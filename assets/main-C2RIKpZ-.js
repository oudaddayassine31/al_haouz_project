function $V(e,t){for(var i=0;i<t.length;i++){const a=t[i];if(typeof a!="string"&&!Array.isArray(a)){for(const h in a)if(h!=="default"&&!(h in e)){const v=Object.getOwnPropertyDescriptor(a,h);v&&Object.defineProperty(e,h,v.get?v:{enumerable:!0,get:()=>a[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const v of h)if(v.type==="childList")for(const S of v.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&a(S)}).observe(document,{childList:!0,subtree:!0});function i(h){const v={};return h.integrity&&(v.integrity=h.integrity),h.referrerPolicy&&(v.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?v.credentials="include":h.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function a(h){if(h.ep)return;h.ep=!0;const v=i(h);fetch(h.href,v)}})();var Uv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gb={exports:{}},A_={},_b={exports:{}},eo={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vk;function UV(){if(vk)return eo;vk=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),S=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),B=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),U=Symbol.iterator;function K(mt){return mt===null||typeof mt!="object"?null:(mt=U&&mt[U]||mt["@@iterator"],typeof mt=="function"?mt:null)}var te={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},le=Object.assign,se={};function ue(mt,zt,Jt){this.props=mt,this.context=zt,this.refs=se,this.updater=Jt||te}ue.prototype.isReactComponent={},ue.prototype.setState=function(mt,zt){if(typeof mt!="object"&&typeof mt!="function"&&mt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,mt,zt,"setState")},ue.prototype.forceUpdate=function(mt){this.updater.enqueueForceUpdate(this,mt,"forceUpdate")};function be(){}be.prototype=ue.prototype;function Ce(mt,zt,Jt){this.props=mt,this.context=zt,this.refs=se,this.updater=Jt||te}var Re=Ce.prototype=new be;Re.constructor=Ce,le(Re,ue.prototype),Re.isPureReactComponent=!0;var De=Array.isArray,ve=Object.prototype.hasOwnProperty,Le={current:null},Fe={key:!0,ref:!0,__self:!0,__source:!0};function lt(mt,zt,Jt){var Un,$n={},Bn=null,$r=null;if(zt!=null)for(Un in zt.ref!==void 0&&($r=zt.ref),zt.key!==void 0&&(Bn=""+zt.key),zt)ve.call(zt,Un)&&!Fe.hasOwnProperty(Un)&&($n[Un]=zt[Un]);var _r=arguments.length-2;if(_r===1)$n.children=Jt;else if(1<_r){for(var Pn=Array(_r),Ke=0;Ke<_r;Ke++)Pn[Ke]=arguments[Ke+2];$n.children=Pn}if(mt&&mt.defaultProps)for(Un in _r=mt.defaultProps,_r)$n[Un]===void 0&&($n[Un]=_r[Un]);return{$$typeof:e,type:mt,key:Bn,ref:$r,props:$n,_owner:Le.current}}function xt(mt,zt){return{$$typeof:e,type:mt.type,key:zt,ref:mt.ref,props:mt.props,_owner:mt._owner}}function gt(mt){return typeof mt=="object"&&mt!==null&&mt.$$typeof===e}function Je(mt){var zt={"=":"=0",":":"=2"};return"$"+mt.replace(/[=:]/g,function(Jt){return zt[Jt]})}var St=/\/+/g;function Nt(mt,zt){return typeof mt=="object"&&mt!==null&&mt.key!=null?Je(""+mt.key):zt.toString(36)}function Ht(mt,zt,Jt,Un,$n){var Bn=typeof mt;(Bn==="undefined"||Bn==="boolean")&&(mt=null);var $r=!1;if(mt===null)$r=!0;else switch(Bn){case"string":case"number":$r=!0;break;case"object":switch(mt.$$typeof){case e:case t:$r=!0}}if($r)return $r=mt,$n=$n($r),mt=Un===""?"."+Nt($r,0):Un,De($n)?(Jt="",mt!=null&&(Jt=mt.replace(St,"$&/")+"/"),Ht($n,zt,Jt,"",function(Ke){return Ke})):$n!=null&&(gt($n)&&($n=xt($n,Jt+(!$n.key||$r&&$r.key===$n.key?"":(""+$n.key).replace(St,"$&/")+"/")+mt)),zt.push($n)),1;if($r=0,Un=Un===""?".":Un+":",De(mt))for(var _r=0;_r<mt.length;_r++){Bn=mt[_r];var Pn=Un+Nt(Bn,_r);$r+=Ht(Bn,zt,Jt,Pn,$n)}else if(Pn=K(mt),typeof Pn=="function")for(mt=Pn.call(mt),_r=0;!(Bn=mt.next()).done;)Bn=Bn.value,Pn=Un+Nt(Bn,_r++),$r+=Ht(Bn,zt,Jt,Pn,$n);else if(Bn==="object")throw zt=String(mt),Error("Objects are not valid as a React child (found: "+(zt==="[object Object]"?"object with keys {"+Object.keys(mt).join(", ")+"}":zt)+"). If you meant to render a collection of children, use an array instead.");return $r}function Ct(mt,zt,Jt){if(mt==null)return mt;var Un=[],$n=0;return Ht(mt,Un,"","",function(Bn){return zt.call(Jt,Bn,$n++)}),Un}function Kt(mt){if(mt._status===-1){var zt=mt._result;zt=zt(),zt.then(function(Jt){(mt._status===0||mt._status===-1)&&(mt._status=1,mt._result=Jt)},function(Jt){(mt._status===0||mt._status===-1)&&(mt._status=2,mt._result=Jt)}),mt._status===-1&&(mt._status=0,mt._result=zt)}if(mt._status===1)return mt._result.default;throw mt._result}var Lt={current:null},et={transition:null},vt={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:et,ReactCurrentOwner:Le};function Ot(){throw Error("act(...) is not supported in production builds of React.")}return eo.Children={map:Ct,forEach:function(mt,zt,Jt){Ct(mt,function(){zt.apply(this,arguments)},Jt)},count:function(mt){var zt=0;return Ct(mt,function(){zt++}),zt},toArray:function(mt){return Ct(mt,function(zt){return zt})||[]},only:function(mt){if(!gt(mt))throw Error("React.Children.only expected to receive a single React element child.");return mt}},eo.Component=ue,eo.Fragment=i,eo.Profiler=h,eo.PureComponent=Ce,eo.StrictMode=a,eo.Suspense=I,eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vt,eo.act=Ot,eo.cloneElement=function(mt,zt,Jt){if(mt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+mt+".");var Un=le({},mt.props),$n=mt.key,Bn=mt.ref,$r=mt._owner;if(zt!=null){if(zt.ref!==void 0&&(Bn=zt.ref,$r=Le.current),zt.key!==void 0&&($n=""+zt.key),mt.type&&mt.type.defaultProps)var _r=mt.type.defaultProps;for(Pn in zt)ve.call(zt,Pn)&&!Fe.hasOwnProperty(Pn)&&(Un[Pn]=zt[Pn]===void 0&&_r!==void 0?_r[Pn]:zt[Pn])}var Pn=arguments.length-2;if(Pn===1)Un.children=Jt;else if(1<Pn){_r=Array(Pn);for(var Ke=0;Ke<Pn;Ke++)_r[Ke]=arguments[Ke+2];Un.children=_r}return{$$typeof:e,type:mt.type,key:$n,ref:Bn,props:Un,_owner:$r}},eo.createContext=function(mt){return mt={$$typeof:S,_currentValue:mt,_currentValue2:mt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},mt.Provider={$$typeof:v,_context:mt},mt.Consumer=mt},eo.createElement=lt,eo.createFactory=function(mt){var zt=lt.bind(null,mt);return zt.type=mt,zt},eo.createRef=function(){return{current:null}},eo.forwardRef=function(mt){return{$$typeof:o,render:mt}},eo.isValidElement=gt,eo.lazy=function(mt){return{$$typeof:$,_payload:{_status:-1,_result:mt},_init:Kt}},eo.memo=function(mt,zt){return{$$typeof:B,type:mt,compare:zt===void 0?null:zt}},eo.startTransition=function(mt){var zt=et.transition;et.transition={};try{mt()}finally{et.transition=zt}},eo.unstable_act=Ot,eo.useCallback=function(mt,zt){return Lt.current.useCallback(mt,zt)},eo.useContext=function(mt){return Lt.current.useContext(mt)},eo.useDebugValue=function(){},eo.useDeferredValue=function(mt){return Lt.current.useDeferredValue(mt)},eo.useEffect=function(mt,zt){return Lt.current.useEffect(mt,zt)},eo.useId=function(){return Lt.current.useId()},eo.useImperativeHandle=function(mt,zt,Jt){return Lt.current.useImperativeHandle(mt,zt,Jt)},eo.useInsertionEffect=function(mt,zt){return Lt.current.useInsertionEffect(mt,zt)},eo.useLayoutEffect=function(mt,zt){return Lt.current.useLayoutEffect(mt,zt)},eo.useMemo=function(mt,zt){return Lt.current.useMemo(mt,zt)},eo.useReducer=function(mt,zt,Jt){return Lt.current.useReducer(mt,zt,Jt)},eo.useRef=function(mt){return Lt.current.useRef(mt)},eo.useState=function(mt){return Lt.current.useState(mt)},eo.useSyncExternalStore=function(mt,zt,Jt){return Lt.current.useSyncExternalStore(mt,zt,Jt)},eo.useTransition=function(){return Lt.current.useTransition()},eo.version="18.3.1",eo}var xk;function Dy(){return xk||(xk=1,_b.exports=UV()),_b.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk;function VV(){if(bk)return A_;bk=1;var e=Dy(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,h=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v={key:!0,ref:!0,__self:!0,__source:!0};function S(o,I,B){var $,U={},K=null,te=null;B!==void 0&&(K=""+B),I.key!==void 0&&(K=""+I.key),I.ref!==void 0&&(te=I.ref);for($ in I)a.call(I,$)&&!v.hasOwnProperty($)&&(U[$]=I[$]);if(o&&o.defaultProps)for($ in I=o.defaultProps,I)U[$]===void 0&&(U[$]=I[$]);return{$$typeof:t,type:o,key:K,ref:te,props:U,_owner:h.current}}return A_.Fragment=i,A_.jsx=S,A_.jsxs=S,A_}var wk;function qV(){return wk||(wk=1,gb.exports=VV()),gb.exports}var Dt=qV(),rt=Dy();const Bt=zo(rt),MA=$V({__proto__:null,default:Bt},[rt]);var Vv={},yb={exports:{}},Iu={},vb={exports:{}},xb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk;function GV(){return Sk||(Sk=1,function(e){function t(et,vt){var Ot=et.length;et.push(vt);e:for(;0<Ot;){var mt=Ot-1>>>1,zt=et[mt];if(0<h(zt,vt))et[mt]=vt,et[Ot]=zt,Ot=mt;else break e}}function i(et){return et.length===0?null:et[0]}function a(et){if(et.length===0)return null;var vt=et[0],Ot=et.pop();if(Ot!==vt){et[0]=Ot;e:for(var mt=0,zt=et.length,Jt=zt>>>1;mt<Jt;){var Un=2*(mt+1)-1,$n=et[Un],Bn=Un+1,$r=et[Bn];if(0>h($n,Ot))Bn<zt&&0>h($r,$n)?(et[mt]=$r,et[Bn]=Ot,mt=Bn):(et[mt]=$n,et[Un]=Ot,mt=Un);else if(Bn<zt&&0>h($r,Ot))et[mt]=$r,et[Bn]=Ot,mt=Bn;else break e}}return vt}function h(et,vt){var Ot=et.sortIndex-vt.sortIndex;return Ot!==0?Ot:et.id-vt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var S=Date,o=S.now();e.unstable_now=function(){return S.now()-o}}var I=[],B=[],$=1,U=null,K=3,te=!1,le=!1,se=!1,ue=typeof setTimeout=="function"?setTimeout:null,be=typeof clearTimeout=="function"?clearTimeout:null,Ce=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Re(et){for(var vt=i(B);vt!==null;){if(vt.callback===null)a(B);else if(vt.startTime<=et)a(B),vt.sortIndex=vt.expirationTime,t(I,vt);else break;vt=i(B)}}function De(et){if(se=!1,Re(et),!le)if(i(I)!==null)le=!0,Kt(ve);else{var vt=i(B);vt!==null&&Lt(De,vt.startTime-et)}}function ve(et,vt){le=!1,se&&(se=!1,be(lt),lt=-1),te=!0;var Ot=K;try{for(Re(vt),U=i(I);U!==null&&(!(U.expirationTime>vt)||et&&!Je());){var mt=U.callback;if(typeof mt=="function"){U.callback=null,K=U.priorityLevel;var zt=mt(U.expirationTime<=vt);vt=e.unstable_now(),typeof zt=="function"?U.callback=zt:U===i(I)&&a(I),Re(vt)}else a(I);U=i(I)}if(U!==null)var Jt=!0;else{var Un=i(B);Un!==null&&Lt(De,Un.startTime-vt),Jt=!1}return Jt}finally{U=null,K=Ot,te=!1}}var Le=!1,Fe=null,lt=-1,xt=5,gt=-1;function Je(){return!(e.unstable_now()-gt<xt)}function St(){if(Fe!==null){var et=e.unstable_now();gt=et;var vt=!0;try{vt=Fe(!0,et)}finally{vt?Nt():(Le=!1,Fe=null)}}else Le=!1}var Nt;if(typeof Ce=="function")Nt=function(){Ce(St)};else if(typeof MessageChannel<"u"){var Ht=new MessageChannel,Ct=Ht.port2;Ht.port1.onmessage=St,Nt=function(){Ct.postMessage(null)}}else Nt=function(){ue(St,0)};function Kt(et){Fe=et,Le||(Le=!0,Nt())}function Lt(et,vt){lt=ue(function(){et(e.unstable_now())},vt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(et){et.callback=null},e.unstable_continueExecution=function(){le||te||(le=!0,Kt(ve))},e.unstable_forceFrameRate=function(et){0>et||125<et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xt=0<et?Math.floor(1e3/et):5},e.unstable_getCurrentPriorityLevel=function(){return K},e.unstable_getFirstCallbackNode=function(){return i(I)},e.unstable_next=function(et){switch(K){case 1:case 2:case 3:var vt=3;break;default:vt=K}var Ot=K;K=vt;try{return et()}finally{K=Ot}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(et,vt){switch(et){case 1:case 2:case 3:case 4:case 5:break;default:et=3}var Ot=K;K=et;try{return vt()}finally{K=Ot}},e.unstable_scheduleCallback=function(et,vt,Ot){var mt=e.unstable_now();switch(typeof Ot=="object"&&Ot!==null?(Ot=Ot.delay,Ot=typeof Ot=="number"&&0<Ot?mt+Ot:mt):Ot=mt,et){case 1:var zt=-1;break;case 2:zt=250;break;case 5:zt=1073741823;break;case 4:zt=1e4;break;default:zt=5e3}return zt=Ot+zt,et={id:$++,callback:vt,priorityLevel:et,startTime:Ot,expirationTime:zt,sortIndex:-1},Ot>mt?(et.sortIndex=Ot,t(B,et),i(I)===null&&et===i(B)&&(se?(be(lt),lt=-1):se=!0,Lt(De,Ot-mt))):(et.sortIndex=zt,t(I,et),le||te||(le=!0,Kt(ve))),et},e.unstable_shouldYield=Je,e.unstable_wrapCallback=function(et){var vt=K;return function(){var Ot=K;K=vt;try{return et.apply(this,arguments)}finally{K=Ot}}}}(xb)),xb}var Tk;function HV(){return Tk||(Tk=1,vb.exports=GV()),vb.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ek;function WV(){if(Ek)return Iu;Ek=1;var e=Dy(),t=HV();function i(_){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+_,z=1;z<arguments.length;z++)b+="&args[]="+encodeURIComponent(arguments[z]);return"Minified React error #"+_+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,h={};function v(_,b){S(_,b),S(_+"Capture",b)}function S(_,b){for(h[_]=b,_=0;_<b.length;_++)a.add(b[_])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),I=Object.prototype.hasOwnProperty,B=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$={},U={};function K(_){return I.call(U,_)?!0:I.call($,_)?!1:B.test(_)?U[_]=!0:($[_]=!0,!1)}function te(_,b,z,G){if(z!==null&&z.type===0)return!1;switch(typeof b){case"function":case"symbol":return!0;case"boolean":return G?!1:z!==null?!z.acceptsBooleans:(_=_.toLowerCase().slice(0,5),_!=="data-"&&_!=="aria-");default:return!1}}function le(_,b,z,G){if(b===null||typeof b>"u"||te(_,b,z,G))return!0;if(G)return!1;if(z!==null)switch(z.type){case 3:return!b;case 4:return b===!1;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function se(_,b,z,G,oe,me,qe){this.acceptsBooleans=b===2||b===3||b===4,this.attributeName=G,this.attributeNamespace=oe,this.mustUseProperty=z,this.propertyName=_,this.type=b,this.sanitizeURL=me,this.removeEmptyString=qe}var ue={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){ue[_]=new se(_,0,!1,_,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var b=_[0];ue[b]=new se(b,1,!1,_[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(_){ue[_]=new se(_,2,!1,_.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){ue[_]=new se(_,2,!1,_,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){ue[_]=new se(_,3,!1,_.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(_){ue[_]=new se(_,3,!0,_,null,!1,!1)}),["capture","download"].forEach(function(_){ue[_]=new se(_,4,!1,_,null,!1,!1)}),["cols","rows","size","span"].forEach(function(_){ue[_]=new se(_,6,!1,_,null,!1,!1)}),["rowSpan","start"].forEach(function(_){ue[_]=new se(_,5,!1,_.toLowerCase(),null,!1,!1)});var be=/[\-:]([a-z])/g;function Ce(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var b=_.replace(be,Ce);ue[b]=new se(b,1,!1,_,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var b=_.replace(be,Ce);ue[b]=new se(b,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(_){var b=_.replace(be,Ce);ue[b]=new se(b,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(_){ue[_]=new se(_,1,!1,_.toLowerCase(),null,!1,!1)}),ue.xlinkHref=new se("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(_){ue[_]=new se(_,1,!1,_.toLowerCase(),null,!0,!0)});function Re(_,b,z,G){var oe=ue.hasOwnProperty(b)?ue[b]:null;(oe!==null?oe.type!==0:G||!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(le(b,z,oe,G)&&(z=null),G||oe===null?K(b)&&(z===null?_.removeAttribute(b):_.setAttribute(b,""+z)):oe.mustUseProperty?_[oe.propertyName]=z===null?oe.type===3?!1:"":z:(b=oe.attributeName,G=oe.attributeNamespace,z===null?_.removeAttribute(b):(oe=oe.type,z=oe===3||oe===4&&z===!0?"":""+z,G?_.setAttributeNS(G,b,z):_.setAttribute(b,z))))}var De=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ve=Symbol.for("react.element"),Le=Symbol.for("react.portal"),Fe=Symbol.for("react.fragment"),lt=Symbol.for("react.strict_mode"),xt=Symbol.for("react.profiler"),gt=Symbol.for("react.provider"),Je=Symbol.for("react.context"),St=Symbol.for("react.forward_ref"),Nt=Symbol.for("react.suspense"),Ht=Symbol.for("react.suspense_list"),Ct=Symbol.for("react.memo"),Kt=Symbol.for("react.lazy"),Lt=Symbol.for("react.offscreen"),et=Symbol.iterator;function vt(_){return _===null||typeof _!="object"?null:(_=et&&_[et]||_["@@iterator"],typeof _=="function"?_:null)}var Ot=Object.assign,mt;function zt(_){if(mt===void 0)try{throw Error()}catch(z){var b=z.stack.trim().match(/\n( *(at )?)/);mt=b&&b[1]||""}return`
`+mt+_}var Jt=!1;function Un(_,b){if(!_||Jt)return"";Jt=!0;var z=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error()},Object.defineProperty(b.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(b,[])}catch(mn){var G=mn}Reflect.construct(_,[],b)}else{try{b.call()}catch(mn){G=mn}_.call(b.prototype)}else{try{throw Error()}catch(mn){G=mn}_()}}catch(mn){if(mn&&G&&typeof mn.stack=="string"){for(var oe=mn.stack.split(`
`),me=G.stack.split(`
`),qe=oe.length-1,bt=me.length-1;1<=qe&&0<=bt&&oe[qe]!==me[bt];)bt--;for(;1<=qe&&0<=bt;qe--,bt--)if(oe[qe]!==me[bt]){if(qe!==1||bt!==1)do if(qe--,bt--,0>bt||oe[qe]!==me[bt]){var Ft=`
`+oe[qe].replace(" at new "," at ");return _.displayName&&Ft.includes("<anonymous>")&&(Ft=Ft.replace("<anonymous>",_.displayName)),Ft}while(1<=qe&&0<=bt);break}}}finally{Jt=!1,Error.prepareStackTrace=z}return(_=_?_.displayName||_.name:"")?zt(_):""}function $n(_){switch(_.tag){case 5:return zt(_.type);case 16:return zt("Lazy");case 13:return zt("Suspense");case 19:return zt("SuspenseList");case 0:case 2:case 15:return _=Un(_.type,!1),_;case 11:return _=Un(_.type.render,!1),_;case 1:return _=Un(_.type,!0),_;default:return""}}function Bn(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case Fe:return"Fragment";case Le:return"Portal";case xt:return"Profiler";case lt:return"StrictMode";case Nt:return"Suspense";case Ht:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case Je:return(_.displayName||"Context")+".Consumer";case gt:return(_._context.displayName||"Context")+".Provider";case St:var b=_.render;return _=_.displayName,_||(_=b.displayName||b.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Ct:return b=_.displayName||null,b!==null?b:Bn(_.type)||"Memo";case Kt:b=_._payload,_=_._init;try{return Bn(_(b))}catch{}}return null}function $r(_){var b=_.type;switch(_.tag){case 24:return"Cache";case 9:return(b.displayName||"Context")+".Consumer";case 10:return(b._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=b.render,_=_.displayName||_.name||"",b.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return b;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bn(b);case 8:return b===lt?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b}return null}function _r(_){switch(typeof _){case"boolean":case"number":case"string":case"undefined":return _;case"object":return _;default:return""}}function Pn(_){var b=_.type;return(_=_.nodeName)&&_.toLowerCase()==="input"&&(b==="checkbox"||b==="radio")}function Ke(_){var b=Pn(_)?"checked":"value",z=Object.getOwnPropertyDescriptor(_.constructor.prototype,b),G=""+_[b];if(!_.hasOwnProperty(b)&&typeof z<"u"&&typeof z.get=="function"&&typeof z.set=="function"){var oe=z.get,me=z.set;return Object.defineProperty(_,b,{configurable:!0,get:function(){return oe.call(this)},set:function(qe){G=""+qe,me.call(this,qe)}}),Object.defineProperty(_,b,{enumerable:z.enumerable}),{getValue:function(){return G},setValue:function(qe){G=""+qe},stopTracking:function(){_._valueTracker=null,delete _[b]}}}}function mr(_){_._valueTracker||(_._valueTracker=Ke(_))}function Sn(_){if(!_)return!1;var b=_._valueTracker;if(!b)return!0;var z=b.getValue(),G="";return _&&(G=Pn(_)?_.checked?"true":"false":_.value),_=G,_!==z?(b.setValue(_),!0):!1}function Dr(_){if(_=_||(typeof document<"u"?document:void 0),typeof _>"u")return null;try{return _.activeElement||_.body}catch{return _.body}}function Yt(_,b){var z=b.checked;return Ot({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:z??_._wrapperState.initialChecked})}function Mr(_,b){var z=b.defaultValue==null?"":b.defaultValue,G=b.checked!=null?b.checked:b.defaultChecked;z=_r(b.value!=null?b.value:z),_._wrapperState={initialChecked:G,initialValue:z,controlled:b.type==="checkbox"||b.type==="radio"?b.checked!=null:b.value!=null}}function Qn(_,b){b=b.checked,b!=null&&Re(_,"checked",b,!1)}function Ar(_,b){Qn(_,b);var z=_r(b.value),G=b.type;if(z!=null)G==="number"?(z===0&&_.value===""||_.value!=z)&&(_.value=""+z):_.value!==""+z&&(_.value=""+z);else if(G==="submit"||G==="reset"){_.removeAttribute("value");return}b.hasOwnProperty("value")?_i(_,b.type,z):b.hasOwnProperty("defaultValue")&&_i(_,b.type,_r(b.defaultValue)),b.checked==null&&b.defaultChecked!=null&&(_.defaultChecked=!!b.defaultChecked)}function sr(_,b,z){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var G=b.type;if(!(G!=="submit"&&G!=="reset"||b.value!==void 0&&b.value!==null))return;b=""+_._wrapperState.initialValue,z||b===_.value||(_.value=b),_.defaultValue=b}z=_.name,z!==""&&(_.name=""),_.defaultChecked=!!_._wrapperState.initialChecked,z!==""&&(_.name=z)}function _i(_,b,z){(b!=="number"||Dr(_.ownerDocument)!==_)&&(z==null?_.defaultValue=""+_._wrapperState.initialValue:_.defaultValue!==""+z&&(_.defaultValue=""+z))}var Wi=Array.isArray;function ii(_,b,z,G){if(_=_.options,b){b={};for(var oe=0;oe<z.length;oe++)b["$"+z[oe]]=!0;for(z=0;z<_.length;z++)oe=b.hasOwnProperty("$"+_[z].value),_[z].selected!==oe&&(_[z].selected=oe),oe&&G&&(_[z].defaultSelected=!0)}else{for(z=""+_r(z),b=null,oe=0;oe<_.length;oe++){if(_[oe].value===z){_[oe].selected=!0,G&&(_[oe].defaultSelected=!0);return}b!==null||_[oe].disabled||(b=_[oe])}b!==null&&(b.selected=!0)}}function Pi(_,b){if(b.dangerouslySetInnerHTML!=null)throw Error(i(91));return Ot({},b,{value:void 0,defaultValue:void 0,children:""+_._wrapperState.initialValue})}function yi(_,b){var z=b.value;if(z==null){if(z=b.children,b=b.defaultValue,z!=null){if(b!=null)throw Error(i(92));if(Wi(z)){if(1<z.length)throw Error(i(93));z=z[0]}b=z}b==null&&(b=""),z=b}_._wrapperState={initialValue:_r(z)}}function lr(_,b){var z=_r(b.value),G=_r(b.defaultValue);z!=null&&(z=""+z,z!==_.value&&(_.value=z),b.defaultValue==null&&_.defaultValue!==z&&(_.defaultValue=z)),G!=null&&(_.defaultValue=""+G)}function qo(_){var b=_.textContent;b===_._wrapperState.initialValue&&b!==""&&b!==null&&(_.value=b)}function ea(_){switch(_){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function la(_,b){return _==null||_==="http://www.w3.org/1999/xhtml"?ea(b):_==="http://www.w3.org/2000/svg"&&b==="foreignObject"?"http://www.w3.org/1999/xhtml":_}var Fi,Mo=function(_){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(b,z,G,oe){MSApp.execUnsafeLocalFunction(function(){return _(b,z,G,oe)})}:_}(function(_,b){if(_.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _)_.innerHTML=b;else{for(Fi=Fi||document.createElement("div"),Fi.innerHTML="<svg>"+b.valueOf().toString()+"</svg>",b=Fi.firstChild;_.firstChild;)_.removeChild(_.firstChild);for(;b.firstChild;)_.appendChild(b.firstChild)}});function ta(_,b){if(b){var z=_.firstChild;if(z&&z===_.lastChild&&z.nodeType===3){z.nodeValue=b;return}}_.textContent=b}var va={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},za=["Webkit","ms","Moz","O"];Object.keys(va).forEach(function(_){za.forEach(function(b){b=b+_.charAt(0).toUpperCase()+_.substring(1),va[b]=va[_]})});function so(_,b,z){return b==null||typeof b=="boolean"||b===""?"":z||typeof b!="number"||b===0||va.hasOwnProperty(_)&&va[_]?(""+b).trim():b+"px"}function Lo(_,b){_=_.style;for(var z in b)if(b.hasOwnProperty(z)){var G=z.indexOf("--")===0,oe=so(z,b[z],G);z==="float"&&(z="cssFloat"),G?_.setProperty(z,oe):_[z]=oe}}var es=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Go(_,b){if(b){if(es[_]&&(b.children!=null||b.dangerouslySetInnerHTML!=null))throw Error(i(137,_));if(b.dangerouslySetInnerHTML!=null){if(b.children!=null)throw Error(i(60));if(typeof b.dangerouslySetInnerHTML!="object"||!("__html"in b.dangerouslySetInnerHTML))throw Error(i(61))}if(b.style!=null&&typeof b.style!="object")throw Error(i(62))}}function Fa(_,b){if(_.indexOf("-")===-1)return typeof b.is=="string";switch(_){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Er=null;function go(_){return _=_.target||_.srcElement||window,_.correspondingUseElement&&(_=_.correspondingUseElement),_.nodeType===3?_.parentNode:_}var Ia=null,Di=null,vi=null;function bi(_){if(_=Bs(_)){if(typeof Ia!="function")throw Error(i(280));var b=_.stateNode;b&&(b=tl(b),Ia(_.stateNode,_.type,b))}}function Mi(_){Di?vi?vi.push(_):vi=[_]:Di=_}function Fo(){if(Di){var _=Di,b=vi;if(vi=Di=null,bi(_),b)for(_=0;_<b.length;_++)bi(b[_])}}function na(_,b){return _(b)}function kt(){}var Se=!1;function Z(_,b,z){if(Se)return _(b,z);Se=!0;try{return na(_,b,z)}finally{Se=!1,(Di!==null||vi!==null)&&(kt(),Fo())}}function re(_,b){var z=_.stateNode;if(z===null)return null;var G=tl(z);if(G===null)return null;z=G[b];e:switch(b){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(G=!G.disabled)||(_=_.type,G=!(_==="button"||_==="input"||_==="select"||_==="textarea")),_=!G;break e;default:_=!1}if(_)return null;if(z&&typeof z!="function")throw Error(i(231,b,typeof z));return z}var ce=!1;if(o)try{var de={};Object.defineProperty(de,"passive",{get:function(){ce=!0}}),window.addEventListener("test",de,de),window.removeEventListener("test",de,de)}catch{ce=!1}function xe(_,b,z,G,oe,me,qe,bt,Ft){var mn=Array.prototype.slice.call(arguments,3);try{b.apply(z,mn)}catch(Vn){this.onError(Vn)}}var Ie=!1,Ae=null,Be=!1,tt=null,ut={onError:function(_){Ie=!0,Ae=_}};function Tt(_,b,z,G,oe,me,qe,bt,Ft){Ie=!1,Ae=null,xe.apply(ut,arguments)}function Wt(_,b,z,G,oe,me,qe,bt,Ft){if(Tt.apply(this,arguments),Ie){if(Ie){var mn=Ae;Ie=!1,Ae=null}else throw Error(i(198));Be||(Be=!0,tt=mn)}}function Vt(_){var b=_,z=_;if(_.alternate)for(;b.return;)b=b.return;else{_=b;do b=_,b.flags&4098&&(z=b.return),_=b.return;while(_)}return b.tag===3?z:null}function Gt(_){if(_.tag===13){var b=_.memoizedState;if(b===null&&(_=_.alternate,_!==null&&(b=_.memoizedState)),b!==null)return b.dehydrated}return null}function gn(_){if(Vt(_)!==_)throw Error(i(188))}function Tn(_){var b=_.alternate;if(!b){if(b=Vt(_),b===null)throw Error(i(188));return b!==_?null:_}for(var z=_,G=b;;){var oe=z.return;if(oe===null)break;var me=oe.alternate;if(me===null){if(G=oe.return,G!==null){z=G;continue}break}if(oe.child===me.child){for(me=oe.child;me;){if(me===z)return gn(oe),_;if(me===G)return gn(oe),b;me=me.sibling}throw Error(i(188))}if(z.return!==G.return)z=oe,G=me;else{for(var qe=!1,bt=oe.child;bt;){if(bt===z){qe=!0,z=oe,G=me;break}if(bt===G){qe=!0,G=oe,z=me;break}bt=bt.sibling}if(!qe){for(bt=me.child;bt;){if(bt===z){qe=!0,z=me,G=oe;break}if(bt===G){qe=!0,G=me,z=oe;break}bt=bt.sibling}if(!qe)throw Error(i(189))}}if(z.alternate!==G)throw Error(i(190))}if(z.tag!==3)throw Error(i(188));return z.stateNode.current===z?_:b}function In(_){return _=Tn(_),_!==null?Ln(_):null}function Ln(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var b=Ln(_);if(b!==null)return b;_=_.sibling}return null}var dr=t.unstable_scheduleCallback,Zn=t.unstable_cancelCallback,Zr=t.unstable_shouldYield,ri=t.unstable_requestPaint,nr=t.unstable_now,hn=t.unstable_getCurrentPriorityLevel,Kn=t.unstable_ImmediatePriority,br=t.unstable_UserBlockingPriority,oi=t.unstable_NormalPriority,Ir=t.unstable_LowPriority,Kr=t.unstable_IdlePriority,qr=null,ci=null;function Zi(_){if(ci&&typeof ci.onCommitFiberRoot=="function")try{ci.onCommitFiberRoot(qr,_,void 0,(_.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:lo,Gr=Math.log,xa=Math.LN2;function lo(_){return _>>>=0,_===0?32:31-(Gr(_)/xa|0)|0}var uo=64,wo=4194304;function yr(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function wi(_,b){var z=_.pendingLanes;if(z===0)return 0;var G=0,oe=_.suspendedLanes,me=_.pingedLanes,qe=z&268435455;if(qe!==0){var bt=qe&~oe;bt!==0?G=yr(bt):(me&=qe,me!==0&&(G=yr(me)))}else qe=z&~oe,qe!==0?G=yr(qe):me!==0&&(G=yr(me));if(G===0)return 0;if(b!==0&&b!==G&&!(b&oe)&&(oe=G&-G,me=b&-b,oe>=me||oe===16&&(me&4194240)!==0))return b;if(G&4&&(G|=z&16),b=_.entangledLanes,b!==0)for(_=_.entanglements,b&=G;0<b;)z=31-Xn(b),oe=1<<z,G|=_[z],b&=~oe;return G}function fe(_,b){switch(_){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oe(_,b){for(var z=_.suspendedLanes,G=_.pingedLanes,oe=_.expirationTimes,me=_.pendingLanes;0<me;){var qe=31-Xn(me),bt=1<<qe,Ft=oe[qe];Ft===-1?(!(bt&z)||bt&G)&&(oe[qe]=fe(bt,b)):Ft<=b&&(_.expiredLanes|=bt),me&=~bt}}function We(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function dt(){var _=uo;return uo<<=1,!(uo&4194240)&&(uo=64),_}function nn(_){for(var b=[],z=0;31>z;z++)b.push(_);return b}function Zt(_,b,z){_.pendingLanes|=b,b!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,b=31-Xn(b),_[b]=z}function fn(_,b){var z=_.pendingLanes&~b;_.pendingLanes=b,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=b,_.mutableReadLanes&=b,_.entangledLanes&=b,b=_.entanglements;var G=_.eventTimes;for(_=_.expirationTimes;0<z;){var oe=31-Xn(z),me=1<<oe;b[oe]=0,G[oe]=-1,_[oe]=-1,z&=~me}}function Cn(_,b){var z=_.entangledLanes|=b;for(_=_.entanglements;z;){var G=31-Xn(z),oe=1<<G;oe&b|_[G]&b&&(_[G]|=b),z&=~oe}}var Gn=0;function Cr(_){return _&=-_,1<_?4<_?_&268435455?16:536870912:4:1}var Ur,Ri,So,To,wr,Ba=!1,Pr=[],Ho=null,Yn=null,Wo=null,ba=new Map,Hr=new Map,fo=[],no="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ss(_,b){switch(_){case"focusin":case"focusout":Ho=null;break;case"dragenter":case"dragleave":Yn=null;break;case"mouseover":case"mouseout":Wo=null;break;case"pointerover":case"pointerout":ba.delete(b.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hr.delete(b.pointerId)}}function Dn(_,b,z,G,oe,me){return _===null||_.nativeEvent!==me?(_={blockedOn:b,domEventName:z,eventSystemFlags:G,nativeEvent:me,targetContainers:[oe]},b!==null&&(b=Bs(b),b!==null&&Ri(b)),_):(_.eventSystemFlags|=G,b=_.targetContainers,oe!==null&&b.indexOf(oe)===-1&&b.push(oe),_)}function ai(_,b,z,G,oe){switch(b){case"focusin":return Ho=Dn(Ho,_,b,z,G,oe),!0;case"dragenter":return Yn=Dn(Yn,_,b,z,G,oe),!0;case"mouseover":return Wo=Dn(Wo,_,b,z,G,oe),!0;case"pointerover":var me=oe.pointerId;return ba.set(me,Dn(ba.get(me)||null,_,b,z,G,oe)),!0;case"gotpointercapture":return me=oe.pointerId,Hr.set(me,Dn(Hr.get(me)||null,_,b,z,G,oe)),!0}return!1}function Br(_){var b=Xl(_.target);if(b!==null){var z=Vt(b);if(z!==null){if(b=z.tag,b===13){if(b=Gt(z),b!==null){_.blockedOn=b,wr(_.priority,function(){So(z)});return}}else if(b===3&&z.stateNode.current.memoizedState.isDehydrated){_.blockedOn=z.tag===3?z.stateNode.containerInfo:null;return}}}_.blockedOn=null}function Eo(_){if(_.blockedOn!==null)return!1;for(var b=_.targetContainers;0<b.length;){var z=Za(_.domEventName,_.eventSystemFlags,b[0],_.nativeEvent);if(z===null){z=_.nativeEvent;var G=new z.constructor(z.type,z);Er=G,z.target.dispatchEvent(G),Er=null}else return b=Bs(z),b!==null&&Ri(b),_.blockedOn=z,!1;b.shift()}return!0}function Bo(_,b,z){Eo(_)&&z.delete(b)}function cr(){Ba=!1,Ho!==null&&Eo(Ho)&&(Ho=null),Yn!==null&&Eo(Yn)&&(Yn=null),Wo!==null&&Eo(Wo)&&(Wo=null),ba.forEach(Bo),Hr.forEach(Bo)}function co(_,b){_.blockedOn===b&&(_.blockedOn=null,Ba||(Ba=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,cr)))}function ua(_){function b(oe){return co(oe,_)}if(0<Pr.length){co(Pr[0],_);for(var z=1;z<Pr.length;z++){var G=Pr[z];G.blockedOn===_&&(G.blockedOn=null)}}for(Ho!==null&&co(Ho,_),Yn!==null&&co(Yn,_),Wo!==null&&co(Wo,_),ba.forEach(b),Hr.forEach(b),z=0;z<fo.length;z++)G=fo[z],G.blockedOn===_&&(G.blockedOn=null);for(;0<fo.length&&(z=fo[0],z.blockedOn===null);)Br(z),z.blockedOn===null&&fo.shift()}var Na=De.ReactCurrentBatchConfig,_o=!0;function ho(_,b,z,G){var oe=Gn,me=Na.transition;Na.transition=null;try{Gn=1,ks(_,b,z,G)}finally{Gn=oe,Na.transition=me}}function hl(_,b,z,G){var oe=Gn,me=Na.transition;Na.transition=null;try{Gn=4,ks(_,b,z,G)}finally{Gn=oe,Na.transition=me}}function ks(_,b,z,G){if(_o){var oe=Za(_,b,z,G);if(oe===null)y(_,b,G,Rs,z),ss(_,G);else if(ai(oe,_,b,z,G))G.stopPropagation();else if(ss(_,G),b&4&&-1<no.indexOf(_)){for(;oe!==null;){var me=Bs(oe);if(me!==null&&Ur(me),me=Za(_,b,z,G),me===null&&y(_,b,G,Rs,z),me===oe)break;oe=me}oe!==null&&G.stopPropagation()}else y(_,b,G,null,z)}}var Rs=null;function Za(_,b,z,G){if(Rs=null,_=go(G),_=Xl(_),_!==null)if(b=Vt(_),b===null)_=null;else if(z=b.tag,z===13){if(_=Gt(b),_!==null)return _;_=null}else if(z===3){if(b.stateNode.current.memoizedState.isDehydrated)return b.tag===3?b.stateNode.containerInfo:null;_=null}else b!==_&&(_=null);return Rs=_,null}function Oi(_){switch(_){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hn()){case Kn:return 1;case br:return 4;case oi:case Ir:return 16;case Kr:return 536870912;default:return 16}default:return 16}}var Zo=null,ro=null,No=null;function ac(){if(No)return No;var _,b=ro,z=b.length,G,oe="value"in Zo?Zo.value:Zo.textContent,me=oe.length;for(_=0;_<z&&b[_]===oe[_];_++);var qe=z-_;for(G=1;G<=qe&&b[z-G]===oe[me-G];G++);return No=oe.slice(_,1<G?1-G:void 0)}function ts(_){var b=_.keyCode;return"charCode"in _?(_=_.charCode,_===0&&b===13&&(_=13)):_=b,_===10&&(_=13),32<=_||_===13?_:0}function io(){return!0}function ca(){return!1}function yo(_){function b(z,G,oe,me,qe){this._reactName=z,this._targetInst=oe,this.type=G,this.nativeEvent=me,this.target=qe,this.currentTarget=null;for(var bt in _)_.hasOwnProperty(bt)&&(z=_[bt],this[bt]=z?z(me):me[bt]);return this.isDefaultPrevented=(me.defaultPrevented!=null?me.defaultPrevented:me.returnValue===!1)?io:ca,this.isPropagationStopped=ca,this}return Ot(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var z=this.nativeEvent;z&&(z.preventDefault?z.preventDefault():typeof z.returnValue!="unknown"&&(z.returnValue=!1),this.isDefaultPrevented=io)},stopPropagation:function(){var z=this.nativeEvent;z&&(z.stopPropagation?z.stopPropagation():typeof z.cancelBubble!="unknown"&&(z.cancelBubble=!0),this.isPropagationStopped=io)},persist:function(){},isPersistent:io}),b}var Ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_){return _.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fl=yo(Ao),Ca=Ot({},Ao,{view:0,detail:0}),bl=yo(Ca),Xo,ls,bs,ra=Ot({},Ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ia,button:0,buttons:0,relatedTarget:function(_){return _.relatedTarget===void 0?_.fromElement===_.srcElement?_.toElement:_.fromElement:_.relatedTarget},movementX:function(_){return"movementX"in _?_.movementX:(_!==bs&&(bs&&_.type==="mousemove"?(Xo=_.screenX-bs.screenX,ls=_.screenY-bs.screenY):ls=Xo=0,bs=_),Xo)},movementY:function(_){return"movementY"in _?_.movementY:ls}}),sc=yo(ra),lc=Ot({},ra,{dataTransfer:0}),wa=yo(lc),us=Ot({},Ca,{relatedTarget:0}),wl=yo(us),Ru=Ot({},Ao,{animationName:0,elapsedTime:0,pseudoElement:0}),lu=yo(Ru),$l=Ot({},Ao,{clipboardData:function(_){return"clipboardData"in _?_.clipboardData:window.clipboardData}}),uu=yo($l),cu=Ot({},Ao,{data:0}),Ks=yo(cu),Lu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ws={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Du(_){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(_):(_=dl[_])?!!b[_]:!1}function ia(){return Du}var Sr=Ot({},Ca,{key:function(_){if(_.key){var b=Lu[_.key]||_.key;if(b!=="Unidentified")return b}return _.type==="keypress"?(_=ts(_),_===13?"Enter":String.fromCharCode(_)):_.type==="keydown"||_.type==="keyup"?ws[_.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ia,charCode:function(_){return _.type==="keypress"?ts(_):0},keyCode:function(_){return _.type==="keydown"||_.type==="keyup"?_.keyCode:0},which:function(_){return _.type==="keypress"?ts(_):_.type==="keydown"||_.type==="keyup"?_.keyCode:0}}),ir=yo(Sr),pe=Ot({},ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pe=yo(pe),Xe=Ot({},Ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ia}),pt=yo(Xe),Mt=Ot({},Ao,{propertyName:0,elapsedTime:0,pseudoElement:0}),an=yo(Mt),wn=Ot({},ra,{deltaX:function(_){return"deltaX"in _?_.deltaX:"wheelDeltaX"in _?-_.wheelDeltaX:0},deltaY:function(_){return"deltaY"in _?_.deltaY:"wheelDeltaY"in _?-_.wheelDeltaY:"wheelDelta"in _?-_.wheelDelta:0},deltaZ:0,deltaMode:0}),Hn=yo(wn),vr=[9,13,27,32],Yr=o&&"CompositionEvent"in window,Or=null;o&&"documentMode"in document&&(Or=document.documentMode);var zi=o&&"TextEvent"in window&&!Or,ha=o&&(!Yr||Or&&8<Or&&11>=Or),jo=" ",Xa=!1;function Oa(_,b){switch(_){case"keyup":return vr.indexOf(b.keyCode)!==-1;case"keydown":return b.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ji(_){return _=_.detail,typeof _=="object"&&"data"in _?_.data:null}var cs=!1;function En(_,b){switch(_){case"compositionend":return Ji(b);case"keypress":return b.which!==32?null:(Xa=!0,jo);case"textInput":return _=b.data,_===jo&&Xa?null:_;default:return null}}function Ul(_,b){if(cs)return _==="compositionend"||!Yr&&Oa(_,b)?(_=ac(),No=ro=Zo=null,cs=!1,_):null;switch(_){case"paste":return null;case"keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case"compositionend":return ha&&b.locale!=="ko"?null:b.data;default:return null}}var Vl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qc(_){var b=_&&_.nodeName&&_.nodeName.toLowerCase();return b==="input"?!!Vl[_.type]:b==="textarea"}function zu(_,b,z,G){Mi(G),b=V(b,"onChange"),0<b.length&&(z=new fl("onChange","change",null,z,G),_.push({event:z,listeners:b}))}var hu=null,fa=null;function ff(_){oh(_,0)}function da(_){var b=pu(_);if(Sn(b))return _}function zh(_,b){if(_==="change")return b}var hs=!1;if(o){var Fu;if(o){var eh="oninput"in document;if(!eh){var ns=document.createElement("div");ns.setAttribute("oninput","return;"),eh=typeof ns.oninput=="function"}Fu=eh}else Fu=!1;hs=Fu&&(!document.documentMode||9<document.documentMode)}function uc(){hu&&(hu.detachEvent("onpropertychange",cc),fa=hu=null)}function cc(_){if(_.propertyName==="value"&&da(fa)){var b=[];zu(b,fa,_,go(_)),Z(ff,b)}}function hc(_,b,z){_==="focusin"?(uc(),hu=b,fa=z,hu.attachEvent("onpropertychange",cc)):_==="focusout"&&uc()}function ql(_){if(_==="selectionchange"||_==="keyup"||_==="keydown")return da(fa)}function th(_,b){if(_==="click")return da(b)}function Fh(_,b){if(_==="input"||_==="change")return da(b)}function df(_,b){return _===b&&(_!==0||1/_===1/b)||_!==_&&b!==b}var Ys=typeof Object.is=="function"?Object.is:df;function Sl(_,b){if(Ys(_,b))return!0;if(typeof _!="object"||_===null||typeof b!="object"||b===null)return!1;var z=Object.keys(_),G=Object.keys(b);if(z.length!==G.length)return!1;for(G=0;G<z.length;G++){var oe=z[G];if(!I.call(b,oe)||!Ys(_[oe],b[oe]))return!1}return!0}function pf(_){for(;_&&_.firstChild;)_=_.firstChild;return _}function Bu(_,b){var z=pf(_);_=0;for(var G;z;){if(z.nodeType===3){if(G=_+z.textContent.length,_<=b&&G>=b)return{node:z,offset:b-_};_=G}e:{for(;z;){if(z.nextSibling){z=z.nextSibling;break e}z=z.parentNode}z=void 0}z=pf(z)}}function nh(_,b){return _&&b?_===b?!0:_&&_.nodeType===3?!1:b&&b.nodeType===3?nh(_,b.parentNode):"contains"in _?_.contains(b):_.compareDocumentPosition?!!(_.compareDocumentPosition(b)&16):!1:!1}function Nu(){for(var _=window,b=Dr();b instanceof _.HTMLIFrameElement;){try{var z=typeof b.contentWindow.location.href=="string"}catch{z=!1}if(z)_=b.contentWindow;else break;b=Dr(_.document)}return b}function fu(_){var b=_&&_.nodeName&&_.nodeName.toLowerCase();return b&&(b==="input"&&(_.type==="text"||_.type==="search"||_.type==="tel"||_.type==="url"||_.type==="password")||b==="textarea"||_.contentEditable==="true")}function Ss(_){var b=Nu(),z=_.focusedElem,G=_.selectionRange;if(b!==z&&z&&z.ownerDocument&&nh(z.ownerDocument.documentElement,z)){if(G!==null&&fu(z)){if(b=G.start,_=G.end,_===void 0&&(_=b),"selectionStart"in z)z.selectionStart=b,z.selectionEnd=Math.min(_,z.value.length);else if(_=(b=z.ownerDocument||document)&&b.defaultView||window,_.getSelection){_=_.getSelection();var oe=z.textContent.length,me=Math.min(G.start,oe);G=G.end===void 0?me:Math.min(G.end,oe),!_.extend&&me>G&&(oe=G,G=me,me=oe),oe=Bu(z,me);var qe=Bu(z,G);oe&&qe&&(_.rangeCount!==1||_.anchorNode!==oe.node||_.anchorOffset!==oe.offset||_.focusNode!==qe.node||_.focusOffset!==qe.offset)&&(b=b.createRange(),b.setStart(oe.node,oe.offset),_.removeAllRanges(),me>G?(_.addRange(b),_.extend(qe.node,qe.offset)):(b.setEnd(qe.node,qe.offset),_.addRange(b)))}}for(b=[],_=z;_=_.parentNode;)_.nodeType===1&&b.push({element:_,left:_.scrollLeft,top:_.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<b.length;z++)_=b[z],_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}var ju=o&&"documentMode"in document&&11>=document.documentMode,Ls=null,Ds=null,ti=null,Gl=!1;function fc(_,b,z){var G=z.window===z?z.document:z.nodeType===9?z:z.ownerDocument;Gl||Ls==null||Ls!==Dr(G)||(G=Ls,"selectionStart"in G&&fu(G)?G={start:G.selectionStart,end:G.selectionEnd}:(G=(G.ownerDocument&&G.ownerDocument.defaultView||window).getSelection(),G={anchorNode:G.anchorNode,anchorOffset:G.anchorOffset,focusNode:G.focusNode,focusOffset:G.focusOffset}),ti&&Sl(ti,G)||(ti=G,G=V(Ds,"onSelect"),0<G.length&&(b=new fl("onSelect","select",null,b,z),_.push({event:b,listeners:G}),b.target=Ls)))}function pl(_,b){var z={};return z[_.toLowerCase()]=b.toLowerCase(),z["Webkit"+_]="webkit"+b,z["Moz"+_]="moz"+b,z}var Tl={animationend:pl("Animation","AnimationEnd"),animationiteration:pl("Animation","AnimationIteration"),animationstart:pl("Animation","AnimationStart"),transitionend:pl("Transition","TransitionEnd")},zs={},Bi={};o&&(Bi=document.createElement("div").style,"AnimationEvent"in window||(delete Tl.animationend.animation,delete Tl.animationiteration.animation,delete Tl.animationstart.animation),"TransitionEvent"in window||delete Tl.transitionend.transition);function $u(_){if(zs[_])return zs[_];if(!Tl[_])return _;var b=Tl[_],z;for(z in b)if(b.hasOwnProperty(z)&&z in Bi)return zs[_]=b[z];return _}var mf=$u("animationend"),Js=$u("animationiteration"),dc=$u("animationstart"),Uu=$u("transitionend"),Vu=new Map,gf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qs(_,b){Vu.set(_,b),v(b,[_])}for(var el=0;el<gf.length;el++){var rh=gf[el],ad=rh.toLowerCase(),tp=rh[0].toUpperCase()+rh.slice(1);Qs(ad,"on"+tp)}Qs(mf,"onAnimationEnd"),Qs(Js,"onAnimationIteration"),Qs(dc,"onAnimationStart"),Qs("dblclick","onDoubleClick"),Qs("focusin","onFocus"),Qs("focusout","onBlur"),Qs(Uu,"onTransitionEnd"),S("onMouseEnter",["mouseout","mouseover"]),S("onMouseLeave",["mouseout","mouseover"]),S("onPointerEnter",["pointerout","pointerover"]),S("onPointerLeave",["pointerout","pointerover"]),v("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),v("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),v("onBeforeInput",["compositionend","keypress","textInput","paste"]),v("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),v("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),v("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bh=new Set("cancel close invalid load scroll toggle".split(" ").concat(pc));function ih(_,b,z){var G=_.type||"unknown-event";_.currentTarget=z,Wt(G,b,void 0,_),_.currentTarget=null}function oh(_,b){b=(b&4)!==0;for(var z=0;z<_.length;z++){var G=_[z],oe=G.event;G=G.listeners;e:{var me=void 0;if(b)for(var qe=G.length-1;0<=qe;qe--){var bt=G[qe],Ft=bt.instance,mn=bt.currentTarget;if(bt=bt.listener,Ft!==me&&oe.isPropagationStopped())break e;ih(oe,bt,mn),me=Ft}else for(qe=0;qe<G.length;qe++){if(bt=G[qe],Ft=bt.instance,mn=bt.currentTarget,bt=bt.listener,Ft!==me&&oe.isPropagationStopped())break e;ih(oe,bt,mn),me=Ft}}}if(Be)throw _=tt,Be=!1,tt=null,_}function vo(_,b){var z=b[Gu];z===void 0&&(z=b[Gu]=new Set);var G=_+"__bubble";z.has(G)||(_c(b,_,2,!1),z.add(G))}function Nh(_,b,z){var G=0;b&&(G|=4),_c(z,_,G,b)}var mc="_reactListening"+Math.random().toString(36).slice(2);function gc(_){if(!_[mc]){_[mc]=!0,a.forEach(function(z){z!=="selectionchange"&&(Bh.has(z)||Nh(z,!1,_),Nh(z,!0,_))});var b=_.nodeType===9?_:_.ownerDocument;b===null||b[mc]||(b[mc]=!0,Nh("selectionchange",!1,b))}}function _c(_,b,z,G){switch(Oi(b)){case 1:var oe=ho;break;case 4:oe=hl;break;default:oe=ks}z=oe.bind(null,b,z,_),oe=void 0,!ce||b!=="touchstart"&&b!=="touchmove"&&b!=="wheel"||(oe=!0),G?oe!==void 0?_.addEventListener(b,z,{capture:!0,passive:oe}):_.addEventListener(b,z,!0):oe!==void 0?_.addEventListener(b,z,{passive:oe}):_.addEventListener(b,z,!1)}function y(_,b,z,G,oe){var me=G;if(!(b&1)&&!(b&2)&&G!==null)e:for(;;){if(G===null)return;var qe=G.tag;if(qe===3||qe===4){var bt=G.stateNode.containerInfo;if(bt===oe||bt.nodeType===8&&bt.parentNode===oe)break;if(qe===4)for(qe=G.return;qe!==null;){var Ft=qe.tag;if((Ft===3||Ft===4)&&(Ft=qe.stateNode.containerInfo,Ft===oe||Ft.nodeType===8&&Ft.parentNode===oe))return;qe=qe.return}for(;bt!==null;){if(qe=Xl(bt),qe===null)return;if(Ft=qe.tag,Ft===5||Ft===6){G=me=qe;continue e}bt=bt.parentNode}}G=G.return}Z(function(){var mn=me,Vn=go(z),Wn=[];e:{var jn=Vu.get(_);if(jn!==void 0){var xr=fl,zr=_;switch(_){case"keypress":if(ts(z)===0)break e;case"keydown":case"keyup":xr=ir;break;case"focusin":zr="focus",xr=wl;break;case"focusout":zr="blur",xr=wl;break;case"beforeblur":case"afterblur":xr=wl;break;case"click":if(z.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xr=sc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xr=wa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xr=pt;break;case mf:case Js:case dc:xr=lu;break;case Uu:xr=an;break;case"scroll":xr=bl;break;case"wheel":xr=Hn;break;case"copy":case"cut":case"paste":xr=uu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xr=Pe}var jr=(b&4)!==0,qa=!jr&&_==="scroll",ln=jr?jn!==null?jn+"Capture":null:jn;jr=[];for(var qt=mn,un;qt!==null;){un=qt;var rr=un.stateNode;if(un.tag===5&&rr!==null&&(un=rr,ln!==null&&(rr=re(qt,ln),rr!=null&&jr.push(M(qt,rr,un)))),qa)break;qt=qt.return}0<jr.length&&(jn=new xr(jn,zr,null,z,Vn),Wn.push({event:jn,listeners:jr}))}}if(!(b&7)){e:{if(jn=_==="mouseover"||_==="pointerover",xr=_==="mouseout"||_==="pointerout",jn&&z!==Er&&(zr=z.relatedTarget||z.fromElement)&&(Xl(zr)||zr[Xi]))break e;if((xr||jn)&&(jn=Vn.window===Vn?Vn:(jn=Vn.ownerDocument)?jn.defaultView||jn.parentWindow:window,xr?(zr=z.relatedTarget||z.toElement,xr=mn,zr=zr?Xl(zr):null,zr!==null&&(qa=Vt(zr),zr!==qa||zr.tag!==5&&zr.tag!==6)&&(zr=null)):(xr=null,zr=mn),xr!==zr)){if(jr=sc,rr="onMouseLeave",ln="onMouseEnter",qt="mouse",(_==="pointerout"||_==="pointerover")&&(jr=Pe,rr="onPointerLeave",ln="onPointerEnter",qt="pointer"),qa=xr==null?jn:pu(xr),un=zr==null?jn:pu(zr),jn=new jr(rr,qt+"leave",xr,z,Vn),jn.target=qa,jn.relatedTarget=un,rr=null,Xl(Vn)===mn&&(jr=new jr(ln,qt+"enter",zr,z,Vn),jr.target=un,jr.relatedTarget=qa,rr=jr),qa=rr,xr&&zr)t:{for(jr=xr,ln=zr,qt=0,un=jr;un;un=ie(un))qt++;for(un=0,rr=ln;rr;rr=ie(rr))un++;for(;0<qt-un;)jr=ie(jr),qt--;for(;0<un-qt;)ln=ie(ln),un--;for(;qt--;){if(jr===ln||ln!==null&&jr===ln.alternate)break t;jr=ie(jr),ln=ie(ln)}jr=null}else jr=null;xr!==null&&Ee(Wn,jn,xr,jr,!1),zr!==null&&qa!==null&&Ee(Wn,qa,zr,jr,!0)}}e:{if(jn=mn?pu(mn):window,xr=jn.nodeName&&jn.nodeName.toLowerCase(),xr==="select"||xr==="input"&&jn.type==="file")var Wr=zh;else if(Qc(jn))if(hs)Wr=Fh;else{Wr=ql;var mi=hc}else(xr=jn.nodeName)&&xr.toLowerCase()==="input"&&(jn.type==="checkbox"||jn.type==="radio")&&(Wr=th);if(Wr&&(Wr=Wr(_,mn))){zu(Wn,Wr,z,Vn);break e}mi&&mi(_,jn,mn),_==="focusout"&&(mi=jn._wrapperState)&&mi.controlled&&jn.type==="number"&&_i(jn,"number",jn.value)}switch(mi=mn?pu(mn):window,_){case"focusin":(Qc(mi)||mi.contentEditable==="true")&&(Ls=mi,Ds=mn,ti=null);break;case"focusout":ti=Ds=Ls=null;break;case"mousedown":Gl=!0;break;case"contextmenu":case"mouseup":case"dragend":Gl=!1,fc(Wn,z,Vn);break;case"selectionchange":if(ju)break;case"keydown":case"keyup":fc(Wn,z,Vn)}var gi;if(Yr)e:{switch(_){case"compositionstart":var Ai="onCompositionStart";break e;case"compositionend":Ai="onCompositionEnd";break e;case"compositionupdate":Ai="onCompositionUpdate";break e}Ai=void 0}else cs?Oa(_,z)&&(Ai="onCompositionEnd"):_==="keydown"&&z.keyCode===229&&(Ai="onCompositionStart");Ai&&(ha&&z.locale!=="ko"&&(cs||Ai!=="onCompositionStart"?Ai==="onCompositionEnd"&&cs&&(gi=ac()):(Zo=Vn,ro="value"in Zo?Zo.value:Zo.textContent,cs=!0)),mi=V(mn,Ai),0<mi.length&&(Ai=new Ks(Ai,_,null,z,Vn),Wn.push({event:Ai,listeners:mi}),gi?Ai.data=gi:(gi=Ji(z),gi!==null&&(Ai.data=gi)))),(gi=zi?En(_,z):Ul(_,z))&&(mn=V(mn,"onBeforeInput"),0<mn.length&&(Vn=new Ks("onBeforeInput","beforeinput",null,z,Vn),Wn.push({event:Vn,listeners:mn}),Vn.data=gi))}oh(Wn,b)})}function M(_,b,z){return{instance:_,listener:b,currentTarget:z}}function V(_,b){for(var z=b+"Capture",G=[];_!==null;){var oe=_,me=oe.stateNode;oe.tag===5&&me!==null&&(oe=me,me=re(_,z),me!=null&&G.unshift(M(_,me,oe)),me=re(_,b),me!=null&&G.push(M(_,me,oe))),_=_.return}return G}function ie(_){if(_===null)return null;do _=_.return;while(_&&_.tag!==5);return _||null}function Ee(_,b,z,G,oe){for(var me=b._reactName,qe=[];z!==null&&z!==G;){var bt=z,Ft=bt.alternate,mn=bt.stateNode;if(Ft!==null&&Ft===G)break;bt.tag===5&&mn!==null&&(bt=mn,oe?(Ft=re(z,me),Ft!=null&&qe.unshift(M(z,Ft,bt))):oe||(Ft=re(z,me),Ft!=null&&qe.push(M(z,Ft,bt)))),z=z.return}qe.length!==0&&_.push({event:b,listeners:qe})}var Ge=/\r\n?/g,Pt=/\u0000|\uFFFD/g;function on(_){return(typeof _=="string"?_:""+_).replace(Ge,`
`).replace(Pt,"")}function dn(_,b,z){if(b=on(b),on(_)!==b&&z)throw Error(i(425))}function Rn(){}var hr=null,Jr=null;function Ii(_,b){return _==="textarea"||_==="noscript"||typeof b.children=="string"||typeof b.children=="number"||typeof b.dangerouslySetInnerHTML=="object"&&b.dangerouslySetInnerHTML!==null&&b.dangerouslySetInnerHTML.__html!=null}var ja=typeof setTimeout=="function"?setTimeout:void 0,Ko=typeof clearTimeout=="function"?clearTimeout:void 0,Fs=typeof Promise=="function"?Promise:void 0,fs=typeof queueMicrotask=="function"?queueMicrotask:typeof Fs<"u"?function(_){return Fs.resolve(null).then(_).catch(qu)}:ja;function qu(_){setTimeout(function(){throw _})}function du(_,b){var z=b,G=0;do{var oe=z.nextSibling;if(_.removeChild(z),oe&&oe.nodeType===8)if(z=oe.data,z==="/$"){if(G===0){_.removeChild(oe),ua(b);return}G--}else z!=="$"&&z!=="$?"&&z!=="$!"||G++;z=oe}while(z);ua(b)}function Hl(_){for(;_!=null;_=_.nextSibling){var b=_.nodeType;if(b===1||b===3)break;if(b===8){if(b=_.data,b==="$"||b==="$!"||b==="$?")break;if(b==="/$")return null}}return _}function _f(_){_=_.previousSibling;for(var b=0;_;){if(_.nodeType===8){var z=_.data;if(z==="$"||z==="$!"||z==="$?"){if(b===0)return _;b--}else z==="/$"&&b++}_=_.previousSibling}return null}var Wl=Math.random().toString(36).slice(2),Ts="__reactFiber$"+Wl,Zl="__reactProps$"+Wl,Xi="__reactContainer$"+Wl,Gu="__reactEvents$"+Wl,yf="__reactListeners$"+Wl,vf="__reactHandles$"+Wl;function Xl(_){var b=_[Ts];if(b)return b;for(var z=_.parentNode;z;){if(b=z[Xi]||z[Ts]){if(z=b.alternate,b.child!==null||z!==null&&z.child!==null)for(_=_f(_);_!==null;){if(z=_[Ts])return z;_=_f(_)}return b}_=z,z=_.parentNode}return null}function Bs(_){return _=_[Ts]||_[Xi],!_||_.tag!==5&&_.tag!==6&&_.tag!==13&&_.tag!==3?null:_}function pu(_){if(_.tag===5||_.tag===6)return _.stateNode;throw Error(i(33))}function tl(_){return _[Zl]||null}var jh=[],El=-1;function Hu(_){return{current:_}}function Do(_){0>El||(_.current=jh[El],jh[El]=null,El--)}function Io(_,b){El++,jh[El]=_.current,_.current=b}var mu={},ds=Hu(mu),Es=Hu(!1),Kl=mu;function $h(_,b){var z=_.type.contextTypes;if(!z)return mu;var G=_.stateNode;if(G&&G.__reactInternalMemoizedUnmaskedChildContext===b)return G.__reactInternalMemoizedMaskedChildContext;var oe={},me;for(me in z)oe[me]=b[me];return G&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=b,_.__reactInternalMemoizedMaskedChildContext=oe),oe}function nl(_){return _=_.childContextTypes,_!=null}function Uh(){Do(Es),Do(ds)}function sm(_,b,z){if(ds.current!==mu)throw Error(i(168));Io(ds,b),Io(Es,z)}function sd(_,b,z){var G=_.stateNode;if(b=b.childContextTypes,typeof G.getChildContext!="function")return z;G=G.getChildContext();for(var oe in G)if(!(oe in b))throw Error(i(108,$r(_)||"Unknown",oe));return Ot({},z,G)}function ah(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||mu,Kl=ds.current,Io(ds,_),Io(Es,Es.current),!0}function sh(_,b,z){var G=_.stateNode;if(!G)throw Error(i(169));z?(_=sd(_,b,Kl),G.__reactInternalMemoizedMergedChildContext=_,Do(Es),Do(ds),Io(ds,_)):Do(Es),Io(Es,z)}var Al=null,yc=!1,Wu=!1;function xf(_){Al===null?Al=[_]:Al.push(_)}function ld(_){yc=!0,xf(_)}function gu(){if(!Wu&&Al!==null){Wu=!0;var _=0,b=Gn;try{var z=Al;for(Gn=1;_<z.length;_++){var G=z[_];do G=G(!0);while(G!==null)}Al=null,yc=!1}catch(oe){throw Al!==null&&(Al=Al.slice(_+1)),dr(Kn,gu),oe}finally{Gn=b,Wu=!1}}return null}var vc=[],lh=0,_u=null,xc=0,kn=[],Ns=0,Zu=null,js=1,Sa="";function Jn(_,b){vc[lh++]=xc,vc[lh++]=_u,_u=_,xc=b}function ud(_,b,z){kn[Ns++]=js,kn[Ns++]=Sa,kn[Ns++]=Zu,Zu=_;var G=js;_=Sa;var oe=32-Xn(G)-1;G&=~(1<<oe),z+=1;var me=32-Xn(b)+oe;if(30<me){var qe=oe-oe%5;me=(G&(1<<qe)-1).toString(32),G>>=qe,oe-=qe,js=1<<32-Xn(b)+oe|z<<oe|G,Sa=me+_}else js=1<<me|z<<oe|G,Sa=_}function cd(_){_.return!==null&&(Jn(_,1),ud(_,1,0))}function np(_){for(;_===_u;)_u=vc[--lh],vc[lh]=null,xc=vc[--lh],vc[lh]=null;for(;_===Zu;)Zu=kn[--Ns],kn[Ns]=null,Sa=kn[--Ns],kn[Ns]=null,js=kn[--Ns],kn[Ns]=null}var rs=null,$s=null,Co=!1,Pl=null;function lm(_,b){var z=Au(5,null,null,0);z.elementType="DELETED",z.stateNode=b,z.return=_,b=_.deletions,b===null?(_.deletions=[z],_.flags|=16):b.push(z)}function hd(_,b){switch(_.tag){case 5:var z=_.type;return b=b.nodeType!==1||z.toLowerCase()!==b.nodeName.toLowerCase()?null:b,b!==null?(_.stateNode=b,rs=_,$s=Hl(b.firstChild),!0):!1;case 6:return b=_.pendingProps===""||b.nodeType!==3?null:b,b!==null?(_.stateNode=b,rs=_,$s=null,!0):!1;case 13:return b=b.nodeType!==8?null:b,b!==null?(z=Zu!==null?{id:js,overflow:Sa}:null,_.memoizedState={dehydrated:b,treeContext:z,retryLane:1073741824},z=Au(18,null,null,0),z.stateNode=b,z.return=_,_.child=z,rs=_,$s=null,!0):!1;default:return!1}}function uh(_){return(_.mode&1)!==0&&(_.flags&128)===0}function ch(_){if(Co){var b=$s;if(b){var z=b;if(!hd(_,b)){if(uh(_))throw Error(i(418));b=Hl(z.nextSibling);var G=rs;b&&hd(_,b)?lm(G,z):(_.flags=_.flags&-4097|2,Co=!1,rs=_)}}else{if(uh(_))throw Error(i(418));_.flags=_.flags&-4097|2,Co=!1,rs=_}}}function bf(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;rs=_}function $a(_){if(_!==rs)return!1;if(!Co)return bf(_),Co=!0,!1;var b;if((b=_.tag!==3)&&!(b=_.tag!==5)&&(b=_.type,b=b!=="head"&&b!=="body"&&!Ii(_.type,_.memoizedProps)),b&&(b=$s)){if(uh(_))throw rl(),Error(i(418));for(;b;)lm(_,b),b=Hl(b.nextSibling)}if(bf(_),_.tag===13){if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(i(317));e:{for(_=_.nextSibling,b=0;_;){if(_.nodeType===8){var z=_.data;if(z==="/$"){if(b===0){$s=Hl(_.nextSibling);break e}b--}else z!=="$"&&z!=="$!"&&z!=="$?"||b++}_=_.nextSibling}$s=null}}else $s=rs?Hl(_.stateNode.nextSibling):null;return!0}function rl(){for(var _=$s;_;)_=Hl(_.nextSibling)}function hh(){$s=rs=null,Co=!1}function wf(_){Pl===null?Pl=[_]:Pl.push(_)}var rp=De.ReactCurrentBatchConfig;function fh(_,b,z){if(_=z.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(z._owner){if(z=z._owner,z){if(z.tag!==1)throw Error(i(309));var G=z.stateNode}if(!G)throw Error(i(147,_));var oe=G,me=""+_;return b!==null&&b.ref!==null&&typeof b.ref=="function"&&b.ref._stringRef===me?b.ref:(b=function(qe){var bt=oe.refs;qe===null?delete bt[me]:bt[me]=qe},b._stringRef=me,b)}if(typeof _!="string")throw Error(i(284));if(!z._owner)throw Error(i(290,_))}return _}function Sf(_,b){throw _=Object.prototype.toString.call(b),Error(i(31,_==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":_))}function il(_){var b=_._init;return b(_._payload)}function Po(_){function b(ln,qt){if(_){var un=ln.deletions;un===null?(ln.deletions=[qt],ln.flags|=16):un.push(qt)}}function z(ln,qt){if(!_)return null;for(;qt!==null;)b(ln,qt),qt=qt.sibling;return null}function G(ln,qt){for(ln=new Map;qt!==null;)qt.key!==null?ln.set(qt.key,qt):ln.set(qt.index,qt),qt=qt.sibling;return ln}function oe(ln,qt){return ln=wh(ln,qt),ln.index=0,ln.sibling=null,ln}function me(ln,qt,un){return ln.index=un,_?(un=ln.alternate,un!==null?(un=un.index,un<qt?(ln.flags|=2,qt):un):(ln.flags|=2,qt)):(ln.flags|=1048576,qt)}function qe(ln){return _&&ln.alternate===null&&(ln.flags|=2),ln}function bt(ln,qt,un,rr){return qt===null||qt.tag!==6?(qt=bm(un,ln.mode,rr),qt.return=ln,qt):(qt=oe(qt,un),qt.return=ln,qt)}function Ft(ln,qt,un,rr){var Wr=un.type;return Wr===Fe?Vn(ln,qt,un.props.children,rr,un.key):qt!==null&&(qt.elementType===Wr||typeof Wr=="object"&&Wr!==null&&Wr.$$typeof===Kt&&il(Wr)===qt.type)?(rr=oe(qt,un.props),rr.ref=fh(ln,qt,un),rr.return=ln,rr):(rr=gp(un.type,un.key,un.props,null,ln.mode,rr),rr.ref=fh(ln,qt,un),rr.return=ln,rr)}function mn(ln,qt,un,rr){return qt===null||qt.tag!==4||qt.stateNode.containerInfo!==un.containerInfo||qt.stateNode.implementation!==un.implementation?(qt=yp(un,ln.mode,rr),qt.return=ln,qt):(qt=oe(qt,un.children||[]),qt.return=ln,qt)}function Vn(ln,qt,un,rr,Wr){return qt===null||qt.tag!==7?(qt=Kh(un,ln.mode,rr,Wr),qt.return=ln,qt):(qt=oe(qt,un),qt.return=ln,qt)}function Wn(ln,qt,un){if(typeof qt=="string"&&qt!==""||typeof qt=="number")return qt=bm(""+qt,ln.mode,un),qt.return=ln,qt;if(typeof qt=="object"&&qt!==null){switch(qt.$$typeof){case ve:return un=gp(qt.type,qt.key,qt.props,null,ln.mode,un),un.ref=fh(ln,null,qt),un.return=ln,un;case Le:return qt=yp(qt,ln.mode,un),qt.return=ln,qt;case Kt:var rr=qt._init;return Wn(ln,rr(qt._payload),un)}if(Wi(qt)||vt(qt))return qt=Kh(qt,ln.mode,un,null),qt.return=ln,qt;Sf(ln,qt)}return null}function jn(ln,qt,un,rr){var Wr=qt!==null?qt.key:null;if(typeof un=="string"&&un!==""||typeof un=="number")return Wr!==null?null:bt(ln,qt,""+un,rr);if(typeof un=="object"&&un!==null){switch(un.$$typeof){case ve:return un.key===Wr?Ft(ln,qt,un,rr):null;case Le:return un.key===Wr?mn(ln,qt,un,rr):null;case Kt:return Wr=un._init,jn(ln,qt,Wr(un._payload),rr)}if(Wi(un)||vt(un))return Wr!==null?null:Vn(ln,qt,un,rr,null);Sf(ln,un)}return null}function xr(ln,qt,un,rr,Wr){if(typeof rr=="string"&&rr!==""||typeof rr=="number")return ln=ln.get(un)||null,bt(qt,ln,""+rr,Wr);if(typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case ve:return ln=ln.get(rr.key===null?un:rr.key)||null,Ft(qt,ln,rr,Wr);case Le:return ln=ln.get(rr.key===null?un:rr.key)||null,mn(qt,ln,rr,Wr);case Kt:var mi=rr._init;return xr(ln,qt,un,mi(rr._payload),Wr)}if(Wi(rr)||vt(rr))return ln=ln.get(un)||null,Vn(qt,ln,rr,Wr,null);Sf(qt,rr)}return null}function zr(ln,qt,un,rr){for(var Wr=null,mi=null,gi=qt,Ai=qt=0,Ms=null;gi!==null&&Ai<un.length;Ai++){gi.index>Ai?(Ms=gi,gi=null):Ms=gi.sibling;var xo=jn(ln,gi,un[Ai],rr);if(xo===null){gi===null&&(gi=Ms);break}_&&gi&&xo.alternate===null&&b(ln,gi),qt=me(xo,qt,Ai),mi===null?Wr=xo:mi.sibling=xo,mi=xo,gi=Ms}if(Ai===un.length)return z(ln,gi),Co&&Jn(ln,Ai),Wr;if(gi===null){for(;Ai<un.length;Ai++)gi=Wn(ln,un[Ai],rr),gi!==null&&(qt=me(gi,qt,Ai),mi===null?Wr=gi:mi.sibling=gi,mi=gi);return Co&&Jn(ln,Ai),Wr}for(gi=G(ln,gi);Ai<un.length;Ai++)Ms=xr(gi,ln,Ai,un[Ai],rr),Ms!==null&&(_&&Ms.alternate!==null&&gi.delete(Ms.key===null?Ai:Ms.key),qt=me(Ms,qt,Ai),mi===null?Wr=Ms:mi.sibling=Ms,mi=Ms);return _&&gi.forEach(function(Qh){return b(ln,Qh)}),Co&&Jn(ln,Ai),Wr}function jr(ln,qt,un,rr){var Wr=vt(un);if(typeof Wr!="function")throw Error(i(150));if(un=Wr.call(un),un==null)throw Error(i(151));for(var mi=Wr=null,gi=qt,Ai=qt=0,Ms=null,xo=un.next();gi!==null&&!xo.done;Ai++,xo=un.next()){gi.index>Ai?(Ms=gi,gi=null):Ms=gi.sibling;var Qh=jn(ln,gi,xo.value,rr);if(Qh===null){gi===null&&(gi=Ms);break}_&&gi&&Qh.alternate===null&&b(ln,gi),qt=me(Qh,qt,Ai),mi===null?Wr=Qh:mi.sibling=Qh,mi=Qh,gi=Ms}if(xo.done)return z(ln,gi),Co&&Jn(ln,Ai),Wr;if(gi===null){for(;!xo.done;Ai++,xo=un.next())xo=Wn(ln,xo.value,rr),xo!==null&&(qt=me(xo,qt,Ai),mi===null?Wr=xo:mi.sibling=xo,mi=xo);return Co&&Jn(ln,Ai),Wr}for(gi=G(ln,gi);!xo.done;Ai++,xo=un.next())xo=xr(gi,ln,Ai,xo.value,rr),xo!==null&&(_&&xo.alternate!==null&&gi.delete(xo.key===null?Ai:xo.key),qt=me(xo,qt,Ai),mi===null?Wr=xo:mi.sibling=xo,mi=xo);return _&&gi.forEach(function(Yg){return b(ln,Yg)}),Co&&Jn(ln,Ai),Wr}function qa(ln,qt,un,rr){if(typeof un=="object"&&un!==null&&un.type===Fe&&un.key===null&&(un=un.props.children),typeof un=="object"&&un!==null){switch(un.$$typeof){case ve:e:{for(var Wr=un.key,mi=qt;mi!==null;){if(mi.key===Wr){if(Wr=un.type,Wr===Fe){if(mi.tag===7){z(ln,mi.sibling),qt=oe(mi,un.props.children),qt.return=ln,ln=qt;break e}}else if(mi.elementType===Wr||typeof Wr=="object"&&Wr!==null&&Wr.$$typeof===Kt&&il(Wr)===mi.type){z(ln,mi.sibling),qt=oe(mi,un.props),qt.ref=fh(ln,mi,un),qt.return=ln,ln=qt;break e}z(ln,mi);break}else b(ln,mi);mi=mi.sibling}un.type===Fe?(qt=Kh(un.props.children,ln.mode,rr,un.key),qt.return=ln,ln=qt):(rr=gp(un.type,un.key,un.props,null,ln.mode,rr),rr.ref=fh(ln,qt,un),rr.return=ln,ln=rr)}return qe(ln);case Le:e:{for(mi=un.key;qt!==null;){if(qt.key===mi)if(qt.tag===4&&qt.stateNode.containerInfo===un.containerInfo&&qt.stateNode.implementation===un.implementation){z(ln,qt.sibling),qt=oe(qt,un.children||[]),qt.return=ln,ln=qt;break e}else{z(ln,qt);break}else b(ln,qt);qt=qt.sibling}qt=yp(un,ln.mode,rr),qt.return=ln,ln=qt}return qe(ln);case Kt:return mi=un._init,qa(ln,qt,mi(un._payload),rr)}if(Wi(un))return zr(ln,qt,un,rr);if(vt(un))return jr(ln,qt,un,rr);Sf(ln,un)}return typeof un=="string"&&un!==""||typeof un=="number"?(un=""+un,qt!==null&&qt.tag===6?(z(ln,qt.sibling),qt=oe(qt,un),qt.return=ln,ln=qt):(z(ln,qt),qt=bm(un,ln.mode,rr),qt.return=ln,ln=qt),qe(ln)):z(ln,qt)}return qa}var Xu=Po(!0),fd=Po(!1),Tf=Hu(null),Ef=null,dh=null,ip=null;function bc(){ip=dh=Ef=null}function wc(_){var b=Tf.current;Do(Tf),_._currentValue=b}function vn(_,b,z){for(;_!==null;){var G=_.alternate;if((_.childLanes&b)!==b?(_.childLanes|=b,G!==null&&(G.childLanes|=b)):G!==null&&(G.childLanes&b)!==b&&(G.childLanes|=b),_===z)break;_=_.return}}function tr(_,b){Ef=_,ip=dh=null,_=_.dependencies,_!==null&&_.firstContext!==null&&(_.lanes&b&&(As=!0),_.firstContext=null)}function ps(_){var b=_._currentValue;if(ip!==_)if(_={context:_,memoizedValue:b,next:null},dh===null){if(Ef===null)throw Error(i(308));dh=_,Ef.dependencies={lanes:0,firstContext:_}}else dh=dh.next=_;return b}var Ni=null;function Et(_){Ni===null?Ni=[_]:Ni.push(_)}function dd(_,b,z,G){var oe=b.interleaved;return oe===null?(z.next=z,Et(b)):(z.next=oe.next,oe.next=z),b.interleaved=z,Us(_,G)}function Us(_,b){_.lanes|=b;var z=_.alternate;for(z!==null&&(z.lanes|=b),z=_,_=_.return;_!==null;)_.childLanes|=b,z=_.alternate,z!==null&&(z.childLanes|=b),z=_,_=_.return;return z.tag===3?z.stateNode:null}var yu=!1;function Vh(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vu(_,b){_=_.updateQueue,b.updateQueue===_&&(b.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function Yl(_,b){return{eventTime:_,lane:b,tag:0,payload:null,callback:null,next:null}}function is(_,b,z){var G=_.updateQueue;if(G===null)return null;if(G=G.shared,fr&2){var oe=G.pending;return oe===null?b.next=b:(b.next=oe.next,oe.next=b),G.pending=b,Us(_,z)}return oe=G.interleaved,oe===null?(b.next=b,Et(G)):(b.next=oe.next,oe.next=b),G.interleaved=b,Us(_,z)}function pd(_,b,z){if(b=b.updateQueue,b!==null&&(b=b.shared,(z&4194240)!==0)){var G=b.lanes;G&=_.pendingLanes,z|=G,b.lanes=z,Cn(_,z)}}function um(_,b){var z=_.updateQueue,G=_.alternate;if(G!==null&&(G=G.updateQueue,z===G)){var oe=null,me=null;if(z=z.firstBaseUpdate,z!==null){do{var qe={eventTime:z.eventTime,lane:z.lane,tag:z.tag,payload:z.payload,callback:z.callback,next:null};me===null?oe=me=qe:me=me.next=qe,z=z.next}while(z!==null);me===null?oe=me=b:me=me.next=b}else oe=me=b;z={baseState:G.baseState,firstBaseUpdate:oe,lastBaseUpdate:me,shared:G.shared,effects:G.effects},_.updateQueue=z;return}_=z.lastBaseUpdate,_===null?z.firstBaseUpdate=b:_.next=b,z.lastBaseUpdate=b}function Af(_,b,z,G){var oe=_.updateQueue;yu=!1;var me=oe.firstBaseUpdate,qe=oe.lastBaseUpdate,bt=oe.shared.pending;if(bt!==null){oe.shared.pending=null;var Ft=bt,mn=Ft.next;Ft.next=null,qe===null?me=mn:qe.next=mn,qe=Ft;var Vn=_.alternate;Vn!==null&&(Vn=Vn.updateQueue,bt=Vn.lastBaseUpdate,bt!==qe&&(bt===null?Vn.firstBaseUpdate=mn:bt.next=mn,Vn.lastBaseUpdate=Ft))}if(me!==null){var Wn=oe.baseState;qe=0,Vn=mn=Ft=null,bt=me;do{var jn=bt.lane,xr=bt.eventTime;if((G&jn)===jn){Vn!==null&&(Vn=Vn.next={eventTime:xr,lane:0,tag:bt.tag,payload:bt.payload,callback:bt.callback,next:null});e:{var zr=_,jr=bt;switch(jn=b,xr=z,jr.tag){case 1:if(zr=jr.payload,typeof zr=="function"){Wn=zr.call(xr,Wn,jn);break e}Wn=zr;break e;case 3:zr.flags=zr.flags&-65537|128;case 0:if(zr=jr.payload,jn=typeof zr=="function"?zr.call(xr,Wn,jn):zr,jn==null)break e;Wn=Ot({},Wn,jn);break e;case 2:yu=!0}}bt.callback!==null&&bt.lane!==0&&(_.flags|=64,jn=oe.effects,jn===null?oe.effects=[bt]:jn.push(bt))}else xr={eventTime:xr,lane:jn,tag:bt.tag,payload:bt.payload,callback:bt.callback,next:null},Vn===null?(mn=Vn=xr,Ft=Wn):Vn=Vn.next=xr,qe|=jn;if(bt=bt.next,bt===null){if(bt=oe.shared.pending,bt===null)break;jn=bt,bt=jn.next,jn.next=null,oe.lastBaseUpdate=jn,oe.shared.pending=null}}while(!0);if(Vn===null&&(Ft=Wn),oe.baseState=Ft,oe.firstBaseUpdate=mn,oe.lastBaseUpdate=Vn,b=oe.shared.interleaved,b!==null){oe=b;do qe|=oe.lane,oe=oe.next;while(oe!==b)}else me===null&&(oe.shared.lanes=0);Ui|=qe,_.lanes=qe,_.memoizedState=Wn}}function Pf(_,b,z){if(_=b.effects,b.effects=null,_!==null)for(b=0;b<_.length;b++){var G=_[b],oe=G.callback;if(oe!==null){if(G.callback=null,G=z,typeof oe!="function")throw Error(i(191,oe));oe.call(G)}}}var ph={},Ml=Hu(ph),Sc=Hu(ph),Jl=Hu(ph);function Ql(_){if(_===ph)throw Error(i(174));return _}function qh(_,b){switch(Io(Jl,b),Io(Sc,_),Io(Ml,ph),_=b.nodeType,_){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:la(null,"");break;default:_=_===8?b.parentNode:b,b=_.namespaceURI||null,_=_.tagName,b=la(b,_)}Do(Ml),Io(Ml,b)}function mh(){Do(Ml),Do(Sc),Do(Jl)}function eu(_){Ql(Jl.current);var b=Ql(Ml.current),z=la(b,_.type);b!==z&&(Io(Sc,_),Io(Ml,z))}function ms(_){Sc.current===_&&(Do(Ml),Do(Sc))}var oa=Hu(0);function Tc(_){for(var b=_;b!==null;){if(b.tag===13){var z=b.memoizedState;if(z!==null&&(z=z.dehydrated,z===null||z.data==="$?"||z.data==="$!"))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if(b.flags&128)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===_)break;for(;b.sibling===null;){if(b.return===null||b.return===_)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var Ki=[];function Ti(){for(var _=0;_<Ki.length;_++)Ki[_]._workInProgressVersionPrimary=null;Ki.length=0}var Mf=De.ReactCurrentDispatcher,xu=De.ReactCurrentBatchConfig,bu=0,Oo=null,ka=null,Ta=null,Il=!1,Cl=!1,ml=0,md=0;function Ua(){throw Error(i(321))}function Ec(_,b){if(b===null)return!1;for(var z=0;z<b.length&&z<_.length;z++)if(!Ys(_[z],b[z]))return!1;return!0}function If(_,b,z,G,oe,me){if(bu=me,Oo=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,Mf.current=_===null||_.memoizedState===null?$o:dm,_=z(G,oe),Cl){me=0;do{if(Cl=!1,ml=0,25<=me)throw Error(i(301));me+=1,Ta=ka=null,b.updateQueue=null,Mf.current=$g,_=z(G,oe)}while(Cl)}if(Mf.current=wd,b=ka!==null&&ka.next!==null,bu=0,Ta=ka=Oo=null,Il=!1,b)throw Error(i(300));return _}function Cf(){var _=ml!==0;return ml=0,_}function gs(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ta===null?Oo.memoizedState=Ta=_:Ta=Ta.next=_,Ta}function ol(){if(ka===null){var _=Oo.alternate;_=_!==null?_.memoizedState:null}else _=ka.next;var b=Ta===null?Oo.memoizedState:Ta.next;if(b!==null)Ta=b,ka=_;else{if(_===null)throw Error(i(310));ka=_,_={memoizedState:ka.memoizedState,baseState:ka.baseState,baseQueue:ka.baseQueue,queue:ka.queue,next:null},Ta===null?Oo.memoizedState=Ta=_:Ta=Ta.next=_}return Ta}function Ac(_,b){return typeof b=="function"?b(_):b}function Pc(_){var b=ol(),z=b.queue;if(z===null)throw Error(i(311));z.lastRenderedReducer=_;var G=ka,oe=G.baseQueue,me=z.pending;if(me!==null){if(oe!==null){var qe=oe.next;oe.next=me.next,me.next=qe}G.baseQueue=oe=me,z.pending=null}if(oe!==null){me=oe.next,G=G.baseState;var bt=qe=null,Ft=null,mn=me;do{var Vn=mn.lane;if((bu&Vn)===Vn)Ft!==null&&(Ft=Ft.next={lane:0,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null}),G=mn.hasEagerState?mn.eagerState:_(G,mn.action);else{var Wn={lane:Vn,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null};Ft===null?(bt=Ft=Wn,qe=G):Ft=Ft.next=Wn,Oo.lanes|=Vn,Ui|=Vn}mn=mn.next}while(mn!==null&&mn!==me);Ft===null?qe=G:Ft.next=bt,Ys(G,b.memoizedState)||(As=!0),b.memoizedState=G,b.baseState=qe,b.baseQueue=Ft,z.lastRenderedState=G}if(_=z.interleaved,_!==null){oe=_;do me=oe.lane,Oo.lanes|=me,Ui|=me,oe=oe.next;while(oe!==_)}else oe===null&&(z.lanes=0);return[b.memoizedState,z.dispatch]}function Mc(_){var b=ol(),z=b.queue;if(z===null)throw Error(i(311));z.lastRenderedReducer=_;var G=z.dispatch,oe=z.pending,me=b.memoizedState;if(oe!==null){z.pending=null;var qe=oe=oe.next;do me=_(me,qe.action),qe=qe.next;while(qe!==oe);Ys(me,b.memoizedState)||(As=!0),b.memoizedState=me,b.baseQueue===null&&(b.baseState=me),z.lastRenderedState=me}return[me,G]}function po(){}function gh(_,b){var z=Oo,G=ol(),oe=b(),me=!Ys(G.memoizedState,oe);if(me&&(G.memoizedState=oe,As=!0),G=G.queue,Gh(Ic.bind(null,z,G,_),[_]),G.getSnapshot!==b||me||Ta!==null&&Ta.memoizedState.tag&1){if(z.flags|=2048,Ku(9,_h.bind(null,z,G,oe,b),void 0,null),hi===null)throw Error(i(349));bu&30||gd(z,b,oe)}return oe}function gd(_,b,z){_.flags|=16384,_={getSnapshot:b,value:z},b=Oo.updateQueue,b===null?(b={lastEffect:null,stores:null},Oo.updateQueue=b,b.stores=[_]):(z=b.stores,z===null?b.stores=[_]:z.push(_))}function _h(_,b,z,G){b.value=z,b.getSnapshot=G,_d(b)&&Of(_)}function Ic(_,b,z){return z(function(){_d(b)&&Of(_)})}function _d(_){var b=_.getSnapshot;_=_.value;try{var z=b();return!Ys(_,z)}catch{return!0}}function Of(_){var b=Us(_,1);b!==null&&pi(b,_,1,-1)}function op(_){var b=gs();return typeof _=="function"&&(_=_()),b.memoizedState=b.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:_},b.queue=_,_=_.dispatch=hm.bind(null,Oo,_),[b.memoizedState,_]}function Ku(_,b,z,G){return _={tag:_,create:b,destroy:z,deps:G,next:null},b=Oo.updateQueue,b===null?(b={lastEffect:null,stores:null},Oo.updateQueue=b,b.lastEffect=_.next=_):(z=b.lastEffect,z===null?b.lastEffect=_.next=_:(G=z.next,z.next=_,_.next=G,b.lastEffect=_)),_}function yd(){return ol().memoizedState}function Cc(_,b,z,G){var oe=gs();Oo.flags|=_,oe.memoizedState=Ku(1|b,z,void 0,G===void 0?null:G)}function Oc(_,b,z,G){var oe=ol();G=G===void 0?null:G;var me=void 0;if(ka!==null){var qe=ka.memoizedState;if(me=qe.destroy,G!==null&&Ec(G,qe.deps)){oe.memoizedState=Ku(b,z,me,G);return}}Oo.flags|=_,oe.memoizedState=Ku(1|b,z,me,G)}function kf(_,b){return Cc(8390656,8,_,b)}function Gh(_,b){return Oc(2048,8,_,b)}function Rf(_,b){return Oc(4,2,_,b)}function ap(_,b){return Oc(4,4,_,b)}function Lf(_,b){if(typeof b=="function")return _=_(),b(_),function(){b(null)};if(b!=null)return _=_(),b.current=_,function(){b.current=null}}function Hh(_,b,z){return z=z!=null?z.concat([_]):null,Oc(4,4,Lf.bind(null,b,_),z)}function Df(){}function sp(_,b){var z=ol();b=b===void 0?null:b;var G=z.memoizedState;return G!==null&&b!==null&&Ec(b,G[1])?G[0]:(z.memoizedState=[_,b],_)}function vd(_,b){var z=ol();b=b===void 0?null:b;var G=z.memoizedState;return G!==null&&b!==null&&Ec(b,G[1])?G[0]:(_=_(),z.memoizedState=[_,b],_)}function lp(_,b,z){return bu&21?(Ys(z,b)||(z=dt(),Oo.lanes|=z,Ui|=z,_.baseState=!0),b):(_.baseState&&(_.baseState=!1,As=!0),_.memoizedState=z)}function xd(_,b){var z=Gn;Gn=z!==0&&4>z?z:4,_(!0);var G=xu.transition;xu.transition={};try{_(!1),b()}finally{Gn=z,xu.transition=G}}function up(){return ol().memoizedState}function cm(_,b,z){var G=Ja(_);if(z={lane:G,action:z,hasEagerState:!1,eagerState:null,next:null},cp(_))bd(b,z);else if(z=dd(_,b,z,G),z!==null){var oe=ma();pi(z,_,G,oe),fm(z,b,G)}}function hm(_,b,z){var G=Ja(_),oe={lane:G,action:z,hasEagerState:!1,eagerState:null,next:null};if(cp(_))bd(b,oe);else{var me=_.alternate;if(_.lanes===0&&(me===null||me.lanes===0)&&(me=b.lastRenderedReducer,me!==null))try{var qe=b.lastRenderedState,bt=me(qe,z);if(oe.hasEagerState=!0,oe.eagerState=bt,Ys(bt,qe)){var Ft=b.interleaved;Ft===null?(oe.next=oe,Et(b)):(oe.next=Ft.next,Ft.next=oe),b.interleaved=oe;return}}catch{}finally{}z=dd(_,b,oe,G),z!==null&&(oe=ma(),pi(z,_,G,oe),fm(z,b,G))}}function cp(_){var b=_.alternate;return _===Oo||b!==null&&b===Oo}function bd(_,b){Cl=Il=!0;var z=_.pending;z===null?b.next=b:(b.next=z.next,z.next=b),_.pending=b}function fm(_,b,z){if(z&4194240){var G=b.lanes;G&=_.pendingLanes,z|=G,b.lanes=z,Cn(_,z)}}var wd={readContext:ps,useCallback:Ua,useContext:Ua,useEffect:Ua,useImperativeHandle:Ua,useInsertionEffect:Ua,useLayoutEffect:Ua,useMemo:Ua,useReducer:Ua,useRef:Ua,useState:Ua,useDebugValue:Ua,useDeferredValue:Ua,useTransition:Ua,useMutableSource:Ua,useSyncExternalStore:Ua,useId:Ua,unstable_isNewReconciler:!1},$o={readContext:ps,useCallback:function(_,b){return gs().memoizedState=[_,b===void 0?null:b],_},useContext:ps,useEffect:kf,useImperativeHandle:function(_,b,z){return z=z!=null?z.concat([_]):null,Cc(4194308,4,Lf.bind(null,b,_),z)},useLayoutEffect:function(_,b){return Cc(4194308,4,_,b)},useInsertionEffect:function(_,b){return Cc(4,2,_,b)},useMemo:function(_,b){var z=gs();return b=b===void 0?null:b,_=_(),z.memoizedState=[_,b],_},useReducer:function(_,b,z){var G=gs();return b=z!==void 0?z(b):b,G.memoizedState=G.baseState=b,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:b},G.queue=_,_=_.dispatch=cm.bind(null,Oo,_),[G.memoizedState,_]},useRef:function(_){var b=gs();return _={current:_},b.memoizedState=_},useState:op,useDebugValue:Df,useDeferredValue:function(_){return gs().memoizedState=_},useTransition:function(){var _=op(!1),b=_[0];return _=xd.bind(null,_[1]),gs().memoizedState=_,[b,_]},useMutableSource:function(){},useSyncExternalStore:function(_,b,z){var G=Oo,oe=gs();if(Co){if(z===void 0)throw Error(i(407));z=z()}else{if(z=b(),hi===null)throw Error(i(349));bu&30||gd(G,b,z)}oe.memoizedState=z;var me={value:z,getSnapshot:b};return oe.queue=me,kf(Ic.bind(null,G,me,_),[_]),G.flags|=2048,Ku(9,_h.bind(null,G,me,z,b),void 0,null),z},useId:function(){var _=gs(),b=hi.identifierPrefix;if(Co){var z=Sa,G=js;z=(G&~(1<<32-Xn(G)-1)).toString(32)+z,b=":"+b+"R"+z,z=ml++,0<z&&(b+="H"+z.toString(32)),b+=":"}else z=md++,b=":"+b+"r"+z.toString(32)+":";return _.memoizedState=b},unstable_isNewReconciler:!1},dm={readContext:ps,useCallback:sp,useContext:ps,useEffect:Gh,useImperativeHandle:Hh,useInsertionEffect:Rf,useLayoutEffect:ap,useMemo:vd,useReducer:Pc,useRef:yd,useState:function(){return Pc(Ac)},useDebugValue:Df,useDeferredValue:function(_){var b=ol();return lp(b,ka.memoizedState,_)},useTransition:function(){var _=Pc(Ac)[0],b=ol().memoizedState;return[_,b]},useMutableSource:po,useSyncExternalStore:gh,useId:up,unstable_isNewReconciler:!1},$g={readContext:ps,useCallback:sp,useContext:ps,useEffect:Gh,useImperativeHandle:Hh,useInsertionEffect:Rf,useLayoutEffect:ap,useMemo:vd,useReducer:Mc,useRef:yd,useState:function(){return Mc(Ac)},useDebugValue:Df,useDeferredValue:function(_){var b=ol();return ka===null?b.memoizedState=_:lp(b,ka.memoizedState,_)},useTransition:function(){var _=Mc(Ac)[0],b=ol().memoizedState;return[_,b]},useMutableSource:po,useSyncExternalStore:gh,useId:up,unstable_isNewReconciler:!1};function tu(_,b){if(_&&_.defaultProps){b=Ot({},b),_=_.defaultProps;for(var z in _)b[z]===void 0&&(b[z]=_[z]);return b}return b}function yh(_,b,z,G){b=_.memoizedState,z=z(G,b),z=z==null?b:Ot({},b,z),_.memoizedState=z,_.lanes===0&&(_.updateQueue.baseState=z)}var zf={isMounted:function(_){return(_=_._reactInternals)?Vt(_)===_:!1},enqueueSetState:function(_,b,z){_=_._reactInternals;var G=ma(),oe=Ja(_),me=Yl(G,oe);me.payload=b,z!=null&&(me.callback=z),b=is(_,me,oe),b!==null&&(pi(b,_,oe,G),pd(b,_,oe))},enqueueReplaceState:function(_,b,z){_=_._reactInternals;var G=ma(),oe=Ja(_),me=Yl(G,oe);me.tag=1,me.payload=b,z!=null&&(me.callback=z),b=is(_,me,oe),b!==null&&(pi(b,_,oe,G),pd(b,_,oe))},enqueueForceUpdate:function(_,b){_=_._reactInternals;var z=ma(),G=Ja(_),oe=Yl(z,G);oe.tag=2,b!=null&&(oe.callback=b),b=is(_,oe,G),b!==null&&(pi(b,_,G,z),pd(b,_,G))}};function vh(_,b,z,G,oe,me,qe){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(G,me,qe):b.prototype&&b.prototype.isPureReactComponent?!Sl(z,G)||!Sl(oe,me):!0}function Ff(_,b,z){var G=!1,oe=mu,me=b.contextType;return typeof me=="object"&&me!==null?me=ps(me):(oe=nl(b)?Kl:ds.current,G=b.contextTypes,me=(G=G!=null)?$h(_,oe):mu),b=new b(z,me),_.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=zf,_.stateNode=b,b._reactInternals=_,G&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=oe,_.__reactInternalMemoizedMaskedChildContext=me),b}function wu(_,b,z,G){_=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(z,G),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(z,G),b.state!==_&&zf.enqueueReplaceState(b,b.state,null)}function Yu(_,b,z,G){var oe=_.stateNode;oe.props=z,oe.state=_.memoizedState,oe.refs={},Vh(_);var me=b.contextType;typeof me=="object"&&me!==null?oe.context=ps(me):(me=nl(b)?Kl:ds.current,oe.context=$h(_,me)),oe.state=_.memoizedState,me=b.getDerivedStateFromProps,typeof me=="function"&&(yh(_,b,me,z),oe.state=_.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof oe.getSnapshotBeforeUpdate=="function"||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(b=oe.state,typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount(),b!==oe.state&&zf.enqueueReplaceState(oe,oe.state,null),Af(_,z,oe,G),oe.state=_.memoizedState),typeof oe.componentDidMount=="function"&&(_.flags|=4194308)}function Uo(_,b){try{var z="",G=b;do z+=$n(G),G=G.return;while(G);var oe=z}catch(me){oe=`
Error generating stack: `+me.message+`
`+me.stack}return{value:_,source:b,stack:oe,digest:null}}function Ol(_,b,z){return{value:_,source:null,stack:z??null,digest:b??null}}function Bf(_,b){try{console.error(b.value)}catch(z){setTimeout(function(){throw z})}}var Sd=typeof WeakMap=="function"?WeakMap:Map;function Td(_,b,z){z=Yl(-1,z),z.tag=3,z.payload={element:null};var G=b.value;return z.callback=function(){Vi||(Vi=!0,ko=G),Bf(_,b)},z}function hp(_,b,z){z=Yl(-1,z),z.tag=3;var G=_.type.getDerivedStateFromError;if(typeof G=="function"){var oe=b.value;z.payload=function(){return G(oe)},z.callback=function(){Bf(_,b)}}var me=_.stateNode;return me!==null&&typeof me.componentDidCatch=="function"&&(z.callback=function(){Bf(_,b),typeof G!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var qe=b.stack;this.componentDidCatch(b.value,{componentStack:qe!==null?qe:""})}),z}function Wh(_,b,z){var G=_.pingCache;if(G===null){G=_.pingCache=new Sd;var oe=new Set;G.set(b,oe)}else oe=G.get(b),oe===void 0&&(oe=new Set,G.set(b,oe));oe.has(z)||(oe.add(z),_=h1.bind(null,_,b,z),b.then(_,_))}function pm(_){do{var b;if((b=_.tag===13)&&(b=_.memoizedState,b=b!==null?b.dehydrated!==null:!0),b)return _;_=_.return}while(_!==null);return null}function fp(_,b,z,G,oe){return _.mode&1?(_.flags|=65536,_.lanes=oe,_):(_===b?_.flags|=65536:(_.flags|=128,z.flags|=131072,z.flags&=-52805,z.tag===1&&(z.alternate===null?z.tag=17:(b=Yl(-1,1),b.tag=2,is(z,b,1))),z.lanes|=1),_)}var Ed=De.ReactCurrentOwner,As=!1;function Ka(_,b,z,G){b.child=_===null?fd(b,null,z,G):Xu(b,_.child,z,G)}function xh(_,b,z,G,oe){z=z.render;var me=b.ref;return tr(b,oe),G=If(_,b,z,G,me,oe),z=Cf(),_!==null&&!As?(b.updateQueue=_.updateQueue,b.flags&=-2053,_.lanes&=~oe,F(_,b,oe)):(Co&&z&&cd(b),b.flags|=1,Ka(_,b,G,oe),b.child)}function Su(_,b,z,G,oe){if(_===null){var me=z.type;return typeof me=="function"&&!xm(me)&&me.defaultProps===void 0&&z.compare===null&&z.defaultProps===void 0?(b.tag=15,b.type=me,kl(_,b,me,G,oe)):(_=gp(z.type,null,G,b,b.mode,oe),_.ref=b.ref,_.return=b,b.child=_)}if(me=_.child,!(_.lanes&oe)){var qe=me.memoizedProps;if(z=z.compare,z=z!==null?z:Sl,z(qe,G)&&_.ref===b.ref)return F(_,b,oe)}return b.flags|=1,_=wh(me,G),_.ref=b.ref,_.return=b,b.child=_}function kl(_,b,z,G,oe){if(_!==null){var me=_.memoizedProps;if(Sl(me,G)&&_.ref===b.ref)if(As=!1,b.pendingProps=G=me,(_.lanes&oe)!==0)_.flags&131072&&(As=!0);else return b.lanes=_.lanes,F(_,b,oe)}return Rl(_,b,z,G,oe)}function Tu(_,b,z){var G=b.pendingProps,oe=G.children,me=_!==null?_.memoizedState:null;if(G.mode==="hidden")if(!(b.mode&1))b.memoizedState={baseLanes:0,cachePool:null,transitions:null},Io(Li,Rr),Rr|=z;else{if(!(z&1073741824))return _=me!==null?me.baseLanes|z:z,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:_,cachePool:null,transitions:null},b.updateQueue=null,Io(Li,Rr),Rr|=_,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null},G=me!==null?me.baseLanes:z,Io(Li,Rr),Rr|=G}else me!==null?(G=me.baseLanes|z,b.memoizedState=null):G=z,Io(Li,Rr),Rr|=G;return Ka(_,b,oe,z),b.child}function Eu(_,b){var z=b.ref;(_===null&&z!==null||_!==null&&_.ref!==z)&&(b.flags|=512,b.flags|=2097152)}function Rl(_,b,z,G,oe){var me=nl(z)?Kl:ds.current;return me=$h(b,me),tr(b,oe),z=If(_,b,z,G,me,oe),G=Cf(),_!==null&&!As?(b.updateQueue=_.updateQueue,b.flags&=-2053,_.lanes&=~oe,F(_,b,oe)):(Co&&G&&cd(b),b.flags|=1,Ka(_,b,z,oe),b.child)}function mm(_,b,z,G,oe){if(nl(z)){var me=!0;ah(b)}else me=!1;if(tr(b,oe),b.stateNode===null)A(_,b),Ff(b,z,G),Yu(b,z,G,oe),G=!0;else if(_===null){var qe=b.stateNode,bt=b.memoizedProps;qe.props=bt;var Ft=qe.context,mn=z.contextType;typeof mn=="object"&&mn!==null?mn=ps(mn):(mn=nl(z)?Kl:ds.current,mn=$h(b,mn));var Vn=z.getDerivedStateFromProps,Wn=typeof Vn=="function"||typeof qe.getSnapshotBeforeUpdate=="function";Wn||typeof qe.UNSAFE_componentWillReceiveProps!="function"&&typeof qe.componentWillReceiveProps!="function"||(bt!==G||Ft!==mn)&&wu(b,qe,G,mn),yu=!1;var jn=b.memoizedState;qe.state=jn,Af(b,G,qe,oe),Ft=b.memoizedState,bt!==G||jn!==Ft||Es.current||yu?(typeof Vn=="function"&&(yh(b,z,Vn,G),Ft=b.memoizedState),(bt=yu||vh(b,z,bt,G,jn,Ft,mn))?(Wn||typeof qe.UNSAFE_componentWillMount!="function"&&typeof qe.componentWillMount!="function"||(typeof qe.componentWillMount=="function"&&qe.componentWillMount(),typeof qe.UNSAFE_componentWillMount=="function"&&qe.UNSAFE_componentWillMount()),typeof qe.componentDidMount=="function"&&(b.flags|=4194308)):(typeof qe.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=G,b.memoizedState=Ft),qe.props=G,qe.state=Ft,qe.context=mn,G=bt):(typeof qe.componentDidMount=="function"&&(b.flags|=4194308),G=!1)}else{qe=b.stateNode,vu(_,b),bt=b.memoizedProps,mn=b.type===b.elementType?bt:tu(b.type,bt),qe.props=mn,Wn=b.pendingProps,jn=qe.context,Ft=z.contextType,typeof Ft=="object"&&Ft!==null?Ft=ps(Ft):(Ft=nl(z)?Kl:ds.current,Ft=$h(b,Ft));var xr=z.getDerivedStateFromProps;(Vn=typeof xr=="function"||typeof qe.getSnapshotBeforeUpdate=="function")||typeof qe.UNSAFE_componentWillReceiveProps!="function"&&typeof qe.componentWillReceiveProps!="function"||(bt!==Wn||jn!==Ft)&&wu(b,qe,G,Ft),yu=!1,jn=b.memoizedState,qe.state=jn,Af(b,G,qe,oe);var zr=b.memoizedState;bt!==Wn||jn!==zr||Es.current||yu?(typeof xr=="function"&&(yh(b,z,xr,G),zr=b.memoizedState),(mn=yu||vh(b,z,mn,G,jn,zr,Ft)||!1)?(Vn||typeof qe.UNSAFE_componentWillUpdate!="function"&&typeof qe.componentWillUpdate!="function"||(typeof qe.componentWillUpdate=="function"&&qe.componentWillUpdate(G,zr,Ft),typeof qe.UNSAFE_componentWillUpdate=="function"&&qe.UNSAFE_componentWillUpdate(G,zr,Ft)),typeof qe.componentDidUpdate=="function"&&(b.flags|=4),typeof qe.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof qe.componentDidUpdate!="function"||bt===_.memoizedProps&&jn===_.memoizedState||(b.flags|=4),typeof qe.getSnapshotBeforeUpdate!="function"||bt===_.memoizedProps&&jn===_.memoizedState||(b.flags|=1024),b.memoizedProps=G,b.memoizedState=zr),qe.props=G,qe.state=zr,qe.context=Ft,G=mn):(typeof qe.componentDidUpdate!="function"||bt===_.memoizedProps&&jn===_.memoizedState||(b.flags|=4),typeof qe.getSnapshotBeforeUpdate!="function"||bt===_.memoizedProps&&jn===_.memoizedState||(b.flags|=1024),G=!1)}return dp(_,b,z,G,me,oe)}function dp(_,b,z,G,oe,me){Eu(_,b);var qe=(b.flags&128)!==0;if(!G&&!qe)return oe&&sh(b,z,!1),F(_,b,me);G=b.stateNode,Ed.current=b;var bt=qe&&typeof z.getDerivedStateFromError!="function"?null:G.render();return b.flags|=1,_!==null&&qe?(b.child=Xu(b,_.child,null,me),b.child=Xu(b,null,bt,me)):Ka(_,b,bt,me),b.memoizedState=G.state,oe&&sh(b,z,!0),b.child}function gm(_){var b=_.stateNode;b.pendingContext?sm(_,b.pendingContext,b.pendingContext!==b.context):b.context&&sm(_,b.context,!1),qh(_,b.containerInfo)}function _m(_,b,z,G,oe){return hh(),wf(oe),b.flags|=256,Ka(_,b,z,G),b.child}var Ad={dehydrated:null,treeContext:null,retryLane:0};function Ya(_){return{baseLanes:_,cachePool:null,transitions:null}}function pp(_,b,z){var G=b.pendingProps,oe=oa.current,me=!1,qe=(b.flags&128)!==0,bt;if((bt=qe)||(bt=_!==null&&_.memoizedState===null?!1:(oe&2)!==0),bt?(me=!0,b.flags&=-129):(_===null||_.memoizedState!==null)&&(oe|=1),Io(oa,oe&1),_===null)return ch(b),_=b.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?(b.mode&1?_.data==="$!"?b.lanes=8:b.lanes=1073741824:b.lanes=1,null):(qe=G.children,_=G.fallback,me?(G=b.mode,me=b.child,qe={mode:"hidden",children:qe},!(G&1)&&me!==null?(me.childLanes=0,me.pendingProps=qe):me=_p(qe,G,0,null),_=Kh(_,G,z,null),me.return=b,_.return=b,me.sibling=_,b.child=me,b.child.memoizedState=Ya(z),b.memoizedState=Ad,_):d(b,qe));if(oe=_.memoizedState,oe!==null&&(bt=oe.dehydrated,bt!==null))return l(_,b,qe,G,bt,oe,z);if(me){me=G.fallback,qe=b.mode,oe=_.child,bt=oe.sibling;var Ft={mode:"hidden",children:G.children};return!(qe&1)&&b.child!==oe?(G=b.child,G.childLanes=0,G.pendingProps=Ft,b.deletions=null):(G=wh(oe,Ft),G.subtreeFlags=oe.subtreeFlags&14680064),bt!==null?me=wh(bt,me):(me=Kh(me,qe,z,null),me.flags|=2),me.return=b,G.return=b,G.sibling=me,b.child=G,G=me,me=b.child,qe=_.child.memoizedState,qe=qe===null?Ya(z):{baseLanes:qe.baseLanes|z,cachePool:null,transitions:qe.transitions},me.memoizedState=qe,me.childLanes=_.childLanes&~z,b.memoizedState=Ad,G}return me=_.child,_=me.sibling,G=wh(me,{mode:"visible",children:G.children}),!(b.mode&1)&&(G.lanes=z),G.return=b,G.sibling=null,_!==null&&(z=b.deletions,z===null?(b.deletions=[_],b.flags|=16):z.push(_)),b.child=G,b.memoizedState=null,G}function d(_,b){return b=_p({mode:"visible",children:b},_.mode,0,null),b.return=_,_.child=b}function r(_,b,z,G){return G!==null&&wf(G),Xu(b,_.child,null,z),_=d(b,b.pendingProps.children),_.flags|=2,b.memoizedState=null,_}function l(_,b,z,G,oe,me,qe){if(z)return b.flags&256?(b.flags&=-257,G=Ol(Error(i(422))),r(_,b,qe,G)):b.memoizedState!==null?(b.child=_.child,b.flags|=128,null):(me=G.fallback,oe=b.mode,G=_p({mode:"visible",children:G.children},oe,0,null),me=Kh(me,oe,qe,null),me.flags|=2,G.return=b,me.return=b,G.sibling=me,b.child=G,b.mode&1&&Xu(b,_.child,null,qe),b.child.memoizedState=Ya(qe),b.memoizedState=Ad,me);if(!(b.mode&1))return r(_,b,qe,null);if(oe.data==="$!"){if(G=oe.nextSibling&&oe.nextSibling.dataset,G)var bt=G.dgst;return G=bt,me=Error(i(419)),G=Ol(me,G,void 0),r(_,b,qe,G)}if(bt=(qe&_.childLanes)!==0,As||bt){if(G=hi,G!==null){switch(qe&-qe){case 4:oe=2;break;case 16:oe=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:oe=32;break;case 536870912:oe=268435456;break;default:oe=0}oe=oe&(G.suspendedLanes|qe)?0:oe,oe!==0&&oe!==me.retryLane&&(me.retryLane=oe,Us(_,oe),pi(G,_,oe,-1))}return vm(),G=Ol(Error(i(421))),r(_,b,qe,G)}return oe.data==="$?"?(b.flags|=128,b.child=_.child,b=tv.bind(null,_),oe._reactRetry=b,null):(_=me.treeContext,$s=Hl(oe.nextSibling),rs=b,Co=!0,Pl=null,_!==null&&(kn[Ns++]=js,kn[Ns++]=Sa,kn[Ns++]=Zu,js=_.id,Sa=_.overflow,Zu=b),b=d(b,G.children),b.flags|=4096,b)}function p(_,b,z){_.lanes|=b;var G=_.alternate;G!==null&&(G.lanes|=b),vn(_.return,b,z)}function x(_,b,z,G,oe){var me=_.memoizedState;me===null?_.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:G,tail:z,tailMode:oe}:(me.isBackwards=b,me.rendering=null,me.renderingStartTime=0,me.last=G,me.tail=z,me.tailMode=oe)}function T(_,b,z){var G=b.pendingProps,oe=G.revealOrder,me=G.tail;if(Ka(_,b,G.children,z),G=oa.current,G&2)G=G&1|2,b.flags|=128;else{if(_!==null&&_.flags&128)e:for(_=b.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&p(_,z,b);else if(_.tag===19)p(_,z,b);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===b)break e;for(;_.sibling===null;){if(_.return===null||_.return===b)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}G&=1}if(Io(oa,G),!(b.mode&1))b.memoizedState=null;else switch(oe){case"forwards":for(z=b.child,oe=null;z!==null;)_=z.alternate,_!==null&&Tc(_)===null&&(oe=z),z=z.sibling;z=oe,z===null?(oe=b.child,b.child=null):(oe=z.sibling,z.sibling=null),x(b,!1,oe,z,me);break;case"backwards":for(z=null,oe=b.child,b.child=null;oe!==null;){if(_=oe.alternate,_!==null&&Tc(_)===null){b.child=oe;break}_=oe.sibling,oe.sibling=z,z=oe,oe=_}x(b,!0,z,null,me);break;case"together":x(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function A(_,b){!(b.mode&1)&&_!==null&&(_.alternate=null,b.alternate=null,b.flags|=2)}function F(_,b,z){if(_!==null&&(b.dependencies=_.dependencies),Ui|=b.lanes,!(z&b.childLanes))return null;if(_!==null&&b.child!==_.child)throw Error(i(153));if(b.child!==null){for(_=b.child,z=wh(_,_.pendingProps),b.child=z,z.return=b;_.sibling!==null;)_=_.sibling,z=z.sibling=wh(_,_.pendingProps),z.return=b;z.sibling=null}return b.child}function j(_,b,z){switch(b.tag){case 3:gm(b),hh();break;case 5:eu(b);break;case 1:nl(b.type)&&ah(b);break;case 4:qh(b,b.stateNode.containerInfo);break;case 10:var G=b.type._context,oe=b.memoizedProps.value;Io(Tf,G._currentValue),G._currentValue=oe;break;case 13:if(G=b.memoizedState,G!==null)return G.dehydrated!==null?(Io(oa,oa.current&1),b.flags|=128,null):z&b.child.childLanes?pp(_,b,z):(Io(oa,oa.current&1),_=F(_,b,z),_!==null?_.sibling:null);Io(oa,oa.current&1);break;case 19:if(G=(z&b.childLanes)!==0,_.flags&128){if(G)return T(_,b,z);b.flags|=128}if(oe=b.memoizedState,oe!==null&&(oe.rendering=null,oe.tail=null,oe.lastEffect=null),Io(oa,oa.current),G)break;return null;case 22:case 23:return b.lanes=0,Tu(_,b,z)}return F(_,b,z)}var H,q,Y,Q;H=function(_,b){for(var z=b.child;z!==null;){if(z.tag===5||z.tag===6)_.appendChild(z.stateNode);else if(z.tag!==4&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===b)break;for(;z.sibling===null;){if(z.return===null||z.return===b)return;z=z.return}z.sibling.return=z.return,z=z.sibling}},q=function(){},Y=function(_,b,z,G){var oe=_.memoizedProps;if(oe!==G){_=b.stateNode,Ql(Ml.current);var me=null;switch(z){case"input":oe=Yt(_,oe),G=Yt(_,G),me=[];break;case"select":oe=Ot({},oe,{value:void 0}),G=Ot({},G,{value:void 0}),me=[];break;case"textarea":oe=Pi(_,oe),G=Pi(_,G),me=[];break;default:typeof oe.onClick!="function"&&typeof G.onClick=="function"&&(_.onclick=Rn)}Go(z,G);var qe;z=null;for(mn in oe)if(!G.hasOwnProperty(mn)&&oe.hasOwnProperty(mn)&&oe[mn]!=null)if(mn==="style"){var bt=oe[mn];for(qe in bt)bt.hasOwnProperty(qe)&&(z||(z={}),z[qe]="")}else mn!=="dangerouslySetInnerHTML"&&mn!=="children"&&mn!=="suppressContentEditableWarning"&&mn!=="suppressHydrationWarning"&&mn!=="autoFocus"&&(h.hasOwnProperty(mn)?me||(me=[]):(me=me||[]).push(mn,null));for(mn in G){var Ft=G[mn];if(bt=oe!=null?oe[mn]:void 0,G.hasOwnProperty(mn)&&Ft!==bt&&(Ft!=null||bt!=null))if(mn==="style")if(bt){for(qe in bt)!bt.hasOwnProperty(qe)||Ft&&Ft.hasOwnProperty(qe)||(z||(z={}),z[qe]="");for(qe in Ft)Ft.hasOwnProperty(qe)&&bt[qe]!==Ft[qe]&&(z||(z={}),z[qe]=Ft[qe])}else z||(me||(me=[]),me.push(mn,z)),z=Ft;else mn==="dangerouslySetInnerHTML"?(Ft=Ft?Ft.__html:void 0,bt=bt?bt.__html:void 0,Ft!=null&&bt!==Ft&&(me=me||[]).push(mn,Ft)):mn==="children"?typeof Ft!="string"&&typeof Ft!="number"||(me=me||[]).push(mn,""+Ft):mn!=="suppressContentEditableWarning"&&mn!=="suppressHydrationWarning"&&(h.hasOwnProperty(mn)?(Ft!=null&&mn==="onScroll"&&vo("scroll",_),me||bt===Ft||(me=[])):(me=me||[]).push(mn,Ft))}z&&(me=me||[]).push("style",z);var mn=me;(b.updateQueue=mn)&&(b.flags|=4)}},Q=function(_,b,z,G){z!==G&&(b.flags|=4)};function ae(_,b){if(!Co)switch(_.tailMode){case"hidden":b=_.tail;for(var z=null;b!==null;)b.alternate!==null&&(z=b),b=b.sibling;z===null?_.tail=null:z.sibling=null;break;case"collapsed":z=_.tail;for(var G=null;z!==null;)z.alternate!==null&&(G=z),z=z.sibling;G===null?b||_.tail===null?_.tail=null:_.tail.sibling=null:G.sibling=null}}function ge(_){var b=_.alternate!==null&&_.alternate.child===_.child,z=0,G=0;if(b)for(var oe=_.child;oe!==null;)z|=oe.lanes|oe.childLanes,G|=oe.subtreeFlags&14680064,G|=oe.flags&14680064,oe.return=_,oe=oe.sibling;else for(oe=_.child;oe!==null;)z|=oe.lanes|oe.childLanes,G|=oe.subtreeFlags,G|=oe.flags,oe.return=_,oe=oe.sibling;return _.subtreeFlags|=G,_.childLanes=z,b}function _e(_,b,z){var G=b.pendingProps;switch(np(b),b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ge(b),null;case 1:return nl(b.type)&&Uh(),ge(b),null;case 3:return G=b.stateNode,mh(),Do(Es),Do(ds),Ti(),G.pendingContext&&(G.context=G.pendingContext,G.pendingContext=null),(_===null||_.child===null)&&($a(b)?b.flags|=4:_===null||_.memoizedState.isDehydrated&&!(b.flags&256)||(b.flags|=1024,Pl!==null&&(Nf(Pl),Pl=null))),q(_,b),ge(b),null;case 5:ms(b);var oe=Ql(Jl.current);if(z=b.type,_!==null&&b.stateNode!=null)Y(_,b,z,G,oe),_.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!G){if(b.stateNode===null)throw Error(i(166));return ge(b),null}if(_=Ql(Ml.current),$a(b)){G=b.stateNode,z=b.type;var me=b.memoizedProps;switch(G[Ts]=b,G[Zl]=me,_=(b.mode&1)!==0,z){case"dialog":vo("cancel",G),vo("close",G);break;case"iframe":case"object":case"embed":vo("load",G);break;case"video":case"audio":for(oe=0;oe<pc.length;oe++)vo(pc[oe],G);break;case"source":vo("error",G);break;case"img":case"image":case"link":vo("error",G),vo("load",G);break;case"details":vo("toggle",G);break;case"input":Mr(G,me),vo("invalid",G);break;case"select":G._wrapperState={wasMultiple:!!me.multiple},vo("invalid",G);break;case"textarea":yi(G,me),vo("invalid",G)}Go(z,me),oe=null;for(var qe in me)if(me.hasOwnProperty(qe)){var bt=me[qe];qe==="children"?typeof bt=="string"?G.textContent!==bt&&(me.suppressHydrationWarning!==!0&&dn(G.textContent,bt,_),oe=["children",bt]):typeof bt=="number"&&G.textContent!==""+bt&&(me.suppressHydrationWarning!==!0&&dn(G.textContent,bt,_),oe=["children",""+bt]):h.hasOwnProperty(qe)&&bt!=null&&qe==="onScroll"&&vo("scroll",G)}switch(z){case"input":mr(G),sr(G,me,!0);break;case"textarea":mr(G),qo(G);break;case"select":case"option":break;default:typeof me.onClick=="function"&&(G.onclick=Rn)}G=oe,b.updateQueue=G,G!==null&&(b.flags|=4)}else{qe=oe.nodeType===9?oe:oe.ownerDocument,_==="http://www.w3.org/1999/xhtml"&&(_=ea(z)),_==="http://www.w3.org/1999/xhtml"?z==="script"?(_=qe.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild)):typeof G.is=="string"?_=qe.createElement(z,{is:G.is}):(_=qe.createElement(z),z==="select"&&(qe=_,G.multiple?qe.multiple=!0:G.size&&(qe.size=G.size))):_=qe.createElementNS(_,z),_[Ts]=b,_[Zl]=G,H(_,b,!1,!1),b.stateNode=_;e:{switch(qe=Fa(z,G),z){case"dialog":vo("cancel",_),vo("close",_),oe=G;break;case"iframe":case"object":case"embed":vo("load",_),oe=G;break;case"video":case"audio":for(oe=0;oe<pc.length;oe++)vo(pc[oe],_);oe=G;break;case"source":vo("error",_),oe=G;break;case"img":case"image":case"link":vo("error",_),vo("load",_),oe=G;break;case"details":vo("toggle",_),oe=G;break;case"input":Mr(_,G),oe=Yt(_,G),vo("invalid",_);break;case"option":oe=G;break;case"select":_._wrapperState={wasMultiple:!!G.multiple},oe=Ot({},G,{value:void 0}),vo("invalid",_);break;case"textarea":yi(_,G),oe=Pi(_,G),vo("invalid",_);break;default:oe=G}Go(z,oe),bt=oe;for(me in bt)if(bt.hasOwnProperty(me)){var Ft=bt[me];me==="style"?Lo(_,Ft):me==="dangerouslySetInnerHTML"?(Ft=Ft?Ft.__html:void 0,Ft!=null&&Mo(_,Ft)):me==="children"?typeof Ft=="string"?(z!=="textarea"||Ft!=="")&&ta(_,Ft):typeof Ft=="number"&&ta(_,""+Ft):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(h.hasOwnProperty(me)?Ft!=null&&me==="onScroll"&&vo("scroll",_):Ft!=null&&Re(_,me,Ft,qe))}switch(z){case"input":mr(_),sr(_,G,!1);break;case"textarea":mr(_),qo(_);break;case"option":G.value!=null&&_.setAttribute("value",""+_r(G.value));break;case"select":_.multiple=!!G.multiple,me=G.value,me!=null?ii(_,!!G.multiple,me,!1):G.defaultValue!=null&&ii(_,!!G.multiple,G.defaultValue,!0);break;default:typeof oe.onClick=="function"&&(_.onclick=Rn)}switch(z){case"button":case"input":case"select":case"textarea":G=!!G.autoFocus;break e;case"img":G=!0;break e;default:G=!1}}G&&(b.flags|=4)}b.ref!==null&&(b.flags|=512,b.flags|=2097152)}return ge(b),null;case 6:if(_&&b.stateNode!=null)Q(_,b,_.memoizedProps,G);else{if(typeof G!="string"&&b.stateNode===null)throw Error(i(166));if(z=Ql(Jl.current),Ql(Ml.current),$a(b)){if(G=b.stateNode,z=b.memoizedProps,G[Ts]=b,(me=G.nodeValue!==z)&&(_=rs,_!==null))switch(_.tag){case 3:dn(G.nodeValue,z,(_.mode&1)!==0);break;case 5:_.memoizedProps.suppressHydrationWarning!==!0&&dn(G.nodeValue,z,(_.mode&1)!==0)}me&&(b.flags|=4)}else G=(z.nodeType===9?z:z.ownerDocument).createTextNode(G),G[Ts]=b,b.stateNode=G}return ge(b),null;case 13:if(Do(oa),G=b.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(Co&&$s!==null&&b.mode&1&&!(b.flags&128))rl(),hh(),b.flags|=98560,me=!1;else if(me=$a(b),G!==null&&G.dehydrated!==null){if(_===null){if(!me)throw Error(i(318));if(me=b.memoizedState,me=me!==null?me.dehydrated:null,!me)throw Error(i(317));me[Ts]=b}else hh(),!(b.flags&128)&&(b.memoizedState=null),b.flags|=4;ge(b),me=!1}else Pl!==null&&(Nf(Pl),Pl=null),me=!0;if(!me)return b.flags&65536?b:null}return b.flags&128?(b.lanes=z,b):(G=G!==null,G!==(_!==null&&_.memoizedState!==null)&&G&&(b.child.flags|=8192,b.mode&1&&(_===null||oa.current&1?Qr===0&&(Qr=3):vm())),b.updateQueue!==null&&(b.flags|=4),ge(b),null);case 4:return mh(),q(_,b),_===null&&gc(b.stateNode.containerInfo),ge(b),null;case 10:return wc(b.type._context),ge(b),null;case 17:return nl(b.type)&&Uh(),ge(b),null;case 19:if(Do(oa),me=b.memoizedState,me===null)return ge(b),null;if(G=(b.flags&128)!==0,qe=me.rendering,qe===null)if(G)ae(me,!1);else{if(Qr!==0||_!==null&&_.flags&128)for(_=b.child;_!==null;){if(qe=Tc(_),qe!==null){for(b.flags|=128,ae(me,!1),G=qe.updateQueue,G!==null&&(b.updateQueue=G,b.flags|=4),b.subtreeFlags=0,G=z,z=b.child;z!==null;)me=z,_=G,me.flags&=14680066,qe=me.alternate,qe===null?(me.childLanes=0,me.lanes=_,me.child=null,me.subtreeFlags=0,me.memoizedProps=null,me.memoizedState=null,me.updateQueue=null,me.dependencies=null,me.stateNode=null):(me.childLanes=qe.childLanes,me.lanes=qe.lanes,me.child=qe.child,me.subtreeFlags=0,me.deletions=null,me.memoizedProps=qe.memoizedProps,me.memoizedState=qe.memoizedState,me.updateQueue=qe.updateQueue,me.type=qe.type,_=qe.dependencies,me.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),z=z.sibling;return Io(oa,oa.current&1|2),b.child}_=_.sibling}me.tail!==null&&nr()>ni&&(b.flags|=128,G=!0,ae(me,!1),b.lanes=4194304)}else{if(!G)if(_=Tc(qe),_!==null){if(b.flags|=128,G=!0,z=_.updateQueue,z!==null&&(b.updateQueue=z,b.flags|=4),ae(me,!0),me.tail===null&&me.tailMode==="hidden"&&!qe.alternate&&!Co)return ge(b),null}else 2*nr()-me.renderingStartTime>ni&&z!==1073741824&&(b.flags|=128,G=!0,ae(me,!1),b.lanes=4194304);me.isBackwards?(qe.sibling=b.child,b.child=qe):(z=me.last,z!==null?z.sibling=qe:b.child=qe,me.last=qe)}return me.tail!==null?(b=me.tail,me.rendering=b,me.tail=b.sibling,me.renderingStartTime=nr(),b.sibling=null,z=oa.current,Io(oa,G?z&1|2:z&1),b):(ge(b),null);case 22:case 23:return Md(),G=b.memoizedState!==null,_!==null&&_.memoizedState!==null!==G&&(b.flags|=8192),G&&b.mode&1?Rr&1073741824&&(ge(b),b.subtreeFlags&6&&(b.flags|=8192)):ge(b),null;case 24:return null;case 25:return null}throw Error(i(156,b.tag))}function Te(_,b){switch(np(b),b.tag){case 1:return nl(b.type)&&Uh(),_=b.flags,_&65536?(b.flags=_&-65537|128,b):null;case 3:return mh(),Do(Es),Do(ds),Ti(),_=b.flags,_&65536&&!(_&128)?(b.flags=_&-65537|128,b):null;case 5:return ms(b),null;case 13:if(Do(oa),_=b.memoizedState,_!==null&&_.dehydrated!==null){if(b.alternate===null)throw Error(i(340));hh()}return _=b.flags,_&65536?(b.flags=_&-65537|128,b):null;case 19:return Do(oa),null;case 4:return mh(),null;case 10:return wc(b.type._context),null;case 22:case 23:return Md(),null;case 24:return null;default:return null}}var we=!1,ze=!1,Ue=typeof WeakSet=="function"?WeakSet:Set,ke=null;function He(_,b){var z=_.ref;if(z!==null)if(typeof z=="function")try{z(null)}catch(G){Va(_,b,G)}else z.current=null}function Ye(_,b,z){try{z()}catch(G){Va(_,b,G)}}var Ze=!1;function Qe(_,b){if(hr=_o,_=Nu(),fu(_)){if("selectionStart"in _)var z={start:_.selectionStart,end:_.selectionEnd};else e:{z=(z=_.ownerDocument)&&z.defaultView||window;var G=z.getSelection&&z.getSelection();if(G&&G.rangeCount!==0){z=G.anchorNode;var oe=G.anchorOffset,me=G.focusNode;G=G.focusOffset;try{z.nodeType,me.nodeType}catch{z=null;break e}var qe=0,bt=-1,Ft=-1,mn=0,Vn=0,Wn=_,jn=null;t:for(;;){for(var xr;Wn!==z||oe!==0&&Wn.nodeType!==3||(bt=qe+oe),Wn!==me||G!==0&&Wn.nodeType!==3||(Ft=qe+G),Wn.nodeType===3&&(qe+=Wn.nodeValue.length),(xr=Wn.firstChild)!==null;)jn=Wn,Wn=xr;for(;;){if(Wn===_)break t;if(jn===z&&++mn===oe&&(bt=qe),jn===me&&++Vn===G&&(Ft=qe),(xr=Wn.nextSibling)!==null)break;Wn=jn,jn=Wn.parentNode}Wn=xr}z=bt===-1||Ft===-1?null:{start:bt,end:Ft}}else z=null}z=z||{start:0,end:0}}else z=null;for(Jr={focusedElem:_,selectionRange:z},_o=!1,ke=b;ke!==null;)if(b=ke,_=b.child,(b.subtreeFlags&1028)!==0&&_!==null)_.return=b,ke=_;else for(;ke!==null;){b=ke;try{var zr=b.alternate;if(b.flags&1024)switch(b.tag){case 0:case 11:case 15:break;case 1:if(zr!==null){var jr=zr.memoizedProps,qa=zr.memoizedState,ln=b.stateNode,qt=ln.getSnapshotBeforeUpdate(b.elementType===b.type?jr:tu(b.type,jr),qa);ln.__reactInternalSnapshotBeforeUpdate=qt}break;case 3:var un=b.stateNode.containerInfo;un.nodeType===1?un.textContent="":un.nodeType===9&&un.documentElement&&un.removeChild(un.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(rr){Va(b,b.return,rr)}if(_=b.sibling,_!==null){_.return=b.return,ke=_;break}ke=b.return}return zr=Ze,Ze=!1,zr}function it(_,b,z){var G=b.updateQueue;if(G=G!==null?G.lastEffect:null,G!==null){var oe=G=G.next;do{if((oe.tag&_)===_){var me=oe.destroy;oe.destroy=void 0,me!==void 0&&Ye(b,z,me)}oe=oe.next}while(oe!==G)}}function ft(_,b){if(b=b.updateQueue,b=b!==null?b.lastEffect:null,b!==null){var z=b=b.next;do{if((z.tag&_)===_){var G=z.create;z.destroy=G()}z=z.next}while(z!==b)}}function st(_){var b=_.ref;if(b!==null){var z=_.stateNode;switch(_.tag){case 5:_=z;break;default:_=z}typeof b=="function"?b(_):b.current=_}}function at(_){var b=_.alternate;b!==null&&(_.alternate=null,at(b)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(b=_.stateNode,b!==null&&(delete b[Ts],delete b[Zl],delete b[Gu],delete b[yf],delete b[vf])),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function Rt(_){return _.tag===5||_.tag===3||_.tag===4}function $t(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||Rt(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function sn(_,b,z){var G=_.tag;if(G===5||G===6)_=_.stateNode,b?z.nodeType===8?z.parentNode.insertBefore(_,b):z.insertBefore(_,b):(z.nodeType===8?(b=z.parentNode,b.insertBefore(_,z)):(b=z,b.appendChild(_)),z=z._reactRootContainer,z!=null||b.onclick!==null||(b.onclick=Rn));else if(G!==4&&(_=_.child,_!==null))for(sn(_,b,z),_=_.sibling;_!==null;)sn(_,b,z),_=_.sibling}function _n(_,b,z){var G=_.tag;if(G===5||G===6)_=_.stateNode,b?z.insertBefore(_,b):z.appendChild(_);else if(G!==4&&(_=_.child,_!==null))for(_n(_,b,z),_=_.sibling;_!==null;)_n(_,b,z),_=_.sibling}var yn=null,yt=!1;function Qt(_,b,z){for(z=z.child;z!==null;)jt(_,b,z),z=z.sibling}function jt(_,b,z){if(ci&&typeof ci.onCommitFiberUnmount=="function")try{ci.onCommitFiberUnmount(qr,z)}catch{}switch(z.tag){case 5:ze||He(z,b);case 6:var G=yn,oe=yt;yn=null,Qt(_,b,z),yn=G,yt=oe,yn!==null&&(yt?(_=yn,z=z.stateNode,_.nodeType===8?_.parentNode.removeChild(z):_.removeChild(z)):yn.removeChild(z.stateNode));break;case 18:yn!==null&&(yt?(_=yn,z=z.stateNode,_.nodeType===8?du(_.parentNode,z):_.nodeType===1&&du(_,z),ua(_)):du(yn,z.stateNode));break;case 4:G=yn,oe=yt,yn=z.stateNode.containerInfo,yt=!0,Qt(_,b,z),yn=G,yt=oe;break;case 0:case 11:case 14:case 15:if(!ze&&(G=z.updateQueue,G!==null&&(G=G.lastEffect,G!==null))){oe=G=G.next;do{var me=oe,qe=me.destroy;me=me.tag,qe!==void 0&&(me&2||me&4)&&Ye(z,b,qe),oe=oe.next}while(oe!==G)}Qt(_,b,z);break;case 1:if(!ze&&(He(z,b),G=z.stateNode,typeof G.componentWillUnmount=="function"))try{G.props=z.memoizedProps,G.state=z.memoizedState,G.componentWillUnmount()}catch(bt){Va(z,b,bt)}Qt(_,b,z);break;case 21:Qt(_,b,z);break;case 22:z.mode&1?(ze=(G=ze)||z.memoizedState!==null,Qt(_,b,z),ze=G):Qt(_,b,z);break;default:Qt(_,b,z)}}function tn(_){var b=_.updateQueue;if(b!==null){_.updateQueue=null;var z=_.stateNode;z===null&&(z=_.stateNode=new Ue),b.forEach(function(G){var oe=nv.bind(null,_,G);z.has(G)||(z.add(G),G.then(oe,oe))})}}function rn(_,b){var z=b.deletions;if(z!==null)for(var G=0;G<z.length;G++){var oe=z[G];try{var me=_,qe=b,bt=qe;e:for(;bt!==null;){switch(bt.tag){case 5:yn=bt.stateNode,yt=!1;break e;case 3:yn=bt.stateNode.containerInfo,yt=!0;break e;case 4:yn=bt.stateNode.containerInfo,yt=!0;break e}bt=bt.return}if(yn===null)throw Error(i(160));jt(me,qe,oe),yn=null,yt=!1;var Ft=oe.alternate;Ft!==null&&(Ft.return=null),oe.return=null}catch(mn){Va(oe,b,mn)}}if(b.subtreeFlags&12854)for(b=b.child;b!==null;)en(b,_),b=b.sibling}function en(_,b){var z=_.alternate,G=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(rn(b,_),bn(_),G&4){try{it(3,_,_.return),ft(3,_)}catch(jr){Va(_,_.return,jr)}try{it(5,_,_.return)}catch(jr){Va(_,_.return,jr)}}break;case 1:rn(b,_),bn(_),G&512&&z!==null&&He(z,z.return);break;case 5:if(rn(b,_),bn(_),G&512&&z!==null&&He(z,z.return),_.flags&32){var oe=_.stateNode;try{ta(oe,"")}catch(jr){Va(_,_.return,jr)}}if(G&4&&(oe=_.stateNode,oe!=null)){var me=_.memoizedProps,qe=z!==null?z.memoizedProps:me,bt=_.type,Ft=_.updateQueue;if(_.updateQueue=null,Ft!==null)try{bt==="input"&&me.type==="radio"&&me.name!=null&&Qn(oe,me),Fa(bt,qe);var mn=Fa(bt,me);for(qe=0;qe<Ft.length;qe+=2){var Vn=Ft[qe],Wn=Ft[qe+1];Vn==="style"?Lo(oe,Wn):Vn==="dangerouslySetInnerHTML"?Mo(oe,Wn):Vn==="children"?ta(oe,Wn):Re(oe,Vn,Wn,mn)}switch(bt){case"input":Ar(oe,me);break;case"textarea":lr(oe,me);break;case"select":var jn=oe._wrapperState.wasMultiple;oe._wrapperState.wasMultiple=!!me.multiple;var xr=me.value;xr!=null?ii(oe,!!me.multiple,xr,!1):jn!==!!me.multiple&&(me.defaultValue!=null?ii(oe,!!me.multiple,me.defaultValue,!0):ii(oe,!!me.multiple,me.multiple?[]:"",!1))}oe[Zl]=me}catch(jr){Va(_,_.return,jr)}}break;case 6:if(rn(b,_),bn(_),G&4){if(_.stateNode===null)throw Error(i(162));oe=_.stateNode,me=_.memoizedProps;try{oe.nodeValue=me}catch(jr){Va(_,_.return,jr)}}break;case 3:if(rn(b,_),bn(_),G&4&&z!==null&&z.memoizedState.isDehydrated)try{ua(b.containerInfo)}catch(jr){Va(_,_.return,jr)}break;case 4:rn(b,_),bn(_);break;case 13:rn(b,_),bn(_),oe=_.child,oe.flags&8192&&(me=oe.memoizedState!==null,oe.stateNode.isHidden=me,!me||oe.alternate!==null&&oe.alternate.memoizedState!==null||(xi=nr())),G&4&&tn(_);break;case 22:if(Vn=z!==null&&z.memoizedState!==null,_.mode&1?(ze=(mn=ze)||Vn,rn(b,_),ze=mn):rn(b,_),bn(_),G&8192){if(mn=_.memoizedState!==null,(_.stateNode.isHidden=mn)&&!Vn&&_.mode&1)for(ke=_,Vn=_.child;Vn!==null;){for(Wn=ke=Vn;ke!==null;){switch(jn=ke,xr=jn.child,jn.tag){case 0:case 11:case 14:case 15:it(4,jn,jn.return);break;case 1:He(jn,jn.return);var zr=jn.stateNode;if(typeof zr.componentWillUnmount=="function"){G=jn,z=jn.return;try{b=G,zr.props=b.memoizedProps,zr.state=b.memoizedState,zr.componentWillUnmount()}catch(jr){Va(G,z,jr)}}break;case 5:He(jn,jn.return);break;case 22:if(jn.memoizedState!==null){ar(Wn);continue}}xr!==null?(xr.return=jn,ke=xr):ar(Wn)}Vn=Vn.sibling}e:for(Vn=null,Wn=_;;){if(Wn.tag===5){if(Vn===null){Vn=Wn;try{oe=Wn.stateNode,mn?(me=oe.style,typeof me.setProperty=="function"?me.setProperty("display","none","important"):me.display="none"):(bt=Wn.stateNode,Ft=Wn.memoizedProps.style,qe=Ft!=null&&Ft.hasOwnProperty("display")?Ft.display:null,bt.style.display=so("display",qe))}catch(jr){Va(_,_.return,jr)}}}else if(Wn.tag===6){if(Vn===null)try{Wn.stateNode.nodeValue=mn?"":Wn.memoizedProps}catch(jr){Va(_,_.return,jr)}}else if((Wn.tag!==22&&Wn.tag!==23||Wn.memoizedState===null||Wn===_)&&Wn.child!==null){Wn.child.return=Wn,Wn=Wn.child;continue}if(Wn===_)break e;for(;Wn.sibling===null;){if(Wn.return===null||Wn.return===_)break e;Vn===Wn&&(Vn=null),Wn=Wn.return}Vn===Wn&&(Vn=null),Wn.sibling.return=Wn.return,Wn=Wn.sibling}}break;case 19:rn(b,_),bn(_),G&4&&tn(_);break;case 21:break;default:rn(b,_),bn(_)}}function bn(_){var b=_.flags;if(b&2){try{e:{for(var z=_.return;z!==null;){if(Rt(z)){var G=z;break e}z=z.return}throw Error(i(160))}switch(G.tag){case 5:var oe=G.stateNode;G.flags&32&&(ta(oe,""),G.flags&=-33);var me=$t(_);_n(_,me,oe);break;case 3:case 4:var qe=G.stateNode.containerInfo,bt=$t(_);sn(_,bt,qe);break;default:throw Error(i(161))}}catch(Ft){Va(_,_.return,Ft)}_.flags&=-3}b&4096&&(_.flags&=-4097)}function er(_,b,z){ke=_,or(_)}function or(_,b,z){for(var G=(_.mode&1)!==0;ke!==null;){var oe=ke,me=oe.child;if(oe.tag===22&&G){var qe=oe.memoizedState!==null||we;if(!qe){var bt=oe.alternate,Ft=bt!==null&&bt.memoizedState!==null||ze;bt=we;var mn=ze;if(we=qe,(ze=Ft)&&!mn)for(ke=oe;ke!==null;)qe=ke,Ft=qe.child,qe.tag===22&&qe.memoizedState!==null?On(oe):Ft!==null?(Ft.return=qe,ke=Ft):On(oe);for(;me!==null;)ke=me,or(me),me=me.sibling;ke=oe,we=bt,ze=mn}Nn(_)}else oe.subtreeFlags&8772&&me!==null?(me.return=oe,ke=me):Nn(_)}}function Nn(_){for(;ke!==null;){var b=ke;if(b.flags&8772){var z=b.alternate;try{if(b.flags&8772)switch(b.tag){case 0:case 11:case 15:ze||ft(5,b);break;case 1:var G=b.stateNode;if(b.flags&4&&!ze)if(z===null)G.componentDidMount();else{var oe=b.elementType===b.type?z.memoizedProps:tu(b.type,z.memoizedProps);G.componentDidUpdate(oe,z.memoizedState,G.__reactInternalSnapshotBeforeUpdate)}var me=b.updateQueue;me!==null&&Pf(b,me,G);break;case 3:var qe=b.updateQueue;if(qe!==null){if(z=null,b.child!==null)switch(b.child.tag){case 5:z=b.child.stateNode;break;case 1:z=b.child.stateNode}Pf(b,qe,z)}break;case 5:var bt=b.stateNode;if(z===null&&b.flags&4){z=bt;var Ft=b.memoizedProps;switch(b.type){case"button":case"input":case"select":case"textarea":Ft.autoFocus&&z.focus();break;case"img":Ft.src&&(z.src=Ft.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(b.memoizedState===null){var mn=b.alternate;if(mn!==null){var Vn=mn.memoizedState;if(Vn!==null){var Wn=Vn.dehydrated;Wn!==null&&ua(Wn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}ze||b.flags&512&&st(b)}catch(jn){Va(b,b.return,jn)}}if(b===_){ke=null;break}if(z=b.sibling,z!==null){z.return=b.return,ke=z;break}ke=b.return}}function ar(_){for(;ke!==null;){var b=ke;if(b===_){ke=null;break}var z=b.sibling;if(z!==null){z.return=b.return,ke=z;break}ke=b.return}}function On(_){for(;ke!==null;){var b=ke;try{switch(b.tag){case 0:case 11:case 15:var z=b.return;try{ft(4,b)}catch(Ft){Va(b,z,Ft)}break;case 1:var G=b.stateNode;if(typeof G.componentDidMount=="function"){var oe=b.return;try{G.componentDidMount()}catch(Ft){Va(b,oe,Ft)}}var me=b.return;try{st(b)}catch(Ft){Va(b,me,Ft)}break;case 5:var qe=b.return;try{st(b)}catch(Ft){Va(b,qe,Ft)}}}catch(Ft){Va(b,b.return,Ft)}if(b===_){ke=null;break}var bt=b.sibling;if(bt!==null){bt.return=b.return,ke=bt;break}ke=b.return}}var pr=Math.ceil,kr=De.ReactCurrentDispatcher,si=De.ReactCurrentOwner,Si=De.ReactCurrentBatchConfig,fr=0,hi=null,Nr=null,li=0,Rr=0,Li=Hu(0),Qr=0,Ei=null,Ui=0,Yo=0,Vs=0,Ps=null,Qi=null,xi=0,ni=1/0,di=null,Vi=!1,ko=null,ji=null,pa=!1,_s=null,ys=0,os=0,al=null,sl=-1,vs=0;function ma(){return fr&6?nr():sl!==-1?sl:sl=nr()}function Ja(_){return _.mode&1?fr&2&&li!==0?li&-li:rp.transition!==null?(vs===0&&(vs=dt()),vs):(_=Gn,_!==0||(_=window.event,_=_===void 0?16:Oi(_.type)),_):1}function pi(_,b,z,G){if(50<os)throw os=0,al=null,Error(i(185));Zt(_,z,G),(!(fr&2)||_!==hi)&&(_===hi&&(!(fr&2)&&(Yo|=z),Qr===4&&qs(_,li)),Qa(_,G),z===1&&fr===0&&!(b.mode&1)&&(ni=nr()+500,yc&&gu()))}function Qa(_,b){var z=_.callbackNode;Oe(_,b);var G=wi(_,_===hi?li:0);if(G===0)z!==null&&Zn(z),_.callbackNode=null,_.callbackPriority=0;else if(b=G&-G,_.callbackPriority!==b){if(z!=null&&Zn(z),b===1)_.tag===0?ld(Rc.bind(null,_)):xf(Rc.bind(null,_)),fs(function(){!(fr&6)&&gu()}),z=null;else{switch(Cr(G)){case 1:z=Kn;break;case 4:z=br;break;case 16:z=oi;break;case 536870912:z=Kr;break;default:z=oi}z=Wg(z,Pd.bind(null,_))}_.callbackPriority=b,_.callbackNode=z}}function Pd(_,b){if(sl=-1,vs=0,fr&6)throw Error(i(327));var z=_.callbackNode;if(Xh()&&_.callbackNode!==z)return null;var G=wi(_,_===hi?li:0);if(G===0)return null;if(G&30||G&_.expiredLanes||b)b=$f(_,G);else{b=G;var oe=fr;fr|=2;var me=mp();(hi!==_||li!==b)&&(di=null,ni=nr()+500,bh(_,b));do try{Vg();break}catch(bt){Id(_,bt)}while(!0);bc(),kr.current=me,fr=oe,Nr!==null?b=0:(hi=null,li=0,b=Qr)}if(b!==0){if(b===2&&(oe=We(_),oe!==0&&(G=oe,b=kc(_,oe))),b===1)throw z=Ei,bh(_,0),qs(_,G),Qa(_,nr()),z;if(b===6)qs(_,G);else{if(oe=_.current.alternate,!(G&30)&&!jf(oe)&&(b=$f(_,G),b===2&&(me=We(_),me!==0&&(G=me,b=kc(_,me))),b===1))throw z=Ei,bh(_,0),qs(_,G),Qa(_,nr()),z;switch(_.finishedWork=oe,_.finishedLanes=G,b){case 0:case 1:throw Error(i(345));case 2:Ll(_,Qi,di);break;case 3:if(qs(_,G),(G&130023424)===G&&(b=xi+500-nr(),10<b)){if(wi(_,0)!==0)break;if(oe=_.suspendedLanes,(oe&G)!==G){ma(),_.pingedLanes|=_.suspendedLanes&oe;break}_.timeoutHandle=ja(Ll.bind(null,_,Qi,di),b);break}Ll(_,Qi,di);break;case 4:if(qs(_,G),(G&4194240)===G)break;for(b=_.eventTimes,oe=-1;0<G;){var qe=31-Xn(G);me=1<<qe,qe=b[qe],qe>oe&&(oe=qe),G&=~me}if(G=oe,G=nr()-G,G=(120>G?120:480>G?480:1080>G?1080:1920>G?1920:3e3>G?3e3:4320>G?4320:1960*pr(G/1960))-G,10<G){_.timeoutHandle=ja(Ll.bind(null,_,Qi,di),G);break}Ll(_,Qi,di);break;case 5:Ll(_,Qi,di);break;default:throw Error(i(329))}}}return Qa(_,nr()),_.callbackNode===z?Pd.bind(null,_):null}function kc(_,b){var z=Ps;return _.current.memoizedState.isDehydrated&&(bh(_,b).flags|=256),_=$f(_,b),_!==2&&(b=Qi,Qi=z,b!==null&&Nf(b)),_}function Nf(_){Qi===null?Qi=_:Qi.push.apply(Qi,_)}function jf(_){for(var b=_;;){if(b.flags&16384){var z=b.updateQueue;if(z!==null&&(z=z.stores,z!==null))for(var G=0;G<z.length;G++){var oe=z[G],me=oe.getSnapshot;oe=oe.value;try{if(!Ys(me(),oe))return!1}catch{return!1}}}if(z=b.child,b.subtreeFlags&16384&&z!==null)z.return=b,b=z;else{if(b===_)break;for(;b.sibling===null;){if(b.return===null||b.return===_)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function qs(_,b){for(b&=~Vs,b&=~Yo,_.suspendedLanes|=b,_.pingedLanes&=~b,_=_.expirationTimes;0<b;){var z=31-Xn(b),G=1<<z;_[z]=-1,b&=~G}}function Rc(_){if(fr&6)throw Error(i(327));Xh();var b=wi(_,0);if(!(b&1))return Qa(_,nr()),null;var z=$f(_,b);if(_.tag!==0&&z===2){var G=We(_);G!==0&&(b=G,z=kc(_,G))}if(z===1)throw z=Ei,bh(_,0),qs(_,b),Qa(_,nr()),z;if(z===6)throw Error(i(345));return _.finishedWork=_.current.alternate,_.finishedLanes=b,Ll(_,Qi,di),Qa(_,nr()),null}function ym(_,b){var z=fr;fr|=1;try{return _(b)}finally{fr=z,fr===0&&(ni=nr()+500,yc&&gu())}}function Zh(_){_s!==null&&_s.tag===0&&!(fr&6)&&Xh();var b=fr;fr|=1;var z=Si.transition,G=Gn;try{if(Si.transition=null,Gn=1,_)return _()}finally{Gn=G,Si.transition=z,fr=b,!(fr&6)&&gu()}}function Md(){Rr=Li.current,Do(Li)}function bh(_,b){_.finishedWork=null,_.finishedLanes=0;var z=_.timeoutHandle;if(z!==-1&&(_.timeoutHandle=-1,Ko(z)),Nr!==null)for(z=Nr.return;z!==null;){var G=z;switch(np(G),G.tag){case 1:G=G.type.childContextTypes,G!=null&&Uh();break;case 3:mh(),Do(Es),Do(ds),Ti();break;case 5:ms(G);break;case 4:mh();break;case 13:Do(oa);break;case 19:Do(oa);break;case 10:wc(G.type._context);break;case 22:case 23:Md()}z=z.return}if(hi=_,Nr=_=wh(_.current,null),li=Rr=b,Qr=0,Ei=null,Vs=Yo=Ui=0,Qi=Ps=null,Ni!==null){for(b=0;b<Ni.length;b++)if(z=Ni[b],G=z.interleaved,G!==null){z.interleaved=null;var oe=G.next,me=z.pending;if(me!==null){var qe=me.next;me.next=oe,G.next=qe}z.pending=G}Ni=null}return _}function Id(_,b){do{var z=Nr;try{if(bc(),Mf.current=wd,Il){for(var G=Oo.memoizedState;G!==null;){var oe=G.queue;oe!==null&&(oe.pending=null),G=G.next}Il=!1}if(bu=0,Ta=ka=Oo=null,Cl=!1,ml=0,si.current=null,z===null||z.return===null){Qr=1,Ei=b,Nr=null;break}e:{var me=_,qe=z.return,bt=z,Ft=b;if(b=li,bt.flags|=32768,Ft!==null&&typeof Ft=="object"&&typeof Ft.then=="function"){var mn=Ft,Vn=bt,Wn=Vn.tag;if(!(Vn.mode&1)&&(Wn===0||Wn===11||Wn===15)){var jn=Vn.alternate;jn?(Vn.updateQueue=jn.updateQueue,Vn.memoizedState=jn.memoizedState,Vn.lanes=jn.lanes):(Vn.updateQueue=null,Vn.memoizedState=null)}var xr=pm(qe);if(xr!==null){xr.flags&=-257,fp(xr,qe,bt,me,b),xr.mode&1&&Wh(me,mn,b),b=xr,Ft=mn;var zr=b.updateQueue;if(zr===null){var jr=new Set;jr.add(Ft),b.updateQueue=jr}else zr.add(Ft);break e}else{if(!(b&1)){Wh(me,mn,b),vm();break e}Ft=Error(i(426))}}else if(Co&&bt.mode&1){var qa=pm(qe);if(qa!==null){!(qa.flags&65536)&&(qa.flags|=256),fp(qa,qe,bt,me,b),wf(Uo(Ft,bt));break e}}me=Ft=Uo(Ft,bt),Qr!==4&&(Qr=2),Ps===null?Ps=[me]:Ps.push(me),me=qe;do{switch(me.tag){case 3:me.flags|=65536,b&=-b,me.lanes|=b;var ln=Td(me,Ft,b);um(me,ln);break e;case 1:bt=Ft;var qt=me.type,un=me.stateNode;if(!(me.flags&128)&&(typeof qt.getDerivedStateFromError=="function"||un!==null&&typeof un.componentDidCatch=="function"&&(ji===null||!ji.has(un)))){me.flags|=65536,b&=-b,me.lanes|=b;var rr=hp(me,bt,b);um(me,rr);break e}}me=me.return}while(me!==null)}Gg(z)}catch(Wr){b=Wr,Nr===z&&z!==null&&(Nr=z=z.return);continue}break}while(!0)}function mp(){var _=kr.current;return kr.current=wd,_===null?wd:_}function vm(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),hi===null||!(Ui&268435455)&&!(Yo&268435455)||qs(hi,li)}function $f(_,b){var z=fr;fr|=2;var G=mp();(hi!==_||li!==b)&&(di=null,bh(_,b));do try{Ug();break}catch(oe){Id(_,oe)}while(!0);if(bc(),fr=z,kr.current=G,Nr!==null)throw Error(i(261));return hi=null,li=0,Qr}function Ug(){for(;Nr!==null;)qg(Nr)}function Vg(){for(;Nr!==null&&!Zr();)qg(Nr)}function qg(_){var b=rv(_.alternate,_,Rr);_.memoizedProps=_.pendingProps,b===null?Gg(_):Nr=b,si.current=null}function Gg(_){var b=_;do{var z=b.alternate;if(_=b.return,b.flags&32768){if(z=Te(z,b),z!==null){z.flags&=32767,Nr=z;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{Qr=6,Nr=null;return}}else if(z=_e(z,b,Rr),z!==null){Nr=z;return}if(b=b.sibling,b!==null){Nr=b;return}Nr=b=_}while(b!==null);Qr===0&&(Qr=5)}function Ll(_,b,z){var G=Gn,oe=Si.transition;try{Si.transition=null,Gn=1,Qy(_,b,z,G)}finally{Si.transition=oe,Gn=G}return null}function Qy(_,b,z,G){do Xh();while(_s!==null);if(fr&6)throw Error(i(327));z=_.finishedWork;var oe=_.finishedLanes;if(z===null)return null;if(_.finishedWork=null,_.finishedLanes=0,z===_.current)throw Error(i(177));_.callbackNode=null,_.callbackPriority=0;var me=z.lanes|z.childLanes;if(fn(_,me),_===hi&&(Nr=hi=null,li=0),!(z.subtreeFlags&2064)&&!(z.flags&2064)||pa||(pa=!0,Wg(oi,function(){return Xh(),null})),me=(z.flags&15990)!==0,z.subtreeFlags&15990||me){me=Si.transition,Si.transition=null;var qe=Gn;Gn=1;var bt=fr;fr|=4,si.current=null,Qe(_,z),en(z,_),Ss(Jr),_o=!!hr,Jr=hr=null,_.current=z,er(z),ri(),fr=bt,Gn=qe,Si.transition=me}else _.current=z;if(pa&&(pa=!1,_s=_,ys=oe),me=_.pendingLanes,me===0&&(ji=null),Zi(z.stateNode),Qa(_,nr()),b!==null)for(G=_.onRecoverableError,z=0;z<b.length;z++)oe=b[z],G(oe.value,{componentStack:oe.stack,digest:oe.digest});if(Vi)throw Vi=!1,_=ko,ko=null,_;return ys&1&&_.tag!==0&&Xh(),me=_.pendingLanes,me&1?_===al?os++:(os=0,al=_):os=0,gu(),null}function Xh(){if(_s!==null){var _=Cr(ys),b=Si.transition,z=Gn;try{if(Si.transition=null,Gn=16>_?16:_,_s===null)var G=!1;else{if(_=_s,_s=null,ys=0,fr&6)throw Error(i(331));var oe=fr;for(fr|=4,ke=_.current;ke!==null;){var me=ke,qe=me.child;if(ke.flags&16){var bt=me.deletions;if(bt!==null){for(var Ft=0;Ft<bt.length;Ft++){var mn=bt[Ft];for(ke=mn;ke!==null;){var Vn=ke;switch(Vn.tag){case 0:case 11:case 15:it(8,Vn,me)}var Wn=Vn.child;if(Wn!==null)Wn.return=Vn,ke=Wn;else for(;ke!==null;){Vn=ke;var jn=Vn.sibling,xr=Vn.return;if(at(Vn),Vn===mn){ke=null;break}if(jn!==null){jn.return=xr,ke=jn;break}ke=xr}}}var zr=me.alternate;if(zr!==null){var jr=zr.child;if(jr!==null){zr.child=null;do{var qa=jr.sibling;jr.sibling=null,jr=qa}while(jr!==null)}}ke=me}}if(me.subtreeFlags&2064&&qe!==null)qe.return=me,ke=qe;else e:for(;ke!==null;){if(me=ke,me.flags&2048)switch(me.tag){case 0:case 11:case 15:it(9,me,me.return)}var ln=me.sibling;if(ln!==null){ln.return=me.return,ke=ln;break e}ke=me.return}}var qt=_.current;for(ke=qt;ke!==null;){qe=ke;var un=qe.child;if(qe.subtreeFlags&2064&&un!==null)un.return=qe,ke=un;else e:for(qe=qt;ke!==null;){if(bt=ke,bt.flags&2048)try{switch(bt.tag){case 0:case 11:case 15:ft(9,bt)}}catch(Wr){Va(bt,bt.return,Wr)}if(bt===qe){ke=null;break e}var rr=bt.sibling;if(rr!==null){rr.return=bt.return,ke=rr;break e}ke=bt.return}}if(fr=oe,gu(),ci&&typeof ci.onPostCommitFiberRoot=="function")try{ci.onPostCommitFiberRoot(qr,_)}catch{}G=!0}return G}finally{Gn=z,Si.transition=b}}return!1}function Hg(_,b,z){b=Uo(z,b),b=Td(_,b,1),_=is(_,b,1),b=ma(),_!==null&&(Zt(_,1,b),Qa(_,b))}function Va(_,b,z){if(_.tag===3)Hg(_,_,z);else for(;b!==null;){if(b.tag===3){Hg(b,_,z);break}else if(b.tag===1){var G=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof G.componentDidCatch=="function"&&(ji===null||!ji.has(G))){_=Uo(z,_),_=hp(b,_,1),b=is(b,_,1),_=ma(),b!==null&&(Zt(b,1,_),Qa(b,_));break}}b=b.return}}function h1(_,b,z){var G=_.pingCache;G!==null&&G.delete(b),b=ma(),_.pingedLanes|=_.suspendedLanes&z,hi===_&&(li&z)===z&&(Qr===4||Qr===3&&(li&130023424)===li&&500>nr()-xi?bh(_,0):Vs|=z),Qa(_,b)}function ev(_,b){b===0&&(_.mode&1?(b=wo,wo<<=1,!(wo&130023424)&&(wo=4194304)):b=1);var z=ma();_=Us(_,b),_!==null&&(Zt(_,b,z),Qa(_,z))}function tv(_){var b=_.memoizedState,z=0;b!==null&&(z=b.retryLane),ev(_,z)}function nv(_,b){var z=0;switch(_.tag){case 13:var G=_.stateNode,oe=_.memoizedState;oe!==null&&(z=oe.retryLane);break;case 19:G=_.stateNode;break;default:throw Error(i(314))}G!==null&&G.delete(b),ev(_,z)}var rv;rv=function(_,b,z){if(_!==null)if(_.memoizedProps!==b.pendingProps||Es.current)As=!0;else{if(!(_.lanes&z)&&!(b.flags&128))return As=!1,j(_,b,z);As=!!(_.flags&131072)}else As=!1,Co&&b.flags&1048576&&ud(b,xc,b.index);switch(b.lanes=0,b.tag){case 2:var G=b.type;A(_,b),_=b.pendingProps;var oe=$h(b,ds.current);tr(b,z),oe=If(null,b,G,_,oe,z);var me=Cf();return b.flags|=1,typeof oe=="object"&&oe!==null&&typeof oe.render=="function"&&oe.$$typeof===void 0?(b.tag=1,b.memoizedState=null,b.updateQueue=null,nl(G)?(me=!0,ah(b)):me=!1,b.memoizedState=oe.state!==null&&oe.state!==void 0?oe.state:null,Vh(b),oe.updater=zf,b.stateNode=oe,oe._reactInternals=b,Yu(b,G,_,z),b=dp(null,b,G,!0,me,z)):(b.tag=0,Co&&me&&cd(b),Ka(null,b,oe,z),b=b.child),b;case 16:G=b.elementType;e:{switch(A(_,b),_=b.pendingProps,oe=G._init,G=oe(G._payload),b.type=G,oe=b.tag=iv(G),_=tu(G,_),oe){case 0:b=Rl(null,b,G,_,z);break e;case 1:b=mm(null,b,G,_,z);break e;case 11:b=xh(null,b,G,_,z);break e;case 14:b=Su(null,b,G,tu(G.type,_),z);break e}throw Error(i(306,G,""))}return b;case 0:return G=b.type,oe=b.pendingProps,oe=b.elementType===G?oe:tu(G,oe),Rl(_,b,G,oe,z);case 1:return G=b.type,oe=b.pendingProps,oe=b.elementType===G?oe:tu(G,oe),mm(_,b,G,oe,z);case 3:e:{if(gm(b),_===null)throw Error(i(387));G=b.pendingProps,me=b.memoizedState,oe=me.element,vu(_,b),Af(b,G,null,z);var qe=b.memoizedState;if(G=qe.element,me.isDehydrated)if(me={element:G,isDehydrated:!1,cache:qe.cache,pendingSuspenseBoundaries:qe.pendingSuspenseBoundaries,transitions:qe.transitions},b.updateQueue.baseState=me,b.memoizedState=me,b.flags&256){oe=Uo(Error(i(423)),b),b=_m(_,b,G,z,oe);break e}else if(G!==oe){oe=Uo(Error(i(424)),b),b=_m(_,b,G,z,oe);break e}else for($s=Hl(b.stateNode.containerInfo.firstChild),rs=b,Co=!0,Pl=null,z=fd(b,null,G,z),b.child=z;z;)z.flags=z.flags&-3|4096,z=z.sibling;else{if(hh(),G===oe){b=F(_,b,z);break e}Ka(_,b,G,z)}b=b.child}return b;case 5:return eu(b),_===null&&ch(b),G=b.type,oe=b.pendingProps,me=_!==null?_.memoizedProps:null,qe=oe.children,Ii(G,oe)?qe=null:me!==null&&Ii(G,me)&&(b.flags|=32),Eu(_,b),Ka(_,b,qe,z),b.child;case 6:return _===null&&ch(b),null;case 13:return pp(_,b,z);case 4:return qh(b,b.stateNode.containerInfo),G=b.pendingProps,_===null?b.child=Xu(b,null,G,z):Ka(_,b,G,z),b.child;case 11:return G=b.type,oe=b.pendingProps,oe=b.elementType===G?oe:tu(G,oe),xh(_,b,G,oe,z);case 7:return Ka(_,b,b.pendingProps,z),b.child;case 8:return Ka(_,b,b.pendingProps.children,z),b.child;case 12:return Ka(_,b,b.pendingProps.children,z),b.child;case 10:e:{if(G=b.type._context,oe=b.pendingProps,me=b.memoizedProps,qe=oe.value,Io(Tf,G._currentValue),G._currentValue=qe,me!==null)if(Ys(me.value,qe)){if(me.children===oe.children&&!Es.current){b=F(_,b,z);break e}}else for(me=b.child,me!==null&&(me.return=b);me!==null;){var bt=me.dependencies;if(bt!==null){qe=me.child;for(var Ft=bt.firstContext;Ft!==null;){if(Ft.context===G){if(me.tag===1){Ft=Yl(-1,z&-z),Ft.tag=2;var mn=me.updateQueue;if(mn!==null){mn=mn.shared;var Vn=mn.pending;Vn===null?Ft.next=Ft:(Ft.next=Vn.next,Vn.next=Ft),mn.pending=Ft}}me.lanes|=z,Ft=me.alternate,Ft!==null&&(Ft.lanes|=z),vn(me.return,z,b),bt.lanes|=z;break}Ft=Ft.next}}else if(me.tag===10)qe=me.type===b.type?null:me.child;else if(me.tag===18){if(qe=me.return,qe===null)throw Error(i(341));qe.lanes|=z,bt=qe.alternate,bt!==null&&(bt.lanes|=z),vn(qe,z,b),qe=me.sibling}else qe=me.child;if(qe!==null)qe.return=me;else for(qe=me;qe!==null;){if(qe===b){qe=null;break}if(me=qe.sibling,me!==null){me.return=qe.return,qe=me;break}qe=qe.return}me=qe}Ka(_,b,oe.children,z),b=b.child}return b;case 9:return oe=b.type,G=b.pendingProps.children,tr(b,z),oe=ps(oe),G=G(oe),b.flags|=1,Ka(_,b,G,z),b.child;case 14:return G=b.type,oe=tu(G,b.pendingProps),oe=tu(G.type,oe),Su(_,b,G,oe,z);case 15:return kl(_,b,b.type,b.pendingProps,z);case 17:return G=b.type,oe=b.pendingProps,oe=b.elementType===G?oe:tu(G,oe),A(_,b),b.tag=1,nl(G)?(_=!0,ah(b)):_=!1,tr(b,z),Ff(b,G,oe),Yu(b,G,oe,z),dp(null,b,G,!0,_,z);case 19:return T(_,b,z);case 22:return Tu(_,b,z)}throw Error(i(156,b.tag))};function Wg(_,b){return dr(_,b)}function f1(_,b,z,G){this.tag=_,this.key=z,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=G,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Au(_,b,z,G){return new f1(_,b,z,G)}function xm(_){return _=_.prototype,!(!_||!_.isReactComponent)}function iv(_){if(typeof _=="function")return xm(_)?1:0;if(_!=null){if(_=_.$$typeof,_===St)return 11;if(_===Ct)return 14}return 2}function wh(_,b){var z=_.alternate;return z===null?(z=Au(_.tag,b,_.key,_.mode),z.elementType=_.elementType,z.type=_.type,z.stateNode=_.stateNode,z.alternate=_,_.alternate=z):(z.pendingProps=b,z.type=_.type,z.flags=0,z.subtreeFlags=0,z.deletions=null),z.flags=_.flags&14680064,z.childLanes=_.childLanes,z.lanes=_.lanes,z.child=_.child,z.memoizedProps=_.memoizedProps,z.memoizedState=_.memoizedState,z.updateQueue=_.updateQueue,b=_.dependencies,z.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},z.sibling=_.sibling,z.index=_.index,z.ref=_.ref,z}function gp(_,b,z,G,oe,me){var qe=2;if(G=_,typeof _=="function")xm(_)&&(qe=1);else if(typeof _=="string")qe=5;else e:switch(_){case Fe:return Kh(z.children,oe,me,b);case lt:qe=8,oe|=8;break;case xt:return _=Au(12,z,b,oe|2),_.elementType=xt,_.lanes=me,_;case Nt:return _=Au(13,z,b,oe),_.elementType=Nt,_.lanes=me,_;case Ht:return _=Au(19,z,b,oe),_.elementType=Ht,_.lanes=me,_;case Lt:return _p(z,oe,me,b);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case gt:qe=10;break e;case Je:qe=9;break e;case St:qe=11;break e;case Ct:qe=14;break e;case Kt:qe=16,G=null;break e}throw Error(i(130,_==null?_:typeof _,""))}return b=Au(qe,z,b,oe),b.elementType=_,b.type=G,b.lanes=me,b}function Kh(_,b,z,G){return _=Au(7,_,G,b),_.lanes=z,_}function _p(_,b,z,G){return _=Au(22,_,G,b),_.elementType=Lt,_.lanes=z,_.stateNode={isHidden:!1},_}function bm(_,b,z){return _=Au(6,_,null,b),_.lanes=z,_}function yp(_,b,z){return b=Au(4,_.children!==null?_.children:[],_.key,b),b.lanes=z,b.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},b}function Yh(_,b,z,G,oe){this.tag=b,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nn(0),this.expirationTimes=nn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nn(0),this.identifierPrefix=G,this.onRecoverableError=oe,this.mutableSourceEagerHydrationData=null}function xs(_,b,z,G,oe,me,qe,bt,Ft){return _=new Yh(_,b,z,bt,Ft),b===1?(b=1,me===!0&&(b|=8)):b=0,me=Au(3,null,null,b),_.current=me,me.stateNode=_,me.memoizedState={element:G,isDehydrated:z,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vh(me),_}function ov(_,b,z){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Le,key:G==null?null:""+G,children:_,containerInfo:b,implementation:z}}function Cd(_){if(!_)return mu;_=_._reactInternals;e:{if(Vt(_)!==_||_.tag!==1)throw Error(i(170));var b=_;do{switch(b.tag){case 3:b=b.stateNode.context;break e;case 1:if(nl(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break e}}b=b.return}while(b!==null);throw Error(i(171))}if(_.tag===1){var z=_.type;if(nl(z))return sd(_,z,b)}return b}function av(_,b,z,G,oe,me,qe,bt,Ft){return _=xs(z,G,!0,_,oe,me,qe,bt,Ft),_.context=Cd(null),z=_.current,G=ma(),oe=Ja(z),me=Yl(G,oe),me.callback=b??null,is(z,me,oe),_.current.lanes=oe,Zt(_,oe,G),Qa(_,G),_}function wm(_,b,z,G){var oe=b.current,me=ma(),qe=Ja(oe);return z=Cd(z),b.context===null?b.context=z:b.pendingContext=z,b=Yl(me,qe),b.payload={element:_},G=G===void 0?null:G,G!==null&&(b.callback=G),_=is(oe,b,qe),_!==null&&(pi(_,oe,qe,me),pd(_,oe,qe)),qe}function Jh(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return _.child.stateNode;default:return _.child.stateNode}}function Zg(_,b){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var z=_.retryLane;_.retryLane=z!==0&&z<b?z:b}}function Sh(_,b){Zg(_,b),(_=_.alternate)&&Zg(_,b)}function vp(){return null}var sv=typeof reportError=="function"?reportError:function(_){console.error(_)};function Xg(_){this._internalRoot=_}Sm.prototype.render=Xg.prototype.render=function(_){var b=this._internalRoot;if(b===null)throw Error(i(409));wm(_,b,null,null)},Sm.prototype.unmount=Xg.prototype.unmount=function(){var _=this._internalRoot;if(_!==null){this._internalRoot=null;var b=_.containerInfo;Zh(function(){wm(null,_,null,null)}),b[Xi]=null}};function Sm(_){this._internalRoot=_}Sm.prototype.unstable_scheduleHydration=function(_){if(_){var b=To();_={blockedOn:null,target:_,priority:b};for(var z=0;z<fo.length&&b!==0&&b<fo[z].priority;z++);fo.splice(z,0,_),z===0&&Br(_)}};function Kg(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)}function Tm(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11&&(_.nodeType!==8||_.nodeValue!==" react-mount-point-unstable "))}function lv(){}function d1(_,b,z,G,oe){if(oe){if(typeof G=="function"){var me=G;G=function(){var mn=Jh(qe);me.call(mn)}}var qe=av(b,G,_,0,null,!1,!1,"",lv);return _._reactRootContainer=qe,_[Xi]=qe.current,gc(_.nodeType===8?_.parentNode:_),Zh(),qe}for(;oe=_.lastChild;)_.removeChild(oe);if(typeof G=="function"){var bt=G;G=function(){var mn=Jh(Ft);bt.call(mn)}}var Ft=xs(_,0,!1,null,null,!1,!1,"",lv);return _._reactRootContainer=Ft,_[Xi]=Ft.current,gc(_.nodeType===8?_.parentNode:_),Zh(function(){wm(b,Ft,z,G)}),Ft}function Od(_,b,z,G,oe){var me=z._reactRootContainer;if(me){var qe=me;if(typeof oe=="function"){var bt=oe;oe=function(){var Ft=Jh(qe);bt.call(Ft)}}wm(b,qe,_,oe)}else qe=d1(z,b,_,oe,G);return Jh(qe)}Ur=function(_){switch(_.tag){case 3:var b=_.stateNode;if(b.current.memoizedState.isDehydrated){var z=yr(b.pendingLanes);z!==0&&(Cn(b,z|1),Qa(b,nr()),!(fr&6)&&(ni=nr()+500,gu()))}break;case 13:Zh(function(){var G=Us(_,1);if(G!==null){var oe=ma();pi(G,_,1,oe)}}),Sh(_,1)}},Ri=function(_){if(_.tag===13){var b=Us(_,134217728);if(b!==null){var z=ma();pi(b,_,134217728,z)}Sh(_,134217728)}},So=function(_){if(_.tag===13){var b=Ja(_),z=Us(_,b);if(z!==null){var G=ma();pi(z,_,b,G)}Sh(_,b)}},To=function(){return Gn},wr=function(_,b){var z=Gn;try{return Gn=_,b()}finally{Gn=z}},Ia=function(_,b,z){switch(b){case"input":if(Ar(_,z),b=z.name,z.type==="radio"&&b!=null){for(z=_;z.parentNode;)z=z.parentNode;for(z=z.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]'),b=0;b<z.length;b++){var G=z[b];if(G!==_&&G.form===_.form){var oe=tl(G);if(!oe)throw Error(i(90));Sn(G),Ar(G,oe)}}}break;case"textarea":lr(_,z);break;case"select":b=z.value,b!=null&&ii(_,!!z.multiple,b,!1)}},na=ym,kt=Zh;var p1={usingClientEntryPoint:!1,Events:[Bs,pu,tl,Mi,Fo,ym]},Lc={findFiberByHostInstance:Xl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m1={bundleType:Lc.bundleType,version:Lc.version,rendererPackageName:Lc.rendererPackageName,rendererConfig:Lc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:De.ReactCurrentDispatcher,findHostInstanceByFiber:function(_){return _=In(_),_===null?null:_.stateNode},findFiberByHostInstance:Lc.findFiberByHostInstance||vp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var aa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!aa.isDisabled&&aa.supportsFiber)try{qr=aa.inject(m1),ci=aa}catch{}}return Iu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p1,Iu.createPortal=function(_,b){var z=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kg(b))throw Error(i(200));return ov(_,b,null,z)},Iu.createRoot=function(_,b){if(!Kg(_))throw Error(i(299));var z=!1,G="",oe=sv;return b!=null&&(b.unstable_strictMode===!0&&(z=!0),b.identifierPrefix!==void 0&&(G=b.identifierPrefix),b.onRecoverableError!==void 0&&(oe=b.onRecoverableError)),b=xs(_,1,!1,null,null,z,!1,G,oe),_[Xi]=b.current,gc(_.nodeType===8?_.parentNode:_),new Xg(b)},Iu.findDOMNode=function(_){if(_==null)return null;if(_.nodeType===1)return _;var b=_._reactInternals;if(b===void 0)throw typeof _.render=="function"?Error(i(188)):(_=Object.keys(_).join(","),Error(i(268,_)));return _=In(b),_=_===null?null:_.stateNode,_},Iu.flushSync=function(_){return Zh(_)},Iu.hydrate=function(_,b,z){if(!Tm(b))throw Error(i(200));return Od(null,_,b,!0,z)},Iu.hydrateRoot=function(_,b,z){if(!Kg(_))throw Error(i(405));var G=z!=null&&z.hydratedSources||null,oe=!1,me="",qe=sv;if(z!=null&&(z.unstable_strictMode===!0&&(oe=!0),z.identifierPrefix!==void 0&&(me=z.identifierPrefix),z.onRecoverableError!==void 0&&(qe=z.onRecoverableError)),b=av(b,null,_,1,z??null,oe,!1,me,qe),_[Xi]=b.current,gc(_),G)for(_=0;_<G.length;_++)z=G[_],oe=z._getVersion,oe=oe(z._source),b.mutableSourceEagerHydrationData==null?b.mutableSourceEagerHydrationData=[z,oe]:b.mutableSourceEagerHydrationData.push(z,oe);return new Sm(b)},Iu.render=function(_,b,z){if(!Tm(b))throw Error(i(200));return Od(null,_,b,!1,z)},Iu.unmountComponentAtNode=function(_){if(!Tm(_))throw Error(i(40));return _._reactRootContainer?(Zh(function(){Od(null,null,_,!1,function(){_._reactRootContainer=null,_[Xi]=null})}),!0):!1},Iu.unstable_batchedUpdates=ym,Iu.unstable_renderSubtreeIntoContainer=function(_,b,z,G){if(!Tm(z))throw Error(i(200));if(_==null||_._reactInternals===void 0)throw Error(i(38));return Od(_,b,z,!1,G)},Iu.version="18.3.1-next-f1338f8080-20240426",Iu}var Ak;function X5(){if(Ak)return yb.exports;Ak=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),yb.exports=WV(),yb.exports}var Pk;function ZV(){if(Pk)return Vv;Pk=1;var e=X5();return Vv.createRoot=e.createRoot,Vv.hydrateRoot=e.hydrateRoot,Vv}var XV=ZV();function Gf({children:e,className:t}){return Dt.jsx("div",{className:`bg-white rounded-lg shadow-sm ${t||""}`,children:e})}var jd={},Mp={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mk;function KV(){if(Mk)return Mp;Mk=1;var e=Dy();function t(fe){for(var Oe="https://reactjs.org/docs/error-decoder.html?invariant="+fe,We=1;We<arguments.length;We++)Oe+="&args[]="+encodeURIComponent(arguments[We]);return"Minified React error #"+fe+"; visit "+Oe+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=Object.prototype.hasOwnProperty,a=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},v={};function S(fe){return i.call(v,fe)?!0:i.call(h,fe)?!1:a.test(fe)?v[fe]=!0:(h[fe]=!0,!1)}function o(fe,Oe,We,dt,nn,Zt,fn){this.acceptsBooleans=Oe===2||Oe===3||Oe===4,this.attributeName=dt,this.attributeNamespace=nn,this.mustUseProperty=We,this.propertyName=fe,this.type=Oe,this.sanitizeURL=Zt,this.removeEmptyString=fn}var I={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(fe){I[fe]=new o(fe,0,!1,fe,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(fe){var Oe=fe[0];I[Oe]=new o(Oe,1,!1,fe[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(fe){I[fe]=new o(fe,2,!1,fe.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(fe){I[fe]=new o(fe,2,!1,fe,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(fe){I[fe]=new o(fe,3,!1,fe.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(fe){I[fe]=new o(fe,3,!0,fe,null,!1,!1)}),["capture","download"].forEach(function(fe){I[fe]=new o(fe,4,!1,fe,null,!1,!1)}),["cols","rows","size","span"].forEach(function(fe){I[fe]=new o(fe,6,!1,fe,null,!1,!1)}),["rowSpan","start"].forEach(function(fe){I[fe]=new o(fe,5,!1,fe.toLowerCase(),null,!1,!1)});var B=/[\-:]([a-z])/g;function $(fe){return fe[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(fe){var Oe=fe.replace(B,$);I[Oe]=new o(Oe,1,!1,fe,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(fe){var Oe=fe.replace(B,$);I[Oe]=new o(Oe,1,!1,fe,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(fe){var Oe=fe.replace(B,$);I[Oe]=new o(Oe,1,!1,fe,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(fe){I[fe]=new o(fe,1,!1,fe.toLowerCase(),null,!1,!1)}),I.xlinkHref=new o("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(fe){I[fe]=new o(fe,1,!1,fe.toLowerCase(),null,!0,!0)});var U={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},K=["Webkit","ms","Moz","O"];Object.keys(U).forEach(function(fe){K.forEach(function(Oe){Oe=Oe+fe.charAt(0).toUpperCase()+fe.substring(1),U[Oe]=U[fe]})});var te=/["'&<>]/;function le(fe){if(typeof fe=="boolean"||typeof fe=="number")return""+fe;fe=""+fe;var Oe=te.exec(fe);if(Oe){var We="",dt,nn=0;for(dt=Oe.index;dt<fe.length;dt++){switch(fe.charCodeAt(dt)){case 34:Oe="&quot;";break;case 38:Oe="&amp;";break;case 39:Oe="&#x27;";break;case 60:Oe="&lt;";break;case 62:Oe="&gt;";break;default:continue}nn!==dt&&(We+=fe.substring(nn,dt)),nn=dt+1,We+=Oe}fe=nn!==dt?We+fe.substring(nn,dt):We}return fe}var se=/([A-Z])/g,ue=/^ms-/,be=Array.isArray;function Ce(fe,Oe){return{insertionMode:fe,selectedValue:Oe}}function Re(fe,Oe,We){switch(Oe){case"select":return Ce(1,We.value!=null?We.value:We.defaultValue);case"svg":return Ce(2,null);case"math":return Ce(3,null);case"foreignObject":return Ce(1,null);case"table":return Ce(4,null);case"thead":case"tbody":case"tfoot":return Ce(5,null);case"colgroup":return Ce(7,null);case"tr":return Ce(6,null)}return 4<=fe.insertionMode||fe.insertionMode===0?Ce(1,null):fe}var De=new Map;function ve(fe,Oe,We){if(typeof We!="object")throw Error(t(62));Oe=!0;for(var dt in We)if(i.call(We,dt)){var nn=We[dt];if(nn!=null&&typeof nn!="boolean"&&nn!==""){if(dt.indexOf("--")===0){var Zt=le(dt);nn=le((""+nn).trim())}else{Zt=dt;var fn=De.get(Zt);fn!==void 0||(fn=le(Zt.replace(se,"-$1").toLowerCase().replace(ue,"-ms-")),De.set(Zt,fn)),Zt=fn,nn=typeof nn=="number"?nn===0||i.call(U,dt)?""+nn:nn+"px":le((""+nn).trim())}Oe?(Oe=!1,fe.push(' style="',Zt,":",nn)):fe.push(";",Zt,":",nn)}}Oe||fe.push('"')}function Le(fe,Oe,We,dt){switch(We){case"style":ve(fe,Oe,dt);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<We.length)||We[0]!=="o"&&We[0]!=="O"||We[1]!=="n"&&We[1]!=="N"){if(Oe=I.hasOwnProperty(We)?I[We]:null,Oe!==null){switch(typeof dt){case"function":case"symbol":return;case"boolean":if(!Oe.acceptsBooleans)return}switch(We=Oe.attributeName,Oe.type){case 3:dt&&fe.push(" ",We,'=""');break;case 4:dt===!0?fe.push(" ",We,'=""'):dt!==!1&&fe.push(" ",We,'="',le(dt),'"');break;case 5:isNaN(dt)||fe.push(" ",We,'="',le(dt),'"');break;case 6:!isNaN(dt)&&1<=dt&&fe.push(" ",We,'="',le(dt),'"');break;default:Oe.sanitizeURL&&(dt=""+dt),fe.push(" ",We,'="',le(dt),'"')}}else if(S(We)){switch(typeof dt){case"function":case"symbol":return;case"boolean":if(Oe=We.toLowerCase().slice(0,5),Oe!=="data-"&&Oe!=="aria-")return}fe.push(" ",We,'="',le(dt),'"')}}}function Fe(fe,Oe,We){if(Oe!=null){if(We!=null)throw Error(t(60));if(typeof Oe!="object"||!("__html"in Oe))throw Error(t(61));Oe=Oe.__html,Oe!=null&&fe.push(""+Oe)}}function lt(fe){var Oe="";return e.Children.forEach(fe,function(We){We!=null&&(Oe+=We)}),Oe}function xt(fe,Oe,We,dt){fe.push(St(We));var nn=We=null,Zt;for(Zt in Oe)if(i.call(Oe,Zt)){var fn=Oe[Zt];if(fn!=null)switch(Zt){case"children":We=fn;break;case"dangerouslySetInnerHTML":nn=fn;break;default:Le(fe,dt,Zt,fn)}}return fe.push(">"),Fe(fe,nn,We),typeof We=="string"?(fe.push(le(We)),null):We}var gt=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Je=new Map;function St(fe){var Oe=Je.get(fe);if(Oe===void 0){if(!gt.test(fe))throw Error(t(65,fe));Oe="<"+fe,Je.set(fe,Oe)}return Oe}function Nt(fe,Oe,We,dt,nn){switch(Oe){case"select":fe.push(St("select"));var Zt=null,fn=null;for(Ur in We)if(i.call(We,Ur)){var Cn=We[Ur];if(Cn!=null)switch(Ur){case"children":Zt=Cn;break;case"dangerouslySetInnerHTML":fn=Cn;break;case"defaultValue":case"value":break;default:Le(fe,dt,Ur,Cn)}}return fe.push(">"),Fe(fe,fn,Zt),Zt;case"option":fn=nn.selectedValue,fe.push(St("option"));var Gn=Cn=null,Cr=null,Ur=null;for(Zt in We)if(i.call(We,Zt)){var Ri=We[Zt];if(Ri!=null)switch(Zt){case"children":Cn=Ri;break;case"selected":Cr=Ri;break;case"dangerouslySetInnerHTML":Ur=Ri;break;case"value":Gn=Ri;default:Le(fe,dt,Zt,Ri)}}if(fn!=null)if(We=Gn!==null?""+Gn:lt(Cn),be(fn)){for(dt=0;dt<fn.length;dt++)if(""+fn[dt]===We){fe.push(' selected=""');break}}else""+fn===We&&fe.push(' selected=""');else Cr&&fe.push(' selected=""');return fe.push(">"),Fe(fe,Ur,Cn),Cn;case"textarea":fe.push(St("textarea")),Ur=fn=Zt=null;for(Cn in We)if(i.call(We,Cn)&&(Gn=We[Cn],Gn!=null))switch(Cn){case"children":Ur=Gn;break;case"value":Zt=Gn;break;case"defaultValue":fn=Gn;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:Le(fe,dt,Cn,Gn)}if(Zt===null&&fn!==null&&(Zt=fn),fe.push(">"),Ur!=null){if(Zt!=null)throw Error(t(92));if(be(Ur)&&1<Ur.length)throw Error(t(93));Zt=""+Ur}return typeof Zt=="string"&&Zt[0]===`
`&&fe.push(`
`),Zt!==null&&fe.push(le(""+Zt)),null;case"input":fe.push(St("input")),Gn=Ur=Cn=Zt=null;for(fn in We)if(i.call(We,fn)&&(Cr=We[fn],Cr!=null))switch(fn){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":Gn=Cr;break;case"defaultValue":Cn=Cr;break;case"checked":Ur=Cr;break;case"value":Zt=Cr;break;default:Le(fe,dt,fn,Cr)}return Ur!==null?Le(fe,dt,"checked",Ur):Gn!==null&&Le(fe,dt,"checked",Gn),Zt!==null?Le(fe,dt,"value",Zt):Cn!==null&&Le(fe,dt,"value",Cn),fe.push("/>"),null;case"menuitem":fe.push(St("menuitem"));for(var So in We)if(i.call(We,So)&&(Zt=We[So],Zt!=null))switch(So){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:Le(fe,dt,So,Zt)}return fe.push(">"),null;case"title":fe.push(St("title")),Zt=null;for(Ri in We)if(i.call(We,Ri)&&(fn=We[Ri],fn!=null))switch(Ri){case"children":Zt=fn;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:Le(fe,dt,Ri,fn)}return fe.push(">"),Zt;case"listing":case"pre":fe.push(St(Oe)),fn=Zt=null;for(Gn in We)if(i.call(We,Gn)&&(Cn=We[Gn],Cn!=null))switch(Gn){case"children":Zt=Cn;break;case"dangerouslySetInnerHTML":fn=Cn;break;default:Le(fe,dt,Gn,Cn)}if(fe.push(">"),fn!=null){if(Zt!=null)throw Error(t(60));if(typeof fn!="object"||!("__html"in fn))throw Error(t(61));We=fn.__html,We!=null&&(typeof We=="string"&&0<We.length&&We[0]===`
`?fe.push(`
`,We):fe.push(""+We))}return typeof Zt=="string"&&Zt[0]===`
`&&fe.push(`
`),Zt;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":fe.push(St(Oe));for(var To in We)if(i.call(We,To)&&(Zt=We[To],Zt!=null))switch(To){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,Oe));default:Le(fe,dt,To,Zt)}return fe.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return xt(fe,We,Oe,dt);case"html":return nn.insertionMode===0&&fe.push("<!DOCTYPE html>"),xt(fe,We,Oe,dt);default:if(Oe.indexOf("-")===-1&&typeof We.is!="string")return xt(fe,We,Oe,dt);fe.push(St(Oe)),fn=Zt=null;for(Cr in We)if(i.call(We,Cr)&&(Cn=We[Cr],Cn!=null))switch(Cr){case"children":Zt=Cn;break;case"dangerouslySetInnerHTML":fn=Cn;break;case"style":ve(fe,dt,Cn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:S(Cr)&&typeof Cn!="function"&&typeof Cn!="symbol"&&fe.push(" ",Cr,'="',le(Cn),'"')}return fe.push(">"),Fe(fe,fn,Zt),Zt}}function Ht(fe,Oe,We){if(fe.push('<!--$?--><template id="'),We===null)throw Error(t(395));return fe.push(We),fe.push('"></template>')}function Ct(fe,Oe,We,dt){switch(We.insertionMode){case 0:case 1:return fe.push('<div hidden id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');case 2:return fe.push('<svg aria-hidden="true" style="display:none" id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');case 3:return fe.push('<math aria-hidden="true" style="display:none" id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');case 4:return fe.push('<table hidden id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');case 5:return fe.push('<table hidden><tbody id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');case 6:return fe.push('<table hidden><tr id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');case 7:return fe.push('<table hidden><colgroup id="'),fe.push(Oe.segmentPrefix),Oe=dt.toString(16),fe.push(Oe),fe.push('">');default:throw Error(t(397))}}function Kt(fe,Oe){switch(Oe.insertionMode){case 0:case 1:return fe.push("</div>");case 2:return fe.push("</svg>");case 3:return fe.push("</math>");case 4:return fe.push("</table>");case 5:return fe.push("</tbody></table>");case 6:return fe.push("</tr></table>");case 7:return fe.push("</colgroup></table>");default:throw Error(t(397))}}var Lt=/[<\u2028\u2029]/g;function et(fe){return JSON.stringify(fe).replace(Lt,function(Oe){switch(Oe){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function vt(fe,Oe){return Oe=Oe===void 0?"":Oe,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:Oe+"P:",segmentPrefix:Oe+"S:",boundaryPrefix:Oe+"B:",idPrefix:Oe,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:fe}}function Ot(fe,Oe,We,dt){return We.generateStaticMarkup?(fe.push(le(Oe)),!1):(Oe===""?fe=dt:(dt&&fe.push("<!-- -->"),fe.push(le(Oe)),fe=!0),fe)}var mt=Object.assign,zt=Symbol.for("react.element"),Jt=Symbol.for("react.portal"),Un=Symbol.for("react.fragment"),$n=Symbol.for("react.strict_mode"),Bn=Symbol.for("react.profiler"),$r=Symbol.for("react.provider"),_r=Symbol.for("react.context"),Pn=Symbol.for("react.forward_ref"),Ke=Symbol.for("react.suspense"),mr=Symbol.for("react.suspense_list"),Sn=Symbol.for("react.memo"),Dr=Symbol.for("react.lazy"),Yt=Symbol.for("react.scope"),Mr=Symbol.for("react.debug_trace_mode"),Qn=Symbol.for("react.legacy_hidden"),Ar=Symbol.for("react.default_value"),sr=Symbol.iterator;function _i(fe){if(fe==null)return null;if(typeof fe=="function")return fe.displayName||fe.name||null;if(typeof fe=="string")return fe;switch(fe){case Un:return"Fragment";case Jt:return"Portal";case Bn:return"Profiler";case $n:return"StrictMode";case Ke:return"Suspense";case mr:return"SuspenseList"}if(typeof fe=="object")switch(fe.$$typeof){case _r:return(fe.displayName||"Context")+".Consumer";case $r:return(fe._context.displayName||"Context")+".Provider";case Pn:var Oe=fe.render;return fe=fe.displayName,fe||(fe=Oe.displayName||Oe.name||"",fe=fe!==""?"ForwardRef("+fe+")":"ForwardRef"),fe;case Sn:return Oe=fe.displayName||null,Oe!==null?Oe:_i(fe.type)||"Memo";case Dr:Oe=fe._payload,fe=fe._init;try{return _i(fe(Oe))}catch{}}return null}var Wi={};function ii(fe,Oe){if(fe=fe.contextTypes,!fe)return Wi;var We={},dt;for(dt in fe)We[dt]=Oe[dt];return We}var Pi=null;function yi(fe,Oe){if(fe!==Oe){fe.context._currentValue2=fe.parentValue,fe=fe.parent;var We=Oe.parent;if(fe===null){if(We!==null)throw Error(t(401))}else{if(We===null)throw Error(t(401));yi(fe,We)}Oe.context._currentValue2=Oe.value}}function lr(fe){fe.context._currentValue2=fe.parentValue,fe=fe.parent,fe!==null&&lr(fe)}function qo(fe){var Oe=fe.parent;Oe!==null&&qo(Oe),fe.context._currentValue2=fe.value}function ea(fe,Oe){if(fe.context._currentValue2=fe.parentValue,fe=fe.parent,fe===null)throw Error(t(402));fe.depth===Oe.depth?yi(fe,Oe):ea(fe,Oe)}function la(fe,Oe){var We=Oe.parent;if(We===null)throw Error(t(402));fe.depth===We.depth?yi(fe,We):la(fe,We),Oe.context._currentValue2=Oe.value}function Fi(fe){var Oe=Pi;Oe!==fe&&(Oe===null?qo(fe):fe===null?lr(Oe):Oe.depth===fe.depth?yi(Oe,fe):Oe.depth>fe.depth?ea(Oe,fe):la(Oe,fe),Pi=fe)}var Mo={isMounted:function(){return!1},enqueueSetState:function(fe,Oe){fe=fe._reactInternals,fe.queue!==null&&fe.queue.push(Oe)},enqueueReplaceState:function(fe,Oe){fe=fe._reactInternals,fe.replace=!0,fe.queue=[Oe]},enqueueForceUpdate:function(){}};function ta(fe,Oe,We,dt){var nn=fe.state!==void 0?fe.state:null;fe.updater=Mo,fe.props=We,fe.state=nn;var Zt={queue:[],replace:!1};fe._reactInternals=Zt;var fn=Oe.contextType;if(fe.context=typeof fn=="object"&&fn!==null?fn._currentValue2:dt,fn=Oe.getDerivedStateFromProps,typeof fn=="function"&&(fn=fn(We,nn),nn=fn==null?nn:mt({},nn,fn),fe.state=nn),typeof Oe.getDerivedStateFromProps!="function"&&typeof fe.getSnapshotBeforeUpdate!="function"&&(typeof fe.UNSAFE_componentWillMount=="function"||typeof fe.componentWillMount=="function"))if(Oe=fe.state,typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount(),Oe!==fe.state&&Mo.enqueueReplaceState(fe,fe.state,null),Zt.queue!==null&&0<Zt.queue.length)if(Oe=Zt.queue,fn=Zt.replace,Zt.queue=null,Zt.replace=!1,fn&&Oe.length===1)fe.state=Oe[0];else{for(Zt=fn?Oe[0]:fe.state,nn=!0,fn=fn?1:0;fn<Oe.length;fn++){var Cn=Oe[fn];Cn=typeof Cn=="function"?Cn.call(fe,Zt,We,dt):Cn,Cn!=null&&(nn?(nn=!1,Zt=mt({},Zt,Cn)):mt(Zt,Cn))}fe.state=Zt}else Zt.queue=null}var va={id:1,overflow:""};function za(fe,Oe,We){var dt=fe.id;fe=fe.overflow;var nn=32-so(dt)-1;dt&=~(1<<nn),We+=1;var Zt=32-so(Oe)+nn;if(30<Zt){var fn=nn-nn%5;return Zt=(dt&(1<<fn)-1).toString(32),dt>>=fn,nn-=fn,{id:1<<32-so(Oe)+nn|We<<nn|dt,overflow:Zt+fe}}return{id:1<<Zt|We<<nn|dt,overflow:fe}}var so=Math.clz32?Math.clz32:Go,Lo=Math.log,es=Math.LN2;function Go(fe){return fe>>>=0,fe===0?32:31-(Lo(fe)/es|0)|0}function Fa(fe,Oe){return fe===Oe&&(fe!==0||1/fe===1/Oe)||fe!==fe&&Oe!==Oe}var Er=typeof Object.is=="function"?Object.is:Fa,go=null,Ia=null,Di=null,vi=null,bi=!1,Mi=!1,Fo=0,na=null,kt=0;function Se(){if(go===null)throw Error(t(321));return go}function Z(){if(0<kt)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function re(){return vi===null?Di===null?(bi=!1,Di=vi=Z()):(bi=!0,vi=Di):vi.next===null?(bi=!1,vi=vi.next=Z()):(bi=!0,vi=vi.next),vi}function ce(){Ia=go=null,Mi=!1,Di=null,kt=0,vi=na=null}function de(fe,Oe){return typeof Oe=="function"?Oe(fe):Oe}function xe(fe,Oe,We){if(go=Se(),vi=re(),bi){var dt=vi.queue;if(Oe=dt.dispatch,na!==null&&(We=na.get(dt),We!==void 0)){na.delete(dt),dt=vi.memoizedState;do dt=fe(dt,We.action),We=We.next;while(We!==null);return vi.memoizedState=dt,[dt,Oe]}return[vi.memoizedState,Oe]}return fe=fe===de?typeof Oe=="function"?Oe():Oe:We!==void 0?We(Oe):Oe,vi.memoizedState=fe,fe=vi.queue={last:null,dispatch:null},fe=fe.dispatch=Ae.bind(null,go,fe),[vi.memoizedState,fe]}function Ie(fe,Oe){if(go=Se(),vi=re(),Oe=Oe===void 0?null:Oe,vi!==null){var We=vi.memoizedState;if(We!==null&&Oe!==null){var dt=We[1];e:if(dt===null)dt=!1;else{for(var nn=0;nn<dt.length&&nn<Oe.length;nn++)if(!Er(Oe[nn],dt[nn])){dt=!1;break e}dt=!0}if(dt)return We[0]}}return fe=fe(),vi.memoizedState=[fe,Oe],fe}function Ae(fe,Oe,We){if(25<=kt)throw Error(t(301));if(fe===go)if(Mi=!0,fe={action:We,next:null},na===null&&(na=new Map),We=na.get(Oe),We===void 0)na.set(Oe,fe);else{for(Oe=We;Oe.next!==null;)Oe=Oe.next;Oe.next=fe}}function Be(){throw Error(t(394))}function tt(){}var ut={readContext:function(fe){return fe._currentValue2},useContext:function(fe){return Se(),fe._currentValue2},useMemo:Ie,useReducer:xe,useRef:function(fe){go=Se(),vi=re();var Oe=vi.memoizedState;return Oe===null?(fe={current:fe},vi.memoizedState=fe):Oe},useState:function(fe){return xe(de,fe)},useInsertionEffect:tt,useLayoutEffect:function(){},useCallback:function(fe,Oe){return Ie(function(){return fe},Oe)},useImperativeHandle:tt,useEffect:tt,useDebugValue:tt,useDeferredValue:function(fe){return Se(),fe},useTransition:function(){return Se(),[!1,Be]},useId:function(){var fe=Ia.treeContext,Oe=fe.overflow;fe=fe.id,fe=(fe&~(1<<32-so(fe)-1)).toString(32)+Oe;var We=Tt;if(We===null)throw Error(t(404));return Oe=Fo++,fe=":"+We.idPrefix+"R"+fe,0<Oe&&(fe+="H"+Oe.toString(32)),fe+":"},useMutableSource:function(fe,Oe){return Se(),Oe(fe._source)},useSyncExternalStore:function(fe,Oe,We){if(We===void 0)throw Error(t(407));return We()}},Tt=null,Wt=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Vt(fe){return console.error(fe),null}function Gt(){}function gn(fe,Oe,We,dt,nn,Zt,fn,Cn,Gn){var Cr=[],Ur=new Set;return Oe={destination:null,responseState:Oe,progressiveChunkSize:dt===void 0?12800:dt,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Ur,pingedTasks:Cr,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:nn===void 0?Vt:nn,onAllReady:Gt,onShellReady:fn===void 0?Gt:fn,onShellError:Gt,onFatalError:Gt},We=In(Oe,0,null,We,!1,!1),We.parentFlushed=!0,fe=Tn(Oe,fe,null,We,Ur,Wi,null,va),Cr.push(fe),Oe}function Tn(fe,Oe,We,dt,nn,Zt,fn,Cn){fe.allPendingTasks++,We===null?fe.pendingRootTasks++:We.pendingTasks++;var Gn={node:Oe,ping:function(){var Cr=fe.pingedTasks;Cr.push(Gn),Cr.length===1&&ci(fe)},blockedBoundary:We,blockedSegment:dt,abortSet:nn,legacyContext:Zt,context:fn,treeContext:Cn};return nn.add(Gn),Gn}function In(fe,Oe,We,dt,nn,Zt){return{status:0,id:-1,index:Oe,parentFlushed:!1,chunks:[],children:[],formatContext:dt,boundary:We,lastPushedText:nn,textEmbedded:Zt}}function Ln(fe,Oe){if(fe=fe.onError(Oe),fe!=null&&typeof fe!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof fe+'" instead');return fe}function dr(fe,Oe){var We=fe.onShellError;We(Oe),We=fe.onFatalError,We(Oe),fe.destination!==null?(fe.status=2,fe.destination.destroy(Oe)):(fe.status=1,fe.fatalError=Oe)}function Zn(fe,Oe,We,dt,nn){for(go={},Ia=Oe,Fo=0,fe=We(dt,nn);Mi;)Mi=!1,Fo=0,kt+=1,vi=null,fe=We(dt,nn);return ce(),fe}function Zr(fe,Oe,We,dt){var nn=We.render(),Zt=dt.childContextTypes;if(Zt!=null){var fn=Oe.legacyContext;if(typeof We.getChildContext!="function")dt=fn;else{We=We.getChildContext();for(var Cn in We)if(!(Cn in Zt))throw Error(t(108,_i(dt)||"Unknown",Cn));dt=mt({},fn,We)}Oe.legacyContext=dt,hn(fe,Oe,nn),Oe.legacyContext=fn}else hn(fe,Oe,nn)}function ri(fe,Oe){if(fe&&fe.defaultProps){Oe=mt({},Oe),fe=fe.defaultProps;for(var We in fe)Oe[We]===void 0&&(Oe[We]=fe[We]);return Oe}return Oe}function nr(fe,Oe,We,dt,nn){if(typeof We=="function")if(We.prototype&&We.prototype.isReactComponent){nn=ii(We,Oe.legacyContext);var Zt=We.contextType;Zt=new We(dt,typeof Zt=="object"&&Zt!==null?Zt._currentValue2:nn),ta(Zt,We,dt,nn),Zr(fe,Oe,Zt,We)}else{Zt=ii(We,Oe.legacyContext),nn=Zn(fe,Oe,We,dt,Zt);var fn=Fo!==0;if(typeof nn=="object"&&nn!==null&&typeof nn.render=="function"&&nn.$$typeof===void 0)ta(nn,We,dt,Zt),Zr(fe,Oe,nn,We);else if(fn){dt=Oe.treeContext,Oe.treeContext=za(dt,1,0);try{hn(fe,Oe,nn)}finally{Oe.treeContext=dt}}else hn(fe,Oe,nn)}else if(typeof We=="string"){switch(nn=Oe.blockedSegment,Zt=Nt(nn.chunks,We,dt,fe.responseState,nn.formatContext),nn.lastPushedText=!1,fn=nn.formatContext,nn.formatContext=Re(fn,We,dt),br(fe,Oe,Zt),nn.formatContext=fn,We){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:nn.chunks.push("</",We,">")}nn.lastPushedText=!1}else{switch(We){case Qn:case Mr:case $n:case Bn:case Un:hn(fe,Oe,dt.children);return;case mr:hn(fe,Oe,dt.children);return;case Yt:throw Error(t(343));case Ke:e:{We=Oe.blockedBoundary,nn=Oe.blockedSegment,Zt=dt.fallback,dt=dt.children,fn=new Set;var Cn={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:fn,errorDigest:null},Gn=In(fe,nn.chunks.length,Cn,nn.formatContext,!1,!1);nn.children.push(Gn),nn.lastPushedText=!1;var Cr=In(fe,0,null,nn.formatContext,!1,!1);Cr.parentFlushed=!0,Oe.blockedBoundary=Cn,Oe.blockedSegment=Cr;try{if(br(fe,Oe,dt),fe.responseState.generateStaticMarkup||Cr.lastPushedText&&Cr.textEmbedded&&Cr.chunks.push("<!-- -->"),Cr.status=1,Kr(Cn,Cr),Cn.pendingTasks===0)break e}catch(Ur){Cr.status=4,Cn.forceClientRender=!0,Cn.errorDigest=Ln(fe,Ur)}finally{Oe.blockedBoundary=We,Oe.blockedSegment=nn}Oe=Tn(fe,Zt,We,Gn,fn,Oe.legacyContext,Oe.context,Oe.treeContext),fe.pingedTasks.push(Oe)}return}if(typeof We=="object"&&We!==null)switch(We.$$typeof){case Pn:if(dt=Zn(fe,Oe,We.render,dt,nn),Fo!==0){We=Oe.treeContext,Oe.treeContext=za(We,1,0);try{hn(fe,Oe,dt)}finally{Oe.treeContext=We}}else hn(fe,Oe,dt);return;case Sn:We=We.type,dt=ri(We,dt),nr(fe,Oe,We,dt,nn);return;case $r:if(nn=dt.children,We=We._context,dt=dt.value,Zt=We._currentValue2,We._currentValue2=dt,fn=Pi,Pi=dt={parent:fn,depth:fn===null?0:fn.depth+1,context:We,parentValue:Zt,value:dt},Oe.context=dt,hn(fe,Oe,nn),fe=Pi,fe===null)throw Error(t(403));dt=fe.parentValue,fe.context._currentValue2=dt===Ar?fe.context._defaultValue:dt,fe=Pi=fe.parent,Oe.context=fe;return;case _r:dt=dt.children,dt=dt(We._currentValue2),hn(fe,Oe,dt);return;case Dr:nn=We._init,We=nn(We._payload),dt=ri(We,dt),nr(fe,Oe,We,dt,void 0);return}throw Error(t(130,We==null?We:typeof We,""))}}function hn(fe,Oe,We){if(Oe.node=We,typeof We=="object"&&We!==null){switch(We.$$typeof){case zt:nr(fe,Oe,We.type,We.props,We.ref);return;case Jt:throw Error(t(257));case Dr:var dt=We._init;We=dt(We._payload),hn(fe,Oe,We);return}if(be(We)){Kn(fe,Oe,We);return}if(We===null||typeof We!="object"?dt=null:(dt=sr&&We[sr]||We["@@iterator"],dt=typeof dt=="function"?dt:null),dt&&(dt=dt.call(We))){if(We=dt.next(),!We.done){var nn=[];do nn.push(We.value),We=dt.next();while(!We.done);Kn(fe,Oe,nn)}return}throw fe=Object.prototype.toString.call(We),Error(t(31,fe==="[object Object]"?"object with keys {"+Object.keys(We).join(", ")+"}":fe))}typeof We=="string"?(dt=Oe.blockedSegment,dt.lastPushedText=Ot(Oe.blockedSegment.chunks,We,fe.responseState,dt.lastPushedText)):typeof We=="number"&&(dt=Oe.blockedSegment,dt.lastPushedText=Ot(Oe.blockedSegment.chunks,""+We,fe.responseState,dt.lastPushedText))}function Kn(fe,Oe,We){for(var dt=We.length,nn=0;nn<dt;nn++){var Zt=Oe.treeContext;Oe.treeContext=za(Zt,dt,nn);try{br(fe,Oe,We[nn])}finally{Oe.treeContext=Zt}}}function br(fe,Oe,We){var dt=Oe.blockedSegment.formatContext,nn=Oe.legacyContext,Zt=Oe.context;try{return hn(fe,Oe,We)}catch(Gn){if(ce(),typeof Gn=="object"&&Gn!==null&&typeof Gn.then=="function"){We=Gn;var fn=Oe.blockedSegment,Cn=In(fe,fn.chunks.length,null,fn.formatContext,fn.lastPushedText,!0);fn.children.push(Cn),fn.lastPushedText=!1,fe=Tn(fe,Oe.node,Oe.blockedBoundary,Cn,Oe.abortSet,Oe.legacyContext,Oe.context,Oe.treeContext).ping,We.then(fe,fe),Oe.blockedSegment.formatContext=dt,Oe.legacyContext=nn,Oe.context=Zt,Fi(Zt)}else throw Oe.blockedSegment.formatContext=dt,Oe.legacyContext=nn,Oe.context=Zt,Fi(Zt),Gn}}function oi(fe){var Oe=fe.blockedBoundary;fe=fe.blockedSegment,fe.status=3,qr(this,Oe,fe)}function Ir(fe,Oe,We){var dt=fe.blockedBoundary;fe.blockedSegment.status=3,dt===null?(Oe.allPendingTasks--,Oe.status!==2&&(Oe.status=2,Oe.destination!==null&&Oe.destination.push(null))):(dt.pendingTasks--,dt.forceClientRender||(dt.forceClientRender=!0,fe=We===void 0?Error(t(432)):We,dt.errorDigest=Oe.onError(fe),dt.parentFlushed&&Oe.clientRenderedBoundaries.push(dt)),dt.fallbackAbortableTasks.forEach(function(nn){return Ir(nn,Oe,We)}),dt.fallbackAbortableTasks.clear(),Oe.allPendingTasks--,Oe.allPendingTasks===0&&(dt=Oe.onAllReady,dt()))}function Kr(fe,Oe){if(Oe.chunks.length===0&&Oe.children.length===1&&Oe.children[0].boundary===null){var We=Oe.children[0];We.id=Oe.id,We.parentFlushed=!0,We.status===1&&Kr(fe,We)}else fe.completedSegments.push(Oe)}function qr(fe,Oe,We){if(Oe===null){if(We.parentFlushed){if(fe.completedRootSegment!==null)throw Error(t(389));fe.completedRootSegment=We}fe.pendingRootTasks--,fe.pendingRootTasks===0&&(fe.onShellError=Gt,Oe=fe.onShellReady,Oe())}else Oe.pendingTasks--,Oe.forceClientRender||(Oe.pendingTasks===0?(We.parentFlushed&&We.status===1&&Kr(Oe,We),Oe.parentFlushed&&fe.completedBoundaries.push(Oe),Oe.fallbackAbortableTasks.forEach(oi,fe),Oe.fallbackAbortableTasks.clear()):We.parentFlushed&&We.status===1&&(Kr(Oe,We),Oe.completedSegments.length===1&&Oe.parentFlushed&&fe.partialBoundaries.push(Oe)));fe.allPendingTasks--,fe.allPendingTasks===0&&(fe=fe.onAllReady,fe())}function ci(fe){if(fe.status!==2){var Oe=Pi,We=Wt.current;Wt.current=ut;var dt=Tt;Tt=fe.responseState;try{var nn=fe.pingedTasks,Zt;for(Zt=0;Zt<nn.length;Zt++){var fn=nn[Zt],Cn=fe,Gn=fn.blockedSegment;if(Gn.status===0){Fi(fn.context);try{hn(Cn,fn,fn.node),Cn.responseState.generateStaticMarkup||Gn.lastPushedText&&Gn.textEmbedded&&Gn.chunks.push("<!-- -->"),fn.abortSet.delete(fn),Gn.status=1,qr(Cn,fn.blockedBoundary,Gn)}catch(wr){if(ce(),typeof wr=="object"&&wr!==null&&typeof wr.then=="function"){var Cr=fn.ping;wr.then(Cr,Cr)}else{fn.abortSet.delete(fn),Gn.status=4;var Ur=fn.blockedBoundary,Ri=wr,So=Ln(Cn,Ri);if(Ur===null?dr(Cn,Ri):(Ur.pendingTasks--,Ur.forceClientRender||(Ur.forceClientRender=!0,Ur.errorDigest=So,Ur.parentFlushed&&Cn.clientRenderedBoundaries.push(Ur))),Cn.allPendingTasks--,Cn.allPendingTasks===0){var To=Cn.onAllReady;To()}}}finally{}}}nn.splice(0,Zt),fe.destination!==null&&uo(fe,fe.destination)}catch(wr){Ln(fe,wr),dr(fe,wr)}finally{Tt=dt,Wt.current=We,We===ut&&Fi(Oe)}}}function Zi(fe,Oe,We){switch(We.parentFlushed=!0,We.status){case 0:var dt=We.id=fe.nextSegmentId++;return We.lastPushedText=!1,We.textEmbedded=!1,fe=fe.responseState,Oe.push('<template id="'),Oe.push(fe.placeholderPrefix),fe=dt.toString(16),Oe.push(fe),Oe.push('"></template>');case 1:We.status=2;var nn=!0;dt=We.chunks;var Zt=0;We=We.children;for(var fn=0;fn<We.length;fn++){for(nn=We[fn];Zt<nn.index;Zt++)Oe.push(dt[Zt]);nn=Xn(fe,Oe,nn)}for(;Zt<dt.length-1;Zt++)Oe.push(dt[Zt]);return Zt<dt.length&&(nn=Oe.push(dt[Zt])),nn;default:throw Error(t(390))}}function Xn(fe,Oe,We){var dt=We.boundary;if(dt===null)return Zi(fe,Oe,We);if(dt.parentFlushed=!0,dt.forceClientRender)return fe.responseState.generateStaticMarkup||(dt=dt.errorDigest,Oe.push("<!--$!-->"),Oe.push("<template"),dt&&(Oe.push(' data-dgst="'),dt=le(dt),Oe.push(dt),Oe.push('"')),Oe.push("></template>")),Zi(fe,Oe,We),fe=fe.responseState.generateStaticMarkup?!0:Oe.push("<!--/$-->"),fe;if(0<dt.pendingTasks){dt.rootSegmentID=fe.nextSegmentId++,0<dt.completedSegments.length&&fe.partialBoundaries.push(dt);var nn=fe.responseState,Zt=nn.nextSuspenseID++;return nn=nn.boundaryPrefix+Zt.toString(16),dt=dt.id=nn,Ht(Oe,fe.responseState,dt),Zi(fe,Oe,We),Oe.push("<!--/$-->")}if(dt.byteSize>fe.progressiveChunkSize)return dt.rootSegmentID=fe.nextSegmentId++,fe.completedBoundaries.push(dt),Ht(Oe,fe.responseState,dt.id),Zi(fe,Oe,We),Oe.push("<!--/$-->");if(fe.responseState.generateStaticMarkup||Oe.push("<!--$-->"),We=dt.completedSegments,We.length!==1)throw Error(t(391));return Xn(fe,Oe,We[0]),fe=fe.responseState.generateStaticMarkup?!0:Oe.push("<!--/$-->"),fe}function Gr(fe,Oe,We){return Ct(Oe,fe.responseState,We.formatContext,We.id),Xn(fe,Oe,We),Kt(Oe,We.formatContext)}function xa(fe,Oe,We){for(var dt=We.completedSegments,nn=0;nn<dt.length;nn++)lo(fe,Oe,We,dt[nn]);if(dt.length=0,fe=fe.responseState,dt=We.id,We=We.rootSegmentID,Oe.push(fe.startInlineScript),fe.sentCompleteBoundaryFunction?Oe.push('$RC("'):(fe.sentCompleteBoundaryFunction=!0,Oe.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),dt===null)throw Error(t(395));return We=We.toString(16),Oe.push(dt),Oe.push('","'),Oe.push(fe.segmentPrefix),Oe.push(We),Oe.push('")<\/script>')}function lo(fe,Oe,We,dt){if(dt.status===2)return!0;var nn=dt.id;if(nn===-1){if((dt.id=We.rootSegmentID)===-1)throw Error(t(392));return Gr(fe,Oe,dt)}return Gr(fe,Oe,dt),fe=fe.responseState,Oe.push(fe.startInlineScript),fe.sentCompleteSegmentFunction?Oe.push('$RS("'):(fe.sentCompleteSegmentFunction=!0,Oe.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),Oe.push(fe.segmentPrefix),nn=nn.toString(16),Oe.push(nn),Oe.push('","'),Oe.push(fe.placeholderPrefix),Oe.push(nn),Oe.push('")<\/script>')}function uo(fe,Oe){try{var We=fe.completedRootSegment;if(We!==null&&fe.pendingRootTasks===0){Xn(fe,Oe,We),fe.completedRootSegment=null;var dt=fe.responseState.bootstrapChunks;for(We=0;We<dt.length-1;We++)Oe.push(dt[We]);We<dt.length&&Oe.push(dt[We])}var nn=fe.clientRenderedBoundaries,Zt;for(Zt=0;Zt<nn.length;Zt++){var fn=nn[Zt];dt=Oe;var Cn=fe.responseState,Gn=fn.id,Cr=fn.errorDigest,Ur=fn.errorMessage,Ri=fn.errorComponentStack;if(dt.push(Cn.startInlineScript),Cn.sentClientRenderFunction?dt.push('$RX("'):(Cn.sentClientRenderFunction=!0,dt.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),Gn===null)throw Error(t(395));if(dt.push(Gn),dt.push('"'),Cr||Ur||Ri){dt.push(",");var So=et(Cr||"");dt.push(So)}if(Ur||Ri){dt.push(",");var To=et(Ur||"");dt.push(To)}if(Ri){dt.push(",");var wr=et(Ri);dt.push(wr)}if(!dt.push(")<\/script>")){fe.destination=null,Zt++,nn.splice(0,Zt);return}}nn.splice(0,Zt);var Ba=fe.completedBoundaries;for(Zt=0;Zt<Ba.length;Zt++)if(!xa(fe,Oe,Ba[Zt])){fe.destination=null,Zt++,Ba.splice(0,Zt);return}Ba.splice(0,Zt);var Pr=fe.partialBoundaries;for(Zt=0;Zt<Pr.length;Zt++){var Ho=Pr[Zt];e:{nn=fe,fn=Oe;var Yn=Ho.completedSegments;for(Cn=0;Cn<Yn.length;Cn++)if(!lo(nn,fn,Ho,Yn[Cn])){Cn++,Yn.splice(0,Cn);var Wo=!1;break e}Yn.splice(0,Cn),Wo=!0}if(!Wo){fe.destination=null,Zt++,Pr.splice(0,Zt);return}}Pr.splice(0,Zt);var ba=fe.completedBoundaries;for(Zt=0;Zt<ba.length;Zt++)if(!xa(fe,Oe,ba[Zt])){fe.destination=null,Zt++,ba.splice(0,Zt);return}ba.splice(0,Zt)}finally{fe.allPendingTasks===0&&fe.pingedTasks.length===0&&fe.clientRenderedBoundaries.length===0&&fe.completedBoundaries.length===0&&Oe.push(null)}}function wo(fe,Oe){try{var We=fe.abortableTasks;We.forEach(function(dt){return Ir(dt,fe,Oe)}),We.clear(),fe.destination!==null&&uo(fe,fe.destination)}catch(dt){Ln(fe,dt),dr(fe,dt)}}function yr(){}function wi(fe,Oe,We,dt){var nn=!1,Zt=null,fn="",Cn={push:function(Cr){return Cr!==null&&(fn+=Cr),!0},destroy:function(Cr){nn=!0,Zt=Cr}},Gn=!1;if(fe=gn(fe,vt(We,Oe?Oe.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,yr,void 0,function(){Gn=!0}),ci(fe),wo(fe,dt),fe.status===1)fe.status=2,Cn.destroy(fe.fatalError);else if(fe.status!==2&&fe.destination===null){fe.destination=Cn;try{uo(fe,Cn)}catch(Cr){Ln(fe,Cr),dr(fe,Cr)}}if(nn)throw Zt;if(!Gn)throw Error(t(426));return fn}return Mp.renderToNodeStream=function(){throw Error(t(207))},Mp.renderToStaticMarkup=function(fe,Oe){return wi(fe,Oe,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Mp.renderToStaticNodeStream=function(){throw Error(t(208))},Mp.renderToString=function(fe,Oe){return wi(fe,Oe,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},Mp.version="18.3.1",Mp}var qv={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik;function YV(){if(Ik)return qv;Ik=1;var e=Dy();function t(pe){for(var Pe="https://reactjs.org/docs/error-decoder.html?invariant="+pe,Xe=1;Xe<arguments.length;Xe++)Pe+="&args[]="+encodeURIComponent(arguments[Xe]);return"Minified React error #"+pe+"; visit "+Pe+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=null,a=0;function h(pe,Pe){if(Pe.length!==0)if(512<Pe.length)0<a&&(pe.enqueue(new Uint8Array(i.buffer,0,a)),i=new Uint8Array(512),a=0),pe.enqueue(Pe);else{var Xe=i.length-a;Xe<Pe.length&&(Xe===0?pe.enqueue(i):(i.set(Pe.subarray(0,Xe),a),pe.enqueue(i),Pe=Pe.subarray(Xe)),i=new Uint8Array(512),a=0),i.set(Pe,a),a+=Pe.length}}function v(pe,Pe){return h(pe,Pe),!0}function S(pe){i&&0<a&&(pe.enqueue(new Uint8Array(i.buffer,0,a)),i=null,a=0)}var o=new TextEncoder;function I(pe){return o.encode(pe)}function B(pe){return o.encode(pe)}function $(pe,Pe){typeof pe.error=="function"?pe.error(Pe):pe.close()}var U=Object.prototype.hasOwnProperty,K=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,te={},le={};function se(pe){return U.call(le,pe)?!0:U.call(te,pe)?!1:K.test(pe)?le[pe]=!0:(te[pe]=!0,!1)}function ue(pe,Pe,Xe,pt,Mt,an,wn){this.acceptsBooleans=Pe===2||Pe===3||Pe===4,this.attributeName=pt,this.attributeNamespace=Mt,this.mustUseProperty=Xe,this.propertyName=pe,this.type=Pe,this.sanitizeURL=an,this.removeEmptyString=wn}var be={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(pe){be[pe]=new ue(pe,0,!1,pe,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(pe){var Pe=pe[0];be[Pe]=new ue(Pe,1,!1,pe[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(pe){be[pe]=new ue(pe,2,!1,pe.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(pe){be[pe]=new ue(pe,2,!1,pe,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(pe){be[pe]=new ue(pe,3,!1,pe.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(pe){be[pe]=new ue(pe,3,!0,pe,null,!1,!1)}),["capture","download"].forEach(function(pe){be[pe]=new ue(pe,4,!1,pe,null,!1,!1)}),["cols","rows","size","span"].forEach(function(pe){be[pe]=new ue(pe,6,!1,pe,null,!1,!1)}),["rowSpan","start"].forEach(function(pe){be[pe]=new ue(pe,5,!1,pe.toLowerCase(),null,!1,!1)});var Ce=/[\-:]([a-z])/g;function Re(pe){return pe[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(pe){var Pe=pe.replace(Ce,Re);be[Pe]=new ue(Pe,1,!1,pe,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(pe){var Pe=pe.replace(Ce,Re);be[Pe]=new ue(Pe,1,!1,pe,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(pe){var Pe=pe.replace(Ce,Re);be[Pe]=new ue(Pe,1,!1,pe,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(pe){be[pe]=new ue(pe,1,!1,pe.toLowerCase(),null,!1,!1)}),be.xlinkHref=new ue("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(pe){be[pe]=new ue(pe,1,!1,pe.toLowerCase(),null,!0,!0)});var De={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ve=["Webkit","ms","Moz","O"];Object.keys(De).forEach(function(pe){ve.forEach(function(Pe){Pe=Pe+pe.charAt(0).toUpperCase()+pe.substring(1),De[Pe]=De[pe]})});var Le=/["'&<>]/;function Fe(pe){if(typeof pe=="boolean"||typeof pe=="number")return""+pe;pe=""+pe;var Pe=Le.exec(pe);if(Pe){var Xe="",pt,Mt=0;for(pt=Pe.index;pt<pe.length;pt++){switch(pe.charCodeAt(pt)){case 34:Pe="&quot;";break;case 38:Pe="&amp;";break;case 39:Pe="&#x27;";break;case 60:Pe="&lt;";break;case 62:Pe="&gt;";break;default:continue}Mt!==pt&&(Xe+=pe.substring(Mt,pt)),Mt=pt+1,Xe+=Pe}pe=Mt!==pt?Xe+pe.substring(Mt,pt):Xe}return pe}var lt=/([A-Z])/g,xt=/^ms-/,gt=Array.isArray,Je=B("<script>"),St=B("<\/script>"),Nt=B('<script src="'),Ht=B('<script type="module" src="'),Ct=B('" async=""><\/script>'),Kt=/(<\/|<)(s)(cript)/gi;function Lt(pe,Pe,Xe,pt){return""+Pe+(Xe==="s"?"\\u0073":"\\u0053")+pt}function et(pe,Pe,Xe,pt,Mt){pe=pe===void 0?"":pe,Pe=Pe===void 0?Je:B('<script nonce="'+Fe(Pe)+'">');var an=[];if(Xe!==void 0&&an.push(Pe,I((""+Xe).replace(Kt,Lt)),St),pt!==void 0)for(Xe=0;Xe<pt.length;Xe++)an.push(Nt,I(Fe(pt[Xe])),Ct);if(Mt!==void 0)for(pt=0;pt<Mt.length;pt++)an.push(Ht,I(Fe(Mt[pt])),Ct);return{bootstrapChunks:an,startInlineScript:Pe,placeholderPrefix:B(pe+"P:"),segmentPrefix:B(pe+"S:"),boundaryPrefix:pe+"B:",idPrefix:pe,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function vt(pe,Pe){return{insertionMode:pe,selectedValue:Pe}}function Ot(pe){return vt(pe==="http://www.w3.org/2000/svg"?2:pe==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function mt(pe,Pe,Xe){switch(Pe){case"select":return vt(1,Xe.value!=null?Xe.value:Xe.defaultValue);case"svg":return vt(2,null);case"math":return vt(3,null);case"foreignObject":return vt(1,null);case"table":return vt(4,null);case"thead":case"tbody":case"tfoot":return vt(5,null);case"colgroup":return vt(7,null);case"tr":return vt(6,null)}return 4<=pe.insertionMode||pe.insertionMode===0?vt(1,null):pe}var zt=B("<!-- -->");function Jt(pe,Pe,Xe,pt){return Pe===""?pt:(pt&&pe.push(zt),pe.push(I(Fe(Pe))),!0)}var Un=new Map,$n=B(' style="'),Bn=B(":"),$r=B(";");function _r(pe,Pe,Xe){if(typeof Xe!="object")throw Error(t(62));Pe=!0;for(var pt in Xe)if(U.call(Xe,pt)){var Mt=Xe[pt];if(Mt!=null&&typeof Mt!="boolean"&&Mt!==""){if(pt.indexOf("--")===0){var an=I(Fe(pt));Mt=I(Fe((""+Mt).trim()))}else{an=pt;var wn=Un.get(an);wn!==void 0||(wn=B(Fe(an.replace(lt,"-$1").toLowerCase().replace(xt,"-ms-"))),Un.set(an,wn)),an=wn,Mt=typeof Mt=="number"?Mt===0||U.call(De,pt)?I(""+Mt):I(Mt+"px"):I(Fe((""+Mt).trim()))}Pe?(Pe=!1,pe.push($n,an,Bn,Mt)):pe.push($r,an,Bn,Mt)}}Pe||pe.push(mr)}var Pn=B(" "),Ke=B('="'),mr=B('"'),Sn=B('=""');function Dr(pe,Pe,Xe,pt){switch(Xe){case"style":_r(pe,Pe,pt);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<Xe.length)||Xe[0]!=="o"&&Xe[0]!=="O"||Xe[1]!=="n"&&Xe[1]!=="N"){if(Pe=be.hasOwnProperty(Xe)?be[Xe]:null,Pe!==null){switch(typeof pt){case"function":case"symbol":return;case"boolean":if(!Pe.acceptsBooleans)return}switch(Xe=I(Pe.attributeName),Pe.type){case 3:pt&&pe.push(Pn,Xe,Sn);break;case 4:pt===!0?pe.push(Pn,Xe,Sn):pt!==!1&&pe.push(Pn,Xe,Ke,I(Fe(pt)),mr);break;case 5:isNaN(pt)||pe.push(Pn,Xe,Ke,I(Fe(pt)),mr);break;case 6:!isNaN(pt)&&1<=pt&&pe.push(Pn,Xe,Ke,I(Fe(pt)),mr);break;default:Pe.sanitizeURL&&(pt=""+pt),pe.push(Pn,Xe,Ke,I(Fe(pt)),mr)}}else if(se(Xe)){switch(typeof pt){case"function":case"symbol":return;case"boolean":if(Pe=Xe.toLowerCase().slice(0,5),Pe!=="data-"&&Pe!=="aria-")return}pe.push(Pn,I(Xe),Ke,I(Fe(pt)),mr)}}}var Yt=B(">"),Mr=B("/>");function Qn(pe,Pe,Xe){if(Pe!=null){if(Xe!=null)throw Error(t(60));if(typeof Pe!="object"||!("__html"in Pe))throw Error(t(61));Pe=Pe.__html,Pe!=null&&pe.push(I(""+Pe))}}function Ar(pe){var Pe="";return e.Children.forEach(pe,function(Xe){Xe!=null&&(Pe+=Xe)}),Pe}var sr=B(' selected=""');function _i(pe,Pe,Xe,pt){pe.push(yi(Xe));var Mt=Xe=null,an;for(an in Pe)if(U.call(Pe,an)){var wn=Pe[an];if(wn!=null)switch(an){case"children":Xe=wn;break;case"dangerouslySetInnerHTML":Mt=wn;break;default:Dr(pe,pt,an,wn)}}return pe.push(Yt),Qn(pe,Mt,Xe),typeof Xe=="string"?(pe.push(I(Fe(Xe))),null):Xe}var Wi=B(`
`),ii=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Pi=new Map;function yi(pe){var Pe=Pi.get(pe);if(Pe===void 0){if(!ii.test(pe))throw Error(t(65,pe));Pe=B("<"+pe),Pi.set(pe,Pe)}return Pe}var lr=B("<!DOCTYPE html>");function qo(pe,Pe,Xe,pt,Mt){switch(Pe){case"select":pe.push(yi("select"));var an=null,wn=null;for(Or in Xe)if(U.call(Xe,Or)){var Hn=Xe[Or];if(Hn!=null)switch(Or){case"children":an=Hn;break;case"dangerouslySetInnerHTML":wn=Hn;break;case"defaultValue":case"value":break;default:Dr(pe,pt,Or,Hn)}}return pe.push(Yt),Qn(pe,wn,an),an;case"option":wn=Mt.selectedValue,pe.push(yi("option"));var vr=Hn=null,Yr=null,Or=null;for(an in Xe)if(U.call(Xe,an)){var zi=Xe[an];if(zi!=null)switch(an){case"children":Hn=zi;break;case"selected":Yr=zi;break;case"dangerouslySetInnerHTML":Or=zi;break;case"value":vr=zi;default:Dr(pe,pt,an,zi)}}if(wn!=null)if(Xe=vr!==null?""+vr:Ar(Hn),gt(wn)){for(pt=0;pt<wn.length;pt++)if(""+wn[pt]===Xe){pe.push(sr);break}}else""+wn===Xe&&pe.push(sr);else Yr&&pe.push(sr);return pe.push(Yt),Qn(pe,Or,Hn),Hn;case"textarea":pe.push(yi("textarea")),Or=wn=an=null;for(Hn in Xe)if(U.call(Xe,Hn)&&(vr=Xe[Hn],vr!=null))switch(Hn){case"children":Or=vr;break;case"value":an=vr;break;case"defaultValue":wn=vr;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:Dr(pe,pt,Hn,vr)}if(an===null&&wn!==null&&(an=wn),pe.push(Yt),Or!=null){if(an!=null)throw Error(t(92));if(gt(Or)&&1<Or.length)throw Error(t(93));an=""+Or}return typeof an=="string"&&an[0]===`
`&&pe.push(Wi),an!==null&&pe.push(I(Fe(""+an))),null;case"input":pe.push(yi("input")),vr=Or=Hn=an=null;for(wn in Xe)if(U.call(Xe,wn)&&(Yr=Xe[wn],Yr!=null))switch(wn){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":vr=Yr;break;case"defaultValue":Hn=Yr;break;case"checked":Or=Yr;break;case"value":an=Yr;break;default:Dr(pe,pt,wn,Yr)}return Or!==null?Dr(pe,pt,"checked",Or):vr!==null&&Dr(pe,pt,"checked",vr),an!==null?Dr(pe,pt,"value",an):Hn!==null&&Dr(pe,pt,"value",Hn),pe.push(Mr),null;case"menuitem":pe.push(yi("menuitem"));for(var ha in Xe)if(U.call(Xe,ha)&&(an=Xe[ha],an!=null))switch(ha){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:Dr(pe,pt,ha,an)}return pe.push(Yt),null;case"title":pe.push(yi("title")),an=null;for(zi in Xe)if(U.call(Xe,zi)&&(wn=Xe[zi],wn!=null))switch(zi){case"children":an=wn;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:Dr(pe,pt,zi,wn)}return pe.push(Yt),an;case"listing":case"pre":pe.push(yi(Pe)),wn=an=null;for(vr in Xe)if(U.call(Xe,vr)&&(Hn=Xe[vr],Hn!=null))switch(vr){case"children":an=Hn;break;case"dangerouslySetInnerHTML":wn=Hn;break;default:Dr(pe,pt,vr,Hn)}if(pe.push(Yt),wn!=null){if(an!=null)throw Error(t(60));if(typeof wn!="object"||!("__html"in wn))throw Error(t(61));Xe=wn.__html,Xe!=null&&(typeof Xe=="string"&&0<Xe.length&&Xe[0]===`
`?pe.push(Wi,I(Xe)):pe.push(I(""+Xe)))}return typeof an=="string"&&an[0]===`
`&&pe.push(Wi),an;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":pe.push(yi(Pe));for(var jo in Xe)if(U.call(Xe,jo)&&(an=Xe[jo],an!=null))switch(jo){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,Pe));default:Dr(pe,pt,jo,an)}return pe.push(Mr),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return _i(pe,Xe,Pe,pt);case"html":return Mt.insertionMode===0&&pe.push(lr),_i(pe,Xe,Pe,pt);default:if(Pe.indexOf("-")===-1&&typeof Xe.is!="string")return _i(pe,Xe,Pe,pt);pe.push(yi(Pe)),wn=an=null;for(Yr in Xe)if(U.call(Xe,Yr)&&(Hn=Xe[Yr],Hn!=null))switch(Yr){case"children":an=Hn;break;case"dangerouslySetInnerHTML":wn=Hn;break;case"style":_r(pe,pt,Hn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:se(Yr)&&typeof Hn!="function"&&typeof Hn!="symbol"&&pe.push(Pn,I(Yr),Ke,I(Fe(Hn)),mr)}return pe.push(Yt),Qn(pe,wn,an),an}}var ea=B("</"),la=B(">"),Fi=B('<template id="'),Mo=B('"></template>'),ta=B("<!--$-->"),va=B('<!--$?--><template id="'),za=B('"></template>'),so=B("<!--$!-->"),Lo=B("<!--/$-->"),es=B("<template"),Go=B('"'),Fa=B(' data-dgst="');B(' data-msg="'),B(' data-stck="');var Er=B("></template>");function go(pe,Pe,Xe){if(h(pe,va),Xe===null)throw Error(t(395));return h(pe,Xe),v(pe,za)}var Ia=B('<div hidden id="'),Di=B('">'),vi=B("</div>"),bi=B('<svg aria-hidden="true" style="display:none" id="'),Mi=B('">'),Fo=B("</svg>"),na=B('<math aria-hidden="true" style="display:none" id="'),kt=B('">'),Se=B("</math>"),Z=B('<table hidden id="'),re=B('">'),ce=B("</table>"),de=B('<table hidden><tbody id="'),xe=B('">'),Ie=B("</tbody></table>"),Ae=B('<table hidden><tr id="'),Be=B('">'),tt=B("</tr></table>"),ut=B('<table hidden><colgroup id="'),Tt=B('">'),Wt=B("</colgroup></table>");function Vt(pe,Pe,Xe,pt){switch(Xe.insertionMode){case 0:case 1:return h(pe,Ia),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,Di);case 2:return h(pe,bi),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,Mi);case 3:return h(pe,na),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,kt);case 4:return h(pe,Z),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,re);case 5:return h(pe,de),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,xe);case 6:return h(pe,Ae),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,Be);case 7:return h(pe,ut),h(pe,Pe.segmentPrefix),h(pe,I(pt.toString(16))),v(pe,Tt);default:throw Error(t(397))}}function Gt(pe,Pe){switch(Pe.insertionMode){case 0:case 1:return v(pe,vi);case 2:return v(pe,Fo);case 3:return v(pe,Se);case 4:return v(pe,ce);case 5:return v(pe,Ie);case 6:return v(pe,tt);case 7:return v(pe,Wt);default:throw Error(t(397))}}var gn=B('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Tn=B('$RS("'),In=B('","'),Ln=B('")<\/script>'),dr=B('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Zn=B('$RC("'),Zr=B('","'),ri=B('")<\/script>'),nr=B('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),hn=B('$RX("'),Kn=B('"'),br=B(")<\/script>"),oi=B(","),Ir=/[<\u2028\u2029]/g;function Kr(pe){return JSON.stringify(pe).replace(Ir,function(Pe){switch(Pe){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var qr=Object.assign,ci=Symbol.for("react.element"),Zi=Symbol.for("react.portal"),Xn=Symbol.for("react.fragment"),Gr=Symbol.for("react.strict_mode"),xa=Symbol.for("react.profiler"),lo=Symbol.for("react.provider"),uo=Symbol.for("react.context"),wo=Symbol.for("react.forward_ref"),yr=Symbol.for("react.suspense"),wi=Symbol.for("react.suspense_list"),fe=Symbol.for("react.memo"),Oe=Symbol.for("react.lazy"),We=Symbol.for("react.scope"),dt=Symbol.for("react.debug_trace_mode"),nn=Symbol.for("react.legacy_hidden"),Zt=Symbol.for("react.default_value"),fn=Symbol.iterator;function Cn(pe){if(pe==null)return null;if(typeof pe=="function")return pe.displayName||pe.name||null;if(typeof pe=="string")return pe;switch(pe){case Xn:return"Fragment";case Zi:return"Portal";case xa:return"Profiler";case Gr:return"StrictMode";case yr:return"Suspense";case wi:return"SuspenseList"}if(typeof pe=="object")switch(pe.$$typeof){case uo:return(pe.displayName||"Context")+".Consumer";case lo:return(pe._context.displayName||"Context")+".Provider";case wo:var Pe=pe.render;return pe=pe.displayName,pe||(pe=Pe.displayName||Pe.name||"",pe=pe!==""?"ForwardRef("+pe+")":"ForwardRef"),pe;case fe:return Pe=pe.displayName||null,Pe!==null?Pe:Cn(pe.type)||"Memo";case Oe:Pe=pe._payload,pe=pe._init;try{return Cn(pe(Pe))}catch{}}return null}var Gn={};function Cr(pe,Pe){if(pe=pe.contextTypes,!pe)return Gn;var Xe={},pt;for(pt in pe)Xe[pt]=Pe[pt];return Xe}var Ur=null;function Ri(pe,Pe){if(pe!==Pe){pe.context._currentValue=pe.parentValue,pe=pe.parent;var Xe=Pe.parent;if(pe===null){if(Xe!==null)throw Error(t(401))}else{if(Xe===null)throw Error(t(401));Ri(pe,Xe)}Pe.context._currentValue=Pe.value}}function So(pe){pe.context._currentValue=pe.parentValue,pe=pe.parent,pe!==null&&So(pe)}function To(pe){var Pe=pe.parent;Pe!==null&&To(Pe),pe.context._currentValue=pe.value}function wr(pe,Pe){if(pe.context._currentValue=pe.parentValue,pe=pe.parent,pe===null)throw Error(t(402));pe.depth===Pe.depth?Ri(pe,Pe):wr(pe,Pe)}function Ba(pe,Pe){var Xe=Pe.parent;if(Xe===null)throw Error(t(402));pe.depth===Xe.depth?Ri(pe,Xe):Ba(pe,Xe),Pe.context._currentValue=Pe.value}function Pr(pe){var Pe=Ur;Pe!==pe&&(Pe===null?To(pe):pe===null?So(Pe):Pe.depth===pe.depth?Ri(Pe,pe):Pe.depth>pe.depth?wr(Pe,pe):Ba(Pe,pe),Ur=pe)}var Ho={isMounted:function(){return!1},enqueueSetState:function(pe,Pe){pe=pe._reactInternals,pe.queue!==null&&pe.queue.push(Pe)},enqueueReplaceState:function(pe,Pe){pe=pe._reactInternals,pe.replace=!0,pe.queue=[Pe]},enqueueForceUpdate:function(){}};function Yn(pe,Pe,Xe,pt){var Mt=pe.state!==void 0?pe.state:null;pe.updater=Ho,pe.props=Xe,pe.state=Mt;var an={queue:[],replace:!1};pe._reactInternals=an;var wn=Pe.contextType;if(pe.context=typeof wn=="object"&&wn!==null?wn._currentValue:pt,wn=Pe.getDerivedStateFromProps,typeof wn=="function"&&(wn=wn(Xe,Mt),Mt=wn==null?Mt:qr({},Mt,wn),pe.state=Mt),typeof Pe.getDerivedStateFromProps!="function"&&typeof pe.getSnapshotBeforeUpdate!="function"&&(typeof pe.UNSAFE_componentWillMount=="function"||typeof pe.componentWillMount=="function"))if(Pe=pe.state,typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount(),Pe!==pe.state&&Ho.enqueueReplaceState(pe,pe.state,null),an.queue!==null&&0<an.queue.length)if(Pe=an.queue,wn=an.replace,an.queue=null,an.replace=!1,wn&&Pe.length===1)pe.state=Pe[0];else{for(an=wn?Pe[0]:pe.state,Mt=!0,wn=wn?1:0;wn<Pe.length;wn++){var Hn=Pe[wn];Hn=typeof Hn=="function"?Hn.call(pe,an,Xe,pt):Hn,Hn!=null&&(Mt?(Mt=!1,an=qr({},an,Hn)):qr(an,Hn))}pe.state=an}else an.queue=null}var Wo={id:1,overflow:""};function ba(pe,Pe,Xe){var pt=pe.id;pe=pe.overflow;var Mt=32-Hr(pt)-1;pt&=~(1<<Mt),Xe+=1;var an=32-Hr(Pe)+Mt;if(30<an){var wn=Mt-Mt%5;return an=(pt&(1<<wn)-1).toString(32),pt>>=wn,Mt-=wn,{id:1<<32-Hr(Pe)+Mt|Xe<<Mt|pt,overflow:an+pe}}return{id:1<<an|Xe<<Mt|pt,overflow:pe}}var Hr=Math.clz32?Math.clz32:ss,fo=Math.log,no=Math.LN2;function ss(pe){return pe>>>=0,pe===0?32:31-(fo(pe)/no|0)|0}function Dn(pe,Pe){return pe===Pe&&(pe!==0||1/pe===1/Pe)||pe!==pe&&Pe!==Pe}var ai=typeof Object.is=="function"?Object.is:Dn,Br=null,Eo=null,Bo=null,cr=null,co=!1,ua=!1,Na=0,_o=null,ho=0;function hl(){if(Br===null)throw Error(t(321));return Br}function ks(){if(0<ho)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function Rs(){return cr===null?Bo===null?(co=!1,Bo=cr=ks()):(co=!0,cr=Bo):cr.next===null?(co=!1,cr=cr.next=ks()):(co=!0,cr=cr.next),cr}function Za(){Eo=Br=null,ua=!1,Bo=null,ho=0,cr=_o=null}function Oi(pe,Pe){return typeof Pe=="function"?Pe(pe):Pe}function Zo(pe,Pe,Xe){if(Br=hl(),cr=Rs(),co){var pt=cr.queue;if(Pe=pt.dispatch,_o!==null&&(Xe=_o.get(pt),Xe!==void 0)){_o.delete(pt),pt=cr.memoizedState;do pt=pe(pt,Xe.action),Xe=Xe.next;while(Xe!==null);return cr.memoizedState=pt,[pt,Pe]}return[cr.memoizedState,Pe]}return pe=pe===Oi?typeof Pe=="function"?Pe():Pe:Xe!==void 0?Xe(Pe):Pe,cr.memoizedState=pe,pe=cr.queue={last:null,dispatch:null},pe=pe.dispatch=No.bind(null,Br,pe),[cr.memoizedState,pe]}function ro(pe,Pe){if(Br=hl(),cr=Rs(),Pe=Pe===void 0?null:Pe,cr!==null){var Xe=cr.memoizedState;if(Xe!==null&&Pe!==null){var pt=Xe[1];e:if(pt===null)pt=!1;else{for(var Mt=0;Mt<pt.length&&Mt<Pe.length;Mt++)if(!ai(Pe[Mt],pt[Mt])){pt=!1;break e}pt=!0}if(pt)return Xe[0]}}return pe=pe(),cr.memoizedState=[pe,Pe],pe}function No(pe,Pe,Xe){if(25<=ho)throw Error(t(301));if(pe===Br)if(ua=!0,pe={action:Xe,next:null},_o===null&&(_o=new Map),Xe=_o.get(Pe),Xe===void 0)_o.set(Pe,pe);else{for(Pe=Xe;Pe.next!==null;)Pe=Pe.next;Pe.next=pe}}function ac(){throw Error(t(394))}function ts(){}var io={readContext:function(pe){return pe._currentValue},useContext:function(pe){return hl(),pe._currentValue},useMemo:ro,useReducer:Zo,useRef:function(pe){Br=hl(),cr=Rs();var Pe=cr.memoizedState;return Pe===null?(pe={current:pe},cr.memoizedState=pe):Pe},useState:function(pe){return Zo(Oi,pe)},useInsertionEffect:ts,useLayoutEffect:function(){},useCallback:function(pe,Pe){return ro(function(){return pe},Pe)},useImperativeHandle:ts,useEffect:ts,useDebugValue:ts,useDeferredValue:function(pe){return hl(),pe},useTransition:function(){return hl(),[!1,ac]},useId:function(){var pe=Eo.treeContext,Pe=pe.overflow;pe=pe.id,pe=(pe&~(1<<32-Hr(pe)-1)).toString(32)+Pe;var Xe=ca;if(Xe===null)throw Error(t(404));return Pe=Na++,pe=":"+Xe.idPrefix+"R"+pe,0<Pe&&(pe+="H"+Pe.toString(32)),pe+":"},useMutableSource:function(pe,Pe){return hl(),Pe(pe._source)},useSyncExternalStore:function(pe,Pe,Xe){if(Xe===void 0)throw Error(t(407));return Xe()}},ca=null,yo=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Ao(pe){return console.error(pe),null}function fl(){}function Ca(pe,Pe,Xe,pt,Mt,an,wn,Hn,vr){var Yr=[],Or=new Set;return Pe={destination:null,responseState:Pe,progressiveChunkSize:pt===void 0?12800:pt,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Or,pingedTasks:Yr,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Mt===void 0?Ao:Mt,onAllReady:an===void 0?fl:an,onShellReady:wn===void 0?fl:wn,onShellError:Hn===void 0?fl:Hn,onFatalError:vr===void 0?fl:vr},Xe=Xo(Pe,0,null,Xe,!1,!1),Xe.parentFlushed=!0,pe=bl(Pe,pe,null,Xe,Or,Gn,null,Wo),Yr.push(pe),Pe}function bl(pe,Pe,Xe,pt,Mt,an,wn,Hn){pe.allPendingTasks++,Xe===null?pe.pendingRootTasks++:Xe.pendingTasks++;var vr={node:Pe,ping:function(){var Yr=pe.pingedTasks;Yr.push(vr),Yr.length===1&&Ks(pe)},blockedBoundary:Xe,blockedSegment:pt,abortSet:Mt,legacyContext:an,context:wn,treeContext:Hn};return Mt.add(vr),vr}function Xo(pe,Pe,Xe,pt,Mt,an){return{status:0,id:-1,index:Pe,parentFlushed:!1,chunks:[],children:[],formatContext:pt,boundary:Xe,lastPushedText:Mt,textEmbedded:an}}function ls(pe,Pe){if(pe=pe.onError(Pe),pe!=null&&typeof pe!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof pe+'" instead');return pe}function bs(pe,Pe){var Xe=pe.onShellError;Xe(Pe),Xe=pe.onFatalError,Xe(Pe),pe.destination!==null?(pe.status=2,$(pe.destination,Pe)):(pe.status=1,pe.fatalError=Pe)}function ra(pe,Pe,Xe,pt,Mt){for(Br={},Eo=Pe,Na=0,pe=Xe(pt,Mt);ua;)ua=!1,Na=0,ho+=1,cr=null,pe=Xe(pt,Mt);return Za(),pe}function sc(pe,Pe,Xe,pt){var Mt=Xe.render(),an=pt.childContextTypes;if(an!=null){var wn=Pe.legacyContext;if(typeof Xe.getChildContext!="function")pt=wn;else{Xe=Xe.getChildContext();for(var Hn in Xe)if(!(Hn in an))throw Error(t(108,Cn(pt)||"Unknown",Hn));pt=qr({},wn,Xe)}Pe.legacyContext=pt,us(pe,Pe,Mt),Pe.legacyContext=wn}else us(pe,Pe,Mt)}function lc(pe,Pe){if(pe&&pe.defaultProps){Pe=qr({},Pe),pe=pe.defaultProps;for(var Xe in pe)Pe[Xe]===void 0&&(Pe[Xe]=pe[Xe]);return Pe}return Pe}function wa(pe,Pe,Xe,pt,Mt){if(typeof Xe=="function")if(Xe.prototype&&Xe.prototype.isReactComponent){Mt=Cr(Xe,Pe.legacyContext);var an=Xe.contextType;an=new Xe(pt,typeof an=="object"&&an!==null?an._currentValue:Mt),Yn(an,Xe,pt,Mt),sc(pe,Pe,an,Xe)}else{an=Cr(Xe,Pe.legacyContext),Mt=ra(pe,Pe,Xe,pt,an);var wn=Na!==0;if(typeof Mt=="object"&&Mt!==null&&typeof Mt.render=="function"&&Mt.$$typeof===void 0)Yn(Mt,Xe,pt,an),sc(pe,Pe,Mt,Xe);else if(wn){pt=Pe.treeContext,Pe.treeContext=ba(pt,1,0);try{us(pe,Pe,Mt)}finally{Pe.treeContext=pt}}else us(pe,Pe,Mt)}else if(typeof Xe=="string"){switch(Mt=Pe.blockedSegment,an=qo(Mt.chunks,Xe,pt,pe.responseState,Mt.formatContext),Mt.lastPushedText=!1,wn=Mt.formatContext,Mt.formatContext=mt(wn,Xe,pt),Ru(pe,Pe,an),Mt.formatContext=wn,Xe){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Mt.chunks.push(ea,I(Xe),la)}Mt.lastPushedText=!1}else{switch(Xe){case nn:case dt:case Gr:case xa:case Xn:us(pe,Pe,pt.children);return;case wi:us(pe,Pe,pt.children);return;case We:throw Error(t(343));case yr:e:{Xe=Pe.blockedBoundary,Mt=Pe.blockedSegment,an=pt.fallback,pt=pt.children,wn=new Set;var Hn={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:wn,errorDigest:null},vr=Xo(pe,Mt.chunks.length,Hn,Mt.formatContext,!1,!1);Mt.children.push(vr),Mt.lastPushedText=!1;var Yr=Xo(pe,0,null,Mt.formatContext,!1,!1);Yr.parentFlushed=!0,Pe.blockedBoundary=Hn,Pe.blockedSegment=Yr;try{if(Ru(pe,Pe,pt),Yr.lastPushedText&&Yr.textEmbedded&&Yr.chunks.push(zt),Yr.status=1,uu(Hn,Yr),Hn.pendingTasks===0)break e}catch(Or){Yr.status=4,Hn.forceClientRender=!0,Hn.errorDigest=ls(pe,Or)}finally{Pe.blockedBoundary=Xe,Pe.blockedSegment=Mt}Pe=bl(pe,an,Xe,vr,wn,Pe.legacyContext,Pe.context,Pe.treeContext),pe.pingedTasks.push(Pe)}return}if(typeof Xe=="object"&&Xe!==null)switch(Xe.$$typeof){case wo:if(pt=ra(pe,Pe,Xe.render,pt,Mt),Na!==0){Xe=Pe.treeContext,Pe.treeContext=ba(Xe,1,0);try{us(pe,Pe,pt)}finally{Pe.treeContext=Xe}}else us(pe,Pe,pt);return;case fe:Xe=Xe.type,pt=lc(Xe,pt),wa(pe,Pe,Xe,pt,Mt);return;case lo:if(Mt=pt.children,Xe=Xe._context,pt=pt.value,an=Xe._currentValue,Xe._currentValue=pt,wn=Ur,Ur=pt={parent:wn,depth:wn===null?0:wn.depth+1,context:Xe,parentValue:an,value:pt},Pe.context=pt,us(pe,Pe,Mt),pe=Ur,pe===null)throw Error(t(403));pt=pe.parentValue,pe.context._currentValue=pt===Zt?pe.context._defaultValue:pt,pe=Ur=pe.parent,Pe.context=pe;return;case uo:pt=pt.children,pt=pt(Xe._currentValue),us(pe,Pe,pt);return;case Oe:Mt=Xe._init,Xe=Mt(Xe._payload),pt=lc(Xe,pt),wa(pe,Pe,Xe,pt,void 0);return}throw Error(t(130,Xe==null?Xe:typeof Xe,""))}}function us(pe,Pe,Xe){if(Pe.node=Xe,typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case ci:wa(pe,Pe,Xe.type,Xe.props,Xe.ref);return;case Zi:throw Error(t(257));case Oe:var pt=Xe._init;Xe=pt(Xe._payload),us(pe,Pe,Xe);return}if(gt(Xe)){wl(pe,Pe,Xe);return}if(Xe===null||typeof Xe!="object"?pt=null:(pt=fn&&Xe[fn]||Xe["@@iterator"],pt=typeof pt=="function"?pt:null),pt&&(pt=pt.call(Xe))){if(Xe=pt.next(),!Xe.done){var Mt=[];do Mt.push(Xe.value),Xe=pt.next();while(!Xe.done);wl(pe,Pe,Mt)}return}throw pe=Object.prototype.toString.call(Xe),Error(t(31,pe==="[object Object]"?"object with keys {"+Object.keys(Xe).join(", ")+"}":pe))}typeof Xe=="string"?(pt=Pe.blockedSegment,pt.lastPushedText=Jt(Pe.blockedSegment.chunks,Xe,pe.responseState,pt.lastPushedText)):typeof Xe=="number"&&(pt=Pe.blockedSegment,pt.lastPushedText=Jt(Pe.blockedSegment.chunks,""+Xe,pe.responseState,pt.lastPushedText))}function wl(pe,Pe,Xe){for(var pt=Xe.length,Mt=0;Mt<pt;Mt++){var an=Pe.treeContext;Pe.treeContext=ba(an,pt,Mt);try{Ru(pe,Pe,Xe[Mt])}finally{Pe.treeContext=an}}}function Ru(pe,Pe,Xe){var pt=Pe.blockedSegment.formatContext,Mt=Pe.legacyContext,an=Pe.context;try{return us(pe,Pe,Xe)}catch(vr){if(Za(),typeof vr=="object"&&vr!==null&&typeof vr.then=="function"){Xe=vr;var wn=Pe.blockedSegment,Hn=Xo(pe,wn.chunks.length,null,wn.formatContext,wn.lastPushedText,!0);wn.children.push(Hn),wn.lastPushedText=!1,pe=bl(pe,Pe.node,Pe.blockedBoundary,Hn,Pe.abortSet,Pe.legacyContext,Pe.context,Pe.treeContext).ping,Xe.then(pe,pe),Pe.blockedSegment.formatContext=pt,Pe.legacyContext=Mt,Pe.context=an,Pr(an)}else throw Pe.blockedSegment.formatContext=pt,Pe.legacyContext=Mt,Pe.context=an,Pr(an),vr}}function lu(pe){var Pe=pe.blockedBoundary;pe=pe.blockedSegment,pe.status=3,cu(this,Pe,pe)}function $l(pe,Pe,Xe){var pt=pe.blockedBoundary;pe.blockedSegment.status=3,pt===null?(Pe.allPendingTasks--,Pe.status!==2&&(Pe.status=2,Pe.destination!==null&&Pe.destination.close())):(pt.pendingTasks--,pt.forceClientRender||(pt.forceClientRender=!0,pe=Xe===void 0?Error(t(432)):Xe,pt.errorDigest=Pe.onError(pe),pt.parentFlushed&&Pe.clientRenderedBoundaries.push(pt)),pt.fallbackAbortableTasks.forEach(function(Mt){return $l(Mt,Pe,Xe)}),pt.fallbackAbortableTasks.clear(),Pe.allPendingTasks--,Pe.allPendingTasks===0&&(pt=Pe.onAllReady,pt()))}function uu(pe,Pe){if(Pe.chunks.length===0&&Pe.children.length===1&&Pe.children[0].boundary===null){var Xe=Pe.children[0];Xe.id=Pe.id,Xe.parentFlushed=!0,Xe.status===1&&uu(pe,Xe)}else pe.completedSegments.push(Pe)}function cu(pe,Pe,Xe){if(Pe===null){if(Xe.parentFlushed){if(pe.completedRootSegment!==null)throw Error(t(389));pe.completedRootSegment=Xe}pe.pendingRootTasks--,pe.pendingRootTasks===0&&(pe.onShellError=fl,Pe=pe.onShellReady,Pe())}else Pe.pendingTasks--,Pe.forceClientRender||(Pe.pendingTasks===0?(Xe.parentFlushed&&Xe.status===1&&uu(Pe,Xe),Pe.parentFlushed&&pe.completedBoundaries.push(Pe),Pe.fallbackAbortableTasks.forEach(lu,pe),Pe.fallbackAbortableTasks.clear()):Xe.parentFlushed&&Xe.status===1&&(uu(Pe,Xe),Pe.completedSegments.length===1&&Pe.parentFlushed&&pe.partialBoundaries.push(Pe)));pe.allPendingTasks--,pe.allPendingTasks===0&&(pe=pe.onAllReady,pe())}function Ks(pe){if(pe.status!==2){var Pe=Ur,Xe=yo.current;yo.current=io;var pt=ca;ca=pe.responseState;try{var Mt=pe.pingedTasks,an;for(an=0;an<Mt.length;an++){var wn=Mt[an],Hn=pe,vr=wn.blockedSegment;if(vr.status===0){Pr(wn.context);try{us(Hn,wn,wn.node),vr.lastPushedText&&vr.textEmbedded&&vr.chunks.push(zt),wn.abortSet.delete(wn),vr.status=1,cu(Hn,wn.blockedBoundary,vr)}catch(Xa){if(Za(),typeof Xa=="object"&&Xa!==null&&typeof Xa.then=="function"){var Yr=wn.ping;Xa.then(Yr,Yr)}else{wn.abortSet.delete(wn),vr.status=4;var Or=wn.blockedBoundary,zi=Xa,ha=ls(Hn,zi);if(Or===null?bs(Hn,zi):(Or.pendingTasks--,Or.forceClientRender||(Or.forceClientRender=!0,Or.errorDigest=ha,Or.parentFlushed&&Hn.clientRenderedBoundaries.push(Or))),Hn.allPendingTasks--,Hn.allPendingTasks===0){var jo=Hn.onAllReady;jo()}}}finally{}}}Mt.splice(0,an),pe.destination!==null&&Sr(pe,pe.destination)}catch(Xa){ls(pe,Xa),bs(pe,Xa)}finally{ca=pt,yo.current=Xe,Xe===io&&Pr(Pe)}}}function Lu(pe,Pe,Xe){switch(Xe.parentFlushed=!0,Xe.status){case 0:var pt=Xe.id=pe.nextSegmentId++;return Xe.lastPushedText=!1,Xe.textEmbedded=!1,pe=pe.responseState,h(Pe,Fi),h(Pe,pe.placeholderPrefix),pe=I(pt.toString(16)),h(Pe,pe),v(Pe,Mo);case 1:Xe.status=2;var Mt=!0;pt=Xe.chunks;var an=0;Xe=Xe.children;for(var wn=0;wn<Xe.length;wn++){for(Mt=Xe[wn];an<Mt.index;an++)h(Pe,pt[an]);Mt=ws(pe,Pe,Mt)}for(;an<pt.length-1;an++)h(Pe,pt[an]);return an<pt.length&&(Mt=v(Pe,pt[an])),Mt;default:throw Error(t(390))}}function ws(pe,Pe,Xe){var pt=Xe.boundary;if(pt===null)return Lu(pe,Pe,Xe);if(pt.parentFlushed=!0,pt.forceClientRender)pt=pt.errorDigest,v(Pe,so),h(Pe,es),pt&&(h(Pe,Fa),h(Pe,I(Fe(pt))),h(Pe,Go)),v(Pe,Er),Lu(pe,Pe,Xe);else if(0<pt.pendingTasks){pt.rootSegmentID=pe.nextSegmentId++,0<pt.completedSegments.length&&pe.partialBoundaries.push(pt);var Mt=pe.responseState,an=Mt.nextSuspenseID++;Mt=B(Mt.boundaryPrefix+an.toString(16)),pt=pt.id=Mt,go(Pe,pe.responseState,pt),Lu(pe,Pe,Xe)}else if(pt.byteSize>pe.progressiveChunkSize)pt.rootSegmentID=pe.nextSegmentId++,pe.completedBoundaries.push(pt),go(Pe,pe.responseState,pt.id),Lu(pe,Pe,Xe);else{if(v(Pe,ta),Xe=pt.completedSegments,Xe.length!==1)throw Error(t(391));ws(pe,Pe,Xe[0])}return v(Pe,Lo)}function dl(pe,Pe,Xe){return Vt(Pe,pe.responseState,Xe.formatContext,Xe.id),ws(pe,Pe,Xe),Gt(Pe,Xe.formatContext)}function Du(pe,Pe,Xe){for(var pt=Xe.completedSegments,Mt=0;Mt<pt.length;Mt++)ia(pe,Pe,Xe,pt[Mt]);if(pt.length=0,pe=pe.responseState,pt=Xe.id,Xe=Xe.rootSegmentID,h(Pe,pe.startInlineScript),pe.sentCompleteBoundaryFunction?h(Pe,Zn):(pe.sentCompleteBoundaryFunction=!0,h(Pe,dr)),pt===null)throw Error(t(395));return Xe=I(Xe.toString(16)),h(Pe,pt),h(Pe,Zr),h(Pe,pe.segmentPrefix),h(Pe,Xe),v(Pe,ri)}function ia(pe,Pe,Xe,pt){if(pt.status===2)return!0;var Mt=pt.id;if(Mt===-1){if((pt.id=Xe.rootSegmentID)===-1)throw Error(t(392));return dl(pe,Pe,pt)}return dl(pe,Pe,pt),pe=pe.responseState,h(Pe,pe.startInlineScript),pe.sentCompleteSegmentFunction?h(Pe,Tn):(pe.sentCompleteSegmentFunction=!0,h(Pe,gn)),h(Pe,pe.segmentPrefix),Mt=I(Mt.toString(16)),h(Pe,Mt),h(Pe,In),h(Pe,pe.placeholderPrefix),h(Pe,Mt),v(Pe,Ln)}function Sr(pe,Pe){i=new Uint8Array(512),a=0;try{var Xe=pe.completedRootSegment;if(Xe!==null&&pe.pendingRootTasks===0){ws(pe,Pe,Xe),pe.completedRootSegment=null;var pt=pe.responseState.bootstrapChunks;for(Xe=0;Xe<pt.length-1;Xe++)h(Pe,pt[Xe]);Xe<pt.length&&v(Pe,pt[Xe])}var Mt=pe.clientRenderedBoundaries,an;for(an=0;an<Mt.length;an++){var wn=Mt[an];pt=Pe;var Hn=pe.responseState,vr=wn.id,Yr=wn.errorDigest,Or=wn.errorMessage,zi=wn.errorComponentStack;if(h(pt,Hn.startInlineScript),Hn.sentClientRenderFunction?h(pt,hn):(Hn.sentClientRenderFunction=!0,h(pt,nr)),vr===null)throw Error(t(395));h(pt,vr),h(pt,Kn),(Yr||Or||zi)&&(h(pt,oi),h(pt,I(Kr(Yr||"")))),(Or||zi)&&(h(pt,oi),h(pt,I(Kr(Or||"")))),zi&&(h(pt,oi),h(pt,I(Kr(zi)))),v(pt,br)}Mt.splice(0,an);var ha=pe.completedBoundaries;for(an=0;an<ha.length;an++)Du(pe,Pe,ha[an]);ha.splice(0,an),S(Pe),i=new Uint8Array(512),a=0;var jo=pe.partialBoundaries;for(an=0;an<jo.length;an++){var Xa=jo[an];e:{Mt=pe,wn=Pe;var Oa=Xa.completedSegments;for(Hn=0;Hn<Oa.length;Hn++)if(!ia(Mt,wn,Xa,Oa[Hn])){Hn++,Oa.splice(0,Hn);var Ji=!1;break e}Oa.splice(0,Hn),Ji=!0}if(!Ji){pe.destination=null,an++,jo.splice(0,an);return}}jo.splice(0,an);var cs=pe.completedBoundaries;for(an=0;an<cs.length;an++)Du(pe,Pe,cs[an]);cs.splice(0,an)}finally{S(Pe),pe.allPendingTasks===0&&pe.pingedTasks.length===0&&pe.clientRenderedBoundaries.length===0&&pe.completedBoundaries.length===0&&Pe.close()}}function ir(pe,Pe){try{var Xe=pe.abortableTasks;Xe.forEach(function(pt){return $l(pt,pe,Pe)}),Xe.clear(),pe.destination!==null&&Sr(pe,pe.destination)}catch(pt){ls(pe,pt),bs(pe,pt)}}return qv.renderToReadableStream=function(pe,Pe){return new Promise(function(Xe,pt){var Mt,an,wn=new Promise(function(Or,zi){an=Or,Mt=zi}),Hn=Ca(pe,et(Pe?Pe.identifierPrefix:void 0,Pe?Pe.nonce:void 0,Pe?Pe.bootstrapScriptContent:void 0,Pe?Pe.bootstrapScripts:void 0,Pe?Pe.bootstrapModules:void 0),Ot(Pe?Pe.namespaceURI:void 0),Pe?Pe.progressiveChunkSize:void 0,Pe?Pe.onError:void 0,an,function(){var Or=new ReadableStream({type:"bytes",pull:function(zi){if(Hn.status===1)Hn.status=2,$(zi,Hn.fatalError);else if(Hn.status!==2&&Hn.destination===null){Hn.destination=zi;try{Sr(Hn,zi)}catch(ha){ls(Hn,ha),bs(Hn,ha)}}},cancel:function(){ir(Hn)}},{highWaterMark:0});Or.allReady=wn,Xe(Or)},function(Or){wn.catch(function(){}),pt(Or)},Mt);if(Pe&&Pe.signal){var vr=Pe.signal,Yr=function(){ir(Hn,vr.reason),vr.removeEventListener("abort",Yr)};vr.addEventListener("abort",Yr)}Ks(Hn)})},qv.version="18.3.1",qv}var Ck;function JV(){if(Ck)return jd;Ck=1;var e,t;return e=KV(),t=YV(),jd.version=e.version,jd.renderToString=e.renderToString,jd.renderToStaticMarkup=e.renderToStaticMarkup,jd.renderToNodeStream=e.renderToNodeStream,jd.renderToStaticNodeStream=e.renderToStaticNodeStream,jd.renderToReadableStream=t.renderToReadableStream,jd}var QV=JV();const Ok=zo(QV);var s0={exports:{}},eq=s0.exports,kk;function tq(){return kk||(kk=1,function(e,t){(function(i,a){e.exports=a()})(eq,function(){var i,a,h;function v(o,I){if(!i)i=I;else if(!a)a=I;else{var B="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",$={};i($),h=I($),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([B],{type:"text/javascript"})))}}v(["exports"],function(o){function I(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var B,$={},U={};function K(){if(B)return U;B=1,Object.defineProperty(U,"__esModule",{value:!0}),U.setMatrixArrayType=function(m){U.ARRAY_TYPE=n=m},U.toRadian=function(m){return m*c},U.equals=function(m,f){return Math.abs(m-f)<=u*Math.max(1,Math.abs(m),Math.abs(f))},U.RANDOM=U.ARRAY_TYPE=U.EPSILON=void 0;var u=1e-6;U.EPSILON=u;var n=typeof Float32Array<"u"?Float32Array:Array;U.ARRAY_TYPE=n;var s=Math.random;U.RANDOM=s;var c=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,f=arguments.length;f--;)m+=arguments[f]*arguments[f];return Math.sqrt(m)}),U}var te,le={};function se(){if(te)return le;function u(f){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},u(f)}te=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var f=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f},le.clone=function(f){var g=new n.ARRAY_TYPE(4);return g[0]=f[0],g[1]=f[1],g[2]=f[2],g[3]=f[3],g},le.copy=function(f,g){return f[0]=g[0],f[1]=g[1],f[2]=g[2],f[3]=g[3],f},le.identity=function(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=1,f},le.fromValues=function(f,g,E,O){var D=new n.ARRAY_TYPE(4);return D[0]=f,D[1]=g,D[2]=E,D[3]=O,D},le.set=function(f,g,E,O,D){return f[0]=g,f[1]=E,f[2]=O,f[3]=D,f},le.transpose=function(f,g){if(f===g){var E=g[1];f[1]=g[2],f[2]=E}else f[0]=g[0],f[1]=g[2],f[2]=g[1],f[3]=g[3];return f},le.invert=function(f,g){var E=g[0],O=g[1],D=g[2],w=g[3],C=E*w-D*O;return C?(f[0]=w*(C=1/C),f[1]=-O*C,f[2]=-D*C,f[3]=E*C,f):null},le.adjoint=function(f,g){var E=g[0];return f[0]=g[3],f[1]=-g[1],f[2]=-g[2],f[3]=E,f},le.determinant=function(f){return f[0]*f[3]-f[2]*f[1]},le.multiply=c,le.rotate=function(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=Math.sin(E),P=Math.cos(E);return f[0]=O*P+w*R,f[1]=D*P+C*R,f[2]=O*-R+w*P,f[3]=D*-R+C*P,f},le.scale=function(f,g,E){var O=g[1],D=g[2],w=g[3],C=E[0],R=E[1];return f[0]=g[0]*C,f[1]=O*C,f[2]=D*R,f[3]=w*R,f},le.fromRotation=function(f,g){var E=Math.sin(g),O=Math.cos(g);return f[0]=O,f[1]=E,f[2]=-E,f[3]=O,f},le.fromScaling=function(f,g){return f[0]=g[0],f[1]=0,f[2]=0,f[3]=g[1],f},le.str=function(f){return"mat2("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+")"},le.frob=function(f){return Math.hypot(f[0],f[1],f[2],f[3])},le.LDU=function(f,g,E,O){return f[2]=O[2]/O[0],E[0]=O[0],E[1]=O[1],E[3]=O[3]-f[2]*E[1],[f,g,E]},le.add=function(f,g,E){return f[0]=g[0]+E[0],f[1]=g[1]+E[1],f[2]=g[2]+E[2],f[3]=g[3]+E[3],f},le.subtract=m,le.exactEquals=function(f,g){return f[0]===g[0]&&f[1]===g[1]&&f[2]===g[2]&&f[3]===g[3]},le.equals=function(f,g){var E=f[0],O=f[1],D=f[2],w=f[3],C=g[0],R=g[1],P=g[2],k=g[3];return Math.abs(E-C)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(C))&&Math.abs(O-R)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(R))&&Math.abs(D-P)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(P))&&Math.abs(w-k)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(k))},le.multiplyScalar=function(f,g,E){return f[0]=g[0]*E,f[1]=g[1]*E,f[2]=g[2]*E,f[3]=g[3]*E,f},le.multiplyScalarAndAdd=function(f,g,E,O){return f[0]=g[0]+E[0]*O,f[1]=g[1]+E[1]*O,f[2]=g[2]+E[2]*O,f[3]=g[3]+E[3]*O,f},le.sub=le.mul=void 0;var n=function(f,g){if(f&&f.__esModule)return f;if(f===null||u(f)!=="object"&&typeof f!="function")return{default:f};var E=s(void 0);if(E&&E.has(f))return E.get(f);var O={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in f)if(w!=="default"&&Object.prototype.hasOwnProperty.call(f,w)){var C=D?Object.getOwnPropertyDescriptor(f,w):null;C&&(C.get||C.set)?Object.defineProperty(O,w,C):O[w]=f[w]}return O.default=f,E&&E.set(f,O),O}(K());function s(f){if(typeof WeakMap!="function")return null;var g=new WeakMap,E=new WeakMap;return(s=function(O){return O?E:g})(f)}function c(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=E[0],P=E[1],k=E[2],N=E[3];return f[0]=O*R+w*P,f[1]=D*R+C*P,f[2]=O*k+w*N,f[3]=D*k+C*N,f}function m(f,g,E){return f[0]=g[0]-E[0],f[1]=g[1]-E[1],f[2]=g[2]-E[2],f[3]=g[3]-E[3],f}return le.mul=c,le.sub=m,le}var ue,be={};function Ce(){if(ue)return be;function u(f){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},u(f)}ue=1,Object.defineProperty(be,"__esModule",{value:!0}),be.create=function(){var f=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0,f[4]=0,f[5]=0),f[0]=1,f[3]=1,f},be.clone=function(f){var g=new n.ARRAY_TYPE(6);return g[0]=f[0],g[1]=f[1],g[2]=f[2],g[3]=f[3],g[4]=f[4],g[5]=f[5],g},be.copy=function(f,g){return f[0]=g[0],f[1]=g[1],f[2]=g[2],f[3]=g[3],f[4]=g[4],f[5]=g[5],f},be.identity=function(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=1,f[4]=0,f[5]=0,f},be.fromValues=function(f,g,E,O,D,w){var C=new n.ARRAY_TYPE(6);return C[0]=f,C[1]=g,C[2]=E,C[3]=O,C[4]=D,C[5]=w,C},be.set=function(f,g,E,O,D,w,C){return f[0]=g,f[1]=E,f[2]=O,f[3]=D,f[4]=w,f[5]=C,f},be.invert=function(f,g){var E=g[0],O=g[1],D=g[2],w=g[3],C=g[4],R=g[5],P=E*w-O*D;return P?(f[0]=w*(P=1/P),f[1]=-O*P,f[2]=-D*P,f[3]=E*P,f[4]=(D*R-w*C)*P,f[5]=(O*C-E*R)*P,f):null},be.determinant=function(f){return f[0]*f[3]-f[1]*f[2]},be.multiply=c,be.rotate=function(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=g[4],P=g[5],k=Math.sin(E),N=Math.cos(E);return f[0]=O*N+w*k,f[1]=D*N+C*k,f[2]=O*-k+w*N,f[3]=D*-k+C*N,f[4]=R,f[5]=P,f},be.scale=function(f,g,E){var O=g[1],D=g[2],w=g[3],C=g[4],R=g[5],P=E[0],k=E[1];return f[0]=g[0]*P,f[1]=O*P,f[2]=D*k,f[3]=w*k,f[4]=C,f[5]=R,f},be.translate=function(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=g[4],P=g[5],k=E[0],N=E[1];return f[0]=O,f[1]=D,f[2]=w,f[3]=C,f[4]=O*k+w*N+R,f[5]=D*k+C*N+P,f},be.fromRotation=function(f,g){var E=Math.sin(g),O=Math.cos(g);return f[0]=O,f[1]=E,f[2]=-E,f[3]=O,f[4]=0,f[5]=0,f},be.fromScaling=function(f,g){return f[0]=g[0],f[1]=0,f[2]=0,f[3]=g[1],f[4]=0,f[5]=0,f},be.fromTranslation=function(f,g){return f[0]=1,f[1]=0,f[2]=0,f[3]=1,f[4]=g[0],f[5]=g[1],f},be.str=function(f){return"mat2d("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+", "+f[4]+", "+f[5]+")"},be.frob=function(f){return Math.hypot(f[0],f[1],f[2],f[3],f[4],f[5],1)},be.add=function(f,g,E){return f[0]=g[0]+E[0],f[1]=g[1]+E[1],f[2]=g[2]+E[2],f[3]=g[3]+E[3],f[4]=g[4]+E[4],f[5]=g[5]+E[5],f},be.subtract=m,be.multiplyScalar=function(f,g,E){return f[0]=g[0]*E,f[1]=g[1]*E,f[2]=g[2]*E,f[3]=g[3]*E,f[4]=g[4]*E,f[5]=g[5]*E,f},be.multiplyScalarAndAdd=function(f,g,E,O){return f[0]=g[0]+E[0]*O,f[1]=g[1]+E[1]*O,f[2]=g[2]+E[2]*O,f[3]=g[3]+E[3]*O,f[4]=g[4]+E[4]*O,f[5]=g[5]+E[5]*O,f},be.exactEquals=function(f,g){return f[0]===g[0]&&f[1]===g[1]&&f[2]===g[2]&&f[3]===g[3]&&f[4]===g[4]&&f[5]===g[5]},be.equals=function(f,g){var E=f[0],O=f[1],D=f[2],w=f[3],C=f[4],R=f[5],P=g[0],k=g[1],N=g[2],W=g[3],X=g[4],ee=g[5];return Math.abs(E-P)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(P))&&Math.abs(O-k)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(k))&&Math.abs(D-N)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(N))&&Math.abs(w-W)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(W))&&Math.abs(C-X)<=n.EPSILON*Math.max(1,Math.abs(C),Math.abs(X))&&Math.abs(R-ee)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ee))},be.sub=be.mul=void 0;var n=function(f,g){if(f&&f.__esModule)return f;if(f===null||u(f)!=="object"&&typeof f!="function")return{default:f};var E=s(void 0);if(E&&E.has(f))return E.get(f);var O={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in f)if(w!=="default"&&Object.prototype.hasOwnProperty.call(f,w)){var C=D?Object.getOwnPropertyDescriptor(f,w):null;C&&(C.get||C.set)?Object.defineProperty(O,w,C):O[w]=f[w]}return O.default=f,E&&E.set(f,O),O}(K());function s(f){if(typeof WeakMap!="function")return null;var g=new WeakMap,E=new WeakMap;return(s=function(O){return O?E:g})(f)}function c(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=g[4],P=g[5],k=E[0],N=E[1],W=E[2],X=E[3],ee=E[4],ne=E[5];return f[0]=O*k+w*N,f[1]=D*k+C*N,f[2]=O*W+w*X,f[3]=D*W+C*X,f[4]=O*ee+w*ne+R,f[5]=D*ee+C*ne+P,f}function m(f,g,E){return f[0]=g[0]-E[0],f[1]=g[1]-E[1],f[2]=g[2]-E[2],f[3]=g[3]-E[3],f[4]=g[4]-E[4],f[5]=g[5]-E[5],f}return be.mul=c,be.sub=m,be}var Re,De={};function ve(){if(Re)return De;function u(f){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},u(f)}Re=1,Object.defineProperty(De,"__esModule",{value:!0}),De.create=function(){var f=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f},De.fromMat4=function(f,g){return f[0]=g[0],f[1]=g[1],f[2]=g[2],f[3]=g[4],f[4]=g[5],f[5]=g[6],f[6]=g[8],f[7]=g[9],f[8]=g[10],f},De.clone=function(f){var g=new n.ARRAY_TYPE(9);return g[0]=f[0],g[1]=f[1],g[2]=f[2],g[3]=f[3],g[4]=f[4],g[5]=f[5],g[6]=f[6],g[7]=f[7],g[8]=f[8],g},De.copy=function(f,g){return f[0]=g[0],f[1]=g[1],f[2]=g[2],f[3]=g[3],f[4]=g[4],f[5]=g[5],f[6]=g[6],f[7]=g[7],f[8]=g[8],f},De.fromValues=function(f,g,E,O,D,w,C,R,P){var k=new n.ARRAY_TYPE(9);return k[0]=f,k[1]=g,k[2]=E,k[3]=O,k[4]=D,k[5]=w,k[6]=C,k[7]=R,k[8]=P,k},De.set=function(f,g,E,O,D,w,C,R,P,k){return f[0]=g,f[1]=E,f[2]=O,f[3]=D,f[4]=w,f[5]=C,f[6]=R,f[7]=P,f[8]=k,f},De.identity=function(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=1,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},De.transpose=function(f,g){if(f===g){var E=g[1],O=g[2],D=g[5];f[1]=g[3],f[2]=g[6],f[3]=E,f[5]=g[7],f[6]=O,f[7]=D}else f[0]=g[0],f[1]=g[3],f[2]=g[6],f[3]=g[1],f[4]=g[4],f[5]=g[7],f[6]=g[2],f[7]=g[5],f[8]=g[8];return f},De.invert=function(f,g){var E=g[0],O=g[1],D=g[2],w=g[3],C=g[4],R=g[5],P=g[6],k=g[7],N=g[8],W=N*C-R*k,X=-N*w+R*P,ee=k*w-C*P,ne=E*W+O*X+D*ee;return ne?(f[0]=W*(ne=1/ne),f[1]=(-N*O+D*k)*ne,f[2]=(R*O-D*C)*ne,f[3]=X*ne,f[4]=(N*E-D*P)*ne,f[5]=(-R*E+D*w)*ne,f[6]=ee*ne,f[7]=(-k*E+O*P)*ne,f[8]=(C*E-O*w)*ne,f):null},De.adjoint=function(f,g){var E=g[0],O=g[1],D=g[2],w=g[3],C=g[4],R=g[5],P=g[6],k=g[7],N=g[8];return f[0]=C*N-R*k,f[1]=D*k-O*N,f[2]=O*R-D*C,f[3]=R*P-w*N,f[4]=E*N-D*P,f[5]=D*w-E*R,f[6]=w*k-C*P,f[7]=O*P-E*k,f[8]=E*C-O*w,f},De.determinant=function(f){var g=f[3],E=f[4],O=f[5],D=f[6],w=f[7],C=f[8];return f[0]*(C*E-O*w)+f[1]*(-C*g+O*D)+f[2]*(w*g-E*D)},De.multiply=c,De.translate=function(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=g[4],P=g[5],k=g[6],N=g[7],W=g[8],X=E[0],ee=E[1];return f[0]=O,f[1]=D,f[2]=w,f[3]=C,f[4]=R,f[5]=P,f[6]=X*O+ee*C+k,f[7]=X*D+ee*R+N,f[8]=X*w+ee*P+W,f},De.rotate=function(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=g[4],P=g[5],k=g[6],N=g[7],W=g[8],X=Math.sin(E),ee=Math.cos(E);return f[0]=ee*O+X*C,f[1]=ee*D+X*R,f[2]=ee*w+X*P,f[3]=ee*C-X*O,f[4]=ee*R-X*D,f[5]=ee*P-X*w,f[6]=k,f[7]=N,f[8]=W,f},De.scale=function(f,g,E){var O=E[0],D=E[1];return f[0]=O*g[0],f[1]=O*g[1],f[2]=O*g[2],f[3]=D*g[3],f[4]=D*g[4],f[5]=D*g[5],f[6]=g[6],f[7]=g[7],f[8]=g[8],f},De.fromTranslation=function(f,g){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=1,f[5]=0,f[6]=g[0],f[7]=g[1],f[8]=1,f},De.fromRotation=function(f,g){var E=Math.sin(g),O=Math.cos(g);return f[0]=O,f[1]=E,f[2]=0,f[3]=-E,f[4]=O,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},De.fromScaling=function(f,g){return f[0]=g[0],f[1]=0,f[2]=0,f[3]=0,f[4]=g[1],f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},De.fromMat2d=function(f,g){return f[0]=g[0],f[1]=g[1],f[2]=0,f[3]=g[2],f[4]=g[3],f[5]=0,f[6]=g[4],f[7]=g[5],f[8]=1,f},De.fromQuat=function(f,g){var E=g[0],O=g[1],D=g[2],w=g[3],C=E+E,R=O+O,P=D+D,k=E*C,N=O*C,W=O*R,X=D*C,ee=D*R,ne=D*P,J=w*C,he=w*R,ye=w*P;return f[0]=1-W-ne,f[3]=N-ye,f[6]=X+he,f[1]=N+ye,f[4]=1-k-ne,f[7]=ee-J,f[2]=X-he,f[5]=ee+J,f[8]=1-k-W,f},De.normalFromMat4=function(f,g){var E=g[0],O=g[1],D=g[2],w=g[3],C=g[4],R=g[5],P=g[6],k=g[7],N=g[8],W=g[9],X=g[10],ee=g[11],ne=g[12],J=g[13],he=g[14],ye=g[15],Me=E*R-O*C,Ve=E*P-D*C,Ne=E*k-w*C,$e=O*P-D*R,ot=O*k-w*R,je=D*k-w*P,nt=N*J-W*ne,ct=N*he-X*ne,ht=N*ye-ee*ne,_t=W*he-X*J,At=W*ye-ee*J,It=X*ye-ee*he,wt=Me*It-Ve*At+Ne*_t+$e*ht-ot*ct+je*nt;return wt?(f[0]=(R*It-P*At+k*_t)*(wt=1/wt),f[1]=(P*ht-C*It-k*ct)*wt,f[2]=(C*At-R*ht+k*nt)*wt,f[3]=(D*At-O*It-w*_t)*wt,f[4]=(E*It-D*ht+w*ct)*wt,f[5]=(O*ht-E*At-w*nt)*wt,f[6]=(J*je-he*ot+ye*$e)*wt,f[7]=(he*Ne-ne*je-ye*Ve)*wt,f[8]=(ne*ot-J*Ne+ye*Me)*wt,f):null},De.projection=function(f,g,E){return f[0]=2/g,f[1]=0,f[2]=0,f[3]=0,f[4]=-2/E,f[5]=0,f[6]=-1,f[7]=1,f[8]=1,f},De.str=function(f){return"mat3("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+", "+f[4]+", "+f[5]+", "+f[6]+", "+f[7]+", "+f[8]+")"},De.frob=function(f){return Math.hypot(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8])},De.add=function(f,g,E){return f[0]=g[0]+E[0],f[1]=g[1]+E[1],f[2]=g[2]+E[2],f[3]=g[3]+E[3],f[4]=g[4]+E[4],f[5]=g[5]+E[5],f[6]=g[6]+E[6],f[7]=g[7]+E[7],f[8]=g[8]+E[8],f},De.subtract=m,De.multiplyScalar=function(f,g,E){return f[0]=g[0]*E,f[1]=g[1]*E,f[2]=g[2]*E,f[3]=g[3]*E,f[4]=g[4]*E,f[5]=g[5]*E,f[6]=g[6]*E,f[7]=g[7]*E,f[8]=g[8]*E,f},De.multiplyScalarAndAdd=function(f,g,E,O){return f[0]=g[0]+E[0]*O,f[1]=g[1]+E[1]*O,f[2]=g[2]+E[2]*O,f[3]=g[3]+E[3]*O,f[4]=g[4]+E[4]*O,f[5]=g[5]+E[5]*O,f[6]=g[6]+E[6]*O,f[7]=g[7]+E[7]*O,f[8]=g[8]+E[8]*O,f},De.exactEquals=function(f,g){return f[0]===g[0]&&f[1]===g[1]&&f[2]===g[2]&&f[3]===g[3]&&f[4]===g[4]&&f[5]===g[5]&&f[6]===g[6]&&f[7]===g[7]&&f[8]===g[8]},De.equals=function(f,g){var E=f[0],O=f[1],D=f[2],w=f[3],C=f[4],R=f[5],P=f[6],k=f[7],N=f[8],W=g[0],X=g[1],ee=g[2],ne=g[3],J=g[4],he=g[5],ye=g[6],Me=g[7],Ve=g[8];return Math.abs(E-W)<=n.EPSILON*Math.max(1,Math.abs(E),Math.abs(W))&&Math.abs(O-X)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(X))&&Math.abs(D-ee)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(ee))&&Math.abs(w-ne)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(ne))&&Math.abs(C-J)<=n.EPSILON*Math.max(1,Math.abs(C),Math.abs(J))&&Math.abs(R-he)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(he))&&Math.abs(P-ye)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(ye))&&Math.abs(k-Me)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Me))&&Math.abs(N-Ve)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(Ve))},De.sub=De.mul=void 0;var n=function(f,g){if(f&&f.__esModule)return f;if(f===null||u(f)!=="object"&&typeof f!="function")return{default:f};var E=s(void 0);if(E&&E.has(f))return E.get(f);var O={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in f)if(w!=="default"&&Object.prototype.hasOwnProperty.call(f,w)){var C=D?Object.getOwnPropertyDescriptor(f,w):null;C&&(C.get||C.set)?Object.defineProperty(O,w,C):O[w]=f[w]}return O.default=f,E&&E.set(f,O),O}(K());function s(f){if(typeof WeakMap!="function")return null;var g=new WeakMap,E=new WeakMap;return(s=function(O){return O?E:g})(f)}function c(f,g,E){var O=g[0],D=g[1],w=g[2],C=g[3],R=g[4],P=g[5],k=g[6],N=g[7],W=g[8],X=E[0],ee=E[1],ne=E[2],J=E[3],he=E[4],ye=E[5],Me=E[6],Ve=E[7],Ne=E[8];return f[0]=X*O+ee*C+ne*k,f[1]=X*D+ee*R+ne*N,f[2]=X*w+ee*P+ne*W,f[3]=J*O+he*C+ye*k,f[4]=J*D+he*R+ye*N,f[5]=J*w+he*P+ye*W,f[6]=Me*O+Ve*C+Ne*k,f[7]=Me*D+Ve*R+Ne*N,f[8]=Me*w+Ve*P+Ne*W,f}function m(f,g,E){return f[0]=g[0]-E[0],f[1]=g[1]-E[1],f[2]=g[2]-E[2],f[3]=g[3]-E[3],f[4]=g[4]-E[4],f[5]=g[5]-E[5],f[6]=g[6]-E[6],f[7]=g[7]-E[7],f[8]=g[8]-E[8],f}return De.mul=c,De.sub=m,De}var Le,Fe={};function lt(){if(Le)return Fe;function u(w){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},u(w)}Le=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.create=function(){var w=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},Fe.clone=function(w){var C=new n.ARRAY_TYPE(16);return C[0]=w[0],C[1]=w[1],C[2]=w[2],C[3]=w[3],C[4]=w[4],C[5]=w[5],C[6]=w[6],C[7]=w[7],C[8]=w[8],C[9]=w[9],C[10]=w[10],C[11]=w[11],C[12]=w[12],C[13]=w[13],C[14]=w[14],C[15]=w[15],C},Fe.copy=function(w,C){return w[0]=C[0],w[1]=C[1],w[2]=C[2],w[3]=C[3],w[4]=C[4],w[5]=C[5],w[6]=C[6],w[7]=C[7],w[8]=C[8],w[9]=C[9],w[10]=C[10],w[11]=C[11],w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15],w},Fe.fromValues=function(w,C,R,P,k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne){var $e=new n.ARRAY_TYPE(16);return $e[0]=w,$e[1]=C,$e[2]=R,$e[3]=P,$e[4]=k,$e[5]=N,$e[6]=W,$e[7]=X,$e[8]=ee,$e[9]=ne,$e[10]=J,$e[11]=he,$e[12]=ye,$e[13]=Me,$e[14]=Ve,$e[15]=Ne,$e},Fe.set=function(w,C,R,P,k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne,$e){return w[0]=C,w[1]=R,w[2]=P,w[3]=k,w[4]=N,w[5]=W,w[6]=X,w[7]=ee,w[8]=ne,w[9]=J,w[10]=he,w[11]=ye,w[12]=Me,w[13]=Ve,w[14]=Ne,w[15]=$e,w},Fe.identity=c,Fe.transpose=function(w,C){if(w===C){var R=C[1],P=C[2],k=C[3],N=C[6],W=C[7],X=C[11];w[1]=C[4],w[2]=C[8],w[3]=C[12],w[4]=R,w[6]=C[9],w[7]=C[13],w[8]=P,w[9]=N,w[11]=C[14],w[12]=k,w[13]=W,w[14]=X}else w[0]=C[0],w[1]=C[4],w[2]=C[8],w[3]=C[12],w[4]=C[1],w[5]=C[5],w[6]=C[9],w[7]=C[13],w[8]=C[2],w[9]=C[6],w[10]=C[10],w[11]=C[14],w[12]=C[3],w[13]=C[7],w[14]=C[11],w[15]=C[15];return w},Fe.invert=function(w,C){var R=C[0],P=C[1],k=C[2],N=C[3],W=C[4],X=C[5],ee=C[6],ne=C[7],J=C[8],he=C[9],ye=C[10],Me=C[11],Ve=C[12],Ne=C[13],$e=C[14],ot=C[15],je=R*X-P*W,nt=R*ee-k*W,ct=R*ne-N*W,ht=P*ee-k*X,_t=P*ne-N*X,At=k*ne-N*ee,It=J*Ne-he*Ve,wt=J*$e-ye*Ve,Xt=J*ot-Me*Ve,pn=he*$e-ye*Ne,Ut=he*ot-Me*Ne,Fn=ye*ot-Me*$e,An=je*Fn-nt*Ut+ct*pn+ht*Xt-_t*wt+At*It;return An?(w[0]=(X*Fn-ee*Ut+ne*pn)*(An=1/An),w[1]=(k*Ut-P*Fn-N*pn)*An,w[2]=(Ne*At-$e*_t+ot*ht)*An,w[3]=(ye*_t-he*At-Me*ht)*An,w[4]=(ee*Xt-W*Fn-ne*wt)*An,w[5]=(R*Fn-k*Xt+N*wt)*An,w[6]=($e*ct-Ve*At-ot*nt)*An,w[7]=(J*At-ye*ct+Me*nt)*An,w[8]=(W*Ut-X*Xt+ne*It)*An,w[9]=(P*Xt-R*Ut-N*It)*An,w[10]=(Ve*_t-Ne*ct+ot*je)*An,w[11]=(he*ct-J*_t-Me*je)*An,w[12]=(X*wt-W*pn-ee*It)*An,w[13]=(R*pn-P*wt+k*It)*An,w[14]=(Ne*nt-Ve*ht-$e*je)*An,w[15]=(J*ht-he*nt+ye*je)*An,w):null},Fe.adjoint=function(w,C){var R=C[0],P=C[1],k=C[2],N=C[3],W=C[4],X=C[5],ee=C[6],ne=C[7],J=C[8],he=C[9],ye=C[10],Me=C[11],Ve=C[12],Ne=C[13],$e=C[14],ot=C[15];return w[0]=X*(ye*ot-Me*$e)-he*(ee*ot-ne*$e)+Ne*(ee*Me-ne*ye),w[1]=-(P*(ye*ot-Me*$e)-he*(k*ot-N*$e)+Ne*(k*Me-N*ye)),w[2]=P*(ee*ot-ne*$e)-X*(k*ot-N*$e)+Ne*(k*ne-N*ee),w[3]=-(P*(ee*Me-ne*ye)-X*(k*Me-N*ye)+he*(k*ne-N*ee)),w[4]=-(W*(ye*ot-Me*$e)-J*(ee*ot-ne*$e)+Ve*(ee*Me-ne*ye)),w[5]=R*(ye*ot-Me*$e)-J*(k*ot-N*$e)+Ve*(k*Me-N*ye),w[6]=-(R*(ee*ot-ne*$e)-W*(k*ot-N*$e)+Ve*(k*ne-N*ee)),w[7]=R*(ee*Me-ne*ye)-W*(k*Me-N*ye)+J*(k*ne-N*ee),w[8]=W*(he*ot-Me*Ne)-J*(X*ot-ne*Ne)+Ve*(X*Me-ne*he),w[9]=-(R*(he*ot-Me*Ne)-J*(P*ot-N*Ne)+Ve*(P*Me-N*he)),w[10]=R*(X*ot-ne*Ne)-W*(P*ot-N*Ne)+Ve*(P*ne-N*X),w[11]=-(R*(X*Me-ne*he)-W*(P*Me-N*he)+J*(P*ne-N*X)),w[12]=-(W*(he*$e-ye*Ne)-J*(X*$e-ee*Ne)+Ve*(X*ye-ee*he)),w[13]=R*(he*$e-ye*Ne)-J*(P*$e-k*Ne)+Ve*(P*ye-k*he),w[14]=-(R*(X*$e-ee*Ne)-W*(P*$e-k*Ne)+Ve*(P*ee-k*X)),w[15]=R*(X*ye-ee*he)-W*(P*ye-k*he)+J*(P*ee-k*X),w},Fe.determinant=function(w){var C=w[0],R=w[1],P=w[2],k=w[3],N=w[4],W=w[5],X=w[6],ee=w[7],ne=w[8],J=w[9],he=w[10],ye=w[11],Me=w[12],Ve=w[13],Ne=w[14],$e=w[15];return(C*W-R*N)*(he*$e-ye*Ne)-(C*X-P*N)*(J*$e-ye*Ve)+(C*ee-k*N)*(J*Ne-he*Ve)+(R*X-P*W)*(ne*$e-ye*Me)-(R*ee-k*W)*(ne*Ne-he*Me)+(P*ee-k*X)*(ne*Ve-J*Me)},Fe.multiply=m,Fe.translate=function(w,C,R){var P,k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne=R[0],$e=R[1],ot=R[2];return C===w?(w[12]=C[0]*Ne+C[4]*$e+C[8]*ot+C[12],w[13]=C[1]*Ne+C[5]*$e+C[9]*ot+C[13],w[14]=C[2]*Ne+C[6]*$e+C[10]*ot+C[14],w[15]=C[3]*Ne+C[7]*$e+C[11]*ot+C[15]):(k=C[1],N=C[2],W=C[3],X=C[4],ee=C[5],ne=C[6],J=C[7],he=C[8],ye=C[9],Me=C[10],Ve=C[11],w[0]=P=C[0],w[1]=k,w[2]=N,w[3]=W,w[4]=X,w[5]=ee,w[6]=ne,w[7]=J,w[8]=he,w[9]=ye,w[10]=Me,w[11]=Ve,w[12]=P*Ne+X*$e+he*ot+C[12],w[13]=k*Ne+ee*$e+ye*ot+C[13],w[14]=N*Ne+ne*$e+Me*ot+C[14],w[15]=W*Ne+J*$e+Ve*ot+C[15]),w},Fe.scale=function(w,C,R){var P=R[0],k=R[1],N=R[2];return w[0]=C[0]*P,w[1]=C[1]*P,w[2]=C[2]*P,w[3]=C[3]*P,w[4]=C[4]*k,w[5]=C[5]*k,w[6]=C[6]*k,w[7]=C[7]*k,w[8]=C[8]*N,w[9]=C[9]*N,w[10]=C[10]*N,w[11]=C[11]*N,w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15],w},Fe.rotate=function(w,C,R,P){var k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne,$e,ot,je,nt,ct,ht,_t,At,It,wt,Xt,pn,Ut=P[0],Fn=P[1],An=P[2],xn=Math.hypot(Ut,Fn,An);return xn<n.EPSILON?null:(Ut*=xn=1/xn,Fn*=xn,An*=xn,k=Math.sin(R),N=Math.cos(R),ee=C[1],ne=C[2],J=C[3],ye=C[5],Me=C[6],Ve=C[7],$e=C[9],ot=C[10],je=C[11],nt=Ut*Ut*(W=1-N)+N,_t=Ut*Fn*W-An*k,At=Fn*Fn*W+N,It=An*Fn*W+Ut*k,wt=Ut*An*W+Fn*k,Xt=Fn*An*W-Ut*k,pn=An*An*W+N,w[0]=(X=C[0])*nt+(he=C[4])*(ct=Fn*Ut*W+An*k)+(Ne=C[8])*(ht=An*Ut*W-Fn*k),w[1]=ee*nt+ye*ct+$e*ht,w[2]=ne*nt+Me*ct+ot*ht,w[3]=J*nt+Ve*ct+je*ht,w[4]=X*_t+he*At+Ne*It,w[5]=ee*_t+ye*At+$e*It,w[6]=ne*_t+Me*At+ot*It,w[7]=J*_t+Ve*At+je*It,w[8]=X*wt+he*Xt+Ne*pn,w[9]=ee*wt+ye*Xt+$e*pn,w[10]=ne*wt+Me*Xt+ot*pn,w[11]=J*wt+Ve*Xt+je*pn,C!==w&&(w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15]),w)},Fe.rotateX=function(w,C,R){var P=Math.sin(R),k=Math.cos(R),N=C[4],W=C[5],X=C[6],ee=C[7],ne=C[8],J=C[9],he=C[10],ye=C[11];return C!==w&&(w[0]=C[0],w[1]=C[1],w[2]=C[2],w[3]=C[3],w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15]),w[4]=N*k+ne*P,w[5]=W*k+J*P,w[6]=X*k+he*P,w[7]=ee*k+ye*P,w[8]=ne*k-N*P,w[9]=J*k-W*P,w[10]=he*k-X*P,w[11]=ye*k-ee*P,w},Fe.rotateY=function(w,C,R){var P=Math.sin(R),k=Math.cos(R),N=C[0],W=C[1],X=C[2],ee=C[3],ne=C[8],J=C[9],he=C[10],ye=C[11];return C!==w&&(w[4]=C[4],w[5]=C[5],w[6]=C[6],w[7]=C[7],w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15]),w[0]=N*k-ne*P,w[1]=W*k-J*P,w[2]=X*k-he*P,w[3]=ee*k-ye*P,w[8]=N*P+ne*k,w[9]=W*P+J*k,w[10]=X*P+he*k,w[11]=ee*P+ye*k,w},Fe.rotateZ=function(w,C,R){var P=Math.sin(R),k=Math.cos(R),N=C[0],W=C[1],X=C[2],ee=C[3],ne=C[4],J=C[5],he=C[6],ye=C[7];return C!==w&&(w[8]=C[8],w[9]=C[9],w[10]=C[10],w[11]=C[11],w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15]),w[0]=N*k+ne*P,w[1]=W*k+J*P,w[2]=X*k+he*P,w[3]=ee*k+ye*P,w[4]=ne*k-N*P,w[5]=J*k-W*P,w[6]=he*k-X*P,w[7]=ye*k-ee*P,w},Fe.fromTranslation=function(w,C){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=C[0],w[13]=C[1],w[14]=C[2],w[15]=1,w},Fe.fromScaling=function(w,C){return w[0]=C[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=C[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=C[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Fe.fromRotation=function(w,C,R){var P,k,N,W=R[0],X=R[1],ee=R[2],ne=Math.hypot(W,X,ee);return ne<n.EPSILON?null:(W*=ne=1/ne,X*=ne,ee*=ne,P=Math.sin(C),k=Math.cos(C),w[0]=W*W*(N=1-k)+k,w[1]=X*W*N+ee*P,w[2]=ee*W*N-X*P,w[3]=0,w[4]=W*X*N-ee*P,w[5]=X*X*N+k,w[6]=ee*X*N+W*P,w[7]=0,w[8]=W*ee*N+X*P,w[9]=X*ee*N-W*P,w[10]=ee*ee*N+k,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},Fe.fromXRotation=function(w,C){var R=Math.sin(C),P=Math.cos(C);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=P,w[6]=R,w[7]=0,w[8]=0,w[9]=-R,w[10]=P,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Fe.fromYRotation=function(w,C){var R=Math.sin(C),P=Math.cos(C);return w[0]=P,w[1]=0,w[2]=-R,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=R,w[9]=0,w[10]=P,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Fe.fromZRotation=function(w,C){var R=Math.sin(C),P=Math.cos(C);return w[0]=P,w[1]=R,w[2]=0,w[3]=0,w[4]=-R,w[5]=P,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Fe.fromRotationTranslation=f,Fe.fromQuat2=function(w,C){var R=new n.ARRAY_TYPE(3),P=-C[0],k=-C[1],N=-C[2],W=C[3],X=C[4],ee=C[5],ne=C[6],J=C[7],he=P*P+k*k+N*N+W*W;return he>0?(R[0]=2*(X*W+J*P+ee*N-ne*k)/he,R[1]=2*(ee*W+J*k+ne*P-X*N)/he,R[2]=2*(ne*W+J*N+X*k-ee*P)/he):(R[0]=2*(X*W+J*P+ee*N-ne*k),R[1]=2*(ee*W+J*k+ne*P-X*N),R[2]=2*(ne*W+J*N+X*k-ee*P)),f(w,C,R),w},Fe.getTranslation=function(w,C){return w[0]=C[12],w[1]=C[13],w[2]=C[14],w},Fe.getScaling=g,Fe.getRotation=function(w,C){var R=new n.ARRAY_TYPE(3);g(R,C);var P=1/R[0],k=1/R[1],N=1/R[2],W=C[0]*P,X=C[1]*k,ee=C[2]*N,ne=C[4]*P,J=C[5]*k,he=C[6]*N,ye=C[8]*P,Me=C[9]*k,Ve=C[10]*N,Ne=W+J+Ve,$e=0;return Ne>0?($e=2*Math.sqrt(Ne+1),w[3]=.25*$e,w[0]=(he-Me)/$e,w[1]=(ye-ee)/$e,w[2]=(X-ne)/$e):W>J&&W>Ve?($e=2*Math.sqrt(1+W-J-Ve),w[3]=(he-Me)/$e,w[0]=.25*$e,w[1]=(X+ne)/$e,w[2]=(ye+ee)/$e):J>Ve?($e=2*Math.sqrt(1+J-W-Ve),w[3]=(ye-ee)/$e,w[0]=(X+ne)/$e,w[1]=.25*$e,w[2]=(he+Me)/$e):($e=2*Math.sqrt(1+Ve-W-J),w[3]=(X-ne)/$e,w[0]=(ye+ee)/$e,w[1]=(he+Me)/$e,w[2]=.25*$e),w},Fe.fromRotationTranslationScale=function(w,C,R,P){var k=C[0],N=C[1],W=C[2],X=C[3],ee=k+k,ne=N+N,J=W+W,he=k*ee,ye=k*ne,Me=k*J,Ve=N*ne,Ne=N*J,$e=W*J,ot=X*ee,je=X*ne,nt=X*J,ct=P[0],ht=P[1],_t=P[2];return w[0]=(1-(Ve+$e))*ct,w[1]=(ye+nt)*ct,w[2]=(Me-je)*ct,w[3]=0,w[4]=(ye-nt)*ht,w[5]=(1-(he+$e))*ht,w[6]=(Ne+ot)*ht,w[7]=0,w[8]=(Me+je)*_t,w[9]=(Ne-ot)*_t,w[10]=(1-(he+Ve))*_t,w[11]=0,w[12]=R[0],w[13]=R[1],w[14]=R[2],w[15]=1,w},Fe.fromRotationTranslationScaleOrigin=function(w,C,R,P,k){var N=C[0],W=C[1],X=C[2],ee=C[3],ne=N+N,J=W+W,he=X+X,ye=N*ne,Me=N*J,Ve=N*he,Ne=W*J,$e=W*he,ot=X*he,je=ee*ne,nt=ee*J,ct=ee*he,ht=P[0],_t=P[1],At=P[2],It=k[0],wt=k[1],Xt=k[2],pn=(1-(Ne+ot))*ht,Ut=(Me+ct)*ht,Fn=(Ve-nt)*ht,An=(Me-ct)*_t,xn=(1-(ye+ot))*_t,cn=($e+je)*_t,ur=(Ve+nt)*At,zn=($e-je)*At,qn=(1-(ye+Ne))*At;return w[0]=pn,w[1]=Ut,w[2]=Fn,w[3]=0,w[4]=An,w[5]=xn,w[6]=cn,w[7]=0,w[8]=ur,w[9]=zn,w[10]=qn,w[11]=0,w[12]=R[0]+It-(pn*It+An*wt+ur*Xt),w[13]=R[1]+wt-(Ut*It+xn*wt+zn*Xt),w[14]=R[2]+Xt-(Fn*It+cn*wt+qn*Xt),w[15]=1,w},Fe.fromQuat=function(w,C){var R=C[0],P=C[1],k=C[2],N=C[3],W=R+R,X=P+P,ee=k+k,ne=R*W,J=P*W,he=P*X,ye=k*W,Me=k*X,Ve=k*ee,Ne=N*W,$e=N*X,ot=N*ee;return w[0]=1-he-Ve,w[1]=J+ot,w[2]=ye-$e,w[3]=0,w[4]=J-ot,w[5]=1-ne-Ve,w[6]=Me+Ne,w[7]=0,w[8]=ye+$e,w[9]=Me-Ne,w[10]=1-ne-he,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},Fe.frustum=function(w,C,R,P,k,N,W){var X=1/(R-C),ee=1/(k-P),ne=1/(N-W);return w[0]=2*N*X,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*N*ee,w[6]=0,w[7]=0,w[8]=(R+C)*X,w[9]=(k+P)*ee,w[10]=(W+N)*ne,w[11]=-1,w[12]=0,w[13]=0,w[14]=W*N*2*ne,w[15]=0,w},Fe.perspectiveNO=E,Fe.perspectiveZO=function(w,C,R,P,k){var N,W=1/Math.tan(C/2);return w[0]=W/R,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,k!=null&&k!==1/0?(w[10]=k*(N=1/(P-k)),w[14]=k*P*N):(w[10]=-1,w[14]=-P),w},Fe.perspectiveFromFieldOfView=function(w,C,R,P){var k=Math.tan(C.upDegrees*Math.PI/180),N=Math.tan(C.downDegrees*Math.PI/180),W=Math.tan(C.leftDegrees*Math.PI/180),X=Math.tan(C.rightDegrees*Math.PI/180),ee=2/(W+X),ne=2/(k+N);return w[0]=ee,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=ne,w[6]=0,w[7]=0,w[8]=-(W-X)*ee*.5,w[9]=(k-N)*ne*.5,w[10]=P/(R-P),w[11]=-1,w[12]=0,w[13]=0,w[14]=P*R/(R-P),w[15]=0,w},Fe.orthoNO=O,Fe.orthoZO=function(w,C,R,P,k,N,W){var X=1/(C-R),ee=1/(P-k),ne=1/(N-W);return w[0]=-2*X,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ee,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=ne,w[11]=0,w[12]=(C+R)*X,w[13]=(k+P)*ee,w[14]=N*ne,w[15]=1,w},Fe.lookAt=function(w,C,R,P){var k,N,W,X,ee,ne,J,he,ye,Me,Ve=C[0],Ne=C[1],$e=C[2],ot=P[0],je=P[1],nt=P[2],ct=R[0],ht=R[1],_t=R[2];return Math.abs(Ve-ct)<n.EPSILON&&Math.abs(Ne-ht)<n.EPSILON&&Math.abs($e-_t)<n.EPSILON?c(w):(J=Ve-ct,he=Ne-ht,ye=$e-_t,k=je*(ye*=Me=1/Math.hypot(J,he,ye))-nt*(he*=Me),N=nt*(J*=Me)-ot*ye,W=ot*he-je*J,(Me=Math.hypot(k,N,W))?(k*=Me=1/Me,N*=Me,W*=Me):(k=0,N=0,W=0),X=he*W-ye*N,ee=ye*k-J*W,ne=J*N-he*k,(Me=Math.hypot(X,ee,ne))?(X*=Me=1/Me,ee*=Me,ne*=Me):(X=0,ee=0,ne=0),w[0]=k,w[1]=X,w[2]=J,w[3]=0,w[4]=N,w[5]=ee,w[6]=he,w[7]=0,w[8]=W,w[9]=ne,w[10]=ye,w[11]=0,w[12]=-(k*Ve+N*Ne+W*$e),w[13]=-(X*Ve+ee*Ne+ne*$e),w[14]=-(J*Ve+he*Ne+ye*$e),w[15]=1,w)},Fe.targetTo=function(w,C,R,P){var k=C[0],N=C[1],W=C[2],X=P[0],ee=P[1],ne=P[2],J=k-R[0],he=N-R[1],ye=W-R[2],Me=J*J+he*he+ye*ye;Me>0&&(J*=Me=1/Math.sqrt(Me),he*=Me,ye*=Me);var Ve=ee*ye-ne*he,Ne=ne*J-X*ye,$e=X*he-ee*J;return(Me=Ve*Ve+Ne*Ne+$e*$e)>0&&(Ve*=Me=1/Math.sqrt(Me),Ne*=Me,$e*=Me),w[0]=Ve,w[1]=Ne,w[2]=$e,w[3]=0,w[4]=he*$e-ye*Ne,w[5]=ye*Ve-J*$e,w[6]=J*Ne-he*Ve,w[7]=0,w[8]=J,w[9]=he,w[10]=ye,w[11]=0,w[12]=k,w[13]=N,w[14]=W,w[15]=1,w},Fe.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},Fe.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},Fe.add=function(w,C,R){return w[0]=C[0]+R[0],w[1]=C[1]+R[1],w[2]=C[2]+R[2],w[3]=C[3]+R[3],w[4]=C[4]+R[4],w[5]=C[5]+R[5],w[6]=C[6]+R[6],w[7]=C[7]+R[7],w[8]=C[8]+R[8],w[9]=C[9]+R[9],w[10]=C[10]+R[10],w[11]=C[11]+R[11],w[12]=C[12]+R[12],w[13]=C[13]+R[13],w[14]=C[14]+R[14],w[15]=C[15]+R[15],w},Fe.subtract=D,Fe.multiplyScalar=function(w,C,R){return w[0]=C[0]*R,w[1]=C[1]*R,w[2]=C[2]*R,w[3]=C[3]*R,w[4]=C[4]*R,w[5]=C[5]*R,w[6]=C[6]*R,w[7]=C[7]*R,w[8]=C[8]*R,w[9]=C[9]*R,w[10]=C[10]*R,w[11]=C[11]*R,w[12]=C[12]*R,w[13]=C[13]*R,w[14]=C[14]*R,w[15]=C[15]*R,w},Fe.multiplyScalarAndAdd=function(w,C,R,P){return w[0]=C[0]+R[0]*P,w[1]=C[1]+R[1]*P,w[2]=C[2]+R[2]*P,w[3]=C[3]+R[3]*P,w[4]=C[4]+R[4]*P,w[5]=C[5]+R[5]*P,w[6]=C[6]+R[6]*P,w[7]=C[7]+R[7]*P,w[8]=C[8]+R[8]*P,w[9]=C[9]+R[9]*P,w[10]=C[10]+R[10]*P,w[11]=C[11]+R[11]*P,w[12]=C[12]+R[12]*P,w[13]=C[13]+R[13]*P,w[14]=C[14]+R[14]*P,w[15]=C[15]+R[15]*P,w},Fe.exactEquals=function(w,C){return w[0]===C[0]&&w[1]===C[1]&&w[2]===C[2]&&w[3]===C[3]&&w[4]===C[4]&&w[5]===C[5]&&w[6]===C[6]&&w[7]===C[7]&&w[8]===C[8]&&w[9]===C[9]&&w[10]===C[10]&&w[11]===C[11]&&w[12]===C[12]&&w[13]===C[13]&&w[14]===C[14]&&w[15]===C[15]},Fe.equals=function(w,C){var R=w[0],P=w[1],k=w[2],N=w[3],W=w[4],X=w[5],ee=w[6],ne=w[7],J=w[8],he=w[9],ye=w[10],Me=w[11],Ve=w[12],Ne=w[13],$e=w[14],ot=w[15],je=C[0],nt=C[1],ct=C[2],ht=C[3],_t=C[4],At=C[5],It=C[6],wt=C[7],Xt=C[8],pn=C[9],Ut=C[10],Fn=C[11],An=C[12],xn=C[13],cn=C[14],ur=C[15];return Math.abs(R-je)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(je))&&Math.abs(P-nt)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(nt))&&Math.abs(k-ct)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(ct))&&Math.abs(N-ht)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(ht))&&Math.abs(W-_t)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(_t))&&Math.abs(X-At)<=n.EPSILON*Math.max(1,Math.abs(X),Math.abs(At))&&Math.abs(ee-It)<=n.EPSILON*Math.max(1,Math.abs(ee),Math.abs(It))&&Math.abs(ne-wt)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(wt))&&Math.abs(J-Xt)<=n.EPSILON*Math.max(1,Math.abs(J),Math.abs(Xt))&&Math.abs(he-pn)<=n.EPSILON*Math.max(1,Math.abs(he),Math.abs(pn))&&Math.abs(ye-Ut)<=n.EPSILON*Math.max(1,Math.abs(ye),Math.abs(Ut))&&Math.abs(Me-Fn)<=n.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Fn))&&Math.abs(Ve-An)<=n.EPSILON*Math.max(1,Math.abs(Ve),Math.abs(An))&&Math.abs(Ne-xn)<=n.EPSILON*Math.max(1,Math.abs(Ne),Math.abs(xn))&&Math.abs($e-cn)<=n.EPSILON*Math.max(1,Math.abs($e),Math.abs(cn))&&Math.abs(ot-ur)<=n.EPSILON*Math.max(1,Math.abs(ot),Math.abs(ur))},Fe.sub=Fe.mul=Fe.ortho=Fe.perspective=void 0;var n=function(w,C){if(w&&w.__esModule)return w;if(w===null||u(w)!=="object"&&typeof w!="function")return{default:w};var R=s(void 0);if(R&&R.has(w))return R.get(w);var P={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in w)if(N!=="default"&&Object.prototype.hasOwnProperty.call(w,N)){var W=k?Object.getOwnPropertyDescriptor(w,N):null;W&&(W.get||W.set)?Object.defineProperty(P,N,W):P[N]=w[N]}return P.default=w,R&&R.set(w,P),P}(K());function s(w){if(typeof WeakMap!="function")return null;var C=new WeakMap,R=new WeakMap;return(s=function(P){return P?R:C})(w)}function c(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function m(w,C,R){var P=C[0],k=C[1],N=C[2],W=C[3],X=C[4],ee=C[5],ne=C[6],J=C[7],he=C[8],ye=C[9],Me=C[10],Ve=C[11],Ne=C[12],$e=C[13],ot=C[14],je=C[15],nt=R[0],ct=R[1],ht=R[2],_t=R[3];return w[0]=nt*P+ct*X+ht*he+_t*Ne,w[1]=nt*k+ct*ee+ht*ye+_t*$e,w[2]=nt*N+ct*ne+ht*Me+_t*ot,w[3]=nt*W+ct*J+ht*Ve+_t*je,w[4]=(nt=R[4])*P+(ct=R[5])*X+(ht=R[6])*he+(_t=R[7])*Ne,w[5]=nt*k+ct*ee+ht*ye+_t*$e,w[6]=nt*N+ct*ne+ht*Me+_t*ot,w[7]=nt*W+ct*J+ht*Ve+_t*je,w[8]=(nt=R[8])*P+(ct=R[9])*X+(ht=R[10])*he+(_t=R[11])*Ne,w[9]=nt*k+ct*ee+ht*ye+_t*$e,w[10]=nt*N+ct*ne+ht*Me+_t*ot,w[11]=nt*W+ct*J+ht*Ve+_t*je,w[12]=(nt=R[12])*P+(ct=R[13])*X+(ht=R[14])*he+(_t=R[15])*Ne,w[13]=nt*k+ct*ee+ht*ye+_t*$e,w[14]=nt*N+ct*ne+ht*Me+_t*ot,w[15]=nt*W+ct*J+ht*Ve+_t*je,w}function f(w,C,R){var P=C[0],k=C[1],N=C[2],W=C[3],X=P+P,ee=k+k,ne=N+N,J=P*X,he=P*ee,ye=P*ne,Me=k*ee,Ve=k*ne,Ne=N*ne,$e=W*X,ot=W*ee,je=W*ne;return w[0]=1-(Me+Ne),w[1]=he+je,w[2]=ye-ot,w[3]=0,w[4]=he-je,w[5]=1-(J+Ne),w[6]=Ve+$e,w[7]=0,w[8]=ye+ot,w[9]=Ve-$e,w[10]=1-(J+Me),w[11]=0,w[12]=R[0],w[13]=R[1],w[14]=R[2],w[15]=1,w}function g(w,C){var R=C[4],P=C[5],k=C[6],N=C[8],W=C[9],X=C[10];return w[0]=Math.hypot(C[0],C[1],C[2]),w[1]=Math.hypot(R,P,k),w[2]=Math.hypot(N,W,X),w}function E(w,C,R,P,k){var N,W=1/Math.tan(C/2);return w[0]=W/R,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,k!=null&&k!==1/0?(w[10]=(k+P)*(N=1/(P-k)),w[14]=2*k*P*N):(w[10]=-1,w[14]=-2*P),w}function O(w,C,R,P,k,N,W){var X=1/(C-R),ee=1/(P-k),ne=1/(N-W);return w[0]=-2*X,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ee,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*ne,w[11]=0,w[12]=(C+R)*X,w[13]=(k+P)*ee,w[14]=(W+N)*ne,w[15]=1,w}function D(w,C,R){return w[0]=C[0]-R[0],w[1]=C[1]-R[1],w[2]=C[2]-R[2],w[3]=C[3]-R[3],w[4]=C[4]-R[4],w[5]=C[5]-R[5],w[6]=C[6]-R[6],w[7]=C[7]-R[7],w[8]=C[8]-R[8],w[9]=C[9]-R[9],w[10]=C[10]-R[10],w[11]=C[11]-R[11],w[12]=C[12]-R[12],w[13]=C[13]-R[13],w[14]=C[14]-R[14],w[15]=C[15]-R[15],w}return Fe.perspective=E,Fe.ortho=O,Fe.mul=m,Fe.sub=D,Fe}var xt,gt={},Je={};function St(){if(xt)return Je;function u(k){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},u(k)}xt=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.create=c,Je.clone=function(k){var N=new n.ARRAY_TYPE(3);return N[0]=k[0],N[1]=k[1],N[2]=k[2],N},Je.length=m,Je.fromValues=function(k,N,W){var X=new n.ARRAY_TYPE(3);return X[0]=k,X[1]=N,X[2]=W,X},Je.copy=function(k,N){return k[0]=N[0],k[1]=N[1],k[2]=N[2],k},Je.set=function(k,N,W,X){return k[0]=N,k[1]=W,k[2]=X,k},Je.add=function(k,N,W){return k[0]=N[0]+W[0],k[1]=N[1]+W[1],k[2]=N[2]+W[2],k},Je.subtract=f,Je.multiply=g,Je.divide=E,Je.ceil=function(k,N){return k[0]=Math.ceil(N[0]),k[1]=Math.ceil(N[1]),k[2]=Math.ceil(N[2]),k},Je.floor=function(k,N){return k[0]=Math.floor(N[0]),k[1]=Math.floor(N[1]),k[2]=Math.floor(N[2]),k},Je.min=function(k,N,W){return k[0]=Math.min(N[0],W[0]),k[1]=Math.min(N[1],W[1]),k[2]=Math.min(N[2],W[2]),k},Je.max=function(k,N,W){return k[0]=Math.max(N[0],W[0]),k[1]=Math.max(N[1],W[1]),k[2]=Math.max(N[2],W[2]),k},Je.round=function(k,N){return k[0]=Math.round(N[0]),k[1]=Math.round(N[1]),k[2]=Math.round(N[2]),k},Je.scale=function(k,N,W){return k[0]=N[0]*W,k[1]=N[1]*W,k[2]=N[2]*W,k},Je.scaleAndAdd=function(k,N,W,X){return k[0]=N[0]+W[0]*X,k[1]=N[1]+W[1]*X,k[2]=N[2]+W[2]*X,k},Je.distance=O,Je.squaredDistance=D,Je.squaredLength=w,Je.negate=function(k,N){return k[0]=-N[0],k[1]=-N[1],k[2]=-N[2],k},Je.inverse=function(k,N){return k[0]=1/N[0],k[1]=1/N[1],k[2]=1/N[2],k},Je.normalize=function(k,N){var W=N[0],X=N[1],ee=N[2],ne=W*W+X*X+ee*ee;return ne>0&&(ne=1/Math.sqrt(ne)),k[0]=N[0]*ne,k[1]=N[1]*ne,k[2]=N[2]*ne,k},Je.dot=C,Je.cross=function(k,N,W){var X=N[0],ee=N[1],ne=N[2],J=W[0],he=W[1],ye=W[2];return k[0]=ee*ye-ne*he,k[1]=ne*J-X*ye,k[2]=X*he-ee*J,k},Je.lerp=function(k,N,W,X){var ee=N[0],ne=N[1],J=N[2];return k[0]=ee+X*(W[0]-ee),k[1]=ne+X*(W[1]-ne),k[2]=J+X*(W[2]-J),k},Je.hermite=function(k,N,W,X,ee,ne){var J=ne*ne,he=J*(2*ne-3)+1,ye=J*(ne-2)+ne,Me=J*(ne-1),Ve=J*(3-2*ne);return k[0]=N[0]*he+W[0]*ye+X[0]*Me+ee[0]*Ve,k[1]=N[1]*he+W[1]*ye+X[1]*Me+ee[1]*Ve,k[2]=N[2]*he+W[2]*ye+X[2]*Me+ee[2]*Ve,k},Je.bezier=function(k,N,W,X,ee,ne){var J=1-ne,he=J*J,ye=ne*ne,Me=he*J,Ve=3*ne*he,Ne=3*ye*J,$e=ye*ne;return k[0]=N[0]*Me+W[0]*Ve+X[0]*Ne+ee[0]*$e,k[1]=N[1]*Me+W[1]*Ve+X[1]*Ne+ee[1]*$e,k[2]=N[2]*Me+W[2]*Ve+X[2]*Ne+ee[2]*$e,k},Je.random=function(k,N){N=N||1;var W=2*n.RANDOM()*Math.PI,X=2*n.RANDOM()-1,ee=Math.sqrt(1-X*X)*N;return k[0]=Math.cos(W)*ee,k[1]=Math.sin(W)*ee,k[2]=X*N,k},Je.transformMat4=function(k,N,W){var X=N[0],ee=N[1],ne=N[2],J=W[3]*X+W[7]*ee+W[11]*ne+W[15];return k[0]=(W[0]*X+W[4]*ee+W[8]*ne+W[12])/(J=J||1),k[1]=(W[1]*X+W[5]*ee+W[9]*ne+W[13])/J,k[2]=(W[2]*X+W[6]*ee+W[10]*ne+W[14])/J,k},Je.transformMat3=function(k,N,W){var X=N[0],ee=N[1],ne=N[2];return k[0]=X*W[0]+ee*W[3]+ne*W[6],k[1]=X*W[1]+ee*W[4]+ne*W[7],k[2]=X*W[2]+ee*W[5]+ne*W[8],k},Je.transformQuat=function(k,N,W){var X=W[0],ee=W[1],ne=W[2],J=N[0],he=N[1],ye=N[2],Me=ee*ye-ne*he,Ve=ne*J-X*ye,Ne=X*he-ee*J,$e=ee*Ne-ne*Ve,ot=ne*Me-X*Ne,je=X*Ve-ee*Me,nt=2*W[3];return Ve*=nt,Ne*=nt,ot*=2,je*=2,k[0]=J+(Me*=nt)+($e*=2),k[1]=he+Ve+ot,k[2]=ye+Ne+je,k},Je.rotateX=function(k,N,W,X){var ee=[],ne=[];return ee[0]=N[0]-W[0],ee[1]=N[1]-W[1],ee[2]=N[2]-W[2],ne[0]=ee[0],ne[1]=ee[1]*Math.cos(X)-ee[2]*Math.sin(X),ne[2]=ee[1]*Math.sin(X)+ee[2]*Math.cos(X),k[0]=ne[0]+W[0],k[1]=ne[1]+W[1],k[2]=ne[2]+W[2],k},Je.rotateY=function(k,N,W,X){var ee=[],ne=[];return ee[0]=N[0]-W[0],ee[1]=N[1]-W[1],ee[2]=N[2]-W[2],ne[0]=ee[2]*Math.sin(X)+ee[0]*Math.cos(X),ne[1]=ee[1],ne[2]=ee[2]*Math.cos(X)-ee[0]*Math.sin(X),k[0]=ne[0]+W[0],k[1]=ne[1]+W[1],k[2]=ne[2]+W[2],k},Je.rotateZ=function(k,N,W,X){var ee=[],ne=[];return ee[0]=N[0]-W[0],ee[1]=N[1]-W[1],ee[2]=N[2]-W[2],ne[0]=ee[0]*Math.cos(X)-ee[1]*Math.sin(X),ne[1]=ee[0]*Math.sin(X)+ee[1]*Math.cos(X),ne[2]=ee[2],k[0]=ne[0]+W[0],k[1]=ne[1]+W[1],k[2]=ne[2]+W[2],k},Je.angle=function(k,N){var W=k[0],X=k[1],ee=k[2],ne=N[0],J=N[1],he=N[2],ye=Math.sqrt(W*W+X*X+ee*ee)*Math.sqrt(ne*ne+J*J+he*he),Me=ye&&C(k,N)/ye;return Math.acos(Math.min(Math.max(Me,-1),1))},Je.zero=function(k){return k[0]=0,k[1]=0,k[2]=0,k},Je.str=function(k){return"vec3("+k[0]+", "+k[1]+", "+k[2]+")"},Je.exactEquals=function(k,N){return k[0]===N[0]&&k[1]===N[1]&&k[2]===N[2]},Je.equals=function(k,N){var W=k[0],X=k[1],ee=k[2],ne=N[0],J=N[1],he=N[2];return Math.abs(W-ne)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ne))&&Math.abs(X-J)<=n.EPSILON*Math.max(1,Math.abs(X),Math.abs(J))&&Math.abs(ee-he)<=n.EPSILON*Math.max(1,Math.abs(ee),Math.abs(he))},Je.forEach=Je.sqrLen=Je.len=Je.sqrDist=Je.dist=Je.div=Je.mul=Je.sub=void 0;var n=function(k,N){if(k&&k.__esModule)return k;if(k===null||u(k)!=="object"&&typeof k!="function")return{default:k};var W=s(void 0);if(W&&W.has(k))return W.get(k);var X={},ee=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in k)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(k,ne)){var J=ee?Object.getOwnPropertyDescriptor(k,ne):null;J&&(J.get||J.set)?Object.defineProperty(X,ne,J):X[ne]=k[ne]}return X.default=k,W&&W.set(k,X),X}(K());function s(k){if(typeof WeakMap!="function")return null;var N=new WeakMap,W=new WeakMap;return(s=function(X){return X?W:N})(k)}function c(){var k=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(k[0]=0,k[1]=0,k[2]=0),k}function m(k){return Math.hypot(k[0],k[1],k[2])}function f(k,N,W){return k[0]=N[0]-W[0],k[1]=N[1]-W[1],k[2]=N[2]-W[2],k}function g(k,N,W){return k[0]=N[0]*W[0],k[1]=N[1]*W[1],k[2]=N[2]*W[2],k}function E(k,N,W){return k[0]=N[0]/W[0],k[1]=N[1]/W[1],k[2]=N[2]/W[2],k}function O(k,N){return Math.hypot(N[0]-k[0],N[1]-k[1],N[2]-k[2])}function D(k,N){var W=N[0]-k[0],X=N[1]-k[1],ee=N[2]-k[2];return W*W+X*X+ee*ee}function w(k){var N=k[0],W=k[1],X=k[2];return N*N+W*W+X*X}function C(k,N){return k[0]*N[0]+k[1]*N[1]+k[2]*N[2]}Je.sub=f,Je.mul=g,Je.div=E,Je.dist=O,Je.sqrDist=D,Je.len=m,Je.sqrLen=w;var R,P=(R=c(),function(k,N,W,X,ee,ne){var J,he;for(N||(N=3),W||(W=0),he=X?Math.min(X*N+W,k.length):k.length,J=W;J<he;J+=N)R[0]=k[J],R[1]=k[J+1],R[2]=k[J+2],ee(R,R,ne),k[J]=R[0],k[J+1]=R[1],k[J+2]=R[2];return k});return Je.forEach=P,Je}var Nt,Ht,Ct={};function Kt(){if(Nt)return Ct;function u(P){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},u(P)}Nt=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.create=c,Ct.clone=function(P){var k=new n.ARRAY_TYPE(4);return k[0]=P[0],k[1]=P[1],k[2]=P[2],k[3]=P[3],k},Ct.fromValues=function(P,k,N,W){var X=new n.ARRAY_TYPE(4);return X[0]=P,X[1]=k,X[2]=N,X[3]=W,X},Ct.copy=function(P,k){return P[0]=k[0],P[1]=k[1],P[2]=k[2],P[3]=k[3],P},Ct.set=function(P,k,N,W,X){return P[0]=k,P[1]=N,P[2]=W,P[3]=X,P},Ct.add=function(P,k,N){return P[0]=k[0]+N[0],P[1]=k[1]+N[1],P[2]=k[2]+N[2],P[3]=k[3]+N[3],P},Ct.subtract=m,Ct.multiply=f,Ct.divide=g,Ct.ceil=function(P,k){return P[0]=Math.ceil(k[0]),P[1]=Math.ceil(k[1]),P[2]=Math.ceil(k[2]),P[3]=Math.ceil(k[3]),P},Ct.floor=function(P,k){return P[0]=Math.floor(k[0]),P[1]=Math.floor(k[1]),P[2]=Math.floor(k[2]),P[3]=Math.floor(k[3]),P},Ct.min=function(P,k,N){return P[0]=Math.min(k[0],N[0]),P[1]=Math.min(k[1],N[1]),P[2]=Math.min(k[2],N[2]),P[3]=Math.min(k[3],N[3]),P},Ct.max=function(P,k,N){return P[0]=Math.max(k[0],N[0]),P[1]=Math.max(k[1],N[1]),P[2]=Math.max(k[2],N[2]),P[3]=Math.max(k[3],N[3]),P},Ct.round=function(P,k){return P[0]=Math.round(k[0]),P[1]=Math.round(k[1]),P[2]=Math.round(k[2]),P[3]=Math.round(k[3]),P},Ct.scale=function(P,k,N){return P[0]=k[0]*N,P[1]=k[1]*N,P[2]=k[2]*N,P[3]=k[3]*N,P},Ct.scaleAndAdd=function(P,k,N,W){return P[0]=k[0]+N[0]*W,P[1]=k[1]+N[1]*W,P[2]=k[2]+N[2]*W,P[3]=k[3]+N[3]*W,P},Ct.distance=E,Ct.squaredDistance=O,Ct.length=D,Ct.squaredLength=w,Ct.negate=function(P,k){return P[0]=-k[0],P[1]=-k[1],P[2]=-k[2],P[3]=-k[3],P},Ct.inverse=function(P,k){return P[0]=1/k[0],P[1]=1/k[1],P[2]=1/k[2],P[3]=1/k[3],P},Ct.normalize=function(P,k){var N=k[0],W=k[1],X=k[2],ee=k[3],ne=N*N+W*W+X*X+ee*ee;return ne>0&&(ne=1/Math.sqrt(ne)),P[0]=N*ne,P[1]=W*ne,P[2]=X*ne,P[3]=ee*ne,P},Ct.dot=function(P,k){return P[0]*k[0]+P[1]*k[1]+P[2]*k[2]+P[3]*k[3]},Ct.cross=function(P,k,N,W){var X=N[0]*W[1]-N[1]*W[0],ee=N[0]*W[2]-N[2]*W[0],ne=N[0]*W[3]-N[3]*W[0],J=N[1]*W[2]-N[2]*W[1],he=N[1]*W[3]-N[3]*W[1],ye=N[2]*W[3]-N[3]*W[2],Me=k[0],Ve=k[1],Ne=k[2],$e=k[3];return P[0]=Ve*ye-Ne*he+$e*J,P[1]=-Me*ye+Ne*ne-$e*ee,P[2]=Me*he-Ve*ne+$e*X,P[3]=-Me*J+Ve*ee-Ne*X,P},Ct.lerp=function(P,k,N,W){var X=k[0],ee=k[1],ne=k[2],J=k[3];return P[0]=X+W*(N[0]-X),P[1]=ee+W*(N[1]-ee),P[2]=ne+W*(N[2]-ne),P[3]=J+W*(N[3]-J),P},Ct.random=function(P,k){var N,W,X,ee,ne,J;k=k||1;do ne=(N=2*n.RANDOM()-1)*N+(W=2*n.RANDOM()-1)*W;while(ne>=1);do J=(X=2*n.RANDOM()-1)*X+(ee=2*n.RANDOM()-1)*ee;while(J>=1);var he=Math.sqrt((1-ne)/J);return P[0]=k*N,P[1]=k*W,P[2]=k*X*he,P[3]=k*ee*he,P},Ct.transformMat4=function(P,k,N){var W=k[0],X=k[1],ee=k[2],ne=k[3];return P[0]=N[0]*W+N[4]*X+N[8]*ee+N[12]*ne,P[1]=N[1]*W+N[5]*X+N[9]*ee+N[13]*ne,P[2]=N[2]*W+N[6]*X+N[10]*ee+N[14]*ne,P[3]=N[3]*W+N[7]*X+N[11]*ee+N[15]*ne,P},Ct.transformQuat=function(P,k,N){var W=k[0],X=k[1],ee=k[2],ne=N[0],J=N[1],he=N[2],ye=N[3],Me=ye*W+J*ee-he*X,Ve=ye*X+he*W-ne*ee,Ne=ye*ee+ne*X-J*W,$e=-ne*W-J*X-he*ee;return P[0]=Me*ye+$e*-ne+Ve*-he-Ne*-J,P[1]=Ve*ye+$e*-J+Ne*-ne-Me*-he,P[2]=Ne*ye+$e*-he+Me*-J-Ve*-ne,P[3]=k[3],P},Ct.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P[3]=0,P},Ct.str=function(P){return"vec4("+P[0]+", "+P[1]+", "+P[2]+", "+P[3]+")"},Ct.exactEquals=function(P,k){return P[0]===k[0]&&P[1]===k[1]&&P[2]===k[2]&&P[3]===k[3]},Ct.equals=function(P,k){var N=P[0],W=P[1],X=P[2],ee=P[3],ne=k[0],J=k[1],he=k[2],ye=k[3];return Math.abs(N-ne)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(ne))&&Math.abs(W-J)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(J))&&Math.abs(X-he)<=n.EPSILON*Math.max(1,Math.abs(X),Math.abs(he))&&Math.abs(ee-ye)<=n.EPSILON*Math.max(1,Math.abs(ee),Math.abs(ye))},Ct.forEach=Ct.sqrLen=Ct.len=Ct.sqrDist=Ct.dist=Ct.div=Ct.mul=Ct.sub=void 0;var n=function(P,k){if(P&&P.__esModule)return P;if(P===null||u(P)!=="object"&&typeof P!="function")return{default:P};var N=s(void 0);if(N&&N.has(P))return N.get(P);var W={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in P)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(P,ee)){var ne=X?Object.getOwnPropertyDescriptor(P,ee):null;ne&&(ne.get||ne.set)?Object.defineProperty(W,ee,ne):W[ee]=P[ee]}return W.default=P,N&&N.set(P,W),W}(K());function s(P){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(s=function(W){return W?N:k})(P)}function c(){var P=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0,P[3]=0),P}function m(P,k,N){return P[0]=k[0]-N[0],P[1]=k[1]-N[1],P[2]=k[2]-N[2],P[3]=k[3]-N[3],P}function f(P,k,N){return P[0]=k[0]*N[0],P[1]=k[1]*N[1],P[2]=k[2]*N[2],P[3]=k[3]*N[3],P}function g(P,k,N){return P[0]=k[0]/N[0],P[1]=k[1]/N[1],P[2]=k[2]/N[2],P[3]=k[3]/N[3],P}function E(P,k){return Math.hypot(k[0]-P[0],k[1]-P[1],k[2]-P[2],k[3]-P[3])}function O(P,k){var N=k[0]-P[0],W=k[1]-P[1],X=k[2]-P[2],ee=k[3]-P[3];return N*N+W*W+X*X+ee*ee}function D(P){return Math.hypot(P[0],P[1],P[2],P[3])}function w(P){var k=P[0],N=P[1],W=P[2],X=P[3];return k*k+N*N+W*W+X*X}Ct.sub=m,Ct.mul=f,Ct.div=g,Ct.dist=E,Ct.sqrDist=O,Ct.len=D,Ct.sqrLen=w;var C,R=(C=c(),function(P,k,N,W,X,ee){var ne,J;for(k||(k=4),N||(N=0),J=W?Math.min(W*k+N,P.length):P.length,ne=N;ne<J;ne+=k)C[0]=P[ne],C[1]=P[ne+1],C[2]=P[ne+2],C[3]=P[ne+3],X(C,C,ee),P[ne]=C[0],P[ne+1]=C[1],P[ne+2]=C[2],P[ne+3]=C[3];return P});return Ct.forEach=R,Ct}function Lt(){if(Ht)return gt;function u(je){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(nt){return typeof nt}:function(nt){return nt&&typeof Symbol=="function"&&nt.constructor===Symbol&&nt!==Symbol.prototype?"symbol":typeof nt},u(je)}Ht=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.create=E,gt.identity=function(je){return je[0]=0,je[1]=0,je[2]=0,je[3]=1,je},gt.setAxisAngle=O,gt.getAxisAngle=function(je,nt){var ct=2*Math.acos(nt[3]),ht=Math.sin(ct/2);return ht>n.EPSILON?(je[0]=nt[0]/ht,je[1]=nt[1]/ht,je[2]=nt[2]/ht):(je[0]=1,je[1]=0,je[2]=0),ct},gt.getAngle=function(je,nt){var ct=N(je,nt);return Math.acos(2*ct*ct-1)},gt.multiply=D,gt.rotateX=function(je,nt,ct){ct*=.5;var ht=nt[0],_t=nt[1],At=nt[2],It=nt[3],wt=Math.sin(ct),Xt=Math.cos(ct);return je[0]=ht*Xt+It*wt,je[1]=_t*Xt+At*wt,je[2]=At*Xt-_t*wt,je[3]=It*Xt-ht*wt,je},gt.rotateY=function(je,nt,ct){ct*=.5;var ht=nt[0],_t=nt[1],At=nt[2],It=nt[3],wt=Math.sin(ct),Xt=Math.cos(ct);return je[0]=ht*Xt-At*wt,je[1]=_t*Xt+It*wt,je[2]=At*Xt+ht*wt,je[3]=It*Xt-_t*wt,je},gt.rotateZ=function(je,nt,ct){ct*=.5;var ht=nt[0],_t=nt[1],At=nt[2],It=nt[3],wt=Math.sin(ct),Xt=Math.cos(ct);return je[0]=ht*Xt+_t*wt,je[1]=_t*Xt-ht*wt,je[2]=At*Xt+It*wt,je[3]=It*Xt-At*wt,je},gt.calculateW=function(je,nt){var ct=nt[0],ht=nt[1],_t=nt[2];return je[0]=ct,je[1]=ht,je[2]=_t,je[3]=Math.sqrt(Math.abs(1-ct*ct-ht*ht-_t*_t)),je},gt.exp=w,gt.ln=C,gt.pow=function(je,nt,ct){return C(je,nt),k(je,je,ct),w(je,je),je},gt.slerp=R,gt.random=function(je){var nt=n.RANDOM(),ct=n.RANDOM(),ht=n.RANDOM(),_t=Math.sqrt(1-nt),At=Math.sqrt(nt);return je[0]=_t*Math.sin(2*Math.PI*ct),je[1]=_t*Math.cos(2*Math.PI*ct),je[2]=At*Math.sin(2*Math.PI*ht),je[3]=At*Math.cos(2*Math.PI*ht),je},gt.invert=function(je,nt){var ct=nt[0],ht=nt[1],_t=nt[2],At=nt[3],It=ct*ct+ht*ht+_t*_t+At*At,wt=It?1/It:0;return je[0]=-ct*wt,je[1]=-ht*wt,je[2]=-_t*wt,je[3]=At*wt,je},gt.conjugate=function(je,nt){return je[0]=-nt[0],je[1]=-nt[1],je[2]=-nt[2],je[3]=nt[3],je},gt.fromMat3=P,gt.fromEuler=function(je,nt,ct,ht){var _t=.5*Math.PI/180;nt*=_t,ct*=_t,ht*=_t;var At=Math.sin(nt),It=Math.cos(nt),wt=Math.sin(ct),Xt=Math.cos(ct),pn=Math.sin(ht),Ut=Math.cos(ht);return je[0]=At*Xt*Ut-It*wt*pn,je[1]=It*wt*Ut+At*Xt*pn,je[2]=It*Xt*pn-At*wt*Ut,je[3]=It*Xt*Ut+At*wt*pn,je},gt.str=function(je){return"quat("+je[0]+", "+je[1]+", "+je[2]+", "+je[3]+")"},gt.setAxes=gt.sqlerp=gt.rotationTo=gt.equals=gt.exactEquals=gt.normalize=gt.sqrLen=gt.squaredLength=gt.len=gt.length=gt.lerp=gt.dot=gt.scale=gt.mul=gt.add=gt.set=gt.copy=gt.fromValues=gt.clone=void 0;var n=g(K()),s=g(ve()),c=g(St()),m=g(Kt());function f(je){if(typeof WeakMap!="function")return null;var nt=new WeakMap,ct=new WeakMap;return(f=function(ht){return ht?ct:nt})(je)}function g(je,nt){if(je&&je.__esModule)return je;if(je===null||u(je)!=="object"&&typeof je!="function")return{default:je};var ct=f(nt);if(ct&&ct.has(je))return ct.get(je);var ht={},_t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var At in je)if(At!=="default"&&Object.prototype.hasOwnProperty.call(je,At)){var It=_t?Object.getOwnPropertyDescriptor(je,At):null;It&&(It.get||It.set)?Object.defineProperty(ht,At,It):ht[At]=je[At]}return ht.default=je,ct&&ct.set(je,ht),ht}function E(){var je=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(je[0]=0,je[1]=0,je[2]=0),je[3]=1,je}function O(je,nt,ct){ct*=.5;var ht=Math.sin(ct);return je[0]=ht*nt[0],je[1]=ht*nt[1],je[2]=ht*nt[2],je[3]=Math.cos(ct),je}function D(je,nt,ct){var ht=nt[0],_t=nt[1],At=nt[2],It=nt[3],wt=ct[0],Xt=ct[1],pn=ct[2],Ut=ct[3];return je[0]=ht*Ut+It*wt+_t*pn-At*Xt,je[1]=_t*Ut+It*Xt+At*wt-ht*pn,je[2]=At*Ut+It*pn+ht*Xt-_t*wt,je[3]=It*Ut-ht*wt-_t*Xt-At*pn,je}function w(je,nt){var ct=nt[0],ht=nt[1],_t=nt[2],At=nt[3],It=Math.sqrt(ct*ct+ht*ht+_t*_t),wt=Math.exp(At),Xt=It>0?wt*Math.sin(It)/It:0;return je[0]=ct*Xt,je[1]=ht*Xt,je[2]=_t*Xt,je[3]=wt*Math.cos(It),je}function C(je,nt){var ct=nt[0],ht=nt[1],_t=nt[2],At=nt[3],It=Math.sqrt(ct*ct+ht*ht+_t*_t),wt=It>0?Math.atan2(It,At)/It:0;return je[0]=ct*wt,je[1]=ht*wt,je[2]=_t*wt,je[3]=.5*Math.log(ct*ct+ht*ht+_t*_t+At*At),je}function R(je,nt,ct,ht){var _t,At,It,wt,Xt,pn=nt[0],Ut=nt[1],Fn=nt[2],An=nt[3],xn=ct[0],cn=ct[1],ur=ct[2],zn=ct[3];return(At=pn*xn+Ut*cn+Fn*ur+An*zn)<0&&(At=-At,xn=-xn,cn=-cn,ur=-ur,zn=-zn),1-At>n.EPSILON?(_t=Math.acos(At),It=Math.sin(_t),wt=Math.sin((1-ht)*_t)/It,Xt=Math.sin(ht*_t)/It):(wt=1-ht,Xt=ht),je[0]=wt*pn+Xt*xn,je[1]=wt*Ut+Xt*cn,je[2]=wt*Fn+Xt*ur,je[3]=wt*An+Xt*zn,je}function P(je,nt){var ct,ht=nt[0]+nt[4]+nt[8];if(ht>0)ct=Math.sqrt(ht+1),je[3]=.5*ct,je[0]=(nt[5]-nt[7])*(ct=.5/ct),je[1]=(nt[6]-nt[2])*ct,je[2]=(nt[1]-nt[3])*ct;else{var _t=0;nt[4]>nt[0]&&(_t=1),nt[8]>nt[3*_t+_t]&&(_t=2);var At=(_t+1)%3,It=(_t+2)%3;ct=Math.sqrt(nt[3*_t+_t]-nt[3*At+At]-nt[3*It+It]+1),je[_t]=.5*ct,je[3]=(nt[3*At+It]-nt[3*It+At])*(ct=.5/ct),je[At]=(nt[3*At+_t]+nt[3*_t+At])*ct,je[It]=(nt[3*It+_t]+nt[3*_t+It])*ct}return je}gt.clone=m.clone,gt.fromValues=m.fromValues,gt.copy=m.copy,gt.set=m.set,gt.add=m.add,gt.mul=D;var k=m.scale;gt.scale=k;var N=m.dot;gt.dot=N,gt.lerp=m.lerp;var W=m.length;gt.length=W,gt.len=W;var X=m.squaredLength;gt.squaredLength=X,gt.sqrLen=X;var ee=m.normalize;gt.normalize=ee,gt.exactEquals=m.exactEquals,gt.equals=m.equals;var ne,J,he,ye=(ne=c.create(),J=c.fromValues(1,0,0),he=c.fromValues(0,1,0),function(je,nt,ct){var ht=c.dot(nt,ct);return ht<-.999999?(c.cross(ne,J,nt),c.len(ne)<1e-6&&c.cross(ne,he,nt),c.normalize(ne,ne),O(je,ne,Math.PI),je):ht>.999999?(je[0]=0,je[1]=0,je[2]=0,je[3]=1,je):(c.cross(ne,nt,ct),je[0]=ne[0],je[1]=ne[1],je[2]=ne[2],je[3]=1+ht,ee(je,je))});gt.rotationTo=ye;var Me,Ve,Ne=(Me=E(),Ve=E(),function(je,nt,ct,ht,_t,At){return R(Me,nt,_t,At),R(Ve,ct,ht,At),R(je,Me,Ve,2*At*(1-At)),je});gt.sqlerp=Ne;var $e,ot=($e=s.create(),function(je,nt,ct,ht){return $e[0]=ct[0],$e[3]=ct[1],$e[6]=ct[2],$e[1]=ht[0],$e[4]=ht[1],$e[7]=ht[2],$e[2]=-nt[0],$e[5]=-nt[1],$e[8]=-nt[2],ee(je,P(je,$e))});return gt.setAxes=ot,gt}var et,vt={};function Ot(){if(et)return vt;function u(R){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},u(R)}et=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.create=function(){var R=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0,R[4]=0,R[5]=0,R[6]=0,R[7]=0),R[3]=1,R},vt.clone=function(R){var P=new n.ARRAY_TYPE(8);return P[0]=R[0],P[1]=R[1],P[2]=R[2],P[3]=R[3],P[4]=R[4],P[5]=R[5],P[6]=R[6],P[7]=R[7],P},vt.fromValues=function(R,P,k,N,W,X,ee,ne){var J=new n.ARRAY_TYPE(8);return J[0]=R,J[1]=P,J[2]=k,J[3]=N,J[4]=W,J[5]=X,J[6]=ee,J[7]=ne,J},vt.fromRotationTranslationValues=function(R,P,k,N,W,X,ee){var ne=new n.ARRAY_TYPE(8);ne[0]=R,ne[1]=P,ne[2]=k,ne[3]=N;var J=.5*W,he=.5*X,ye=.5*ee;return ne[4]=J*N+he*k-ye*P,ne[5]=he*N+ye*R-J*k,ne[6]=ye*N+J*P-he*R,ne[7]=-J*R-he*P-ye*k,ne},vt.fromRotationTranslation=g,vt.fromTranslation=function(R,P){return R[0]=0,R[1]=0,R[2]=0,R[3]=1,R[4]=.5*P[0],R[5]=.5*P[1],R[6]=.5*P[2],R[7]=0,R},vt.fromRotation=function(R,P){return R[0]=P[0],R[1]=P[1],R[2]=P[2],R[3]=P[3],R[4]=0,R[5]=0,R[6]=0,R[7]=0,R},vt.fromMat4=function(R,P){var k=s.create();c.getRotation(k,P);var N=new n.ARRAY_TYPE(3);return c.getTranslation(N,P),g(R,k,N),R},vt.copy=E,vt.identity=function(R){return R[0]=0,R[1]=0,R[2]=0,R[3]=1,R[4]=0,R[5]=0,R[6]=0,R[7]=0,R},vt.set=function(R,P,k,N,W,X,ee,ne,J){return R[0]=P,R[1]=k,R[2]=N,R[3]=W,R[4]=X,R[5]=ee,R[6]=ne,R[7]=J,R},vt.getDual=function(R,P){return R[0]=P[4],R[1]=P[5],R[2]=P[6],R[3]=P[7],R},vt.setDual=function(R,P){return R[4]=P[0],R[5]=P[1],R[6]=P[2],R[7]=P[3],R},vt.getTranslation=function(R,P){var k=P[4],N=P[5],W=P[6],X=P[7],ee=-P[0],ne=-P[1],J=-P[2],he=P[3];return R[0]=2*(k*he+X*ee+N*J-W*ne),R[1]=2*(N*he+X*ne+W*ee-k*J),R[2]=2*(W*he+X*J+k*ne-N*ee),R},vt.translate=function(R,P,k){var N=P[0],W=P[1],X=P[2],ee=P[3],ne=.5*k[0],J=.5*k[1],he=.5*k[2],ye=P[4],Me=P[5],Ve=P[6],Ne=P[7];return R[0]=N,R[1]=W,R[2]=X,R[3]=ee,R[4]=ee*ne+W*he-X*J+ye,R[5]=ee*J+X*ne-N*he+Me,R[6]=ee*he+N*J-W*ne+Ve,R[7]=-N*ne-W*J-X*he+Ne,R},vt.rotateX=function(R,P,k){var N=-P[0],W=-P[1],X=-P[2],ee=P[3],ne=P[4],J=P[5],he=P[6],ye=P[7],Me=ne*ee+ye*N+J*X-he*W,Ve=J*ee+ye*W+he*N-ne*X,Ne=he*ee+ye*X+ne*W-J*N,$e=ye*ee-ne*N-J*W-he*X;return s.rotateX(R,P,k),R[4]=Me*(ee=R[3])+$e*(N=R[0])+Ve*(X=R[2])-Ne*(W=R[1]),R[5]=Ve*ee+$e*W+Ne*N-Me*X,R[6]=Ne*ee+$e*X+Me*W-Ve*N,R[7]=$e*ee-Me*N-Ve*W-Ne*X,R},vt.rotateY=function(R,P,k){var N=-P[0],W=-P[1],X=-P[2],ee=P[3],ne=P[4],J=P[5],he=P[6],ye=P[7],Me=ne*ee+ye*N+J*X-he*W,Ve=J*ee+ye*W+he*N-ne*X,Ne=he*ee+ye*X+ne*W-J*N,$e=ye*ee-ne*N-J*W-he*X;return s.rotateY(R,P,k),R[4]=Me*(ee=R[3])+$e*(N=R[0])+Ve*(X=R[2])-Ne*(W=R[1]),R[5]=Ve*ee+$e*W+Ne*N-Me*X,R[6]=Ne*ee+$e*X+Me*W-Ve*N,R[7]=$e*ee-Me*N-Ve*W-Ne*X,R},vt.rotateZ=function(R,P,k){var N=-P[0],W=-P[1],X=-P[2],ee=P[3],ne=P[4],J=P[5],he=P[6],ye=P[7],Me=ne*ee+ye*N+J*X-he*W,Ve=J*ee+ye*W+he*N-ne*X,Ne=he*ee+ye*X+ne*W-J*N,$e=ye*ee-ne*N-J*W-he*X;return s.rotateZ(R,P,k),R[4]=Me*(ee=R[3])+$e*(N=R[0])+Ve*(X=R[2])-Ne*(W=R[1]),R[5]=Ve*ee+$e*W+Ne*N-Me*X,R[6]=Ne*ee+$e*X+Me*W-Ve*N,R[7]=$e*ee-Me*N-Ve*W-Ne*X,R},vt.rotateByQuatAppend=function(R,P,k){var N=k[0],W=k[1],X=k[2],ee=k[3],ne=P[0],J=P[1],he=P[2],ye=P[3];return R[0]=ne*ee+ye*N+J*X-he*W,R[1]=J*ee+ye*W+he*N-ne*X,R[2]=he*ee+ye*X+ne*W-J*N,R[3]=ye*ee-ne*N-J*W-he*X,R[4]=(ne=P[4])*ee+(ye=P[7])*N+(J=P[5])*X-(he=P[6])*W,R[5]=J*ee+ye*W+he*N-ne*X,R[6]=he*ee+ye*X+ne*W-J*N,R[7]=ye*ee-ne*N-J*W-he*X,R},vt.rotateByQuatPrepend=function(R,P,k){var N=P[0],W=P[1],X=P[2],ee=P[3],ne=k[0],J=k[1],he=k[2],ye=k[3];return R[0]=N*ye+ee*ne+W*he-X*J,R[1]=W*ye+ee*J+X*ne-N*he,R[2]=X*ye+ee*he+N*J-W*ne,R[3]=ee*ye-N*ne-W*J-X*he,R[4]=N*(ye=k[7])+ee*(ne=k[4])+W*(he=k[6])-X*(J=k[5]),R[5]=W*ye+ee*J+X*ne-N*he,R[6]=X*ye+ee*he+N*J-W*ne,R[7]=ee*ye-N*ne-W*J-X*he,R},vt.rotateAroundAxis=function(R,P,k,N){if(Math.abs(N)<n.EPSILON)return E(R,P);var W=Math.hypot(k[0],k[1],k[2]);N*=.5;var X=Math.sin(N),ee=X*k[0]/W,ne=X*k[1]/W,J=X*k[2]/W,he=Math.cos(N),ye=P[0],Me=P[1],Ve=P[2],Ne=P[3];R[0]=ye*he+Ne*ee+Me*J-Ve*ne,R[1]=Me*he+Ne*ne+Ve*ee-ye*J,R[2]=Ve*he+Ne*J+ye*ne-Me*ee,R[3]=Ne*he-ye*ee-Me*ne-Ve*J;var $e=P[4],ot=P[5],je=P[6],nt=P[7];return R[4]=$e*he+nt*ee+ot*J-je*ne,R[5]=ot*he+nt*ne+je*ee-$e*J,R[6]=je*he+nt*J+$e*ne-ot*ee,R[7]=nt*he-$e*ee-ot*ne-je*J,R},vt.add=function(R,P,k){return R[0]=P[0]+k[0],R[1]=P[1]+k[1],R[2]=P[2]+k[2],R[3]=P[3]+k[3],R[4]=P[4]+k[4],R[5]=P[5]+k[5],R[6]=P[6]+k[6],R[7]=P[7]+k[7],R},vt.multiply=O,vt.scale=function(R,P,k){return R[0]=P[0]*k,R[1]=P[1]*k,R[2]=P[2]*k,R[3]=P[3]*k,R[4]=P[4]*k,R[5]=P[5]*k,R[6]=P[6]*k,R[7]=P[7]*k,R},vt.lerp=function(R,P,k,N){var W=1-N;return D(P,k)<0&&(N=-N),R[0]=P[0]*W+k[0]*N,R[1]=P[1]*W+k[1]*N,R[2]=P[2]*W+k[2]*N,R[3]=P[3]*W+k[3]*N,R[4]=P[4]*W+k[4]*N,R[5]=P[5]*W+k[5]*N,R[6]=P[6]*W+k[6]*N,R[7]=P[7]*W+k[7]*N,R},vt.invert=function(R,P){var k=C(P);return R[0]=-P[0]/k,R[1]=-P[1]/k,R[2]=-P[2]/k,R[3]=P[3]/k,R[4]=-P[4]/k,R[5]=-P[5]/k,R[6]=-P[6]/k,R[7]=P[7]/k,R},vt.conjugate=function(R,P){return R[0]=-P[0],R[1]=-P[1],R[2]=-P[2],R[3]=P[3],R[4]=-P[4],R[5]=-P[5],R[6]=-P[6],R[7]=P[7],R},vt.normalize=function(R,P){var k=C(P);if(k>0){k=Math.sqrt(k);var N=P[0]/k,W=P[1]/k,X=P[2]/k,ee=P[3]/k,ne=P[4],J=P[5],he=P[6],ye=P[7],Me=N*ne+W*J+X*he+ee*ye;R[0]=N,R[1]=W,R[2]=X,R[3]=ee,R[4]=(ne-N*Me)/k,R[5]=(J-W*Me)/k,R[6]=(he-X*Me)/k,R[7]=(ye-ee*Me)/k}return R},vt.str=function(R){return"quat2("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+", "+R[4]+", "+R[5]+", "+R[6]+", "+R[7]+")"},vt.exactEquals=function(R,P){return R[0]===P[0]&&R[1]===P[1]&&R[2]===P[2]&&R[3]===P[3]&&R[4]===P[4]&&R[5]===P[5]&&R[6]===P[6]&&R[7]===P[7]},vt.equals=function(R,P){var k=R[0],N=R[1],W=R[2],X=R[3],ee=R[4],ne=R[5],J=R[6],he=R[7],ye=P[0],Me=P[1],Ve=P[2],Ne=P[3],$e=P[4],ot=P[5],je=P[6],nt=P[7];return Math.abs(k-ye)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(ye))&&Math.abs(N-Me)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(Me))&&Math.abs(W-Ve)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ve))&&Math.abs(X-Ne)<=n.EPSILON*Math.max(1,Math.abs(X),Math.abs(Ne))&&Math.abs(ee-$e)<=n.EPSILON*Math.max(1,Math.abs(ee),Math.abs($e))&&Math.abs(ne-ot)<=n.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ot))&&Math.abs(J-je)<=n.EPSILON*Math.max(1,Math.abs(J),Math.abs(je))&&Math.abs(he-nt)<=n.EPSILON*Math.max(1,Math.abs(he),Math.abs(nt))},vt.sqrLen=vt.squaredLength=vt.len=vt.length=vt.dot=vt.mul=vt.setReal=vt.getReal=void 0;var n=f(K()),s=f(Lt()),c=f(lt());function m(R){if(typeof WeakMap!="function")return null;var P=new WeakMap,k=new WeakMap;return(m=function(N){return N?k:P})(R)}function f(R,P){if(R&&R.__esModule)return R;if(R===null||u(R)!=="object"&&typeof R!="function")return{default:R};var k=m(P);if(k&&k.has(R))return k.get(R);var N={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in R)if(X!=="default"&&Object.prototype.hasOwnProperty.call(R,X)){var ee=W?Object.getOwnPropertyDescriptor(R,X):null;ee&&(ee.get||ee.set)?Object.defineProperty(N,X,ee):N[X]=R[X]}return N.default=R,k&&k.set(R,N),N}function g(R,P,k){var N=.5*k[0],W=.5*k[1],X=.5*k[2],ee=P[0],ne=P[1],J=P[2],he=P[3];return R[0]=ee,R[1]=ne,R[2]=J,R[3]=he,R[4]=N*he+W*J-X*ne,R[5]=W*he+X*ee-N*J,R[6]=X*he+N*ne-W*ee,R[7]=-N*ee-W*ne-X*J,R}function E(R,P){return R[0]=P[0],R[1]=P[1],R[2]=P[2],R[3]=P[3],R[4]=P[4],R[5]=P[5],R[6]=P[6],R[7]=P[7],R}function O(R,P,k){var N=P[0],W=P[1],X=P[2],ee=P[3],ne=k[4],J=k[5],he=k[6],ye=k[7],Me=P[4],Ve=P[5],Ne=P[6],$e=P[7],ot=k[0],je=k[1],nt=k[2],ct=k[3];return R[0]=N*ct+ee*ot+W*nt-X*je,R[1]=W*ct+ee*je+X*ot-N*nt,R[2]=X*ct+ee*nt+N*je-W*ot,R[3]=ee*ct-N*ot-W*je-X*nt,R[4]=N*ye+ee*ne+W*he-X*J+Me*ct+$e*ot+Ve*nt-Ne*je,R[5]=W*ye+ee*J+X*ne-N*he+Ve*ct+$e*je+Ne*ot-Me*nt,R[6]=X*ye+ee*he+N*J-W*ne+Ne*ct+$e*nt+Me*je-Ve*ot,R[7]=ee*ye-N*ne-W*J-X*he+$e*ct-Me*ot-Ve*je-Ne*nt,R}vt.getReal=s.copy,vt.setReal=s.copy,vt.mul=O;var D=s.dot;vt.dot=D;var w=s.length;vt.length=w,vt.len=w;var C=s.squaredLength;return vt.squaredLength=C,vt.sqrLen=C,vt}var mt,zt,Jt={};function Un(){if(mt)return Jt;function u(P){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},u(P)}mt=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.create=c,Jt.clone=function(P){var k=new n.ARRAY_TYPE(2);return k[0]=P[0],k[1]=P[1],k},Jt.fromValues=function(P,k){var N=new n.ARRAY_TYPE(2);return N[0]=P,N[1]=k,N},Jt.copy=function(P,k){return P[0]=k[0],P[1]=k[1],P},Jt.set=function(P,k,N){return P[0]=k,P[1]=N,P},Jt.add=function(P,k,N){return P[0]=k[0]+N[0],P[1]=k[1]+N[1],P},Jt.subtract=m,Jt.multiply=f,Jt.divide=g,Jt.ceil=function(P,k){return P[0]=Math.ceil(k[0]),P[1]=Math.ceil(k[1]),P},Jt.floor=function(P,k){return P[0]=Math.floor(k[0]),P[1]=Math.floor(k[1]),P},Jt.min=function(P,k,N){return P[0]=Math.min(k[0],N[0]),P[1]=Math.min(k[1],N[1]),P},Jt.max=function(P,k,N){return P[0]=Math.max(k[0],N[0]),P[1]=Math.max(k[1],N[1]),P},Jt.round=function(P,k){return P[0]=Math.round(k[0]),P[1]=Math.round(k[1]),P},Jt.scale=function(P,k,N){return P[0]=k[0]*N,P[1]=k[1]*N,P},Jt.scaleAndAdd=function(P,k,N,W){return P[0]=k[0]+N[0]*W,P[1]=k[1]+N[1]*W,P},Jt.distance=E,Jt.squaredDistance=O,Jt.length=D,Jt.squaredLength=w,Jt.negate=function(P,k){return P[0]=-k[0],P[1]=-k[1],P},Jt.inverse=function(P,k){return P[0]=1/k[0],P[1]=1/k[1],P},Jt.normalize=function(P,k){var N=k[0],W=k[1],X=N*N+W*W;return X>0&&(X=1/Math.sqrt(X)),P[0]=k[0]*X,P[1]=k[1]*X,P},Jt.dot=function(P,k){return P[0]*k[0]+P[1]*k[1]},Jt.cross=function(P,k,N){var W=k[0]*N[1]-k[1]*N[0];return P[0]=P[1]=0,P[2]=W,P},Jt.lerp=function(P,k,N,W){var X=k[0],ee=k[1];return P[0]=X+W*(N[0]-X),P[1]=ee+W*(N[1]-ee),P},Jt.random=function(P,k){k=k||1;var N=2*n.RANDOM()*Math.PI;return P[0]=Math.cos(N)*k,P[1]=Math.sin(N)*k,P},Jt.transformMat2=function(P,k,N){var W=k[0],X=k[1];return P[0]=N[0]*W+N[2]*X,P[1]=N[1]*W+N[3]*X,P},Jt.transformMat2d=function(P,k,N){var W=k[0],X=k[1];return P[0]=N[0]*W+N[2]*X+N[4],P[1]=N[1]*W+N[3]*X+N[5],P},Jt.transformMat3=function(P,k,N){var W=k[0],X=k[1];return P[0]=N[0]*W+N[3]*X+N[6],P[1]=N[1]*W+N[4]*X+N[7],P},Jt.transformMat4=function(P,k,N){var W=k[0],X=k[1];return P[0]=N[0]*W+N[4]*X+N[12],P[1]=N[1]*W+N[5]*X+N[13],P},Jt.rotate=function(P,k,N,W){var X=k[0]-N[0],ee=k[1]-N[1],ne=Math.sin(W),J=Math.cos(W);return P[0]=X*J-ee*ne+N[0],P[1]=X*ne+ee*J+N[1],P},Jt.angle=function(P,k){var N=P[0],W=P[1],X=k[0],ee=k[1],ne=Math.sqrt(N*N+W*W)*Math.sqrt(X*X+ee*ee);return Math.acos(Math.min(Math.max(ne&&(N*X+W*ee)/ne,-1),1))},Jt.zero=function(P){return P[0]=0,P[1]=0,P},Jt.str=function(P){return"vec2("+P[0]+", "+P[1]+")"},Jt.exactEquals=function(P,k){return P[0]===k[0]&&P[1]===k[1]},Jt.equals=function(P,k){var N=P[0],W=P[1],X=k[0],ee=k[1];return Math.abs(N-X)<=n.EPSILON*Math.max(1,Math.abs(N),Math.abs(X))&&Math.abs(W-ee)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ee))},Jt.forEach=Jt.sqrLen=Jt.sqrDist=Jt.dist=Jt.div=Jt.mul=Jt.sub=Jt.len=void 0;var n=function(P,k){if(P&&P.__esModule)return P;if(P===null||u(P)!=="object"&&typeof P!="function")return{default:P};var N=s(void 0);if(N&&N.has(P))return N.get(P);var W={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in P)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(P,ee)){var ne=X?Object.getOwnPropertyDescriptor(P,ee):null;ne&&(ne.get||ne.set)?Object.defineProperty(W,ee,ne):W[ee]=P[ee]}return W.default=P,N&&N.set(P,W),W}(K());function s(P){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(s=function(W){return W?N:k})(P)}function c(){var P=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0),P}function m(P,k,N){return P[0]=k[0]-N[0],P[1]=k[1]-N[1],P}function f(P,k,N){return P[0]=k[0]*N[0],P[1]=k[1]*N[1],P}function g(P,k,N){return P[0]=k[0]/N[0],P[1]=k[1]/N[1],P}function E(P,k){return Math.hypot(k[0]-P[0],k[1]-P[1])}function O(P,k){var N=k[0]-P[0],W=k[1]-P[1];return N*N+W*W}function D(P){return Math.hypot(P[0],P[1])}function w(P){var k=P[0],N=P[1];return k*k+N*N}Jt.len=D,Jt.sub=m,Jt.mul=f,Jt.div=g,Jt.dist=E,Jt.sqrDist=O,Jt.sqrLen=w;var C,R=(C=c(),function(P,k,N,W,X,ee){var ne,J;for(k||(k=2),N||(N=0),J=W?Math.min(W*k+N,P.length):P.length,ne=N;ne<J;ne+=k)C[0]=P[ne],C[1]=P[ne+1],X(C,C,ee),P[ne]=C[0],P[ne+1]=C[1];return P});return Jt.forEach=R,Jt}function $n(){if(zt)return $;function u(P){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},u(P)}zt=1,Object.defineProperty($,"__esModule",{value:!0}),$.vec4=$.vec3=$.vec2=$.quat2=$.quat=$.mat4=$.mat3=$.mat2d=$.mat2=$.glMatrix=void 0;var n=R(K());$.glMatrix=n;var s=R(se());$.mat2=s;var c=R(Ce());$.mat2d=c;var m=R(ve());$.mat3=m;var f=R(lt());$.mat4=f;var g=R(Lt());$.quat=g;var E=R(Ot());$.quat2=E;var O=R(Un());$.vec2=O;var D=R(St());$.vec3=D;var w=R(Kt());function C(P){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(C=function(W){return W?N:k})(P)}function R(P,k){if(P&&P.__esModule)return P;if(P===null||u(P)!=="object"&&typeof P!="function")return{default:P};var N=C(k);if(N&&N.has(P))return N.get(P);var W={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in P)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(P,ee)){var ne=X?Object.getOwnPropertyDescriptor(P,ee):null;ne&&(ne.get||ne.set)?Object.defineProperty(W,ee,ne):W[ee]=P[ee]}return W.default=P,N&&N.set(P,W),W}return $.vec4=w,$}var Bn,$r,_r,Pn,Ke=$n(),mr=function(){if($r)return Bn;function u(n,s,c,m){this.cx=3*n,this.bx=3*(c-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(m-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=c,this.p2y=m}return $r=1,Bn=u,u.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var c=n,m=0;m<8;m++){var f=this.sampleCurveX(c)-n;if(Math.abs(f)<s)return c;var g=this.sampleCurveDerivativeX(c);if(Math.abs(g)<1e-6)break;c-=f/g}var E=0,O=1;for(c=n,m=0;m<20&&(f=this.sampleCurveX(c),!(Math.abs(f-n)<s));m++)n>f?E=c:O=c,c=.5*(O-E)+E;return c},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},Bn}(),Sn=I(mr);function Dr(){if(Pn)return _r;function u(n,s){this.x=n,this.y=s}return Pn=1,_r=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,c=n.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),c=Math.sin(n),m=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=m,this},_rotateAround:function(n,s){var c=Math.cos(n),m=Math.sin(n),f=s.y+m*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-m*(this.y-s.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(n){return n instanceof u?n:Array.isArray(n)?new u(n[0],n[1]):n},_r}var Yt=I(Dr());function Mr(u,n){if(Array.isArray(u)){if(!Array.isArray(n)||u.length!==n.length)return!1;for(let s=0;s<u.length;s++)if(!Mr(u[s],n[s]))return!1;return!0}if(typeof u=="object"&&u!==null&&n!==null){if(typeof n!="object"||Object.keys(u).length!==Object.keys(n).length)return!1;for(const s in u)if(!Mr(u[s],n[s]))return!1;return!0}return u===n}const Qn=Math.PI/180,Ar=180/Math.PI;function sr(u){return u*Qn}function _i(u){return u*Ar}const Wi=[[0,0],[1,0],[1,1],[0,1]];function ii(u){if(u<=0)return 0;if(u>=1)return 1;const n=u*u,s=n*u;return 4*(u<.5?s:3*(u-n)+s-.75)}function Pi(u,n,s,c){const m=new Sn(u,n,s,c);return function(f){return m.solve(f)}}const yi=Pi(.25,.1,.25,1);function lr(u,n,s){return Math.min(s,Math.max(n,u))}function qo(u,n,s){return(s=lr((s-u)/(n-u),0,1))*s*(3-2*s)}function ea(u,n,s){const c=s-n,m=((u-n)%c+c)%c+n;return m===n?s:m}function la(u,n,s){if(!u.length)return s(null,[]);let c=u.length;const m=new Array(u.length);let f=null;u.forEach((g,E)=>{n(g,(O,D)=>{O&&(f=O),m[E]=D,--c==0&&s(f,m)})})}function Fi(u,...n){for(const s of n)for(const c in s)u[c]=s[c];return u}let Mo=1;function ta(){return Mo++}function va(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function za(u,n){u.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function so(u,n){return u.indexOf(n,u.length-n.length)!==-1}function Lo(u,n,s){const c={};for(const m in u)c[m]=n.call(this,u[m],m,u);return c}function es(u,n,s){const c={};for(const m in u)n.call(this,u[m],m,u)&&(c[m]=u[m]);return c}function Go(u){return Array.isArray(u)?u.map(Go):typeof u=="object"&&u?Lo(u,Go):u}const Fa={};function Er(u){Fa[u]||(typeof console<"u"&&console.warn(u),Fa[u]=!0)}function go(u,n,s){return(s.y-u.y)*(n.x-u.x)>(n.y-u.y)*(s.x-u.x)}function Ia(u){let n=0;for(let s,c,m=0,f=u.length,g=f-1;m<f;g=m++)s=u[m],c=u[g],n+=(c.x-s.x)*(s.y+c.y);return n}function Di([u,n,s]){const c=sr(n+90),m=sr(s);return{x:u*Math.cos(c)*Math.sin(m),y:u*Math.sin(c)*Math.sin(m),z:u*Math.cos(m),azimuthal:n,polar:s}}function vi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function bi(u){const n={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,m,f)=>{const g=m||f;return n[c]=!g||g.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let Mi=null;function Fo(u,n){return[u[4*n],u[4*n+1],u[4*n+2],u[4*n+3]]}function na(u,n,s,c){for(;n<s;){const m=n+s>>1;u[m]<c?n=m+1:s=m}return n}function kt(u,n,s,c){for(;n<s;){const m=n+s>>1;u[m]<=c?n=m+1:s=m}return n}function Se(u){return u>0?1/(1.001-u):1+u}function Z(u){return u>0?1-1/(1.001-u):-u}const re={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!re.API_URL)return null;try{const u=new URL(re.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ce(u){return re.API_URL_REGEX.test(u)}function de(u){return re.API_SPRITE_REGEX.test(u)}let xe,Ie,Ae,Be,tt,ut;function Tt(){return xe==null&&(xe=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),xe}const Wt={now:()=>Be!==void 0?Be:performance.now(),setNow(u){Be=u},restoreNow(){Be=void 0},frame(u){const n=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(u,n=0){const{width:s,height:c}=u;tt||(tt=document.createElement("canvas"));const m=tt.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(s>tt.width||c>tt.height)&&(tt.width=s,tt.height=c),m.clearRect(-n,-n,s+2*n,c+2*n),m.drawImage(u,0,0,s,c),m.getImageData(-n,-n,s+2*n,c+2*n)},resolveURL:u=>(Ie||(Ie=document.createElement("a")),Ie.href=u,Ie.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ae==null&&(Ae=window.matchMedia("(prefers-reduced-motion: reduce)")),Ae.matches)},hasCanvasFingerprintNoise(){if(ut!==void 0)return ut;if(!Tt())return ut=!1,!1;const u=new OffscreenCanvas(85,1),n=u.getContext("2d",{willReadFrequently:!0});let s=0;for(let m=0;m<u.width;++m)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(m,0,1,1);const c=n.getImageData(0,0,u.width,u.height);s=0;for(let m=0;m<c.data.length;++m)if(m%4!=3&&s++!==c.data[m])return ut=!0,!0;return ut=!1,!1}};function Vt(u,n){const s=u.indexOf("?");if(s<0)return`${u}?${new URLSearchParams(n).toString()}`;const c=new URLSearchParams(u.slice(s));for(const m in n)c.set(m,n[m]);return`${u.slice(0,s)}?${c.toString()}`}function Gt(u,n={persistentParams:[]}){const s=u.indexOf("?");if(s<0)return u;const c=new URLSearchParams,m=new URLSearchParams(u.slice(s));for(const g of n.persistentParams){const E=m.get(g);E&&c.set(g,E)}const f=c.toString();return`${u.slice(0,s)}${f.length>0?`?${f}`:""}`}const gn="mapbox-tiles";let Tn=500,In=50;const Ln=["language","worldview","jobid"];let dr,Zn;function Zr(){try{return caches}catch{}}function ri(){const u=Zr();u&&dr==null&&(dr=u.open(gn))}let nr=1/0;const hn={supported:!1,testSupport:function(u){!oi&&br&&(Ir?qr(u):Kn=u)}};let Kn,br,oi=!1,Ir=!1;const Kr=typeof self<"u"?self:{};function qr(u){const n=u.createTexture();u.bindTexture(u.TEXTURE_2D,n);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,br),u.isContextLost())return;hn.supported=!0}catch{}u.deleteTexture(n),oi=!0}Kr.document&&(br=Kr.document.createElement("img"),br.onload=function(){Kn&&qr(Kn),Kn=null,Ir=!0},br.onerror=function(){oi=!0,Kn=null},br.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ci={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(ci);class Zi extends Error{constructor(n,s,c){s===401&&ce(c)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Xn=vi()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Gr=function(u,n){if(!(/^file:/.test(s=u.url)||/^file:/.test(Xn())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,m){const f=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Xn(),referrerPolicy:c.referrerPolicy,signal:f.signal});let E=!1,O=!1;const D=(w=g.url).indexOf("sku=")>0&&ce(w);var w;c.type==="json"&&g.headers.set("Accept","application/json");const C=(P,k,N)=>{if(O)return;if(P&&P.message!=="SecurityError"&&Er(P.toString()),k&&N)return R(k);const W=Date.now();fetch(g).then(X=>{if(X.ok){const ee=D?X.clone():null;return R(X,ee,W)}return m(new Zi(X.statusText,X.status,c.url))}).catch(X=>{X.name!=="AbortError"&&m(new Error(`${X.message} ${c.url}`))})},R=(P,k,N)=>{(c.type==="arrayBuffer"?P.arrayBuffer():c.type==="json"?P.json():P.text()).then(W=>{O||(k&&N&&function(X,ee,ne){if(ri(),dr==null)return;const J=bi(ee.headers.get("Cache-Control")||"");if(J["no-store"])return;const he={status:ee.status,statusText:ee.statusText,headers:new Headers};ee.headers.forEach((Ve,Ne)=>he.headers.set(Ne,Ve)),J["max-age"]&&he.headers.set("Expires",new Date(ne+1e3*J["max-age"]).toUTCString());const ye=he.headers.get("Expires");if(!ye||new Date(ye).getTime()-ne<42e4)return;let Me=Gt(X.url,{persistentParams:Ln});if(ee.status===206){const Ve=X.headers.get("Range");if(!Ve)return;he.status=200,Me=Vt(Me,{range:Ve})}(function(Ve,Ne){if(Zn===void 0)try{new Response(new ReadableStream),Zn=!0}catch{Zn=!1}Zn?Ne(Ve.body):Ve.blob().then(Ne)})(ee,Ve=>{const Ne=new Response(($e=ee.status)!==200&&$e!==404&&[101,103,204,205,304].includes($e)?null:Ve,he);var $e;ri(),dr!=null&&dr.then(ot=>ot.put(Me,Ne)).catch(ot=>Er(ot.message))})}(g,k,N),E=!0,m(null,W,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(W=>{O||m(new Error(W.message))})};return D?function(P,k){if(ri(),dr==null)return k(null);dr.then(N=>{let W=Gt(P.url,{persistentParams:Ln});const X=P.headers.get("Range");X&&(W=Vt(W,{range:X})),N.match(W).then(ee=>{const ne=function(J){if(!J)return!1;const he=new Date(J.headers.get("Expires")||0),ye=bi(J.headers.get("Cache-Control")||"");return he>Date.now()&&!ye["no-cache"]}(ee);N.delete(W),ne&&N.put(W,ee.clone()),k(null,ee,ne)}).catch(k)}).catch(k)}(g,C):C(null,null),{cancel:()=>{O=!0,E||f.abort()}}}(u,n);if(vi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,n,void 0,!0)}var s;return function(c,m){const f=new XMLHttpRequest;f.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const g in c.headers)f.setRequestHeader(g,c.headers[g]);return c.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=c.credentials==="include",f.onerror=()=>{m(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let g=f.response;if(c.type==="json")try{g=JSON.parse(f.response)}catch(E){return m(E)}m(null,g,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else m(new Zi(f.statusText,f.status,c.url))},f.send(c.body),{cancel:()=>f.abort()}}(u,n)},xa=function(u,n){return Gr(Fi(u,{type:"arrayBuffer"}),n)};function lo(u){const n=document.createElement("a");return n.href=u,n.protocol===location.protocol&&n.host===location.host}const uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let wo,yr;wo=[],yr=0;const wi=function(u,n){if(hn.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),yr>=re.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:u,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return wo.push(f),f}yr++;let s=!1;const c=()=>{if(!s)for(s=!0,yr--;wo.length&&yr<re.MAX_PARALLEL_IMAGE_REQUESTS;){const f=wo.shift(),{requestParameters:g,callback:E,cancelled:O}=f;O||(f.cancel=wi(g,E).cancel)}},m=xa(u,(f,g,E,O)=>{c(),f?n(f):g&&(self.createImageBitmap?function(D,w){const C=new Blob([new Uint8Array(D)],{type:"image/png"});createImageBitmap(C).then(R=>{w(null,R)}).catch(R=>{w(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(D,w)=>n(D,w,E,O)):function(D,w){const C=new Image;C.onload=()=>{w(null,C),URL.revokeObjectURL(C.src),C.onload=null,requestAnimationFrame(()=>{C.src=uo})},C.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const R=new Blob([new Uint8Array(D)],{type:"image/png"});C.src=D.byteLength?URL.createObjectURL(R):uo}(g,(D,w)=>n(D,w,E,O)))});return{cancel:()=>{m.cancel(),c()}}};var fe,Oe,We,dt={exports:{}},nn={exports:{}},Zt={exports:{}},fn=function(){if(We)return dt.exports;We=1;var u=(fe||(fe=1,nn.exports=function(s,c){var m,f,g,E,O,D,w,C;for(f=s.length-(m=3&s.length),g=c,O=3432918353,D=461845907,C=0;C<f;)w=255&s.charCodeAt(C)|(255&s.charCodeAt(++C))<<8|(255&s.charCodeAt(++C))<<16|(255&s.charCodeAt(++C))<<24,++C,g=27492+(65535&(E=5*(65535&(g=(g^=w=(65535&(w=(w=(65535&w)*O+(((w>>>16)*O&65535)<<16)&4294967295)<<15|w>>>17))*D+(((w>>>16)*D&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(w=0,m){case 3:w^=(255&s.charCodeAt(C+2))<<16;case 2:w^=(255&s.charCodeAt(C+1))<<8;case 1:g^=w=(65535&(w=(w=(65535&(w^=255&s.charCodeAt(C)))*O+(((w>>>16)*O&65535)<<16)&4294967295)<<15|w>>>17))*D+(((w>>>16)*D&65535)<<16)&4294967295}return g^=s.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),nn.exports),n=(Oe||(Oe=1,Zt.exports=function(s,c){for(var m,f=s.length,g=c^f,E=0;f>=4;)m=1540483477*(65535&(m=255&s.charCodeAt(E)|(255&s.charCodeAt(++E))<<8|(255&s.charCodeAt(++E))<<16|(255&s.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),f-=4,++E;switch(f){case 3:g^=(255&s.charCodeAt(E+2))<<16;case 2:g^=(255&s.charCodeAt(E+1))<<8;case 1:g=1540483477*(65535&(g^=255&s.charCodeAt(E)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),Zt.exports);return dt.exports=u,dt.exports.murmur3=u,dt.exports.murmur2=n,dt.exports}(),Cn=I(fn);class Gn{constructor(n,...s){Fi(this,s[0]||{}),this.type=n}}class Cr extends Gn{constructor(n,s={}){super("error",Fi({error:n},s))}}function Ur(u,n,s){s[u]&&s[u].indexOf(n)!==-1||(s[u]=s[u]||[],s[u].push(n))}function Ri(u,n,s){if(s&&s[u]){const c=s[u].indexOf(n);c!==-1&&s[u].splice(c,1)}}class So{on(n,s){return this._listeners=this._listeners||{},Ur(n,s,this._listeners),this}off(n,s){return Ri(n,s,this._listeners),Ri(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Ur(n,s,this._oneTimeListeners),this):new Promise(c=>this.once(n,c))}fire(n,s){const c=typeof n=="string"?new Gn(n,s):n,m=c.type;if(this.listens(m)){c.target=this;const f=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const O of f)O.call(this,c);const g=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const O of g)Ri(m,O,this._oneTimeListeners),O.call(this,c);const E=this._eventedParent;E&&(Fi(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(c))}else c instanceof Cr&&console.error(c.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var To,wr={},Ba=function(){if(To)return wr;To=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(f){return(f=Math.round(f))<0?0:f>255?255:f}function s(f){return n(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function c(f){return(g=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:g>1?1:g;var g}function m(f,g,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?f+(g-f)*E*6:2*E<1?g:3*E<2?f+(g-f)*(2/3-E)*6:f}try{wr.parseCSSColor=function(f){var g,E=f.replace(/ /g,"").toLowerCase();if(E in u)return u[E].slice();if(E[0]==="#")return E.length===4?(g=parseInt(E.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:E.length===7&&(g=parseInt(E.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var O=E.indexOf("("),D=E.indexOf(")");if(O!==-1&&D+1===E.length){var w=E.substr(0,O),C=E.substr(O+1,D-(O+1)).split(","),R=1;switch(w){case"rgba":if(C.length!==4)return null;R=c(C.pop());case"rgb":return C.length!==3?null:[s(C[0]),s(C[1]),s(C[2]),R];case"hsla":if(C.length!==4)return null;R=c(C.pop());case"hsl":if(C.length!==3)return null;var P=(parseFloat(C[0])%360+360)%360/360,k=c(C[1]),N=c(C[2]),W=N<=.5?N*(k+1):N+k-N*k,X=2*N-W;return[n(255*m(X,W,P+1/3)),n(255*m(X,W,P)),n(255*m(X,W,P-1/3)),R];default:return null}}return null}}catch{}return wr}();class Pr{constructor(n,s,c,m=1){this.r=n,this.g=s,this.b=c,this.a=m}static parse(n){if(!n)return;if(n instanceof Pr)return n;if(typeof n!="string")return;const s=Ba.parseCSSColor(n);return s?new Pr(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,c,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(c)},${m})`}toRenderColor(n){const{r:s,g:c,b:m,a:f}=this;return new Ho(n,s,c,m,f)}}class Ho{constructor(n,s,c,m,f){if(n){const g=n.image.height,E=g*g;s=f===0?0:s/f*(g-1),c=f===0?0:c/f*(g-1),m=f===0?0:m/f*(g-1);const O=Math.floor(s),D=Math.floor(c),w=Math.floor(m),C=Math.ceil(s),R=Math.ceil(c),P=Math.ceil(m),k=s-O,N=c-D,W=m-w,X=n.image.data,ee=4*(O+D*E+w*g),ne=4*(O+D*E+P*g),J=4*(O+R*E+w*g),he=4*(O+R*E+P*g),ye=4*(C+D*E+w*g),Me=4*(C+D*E+P*g),Ve=4*(C+R*E+w*g),Ne=4*(C+R*E+P*g);if(ee<0||Ne>=X.length)throw new Error("out of range");this.r=Yn(Yn(Yn(X[ee],X[ne],W),Yn(X[J],X[he],W),N),Yn(Yn(X[ye],X[Me],W),Yn(X[Ve],X[Ne],W),N),k)/255*f,this.g=Yn(Yn(Yn(X[ee+1],X[ne+1],W),Yn(X[J+1],X[he+1],W),N),Yn(Yn(X[ye+1],X[Me+1],W),Yn(X[Ve+1],X[Ne+1],W),N),k)/255*f,this.b=Yn(Yn(Yn(X[ee+2],X[ne+2],W),Yn(X[J+2],X[he+2],W),N),Yn(Yn(X[ye+2],X[Me+2],W),Yn(X[Ve+2],X[Ne+2],W),N),k)/255*f,this.a=f}else this.r=s,this.g=c,this.b=m,this.a=f}toArray(){const{r:n,g:s,b:c,a:m}=this;return m===0?[0,0,0,0]:[255*n/m,255*s/m,255*c/m,m]}toArray01(){const{r:n,g:s,b:c,a:m}=this;return m===0?[0,0,0,0]:[n/m,s/m,c/m,m]}toArray01Scaled(n){const{r:s,g:c,b:m,a:f}=this;return f===0?[0,0,0]:[s/f*n,c/f*n,m/f*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:c,a:m}=this;return[n,s,c,m]}toArray01Linear(){const{r:n,g:s,b:c,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(n/m,2.2),Math.pow(s/m,2.2),Math.pow(c/m,2.2),m]}}function Yn(u,n,s){return u*(1-s)+n*s}function Wo(u,n,s){return u.map((c,m)=>Yn(c,n[m],s))}Pr.black=new Pr(0,0,0,1),Pr.white=new Pr(1,1,1,1),Pr.transparent=new Pr(0,0,0,0),Pr.red=new Pr(1,0,0,1),Pr.blue=new Pr(0,0,1,1);var ba=Object.freeze({__proto__:null,array:Wo,color:function(u,n,s){return new Pr(Yn(u.r,n.r,s),Yn(u.g,n.g,s),Yn(u.b,n.b,s),Yn(u.a,n.a,s))},number:Yn});function Hr(u,...n){for(const s of n)for(const c in s)u[c]=s[c];return u}class fo extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class no{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[c,m]of s)this.bindings[c]=m}concat(n){return new no(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const ss={kind:"null"},Dn={kind:"number"},ai={kind:"string"},Br={kind:"boolean"},Eo={kind:"color"},Bo={kind:"object"},cr={kind:"value"},co={kind:"collator"},ua={kind:"formatted"},Na={kind:"resolvedImage"};function _o(u,n){return{kind:"array",itemType:u,N:n}}function ho(u){if(u.kind==="array"){const n=ho(u.itemType);return typeof u.N=="number"?`array<${n}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${n}>`}return u.kind}const hl=[ss,Dn,ai,Br,Eo,ua,Bo,_o(cr),Na];function ks(u,n){if(n.kind==="error")return null;if(u.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ks(u.itemType,n.itemType))&&(typeof u.N!="number"||u.N===n.N))return null}else{if(u.kind===n.kind)return null;if(u.kind==="value"){for(const s of hl)if(!ks(s,n))return null}}return`Expected ${ho(u)} but found ${ho(n)} instead.`}function Rs(u,n){return n.some(s=>s.kind===u.kind)}function Za(u,n){return n.some(s=>s==="null"?u===null:s==="array"?Array.isArray(u):s==="object"?u&&!Array.isArray(u)&&typeof u=="object":s===typeof u)}class Oi{constructor(n,s,c){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zo{constructor(n,s,c,m,f){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=c,this.fontStack=m,this.textColor=f}}class ro{constructor(n){this.sections=n}static fromString(n){return new ro([new Zo(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary.length!==0)}static factory(n){return n instanceof ro?n:ro.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(c)}return n}}class No{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),this.available=n.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(n,s){return n?new No({namePrimary:n,nameSecondary:s,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function ac(u,n,s,c){return typeof u=="number"&&u>=0&&u<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[u,n,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[u,n,s,c]:[u,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ts(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Pr||u instanceof Oi||u instanceof ro||u instanceof No)return!0;if(Array.isArray(u)){for(const n of u)if(!ts(n))return!1;return!0}if(typeof u=="object"){for(const n in u)if(!ts(u[n]))return!1;return!0}return!1}function io(u){if(u===null)return ss;if(typeof u=="string")return ai;if(typeof u=="boolean")return Br;if(typeof u=="number")return Dn;if(u instanceof Pr)return Eo;if(u instanceof Oi)return co;if(u instanceof ro)return ua;if(u instanceof No)return Na;if(Array.isArray(u)){const n=u.length;let s;for(const c of u){const m=io(c);if(s){if(s===m)continue;s=cr;break}s=m}return _o(s||cr,n)}return Bo}function ca(u){const n=typeof u;return u===null?"":n==="string"||n==="number"||n==="boolean"?String(u):u instanceof Pr||u instanceof ro||u instanceof No?u.toString():JSON.stringify(u)}class yo{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!ts(n[1]))return s.error("invalid value");const c=n[1];let m=io(c);const f=s.expectedType;return m.kind!=="array"||m.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(m=f),new yo(m,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Pr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ro?this.value.serialize():this.value}}class Ao{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const fl={string:ai,number:Dn,boolean:Br,object:Bo};class Ca{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let c,m=1;const f=n[0];if(f==="array"){let E,O;if(n.length>2){const D=n[1];if(typeof D!="string"||!(D in fl)||D==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);E=fl[D],m++}else E=cr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);O=n[2],m++}c=_o(E,O)}else c=fl[f];const g=[];for(;m<n.length;m++){const E=s.parse(n[m],m,cr);if(!E)return null;g.push(E)}return new Ca(c,g)}evaluate(n){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(n);if(!ks(this.type,io(c)))return c;if(s===this.args.length-1)throw new Ao(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${ho(io(c))} but was expected to be of type ${ho(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const c=n.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const m=n.N;(typeof m=="number"||this.args.length>1)&&s.push(m)}}return s.concat(this.args.map(c=>c.serialize()))}}class bl{constructor(n){this.type=ua,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const m=[];let f=!1;for(let g=1;g<=n.length-1;++g){const E=n[g];if(f&&typeof E=="object"&&!Array.isArray(E)){f=!1;let O=null;if(E["font-scale"]&&(O=s.parseObjectValue(E["font-scale"],g,"font-scale",Dn),!O))return null;let D=null;if(E["text-font"]&&(D=s.parseObjectValue(E["text-font"],g,"text-font",_o(ai)),!D))return null;let w=null;if(E["text-color"]&&(w=s.parseObjectValue(E["text-color"],g,"text-color",Eo),!w))return null;const C=m[m.length-1];C.scale=O,C.font=D,C.textColor=w}else{const O=s.parse(n[g],g,cr);if(!O)return null;const D=O.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,m.push({content:O,scale:null,font:null,textColor:null})}}return new bl(m)}evaluate(n){return new ro(this.sections.map(s=>{const c=s.content.evaluate(n);return io(c)===Na?new Zo("",c,null,null,null):new Zo(ca(c),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),n.push(c)}return n}}class Xo{constructor(n,s){this.type=Na,this.inputPrimary=n,this.inputSecondary=s}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");const c=s.parse(n[1],1,ai);if(!c)return s.error("No image name provided.");if(n.length===2)return new Xo(c);const m=s.parse(n[2],1,ai);return m?new Xo(c,m):s.error("Secondary image variant is not a string.")}evaluate(n){const s=No.fromString(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){n(this.inputPrimary),this.inputSecondary&&n(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ls(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const bs={"to-boolean":Br,"to-color":Eo,"to-number":Dn,"to-string":ai};class ra{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[0],m=[];let f=ss;if(c==="to-array"){if(!Array.isArray(n[1]))return null;const g=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);f=_o(s.expectedType.itemType,g)}else{if(!(g>0&&ts(n[1][0])))return null;f=_o(io(n[1][0]),g)}for(let E=0;E<g;E++){const O=n[1][E];let D;if(ls(O)==="array")D=s.parse(O,void 0,f.itemType);else{const w=ls(O);if(w!==f.itemType.kind)return s.error(`Expected ${f.itemType.kind} but found ${w}.`);D=s.registry.literal.parse(["literal",O===void 0?null:O],s)}if(!D)return null;m.push(D)}}else{if((c==="to-boolean"||c==="to-string")&&n.length!==2)return s.error("Expected one argument.");f=bs[c];for(let g=1;g<n.length;g++){const E=s.parse(n[g],g,cr);if(!E)return null;m.push(E)}}return new ra(f,m)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,c;for(const m of this.args){if(s=m.evaluate(n),c=null,s instanceof Pr)return s;if(typeof s=="string"){const f=n.parseColor(s);if(f)return f}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:ac(s[0],s[1],s[2],s[3]),!c))return new Pr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Ao(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(n),s===null)return 0;const m=Number(s);if(!isNaN(m))return m}throw new Ao(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?ro.fromString(ca(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?No.fromString(ca(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):ca(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new bl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Xo(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const sc=["Unknown","Point","LineString","Polygon"];class lc{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?sc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-n[0])+this.featureDistanceData.bearing[1]*(m*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Pr.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class wa{constructor(n,s,c,m,f){this.name=n,this.type=s,this._evaluate=c,this.args=m,this._overloadIndex=f}evaluate(n){if(!this._evaluate){const s=wa.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const c=n[0],m=wa.definitions[c];if(!m)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(m)?m[0]:m.type,g=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=[];let O=null,D=-1;for(const[w,C]of g){if(Array.isArray(w)&&w.length!==n.length-1)continue;E.push(w),D++,O=new mf(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const R=[];let P=!1;for(let k=1;k<n.length;k++){const N=n[k],W=Array.isArray(w)?w[k-1]:w.type,X=O.parse(N,1+R.length,W);if(!X){P=!0;break}R.push(X)}if(!P)if(Array.isArray(w)&&w.length!==R.length)O.error(`Expected ${w.length} arguments, but found ${R.length} instead.`);else{for(let k=0;k<R.length;k++){const N=Array.isArray(w)?w[k]:w.type,W=R[k];O.concat(k+1).checkSubtype(N,W.type)}if(O.errors.length===0)return new wa(c,f,C,R,D)}}if(E.length===1)s.errors.push(...O.errors);else{const w=(E.length?E:g.map(([R])=>R)).map(us).join(" | "),C=[];for(let R=1;R<n.length;R++){const P=s.parse(n[R],1+C.length);if(!P)return null;C.push(ho(P.type))}s.error(`Expected arguments of type ${w}, but found (${C.join(", ")}) instead.`)}return null}static register(n,s){wa.definitions=s;for(const c in s)n[c]=wa}}function us(u){return Array.isArray(u)?`(${u.map(ho).join(", ")})`:`(${ho(u.type)}...)`}class wl{constructor(n,s,c){this.type=co,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const m=c["case-sensitive"]===void 0?s.parse(!1,1,Br):s.parseObjectValue(c["case-sensitive"],1,"case-sensitive",Br);if(!m)return null;const f=c["diacritic-sensitive"]===void 0?s.parse(!1,1,Br):s.parseObjectValue(c["diacritic-sensitive"],1,"diacritic-sensitive",Br);if(!f)return null;let g=null;return c.locale&&(g=s.parseObjectValue(c.locale,1,"locale",ai),!g)?null:new wl(m,f,g)}evaluate(n){return new Oi(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function Ru(u,n,s=0,c=u.length-1,m=$l){for(;c>s;){if(c-s>600){const O=c-s+1,D=n-s+1,w=Math.log(O),C=.5*Math.exp(2*w/3),R=.5*Math.sqrt(w*C*(O-C)/O)*(D-O/2<0?-1:1);Ru(u,n,Math.max(s,Math.floor(n-D*C/O+R)),Math.min(c,Math.floor(n+(O-D)*C/O+R)),m)}const f=u[n];let g=s,E=c;for(lu(u,s,n),m(u[c],f)>0&&lu(u,s,c);g<E;){for(lu(u,g,E),g++,E--;m(u[g],f)<0;)g++;for(;m(u[E],f)>0;)E--}m(u[s],f)===0?lu(u,s,E):(E++,lu(u,E,c)),E<=n&&(s=E+1),n<=E&&(c=E-1)}}function lu(u,n,s){const c=u[n];u[n]=u[s],u[s]=c}function $l(u,n){return u<n?-1:u>n?1:0}function uu(u){let n=0;for(let s,c,m=0,f=u.length,g=f-1;m<f;g=m++)s=u[m],c=u[g],n+=(c.x-s.x)*(s.y+c.y);return n}function cu(u,n){u[0]=Math.min(u[0],n[0]),u[1]=Math.min(u[1],n[1]),u[2]=Math.max(u[2],n[0]),u[3]=Math.max(u[3],n[1])}function Ks(u,n){return!(u[0]<=n[0]||u[2]>=n[2]||u[1]<=n[1]||u[3]>=n[3])}function Lu(u,n,s){const c=u[0]-n[0],m=u[1]-n[1],f=u[0]-s[0],g=u[1]-s[1];return c*g-f*m==0&&c*f<=0&&m*g<=0}function ws(u,n,s=!1){let c=!1;for(let E=0,O=n.length;E<O;E++){const D=n[E];for(let w=0,C=D.length,R=C-1;w<C;R=w++){const P=D[R],k=D[w];if(Lu(u,P,k))return s;(f=P)[1]>(m=u)[1]!=(g=k)[1]>m[1]&&m[0]<(g[0]-f[0])*(m[1]-f[1])/(g[1]-f[1])+f[0]&&(c=!c)}}var m,f,g;return c}function dl(u,n,s,c){const m=c[0]-s[0],f=c[1]-s[1],g=(u[0]-s[0])*f-m*(u[1]-s[1]),E=(n[0]-s[0])*f-m*(n[1]-s[1]);return g>0&&E<0||g<0&&E>0}function Du(u,n,s,c){return(m=[c[0]-s[0],c[1]-s[1]])[0]*(f=[n[0]-u[0],n[1]-u[1]])[1]-m[1]*f[0]!=0&&!(!dl(u,n,s,c)||!dl(s,c,u,n));var m,f}const ia=8192;function Sr(u,n){const s=(180+u[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,m=Math.pow(2,n.z);return[Math.round(s*m*ia),Math.round(c*m*ia)]}function ir(u,n){for(let s=0;s<n.length;s++)if(ws(u,n[s]))return!0;return!1}function pe(u,n,s){for(const c of s)for(let m=0,f=c.length,g=f-1;m<f;g=m++)if(Du(u,n,c[g],c[m]))return!0;return!1}function Pe(u,n){for(let s=0;s<u.length;++s)if(!ws(u[s],n))return!1;for(let s=0;s<u.length-1;++s)if(pe(u[s],u[s+1],n))return!1;return!0}function Xe(u,n){for(let s=0;s<n.length;s++)if(Pe(u,n[s]))return!0;return!1}function pt(u,n,s){const c=[];for(let m=0;m<u.length;m++){const f=[];for(let g=0;g<u[m].length;g++){const E=Sr(u[m][g],s);cu(n,E),f.push(E)}c.push(f)}return c}function Mt(u,n,s){const c=[];for(let m=0;m<u.length;m++){const f=pt(u[m],n,s);c.push(f)}return c}function an(u,n,s,c){if(u[0]<s[0]||u[0]>s[2]){const m=.5*c;let f=u[0]-s[0]>m?-c:s[0]-u[0]>m?c:0;f===0&&(f=u[0]-s[2]>m?-c:s[2]-u[0]>m?c:0),u[0]+=f}cu(n,u)}function wn(u,n,s,c){const m=Math.pow(2,c.z)*ia,f=[c.x*ia,c.y*ia],g=[];if(!u)return g;for(const E of u)for(const O of E){const D=[O.x+f[0],O.y+f[1]];an(D,n,s,m),g.push(D)}return g}function Hn(u,n,s,c){const m=Math.pow(2,c.z)*ia,f=[c.x*ia,c.y*ia],g=[];if(!u)return g;for(const O of u){const D=[];for(const w of O){const C=[w.x+f[0],w.y+f[1]];cu(n,C),D.push(C)}g.push(D)}if(n[2]-n[0]<=m/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const O of g)for(const D of O)an(D,n,s,m)}var E;return g}class vr{constructor(n,s){this.type=Br,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(ts(n[1])){const c=n[1];if(c.type==="FeatureCollection")for(let m=0;m<c.features.length;++m){const f=c.features[m].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new vr(c,c.features[m].geometry)}else if(c.type==="Feature"){const m=c.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new vr(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new vr(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,c){const m=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=s.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const E=pt(c.coordinates,f,g),O=wn(s.geometry(),m,f,g);if(!Ks(m,f))return!1;for(const D of O)if(!ws(D,E))return!1}if(c.type==="MultiPolygon"){const E=Mt(c.coordinates,f,g),O=wn(s.geometry(),m,f,g);if(!Ks(m,f))return!1;for(const D of O)if(!ir(D,E))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,c){const m=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=s.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const E=pt(c.coordinates,f,g),O=Hn(s.geometry(),m,f,g);if(!Ks(m,f))return!1;for(const D of O)if(!Pe(D,E))return!1}if(c.type==="MultiPolygon"){const E=Mt(c.coordinates,f,g),O=Hn(s.geometry(),m,f,g);if(!Ks(m,f))return!1;for(const D of O)if(!Xe(D,E))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Yr={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Or=1/298.257223563,zi=Or*(2-Or),ha=Math.PI/180;class jo{static fromTile(n,s,c){const m=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),f=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/ha;return new jo(f,c)}static get units(){return Yr}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!Yr[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(Yr).join(", ")}`);const c=6378.137*ha*(s?Yr[s]:1),m=Math.cos(n*ha),f=1/(1-zi*(1-m*m)),g=Math.sqrt(f);this.kx=c*g*m,this.ky=c*g*f*(1-zi)}distance(n,s){const c=Ji(n[0]-s[0])*this.kx,m=(n[1]-s[1])*this.ky;return Math.sqrt(c*c+m*m)}bearing(n,s){const c=Ji(s[0]-n[0])*this.kx;return Math.atan2(c,(s[1]-n[1])*this.ky)/ha}destination(n,s,c){const m=c*ha;return this.offset(n,Math.sin(m)*s,Math.cos(m)*s)}offset(n,s,c){return[n[0]+s/this.kx,n[1]+c/this.ky]}lineDistance(n){let s=0;for(let c=0;c<n.length-1;c++)s+=this.distance(n[c],n[c+1]);return s}area(n){let s=0;for(let c=0;c<n.length;c++){const m=n[c];for(let f=0,g=m.length,E=g-1;f<g;E=f++)s+=Ji(m[f][0]-m[E][0])*(m[f][1]+m[E][1])*(c?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let c=0;if(s<=0)return n[0];for(let m=0;m<n.length-1;m++){const f=n[m],g=n[m+1],E=this.distance(f,g);if(c+=E,c>s)return Oa(f,g,(s-(c-E))/E)}return n[n.length-1]}pointToSegmentDistance(n,s,c){let[m,f]=s,g=Ji(c[0]-m)*this.kx,E=(c[1]-f)*this.ky;if(g!==0||E!==0){const O=(Ji(n[0]-m)*this.kx*g+(n[1]-f)*this.ky*E)/(g*g+E*E);O>1?(m=c[0],f=c[1]):O>0&&(m+=g/this.kx*O,f+=E/this.ky*O)}return g=Ji(n[0]-m)*this.kx,E=(n[1]-f)*this.ky,Math.sqrt(g*g+E*E)}pointOnLine(n,s){let c=1/0,m=n[0][0],f=n[0][1],g=0,E=0;for(let O=0;O<n.length-1;O++){let D=n[O][0],w=n[O][1],C=Ji(n[O+1][0]-D)*this.kx,R=(n[O+1][1]-w)*this.ky,P=0;C===0&&R===0||(P=(Ji(s[0]-D)*this.kx*C+(s[1]-w)*this.ky*R)/(C*C+R*R),P>1?(D=n[O+1][0],w=n[O+1][1]):P>0&&(D+=C/this.kx*P,w+=R/this.ky*P)),C=Ji(s[0]-D)*this.kx,R=(s[1]-w)*this.ky;const k=C*C+R*R;k<c&&(c=k,m=D,f=w,g=O,E=P)}return{point:[m,f],index:g,t:Math.max(0,Math.min(1,E))}}lineSlice(n,s,c){let m=this.pointOnLine(c,n),f=this.pointOnLine(c,s);if(m.index>f.index||m.index===f.index&&m.t>f.t){const D=m;m=f,f=D}const g=[m.point],E=m.index+1,O=f.index;!Xa(c[E],g[0])&&E<=O&&g.push(c[E]);for(let D=E+1;D<=O;D++)g.push(c[D]);return Xa(c[O],f.point)||g.push(f.point),g}lineSliceAlong(n,s,c){let m=0;const f=[];for(let g=0;g<c.length-1;g++){const E=c[g],O=c[g+1],D=this.distance(E,O);if(m+=D,m>n&&f.length===0&&f.push(Oa(E,O,(n-(m-D))/D)),m>=s)return f.push(Oa(E,O,(s-(m-D))/D)),f;m>n&&f.push(O)}return f}bufferPoint(n,s){const c=s/this.ky,m=s/this.kx;return[n[0]-m,n[1]-c,n[0]+m,n[1]+c]}bufferBBox(n,s){const c=s/this.ky,m=s/this.kx;return[n[0]-m,n[1]-c,n[2]+m,n[3]+c]}insideBBox(n,s){return Ji(n[0]-s[0])>=0&&Ji(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function Xa(u,n){return u[0]===n[0]&&u[1]===n[1]}function Oa(u,n,s){const c=Ji(n[0]-u[0]);return[u[0]+c*s,u[1]+(n[1]-u[1])*s]}function Ji(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class cs{constructor(n=[],s=(c,m)=>c<m?-1:c>m?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:c}=this,m=s[n];for(;n>0;){const f=n-1>>1,g=s[f];if(c(m,g)>=0)break;s[n]=g,n=f}s[n]=m}_down(n){const{data:s,compare:c}=this,m=this.length>>1,f=s[n];for(;n<m;){let g=1+(n<<1);const E=g+1;if(E<this.length&&c(s[E],s[g])<0&&(g=E),c(s[g],f)>=0)break;s[n]=s[g],n=g}s[n]=f}}var En=8192;function Ul(u,n){return n.dist-u.dist}const Vl=100,Qc=50;function zu(u){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==u.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==u[s])return!1;return!0}function hu(u){return u[1]-u[0]+1}function fa(u,n){const s=u[1]>=u[0]&&u[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function ff(u,n){if(u[0]>u[1])return[null,null];const s=hu(u);if(n){if(s===2)return[u,null];const c=Math.floor(s/2);return[[u[0],u[0]+c],[u[0]+c,u[1]]]}{if(s===1)return[u,null];const c=Math.floor(s/2)-1;return[[u[0],u[0]+c],[u[0]+c+1,u[1]]]}}function da(u,n){const s=[1/0,1/0,-1/0,-1/0];if(!fa(n,u.length))return s;for(let c=n[0];c<=n[1];++c)cu(s,u[c]);return s}function zh(u){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<u.length;++s)for(let c=0;c<u[s].length;++c)cu(n,u[s][c]);return n}function hs(u,n,s){if(zu(u)||zu(n))return NaN;let c=0,m=0;return u[2]<n[0]&&(c=n[0]-u[2]),u[0]>n[2]&&(c=u[0]-n[2]),u[1]>n[3]&&(m=u[1]-n[3]),u[3]<n[1]&&(m=n[1]-u[3]),s.distance([0,0],[c,m])}function Fu(u){return 360*u-180}function eh(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function ns(u,n){const s=Math.pow(2,n.z),c=(u.y/En+n.y)/s;return[Fu((u.x/En+n.x)/s),eh(c)]}function uc(u,n){const s=[];for(let c=0;c<u.length;++c)s.push(ns(u[c],n));return s}function cc(u,n,s){const c=s.pointOnLine(n,u).point;return s.distance(u,c)}function hc(u,n,s,c,m){const f=s.slice(c[0],c[1]+1);let g=1/0;for(let E=n[0];E<=n[1];++E)if((g=Math.min(g,cc(u[E],f,m)))===0)return 0;return g}function ql(u,n,s,c,m){const f=Math.min(m.pointToSegmentDistance(u,s,c),m.pointToSegmentDistance(n,s,c)),g=Math.min(m.pointToSegmentDistance(s,u,n),m.pointToSegmentDistance(c,u,n));return Math.min(f,g)}function th(u,n,s,c,m){if(!fa(n,u.length)||!fa(c,s.length))return NaN;let f=1/0;for(let g=n[0];g<n[1];++g)for(let E=c[0];E<c[1];++E){if(Du(u[g],u[g+1],s[E],s[E+1]))return 0;f=Math.min(f,ql(u[g],u[g+1],s[E],s[E+1],m))}return f}function Fh(u,n,s,c,m){if(!fa(n,u.length)||!fa(c,s.length))return NaN;let f=1/0;for(let g=n[0];g<=n[1];++g)for(let E=c[0];E<=c[1];++E)if((f=Math.min(f,m.distance(u[g],s[E])))===0)return f;return f}function df(u,n,s){if(ws(u,n,!0))return 0;let c=1/0;for(const m of n){const f=m.length;if(f<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[f-1]&&(c=Math.min(c,s.pointToSegmentDistance(u,m[f-1],m[0])))===0||(c=Math.min(c,cc(u,m,s)))===0)return c}return c}function Ys(u,n,s,c){if(!fa(n,u.length))return NaN;for(let f=n[0];f<=n[1];++f)if(ws(u[f],s,!0))return 0;let m=1/0;for(let f=n[0];f<n[1];++f)for(const g of s)for(let E=0,O=g.length,D=O-1;E<O;D=E++){if(Du(u[f],u[f+1],g[D],g[E]))return 0;m=Math.min(m,ql(u[f],u[f+1],g[D],g[E],c))}return m}function Sl(u,n){for(const s of u)for(let c=0;c<=s.length-1;++c)if(ws(s[c],n,!0))return!0;return!1}function pf(u,n,s,c=1/0){const m=zh(u),f=zh(n);if(c!==1/0&&hs(m,f,s)>=c)return c;if(Ks(m,f)){if(Sl(u,n))return 0}else if(Sl(n,u))return 0;let g=c;for(const E of u)for(let O=0,D=E.length,w=D-1;O<D;w=O++)for(const C of n)for(let R=0,P=C.length,k=P-1;R<P;k=R++){if(Du(E[w],E[O],C[k],C[R]))return 0;g=Math.min(g,ql(E[w],E[O],C[k],C[R],s))}return g}function Bu(u,n,s,c,m,f,g){if(f===null||g===null)return;const E=hs(da(c,f),da(m,g),s);E<n&&u.push({dist:E,range1:f,range2:g})}function nh(u,n,s,c,m=1/0){let f=Math.min(c.distance(u[0],s[0][0]),m);if(f===0)return f;const g=new cs([{dist:0,range1:[0,u.length-1],range2:[0,0]}],Ul),E=n?Qc:Vl,O=zh(s);for(;g.length;){const D=g.pop();if(D.dist>=f)continue;const w=D.range1;if(hu(w)<=E){if(!fa(w,u.length))return NaN;if(n){const C=Ys(u,w,s,c);if((f=Math.min(f,C))===0)return f}else for(let C=w[0];C<=w[1];++C){const R=df(u[C],s,c);if((f=Math.min(f,R))===0)return f}}else{const C=ff(w,n);if(C[0]!==null){const R=hs(da(u,C[0]),O,c);R<f&&g.push({dist:R,range1:C[0],range2:[0,0]})}if(C[1]!==null){const R=hs(da(u,C[1]),O,c);R<f&&g.push({dist:R,range1:C[1],range2:[0,0]})}}}return f}function Nu(u,n,s,c,m,f=1/0){let g=Math.min(f,m.distance(u[0],s[0]));if(g===0)return g;const E=new cs([{dist:0,range1:[0,u.length-1],range2:[0,s.length-1]}],Ul),O=n?Qc:Vl,D=c?Qc:Vl;for(;E.length;){const w=E.pop();if(w.dist>=g)continue;const C=w.range1,R=w.range2;if(hu(C)<=O&&hu(R)<=D){if(!fa(C,u.length)||!fa(R,s.length))return NaN;if(n&&c?g=Math.min(g,th(u,C,s,R,m)):n||c?n&&!c?g=Math.min(g,hc(s,R,u,C,m)):!n&&c&&(g=Math.min(g,hc(u,C,s,R,m))):g=Math.min(g,Fh(u,C,s,R,m)),g===0)return g}else{const P=ff(C,n),k=ff(R,c);Bu(E,g,m,u,s,P[0],k[0]),Bu(E,g,m,u,s,P[0],k[1]),Bu(E,g,m,u,s,P[1],k[0]),Bu(E,g,m,u,s,P[1],k[1])}}return g}function fu(u,n,s,c,m=1/0){let f=m;const g=da(u,[0,u.length-1]);for(const E of s)if(!(f!==1/0&&hs(g,da(E,[0,E.length-1]),c)>=f)&&(f=Math.min(f,Nu(u,n,E,!0,c,f)),f===0))return f;return f}function Ss(u,n,s,c,m=1/0){let f=m;const g=da(u,[0,u.length-1]);for(const E of s){if(f!==1/0&&hs(g,zh(E),c)>=f)continue;const O=nh(u,n,E,c,f);if(isNaN(O))return O;if((f=Math.min(f,O))===0)return f}return f}function ju(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class Ls{constructor(n,s){this.type=Dn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(ts(n[1])){const c=n[1];if(c.type==="FeatureCollection"){for(let m=0;m<c.features.length;++m)if(ju(c.features[m].geometry.type))return new Ls(c,c.features[m].geometry)}else if(c.type==="Feature"){if(ju(c.geometry.type))return new Ls(c,c.geometry)}else if(ju(c.type))return new Ls(c,c)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),c=n.canonicalID();if(s!=null&&c!=null){if(n.geometryType()==="Point")return function(m,f,g){const E=[];for(const D of m)for(const w of D)E.push(ns(w,f));const O=new jo(E[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?Nu(E,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",O):g.type==="MultiLineString"?fu(E,!1,g.coordinates,O):g.type==="Polygon"||g.type==="MultiPolygon"?Ss(E,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,O):null}(s,c,this.geometries);if(n.geometryType()==="LineString")return function(m,f,g){const E=[];for(const D of m){const w=[];for(const C of D)w.push(ns(C,f));E.push(w)}const O=new jo(E[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return fu(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",E,O);if(g.type==="MultiLineString"){let D=1/0;for(let w=0;w<g.coordinates.length;w++){const C=fu(g.coordinates[w],!0,E,O,D);if(isNaN(C))return C;if((D=Math.min(D,C))===0)return D}return D}if(g.type==="Polygon"||g.type==="MultiPolygon"){let D=1/0;for(let w=0;w<E.length;w++){const C=Ss(E[w],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,O,D);if(isNaN(C))return C;if((D=Math.min(D,C))===0)return D}return D}return null}(s,c,this.geometries);if(n.geometryType()==="Polygon")return function(m,f,g){const E=[];for(const D of function(w,C){const R=w.length;if(R<=1)return[w];const P=[];let k,N;for(let W=0;W<R;W++){const X=uu(w[W]);X!==0&&(w[W].area=Math.abs(X),N===void 0&&(N=X<0),N===X<0?(k&&P.push(k),k=[w[W]]):k.push(w[W]))}return k&&P.push(k),P}(m)){const w=[];for(let C=0;C<D.length;++C)w.push(uc(D[C],f));E.push(w)}const O=new jo(E[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return Ss(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",E,O);if(g.type==="MultiLineString"){let D=1/0;for(let w=0;w<g.coordinates.length;w++){const C=Ss(g.coordinates[w],!0,E,O,D);if(isNaN(C))return C;if((D=Math.min(D,C))===0)return D}return D}return g.type==="Polygon"||g.type==="MultiPolygon"?function(D,w,C){let R=1/0;for(const P of D)for(const k of w){const N=pf(P,k,C,R);if(isNaN(N))return N;if((R=Math.min(R,N))===0)return R}return R}(g.type==="Polygon"?[g.coordinates]:g.coordinates,E,O):null}(s,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Ds(u,n){switch(u){case"string":return ca(n);case"number":return+n;case"boolean":return!!n;case"color":return Pr.parse(n);case"formatted":return ro.fromString(ca(n));case"resolvedImage":return No.fromString(ca(n))}return n}function ti(u,n,s,c){return c!==void 0&&(u=c*Math.round(u/c)),n!==void 0&&u<n&&(u=n),s!==void 0&&u>s&&(u=s),u}class Gl{constructor(n,s,c){this.type=n,this.key=s,this.scope=c}static parse(n,s){let c=s.expectedType;if(c==null&&(c=cr),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const m=s.parse(n[1],1);if(!(m instanceof yo))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const f=s.parse(n[2],2);return f instanceof yo?new Gl(c,ca(m.value),ca(f.value)):s.error("Scope of 'config' expression must be a string literal.")}return new Gl(c,ca(m.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),c=n.getConfig(s);if(!c)return null;const{type:m,value:f,values:g,minValue:E,maxValue:O,stepValue:D}=c,w=c.default.evaluate(n);let C=w;if(f){const R=n.scope;n.scope=(R||"").split("").slice(1).join(""),C=f.evaluate(n),n.scope=R}return m&&(C=Ds(m,C)),C===void 0||E===void 0&&O===void 0&&D===void 0||(typeof C=="number"?C=ti(C,E,O,D):Array.isArray(C)&&(C=C.map(R=>typeof R=="number"?ti(R,E,O,D):R))),f!==void 0&&C!==void 0&&g&&!g.includes(C)&&(C=w,m&&(C=Ds(m,C))),(m&&m!==this.type||C!==void 0&&io(C)!==this.type)&&(C=Ds(this.type.kind,C)),C}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function fc(u){if(u instanceof wa&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof vr||u instanceof Ls)return!1;let n=!0;return u.eachChild(s=>{n&&!fc(s)&&(n=!1)}),n}function pl(u){if(u instanceof wa&&u.name==="feature-state")return!1;let n=!0;return u.eachChild(s=>{n&&!pl(s)&&(n=!1)}),n}function Tl(u){if(u instanceof Gl)return new Set([u.key]);let n=new Set;return u.eachChild(s=>{n=new Set([...n,...Tl(s)])}),n}function zs(u,n){if(u instanceof wa&&n.indexOf(u.name)>=0)return!1;let s=!0;return u.eachChild(c=>{s&&!zs(c,n)&&(s=!1)}),s}class Bi{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=n[1];return s.scope.has(c)?new Bi(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class $u{constructor(n,s=[],c,m=new no,f=[],g,E){this.registry=n,this.path=s,this.key=s.map(O=>typeof O=="string"?`['${O}']`:`[${O}]`).join(""),this.scope=m,this.errors=f,this.expectedType=c,this._scope=g,this.options=E}parse(n,s,c,m,f={}){return s||c?this.concat(s,null,c,m)._parse(n,f):this._parse(n,f)}parseObjectValue(n,s,c,m,f,g={}){return this.concat(s,c,m,f)._parse(n,g)}_parse(n,s){function c(m,f,g){return g==="assert"?new Ca(f,[m]):g==="coerce"?new ra(f,[m]):m}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(m){let f=m.parse(n,this);if(!f)return null;if(this.expectedType){const g=this.expectedType,E=f.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||E.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(g,E))return null}else f=c(f,g,s.typeAnnotation||"coerce");else f=c(f,g,s.typeAnnotation||"assert")}if(!(f instanceof yo)&&f.type.kind!=="resolvedImage"&&Js(f)){const g=new lc(this._scope,this.options);try{f=new yo(f.type,f.evaluate(g))}catch(E){return this.error(E.message),null}}return f}return ra.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,c,m){let f=typeof n=="number"?this.path.concat(n):this.path;f=typeof s=="string"?f.concat(s):f;const g=m?this.scope.concat(m):this.scope;return new $u(this.registry,f,c||null,g,this.errors,this._scope,this.options)}error(n,...s){const c=`${this.key}${s.map(m=>`[${m}]`).join("")}`;this.errors.push(new fo(c,n))}checkSubtype(n,s){const c=ks(n,s);return c&&this.error(c),c}}var mf=$u;function Js(u){if(u instanceof Bi)return Js(u.boundExpression);if(u instanceof wa&&u.name==="error"||u instanceof wl||u instanceof vr||u instanceof Ls||u instanceof Gl)return!1;const n=u instanceof ra||u instanceof Ca;let s=!0;return u.eachChild(c=>{s=n?s&&Js(c):s&&c instanceof yo}),!!s&&fc(u)&&zs(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function dc(u,n){const s=u.length-1;let c,m,f=0,g=s,E=0;for(;f<=g;)if(E=Math.floor((f+g)/2),c=u[E],m=u[E+1],c<=n){if(E===s||n<m)return E;f=E+1}else{if(!(c>n))throw new Ao("Input is not a number.");g=E-1}return 0}class Uu{constructor(n,s,c){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[m,f]of c)this.labels.push(m),this.outputs.push(f)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(n[1],1,Dn);if(!c)return null;const m=[];let f=null;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);for(let g=1;g<n.length;g+=2){const E=g===1?-1/0:n[g],O=n[g+1],D=g,w=g+1;if(typeof E!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(m.length&&m[m.length-1][0]>=E)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const C=s.parse(O,w,f);if(!C)return null;f=f||C.type,m.push([E,C])}return new Uu(f,c,m)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const m=this.input.evaluate(n);if(m<=s[0])return c[0].evaluate(n);const f=s.length;return m>=s[f-1]?c[f-1].evaluate(n):c[dc(s,m)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const Vu=.95047,gf=1.08883,Qs=4/29,el=6/29,rh=3*el*el,ad=el*el*el,tp=Math.PI/180,pc=180/Math.PI;function Bh(u){return u>ad?Math.pow(u,1/3):u/rh+Qs}function ih(u){return u>el?u*u*u:rh*(u-Qs)}function oh(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function vo(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Nh(u){const n=vo(u.r),s=vo(u.g),c=vo(u.b),m=Bh((.4124564*n+.3575761*s+.1804375*c)/Vu),f=Bh((.2126729*n+.7151522*s+.072175*c)/1);return{l:116*f-16,a:500*(m-f),b:200*(f-Bh((.0193339*n+.119192*s+.9503041*c)/gf)),alpha:u.a}}function mc(u){let n=(u.l+16)/116,s=isNaN(u.a)?n:n+u.a/500,c=isNaN(u.b)?n:n-u.b/200;return n=1*ih(n),s=Vu*ih(s),c=gf*ih(c),new Pr(oh(3.2404542*s-1.5371385*n-.4985314*c),oh(-.969266*s+1.8760108*n+.041556*c),oh(.0556434*s-.2040259*n+1.0572252*c),u.alpha)}function gc(u,n,s){const c=n-u;return u+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const _c={forward:Nh,reverse:mc,interpolate:function(u,n,s){return{l:Yn(u.l,n.l,s),a:Yn(u.a,n.a,s),b:Yn(u.b,n.b,s),alpha:Yn(u.alpha,n.alpha,s)}}},y={forward:function(u){const{l:n,a:s,b:c}=Nh(u),m=Math.atan2(c,s)*pc;return{h:m<0?m+360:m,c:Math.sqrt(s*s+c*c),l:n,alpha:u.a}},reverse:function(u){const n=u.h*tp,s=u.c;return mc({l:u.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:u.alpha})},interpolate:function(u,n,s){return{h:gc(u.h,n.h,s),c:Yn(u.c,n.c,s),l:Yn(u.l,n.l,s),alpha:Yn(u.alpha,n.alpha,s)}}};var M=Object.freeze({__proto__:null,hcl:y,lab:_c});class V{constructor(n,s,c,m,f){this.type=n,this.operator=s,this.interpolation=c,this.input=m,this.labels=[],this.outputs=[];for(const[g,E]of f)this.labels.push(g),this.outputs.push(E)}static interpolationFactor(n,s,c,m){let f=0;if(n.name==="exponential")f=ie(s,n.base,c,m);else if(n.name==="linear")f=ie(s,1,c,m);else if(n.name==="cubic-bezier"){const g=n.controlPoints;f=new Sn(g[0],g[1],g[2],g[3]).solve(ie(s,1,c,m))}return f}static parse(n,s){let[c,m,f,...g]=n;if(!Array.isArray(m)||m.length===0)return s.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const D=m[1];if(typeof D!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:D}}else{if(m[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const D=m.slice(1);if(D.length!==4||D.some(w=>typeof w!="number"||w<0||w>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:D}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(f=s.parse(f,2,Dn),!f)return null;const E=[];let O=null;c==="interpolate-hcl"||c==="interpolate-lab"?O=Eo:s.expectedType&&s.expectedType.kind!=="value"&&(O=s.expectedType);for(let D=0;D<g.length;D+=2){const w=g[D],C=g[D+1],R=D+3,P=D+4;if(typeof w!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(E.length&&E[E.length-1][0]>=w)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const k=s.parse(C,P,O);if(!k)return null;O=O||k.type,E.push([w,k])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new V(O,c,m,f,E):s.error(`Type ${ho(O)} is not interpolatable.`)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const m=this.input.evaluate(n);if(m<=s[0])return c[0].evaluate(n);const f=s.length;if(m>=s[f-1])return c[f-1].evaluate(n);const g=dc(s,m),E=V.interpolationFactor(this.interpolation,m,s[g],s[g+1]),O=c[g].evaluate(n),D=c[g+1].evaluate(n);return this.operator==="interpolate"?ba[this.type.kind.toLowerCase()](O,D,E):this.operator==="interpolate-hcl"?y.reverse(y.interpolate(y.forward(O),y.forward(D),E)):_c.reverse(_c.interpolate(_c.forward(O),_c.forward(D),E))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function ie(u,n,s,c){const m=c-s,f=u-s;return m===0?0:n===1?f/m:(Math.pow(n,f)-1)/(Math.pow(n,m)-1)}class Ee{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let c=null;const m=s.expectedType;m&&m.kind!=="value"&&(c=m);const f=[];for(const E of n.slice(1)){const O=s.parse(E,1+f.length,c,void 0,{typeAnnotation:"omit"});if(!O)return null;c=c||O.type,f.push(O)}const g=m&&f.some(E=>ks(m,E.type));return new Ee(g?cr:c,f)}evaluate(n){let s,c=null,m=0;for(const f of this.args){if(m++,c=f.evaluate(n),c&&c instanceof No&&!c.available&&(s||(s=c),c=null,m===this.args.length))return s;if(c!==null)break}return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class Ge{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let f=1;f<n.length-1;f+=2){const g=n[f];if(typeof g!="string")return s.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return s.error("Variable names must contain only alphanumeric characters or '_'.",f);const E=s.parse(n[f+1],f+1);if(!E)return null;c.push([g,E])}const m=s.parse(n[n.length-1],n.length-1,s.expectedType,c);return m?new Ge(c,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,c]of this.bindings)n.push(s,c.serialize());return n.push(this.result.serialize()),n}}class Pt{constructor(n,s,c){this.type=n,this.index=s,this.input=c}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Dn),m=s.parse(n[2],2,_o(s.expectedType||cr));return c&&m?new Pt(m.type.itemType,c,m):null}evaluate(n){const s=this.index.evaluate(n),c=this.input.evaluate(n);if(s<0)throw new Ao(`Array index out of bounds: ${s} < 0.`);if(s>c.length-1)throw new Ao(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s===Math.floor(s))return c[s];const m=Math.floor(s),f=Math.ceil(s),g=c[m],E=c[f];if(typeof g!="number"||typeof E!="number")throw new Ao(`Cannot interpolate between non-number values at index ${s}.`);const O=s-m;return g*(1-O)+E*O}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class on{constructor(n,s){this.type=Br,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,cr),m=s.parse(n[2],2,cr);return c&&m?Rs(c.type,[Br,ai,Dn,ss,cr])?new on(c,m):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ho(c.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(c==null)return!1;if(!Za(s,["boolean","string","number","null"]))throw new Ao(`Expected first argument to be of type boolean, string, number or null, but found ${ho(io(s))} instead.`);if(!Za(c,["string","array"]))throw new Ao(`Expected second argument to be of type array or string, but found ${ho(io(c))} instead.`);return c.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class dn{constructor(n,s,c){this.type=Dn,this.needle=n,this.haystack=s,this.fromIndex=c}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,cr),m=s.parse(n[2],2,cr);if(!c||!m)return null;if(!Rs(c.type,[Br,ai,Dn,ss,cr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ho(c.type)} instead`);if(n.length===4){const f=s.parse(n[3],3,Dn);return f?new dn(c,m,f):null}return new dn(c,m)}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!Za(s,["boolean","string","number","null"]))throw new Ao(`Expected first argument to be of type boolean, string, number or null, but found ${ho(io(s))} instead.`);if(!Za(c,["string","array"]))throw new Ao(`Expected second argument to be of type array or string, but found ${ho(io(c))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(n);return c.indexOf(s,m)}return c.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Rn{constructor(n,s,c,m,f,g){this.inputType=n,this.type=s,this.input=c,this.cases=m,this.outputs=f,this.otherwise=g}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let c,m;s.expectedType&&s.expectedType.kind!=="value"&&(m=s.expectedType);const f={},g=[];for(let D=2;D<n.length-1;D+=2){let w=n[D];const C=n[D+1];Array.isArray(w)||(w=[w]);const R=s.concat(D);if(w.length===0)return R.error("Expected at least one branch label.");for(const k of w){if(typeof k!="number"&&typeof k!="string")return R.error("Branch labels must be numbers or strings.");if(typeof k=="number"&&Math.abs(k)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof k=="number"&&Math.floor(k)!==k)return R.error("Numeric branch labels must be integer values.");if(c){if(R.checkSubtype(c,io(k)))return null}else c=io(k);if(f[String(k)]!==void 0)return R.error("Branch labels must be unique.");f[String(k)]=g.length}const P=s.parse(C,D,m);if(!P)return null;m=m||P.type,g.push(P)}const E=s.parse(n[1],1,cr);if(!E)return null;const O=s.parse(n[n.length-1],n.length-1,m);return O?E.type.kind!=="value"&&s.concat(1).checkSubtype(c,E.type)?null:new Rn(c,m,E,f,g,O):null}evaluate(n){const s=this.input.evaluate(n);return(io(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],m={};for(const g of s){const E=m[this.cases[g]];E===void 0?(m[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[E][1].push(g)}const f=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,E]of c)n.push(E.length===1?f(E[0]):E.map(f)),n.push(this.outputs[g].serialize());return n.push(this.otherwise.serialize()),n}}class hr{constructor(n,s,c){this.type=n,this.branches=s,this.otherwise=c}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const m=[];for(let g=1;g<n.length-1;g+=2){const E=s.parse(n[g],g,Br);if(!E)return null;const O=s.parse(n[g+1],g+1,c);if(!O)return null;m.push([E,O]),c=c||O.type}const f=s.parse(n[n.length-1],n.length-1,c);return f?new hr(c,m,f):null}evaluate(n){for(const[s,c]of this.branches)if(s.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,c]of this.branches)n(s),n(c);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class Jr{constructor(n,s,c,m){this.type=n,this.input=s,this.beginIndex=c,this.endIndex=m}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,cr),m=s.parse(n[2],2,Dn);if(!c||!m)return null;if(!Rs(c.type,[_o(cr),ai,cr]))return s.error(`Expected first argument to be of type array or string, but found ${ho(c.type)} instead`);if(n.length===4){const f=s.parse(n[3],3,Dn);return f?new Jr(c.type,c,m,f):null}return new Jr(c.type,c,m)}evaluate(n){const s=this.input.evaluate(n),c=this.beginIndex.evaluate(n);if(!Za(s,["string","array"]))throw new Ao(`Expected first argument to be of type array or string, but found ${ho(io(s))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(n);return s.slice(c,m)}return s.slice(c)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Ii(u,n){return u==="=="||u==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function ja(u,n,s,c){return c.compare(n,s)===0}function Ko(u,n,s){const c=u!=="=="&&u!=="!=";return class K5{constructor(f,g,E){this.type=Br,this.lhs=f,this.rhs=g,this.collator=E,this.hasUntypedArgument=f.type.kind==="value"||g.type.kind==="value"}static parse(f,g){if(f.length!==3&&f.length!==4)return g.error("Expected two or three arguments.");const E=f[0];let O=g.parse(f[1],1,cr);if(!O)return null;if(!Ii(E,O.type))return g.concat(1).error(`"${E}" comparisons are not supported for type '${ho(O.type)}'.`);let D=g.parse(f[2],2,cr);if(!D)return null;if(!Ii(E,D.type))return g.concat(2).error(`"${E}" comparisons are not supported for type '${ho(D.type)}'.`);if(O.type.kind!==D.type.kind&&O.type.kind!=="value"&&D.type.kind!=="value")return g.error(`Cannot compare types '${ho(O.type)}' and '${ho(D.type)}'.`);c&&(O.type.kind==="value"&&D.type.kind!=="value"?O=new Ca(D.type,[O]):O.type.kind!=="value"&&D.type.kind==="value"&&(D=new Ca(O.type,[D])));let w=null;if(f.length===4){if(O.type.kind!=="string"&&D.type.kind!=="string"&&O.type.kind!=="value"&&D.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(w=g.parse(f[3],3,co),!w)return null}return new K5(O,D,w)}evaluate(f){const g=this.lhs.evaluate(f),E=this.rhs.evaluate(f);if(c&&this.hasUntypedArgument){const O=io(g),D=io(E);if(O.kind!==D.kind||O.kind!=="string"&&O.kind!=="number")throw new Ao(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${O.kind}, ${D.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const O=io(g),D=io(E);if(O.kind!=="string"||D.kind!=="string")return n(f,g,E)}return this.collator?s(f,g,E,this.collator.evaluate(f)):n(f,g,E)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[u];return this.eachChild(g=>{f.push(g.serialize())}),f}}}const Fs=Ko("==",function(u,n,s){return n===s},ja),fs=Ko("!=",function(u,n,s){return n!==s},function(u,n,s,c){return!ja(0,n,s,c)}),qu=Ko("<",function(u,n,s){return n<s},function(u,n,s,c){return c.compare(n,s)<0}),du=Ko(">",function(u,n,s){return n>s},function(u,n,s,c){return c.compare(n,s)>0}),Hl=Ko("<=",function(u,n,s){return n<=s},function(u,n,s,c){return c.compare(n,s)<=0}),_f=Ko(">=",function(u,n,s){return n>=s},function(u,n,s,c){return c.compare(n,s)>=0});class Wl{constructor(n,s,c,m,f,g){this.type=ai,this.number=n,this.locale=s,this.currency=c,this.unit=m,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Dn);if(!c)return null;const m=n[2];if(typeof m!="object"||Array.isArray(m))return s.error("NumberFormat options argument must be an object.");let f=null;if(m.locale&&(f=s.parseObjectValue(m.locale,2,"locale",ai),!f))return null;let g=null;if(m.currency&&(g=s.parseObjectValue(m.currency,2,"currency",ai),!g))return null;let E=null;if(m.unit&&(E=s.parseObjectValue(m.unit,2,"unit",ai),!E))return null;let O=null;if(m["min-fraction-digits"]&&(O=s.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",Dn),!O))return null;let D=null;return m["max-fraction-digits"]&&(D=s.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",Dn),!D)?null:new Wl(c,f,g,E,O,D)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Ts{constructor(n){this.type=Dn,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=s.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${ho(c.type)} instead.`):new Ts(c):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Ao(`Expected value to be of type string or array, but found ${ho(io(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function Zl(u){return function(){u=1831565813+(u|=0)|0;let n=Math.imul(u^u>>>15,1|u);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const Xi={"==":Fs,"!=":fs,">":du,"<":qu,">=":_f,"<=":Hl,array:Ca,at:Pt,boolean:Ca,case:hr,coalesce:Ee,collator:wl,format:bl,image:Xo,in:on,"index-of":dn,interpolate:V,"interpolate-hcl":V,"interpolate-lab":V,length:Ts,let:Ge,literal:yo,match:Rn,number:Ca,"number-format":Wl,object:Ca,slice:Jr,step:Uu,string:Ca,"to-boolean":ra,"to-color":ra,"to-number":ra,"to-string":ra,var:Bi,within:vr,distance:Ls,config:Gl};function Gu(u,[n,s,c,m]){n=n.evaluate(u),s=s.evaluate(u),c=c.evaluate(u);const f=m?m.evaluate(u):1,g=ac(n,s,c,f);if(g)throw new Ao(g);return new Pr(n/255*f,s/255*f,c/255*f,f)}function yf(u,[n,s,c,m]){n=n.evaluate(u),s=s.evaluate(u),c=c.evaluate(u);const f=m?m.evaluate(u):1,g=function(D,w,C,R){return typeof D=="number"&&D>=0&&D<=360?typeof w=="number"&&w>=0&&w<=100&&typeof C=="number"&&C>=0&&C<=100?R===void 0||typeof R=="number"&&R>=0&&R<=1?null:`Invalid hsla value [${[D,w,C,R].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof R=="number"?[D,w,C,R]:[D,w,C]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof R=="number"?[D,w,C,R]:[D,w,C]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,c,f);if(g)throw new Ao(g);const E=`hsla(${n}, ${s}%, ${c}%, ${f})`,O=Pr.parse(E);if(!O)throw new Ao(`Failed to parse HSLA color: ${E}`);return O}function vf(u,n){return u in n}function Xl(u,n){const s=n[u];return s===void 0?null:s}function Bs(u){return{type:u}}function pu(u){return{result:"success",value:u}}function tl(u){return{result:"error",value:u}}function jh(u,n){return!!u&&!!u.parameters&&u.parameters.indexOf(n)>-1}function El(u){return u["property-type"]==="data-driven"}function Hu(u){return jh(u.expression,"measure-light")}function Do(u){return jh(u.expression,"zoom")}function Io(u){return!!u.expression&&u.expression.interpolated}function mu(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function ds(u){return u}function Es(u,n){const s=n.type==="color",c=u.stops&&typeof u.stops[0][0]=="object",m=c||!(c||u.property!==void 0),f=u.type||(Io(n)?"exponential":"interval");if(s&&((u=Hr({},u)).stops&&(u.stops=u.stops.map(D=>[D[0],Pr.parse(D[1])])),u.default=Pr.parse(u.default?u.default:n.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!M[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let g,E,O;if(f==="exponential")g=Uh;else if(f==="interval")g=nl;else if(f==="categorical"){g=$h,E=Object.create(null);for(const D of u.stops)E[D[0]]=D[1];O=typeof u.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);g=sm}if(c){const D={},w=[];for(let P=0;P<u.stops.length;P++){const k=u.stops[P],N=k[0].zoom;D[N]===void 0&&(D[N]={zoom:N,type:u.type,property:u.property,default:u.default,stops:[]},w.push(N)),D[N].stops.push([k[0].value,k[1]])}const C=[];for(const P of w)C.push([D[P].zoom,Es(D[P],n)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:V.interpolationFactor.bind(void 0,R),zoomStops:C.map(P=>P[0]),evaluate:({zoom:P},k)=>Uh({stops:C,base:u.base},n,P).evaluate(P,k)}}if(m){const D=f==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:V.interpolationFactor.bind(void 0,D),zoomStops:u.stops.map(w=>w[0]),evaluate:({zoom:w})=>g(u,n,w,E,O)}}return{kind:"source",evaluate(D,w){const C=w&&w.properties?w.properties[u.property]:void 0;return C===void 0?Kl(u.default,n.default):g(u,n,C,E,O)}}}function Kl(u,n,s){return u!==void 0?u:n!==void 0?n:s!==void 0?s:void 0}function $h(u,n,s,c,m){return Kl(typeof s===m?c[s]:void 0,u.default,n.default)}function nl(u,n,s){if(ls(s)!=="number")return Kl(u.default,n.default);const c=u.stops.length;if(c===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[c-1][0])return u.stops[c-1][1];const m=dc(u.stops.map(f=>f[0]),s);return u.stops[m][1]}function Uh(u,n,s){const c=u.base!==void 0?u.base:1;if(ls(s)!=="number")return Kl(u.default,n.default);const m=u.stops.length;if(m===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[m-1][0])return u.stops[m-1][1];const f=dc(u.stops.map(w=>w[0]),s),g=function(w,C,R,P){const k=P-R,N=w-R;return k===0?0:C===1?N/k:(Math.pow(C,N)-1)/(Math.pow(C,k)-1)}(s,c,u.stops[f][0],u.stops[f+1][0]),E=u.stops[f][1],O=u.stops[f+1][1];let D=ba[n.type]||ds;if(u.colorSpace&&u.colorSpace!=="rgb"){const w=M[u.colorSpace];D=(C,R)=>w.reverse(w.interpolate(w.forward(C),w.forward(R),g))}return typeof E.evaluate=="function"?{evaluate(...w){const C=E.evaluate.apply(void 0,w),R=O.evaluate.apply(void 0,w);if(C!==void 0&&R!==void 0)return D(C,R,g)}}:D(E,O,g)}function sm(u,n,s){return n.type==="color"?s=Pr.parse(s):n.type==="formatted"?s=ro.fromString(s.toString()):n.type==="resolvedImage"?s=No.fromString(s.toString()):ls(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Kl(s,u.default,n.default)}wa.register(Xi,{error:[{kind:"error"},[ai],(u,[n])=>{throw new Ao(n.evaluate(u))}],typeof:[ai,[cr],(u,[n])=>ho(io(n.evaluate(u)))],"to-rgba":[_o(Dn,4),[Eo],(u,[n])=>n.evaluate(u).toRenderColor(null).toArray()],rgb:[Eo,[Dn,Dn,Dn],Gu],rgba:[Eo,[Dn,Dn,Dn,Dn],Gu],hsl:[Eo,[Dn,Dn,Dn],yf],hsla:[Eo,[Dn,Dn,Dn,Dn],yf],has:{type:Br,overloads:[[[ai],(u,[n])=>vf(n.evaluate(u),u.properties())],[[ai,Bo],(u,[n,s])=>vf(n.evaluate(u),s.evaluate(u))]]},get:{type:cr,overloads:[[[ai],(u,[n])=>Xl(n.evaluate(u),u.properties())],[[ai,Bo],(u,[n,s])=>Xl(n.evaluate(u),s.evaluate(u))]]},"feature-state":[cr,[ai],(u,[n])=>Xl(n.evaluate(u),u.featureState||{})],properties:[Bo,[],u=>u.properties()],"geometry-type":[ai,[],u=>u.geometryType()],id:[cr,[],u=>u.id()],zoom:[Dn,[],u=>u.globals.zoom],pitch:[Dn,[],u=>u.globals.pitch||0],"distance-from-center":[Dn,[],u=>u.distanceFromCenter()],"measure-light":[Dn,[ai],(u,[n])=>u.measureLight(n.evaluate(u))],"heatmap-density":[Dn,[],u=>u.globals.heatmapDensity||0],"line-progress":[Dn,[],u=>u.globals.lineProgress||0],"raster-value":[Dn,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[Dn,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[Dn,[],u=>u.globals.skyRadialProgress||0],accumulated:[cr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Dn,Bs(Dn),(u,n)=>{let s=0;for(const c of n)s+=c.evaluate(u);return s}],"*":[Dn,Bs(Dn),(u,n)=>{let s=1;for(const c of n)s*=c.evaluate(u);return s}],"-":{type:Dn,overloads:[[[Dn,Dn],(u,[n,s])=>n.evaluate(u)-s.evaluate(u)],[[Dn],(u,[n])=>-n.evaluate(u)]]},"/":[Dn,[Dn,Dn],(u,[n,s])=>n.evaluate(u)/s.evaluate(u)],"%":[Dn,[Dn,Dn],(u,[n,s])=>n.evaluate(u)%s.evaluate(u)],ln2:[Dn,[],()=>Math.LN2],pi:[Dn,[],()=>Math.PI],e:[Dn,[],()=>Math.E],"^":[Dn,[Dn,Dn],(u,[n,s])=>Math.pow(n.evaluate(u),s.evaluate(u))],sqrt:[Dn,[Dn],(u,[n])=>Math.sqrt(n.evaluate(u))],log10:[Dn,[Dn],(u,[n])=>Math.log(n.evaluate(u))/Math.LN10],ln:[Dn,[Dn],(u,[n])=>Math.log(n.evaluate(u))],log2:[Dn,[Dn],(u,[n])=>Math.log(n.evaluate(u))/Math.LN2],sin:[Dn,[Dn],(u,[n])=>Math.sin(n.evaluate(u))],cos:[Dn,[Dn],(u,[n])=>Math.cos(n.evaluate(u))],tan:[Dn,[Dn],(u,[n])=>Math.tan(n.evaluate(u))],asin:[Dn,[Dn],(u,[n])=>Math.asin(n.evaluate(u))],acos:[Dn,[Dn],(u,[n])=>Math.acos(n.evaluate(u))],atan:[Dn,[Dn],(u,[n])=>Math.atan(n.evaluate(u))],min:[Dn,Bs(Dn),(u,n)=>Math.min(...n.map(s=>s.evaluate(u)))],max:[Dn,Bs(Dn),(u,n)=>Math.max(...n.map(s=>s.evaluate(u)))],abs:[Dn,[Dn],(u,[n])=>Math.abs(n.evaluate(u))],round:[Dn,[Dn],(u,[n])=>{const s=n.evaluate(u);return s<0?-Math.round(-s):Math.round(s)}],floor:[Dn,[Dn],(u,[n])=>Math.floor(n.evaluate(u))],ceil:[Dn,[Dn],(u,[n])=>Math.ceil(n.evaluate(u))],"filter-==":[Br,[ai,cr],(u,[n,s])=>u.properties()[n.value]===s.value],"filter-id-==":[Br,[cr],(u,[n])=>u.id()===n.value],"filter-type-==":[Br,[ai],(u,[n])=>u.geometryType()===n.value],"filter-<":[Br,[ai,cr],(u,[n,s])=>{const c=u.properties()[n.value],m=s.value;return typeof c==typeof m&&c<m}],"filter-id-<":[Br,[cr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s<c}],"filter->":[Br,[ai,cr],(u,[n,s])=>{const c=u.properties()[n.value],m=s.value;return typeof c==typeof m&&c>m}],"filter-id->":[Br,[cr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s>c}],"filter-<=":[Br,[ai,cr],(u,[n,s])=>{const c=u.properties()[n.value],m=s.value;return typeof c==typeof m&&c<=m}],"filter-id-<=":[Br,[cr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s<=c}],"filter->=":[Br,[ai,cr],(u,[n,s])=>{const c=u.properties()[n.value],m=s.value;return typeof c==typeof m&&c>=m}],"filter-id->=":[Br,[cr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s>=c}],"filter-has":[Br,[cr],(u,[n])=>n.value in u.properties()],"filter-has-id":[Br,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Br,[_o(ai)],(u,[n])=>n.value.indexOf(u.geometryType())>=0],"filter-id-in":[Br,[_o(cr)],(u,[n])=>n.value.indexOf(u.id())>=0],"filter-in-small":[Br,[ai,_o(cr)],(u,[n,s])=>s.value.indexOf(u.properties()[n.value])>=0],"filter-in-large":[Br,[ai,_o(cr)],(u,[n,s])=>function(c,m,f,g){for(;f<=g;){const E=f+g>>1;if(m[E]===c)return!0;m[E]>c?g=E-1:f=E+1}return!1}(u.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Br,overloads:[[[Br,Br],(u,[n,s])=>n.evaluate(u)&&s.evaluate(u)],[Bs(Br),(u,n)=>{for(const s of n)if(!s.evaluate(u))return!1;return!0}]]},any:{type:Br,overloads:[[[Br,Br],(u,[n,s])=>n.evaluate(u)||s.evaluate(u)],[Bs(Br),(u,n)=>{for(const s of n)if(s.evaluate(u))return!0;return!1}]]},"!":[Br,[Br],(u,[n])=>!n.evaluate(u)],"is-supported-script":[Br,[ai],(u,[n])=>{const s=u.globals&&u.globals.isSupportedScript;return!s||s(n.evaluate(u))}],upcase:[ai,[ai],(u,[n])=>n.evaluate(u).toUpperCase()],downcase:[ai,[ai],(u,[n])=>n.evaluate(u).toLowerCase()],concat:[ai,Bs(cr),(u,n)=>n.map(s=>ca(s.evaluate(u))).join("")],"resolved-locale":[ai,[co],(u,[n])=>n.evaluate(u).resolvedLocale()],random:[Dn,[Dn,Dn,cr],(u,n)=>{const[s,c,m]=n.map(g=>g.evaluate(u));if(s>c||s===c)return s;let f;if(typeof m=="string")f=function(g){let E=0;if(g.length===0)return E;for(let O=0;O<g.length;O++)E=(E<<5)-E+g.charCodeAt(O),E|=0;return E}(m);else{if(typeof m!="number")throw new Ao(`Invalid seed input: ${m}`);f=m}return s+Zl(f)()*(c-s)}]});class sd{constructor(n,s,c,m){this.expression=n,this._warningHistory={},this._evaluator=new lc(c,m),this._defaultValue=s?function(f){return f.type==="color"&&(mu(f.default)||Array.isArray(f.default))?new Pr(0,0,0,0):f.type==="color"?Pr.parse(f.default)||null:f.default===void 0?null:f.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=Tl(n)}evaluateWithoutErrorHandling(n,s,c,m,f,g,E,O){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=m||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,c,m,f,g,E,O){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=O||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Ao(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${D.message}`)),this._defaultValue}}}function ah(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Xi}function sh(u,n,s,c){const m=new mf(Xi,[],n?function(g){const E={color:Eo,string:ai,number:Dn,enum:ai,boolean:Br,formatted:ua,resolvedImage:Na};return g.type==="array"?_o(E[g.value]||cr,g.length):E[g.type]}(n):void 0,void 0,void 0,s,c),f=m.parse(u,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?pu(new sd(f,n,s,c)):tl(m.errors)}class Al{constructor(n,s,c){this.kind=n,this._styleExpression=s,this.isLightConstant=c,this.isStateDependent=n!=="constant"&&!pl(s.expression),this.configDependencies=Tl(s.expression)}evaluateWithoutErrorHandling(n,s,c,m,f,g){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,m,f,g)}evaluate(n,s,c,m,f,g){return this._styleExpression.evaluate(n,s,c,m,f,g)}}class yc{constructor(n,s,c,m,f){this.kind=n,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!pl(s.expression),this.isLightConstant=f,this.configDependencies=Tl(s.expression),this.interpolationType=m}evaluateWithoutErrorHandling(n,s,c,m,f,g){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,m,f,g)}evaluate(n,s,c,m,f,g){return this._styleExpression.evaluate(n,s,c,m,f,g)}interpolationFactor(n,s,c){return this.interpolationType?V.interpolationFactor(this.interpolationType,n,s,c):0}}function Wu(u,n,s,c){if((u=sh(u,n,s,c)).result==="error")return u;const m=u.value.expression,f=fc(m);if(!f&&!El(n))return tl([new fo("","data expressions not supported")]);const g=zs(m,["zoom","pitch","distance-from-center"]);if(!g&&!Do(n))return tl([new fo("","zoom expressions not supported")]);const E=zs(m,["measure-light"]);if(!E&&!Hu(n))return tl([new fo("","measure-light expression not supported")]);const O=zs(m,["line-progress"]);if(!O&&!function(C){return jh(C.expression,"line-progress")}(n))return tl([new fo("","line-progress expression not supported")]);const D=n.expression&&n.expression.relaxZoomRestriction,w=ld(m);return w||g||D?w instanceof fo?tl([w]):w instanceof V&&!Io(n)?tl([new fo("",'"interpolate" expressions cannot be used with this property')]):pu(w?new yc(f&&O?"camera":"composite",u.value,w.labels,w instanceof V?w.interpolation:void 0,E):new Al(f&&O?"constant":"source",u.value,E)):tl([new fo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class xf{constructor(n,s){this._parameters=n,this._specification=s,Hr(this,Es(this._parameters,this._specification))}static deserialize(n){return new xf(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function ld(u){let n=null;if(u instanceof Ge)n=ld(u.result);else if(u instanceof Ee){for(const s of u.args)if(n=ld(s),n)break}else(u instanceof Uu||u instanceof V)&&u.input instanceof wa&&u.input.name==="zoom"&&(n=u);return n instanceof fo||u.eachChild(s=>{const c=ld(s);c instanceof fo?n=c:n&&c&&n!==c&&(n=new fo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var gu,vc,lh=function(){if(vc)return gu;vc=1,gu=n;var u=3;function n(s,c,m){var f=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var g=new Int32Array(this.arrayBuffer);s=g[0],this.d=(c=g[1])+2*(m=g[2]);for(var E=0;E<this.d*this.d;E++){var O=g[u+E],D=g[u+E+1];f.push(O===D?null:g.subarray(O,D))}var w=g[u+f.length+1];this.keys=g.subarray(g[u+f.length],w),this.bboxes=g.subarray(w),this.insert=this._insertReadonly}else{this.d=c+2*m;for(var C=0;C<this.d*this.d;C++)f.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=s,this.padding=m,this.scale=c/s,this.uid=0;var R=m/c*s;this.min=-R,this.max=s+R}return n.prototype.insert=function(s,c,m,f,g){this._forEachCell(c,m,f,g,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(f),this.bboxes.push(g)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,c,m,f,g,E){this.cells[g].push(E)},n.prototype.query=function(s,c,m,f,g){var E=this.min,O=this.max;if(s<=E&&c<=E&&O<=m&&O<=f&&!g)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(s,c,m,f,this._queryCell,D,{},g),D},n.prototype._queryCell=function(s,c,m,f,g,E,O,D){var w=this.cells[g];if(w!==null)for(var C=this.keys,R=this.bboxes,P=0;P<w.length;P++){var k=w[P];if(O[k]===void 0){var N=4*k;(D?D(R[N+0],R[N+1],R[N+2],R[N+3]):s<=R[N+2]&&c<=R[N+3]&&m>=R[N+0]&&f>=R[N+1])?(O[k]=!0,E.push(C[k])):O[k]=!1}}},n.prototype._forEachCell=function(s,c,m,f,g,E,O,D){for(var w=this._convertToCellCoord(s),C=this._convertToCellCoord(c),R=this._convertToCellCoord(m),P=this._convertToCellCoord(f),k=w;k<=R;k++)for(var N=C;N<=P;N++){var W=this.d*N+k;if((!D||D(this._convertFromCellCoord(k),this._convertFromCellCoord(N),this._convertFromCellCoord(k+1),this._convertFromCellCoord(N+1)))&&g.call(this,s,c,m,f,W,E,O,D))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,c=u+this.cells.length+1+1,m=0,f=0;f<this.cells.length;f++)m+=this.cells[f].length;var g=new Int32Array(c+m+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var E=c,O=0;O<s.length;O++){var D=s[O];g[u+O]=E,g.set(D,E),E+=D.length}return g[u+s.length]=E,g.set(this.keys,E),g[u+s.length+1]=E+=this.keys.length,g.set(this.bboxes,E),E+=this.bboxes.length,g.buffer},gu}(),_u=I(lh);const xc={};function kn(u,n,s={}){Object.defineProperty(u,"_classRegistryKey",{value:n,writable:!1}),xc[n]={klass:u,omit:s.omit||[]}}kn(Object,"Object"),_u.serialize=function(u,n){const s=u.toArrayBuffer();return n&&n.add(s),{buffer:s}},_u.deserialize=function(u){return new _u(u.buffer)},Object.defineProperty(_u,"name",{value:"Grid"}),kn(_u,"Grid"),kn(Pr,"Color"),kn(Error,"Error"),kn(ro,"Formatted"),kn(Zo,"FormattedSection"),kn(Zi,"AJAXError"),kn(No,"ResolvedImage"),kn(xf,"StylePropertyFunction"),kn(sd,"StyleExpression",{omit:["_evaluator"]}),kn(yc,"ZoomDependentExpression"),kn(Al,"ZoomConstantExpression"),kn(wa,"CompoundExpression",{omit:["_evaluate"]});for(const u in Xi)xc[Xi[u]._classRegistryKey]||kn(Xi[u],`Expression${u}`);function Ns(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Zu(u){return self.ImageBitmap&&u instanceof ImageBitmap}function js(u,n){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(Ns(u)||Zu(u))return n&&n.add(u),u;if(ArrayBuffer.isView(u)){const s=u;return n&&n.add(s.buffer),s}if(u instanceof ImageData)return n&&n.add(u.data.buffer),u;if(Array.isArray(u)){const s=[];for(const c of u)s.push(js(c,n));return s}if(u instanceof Map){const s={$name:"Map"};for(const[c,m]of u.entries())s[c]=js(m);return s}if(u instanceof Set){const s={$name:"Set"};let c=0;for(const m of u.values())s[++c]=js(m);return s}if(typeof u=="object"){const s=u.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const m=s.serialize?s.serialize(u,n):{};if(!s.serialize){for(const f in u)u.hasOwnProperty(f)&&(xc[c].omit.indexOf(f)>=0||(m[f]=js(u[f],n)));u instanceof Error&&(m.message=u.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(m.$name=c),m}throw new Error("can't serialize object of type "+typeof u)}function Sa(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||Ns(u)||Zu(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Sa);if(typeof u=="object"){const n=u.$name||"Object";if(n==="Map"){const m=new Map;for(const f of Object.keys(u))f!=="$name"&&m.set(f,Sa(u[f]));return m}if(n==="Set"){const m=new Set;for(const f of Object.keys(u))f!=="$name"&&m.add(Sa(u[f]));return m}const{klass:s}=xc[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(u);const c=Object.create(s.prototype);for(const m of Object.keys(u))m!=="$name"&&(c[m]=Sa(u[m]));return c}throw new Error("can't deserialize object of type "+typeof u)}const Jn={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function ud(u){for(const n of u)if(rs(n.charCodeAt(0)))return!0;return!1}function cd(u){for(const n of u)if(!np(n.charCodeAt(0)))return!1;return!0}function np(u){return!(Jn.Arabic(u)||Jn["Arabic Supplement"](u)||Jn["Arabic Extended-A"](u)||Jn["Arabic Presentation Forms-A"](u)||Jn["Arabic Presentation Forms-B"](u))}function rs(u){return!(u!==746&&u!==747&&(u<4352||!(Jn["Bopomofo Extended"](u)||Jn.Bopomofo(u)||Jn["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Jn["CJK Compatibility Ideographs"](u)||Jn["CJK Compatibility"](u)||Jn["CJK Radicals Supplement"](u)||Jn["CJK Strokes"](u)||!(!Jn["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Jn["CJK Unified Ideographs Extension A"](u)||Jn["CJK Unified Ideographs"](u)||Jn["Enclosed CJK Letters and Months"](u)||Jn["Hangul Compatibility Jamo"](u)||Jn["Hangul Jamo Extended-A"](u)||Jn["Hangul Jamo Extended-B"](u)||Jn["Hangul Jamo"](u)||Jn["Hangul Syllables"](u)||Jn.Hiragana(u)||Jn["Ideographic Description Characters"](u)||Jn.Kanbun(u)||Jn["Kangxi Radicals"](u)||Jn["Katakana Phonetic Extensions"](u)||Jn.Katakana(u)&&u!==12540||!(!Jn["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Jn["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Jn["Unified Canadian Aboriginal Syllabics"](u)||Jn["Unified Canadian Aboriginal Syllabics Extended"](u)||Jn["Vertical Forms"](u)||Jn["Yijing Hexagram Symbols"](u)||Jn["Yi Syllables"](u)||Jn["Yi Radicals"](u))))}function $s(u){return!(rs(u)||function(n){return!!(Jn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Jn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Jn["Letterlike Symbols"](n)||Jn["Number Forms"](n)||Jn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Jn["Control Pictures"](n)&&n!==9251||Jn["Optical Character Recognition"](n)||Jn["Enclosed Alphanumerics"](n)||Jn["Geometric Shapes"](n)||Jn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Jn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Jn["CJK Symbols and Punctuation"](n)||Jn.Katakana(n)||Jn["Private Use Area"](n)||Jn["CJK Compatibility Forms"](n)||Jn["Small Form Variants"](n)||Jn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(u))}function Co(u){return u>=1424&&u<=2303||Jn["Arabic Presentation Forms-A"](u)||Jn["Arabic Presentation Forms-B"](u)}function Pl(u,n){return!(!n&&Co(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Jn.Khmer(u))}function lm(u){for(const n of u)if(Co(n.charCodeAt(0)))return!0;return!1}const hd="deferred",uh="loading",ch="loaded";let bf=null,$a="unavailable",rl=null;const hh=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&($a="error"),bf&&bf(u)};function wf(){rp.fire(new Gn("pluginStateChange",{pluginStatus:$a,pluginURL:rl}))}const rp=new So,fh=function(){return $a},Sf=function(){if($a!==hd||!rl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");$a=uh,wf(),rl&&xa({url:rl},u=>{u?hh(u):($a=ch,wf())})},il={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>$a===ch||il.applyArabicShaping!=null,isLoading:()=>$a===uh,setState(u){$a=u.pluginStatus,rl=u.pluginURL},isParsed:()=>il.applyArabicShaping!=null&&il.processBidirectionalText!=null&&il.processStyledBidirectionalText!=null,getPluginURL:()=>rl};class Po{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,c){for(const m of s)if(!Pl(m.charCodeAt(0),c))return!1;return!0}(n,il.isLoaded())}}class Xu{constructor(n,s,c,m){this.property=n,this.value=s,this.expression=function(f,g,E,O){if(mu(f))return new xf(f,g);if(ah(f)||Array.isArray(f)&&f.length>0){const D=Wu(f,g,E,O);if(D.result==="error")throw new Error(D.value.map(w=>`${w.key}: ${w.message}`).join(", "));return D.value}{let D=f;return typeof f=="string"&&g.type==="color"&&(D=Pr.parse(f)),{kind:"constant",configDependencies:new Set,evaluate:()=>D}}}(s===void 0?n.specification.default:s,n.specification,c,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,c){return this.property.possiblyEvaluate(this,n,s,c)}}class fd{constructor(n,s,c){this.property=n,this.value=new Xu(n,void 0,s,c)}transitioned(n,s){return new Ef(this.property,this.value,s,Fi({},n.transition,this.transition),n.now)}untransitioned(){return new Ef(this.property,this.value,null,{},0)}}class Tf{constructor(n,s,c){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=c,this.configDependencies=new Set}getValue(n){return Go(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new fd(this._values[n].property,this._scope,this._options)),this._values[n].value=new Xu(this._values[n].property,s===null?void 0:Go(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const c=this._properties.properties;if(n)for(const m in n){const f=n[m];if(so(m,"-transition")){const g=m.slice(0,-11);c[g]&&this.setTransition(g,f)}else c.hasOwnProperty(m)&&this.setValue(m,f)}}getTransition(n){return Go(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new fd(this._values[n].property)),this._values[n].transition=Go(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c);const m=this.getTransition(s);m!==void 0&&(n[`${s}-transition`]=m)}return n}transitioned(n,s){const c=new dh(this._properties);for(const m of Object.keys(this._values))c._values[m]=this._values[m].transitioned(n,s._values[m]);return c}untransitioned(){const n=new dh(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Ef{constructor(n,s,c,m,f){const g=m.delay||0,E=m.duration||0;f=f||0,this.property=n,this.value=s,this.begin=f+g,this.end=this.begin+E,n.specification.transition&&(m.delay||m.duration)&&(this.prior=c)}possiblyEvaluate(n,s,c){const m=n.now||0,f=this.value.possiblyEvaluate(n,s,c),g=this.prior;if(g){if(m>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(m<this.begin)return g.possiblyEvaluate(n,s,c);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(n,s,c),f,ii(E))}}return f}}class dh{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,c){const m=new wc(this._properties);for(const f of Object.keys(this._values))m._values[f]=this._values[f].possiblyEvaluate(n,s,c);return m}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ip{constructor(n,s,c){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=c,this.configDependencies=new Set}getValue(n){return Go(this._values[n].value)}setValue(n,s){this._values[n]=new Xu(this._values[n].property,s===null?void 0:Go(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c)}return n}possiblyEvaluate(n,s,c){const m=new wc(this._properties);for(const f of Object.keys(this._values))m._values[f]=this._values[f].possiblyEvaluate(n,s,c);return m}}class bc{constructor(n,s,c){this.property=n,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,c,m){return this.property.evaluate(this.value,this.parameters,n,s,c,m)}}class wc{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class vn{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,c){const m=ba[this.specification.type];return m?m(n,s,c):n}}class tr{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,c,m){return new bc(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},c,m)}:n.expression,s)}interpolate(n,s,c){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new bc(this,{kind:"constant",value:void 0},n.parameters);const m=ba[this.specification.type];return m?new bc(this,{kind:"constant",value:m(n.value.value,s.value.value,c)},n.parameters):n}evaluate(n,s,c,m,f,g){return n.kind==="constant"?n.value:n.evaluate(s,c,m,f,g)}}class ps{constructor(n){this.specification=n}possiblyEvaluate(n,s,c,m){return!!n.expression.evaluate(s,null,{},c,m)}interpolate(){return!1}}class Ni{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Po(0,{});for(const c in n){const m=n[c];m.specification.overridable&&this.overridableProperties.push(c);const f=this.defaultPropertyValues[c]=new Xu(m,void 0),g=this.defaultTransitionablePropertyValues[c]=new fd(m);this.defaultTransitioningPropertyValues[c]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=f.possiblyEvaluate(s)}}}kn(tr,"DataDrivenProperty"),kn(vn,"DataConstantProperty"),kn(ps,"ColorRampProperty");var Et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,90],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"rain":{"density":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"centerThinning":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function dd(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Us(u){if(Array.isArray(u))return u.map(Us);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const n={};for(const s in u)n[s]=Us(u[s]);return n}return dd(u)}function yu(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const n of u.slice(1))if(!yu(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function Vh(u,n="",s=null,c="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};yu(u)||(u=Pf(u));const m=u;let f=!0;try{f=function(w){if(!is(w))return w;let C=Us(w);return Yl(C),C=vu(C),C}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let g=null,E=null;if(c!=="background"&&c!=="sky"&&c!=="slot"){E=Et[`filter_${c}`];const w=sh(f,E,n,s);if(w.result==="error")throw new Error(w.value.map(C=>`${C.key}: ${C.message}`).join(", "));g=(C,R,P)=>w.value.evaluate(C,R,{},P)}let O=null,D=null;if(f!==m){const w=sh(m,E,n,s);if(w.result==="error")throw new Error(w.value.map(C=>`${C.key}: ${C.message}`).join(", "));O=(C,R,P,k,N)=>w.value.evaluate(C,R,{},P,void 0,void 0,k,N),D=!fc(w.value.expression)}return{filter:g,dynamicFilter:O||void 0,needGeometry:Af(f),needFeature:!!D}}function vu(u){if(!Array.isArray(u))return u;const n=function(s){if(pd.has(s[0])){for(let c=1;c<s.length;c++)if(is(s[c]))return!0}return s}(u);return n===!0?n:n.map(s=>vu(s))}function Yl(u){let n=!1;const s=[];if(u[0]==="case"){for(let c=1;c<u.length-1;c+=2)n=n||is(u[c]),s.push(u[c+1]);s.push(u[u.length-1])}else if(u[0]==="match"){n=n||is(u[1]);for(let c=2;c<u.length-1;c+=2)s.push(u[c+1]);s.push(u[u.length-1])}else if(u[0]==="step"){n=n||is(u[1]);for(let c=1;c<u.length-1;c+=2)s.push(u[c+1])}n&&(u.length=0,u.push("any",...s));for(let c=1;c<u.length;c++)Yl(u[c])}function is(u){if(!Array.isArray(u))return!1;if((n=u[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<u.length;s++)if(is(u[s]))return!0;return!1}const pd=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function um(u,n){return u<n?-1:u>n?1:0}function Af(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let n=1;n<u.length;n++)if(Af(u[n]))return!0;return!1}function Pf(u){if(!u)return!0;const n=u[0];return u.length<=1?n!=="any":n==="=="?ph(u[1],u[2],"=="):n==="!="?Jl(ph(u[1],u[2],"==")):n==="<"||n===">"||n==="<="||n===">="?ph(u[1],u[2],n):n==="any"?(s=u.slice(1),["any"].concat(s.map(Pf))):n==="all"?["all"].concat(u.slice(1).map(Pf)):n==="none"?["all"].concat(u.slice(1).map(Pf).map(Jl)):n==="in"?Ml(u[1],u.slice(2)):n==="!in"?Jl(Ml(u[1],u.slice(2))):n==="has"?Sc(u[1]):n!=="!has"||Jl(Sc(u[1]));var s}function ph(u,n,s){switch(u){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,u,n]}}function Ml(u,n){if(n.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",u,["literal",n.sort(um)]]:["filter-in-small",u,["literal",n]]}}function Sc(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Jl(u){return["!",u]}const Ql="";function qh(u,n){return n?`${u}${Ql}${n}`:u}const mh="-transition",eu=new Set(["fill","line","background","hillshade","raster"]);class ms extends So{constructor(n,s,c,m,f){if(super(),this.id=n.id,this.fqid=qh(this.id,c),this.type=n.type,this.scope=c,this.lut=m,this.options=f,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const g=sh(this.filter,Et[`filter_${n.type}`]);g.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...g.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new ip(s.layout,this.scope,f),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new Tf(s.paint,this.scope,f);for(const g in n.paint)this.setPaintProperty(g,n.paint[g]);for(const g in n.layout)this.setLayoutProperty(g,n.layout[g]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new wc(s.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&eu.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const c=this._unevaluatedLayout;c._properties.properties[n]&&(c.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return so(n,mh)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const c=this._transitionablePaint,m=c._properties.properties;if(so(n,mh)){const C=n.slice(0,-11);return m[C]&&c.setTransition(C,s||void 0),!1}if(!m[n])return!1;const f=c._values[n],g=f.value.isDataDriven(),E=f.value;c.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const O=c._values[n].value,D=O.isDataDriven(),w=so(n,"pattern")||n==="line-dasharray";return D||g||w||this._handleOverridablePaintPropertyUpdate(n,E,O)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,c){return null}_handleOverridablePaintPropertyUpdate(n,s,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return es({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof bc&&El(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=Vh(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,c,m,f,g,E,O,D){}queryIntersectsMatchingFeature(n,s,c,m){}}const oa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Tc{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ki{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ti(u,n=1){let s=0,c=0;return{members:u.map(m=>{const f=oa[m.type].BYTES_PER_ELEMENT,g=s=Mf(s,Math.max(n,f)),E=m.components||1;return c=Math.max(c,f),s+=f*E,{name:m.name,type:m.type,components:E,offset:g}}),size:Mf(s,Math.max(c,n)),alignment:n}}function Mf(u,n){return Math.ceil(u/n)*n}class xu extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const m=2*n;return this.int16[m+0]=s,this.int16[m+1]=c,n}}xu.prototype.bytesPerElement=4,kn(xu,"StructArrayLayout2i4");class bu extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,c)}emplace(n,s,c,m){const f=3*n;return this.int16[f+0]=s,this.int16[f+1]=c,this.int16[f+2]=m,n}}bu.prototype.bytesPerElement=6,kn(bu,"StructArrayLayout3i6");class Oo extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,m){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,m)}emplace(n,s,c,m,f){const g=4*n;return this.int16[g+0]=s,this.int16[g+1]=c,this.int16[g+2]=m,this.int16[g+3]=f,n}}Oo.prototype.bytesPerElement=8,kn(Oo,"StructArrayLayout4i8");class ka extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,m,f)}emplace(n,s,c,m,f,g){const E=5*n;return this.int16[E+0]=s,this.int16[E+1]=c,this.int16[E+2]=m,this.int16[E+3]=f,this.int16[E+4]=g,n}}ka.prototype.bytesPerElement=10,kn(ka,"StructArrayLayout5i10");class Ta extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,c,m,f,g,E)}emplace(n,s,c,m,f,g,E,O){const D=6*n,w=12*n,C=3*n;return this.int16[D+0]=s,this.int16[D+1]=c,this.uint8[w+4]=m,this.uint8[w+5]=f,this.uint8[w+6]=g,this.uint8[w+7]=E,this.float32[C+2]=O,n}}Ta.prototype.bytesPerElement=12,kn(Ta,"StructArrayLayout2i4ub1f12");class Il extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,m)}emplace(n,s,c,m,f){const g=4*n;return this.float32[g+0]=s,this.float32[g+1]=c,this.float32[g+2]=m,this.float32[g+3]=f,n}}Il.prototype.bytesPerElement=16,kn(Il,"StructArrayLayout4f16");class Cl extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,c)}emplace(n,s,c,m){const f=3*n;return this.float32[f+0]=s,this.float32[f+1]=c,this.float32[f+2]=m,n}}Cl.prototype.bytesPerElement=12,kn(Cl,"StructArrayLayout3f12");class ml extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,m,f)}emplace(n,s,c,m,f,g){const E=6*n,O=3*n;return this.uint16[E+0]=s,this.uint16[E+1]=c,this.uint16[E+2]=m,this.uint16[E+3]=f,this.float32[O+2]=g,n}}ml.prototype.bytesPerElement=12,kn(ml,"StructArrayLayout4ui1f12");class md extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,m){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,m)}emplace(n,s,c,m,f){const g=4*n;return this.uint16[g+0]=s,this.uint16[g+1]=c,this.uint16[g+2]=m,this.uint16[g+3]=f,n}}md.prototype.bytesPerElement=8,kn(md,"StructArrayLayout4ui8");class Ua extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,m,f,g)}emplace(n,s,c,m,f,g,E){const O=6*n;return this.int16[O+0]=s,this.int16[O+1]=c,this.int16[O+2]=m,this.int16[O+3]=f,this.int16[O+4]=g,this.int16[O+5]=E,n}}Ua.prototype.bytesPerElement=12,kn(Ua,"StructArrayLayout6i12");class Ec extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D,w,C,R){const P=this.length;return this.resize(P+1),this.emplace(P,n,s,c,m,f,g,E,O,D,w,C,R)}emplace(n,s,c,m,f,g,E,O,D,w,C,R,P){const k=12*n;return this.int16[k+0]=s,this.int16[k+1]=c,this.int16[k+2]=m,this.int16[k+3]=f,this.uint16[k+4]=g,this.uint16[k+5]=E,this.uint16[k+6]=O,this.uint16[k+7]=D,this.int16[k+8]=w,this.int16[k+9]=C,this.int16[k+10]=R,this.int16[k+11]=P,n}}Ec.prototype.bytesPerElement=24,kn(Ec,"StructArrayLayout4i4ui4i24");class If extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,m,f,g)}emplace(n,s,c,m,f,g,E){const O=10*n,D=5*n;return this.int16[O+0]=s,this.int16[O+1]=c,this.int16[O+2]=m,this.float32[D+2]=f,this.float32[D+3]=g,this.float32[D+4]=E,n}}If.prototype.bytesPerElement=20,kn(If,"StructArrayLayout3i3f20");class Cf extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}Cf.prototype.bytesPerElement=4,kn(Cf,"StructArrayLayout1ul4");class gs extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const m=2*n;return this.uint16[m+0]=s,this.uint16[m+1]=c,n}}gs.prototype.bytesPerElement=4,kn(gs,"StructArrayLayout2ui4");class ol extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D,w,C,R,P){const k=this.length;return this.resize(k+1),this.emplace(k,n,s,c,m,f,g,E,O,D,w,C,R,P)}emplace(n,s,c,m,f,g,E,O,D,w,C,R,P,k){const N=20*n,W=10*n;return this.int16[N+0]=s,this.int16[N+1]=c,this.int16[N+2]=m,this.int16[N+3]=f,this.int16[N+4]=g,this.float32[W+3]=E,this.float32[W+4]=O,this.float32[W+5]=D,this.float32[W+6]=w,this.int16[N+14]=C,this.uint32[W+8]=R,this.uint16[N+18]=P,this.uint16[N+19]=k,n}}ol.prototype.bytesPerElement=40,kn(ol,"StructArrayLayout5i4f1i1ul2ui40");class Ac extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,c,m,f,g,E)}emplace(n,s,c,m,f,g,E,O){const D=8*n;return this.int16[D+0]=s,this.int16[D+1]=c,this.int16[D+2]=m,this.int16[D+4]=f,this.int16[D+5]=g,this.int16[D+6]=E,this.int16[D+7]=O,n}}Ac.prototype.bytesPerElement=16,kn(Ac,"StructArrayLayout3i2i2i16");class Pc extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,m,f)}emplace(n,s,c,m,f,g){const E=4*n,O=8*n;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=m,this.int16[O+6]=f,this.int16[O+7]=g,n}}Pc.prototype.bytesPerElement=16,kn(Pc,"StructArrayLayout2f1f2i16");class Mc extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,m,f,g)}emplace(n,s,c,m,f,g,E){const O=20*n,D=5*n;return this.uint8[O+0]=s,this.uint8[O+1]=c,this.float32[D+1]=m,this.float32[D+2]=f,this.float32[D+3]=g,this.float32[D+4]=E,n}}Mc.prototype.bytesPerElement=20,kn(Mc,"StructArrayLayout2ub4f20");class po extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,c)}emplace(n,s,c,m){const f=3*n;return this.uint16[f+0]=s,this.uint16[f+1]=c,this.uint16[f+2]=m,n}}po.prototype.bytesPerElement=6,kn(po,"StructArrayLayout3ui6");class gh extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X,ee,ne,J,he){const ye=this.length;return this.resize(ye+1),this.emplace(ye,n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X,ee,ne,J,he)}emplace(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X,ee,ne,J,he,ye){const Me=30*n,Ve=15*n,Ne=60*n;return this.int16[Me+0]=s,this.int16[Me+1]=c,this.int16[Me+2]=m,this.float32[Ve+2]=f,this.float32[Ve+3]=g,this.uint16[Me+8]=E,this.uint16[Me+9]=O,this.uint32[Ve+5]=D,this.uint32[Ve+6]=w,this.uint32[Ve+7]=C,this.uint16[Me+16]=R,this.uint16[Me+17]=P,this.uint16[Me+18]=k,this.float32[Ve+10]=N,this.float32[Ve+11]=W,this.uint8[Ne+48]=X,this.uint8[Ne+49]=ee,this.uint8[Ne+50]=ne,this.uint32[Ve+13]=J,this.int16[Me+28]=he,this.uint8[Ne+58]=ye,n}}gh.prototype.bytesPerElement=60,kn(gh,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class gd extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne,$e,ot,je,nt,ct,ht,_t){const At=this.length;return this.resize(At+1),this.emplace(At,n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne,$e,ot,je,nt,ct,ht,_t)}emplace(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X,ee,ne,J,he,ye,Me,Ve,Ne,$e,ot,je,nt,ct,ht,_t,At){const It=20*n,wt=40*n,Xt=80*n;return this.float32[It+0]=s,this.float32[It+1]=c,this.int16[wt+4]=m,this.int16[wt+5]=f,this.int16[wt+6]=g,this.int16[wt+7]=E,this.int16[wt+8]=O,this.int16[wt+9]=D,this.int16[wt+10]=w,this.int16[wt+11]=C,this.int16[wt+12]=R,this.uint16[wt+13]=P,this.uint16[wt+14]=k,this.uint16[wt+15]=N,this.uint16[wt+16]=W,this.uint16[wt+17]=X,this.uint16[wt+18]=ee,this.uint16[wt+19]=ne,this.uint16[wt+20]=J,this.uint16[wt+21]=he,this.uint16[wt+22]=ye,this.uint16[wt+23]=Me,this.uint16[wt+24]=Ve,this.uint16[wt+25]=Ne,this.uint16[wt+26]=$e,this.uint16[wt+27]=ot,this.uint32[It+14]=je,this.float32[It+15]=nt,this.float32[It+16]=ct,this.float32[It+17]=ht,this.float32[It+18]=_t,this.uint8[Xt+76]=At,n}}gd.prototype.bytesPerElement=80,kn(gd,"StructArrayLayout2f9i15ui1ul4f1ub80");class _h extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}_h.prototype.bytesPerElement=4,kn(_h,"StructArrayLayout1f4");class Ic extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c,m,f)}emplace(n,s,c,m,f,g){const E=5*n;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=m,this.float32[E+3]=f,this.float32[E+4]=g,n}}Ic.prototype.bytesPerElement=20,kn(Ic,"StructArrayLayout5f20");class _d extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,c,m,f,g,E)}emplace(n,s,c,m,f,g,E,O){const D=7*n;return this.float32[D+0]=s,this.float32[D+1]=c,this.float32[D+2]=m,this.float32[D+3]=f,this.float32[D+4]=g,this.float32[D+5]=E,this.float32[D+6]=O,n}}_d.prototype.bytesPerElement=28,kn(_d,"StructArrayLayout7f28");class Of extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D,w,C){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,c,m,f,g,E,O,D,w,C)}emplace(n,s,c,m,f,g,E,O,D,w,C,R){const P=11*n;return this.float32[P+0]=s,this.float32[P+1]=c,this.float32[P+2]=m,this.float32[P+3]=f,this.float32[P+4]=g,this.float32[P+5]=E,this.float32[P+6]=O,this.float32[P+7]=D,this.float32[P+8]=w,this.float32[P+9]=C,this.float32[P+10]=R,n}}Of.prototype.bytesPerElement=44,kn(Of,"StructArrayLayout11f44");class op extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,m,f,g,E,O,D)}emplace(n,s,c,m,f,g,E,O,D,w){const C=9*n;return this.float32[C+0]=s,this.float32[C+1]=c,this.float32[C+2]=m,this.float32[C+3]=f,this.float32[C+4]=g,this.float32[C+5]=E,this.float32[C+6]=O,this.float32[C+7]=D,this.float32[C+8]=w,n}}op.prototype.bytesPerElement=36,kn(op,"StructArrayLayout9f36");class Ku extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,m){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,m)}emplace(n,s,c,m,f){const g=6*n;return this.uint32[3*n+0]=s,this.uint16[g+2]=c,this.uint16[g+3]=m,this.uint16[g+4]=f,n}}Ku.prototype.bytesPerElement=12,kn(Ku,"StructArrayLayout1ul3ui12");class yd extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}yd.prototype.bytesPerElement=2,kn(yd,"StructArrayLayout1ui2");class Cc extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const m=2*n;return this.float32[m+0]=s,this.float32[m+1]=c,n}}Cc.prototype.bytesPerElement=8,kn(Cc,"StructArrayLayout2f8");class Oc extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W){const X=this.length;return this.resize(X+1),this.emplace(X,n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W)}emplace(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X){const ee=16*n;return this.float32[ee+0]=s,this.float32[ee+1]=c,this.float32[ee+2]=m,this.float32[ee+3]=f,this.float32[ee+4]=g,this.float32[ee+5]=E,this.float32[ee+6]=O,this.float32[ee+7]=D,this.float32[ee+8]=w,this.float32[ee+9]=C,this.float32[ee+10]=R,this.float32[ee+11]=P,this.float32[ee+12]=k,this.float32[ee+13]=N,this.float32[ee+14]=W,this.float32[ee+15]=X,n}}Oc.prototype.bytesPerElement=64,kn(Oc,"StructArrayLayout16f64");class kf extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,m,f,g,E){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,c,m,f,g,E)}emplace(n,s,c,m,f,g,E,O){const D=10*n,w=5*n;return this.uint16[D+0]=s,this.uint16[D+1]=c,this.uint16[D+2]=m,this.uint16[D+3]=f,this.float32[w+2]=g,this.float32[w+3]=E,this.float32[w+4]=O,n}}kf.prototype.bytesPerElement=20,kn(kf,"StructArrayLayout4ui3f20");class Gh extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}Gh.prototype.bytesPerElement=2,kn(Gh,"StructArrayLayout1i2");class Rf extends Ki{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}Rf.prototype.bytesPerElement=1,kn(Rf,"StructArrayLayout1ub1");class ap extends Tc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ap.prototype.size=40;class Lf extends ol{get(n){return new ap(this,n)}}kn(Lf,"CollisionBoxArray");class Hh extends Tc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Hh.prototype.size=60;class Df extends gh{get(n){return new Hh(this,n)}}kn(Df,"PlacedSymbolArray");class sp extends Tc{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}sp.prototype.size=80;class vd extends gd{get(n){return new sp(this,n)}}kn(vd,"SymbolInstanceArray");class lp extends _h{getoffsetX(n){return this.float32[1*n+0]}}kn(lp,"GlyphOffsetArray");class xd extends xu{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}kn(xd,"SymbolLineVertexArray");class up extends Tc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}up.prototype.size=12;class cm extends Ku{get(n){return new up(this,n)}}kn(cm,"FeatureIndexArray");class hm extends gs{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}kn(hm,"FillExtrusionCentroidArray");class cp extends Tc{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}cp.prototype.size=6;class bd extends bu{get(n){return new cp(this,n)}}kn(bd,"FillExtrusionWallArray");const fm=Ti([{name:"a_pos",components:2,type:"Int16"}],4),wd=Ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class $o{constructor(n=[]){this.segments=n}_prepareSegment(n,s,c,m){let f=this.segments[this.segments.length-1];return n>$o.MAX_VERTEX_ARRAY_LENGTH&&Er(`Max vertices per segment is ${$o.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!f||f.vertexLength+n>$o.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==m)&&(f={vertexOffset:s,primitiveOffset:c,vertexLength:0,primitiveLength:0},m!==void 0&&(f.sortKey=m),this.segments.push(f)),f}prepareSegment(n,s,c,m){return this._prepareSegment(n,s.length,c.length,m)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,c,m){return new $o([{vertexOffset:n,primitiveOffset:s,vertexLength:c,primitiveLength:m,vaos:{},sortKey:0}])}}function dm(u,n){return 256*(u=lr(Math.floor(u),0,255))+lr(Math.floor(n),0,255)}$o.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kn($o,"SegmentVector");const $g=Ti([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),tu=Ti([{name:"a_dash",components:4,type:"Uint16"}]);class yh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,c,m){this.ids.push(zf(n)),this.positions.push(s,c,m)}eachPosition(n,s){const c=zf(n);let m=0,f=this.ids.length-1;for(;m<f;){const g=m+f>>1;this.ids[g]>=c?f=g:m=g+1}for(;this.ids[m]===c;)s(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(n,s){const c=new Float64Array(n.ids),m=new Uint32Array(n.positions);return vh(c,m,0,c.length-1),s&&(s.add(c.buffer),s.add(m.buffer)),{ids:c,positions:m}}static deserialize(n){const s=new yh;let c;s.ids=n.ids,s.positions=n.positions;for(const m of s.ids)m!==c&&s.uniqueIds.push(m),c=m;return s.indexed=!0,s}}function zf(u){const n=+u;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:Cn(String(u))}function vh(u,n,s,c){for(;s<c;){const m=u[s+c>>1];let f=s-1,g=c+1;for(;;){do f++;while(u[f]<m);do g--;while(u[g]>m);if(f>=g)break;Ff(u,f,g),Ff(n,3*f,3*g),Ff(n,3*f+1,3*g+1),Ff(n,3*f+2,3*g+2)}g-s<c-g?(vh(u,n,s,g),s=g+1):(vh(u,n,g+1,c),c=g)}}function Ff(u,n,s){const c=u[n];u[n]=u[s],u[s]=c}kn(yh,"FeaturePositionMap");class wu{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Yu extends wu{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class Uo extends wu{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Ol extends wu{constructor(n){super(n),this.current=[0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class Bf extends wu{constructor(n){super(n),this.current=[0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class Sd extends wu{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class Td extends wu{constructor(n){super(n),this.current=Pr.transparent.toRenderColor(null)}set(n,s,c){this.fetchUniformLocation(n,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const hp=new Float32Array(16);class Wh extends wu{constructor(n){super(n),this.current=hp}set(n,s,c){if(this.fetchUniformLocation(n,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let m=1;m<16;m++)if(c[m]!==this.current[m]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const pm=new Float32Array(9),fp=new Float32Array(4);class Ed extends wu{constructor(n){super(n),this.current=fp}set(n,s,c){if(this.fetchUniformLocation(n,s)){for(let m=0;m<4;m++)if(c[m]!==this.current[m]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function As(u){return[dm(255*u.r,255*u.g),dm(255*u.b,255*u.a)]}class Ka{constructor(n,s,c,m){this.value=n,this.uniformNames=s.map(f=>`u_${f}`),this.type=c,this.context=m}setUniform(n,s,c,m,f){const g=m.constantOr(this.value);s.set(n,f,g instanceof Pr?g.toRenderColor(this.context.lut):g)}getBinding(n,s){return this.type==="color"?new Td(n):new Uo(n)}}class xh{constructor(n,s){this.uniformNames=s.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,c,m,f){const g=f==="u_pattern"||f==="u_dash"?this.pattern:f==="u_pixel_ratio"?this.pixelRatio:null;g&&s.set(n,f,g)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new Sd(n):new Uo(n)}}class Su{constructor(n,s,c,m){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(f=>({name:`a_${f}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(n,s,c,m,f,g,E){const O=this.paintVertexArray.length,D=this.expression.evaluate(new Po(0,{brightness:g}),s,{},f,m,E);this.paintVertexArray.resize(n),this._setPaintValue(O,n,D,this.context)}updatePaintArray(n,s,c,m,f,g,E){const O=this.expression.evaluate({zoom:0,brightness:E},c,m,void 0,f);this._setPaintValue(n,s,O,this.context)}_setPaintValue(n,s,c,m){if(this.type==="color"){const f=As(c.toRenderColor(m.lut));for(let g=n;g<s;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=n;f<s;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class kl{constructor(n,s,c,m,f,g){this.expression=n,this.uniformNames=s.map(E=>`u_${E}_t`),this.type=c,this.useIntegerZoom=m,this.context=f,this.maxValue=0,this.paintVertexAttributes=s.map(E=>({name:`a_${E}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,s,c,m,f,g,E){const O=this.expression.evaluate(new Po(this.context.zoom,{brightness:g}),s,{},f,m,E),D=this.expression.evaluate(new Po(this.context.zoom+1,{brightness:g}),s,{},f,m,E),w=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(w,n,O,D,this.context)}updatePaintArray(n,s,c,m,f,g,E){const O=this.expression.evaluate({zoom:this.context.zoom,brightness:E},c,m,void 0,f),D=this.expression.evaluate({zoom:this.context.zoom+1,brightness:E},c,m,void 0,f);this._setPaintValue(n,s,O,D,this.context)}_setPaintValue(n,s,c,m,f){if(this.type==="color"){const g=As(c.toRenderColor(f.lut)),E=As(c.toRenderColor(f.lut));for(let O=n;O<s;O++)this.paintVertexArray.emplace(O,g[0],g[1],E[0],E[1])}else{for(let g=n;g<s;g++)this.paintVertexArray.emplace(g,c,m);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,c,m,f){const g=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,E=lr(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);s.set(n,f,E)}getBinding(n,s){return new Uo(n)}}class Tu{constructor(n,s,c,m,f){this.expression=n,this.layerId=f,this.paintVertexAttributes=(c==="array"?tu:$g).members;for(let g=0;g<s.length;++g);this.paintVertexArray=new m}populatePaintArray(n,s,c,m){const f=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(f,n,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(n,s,c,m,f,g,E){this._setPaintValues(n,s,c.patterns&&c.patterns[this.layerId],g)}_setPaintValues(n,s,c,m){if(!m||!c)return;const f=m[c];if(!f)return;const{tl:g,br:E,pixelRatio:O}=f;for(let D=n;D<s;D++)this.paintVertexArray.emplace(D,g[0],g[1],E[0],E[1],O)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Eu{constructor(n,s,c=()=>!0){this.binders={},this._buffers=[],this.context=s;const m=[];for(const f in n.paint._values){const g=n.paint.get(f);if(!c(f)||!(g instanceof bc&&El(g.property.specification)))continue;const E=dp(f,n.type),O=g.value,D=g.property.specification.type,w=!!g.property.useIntegerZoom,C=f==="line-dasharray"||f.endsWith("pattern"),R=f==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(O.kind!=="constant"||R)if(O.kind==="source"||R||C){const P=Ad(f,D,"source");this.binders[f]=C?new Tu(O,E,D,P,n.id):new Su(O,E,D,P),m.push(`/a_${f}`)}else{const P=Ad(f,D,"composite");this.binders[f]=new kl(O,E,D,w,s,P),m.push(`/z_${f}`)}else this.binders[f]=C?new xh(O.value,E):new Ka(O.value,E,D,s),m.push(`/u_${f}`)}this.cacheKey=m.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Su||s instanceof kl?s.maxValue:0}populatePaintArrays(n,s,c,m,f,g,E){for(const O in this.binders){const D=this.binders[O];D.context=this.context,(D instanceof Su||D instanceof kl||D instanceof Tu)&&D.populatePaintArray(n,s,c,m,f,g,E)}}setConstantPatternPositions(n){for(const s in this.binders){const c=this.binders[s];c instanceof xh&&c.setConstantPatternPositions(n)}}updatePaintArrays(n,s,c,m,f,g,E,O){let D=!1;const w=Object.keys(n),C=w.length!==0,R=C?w:s.uniqueIds;this.context.lut=f.lut;for(const P in this.binders){const k=this.binders[P];if(k.context=this.context,(k instanceof Su||k instanceof kl||k instanceof Tu)&&(k.expression.isStateDependent===!0||k.expression.isLightConstant===!1)){const N=f.paint.get(P);k.expression=N.value;for(const W of R){const X=n[W.toString()];s.eachPosition(W,(ee,ne,J)=>{const he=m.feature(ee);k.updatePaintArray(ne,J,he,X,g,E,O)})}if(!C)for(const W of c.uniqueIds){const X=n[W.toString()];c.eachPosition(W,(ee,ne,J)=>{const he=m.feature(ee);k.updatePaintArray(ne,J,he,X,g,E,O)})}D=!0}}return D}defines(){const n=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Ka||c instanceof xh)&&n.push(...c.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Su||c instanceof kl||c instanceof Tu)for(let m=0;m<c.paintVertexAttributes.length;m++)n.push(c.paintVertexAttributes[m].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Ka||c instanceof xh||c instanceof kl)for(const m of c.uniformNames)n.push(m)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof Ka||m instanceof xh||m instanceof kl)for(const f of m.uniformNames)s.push({name:f,property:c,binding:m.getBinding(n,f)})}return s}setUniforms(n,s,c,m,f){for(const{name:g,property:E,binding:O}of c)this.binders[E].setUniform(n,O,f,m.get(E),g)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Su||s instanceof kl||s instanceof Tu)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const c=this.binders[s];(c instanceof Su||c instanceof kl||c instanceof Tu)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Su||s instanceof kl||s instanceof Tu)&&s.destroy()}}}class Rl{constructor(n,s,c=()=>!0){this.programConfigurations={};for(const m of n)this.programConfigurations[m.id]=new Eu(m,s,c);this.needsUpload=!1,this._featureMap=new yh,this._featureMapWithoutIds=new yh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,c,m,f,g,E,O){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(n,s,m,f,g,E,O);s.id!==void 0?this._featureMap.add(s.id,c,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,c,m,f,g){for(const E of c)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,E,m,f,g||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const mm={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function dp(u,n){return mm[u]||[u.replace(`${n}-`,"").replace(/-/g,"_")]}const gm={"line-pattern":{source:ml,composite:ml},"fill-pattern":{source:ml,composite:ml},"fill-extrusion-pattern":{source:ml,composite:ml},"line-dasharray":{source:md,composite:md}},_m={color:{source:Cc,composite:Il},number:{source:_h,composite:Cc}};function Ad(u,n,s){const c=gm[u];return c&&c[s]||_m[n][s]}kn(Ka,"ConstantBinder"),kn(xh,"PatternConstantBinder"),kn(Su,"SourceExpressionBinder"),kn(Tu,"PatternCompositeBinder"),kn(kl,"CompositeExpressionBinder"),kn(Eu,"ProgramConfiguration",{omit:["_buffers"]}),kn(Rl,"ProgramConfigurationSet");const Ya=En/Math.PI/2,pp=5,d=6,r=16383,l=64,p=[l,32,16],x=-Ya,T=Ya;function A(u,n,s,c=Ya){return s=sr(s),[u*Math.sin(s)*c,-n*c,u*Math.cos(s)*c]}function F(u,n,s){return A(Math.cos(sr(u)),Math.sin(sr(u)),n,s)}const j=63710088e-1,H=2*Math.PI*j;class q{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new q(ea(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,c=this.lat*s,m=n.lat*s,f=Math.sin(c)*Math.sin(m)+Math.cos(c)*Math.cos(m)*Math.cos((n.lng-this.lng)*s);return j*Math.acos(Math.min(f,1))}toBounds(n=0){const s=360*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Y({lng:this.lng-c,lat:this.lat-s},{lng:this.lng+c,lat:this.lat+s})}toEcef(n){return F(this.lat,this.lng,Ya+n*Ya/j)}static convert(n){if(n instanceof q)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new q(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new q(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Y{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const c=n;this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]])}else{const c=n;this.setSouthWest(c[0]).setNorthEast(c[1])}}setNorthEast(n){return this._ne=n instanceof q?new q(n.lng,n.lat):q.convert(n),this}setSouthWest(n){return this._sw=n instanceof q?new q(n.lng,n.lat):q.convert(n),this}extend(n){const s=this._sw,c=this._ne;let m,f;if(n instanceof q)m=n,f=n;else{if(!(n instanceof Y))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Y.convert(n)):this.extend(q.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(q.convert(n)):this;if(m=n._sw,f=n._ne,!m||!f)return this}return s||c?(s.lng=Math.min(m.lng,s.lng),s.lat=Math.min(m.lat,s.lat),c.lng=Math.max(f.lng,c.lng),c.lat=Math.max(f.lat,c.lat)):(this._sw=new q(m.lng,m.lat),this._ne=new q(f.lng,f.lat)),this}getCenter(){return new q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new q(this.getWest(),this.getNorth())}getSouthEast(){return new q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:c}=q.convert(n);let m=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&m}static convert(n){if(n)return n instanceof Y?n:new Y(n)}}const Q=0,ae=25.5;function ge(u){return H*Math.cos(u*Math.PI/180)}function _e(u){return(180+u)/360}function Te(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function we(u,n){return u/ge(n)}function ze(u){return 360*u-180}function Ue(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function ke(u,n){return u*ge(Ue(n))}const He=85.051129;function Ye(u){return Math.cos(sr(lr(u,-He,He)))}function Ze(u,n){const s=lr(n,Q,ae),c=Math.pow(2,s);return Ye(u)*H/(512*c)}function Qe(u){return 1/Math.cos(u*Math.PI/180)}function it(u,n=0){const s=Math.exp(Math.PI*(1-(u.y+n/En)/(1<<u.z)*2));return 80150034*s/(s*s+1)/En/(1<<u.z)}class ft{constructor(n,s,c=0){this.x=+n,this.y=+s,this.z=+c}static fromLngLat(n,s=0){const c=q.convert(n);return new ft(_e(c.lng),Te(c.lat),we(s,c.lat))}toLngLat(){return new q(ze(this.x),Ue(this.y))}toAltitude(){return ke(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/H*Qe(Ue(this.y))}}function st(u,n,s,c,m,f,g,E,O){const D=(n+c)/2,w=(s+m)/2,C=new Yt(D,w);E(C),function(R,P,k,N,W,X){const ee=k-W,ne=N-X;return Math.abs((N-P)*ee-(k-R)*ne)/Math.hypot(ee,ne)}(C.x,C.y,f.x,f.y,g.x,g.y)>=O?(st(u,n,s,D,w,f,C,E,O),st(u,D,w,c,m,C,g,E,O)):u.push(g)}function at(u,n,s){let c=u[0],m=c.x,f=c.y;n(c);const g=[c];for(let E=1;E<u.length;E++){const O=u[E],{x:D,y:w}=O;n(O),st(g,m,f,D,w,c,O,n,s),m=D,f=w,c=O}return g}function Rt(u,n,s,c){if(c(n,s)){const m=n.add(s)._mult(.5);Rt(u,n,m,c),Rt(u,m,s,c)}else u.push(s)}function $t(u,n){let s=u[0];const c=[s];for(let m=1;m<u.length;m++){const f=u[m];Rt(c,s,f,n),s=f}return c}const sn=Math.pow(2,14)-1,_n=-sn-1;function yn(u,n){const s=Math.round(u.x*n),c=Math.round(u.y*n);return u.x=lr(s,_n,sn),u.y=lr(c,_n,sn),(s<u.x||s>u.x+1||c<u.y||c>u.y+1)&&Er("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function yt(u,n,s){const c=u.loadGeometry(),m=u.extent,f=En/m;if(n&&s&&s.projection.isReprojectedInTileSpace){const g=1<<n.z,{scale:E,x:O,y:D,projection:w}=s,C=R=>{const P=ze((n.x+R.x/m)/g),k=Ue((n.y+R.y/m)/g),N=w.project(P,k);R.x=(N.x*E-O)*m,R.y=(N.y*E-D)*m};for(let R=0;R<c.length;R++)if(u.type!==1)c[R]=at(c[R],C,1);else{const P=[];for(const k of c[R])k.x<0||k.x>=m||k.y<0||k.y>=m||(C(k),P.push(k));c[R]=P}}for(const g of c)for(const E of g)yn(E,f);return c}function Qt(u,n){return{type:u.type,id:u.id,properties:u.properties,geometry:n?yt(u):[]}}function jt(u,n,s,c,m){u.emplaceBack(2*n+(c+1)/2,2*s+(m+1)/2)}function tn(u,n,s){u.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class rn{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new xu,this.indexArray=new po,this.segments=new $o,this.programConfigurations=new Rl(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,c,m){const f=this.layers[0],g=[];let E=null;f.type==="circle"&&(E=f.layout.get("circle-sort-key"));for(const{feature:D,id:w,index:C,sourceLayerIndex:R}of n){const P=this.layers[0]._featureFilter.needGeometry,k=Qt(D,P);if(!this.layers[0]._featureFilter.filter(new Po(this.zoom),k,c))continue;const N=E?E.evaluate(k,{},c):void 0,W={id:w,properties:D.properties,type:D.type,sourceLayerIndex:R,index:C,geometry:P?k.geometry:yt(D,c,m),patterns:{},sortKey:N};g.push(W)}E&&g.sort((D,w)=>D.sortKey-w.sortKey);let O=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Ua,O=m.projection);for(const D of g){const{geometry:w,index:C,sourceLayerIndex:R}=D,P=n[C].feature;this.addFeature(D,w,C,s.availableImages,c,O,s.brightness),s.featureIndex.insert(P,w,C,R,this.index)}}update(n,s,c,m,f){const g=Object.keys(n).length!==0;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,g?this.stateDependentLayers:this.layers,c,m,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,fm.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,wd.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,c,m,f,g,E){for(const O of s)for(const D of O){const w=D.x,C=D.y;if(w<0||w>=En||C<0||C>=En)continue;if(g){const k=g.projectTilePoint(w,C,f),N=g.upVector(f,w,C),W=this.globeExtVertexArray;tn(W,k,N),tn(W,k,N),tn(W,k,N),tn(W,k,N)}const R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),P=R.vertexLength;jt(this.layoutVertexArray,w,C,-1,-1),jt(this.layoutVertexArray,w,C,1,-1),jt(this.layoutVertexArray,w,C,1,1),jt(this.layoutVertexArray,w,C,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),R.vertexLength+=4,R.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},m,f,E)}}function en(u,n){for(let s=0;s<u.length;s++)if(si(n,u[s]))return!0;for(let s=0;s<n.length;s++)if(si(u,n[s]))return!0;return!!Nn(u,n)}function bn(u,n,s){return!!si(u,n)||!!On(n,u,s)}function er(u,n){if(u.length===1)return kr(n,u[0]);for(let s=0;s<n.length;s++){const c=n[s];for(let m=0;m<c.length;m++)if(si(u,c[m]))return!0}for(let s=0;s<u.length;s++)if(kr(n,u[s]))return!0;for(let s=0;s<n.length;s++)if(Nn(u,n[s]))return!0;return!1}function or(u,n,s){if(u.length>1){if(Nn(u,n))return!0;for(let c=0;c<n.length;c++)if(On(n[c],u,s))return!0}for(let c=0;c<u.length;c++)if(On(u[c],n,s))return!0;return!1}function Nn(u,n){if(u.length===0||n.length===0)return!1;for(let s=0;s<u.length-1;s++){const c=u[s],m=u[s+1];for(let f=0;f<n.length-1;f++)if(ar(c,m,n[f],n[f+1]))return!0}return!1}function ar(u,n,s,c){return go(u,s,c)!==go(n,s,c)&&go(u,n,s)!==go(u,n,c)}function On(u,n,s){const c=s*s;if(n.length===1)return u.distSqr(n[0])<c;for(let m=1;m<n.length;m++)if(pr(u,n[m-1],n[m])<c)return!0;return!1}function pr(u,n,s){const c=n.distSqr(s);if(c===0)return u.distSqr(n);const m=((u.x-n.x)*(s.x-n.x)+(u.y-n.y)*(s.y-n.y))/c;return u.distSqr(m<0?n:m>1?s:s.sub(n)._mult(m)._add(n))}function kr(u,n){let s,c,m,f=!1;for(let g=0;g<u.length;g++){s=u[g];for(let E=0,O=s.length-1;E<s.length;O=E++)c=s[E],m=s[O],c.y>n.y!=m.y>n.y&&n.x<(m.x-c.x)*(n.y-c.y)/(m.y-c.y)+c.x&&(f=!f)}return f}function si(u,n){let s=!1;for(let c=0,m=u.length-1;c<u.length;m=c++){const f=u[c],g=u[m];f.y>n.y!=g.y>n.y&&n.x<(g.x-f.x)*(n.y-f.y)/(g.y-f.y)+f.x&&(s=!s)}return s}function Si(u,n,s,c,m){for(const g of u)if(n<=g.x&&s<=g.y&&c>=g.x&&m>=g.y)return!0;const f=[new Yt(n,s),new Yt(n,m),new Yt(c,m),new Yt(c,s)];if(u.length>2){for(const g of f)if(si(u,g))return!0}for(let g=0;g<u.length-1;g++)if(fr(u[g],u[g+1],f))return!0;return!1}function fr(u,n,s){const c=s[0],m=s[2];if(u.x<c.x&&n.x<c.x||u.x>m.x&&n.x>m.x||u.y<c.y&&n.y<c.y||u.y>m.y&&n.y>m.y)return!1;const f=go(u,n,s[0]);return f!==go(u,n,s[1])||f!==go(u,n,s[2])||f!==go(u,n,s[3])}function hi(u,n,s,c,m,f){let g=n.y-u.y,E=u.x-n.x;if(f=f||0){const O=g*g+E*E;if(O===0)return!0;const D=Math.sqrt(O);g/=D,E/=D}return!((s.x-u.x)*g+(s.y-u.y)*E-f<0||(c.x-u.x)*g+(c.y-u.y)*E-f<0||(m.x-u.x)*g+(m.y-u.y)*E-f<0)}function Nr(u,n,s,c,m,f,g){return!(hi(u,n,c,m,f,g)||hi(n,s,c,m,f,g)||hi(s,u,c,m,f,g)||hi(c,m,u,n,s,g)||hi(m,f,u,n,s,g)||hi(f,c,u,n,s,g))}function li(u,n,s){const c=n.paint.get(u).value;return c.kind==="constant"?c.value:s.programConfigurations.get(n.id).getMaxValue(u)}function Rr(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Li(u,n,s,c,m){if(!n[0]&&!n[1])return u;const f=Yt.convert(n)._mult(m);s==="viewport"&&f._rotate(-c);const g=[];for(let E=0;E<u.length;E++)g.push(u[E].sub(f));return g}function Qr(u,n,s,c){const m=Yt.convert(u)._mult(c);return n==="viewport"&&m._rotate(-s),m}let Ei,Ui;kn(rn,"CircleBucket",{omit:["layers"]});var Yo,Vs={exports:{}},Ps=(Yo||(Yo=1,function(u,n){(function(s){function c(f,g,E){var O=m(256*f,256*(g=Math.pow(2,E)-g-1),E),D=m(256*(f+1),256*(g+1),E);return O[0]+","+O[1]+","+D[0]+","+D[1]}function m(f,g,E){var O=2*Math.PI*6378137/256/Math.pow(2,E);return[f*O-2*Math.PI*6378137/2,g*O-2*Math.PI*6378137/2]}s.getURL=function(f,g,E,O,D,w){return w=w||{},f+"?"+["bbox="+c(E,O,D),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+g].join("&")},s.getTileBBox=c,s.getMercCoords=m,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,Vs.exports)),Vs.exports);class Qi{constructor(n,s,c){this.z=n,this.x=s,this.y=c,this.key=di(0,n,n,s,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const c=Ps.getTileBBox(this.x,this.y,this.z),m=function(f,g,E){let O,D="";for(let w=f;w>0;w--)O=1<<w-1,D+=(g&O?1:0)+(E&O?2:0);return D}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xi{constructor(n,s){this.wrap=n,this.canonical=s,this.key=di(n,s.z,s.z,s.x,s.y)}}class ni{constructor(n,s,c,m,f){this.overscaledZ=n,this.wrap=s,this.canonical=new Qi(c,+m,+f),this.key=s===0&&n===c?this.canonical.key:di(s,n,c,m,f)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new ni(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ni(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return di(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-n;return di(this.wrap*+s,n,n,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new ni(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,m=2*this.canonical.y;return[new ni(s,this.wrap,s,c,m),new ni(s,this.wrap,s,c+1,m),new ni(s,this.wrap,s,c,m+1),new ni(s,this.wrap,s,c+1,m+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ni(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ni(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xi(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function di(u,n,s,c,m){const f=1<<Math.min(s,22);let g=f*(m%f)+c%f;return u&&s<22&&(g+=f*f*((u<0?-2*u-1:2*u)%(1<<2*(22-s)))),16*(32*g+s)+(n-s)}const Vi=[u=>{let n=u.canonical.x-1,s=u.wrap;return n<0&&(n=(1<<u.canonical.z)-1,s--),new ni(u.overscaledZ,s,u.canonical.z,n,u.canonical.y)},u=>{let n=u.canonical.x+1,s=u.wrap;return n===1<<u.canonical.z&&(n=0,s++),new ni(u.overscaledZ,s,u.canonical.z,n,u.canonical.y)},u=>new ni(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new ni(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];kn(Qi,"CanonicalTileID"),kn(ni,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ko=Ti([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ji}=ko,pa=Ti([{name:"a_pos_3",components:3,type:"Int16"}]);var _s=Ti([{name:"a_pos",type:"Int16",components:2}]);class ys{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,c){const m=Ke.vec3.dot(s,this.dir);if(Math.abs(m)<1e-6)return!1;const f=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/m;return c[0]=this.pos[0]+this.dir[0]*f,c[1]=this.pos[1]+this.dir[1]*f,c[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(n,s,c){if(Ke.vec3.equals(this.pos,n)||s===0)return c[0]=c[1]=c[2]=0,!1;const[m,f,g]=this.dir,E=this.pos[0]-n[0],O=this.pos[1]-n[1],D=this.pos[2]-n[2],w=m*m+f*f+g*g,C=2*(E*m+O*f+D*g),R=C*C-4*w*(E*E+O*O+D*D-s*s);if(R<0){const P=Math.max(-C/2,0),k=E+m*P,N=O+f*P,W=D+g*P,X=Math.hypot(k,N,W);return c[0]=k*s/X,c[1]=N*s/X,c[2]=W*s/X,!1}{const P=(-C-Math.sqrt(R))/(2*w);if(P<0){const k=Math.hypot(E,O,D);return c[0]=E*s/k,c[1]=O*s/k,c[2]=D*s/k,!1}return c[0]=E+m*P,c[1]=O+f*P,c[2]=D+g*P,!0}}}class os{constructor(n,s,c,m,f){this.TL=n,this.TR=s,this.BR=c,this.BL=m,this.horizon=f}static fromInvProjectionMatrix(n,s,c){const m=[-1,1,1],f=[1,1,1],g=[1,-1,1],E=[-1,-1,1],O=Ke.vec3.transformMat4(m,m,n),D=Ke.vec3.transformMat4(f,f,n),w=Ke.vec3.transformMat4(g,g,n),C=Ke.vec3.transformMat4(E,E,n);return new os(O,D,w,C,s/c)}}function al(u,n,s){let c=1/0,m=-1/0;const f=[];for(const g of u){Ke.vec3.sub(f,g,n);const E=Ke.vec3.dot(f,s);c=Math.min(c,E),m=Math.max(m,E)}return[c,m]}function sl(u,n){let s=!0;for(let c=0;c<u.planes.length;c++){const m=u.planes[c];let f=0;for(let g=0;g<n.length;g++)f+=Ke.vec3.dot(m,n[g])+m[3]>=0;if(f===0)return 0;f!==n.length&&(s=!1)}return s?2:1}function vs(u,n){for(const s of u.projections){const c=al(n,u.points[0],s.axis);if(s.projection[1]<c[0]||s.projection[0]>c[1])return 0}return 1}function ma(u,n){let s=0;const c=[0,0,0,0];for(let m=0;m<u.length;m++)c[0]=u[m][0],c[1]=u[m][1],c[2]=u[m][2],c[3]=1,Ke.vec4.dot(c,n)>=0&&s++;return s}class Ja{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=pi.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ke.vec3.sub([],this.points[2],this.points[3]),Ke.vec3.sub([],this.points[0],this.points[3]),Ke.vec3.sub([],this.points[4],this.points[0]),Ke.vec3.sub([],this.points[5],this.points[1]),Ke.vec3.sub([],this.points[6],this.points[2]),Ke.vec3.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const m=[0,-c[2],c[1]],f=[c[2],0,-c[0]];this.projections.push({axis:m,projection:al(this.points,this.points[0],m)}),this.projections.push({axis:f,projection:al(this.points,this.points[0],f)})}}static fromInvProjectionMatrix(n,s,c,m){const f=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const w=Ke.vec4.transformMat4([],D,n),C=1/w[3]/s*f;return Ke.vec4.mul(w,w,[C,C,m?1/w[3]:C,C])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const w=Ke.vec3.sub([],g[D[0]],g[D[1]]),C=Ke.vec3.sub([],g[D[2]],g[D[1]]),R=Ke.vec3.normalize([],Ke.vec3.cross([],w,C)),P=-Ke.vec3.dot(R,g[D[1]]);return R.concat(P)}),O=[];for(let D=0;D<g.length;D++)O.push([g[D][0],g[D][1],g[D][2]]);return new Ja(O,E)}intersectsPrecise(n,s,c){for(let m=0;m<s.length;m++)if(!ma(n,s[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!ma(n,this.planes[m]))return 0;for(const m of c)for(const f of this.frustumEdges){const g=Ke.vec3.cross([],m,f),E=Ke.vec3.length(g);if(E===0)continue;Ke.vec3.scale(g,g,1/E);const O=al(this.points,this.points[0],g),D=al(n,this.points[0],g);if(O[0]>D[1]||D[0]>O[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const c=s[3];if(Ke.vec3.dot([s[0],s[1],s[2]],n)+c<0)return!1}return!0}}class pi{static fromPoints(n){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const m of n)Ke.vec3.min(s,s,m),Ke.vec3.max(c,c,m);return new pi(s,c)}static fromTileIdAndHeight(n,s,c){const m=1<<n.canonical.z,f=n.canonical.x,g=n.canonical.y;return new pi([f/m,g/m,s],[(f+1)/m,(g+1)/m,c])}static applyTransform(n,s){const c=n.getCorners();for(let m=0;m<c.length;++m)Ke.vec3.transformMat4(c[m],c[m],s);return pi.fromPoints(c)}static applyTransformFast(n,s){const c=[s[12],s[13],s[14]],m=[...c];for(let f=0;f<3;f++)for(let g=0;g<3;g++){const E=s[4*g+f],O=E*n.min[g],D=E*n.max[g];c[f]+=Math.min(O,D),m[f]+=Math.max(O,D)}return new pi(c,m)}static projectAabbCorners(n,s){const c=n.getCorners();for(let m=0;m<c.length;++m)Ke.vec3.transformMat4(c[m],c[m],s);return c}constructor(n,s){this.min=n,this.max=s,this.center=Ke.vec3.scale([],Ke.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],c=Ke.vec3.clone(this.min),m=Ke.vec3.clone(this.max);for(let f=0;f<s.length;f++)c[f]=s[f]?this.min[f]:this.center[f],m[f]=s[f]?this.center[f]:this.max[f];return m[2]=this.max[2],new pi(c,m)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?sl(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?sl(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?vs(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?vs(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function Qa(u){return u*Ya/j}kn(pi,"Aabb");const Pd=[new pi([x,x,x],[T,T,T]),new pi([x,x,x],[0,0,T]),new pi([0,x,x],[T,0,T]),new pi([x,0,x],[0,T,T]),new pi([0,0,x],[T,T,T])];function kc(u,n,s,c=!0){const m=Ke.vec3.scale([],u._camera.position,u.worldSize),f=[n,s,1,1];Ke.vec4.transformMat4(f,f,u.pixelMatrixInverse),Ke.vec4.scale(f,f,1/f[3]);const g=Ke.vec3.sub([],f,m),E=Ke.vec3.normalize([],g),O=u.globeMatrix,D=[O[12],O[13],O[14]],w=Ke.vec3.sub([],D,m),C=Ke.vec3.length(w),R=Ke.vec3.normalize([],w),P=u.worldSize/(2*Math.PI),k=Ke.vec3.dot(R,E),N=Math.asin(P/C);if(N<Math.acos(k)){if(!c)return null;const ot=[],je=[];Ke.vec3.scale(ot,E,C/k),Ke.vec3.normalize(je,Ke.vec3.sub(je,ot,w)),Ke.vec3.normalize(E,Ke.vec3.add(E,w,Ke.vec3.scale(E,je,Math.tan(N)*C)))}const W=[];new ys(m,E).closestPointOnSphere(D,P,W);const X=Ke.vec3.normalize([],Fo(O,0)),ee=Ke.vec3.normalize([],Fo(O,1)),ne=Ke.vec3.normalize([],Fo(O,2)),J=Ke.vec3.dot(X,W),he=Ke.vec3.dot(ee,W),ye=Ke.vec3.dot(ne,W),Me=_i(Math.asin(-he/P));let Ve=_i(Math.atan2(J,ye));Ve=u.center.lng+function(ot,je){const nt=(je-ot+180)%360-180;return nt<-180?nt+360:nt}(u.center.lng,Ve);const Ne=_e(Ve),$e=lr(Te(Me),0,1);return new ft(Ne,$e)}class Nf{constructor(n,s,c){this.a=Ke.vec3.sub([],n,c),this.b=Ke.vec3.sub([],s,c),this.center=c;const m=Ke.vec3.normalize([],this.a),f=Ke.vec3.normalize([],this.b);this.angle=Math.acos(Ke.vec3.dot(m,f))}}function jf(u,n){if(u.angle===0)return null;let s;return s=u.a[n]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[n]/u.a[n]/Math.sin(u.angle)-1/Math.tan(u.angle)),s<0||s>1?null:function(c,m,f,g){const E=Math.sin(f);return c*(Math.sin((1-g)*f)/E)+m*(Math.sin(g*f)/E)}(u.a[n],u.b[n],u.angle,lr(s,0,1))+u.center[n]}function qs(u){if(u.z<=1)return Pd[u.z+2*u.y+u.x];const n=bh(Md(u));return pi.fromPoints(n)}function Rc(u,n,s){return Ke.vec3.scale(u,u,1-s),Ke.vec3.scaleAndAdd(u,u,n,s)}function ym(u,n,s){for(const c of u)Ke.vec3.transformMat4(c,c,n),Ke.vec3.scale(c,c,s)}function Zh(u,n,s,c){const m=n/u.worldSize,f=u.globeMatrix;if(s.z<=1){const Ne=qs(s).getCorners();return ym(Ne,f,m),pi.fromPoints(Ne)}const g=Md(s,c),E=bh(g,Ya+Qa(u._tileCoverLift));ym(E,f,m);const O=Number.MAX_VALUE,D=[-O,-O,-O],w=[O,O,O];if(g.contains(u.center)){for(const ot of E)Ke.vec3.min(w,w,ot),Ke.vec3.max(D,D,ot);D[2]=0;const Ne=u.point,$e=[Ne.x*m,Ne.y*m,0];return Ke.vec3.min(w,w,$e),Ke.vec3.max(D,D,$e),new pi(w,D)}if(u._tileCoverLift>0){for(const Ne of E)Ke.vec3.min(w,w,Ne),Ke.vec3.max(D,D,Ne);return new pi(w,D)}const C=[f[12]*m,f[13]*m,f[14]*m],R=g.getCenter(),P=lr(u.center.lat,-He,He),k=lr(R.lat,-He,He),N=_e(u.center.lng),W=Te(P);let X=N-_e(R.lng);const ee=W-Te(k);X>.5?X-=1:X<-.5&&(X+=1);let ne=0;if(Math.abs(X)>Math.abs(ee))ne=X>=0?1:3;else{ne=ee>=0?0:2;const Ne=[f[4]*m,f[5]*m,f[6]*m],$e=-Math.sin(sr(ee>=0?g.getSouth():g.getNorth()))*Ya;Ke.vec3.scaleAndAdd(C,C,Ne,$e)}const J=E[ne],he=E[(ne+1)%4],ye=new Nf(J,he,C),Me=[jf(ye,0)||J[0],jf(ye,1)||J[1],jf(ye,2)||J[2]],Ve=Ll(u.zoom);if(Ve>0){const Ne=function({x:ot,y:je,z:nt},ct,ht,_t,At){const It=1/(1<<nt);let wt=ot*It,Xt=wt+It,pn=je*It,Ut=pn+It,Fn=0;const An=(wt+Xt)/2-_t;return An>.5?Fn=-1:An<-.5&&(Fn=1),wt=((wt+Fn)*ct-(_t*=ct))*ht+_t,Xt=((Xt+Fn)*ct-_t)*ht+_t,pn=(pn*ct-(At*=ct))*ht+At,Ut=(Ut*ct-At)*ht+At,[[wt,Ut,0],[Xt,Ut,0],[Xt,pn,0],[wt,pn,0]]}(s,n,u._pixelsPerMercatorPixel,N,W);for(let ot=0;ot<E.length;ot++)Rc(E[ot],Ne[ot],Ve);const $e=Ke.vec3.add([],Ne[ne],Ne[(ne+1)%4]);Ke.vec3.scale($e,$e,.5),Rc(Me,$e,Ve)}for(const Ne of E)Ke.vec3.min(w,w,Ne),Ke.vec3.max(D,D,Ne);return w[2]=Math.min(J[2],he[2]),Ke.vec3.min(w,w,Me),Ke.vec3.max(D,D,Me),new pi(w,D)}function Md({x:u,y:n,z:s},c=!1){const m=1/(1<<s),f=new q(ze(u*m),n===(1<<s)-1&&c?-90:Ue((n+1)*m)),g=new q(ze((u+1)*m),n===0&&c?90:Ue(n*m));return new Y(f,g)}function bh(u,n=Ya){const s=sr(u.getNorth()),c=sr(u.getSouth()),m=Math.cos(s),f=Math.cos(c),g=Math.sin(s),E=Math.sin(c),O=u.getWest(),D=u.getEast();return[A(f,E,O,n),A(f,E,D,n),A(m,g,D,n),A(m,g,O,n)]}function Id(u,n,s,c){const m=1<<s.z,f=(u/En+s.x)/m;return F(Ue((n/En+s.y)/m),ze(f),c)}function mp({min:u,max:n}){return r/Math.max(n[0]-u[0],n[1]-u[1],n[2]-u[2])}const vm=new Float64Array(16);function $f(u){const n=mp(u),s=Ke.mat4.fromScaling(vm,[n,n,n]);return Ke.mat4.translate(s,s,Ke.vec3.negate([],u.min))}function Ug(u){const n=Ke.mat4.fromTranslation(vm,u.min),s=1/mp(u);return Ke.mat4.scale(n,n,[s,s,s])}function Vg(u){const n=En/(2*Math.PI);return u/(2*Math.PI)/n}function qg(u,n){return En/(512*Math.pow(2,u))*mp(qs(n))}function Gg(u,n,s,c,m){const f=Vg(s),g=[u,n,-s/(2*Math.PI)],E=Ke.mat4.identity(new Float64Array(16));return Ke.mat4.translate(E,E,g),Ke.mat4.scale(E,E,[f,f,f]),Ke.mat4.rotateX(E,E,sr(-m)),Ke.mat4.rotateY(E,E,sr(-c)),E}function Ll(u){return qo(pp,d,u)}function Qy(u,n){const s=F(n.lat,n.lng),c=function(f){const g=F(f._center.lat,f._center.lng),E=Ke.vec3.fromValues(0,1,0);let O=Ke.vec3.cross([],E,g);const D=Ke.mat4.fromRotation([],-f.angle,g);O=Ke.vec3.transformMat4(O,O,D),Ke.mat4.fromRotation(D,-f._pitch,O);const w=Ke.vec3.normalize([],g);return Ke.vec3.scale(w,w,Qa(f.cameraToCenterDistance/f.pixelsPerMeter)),Ke.vec3.transformMat4(w,w,D),Ke.vec3.add([],g,w)}(u),m=Ke.vec3.subtract([],c,s);return Ke.vec3.angle(m,s)}function Xh(u,n){return Qy(u,n)>Math.PI/2*1.01}const Hg=sr(85),Va=Math.cos(Hg),h1=Math.sin(Hg),ev=Ke.mat4.create(),tv=u=>{const n=[];return u.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function nv(u,n,s,c,m,f,g,E,O){if(f&&u.queryGeometry.isAboveHorizon)return!1;f&&(O*=u.pixelToTileUnitsFactor);const D=u.tileID.canonical,w=s.projection.upVectorScale(D,s.center.lat,s.worldSize).metersToTile;for(const C of n)for(const R of C){const P=R.add(E),k=m&&s.elevation?s.elevation.exaggeration()*m.getElevationAt(P.x,P.y,!0):0,N=s.projection.projectTilePoint(P.x,P.y,D);if(k>0){const ne=s.projection.upVector(D,P.x,P.y);N.x+=ne[0]*w*k,N.y+=ne[1]*w*k,N.z+=ne[2]*w*k}const W=f?P:rv(N.x,N.y,N.z,c),X=f?u.tilespaceRays.map(ne=>Au(ne,k)):u.queryGeometry.screenGeometry,ee=Ke.vec4.transformMat4([],[N.x,N.y,N.z,1],c);if(!g&&f?O*=ee[3]/s.cameraToCenterDistance:g&&!f&&(O*=s.cameraToCenterDistance/ee[3]),f){const ne=Ue((R.y/En+D.y)/(1<<D.z));O/=s.projection.pixelsPerMeter(ne,1)/we(1,ne)}if(bn(X,W,O))return!0}return!1}function rv(u,n,s,c){const m=Ke.vec4.transformMat4([],[u,n,s,1],c);return new Yt(m[0]/m[3],m[1]/m[3])}const Wg=Ke.vec3.fromValues(0,0,0),f1=Ke.vec3.fromValues(0,0,1);function Au(u,n){const s=Ke.vec3.create();return Wg[2]=n,u.intersectsPlane(Wg,f1,s),new Yt(s[0],s[1])}class xm extends rn{}let iv,wh,gp,Kh;function _p(u,{width:n,height:s},c,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==n*s*c)throw new RangeError("mismatched image size")}else m=new Uint8Array(n*s*c);return u.width=n,u.height=s,u.data=m,u}function bm(u,n,s){const{width:c,height:m}=n;c===u.width&&m===u.height||(yp(u,n,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,c),height:Math.min(u.height,m)},s,null),u.width=c,u.height=m,u.data=n.data)}function yp(u,n,s,c,m,f,g,E){if(m.width===0||m.height===0)return n;if(m.width>u.width||m.height>u.height||s.x>u.width-m.width||s.y>u.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>n.width||m.height>n.height||c.x>n.width-m.width||c.y>n.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const O=u.data,D=n.data,w=f===4&&E;for(let C=0;C<m.height;C++){const R=((s.y+C)*u.width+s.x)*f,P=((c.y+C)*n.width+c.x)*f;if(w)for(let k=0;k<m.width;k++){const N=R+k*f+3,W=P+k*f;D[W+0]=255,D[W+1]=255,D[W+2]=255,D[W+3]=O[N]}else if(g)for(let k=0;k<m.width;k++){const N=R+k*f,W=P+k*f,X=O[N+3],ee=new Pr(O[N+0]/255*X,O[N+1]/255*X,O[N+2]/255*X,X).toRenderColor(g).toArray();D[W+0]=ee[0],D[W+1]=ee[1],D[W+2]=ee[2],D[W+3]=ee[3]}else for(let k=0;k<m.width*f;k++)D[P+k]=O[R+k]}return n}kn(xm,"HeatmapBucket",{omit:["layers"]});class Yh{constructor(n,s){_p(this,n,1,s)}resize(n){bm(this,new Yh(n),1)}clone(){return new Yh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,m,f){yp(n,s,c,m,f,1,null)}}class xs{constructor(n,s){_p(this,n,4,s)}resize(n){bm(this,new xs(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new xs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,m,f,g,E){yp(n,s,c,m,f,4,g,E)}}class ov{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function Cd(u){const n={},s=u.resolution||256,c=u.clips?u.clips.length:1,m=u.image||new xs({width:s,height:c}),f=(g,E,O)=>{n[u.evaluationKey]=O;const D=u.expression.evaluate(n);D&&(m.data[g+E+0]=Math.floor(255*D.r/D.a),m.data[g+E+1]=Math.floor(255*D.g/D.a),m.data[g+E+2]=Math.floor(255*D.b/D.a),m.data[g+E+3]=Math.floor(255*D.a))};if(u.clips)for(let g=0,E=0;g<c;++g,E+=4*s)for(let O=0,D=0;O<s;O++,D+=4){const w=O/(s-1),{start:C,end:R}=u.clips[g];f(E,D,C*(1-w)+R*w)}else for(let g=0,E=0;g<s;g++,E+=4)f(0,E,g/(s-1));return m}kn(Yh,"AlphaImage"),kn(xs,"RGBAImage");const av=Ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:wm}=av;function Jh(u,n,s=2){const c=n&&n.length,m=c?n[0]*s:u.length;let f=Zg(u,0,m,s,!0);const g=[];if(!f||f.next===f.prev)return g;let E,O,D;if(c&&(f=function(w,C,R,P){const k=[];for(let N=0,W=C.length;N<W;N++){const X=Zg(w,C[N]*P,N<W-1?C[N+1]*P:w.length,P,!1);X===X.next&&(X.steiner=!0),k.push(p1(X))}k.sort(Tm);for(let N=0;N<k.length;N++)R=lv(k[N],R);return R}(u,n,f,s)),u.length>80*s){E=1/0,O=1/0;let w=-1/0,C=-1/0;for(let R=s;R<m;R+=s){const P=u[R],k=u[R+1];P<E&&(E=P),k<O&&(O=k),P>w&&(w=P),k>C&&(C=k)}D=Math.max(w-E,C-O),D=D!==0?32767/D:0}return vp(f,g,s,E,O,D,0),g}function Zg(u,n,s,c,m){let f;if(m===function(g,E,O,D){let w=0;for(let C=E,R=O-D;C<O;C+=D)w+=(g[R]-g[C])*(g[C+1]+g[R+1]),R=C;return w}(u,n,s,c)>0)for(let g=n;g<s;g+=c)f=qe(g/c|0,u[g],u[g+1],f);else for(let g=s-c;g>=n;g-=c)f=qe(g/c|0,u[g],u[g+1],f);return f&&_(f,f.next)&&(bt(f),f=f.next),f}function Sh(u,n){if(!u)return u;n||(n=u);let s,c=u;do if(s=!1,c.steiner||!_(c,c.next)&&aa(c.prev,c,c.next)!==0)c=c.next;else{if(bt(c),c=n=c.prev,c===c.next)break;s=!0}while(s||c!==n);return n}function vp(u,n,s,c,m,f,g){if(!u)return;!g&&f&&function(O,D,w,C){let R=O;do R.z===0&&(R.z=Od(R.x,R.y,D,w,C)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==O);R.prevZ.nextZ=null,R.prevZ=null,function(P){let k,N=1;do{let W,X=P;P=null;let ee=null;for(k=0;X;){k++;let ne=X,J=0;for(let ye=0;ye<N&&(J++,ne=ne.nextZ,ne);ye++);let he=N;for(;J>0||he>0&&ne;)J!==0&&(he===0||!ne||X.z<=ne.z)?(W=X,X=X.nextZ,J--):(W=ne,ne=ne.nextZ,he--),ee?ee.nextZ=W:P=W,W.prevZ=ee,ee=W;X=ne}ee.nextZ=null,N*=2}while(k>1)}(R)}(u,c,m,f);let E=u;for(;u.prev!==u.next;){const O=u.prev,D=u.next;if(f?Xg(u,c,m,f):sv(u))n.push(O.i,u.i,D.i),bt(u),u=D.next,E=D.next;else if((u=D)===E){g?g===1?vp(u=Sm(Sh(u),n),n,s,c,m,f,2):g===2&&Kg(u,n,s,c,m,f):vp(Sh(u),n,s,c,m,f,1);break}}}function sv(u){const n=u.prev,s=u,c=u.next;if(aa(n,s,c)>=0)return!1;const m=n.x,f=s.x,g=c.x,E=n.y,O=s.y,D=c.y,w=m<f?m<g?m:g:f<g?f:g,C=E<O?E<D?E:D:O<D?O:D,R=m>f?m>g?m:g:f>g?f:g,P=E>O?E>D?E:D:O>D?O:D;let k=c.next;for(;k!==n;){if(k.x>=w&&k.x<=R&&k.y>=C&&k.y<=P&&Lc(m,E,f,O,g,D,k.x,k.y)&&aa(k.prev,k,k.next)>=0)return!1;k=k.next}return!0}function Xg(u,n,s,c){const m=u.prev,f=u,g=u.next;if(aa(m,f,g)>=0)return!1;const E=m.x,O=f.x,D=g.x,w=m.y,C=f.y,R=g.y,P=E<O?E<D?E:D:O<D?O:D,k=w<C?w<R?w:R:C<R?C:R,N=E>O?E>D?E:D:O>D?O:D,W=w>C?w>R?w:R:C>R?C:R,X=Od(P,k,n,s,c),ee=Od(N,W,n,s,c);let ne=u.prevZ,J=u.nextZ;for(;ne&&ne.z>=X&&J&&J.z<=ee;){if(ne.x>=P&&ne.x<=N&&ne.y>=k&&ne.y<=W&&ne!==m&&ne!==g&&Lc(E,w,O,C,D,R,ne.x,ne.y)&&aa(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,J.x>=P&&J.x<=N&&J.y>=k&&J.y<=W&&J!==m&&J!==g&&Lc(E,w,O,C,D,R,J.x,J.y)&&aa(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;ne&&ne.z>=X;){if(ne.x>=P&&ne.x<=N&&ne.y>=k&&ne.y<=W&&ne!==m&&ne!==g&&Lc(E,w,O,C,D,R,ne.x,ne.y)&&aa(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;J&&J.z<=ee;){if(J.x>=P&&J.x<=N&&J.y>=k&&J.y<=W&&J!==m&&J!==g&&Lc(E,w,O,C,D,R,J.x,J.y)&&aa(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function Sm(u,n){let s=u;do{const c=s.prev,m=s.next.next;!_(c,m)&&b(c,s,s.next,m)&&oe(c,m)&&oe(m,c)&&(n.push(c.i,s.i,m.i),bt(s),bt(s.next),s=u=m),s=s.next}while(s!==u);return Sh(s)}function Kg(u,n,s,c,m,f){let g=u;do{let E=g.next.next;for(;E!==g.prev;){if(g.i!==E.i&&m1(g,E)){let O=me(g,E);return g=Sh(g,g.next),O=Sh(O,O.next),vp(g,n,s,c,m,f,0),void vp(O,n,s,c,m,f,0)}E=E.next}g=g.next}while(g!==u)}function Tm(u,n){return u.x-n.x}function lv(u,n){const s=function(m,f){let g=f;const E=m.x,O=m.y;let D,w=-1/0;do{if(O<=g.y&&O>=g.next.y&&g.next.y!==g.y){const N=g.x+(O-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(N<=E&&N>w&&(w=N,D=g.x<g.next.x?g:g.next,N===E))return D}g=g.next}while(g!==f);if(!D)return null;const C=D,R=D.x,P=D.y;let k=1/0;g=D;do{if(E>=g.x&&g.x>=R&&E!==g.x&&Lc(O<P?E:w,O,R,P,O<P?w:E,O,g.x,g.y)){const N=Math.abs(O-g.y)/(E-g.x);oe(g,m)&&(N<k||N===k&&(g.x>D.x||g.x===D.x&&d1(D,g)))&&(D=g,k=N)}g=g.next}while(g!==C);return D}(u,n);if(!s)return n;const c=me(s,u);return Sh(c,c.next),Sh(s,s.next)}function d1(u,n){return aa(u.prev,u,n.prev)<0&&aa(n.next,u,u.next)<0}function Od(u,n,s,c,m){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-s)*m|0)|u<<8))|u<<4))|u<<2))|u<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*m|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function p1(u){let n=u,s=u;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==u);return s}function Lc(u,n,s,c,m,f,g,E){return(m-g)*(n-E)>=(u-g)*(f-E)&&(u-g)*(c-E)>=(s-g)*(n-E)&&(s-g)*(f-E)>=(m-g)*(c-E)}function m1(u,n){return u.next.i!==n.i&&u.prev.i!==n.i&&!function(s,c){let m=s;do{if(m.i!==s.i&&m.next.i!==s.i&&m.i!==c.i&&m.next.i!==c.i&&b(m,m.next,s,c))return!0;m=m.next}while(m!==s);return!1}(u,n)&&(oe(u,n)&&oe(n,u)&&function(s,c){let m=s,f=!1;const g=(s.x+c.x)/2,E=(s.y+c.y)/2;do m.y>E!=m.next.y>E&&m.next.y!==m.y&&g<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(f=!f),m=m.next;while(m!==s);return f}(u,n)&&(aa(u.prev,u,n.prev)||aa(u,n.prev,n))||_(u,n)&&aa(u.prev,u,u.next)>0&&aa(n.prev,n,n.next)>0)}function aa(u,n,s){return(n.y-u.y)*(s.x-n.x)-(n.x-u.x)*(s.y-n.y)}function _(u,n){return u.x===n.x&&u.y===n.y}function b(u,n,s,c){const m=G(aa(u,n,s)),f=G(aa(u,n,c)),g=G(aa(s,c,u)),E=G(aa(s,c,n));return m!==f&&g!==E||!(m!==0||!z(u,s,n))||!(f!==0||!z(u,c,n))||!(g!==0||!z(s,u,c))||!(E!==0||!z(s,n,c))}function z(u,n,s){return n.x<=Math.max(u.x,s.x)&&n.x>=Math.min(u.x,s.x)&&n.y<=Math.max(u.y,s.y)&&n.y>=Math.min(u.y,s.y)}function G(u){return u>0?1:u<0?-1:0}function oe(u,n){return aa(u.prev,u,u.next)<0?aa(u,n,u.next)>=0&&aa(u,u.prev,n)>=0:aa(u,n,u.prev)<0||aa(u,u.next,n)<0}function me(u,n){const s=Ft(u.i,u.x,u.y),c=Ft(n.i,n.x,n.y),m=u.next,f=n.prev;return u.next=n,n.prev=u,s.next=m,m.prev=s,c.next=s,s.prev=c,f.next=c,c.prev=f,c}function qe(u,n,s,c){const m=Ft(u,n,s);return c?(m.next=c.next,m.prev=c,c.next.prev=m,c.next=m):(m.prev=m,m.next=m),m}function bt(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Ft(u,n,s){return{i:u,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function mn(u,n){const s=u.length;if(s<=1)return[u];const c=[];let m,f;for(let g=0;g<s;g++){const E=Ia(u[g]);E!==0&&(u[g].area=Math.abs(E),f===void 0&&(f=E<0),f===E<0?(m&&c.push(m),m=[u[g]]):m.push(u[g]))}if(m&&c.push(m),n>1)for(let g=0;g<c.length;g++)c[g].length<=n||(Ru(c[g],n,1,c[g].length-1,Vn),c[g]=c[g].slice(0,n));return c}function Vn(u,n){return n.area-u.area}function Wn(u,n,s){const c=s.patternDependencies;let m=!1;for(const f of n){const g=f.paint.get(`${u}-pattern`);g.isConstant()||(m=!0);const E=g.constantOr(null);E&&(m=!0,c[E]=!0)}return m}function jn(u,n,s,c,m){const f=m.patternDependencies;for(const g of n){const E=g.paint.get(`${u}-pattern`).value;if(E.kind!=="constant"){let O=E.evaluate({zoom:c},s,{},m.availableImages);O=O&&O.name?O.name:O,f[O]=!0,s.patterns[g.id]=O}}return s}class xr{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new xu,this.indexArray=new po,this.indexArray2=new gs,this.programConfigurations=new Rl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new $o,this.segments2=new $o,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,c,m){this.hasPattern=Wn("fill",this.layers,s);const f=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:E,id:O,index:D,sourceLayerIndex:w}of n){const C=this.layers[0]._featureFilter.needGeometry,R=Qt(E,C);if(!this.layers[0]._featureFilter.filter(new Po(this.zoom),R,c))continue;const P=f?f.evaluate(R,{},c,s.availableImages):void 0,k={id:O,properties:E.properties,type:E.type,sourceLayerIndex:w,index:D,geometry:C?R.geometry:yt(E,c,m),patterns:{},sortKey:P};g.push(k)}f&&g.sort((E,O)=>E.sortKey-O.sortKey);for(const E of g){const{geometry:O,index:D,sourceLayerIndex:w}=E;if(this.hasPattern){const C=jn("fill",this.layers,E,this.zoom,s);this.patternFeatures.push(C)}else this.addFeature(E,O,D,c,{},s.availableImages,s.brightness);s.featureIndex.insert(n[D].feature,O,D,w,this.index)}}update(n,s,c,m,f){const g=Object.keys(n).length!==0;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,g?this.stateDependentLayers:this.layers,c,m,f)}addFeatures(n,s,c,m,f,g){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,s,c,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,wm),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,c,m,f,g=[],E){for(const O of mn(s,500)){let D=0;for(const N of O)D+=N.length;const w=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),C=w.vertexLength,R=[],P=[];for(const N of O){if(N.length===0)continue;N!==O[0]&&P.push(R.length/2);const W=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),X=W.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(X+N.length-1,X),R.push(N[0].x),R.push(N[0].y);for(let ee=1;ee<N.length;ee++)this.layoutVertexArray.emplaceBack(N[ee].x,N[ee].y),this.indexArray2.emplaceBack(X+ee-1,X+ee),R.push(N[ee].x),R.push(N[ee].y);W.vertexLength+=N.length,W.primitiveLength+=N.length}const k=Jh(R,P);for(let N=0;N<k.length;N+=3)this.indexArray.emplaceBack(C+k[N],C+k[N+1],C+k[N+2]);w.vertexLength+=D,w.primitiveLength+=k.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,g,m,E)}}let zr,jr,qa,ln;kn(xr,"FillBucket",{omit:["layers","patternFeatures"]});class qt{constructor(n,s,c,m){if(this.triangleCount=s.length/3,this.min=new Yt(0,0),this.max=new Yt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[f,g]=[n[0].clone(),n[0].clone()];for(let C=1;C<n.length;++C){const R=n[C];f.x=Math.min(f.x,R.x),f.y=Math.min(f.y,R.y),g.x=Math.max(g.x,R.x),g.y=Math.max(g.y,R.y)}if(m){const C=Math.ceil(Math.max(g.x-f.x,g.y-f.y)/m);c=Math.max(c,C)}if(c===0)return;this.min=f,this.max=g;const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const O=Math.max(E.x,E.y)/c;this.cellsX=Math.max(1,Math.ceil(E.x/O)),this.cellsY=Math.max(1,Math.ceil(E.y/O)),this.xScale=1/O,this.yScale=1/O;const D=[];for(let C=0;C<this.triangleCount;C++){const R=n[s[3*C+0]].sub(this.min),P=n[s[3*C+1]].sub(this.min),k=n[s[3*C+2]].sub(this.min),N=un(Math.floor(Math.min(R.x,P.x,k.x)),this.xScale,this.cellsX),W=un(Math.floor(Math.max(R.x,P.x,k.x)),this.xScale,this.cellsX),X=un(Math.floor(Math.min(R.y,P.y,k.y)),this.yScale,this.cellsY),ee=un(Math.floor(Math.max(R.y,P.y,k.y)),this.yScale,this.cellsY),ne=new Yt(0,0),J=new Yt(0,0),he=new Yt(0,0),ye=new Yt(0,0);for(let Me=X;Me<=ee;++Me){ne.y=J.y=Me*O,he.y=ye.y=(Me+1)*O;for(let Ve=N;Ve<=W;++Ve)ne.x=he.x=Ve*O,J.x=ye.x=(Ve+1)*O,(Nr(R,P,k,ne,J,ye)||Nr(R,P,k,ne,ye,he))&&D.push({cellIdx:Me*this.cellsX+Ve,triIdx:C})}}if(D.length===0)return;D.sort((C,R)=>C.cellIdx-R.cellIdx||C.triIdx-R.triIdx);let w=0;for(;w<D.length;){const C=D[w].cellIdx,R={start:this.payload.length,len:0};for(;w<D.length&&D[w].cellIdx===C;)++R.len,this.payload.push(D[w++].triIdx);this.cells[C]=R}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const c=un(n.x-this.min.x,this.xScale,this.cellsX),m=un(n.y-this.min.y,this.yScale,this.cellsY),f=this.cells[m*this.cellsX+c];if(f){this._lazyInitLookup();for(let g=0;g<f.len;g++){const E=this.payload[f.start+g],O=Math.floor(E/8),D=1<<E%8;if(!(this.lookup[O]&D)&&(this.lookup[O]|=D,s.push(E),s.length===this.triangleCount))return}}}query(n,s,c){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const m=un(n.x-this.min.x,this.xScale,this.cellsX),f=un(s.x-this.min.x,this.xScale,this.cellsX),g=un(n.y-this.min.y,this.yScale,this.cellsY),E=un(s.y-this.min.y,this.yScale,this.cellsY);for(let O=g;O<=E;O++)for(let D=m;D<=f;D++){const w=this.cells[O*this.cellsX+D];if(w)for(let C=0;C<w.len;C++){const R=this.payload[w.start+C],P=Math.floor(R/8),k=1<<R%8;if(!(this.lookup[P]&k)&&(this.lookup[P]|=k,c.push(R),c.length===this.triangleCount))return}}}}function un(u,n,s){return Math.max(0,Math.min(s-1,Math.floor(u*n)))}kn(qt,"TriangleGridIndex");class rr{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const c of this.footprints)s.push({footprint:c,id:n})}populate(n,s,c,m){const f=[];for(const{feature:g,id:E,index:O,sourceLayerIndex:D}of n){const w=this.layers[0]._featureFilter.needGeometry,C=Qt(g,w);if(!this.layers[0]._featureFilter.filter(new Po(this.zoom),C,c))continue;const R={id:E,properties:g.properties,type:g.type,sourceLayerIndex:D,index:O,geometry:w?C.geometry:yt(g,c,m),patterns:{}};f.push(R)}for(const g of f){const{geometry:E,index:O,sourceLayerIndex:D}=g;this.addFeature(g,E,O,c,{},s.availableImages,s.brightness),s.featureIndex.insert(n[O].feature,E,O,D,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,c,m,f){}destroy(){}addFeature(n,s,c,m,f,g=[],E){for(const O of mn(s,2)){const D=[],w=[],C=[],R=new Yt(1/0,1/0),P=new Yt(-1/0,-1/0);for(const W of O)if(W.length!==0){W!==O[0]&&C.push(w.length/2);for(let X=0;X<W.length;X++)w.push(W[X].x),w.push(W[X].y),D.push(W[X]),R.x=Math.min(R.x,W[X].x),R.y=Math.min(R.y,W[X].y),P.x=Math.max(P.x,W[X].x),P.y=Math.max(P.y,W[X].y)}const k=Jh(w,C),N=new qt(D,k,8,256);this.footprints.push({vertices:D,indices:k,grid:N,min:R,max:P})}}}kn(rr,"ClipBucket",{omit:["layers"]});const Wr=Ti([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),mi=Ti([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),gi=Ti([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ai=Ti([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Ms=Ti([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),xo=Ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Qh}=Wr;var Yg,MI,g1,II,_1,CI,OI,uv={};function kI(){if(MI)return Yg;MI=1;var u=Dr();function n(m,f,g,E,O){this.properties={},this.extent=g,this.type=0,this._pbf=m,this._geometry=-1,this._keys=E,this._values=O,m.readFields(s,this,f)}function s(m,f,g){m==1?f.id=g.readVarint():m==2?function(E,O){for(var D=E.readVarint()+E.pos;E.pos<D;){var w=O._keys[E.readVarint()],C=O._values[E.readVarint()];O.properties[w]=C}}(g,f):m==3?f.type=g.readVarint():m==4&&(f._geometry=g.pos)}function c(m){for(var f,g,E=0,O=0,D=m.length,w=D-1;O<D;w=O++)E+=((g=m[w]).x-(f=m[O]).x)*(f.y+g.y);return E}return Yg=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var f,g=m.readVarint()+m.pos,E=1,O=0,D=0,w=0,C=[];m.pos<g;){if(O<=0){var R=m.readVarint();E=7&R,O=R>>3}if(O--,E===1||E===2)D+=m.readSVarint(),w+=m.readSVarint(),E===1&&(f&&C.push(f),f=[]),f.push(new u(D,w));else{if(E!==7)throw new Error("unknown command "+E);f&&f.push(f[0].clone())}}return f&&C.push(f),C},n.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var f=m.readVarint()+m.pos,g=1,E=0,O=0,D=0,w=1/0,C=-1/0,R=1/0,P=-1/0;m.pos<f;){if(E<=0){var k=m.readVarint();g=7&k,E=k>>3}if(E--,g===1||g===2)(O+=m.readSVarint())<w&&(w=O),O>C&&(C=O),(D+=m.readSVarint())<R&&(R=D),D>P&&(P=D);else if(g!==7)throw new Error("unknown command "+g)}return[w,R,C,P]},n.prototype.toGeoJSON=function(m,f,g){var E,O,D=this.extent*Math.pow(2,g),w=this.extent*m,C=this.extent*f,R=this.loadGeometry(),P=n.types[this.type];function k(X){for(var ee=0;ee<X.length;ee++){var ne=X[ee];X[ee]=[360*(ne.x+w)/D-180,360/Math.PI*Math.atan(Math.exp((180-360*(ne.y+C)/D)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(E=0;E<R.length;E++)N[E]=R[E][0];k(R=N);break;case 2:for(E=0;E<R.length;E++)k(R[E]);break;case 3:for(R=function(X){var ee=X.length;if(ee<=1)return[X];for(var ne,J,he=[],ye=0;ye<ee;ye++){var Me=c(X[ye]);Me!==0&&(J===void 0&&(J=Me<0),J===Me<0?(ne&&he.push(ne),ne=[X[ye]]):ne.push(X[ye]))}return ne&&he.push(ne),he}(R),E=0;E<R.length;E++)for(O=0;O<R[E].length;O++)k(R[E][O])}R.length===1?R=R[0]:P="Multi"+P;var W={type:"Feature",geometry:{type:P,coordinates:R},properties:this.properties};return"id"in this&&(W.id=this.id),W},Yg}function RI(){if(II)return g1;II=1;var u=kI();function n(c,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(s,this,m),this.length=this._features.length}function s(c,m,f){c===15?m.version=f.readVarint():c===1?m.name=f.readString():c===5?m.extent=f.readVarint():c===2?m._features.push(f.pos):c===3?m._keys.push(f.readString()):c===4&&m._values.push(function(g){for(var E=null,O=g.readVarint()+g.pos;g.pos<O;){var D=g.readVarint()>>3;E=D===1?g.readString():D===2?g.readFloat():D===3?g.readDouble():D===4?g.readVarint64():D===5?g.readVarint():D===6?g.readSVarint():D===7?g.readBoolean():null}return E}(f))}return g1=n,n.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var m=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,m,this.extent,this._keys,this._values)},g1}function LI(){return OI||(OI=1,uv.VectorTile=function(){if(CI)return _1;CI=1;var u=RI();function n(s,c,m){if(s===3){var f=new u(m,m.readVarint()+m.pos);f.length&&(c[f.name]=f)}}return _1=function(s,c){this.layers=s.readFields(n,{},c)},_1}(),uv.VectorTileFeature=kI(),uv.VectorTileLayer=RI()),uv}var Em=LI();class xp extends Yt{constructor(n,s,c){super(n,s),this.z=c}}class DI extends xp{constructor(n,s,c,m){super(n,s,c),this.w=m}}function cv(u,n,s,c){const m=[],f=c===0?(g,E,O,D,w,C)=>{g.push(new Yt(C,O+(C-E)/(D-E)*(w-O)))}:(g,E,O,D,w,C)=>{g.push(new Yt(E+(C-O)/(w-O)*(D-E),C))};for(const g of u){const E=[];for(const O of g){if(O.length<=2)continue;const D=[];for(let R=0;R<O.length-1;R++){const P=O[R].x,k=O[R].y,N=O[R+1].x,W=O[R+1].y,X=c===0?P:k,ee=c===0?N:W;X<n?ee>n&&f(D,P,k,N,W,n):X>s?ee<s&&f(D,P,k,N,W,s):D.push(O[R]),ee<n&&X>=n&&f(D,P,k,N,W,n),ee>s&&X<=s&&f(D,P,k,N,W,s)}let w=O[O.length-1];const C=c===0?w.x:w.y;C>=n&&C<=s&&D.push(w),D.length&&(w=D[D.length-1],D[0].x===w.x&&D[0].y===w.y||D.push(D[0]),E.push(D))}E.length&&m.push(E)}return m}function zI(u,n,s,c){const m=s==="x"?"y":"x",f=(c-u[s])/(n[s]-u[s]);u[m]=u[m]+(n[m]-u[m])*f,u[s]=c,u.hasOwnProperty("z")&&(u.z=Yn(u.z,n.z,f)),u.hasOwnProperty("w")&&(u.w=Yn(u.w,n.w,f))}function FI(u,n,s,c){const m=s,f=c;for(const g of["x","y"]){let E=u,O=n;E[g]>=O[g]&&(E=n,O=u),E[g]<m&&O[g]>m&&zI(E,O,g,m),E[g]<f&&O[g]>f&&zI(O,E,g,f)}}const hv=Number.MAX_SAFE_INTEGER;function BI(u,n,s,c){return u.order<n||u.order===hv||!(u.clipMask&s)||function(m,f){return f.length!==0&&f.find(g=>g===m)===void 0}(c,u.clipScope)}function fv(u,n){return u.x-n.x||u.y-n.y}function NI(u,n){return fv(u.min,n.min)===0&&fv(u.max,n.max)===0}function y1(u,n){return!(u.min.x>n.max.x||u.max.x<n.min.x||u.min.y>n.max.y||u.max.y<n.min.y)}function v1(u,n){if(u.length!==n.length)return!1;for(let s=0;s<u.length;s++)if(u[s].sourceId!==n[s].sourceId||!NI(u[s],n[s])||u[s].order!==n[s].order||u[s].clipMask!==n[s].clipMask||!Mr(u[s].clipScope,n[s].clipScope))return!1;return!0}function jI(u,n,s){const c=1/En,m=1/(1<<s.canonical.z),f=(n.x*c+s.canonical.x)*m+s.wrap,g=(n.y*c+s.canonical.y)*m;return{min:new Yt((u.x*c+s.canonical.x)*m+s.wrap,(u.y*c+s.canonical.y)*m),max:new Yt(f,g)}}function LU(u,n,s){const c=1<<s.canonical.z,m=((n.x-s.wrap)*c-s.canonical.x)*En,f=(n.y*c-s.canonical.y)*En;return{min:new Yt(((u.x-s.wrap)*c-s.canonical.x)*En,(u.y*c-s.canonical.y)*En),max:new Yt(m,f)}}function $I(u,n,s,c,m,f,g){const E=u.indices,O=u.vertices,D=[];for(let w=c;w<c+m;w+=3){const C=n[s[w+0]+f],R=n[s[w+1]+f],P=n[s[w+2]+f],k=Math.min(C.x,R.x,P.x),N=Math.max(C.x,R.x,P.x),W=Math.min(C.y,R.y,P.y),X=Math.max(C.y,R.y,P.y);D.length=0,u.grid.query(new Yt(k,W),new Yt(N,X),D);for(let ee=0;ee<D.length;ee++){const ne=D[ee];if(Nr(O[E[3*ne+0]],O[E[3*ne+1]],O[E[3*ne+2]],C,R,P,g))return!0}}return!1}function UI(u,n,s,c){if(!u||!s)return!1;let m=u.vertices;if(!n.canonical.equals(c.canonical)||n.wrap!==c.wrap){if(s.vertices.length<u.vertices.length)return UI(s,c,u,n);const f=n.canonical,g=c.canonical,E=Math.pow(2,g.z-f.z);m=u.vertices.map(O=>new Yt((O.x+f.x*En)*E-g.x*En,(O.y+f.y*En)*E-g.y*En))}return $I(s,m,u.indices,0,u.indices.length,0,0)}function VI(u,n,s,c){const m=Math.pow(2,c.z-s.z);return new Yt((u+s.x*En)*m-c.x*En,(n+s.y*En)*m-c.y*En)}function qI(u,n){const s=[];n.grid.queryPoint(u,s);const c=n.indices,m=n.vertices;for(let f=0;f<s.length;f++){const g=s[f];if(si([m[c[3*g+0]],m[c[3*g+1]],m[c[3*g+2]]],u))return!0}return!1}const x1=[new Yt(0,0),new Yt(En,0),new Yt(En,En),new Yt(0,En)];function GI(u,n){const s=[];let c=[];if(!n||u.length<2)return[u];if(u.length===2)return fr(u[0],u[1],x1)?[u]:[];for(let m=0;m<u.length+2;m++){const f=u[m%u.length],g=u[(m+1)%u.length],E=fr(m===0?u[u.length-1]:u[(m-1)%u.length],f,x1),O=fr(f,g,x1),D=E||O;D&&c.push(f),D&&O||c.length>0&&(c.length>1&&s.push(c),c=[])}return c.length>1&&s.push(c),s}const b1=Em.VectorTileFeature.types,DU=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],zU=["fill-extrusion-flood-light-ground-radius"],FU=Math.pow(2,13),BU=Math.pow(2,15)-1,HI=new Yt(0,1),kd=2147483648;function Jg(u,n,s,c,m,f,g,E){u.emplaceBack((n<<1)+g,(s<<1)+f,(Math.floor(c*FU)<<1)+m,Math.round(E))}function Qg(u,n,s){u.emplaceBack(n.x*En,n.y*En,s?1:0)}function dv(u,n,s,c,m,f){u.emplaceBack(n.x,n.y,(s.x<<1)+c,(s.y<<1)+m,f)}function e_(u,n,s){u.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class WI{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class ZI{constructor(){this.centroidXY=new Yt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Yt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Yt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Yt(this.max.x-this.min.x,this.max.y-this.min.y)}}class XI{constructor(){this.acc=new Yt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,c){this.accCount++,this.acc._add(s);let m=!!this.borders;s.x<n.min.x?(n.min.x=s.x,m=!0):s.x>n.max.x&&(n.max.x=s.x,m=!0),s.y<n.min.y?(n.min.y=s.y,m=!0):s.y>n.max.y&&(n.max.y=s.y,m=!0),((s.x===0||s.x===En)&&s.x===c.x)!=((s.y===0||s.y===En)&&s.y===c.y)&&this.processBorderOverlap(s,c),m&&this.checkBorderIntersection(s,c)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,Yn(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>En!=n.x>En&&this.addBorderIntersection(1,Yn(s.y,n.y,(En-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,Yn(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>En!=n.y>En&&this.addBorderIntersection(3,Yn(s.x,n.x,(En-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[n];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const c=n.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,n.y)}else{const c=n.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,n.x)}}centroid(){return this.accCount===0?new Yt(0,0):new Yt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function KI(u,n){const s=u.add(n)._unit(),c=lr(u.x*s.x+u.y*s.y,-1,1);var m,f,g;return g=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(g)))/4*BU*((m=u).x*(f=n).y-m.y*f.x<0?-1:1)}const NU=[u=>u.x<0,u=>u.x>En,u=>u.y<0,u=>u.y>En];function jU(u,n,s,c){const m=[4];if(c===0)return m;s._mult(c);const f=u.sub(s),g=n.sub(s),E=[u,n,f,g];for(let O=0;O<4;O++)for(const D of E)if(NU[O](D)){m.push(O);break}return m}class YI{constructor(n){this.vertexArray=new ka,this.indexArray=new po,this.programConfigurations=new Rl(n.layers,{zoom:n.zoom,lut:n.lut},s=>zU.includes(s)),this._segments=new $o,this.hiddenByLandmarkVertexArray=new Rf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new $o}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,c,m=!1){const f=n.length;if(f>2){let g=Math.max(0,this._segments.get().length-1);const E=this._segments._prepareSegment(4*f,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let O;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const D=n[0],w=n[1];O=KI(D.sub(n[f-1])._perp()._unit(),w.sub(D)._perp()._unit())}for(let D=0;D<f;D++){const w=D===f-1?0:D+1,C=n[D],R=n[w],P=n[w===f-1?0:w+1],k=R.sub(C)._perp()._unit(),N=KI(k,P.sub(R)._perp()._unit()),W=O,X=N;if(w1(C,R,s)||m&&eC(C,s)&&eC(R,s)){O=N;continue}const ee=E.vertexLength;dv(this.vertexArray,C,R,1,1,W),dv(this.vertexArray,C,R,1,0,W),dv(this.vertexArray,C,R,0,1,X),dv(this.vertexArray,C,R,0,0,X),E.vertexLength+=4;const ne=jU(C,R,k,c);for(const J of ne)this._segmentToGroundQuads[g].push({id:ee,region:J}),this._segmentToRegionTriCounts[g][J]+=2,E.primitiveLength+=2;O=N}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let c=0;c<s;c++)this._segmentToGroundQuads[c].sort((m,f)=>m.region-f.region);for(let c=0;c<s;c++){const m=this._segmentToGroundQuads[c],f=n[c],g=this._segmentToRegionTriCounts[c];g.reduce((O,D)=>O+D,0);let E=0;for(let O=0;O<=4;O++){const D=g[O];if(D!==0){let w=this.regionSegments[O];w||(w=this.regionSegments[O]=new $o);const C={vertexOffset:f.vertexOffset,primitiveOffset:f.primitiveOffset+E,vertexLength:f.vertexLength,primitiveLength:D};w.get().push(C)}E+=D}for(let O=0;O<m.length;O++){const D=m[O].id;this.indexArray.emplaceBack(D,D+1,D+3),this.indexArray.emplaceBack(D,D+3,D+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,c,m,f,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,c,m,f,g)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,mi.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,c,m,f,g){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,c,m,f,g)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const c=n.flags&kd?1:0;for(let m=n.groundVertexArrayOffset;m<s;++m)this.hiddenByLandmarkVertexArray.emplace(m,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,Ms.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class pv{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new po,this.footprintVertices=new xu,this.footprintSegments=[],this.layoutVertexArray=new Oo,this.centroidVertexArray=new hm,this.wallVertexArray=new bd,this.indexArray=new po,this.programConfigurations=new Rl(n.layers,{zoom:n.zoom,lut:n.lut},s=>DU.includes(s)),this.segments=new $o,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new YI(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,c,m){this.features=[],this.hasPattern=Wn("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=it(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:f,id:g,index:E,sourceLayerIndex:O}of n){const D=this.layers[0]._featureFilter.needGeometry,w=Qt(f,D);if(!this.layers[0]._featureFilter.filter(new Po(this.zoom),w,c))continue;const C={id:g,sourceLayerIndex:O,index:E,geometry:D?w.geometry:yt(f,c,m),properties:f.properties,type:f.type,patterns:{}},R=this.layoutVertexArray.length,P=b1[C.type]==="Polygon";if(this.hasPattern)this.features.push(jn("fill-extrusion",this.layers,C,this.zoom,s));else if(this.wallMode)for(const k of C.geometry)for(const N of GI(k,P))this.addFeature(C,[N],E,c,{},s.availableImages,m,s.brightness);else this.addFeature(C,C.geometry,E,c,{},s.availableImages,m,s.brightness);s.featureIndex.insert(f,C.geometry,E,O,this.index,R)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,c,m,f,g){for(const E of this.features){const O=b1[E.type]==="Polygon",{geometry:D}=E;if(this.wallMode)for(const w of D)for(const C of GI(w,O))this.addFeature(E,[C],E.index,s,c,m,f,g);else this.addFeature(E,D,E.index,s,c,m,f,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,c,m,f){const g=Object.keys(n).length!==0;if(g&&!this.stateDependentLayers.length)return;const E=g?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(n,s,E,c,m,f),this.groundEffect.update(n,s,E,c,m,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Qh),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,Ai.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,xo.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,gi.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,c,m,f,g,E,O){const D=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,w=[new Yt(0,0),new Yt(En,En)],C=E.projection,R=C.name==="globe",P=this.wallMode||b1[n.type]==="Polygon",k=new XI;k.centroidDataIndex=this.centroidData.length;const N=new ZI,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},m)<=0,X=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},m);let ee;if(N.height=X,N.vertexArrayOffset=this.layoutVertexArray.length,N.groundVertexArrayOffset=this.groundEffect.vertexArray.length,R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ua),this.wallMode){if(R)return void Er("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;ee=function($e){const ot=$e[0].x===$e[$e.length-1].x&&$e[0].y===$e[$e.length-1].y;(function(xn){let cn=0;const ur=xn.length;for(let zn=0;zn<ur;zn++)cn+=(xn[(zn+1)%ur].x-xn[zn].x)*(xn[(zn+1)%ur].y+xn[zn].y);return cn>=0})($e)||($e=$e.reverse());const nt={geometry:[],joinNormals:[],indices:[]},ct=[],ht=[],_t=[];let At=$e.length;if(At<(ot?3:2))return nt;for(;At>=2&&$e[At-1].equals($e[At-2]);)At--;let It,wt,Xt,pn,Ut,Fn=0;for(;Fn<At-1&&$e[Fn].equals($e[Fn+1]);)Fn++;ot&&(It=$e[At-2],Ut=$e[Fn].sub(It)._unit()._perp());for(let xn=Fn;xn<At;xn++){if(Xt=xn===At-1?ot?$e[Fn+1]:void 0:$e[xn+1],Xt&&$e[xn].equals(Xt))continue;Ut&&(pn=Ut),It&&(wt=It),It=$e[xn],Ut=Xt?Xt.sub(It)._unit()._perp():pn,pn=pn||Ut;let cn=pn.add(Ut);cn.x===0&&cn.y===0||cn._unit();const ur=cn.x*Ut.x+cn.y*Ut.y,zn=ur!==0?1/ur:1/0,qn=pn.x*Ut.y-pn.y*Ut.x>0;let Lr="miter";const Xr=2;Lr==="miter"&&zn>Xr&&(Lr="bevel"),Lr==="bevel"&&(zn>100&&(Lr="flipbevel"),zn<Xr&&(Lr="miter"));const ei=(Vr,fi,ui,oo)=>{const Yi=new Yt(Vr.x,Vr.y),Tr=new Yt(Vr.x,Vr.y);Yi.x+=fi.x*oo,Yi.y+=fi.y*oo,Tr.x-=fi.x*Math.max(ui,1),Tr.y-=fi.y*Math.max(ui,1),_t.push(fi),ct.push(Yi),ht.push(Tr)};if(Lr==="miter")cn._mult(zn),ei(It,cn,0,0);else if(Lr==="flipbevel")cn=Ut.mult(-1),ei(It,cn,0,0),ei(It,cn.mult(-1),0,0);else{const Vr=-Math.sqrt(zn*zn-1),fi=qn?Vr:0,ui=qn?0:Vr;wt&&ei(It,pn,fi,ui),Xt&&ei(It,Ut,fi,ui)}}nt.geometry=[...ct,...ht.reverse(),ct[0]],nt.joinNormals=[..._t,..._t.reverse(),_t[_t.length-1]];const An=nt.geometry.length-1;for(let xn=0;xn<An/2;xn++)if(xn+1<An/2){let cn=xn,ur=xn+1,zn=An-1-xn,qn=An-2-xn;cn=cn===0?An-1:cn-1,ur=ur===0?An-1:ur-1,zn=zn===0?An-1:zn-1,qn=qn===0?An-1:qn-1,nt.indices.push(zn),nt.indices.push(ur),nt.indices.push(cn),nt.indices.push(zn),nt.indices.push(qn),nt.indices.push(ur)}return nt}(s[0]),s=[ee.geometry]}const ne=($e,ot)=>$e<(ot.length-1)/2||$e===ot.length-1,J=this.wallMode?[s]:mn(s,500);for(let $e=J.length-1;$e>=0;$e--){const ot=J[$e];(ot.length===0||(he=ot[0]).every(je=>je.x<=0)||he.every(je=>je.x>=En)||he.every(je=>je.y<=0)||he.every(je=>je.y>=En))&&J.splice($e,1)}var he;let ye;if(R)ye=iC(J,w,m);else{ye=[];for(const $e of J)ye.push({polygon:$e,bounds:w})}const Me=P?this.edgeRadius:0,Ve=Me>0&&this.zoom<17,Ne=($e,ot)=>{if($e.length===0)return!1;const je=$e[$e.length-1];return ot.x===je.x&&ot.y===je.y};for(const{polygon:$e,bounds:ot}of ye){let je=0,nt=0;for(const At of $e)P&&!At[0].equals(At[At.length-1])&&At.push(At[0]),nt+=P?At.length-1:At.length;const ct=this.segments.prepareSegment((P?5:4)*nt,this.layoutVertexArray,this.indexArray);N.footprintSegIdx<0&&(N.footprintSegIdx=this.footprintSegments.length),N.polygonSegIdx<0&&(N.polygonSegIdx=this.polygonSegments.length);const ht={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},_t=new WI;if(_t.vertexOffset=this.footprintVertices.length,_t.indexOffset=3*this.footprintIndices.length,_t.ringIndices=[],P){const At=[],It=[];je=ct.vertexLength;for(let Xt=0;Xt<$e.length;Xt++){const pn=$e[Xt];pn.length&&Xt!==0&&It.push(At.length/2);const Ut=[];let Fn,An;Fn=pn[1].sub(pn[0])._perp()._unit(),_t.ringIndices.push(pn.length-1);for(let xn=1;xn<pn.length;xn++){const cn=pn[xn],ur=pn[xn===pn.length-1?1:xn+1],zn=cn.clone();if(Me){An=ur.sub(cn)._perp()._unit();const qn=Fn.add(An)._unit(),Lr=Me*Math.min(4,1/(Fn.x*qn.x+Fn.y*qn.y));zn.x+=Lr*qn.x,zn.y+=Lr*qn.y,zn.x=Math.round(zn.x),zn.y=Math.round(zn.y),Fn=An}if(!W||Me!==0&&!Ve||Ne(Ut,zn)||Ut.push(zn),Jg(this.layoutVertexArray,zn.x,zn.y,0,0,1,1,0),this.wallMode){const qn=ne(xn,pn);Qg(this.wallVertexArray,ee.joinNormals[xn],!qn)}ct.vertexLength++,this.footprintVertices.emplaceBack(cn.x,cn.y),At.push(cn.x,cn.y),R&&e_(this.layoutVertexExtArray,C.projectTilePoint(zn.x,zn.y,m),C.upVector(m,zn.x,zn.y))}W&&(Me===0||Ve)&&(Ut.length!==0&&Ne(Ut,Ut[0])&&Ut.pop(),this.groundEffect.addData(Ut,ot,D))}const wt=this.wallMode?ee.indices:Jh(At,It);for(let Xt=0;Xt<wt.length;Xt+=3)this.footprintIndices.emplaceBack(_t.vertexOffset+wt[Xt+0],_t.vertexOffset+wt[Xt+1],_t.vertexOffset+wt[Xt+2]),this.indexArray.emplaceBack(je+wt[Xt],je+wt[Xt+2],je+wt[Xt+1]),ct.primitiveLength++;_t.indexCount+=wt.length,_t.vertexCount+=this.footprintVertices.length-_t.vertexOffset}for(let At=0;At<$e.length;At++){const It=$e[At];k.startRing(N,It[0]);let wt=It.length>4&&tC(It[It.length-2],It[0],It[1]),Xt=Me?$U(It[It.length-2],It[0],It[1],Me):0;const pn=[];let Ut,Fn,An;Fn=It[1].sub(It[0])._perp()._unit();let xn=!0;for(let cn=1,ur=0;cn<It.length;cn++){let zn=It[cn-1],qn=It[cn];const Lr=It[cn===It.length-1?1:cn+1];if(k.appendEdge(N,qn,zn),w1(qn,zn,ot)){Me&&(Fn=Lr.sub(qn)._perp()._unit(),xn=!xn);continue}const Xr=qn.sub(zn)._perp(),ei=Xr.x/(Math.abs(Xr.x)+Math.abs(Xr.y)),Vr=Xr.y>0?1:0,fi=zn.dist(qn);if(ur+fi>32768&&(ur=0),Me){An=Lr.sub(qn)._perp()._unit();let Tr=QI(zn,qn,Lr,JI(Fn,An),Me);isNaN(Tr)&&(Tr=0);const $i=qn.sub(zn)._unit();zn=zn.add($i.mult(Xt))._round(),qn=qn.add($i.mult(-Tr))._round(),Xt=Tr,Fn=An,W&&this.zoom>=17&&(Ne(pn,zn)||pn.push(zn),Ne(pn,qn)||pn.push(qn))}const ui=ct.vertexLength,oo=It.length>4&&tC(zn,qn,Lr);let Yi=nC(ur,wt,xn);if(Jg(this.layoutVertexArray,zn.x,zn.y,ei,Vr,0,0,Yi),Jg(this.layoutVertexArray,zn.x,zn.y,ei,Vr,0,1,Yi),this.wallMode){const Tr=ne(cn-1,It),$i=ee.joinNormals[cn-1];Qg(this.wallVertexArray,$i,Tr),Qg(this.wallVertexArray,$i,Tr)}if(ur+=fi,Yi=nC(ur,oo,!xn),wt=oo,Jg(this.layoutVertexArray,qn.x,qn.y,ei,Vr,0,0,Yi),Jg(this.layoutVertexArray,qn.x,qn.y,ei,Vr,0,1,Yi),this.wallMode){const Tr=ne(cn,It),$i=ee.joinNormals[cn];Qg(this.wallVertexArray,$i,Tr),Qg(this.wallVertexArray,$i,Tr)}if(ct.vertexLength+=4,this.indexArray.emplaceBack(ui+0,ui+1,ui+2),this.indexArray.emplaceBack(ui+1,ui+3,ui+2),ct.primitiveLength+=2,Me){const Tr=je+(cn===1?It.length-2:cn-2),$i=cn===1?je:Tr+1;if(this.indexArray.emplaceBack(ui+1,Tr,ui+3),this.indexArray.emplaceBack(Tr,$i,ui+3),ct.primitiveLength+=2,Ut===void 0&&(Ut=ui),!w1(Lr,It[cn],ot)){const qi=cn===It.length-1?Ut:ct.vertexLength;this.indexArray.emplaceBack(ui+2,ui+3,qi),this.indexArray.emplaceBack(ui+3,qi+1,qi),this.indexArray.emplaceBack(ui+3,$i,qi+1),ct.primitiveLength+=3}xn=!xn}if(R){const Tr=this.layoutVertexExtArray,$i=C.projectTilePoint(zn.x,zn.y,m),qi=C.projectTilePoint(qn.x,qn.y,m),bo=C.upVector(m,zn.x,zn.y),ga=C.upVector(m,qn.x,qn.y);e_(Tr,$i,bo),e_(Tr,$i,bo),e_(Tr,qi,ga),e_(Tr,qi,ga)}}P&&(je+=It.length-1),W&&Me&&this.zoom>=17&&(pn.length!==0&&Ne(pn,pn[0])&&pn.pop(),this.groundEffect.addData(pn,ot,D,Me>0))}this.footprintSegments.push(_t),ht.triangleCount=this.indexArray.length-ht.triangleArrayOffset,this.polygonSegments.push(ht),++N.footprintSegLen,++N.polygonSegLen}if(N.vertexCount=this.layoutVertexArray.length-N.vertexArrayOffset,N.groundVertexCount=this.groundEffect.vertexArray.length-N.groundVertexArrayOffset,N.vertexCount!==0){if(N.centroidXY=k.borders?HI:this.encodeCentroid(k,N),this.centroidData.push(N),k.borders){this.featuresOnBorder.push(k);const $e=this.featuresOnBorder.length-1;for(let ot=0;ot<k.borders.length;ot++)k.borders[ot][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ot].push($e)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,g,m,O),this.groundEffect.addPaintPropertiesData(n,c,f,g,m,O),this.maxHeight=Math.max(this.maxHeight,X)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,c)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[c].borders[n][0])}splitToSubtiles(){const n=[];for(let E=0;E<this.centroidData.length;E++){const O=this.centroidData[E],D=+(O.min.y+O.max.y>En),w=2*D+(+(O.min.x+O.max.x>En)^D);for(let C=0;C<O.polygonSegLen;C++){const R=O.polygonSegIdx+C;n.push({centroidIdx:E,subtile:w,polygonSegmentIdx:R,triangleSegmentIdx:this.polygonSegments[R].triangleSegIdx})}}const s=new po;n.sort((E,O)=>E.triangleSegmentIdx===O.triangleSegmentIdx?E.subtile-O.subtile:E.triangleSegmentIdx-O.triangleSegmentIdx);let c=0,m=0,f=0;for(const E of n){if(E.triangleSegmentIdx!==c)break;f++}const g=n.length;for(;m!==n.length;){c=n[m].triangleSegmentIdx;let E=0,O=m,D=m;for(let w=O;w<f&&n[w].subtile===E;w++)D++;for(;O!==f;){const w=n[O];E=w.subtile;const C=this.centroidData[w.centroidIdx].min.clone(),R=this.centroidData[w.centroidIdx].max.clone(),P={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let k=O;k<D;k++){const N=n[k],W=this.polygonSegments[N.polygonSegmentIdx],X=this.centroidData[N.centroidIdx].min,ee=this.centroidData[N.centroidIdx].max,ne=this.indexArray.uint16;for(let J=W.triangleArrayOffset;J<W.triangleArrayOffset+W.triangleCount;J++)s.emplaceBack(ne[3*J],ne[3*J+1],ne[3*J+2]);P.primitiveLength+=W.triangleCount,C.x=Math.min(C.x,X.x),C.y=Math.min(C.y,X.y),R.x=Math.max(R.x,ee.x),R.y=Math.max(R.y,ee.y)}P.primitiveLength>0&&this.triangleSubSegments.push({segment:P,min:C,max:R}),O=D;for(let k=O;k<f&&n[k].subtile===n[O].subtile;k++)D++}m=f;for(let w=m;w<g&&n[w].triangleSegmentIdx===n[m].triangleSegmentIdx;w++)f++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,c){const m=new $o;if(this.wallMode){for(const N of this.triangleSubSegments)m.segments.push(N.segment);return m}let f=0,g=0;const E=1<<n.canonical.z;if(s){const N=s.getMinMaxForTile(n);N&&(f=N.min,g=N.max)}g+=this.maxHeight;const O=n.toUnwrapped();let D;const w=[O.canonical.x/E+O.wrap,O.canonical.y/E],C=[(O.canonical.x+1)/E+O.wrap,(O.canonical.y+1)/E],R=(N,W,X)=>[N[0]*(1-X[0])+W[0]*X[0],N[1]*(1-X[1])+W[1]*X[1]],P=[],k=[];for(const N of this.triangleSubSegments){P[0]=N.min.x/En,P[1]=N.min.y/En,k[0]=N.max.x/En,k[1]=N.max.y/En;const W=R(w,C,P),X=R(w,C,k);if(new pi([W[0],W[1],f],[X[0],X[1],g]).intersectsPrecise(c)===0){D&&(m.segments.push(D),D=void 0);continue}const ee=N.segment;D&&D.vertexOffset!==ee.vertexOffset&&(m.segments.push(D),D=void 0),D?(D.vertexLength+=ee.vertexLength,D.primitiveLength+=ee.primitiveLength):D={vertexOffset:ee.vertexOffset,primitiveLength:ee.primitiveLength,vertexLength:ee.vertexLength,primitiveOffset:ee.primitiveOffset,sortKey:void 0,vaos:{}}}return D&&m.segments.push(D),m}encodeCentroid(n,s){const c=n.centroid(),m=s.span(),f=Math.min(7,Math.round(m.x*this.tileToMeter/10)),g=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new Yt(lr(c.x,1,En-1)<<3|f,lr(c.y,1,En-1)<<3|g)}encodeBorderCentroid(n){if(!n.borders)return new Yt(0,0);const s=n.borders,c=Number.MAX_VALUE;if(s[0][0]!==c||s[1][0]!==c){const m=s[0][0]!==c?0:1;return new Yt(6|(s[0][0]!==c?0:65528),(s[m][0]+s[m][1])/2<<3|6)}{const m=s[2][0]!==c?2:3;return new Yt((s[m][0]+s[m][1])/2<<3|6,6|(s[2][0]!==c?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=kd,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,c=n.vertexCount+n.vertexArrayOffset,m=n.flags&kd?HI:n.centroidXY,f=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==m.y||f!==m.x){for(let g=s;g<c;++g)this.centroidVertexArray.emplace(g,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,c){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const m=s.getReplacementRegionsForTile(n.toUnwrapped());if(v1(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const f=[];for(const g of this.activeReplacements){if(g.order<c)continue;const E=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-n.canonical.z));for(const O of this.centroidData)if(!(O.flags&kd||g.min.x>O.max.x||O.min.x>g.max.x||g.min.y>O.max.y||O.min.y>g.max.y))for(let D=0;D<O.footprintSegLen;D++){const w=this.footprintSegments[O.footprintSegIdx+D];if(f.length=0,UU(this.footprintVertices,w.vertexOffset,w.vertexCount,g.footprintTileId.canonical,n.canonical,f),$I(g.footprint,f,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-E)){O.flags|=kd;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,c){let m=!1;for(let f=0;f<c.footprintSegLen;f++){const g=this.footprintSegments[c.footprintSegIdx+f];let E=0;for(const O of g.ringIndices){for(let D=E,w=O+E-1;D<O+E;w=D++){const C=this.footprintVertices.int16[2*(D+g.vertexOffset)+0],R=this.footprintVertices.int16[2*(D+g.vertexOffset)+1],P=this.footprintVertices.int16[2*(w+g.vertexOffset)+1];R>s!=P>s&&n<(this.footprintVertices.int16[2*(w+g.vertexOffset)+0]-C)*(s-R)/(P-R)+C&&(m=!m)}E=O}}return m}getHeightAtTileCoord(n,s){let c=Number.NEGATIVE_INFINITY,m=!0;const f=4*(n+En)*En+(s+En);if(this.partLookup.hasOwnProperty(f)){const g=this.partLookup[f];return g?{height:g.height,hidden:!!(g.flags&kd)}:void 0}for(const g of this.centroidData)n>g.max.x||g.min.x>n||s>g.max.y||g.min.y>s||this.footprintContainsPoint(n,s,g)&&g&&g.height>c&&(c=g.height,this.partLookup[f]=g,m=!!(g.flags&kd));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:m};this.partLookup[f]=void 0}}function JI(u,n){const s=u.add(n)._unit();return u.x*s.x+u.y*s.y}function $U(u,n,s,c){const m=n.sub(u)._perp()._unit(),f=s.sub(n)._perp()._unit();return QI(u,n,s,JI(m,f),c)}function QI(u,n,s,c,m){const f=Math.sqrt(1-c*c);return Math.min(u.dist(n)/3,n.dist(s)/3,m*f/c)}function w1(u,n,s){return u.x<s[0].x&&n.x<s[0].x||u.x>s[1].x&&n.x>s[1].x||u.y<s[0].y&&n.y<s[0].y||u.y>s[1].y&&n.y>s[1].y}function eC(u,n){return u.x<n[0].x||u.x>n[1].x||u.y<n[0].y||u.y>n[1].y}function tC(u,n,s){if(u.x<0||u.x>=En||n.x<0||n.x>=En||s.x<0||s.x>=En)return!1;const c=s.sub(n),m=c.perp(),f=u.sub(n);return(c.x*f.x+c.y*f.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(f.x*f.x+f.y*f.y))>-.866&&m.x*f.x+m.y*f.y<0}function nC(u,n,s){const c=n?2|u:-3&u;return s?1|c:-2&c}function rC(){const u=Math.PI/32,n=Math.tan(u),s=j;return s*Math.sqrt(1+2*n*n)-s}function iC(u,n,s){const c=1<<s.z,m=ze(s.x/c),f=ze((s.x+1)/c),g=Ue(s.y/c),E=Ue((s.y+1)/c);return function(O,D,w,C,R=0,P){const k=[];if(!O.length||!w||!C)return k;const N=(ye,Me)=>{for(const Ve of ye)k.push({polygon:Ve,bounds:Me})},W=Math.ceil(Math.log2(w)),X=Math.ceil(Math.log2(C)),ee=W-X,ne=[];for(let ye=0;ye<Math.abs(ee);ye++)ne.push(ee>0?0:1);for(let ye=0;ye<Math.min(W,X);ye++)ne.push(0),ne.push(1);let J=O;if(J=cv(J,D[0].y-R,D[1].y+R,1),J=cv(J,D[0].x-R,D[1].x+R,0),!J.length)return k;const he=[];for(ne.length?he.push({polygons:J,bounds:D,depth:0}):N(J,D);he.length;){const ye=he.pop(),Me=ye.depth,Ve=ne[Me],Ne=ye.bounds[0],$e=ye.bounds[1],ot=Ve===0?Ne.x:Ne.y,je=Ve===0?$e.x:$e.y,nt=P?P(Ve,ot,je):.5*(ot+je),ct=cv(ye.polygons,ot-R,nt+R,Ve),ht=cv(ye.polygons,nt-R,je+R,Ve);if(ct.length){const _t=[Ne,new Yt(Ve===0?nt:$e.x,Ve===1?nt:$e.y)];ne.length>Me+1?he.push({polygons:ct,bounds:_t,depth:Me+1}):N(ct,_t)}if(ht.length){const _t=[new Yt(Ve===0?nt:Ne.x,Ve===1?nt:Ne.y),$e];ne.length>Me+1?he.push({polygons:ht,bounds:_t,depth:Me+1}):N(ht,_t)}}return k}(u,n,Math.ceil((f-m)/11.25),Math.ceil((g-E)/11.25),1,(O,D,w)=>{if(O===0)return .5*(D+w);{const C=Ue((s.y+D/En)/c);return(Te(.5*(Ue((s.y+w/En)/c)+C))*c-s.y)*En}})}function UU(u,n,s,c,m,f){const g=Math.pow(2,c.z-m.z);for(let E=0;E<s;E++){let O=u.int16[2*(E+n)+0],D=u.int16[2*(E+n)+1];O=(O+m.x*En)*g-c.x*En,D=(D+m.y*En)*g-c.y*En,f.push(new Yt(O,D))}}let oC,aC;function t_(u,n){return u.x*n.x+u.y*n.y}function sC(u,n){if(u.length===1){let s=0;const c=n[s++];let m;for(;!m||c.equals(m);)if(m=n[s++],!m)return 1/0;for(;s<n.length;s++){const f=n[s],g=u[0],E=m.sub(c),O=f.sub(c),D=g.sub(c),w=t_(E,E),C=t_(E,O),R=t_(O,O),P=t_(D,E),k=t_(D,O),N=w*R-C*C,W=(R*P-C*k)/N,X=(w*k-C*P)/N,ee=c.z*(1-W-X)+m.z*W+f.z*X;if(isFinite(ee))return ee}return 1/0}{let s=1/0;for(const c of n)s=Math.min(s,c.z);return s}}function lC(u,n,s,c,m,f,g,E){const O=g*m.getElevationAt(u,n,!0,!0),D=f[0]!==0,w=D?f[1]===0?g*(f[0]/7-450):g*function(C,R,P){const k=Math.floor(R[0]/8),N=Math.floor(R[1]/8),W=10*(R[0]-8*k),X=10*(R[1]-8*N),ee=C.getElevationAt(k,N,!0,!0),ne=C.getMeterToDEM(P),J=Math.floor(.5*(W*ne-1)),he=Math.floor(.5*(X*ne-1)),ye=C.tileCoordToPixel(k,N),Me=2*J+1,Ve=2*he+1,Ne=function(ht,_t,At,It,wt){return[ht.getElevationAtPixel(_t,At,!0),ht.getElevationAtPixel(_t+wt,At,!0),ht.getElevationAtPixel(_t,At+wt,!0),ht.getElevationAtPixel(_t+It,At+wt,!0)]}(C,ye.x-J,ye.y-he,Me,Ve),$e=Math.abs(Ne[0]-Ne[1]),ot=Math.abs(Ne[2]-Ne[3]),je=Math.abs(Ne[0]-Ne[2])+Math.abs(Ne[1]-Ne[3]),nt=Math.min(.25,.5*ne*($e+ot)/Me),ct=Math.min(.25,.5*ne*je/Ve);return ee+Math.max(nt*W,ct*X)}(m,f,E):O;return{base:O+(s===0?-1:s),top:D?Math.max(w+c,O+s+2):O+c}}kn(pv,"FillExtrusionBucket",{omit:["layers","features"]}),kn(ZI,"PartData"),kn(WI,"FootprintSegment"),kn(XI,"BorderCentroidData"),kn(YI,"GroundEffect");const VU=Ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),qU=Ti([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:GU}=VU,HU=Ti([{name:"a_packed",components:4,type:"Float32"}]),{members:WU}=HU,ZU=Ti([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:XU}=ZU;class uC{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new Yh({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const c=this.getKey(n,s);return this.positions[c]}trim(){const n=this.width,s=this.height=va(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,c){const m=[];let f=n.length%2==1?-n[n.length-1]*c:0,g=n[0]*c,E=!0;m.push({left:f,right:g,isDash:E,zeroLength:n[0]===0});let O=n[0];for(let D=1;D<n.length;D++){E=!E;const w=n[D];f=O*c,O+=w,g=O*c,m.push({left:f,right:g,isDash:E,zeroLength:w===0})}return m}addRoundDash(n,s,c){const m=s/2;for(let f=-c;f<=c;f++){const g=this.width*(this.nextRow+c+f);let E=0,O=n[E];for(let D=0;D<this.width;D++){D/O.right>1&&(O=n[++E]);const w=Math.abs(D-O.left),C=Math.abs(D-O.right),R=Math.min(w,C);let P;const k=f/c*(m+1);if(O.isDash){const N=m-Math.abs(k);P=Math.sqrt(R*R+N*N)}else P=m-Math.sqrt(R*R+k*k);this.image.data[g+D]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(n,s){for(let O=n.length-1;O>=0;--O){const D=n[O],w=n[O+1];D.zeroLength?n.splice(O,1):w&&w.isDash===D.isDash&&(w.left=D.left,n.splice(O,1))}const c=n[0],m=n[n.length-1];c.isDash===m.isDash&&(c.left=m.left-this.width,m.right=c.right+this.width);const f=this.width*this.nextRow;let g=0,E=n[g];for(let O=0;O<this.width;O++){O/E.right>1&&(E=n[++g]);const D=Math.abs(O-E.left),w=Math.abs(O-E.right),C=Math.min(D,w);this.image.data[f+O]=Math.max(0,Math.min(255,(E.isDash?C:-C)+s+128))}}addDash(n,s){const c=this.getKey(n,s);if(this.positions[c])return this.positions[c];const m=s==="round",f=m?7:0,g=2*f+1;if(this.nextRow+g>this.height)return Er("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let w=0;w<n.length;w++)n[w]<0&&(Er("Negative value is found in line dasharray, replacing values with 0"),n[w]=0),E+=n[w];if(E!==0){const w=this.width/E,C=this.getDashRanges(n,this.width,w);m?this.addRoundDash(C,w,f):this.addRegularDash(C,s==="square"?.5*w:0)}const O=this.nextRow+f;this.nextRow+=g;const D={tl:[O,f],br:[E,0]};return this.positions[c]=D,D}}kn(uC,"LineAtlas");const KU=Em.VectorTileFeature.types,YU=Math.cos(Math.PI/180*37.5),JU=Math.cos(Math.PI/180*5);class S1{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Ta,this.layoutVertexArray2=new Il,this.patternVertexArray=new Cl,this.indexArray=new po,this.programConfigurations=new Rl(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new $o,this.maxLineLength=0,this.zOffsetVertexArray=new _h,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:En/64}updateFootprints(n,s){}populate(n,s,c,m){this.hasPattern=Wn("line",this.layers,s);const f=this.layers[0].layout.get("line-sort-key");this.hasZOffset=!this.layers[0].isDraped();const g=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&g==="none"&&Er(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const E=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&E!==void 0;const O=[];for(const{feature:R,id:P,index:k,sourceLayerIndex:N}of n){const W=this.layers[0]._featureFilter.needGeometry,X=Qt(R,W);if(!this.layers[0]._featureFilter.filter(new Po(this.zoom),X,c))continue;const ee=f?f.evaluate(X,{},c):void 0,ne={id:P,properties:R.properties,type:R.type,sourceLayerIndex:N,index:k,geometry:W?X.geometry:yt(R,c,m),patterns:{},sortKey:ee};O.push(ne)}f&&O.sort((R,P)=>R.sortKey-P.sortKey);const{lineAtlas:D,featureIndex:w}=s,C=this.addConstantDashes(D);for(const R of O){const{geometry:P,index:k,sourceLayerIndex:N}=R;if(C&&this.addFeatureDashes(R,D),this.hasPattern){const W=jn("line",this.layers,R,this.zoom,s);this.patternFeatures.push(W)}else this.addFeature(R,P,k,c,D.positions,s.availableImages,s.brightness);w.insert(n[k].feature,P,k,N,this.index)}}addConstantDashes(n){let s=!1;for(const c of this.layers){const m=c.paint.get("line-dasharray").value,f=c.layout.get("line-cap").value;if(m.kind!=="constant"||f.kind!=="constant")s=!0;else{const g=f.value,E=m.value;if(!E)continue;n.addDash(E,g)}}return s}addFeatureDashes(n,s){const c=this.zoom;for(const m of this.layers){const f=m.paint.get("line-dasharray").value,g=m.layout.get("line-cap").value;if(f.kind==="constant"&&g.kind==="constant")continue;let E,O;if(f.kind==="constant"){if(E=f.value,!E)continue}else E=f.evaluate({zoom:c},n);O=g.kind==="constant"?g.value:g.evaluate({zoom:c},n),s.addDash(E,O),n.patterns[m.id]=s.getKey(E,O)}}update(n,s,c,m,f){const g=Object.keys(n).length!==0;g&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(n,s,g?this.stateDependentLayers:this.layers,c,m,f)}addFeatures(n,s,c,m,f,g){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,s,c,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,WU)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,XU)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,qU.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,GU),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,c,m,f,g,E){const O=this.layers[0].layout,D=O.get("line-join").evaluate(n,{}),w=O.get("line-cap").evaluate(n,{}),C=O.get("line-miter-limit"),R=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=O.get("line-z-offset").value;for(const P of s)this.addLine(P,n,m,D,w,C,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,g,m,E)}addLine(n,s,c,m,f,g,E){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=m==="none";if(this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<n.length-1;ne++)this.totalDistance+=n[ne].dist(n[ne+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=KU[s.type]==="Polygon";let w=n.length;for(;w>=2&&n[w-1].equals(n[w-2]);)w--;let C=0;for(;C<w-1&&n[C].equals(n[C+1]);)C++;if(w<(D?3:2))return;m==="bevel"&&(g=1.05);const R=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let P,k,N,W,X,ee;this.e1=this.e2=-1,D&&(P=n[w-2],X=n[C].sub(P)._unit()._perp());for(let ne=C;ne<w;ne++){if(N=ne===w-1?D?n[C+1]:void 0:n[ne+1],N&&n[ne].equals(N))continue;X&&(W=X),P&&(k=P),P=n[ne],ee=this.hasZOffset?this.evaluateElevationValue(k?k.dist(P):0):null,X=N?N.sub(P)._unit()._perp():W,W=W||X;const J=k&&N;let he=J?m:D||O?"butt":f;const ye=W.x*X.x+W.y*X.y;if(O){const ct=function(ht){if(ht.patternJoinNone){const _t=ht.segmentPoints.length/2,At=ht.lineSoFar-ht.segmentStart;for(let It=0;It<_t;++It){const wt=ht.segmentPoints[2*It+1],Xt=Math.round(ht.segmentPoints[2*It])+.5+.25*wt;ht.patternVertexArray.emplaceBack(Xt,At,ht.segmentStart),ht.patternVertexArray.emplaceBack(Xt,At,ht.segmentStart)}ht.segmentPoints.length=0}ht.e1=ht.e2=-1};if(J&&ye<JU){this.updateDistance(k,P),this.addCurrentVertex(P,W,1,1,R,ee),ct(this),this.addCurrentVertex(P,X,-1,-1,R,ee);continue}if(k){if(!N){this.updateDistance(k,P),this.addCurrentVertex(P,W,1,1,R,ee),ct(this);continue}he="miter"}}let Me=W.add(X);Me.x===0&&Me.y===0||Me._unit();const Ve=Me.x*X.x+Me.y*X.y,Ne=Ve!==0?1/Ve:1/0,$e=2*Math.sqrt(2-2*Ve),ot=Ve<YU&&k&&N,je=W.x*X.y-W.y*X.x>0,nt=this.overscaling<=16?15*En/(512*this.overscaling):0;if(J&&he==="round"){if(Ne<E)he="miter";else if(Ne<=2){const ct=T1(P,-10,En+10);he=this.hasZOffset&&(ct||this.hasCrossSlope)?"miter":"fakeround"}}if(he==="miter"&&Ne>g&&(he="bevel"),he==="bevel"&&(Ne>2&&(he="flipbevel"),Ne<g&&(he="miter")),k&&!(he==="miter"&&ot)&&this.updateDistance(k,P),he==="miter")if(ot){const ct=P.dist(k);if(ct>2*nt){const _t=P.sub(P.sub(k)._mult(nt/ct)._round());this.updateDistance(k,_t),this.addCurrentVertex(_t,W,0,0,R,ee),k=_t}this.updateDistance(k,P),Me._mult(Ne),this.addCurrentVertex(P,Me,0,0,R,ee);const ht=P.dist(N);if(ht>2*nt){const _t=P.add(N.sub(P)._mult(nt/ht)._round());this.updateDistance(P,_t),this.addCurrentVertex(_t,X,0,0,R,ee),P=_t}}else Me._mult(Ne),this.addCurrentVertex(P,Me,0,0,R,ee);else if(he==="flipbevel"){if(Ne>100)Me=X.mult(-1);else{const ct=Ne*W.add(X).mag()/W.sub(X).mag();Me._perp()._mult(ct*(je?-1:1))}this.addCurrentVertex(P,Me,0,0,R,ee),this.addCurrentVertex(P,Me.mult(-1),0,0,R,ee)}else if(he==="bevel"||he==="fakeround"){ee!=null&&k&&this.addCurrentVertex(P,W,-1,-1,R,ee);const ct=P.dist(k)<=2*nt&&he!=="bevel",ht=Me.mult(je?1:-1);ht._mult(Ne);const _t=X.mult(je?-1:1),At=W.mult(je?-1:1),It=this.evaluateElevationValue(this.distance);if(ee==null&&(this.addHalfVertex(P,ht.x,ht.y,!1,!je,0,R,It),ct||this.addHalfVertex(P,ht.x+2*At.x,ht.y+2*At.y,!1,je,0,R,It)),he==="fakeround"){const wt=Math.round(180*$e/Math.PI/20);this.addHalfVertex(P,At.x,At.y,!1,je,0,R,It);for(let Xt=0;Xt<wt;Xt++){let pn=Xt/wt;if(pn!==.5){const Fn=pn-.5;pn+=pn*Fn*(pn-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*Fn*Fn+(.848013+ye*(.215638*ye-1.06021)))}const Ut=_t.sub(At)._mult(pn)._add(At)._unit();this.addHalfVertex(P,Ut.x,Ut.y,!1,je,0,R,It)}this.addHalfVertex(P,_t.x,_t.y,!1,je,0,R,It)}ct||ee!=null||this.addHalfVertex(P,ht.x+2*_t.x,ht.y+2*_t.y,!1,je,0,R,It),ee!=null&&N&&this.addCurrentVertex(P,X,1,1,R,ee)}else he==="butt"?this.addCurrentVertex(P,Me,0,0,R,ee):he==="square"?(k||this.addCurrentVertex(P,Me,-1,-1,R,ee),this.addCurrentVertex(P,Me,0,0,R,ee),k&&this.addCurrentVertex(P,Me,1,1,R,ee)):he==="round"&&(k&&(this.addCurrentVertex(P,W,0,0,R,ee),this.addCurrentVertex(P,W,1,1,R,ee,!0)),N&&(this.addCurrentVertex(P,X,-1,-1,R,ee,!0),this.addCurrentVertex(P,X,0,0,R,ee)))}}addVerticesTo(n,s,c,m,f,g,E,O,D,w){const C=(s.w-n.w)/this.tessellationStep|0;let R=0;const P=this.scaledDistance;if(C>1){this.lineSoFar=n.w;const N=(s.x-n.x)/C,W=(s.y-n.y)/C,X=(s.z-n.z)/C,ee=(s.w-n.w)/C;for(let ne=1;ne<C;++ne){n.x+=N,n.y+=W,n.z+=X,this.lineSoFar+=ee,R+=ee;const J=this.evaluateElevationValue(this.prevDistance+R);this.scaledDistance=(this.prevDistance+R)/this.totalDistance,this.addHalfVertex(n,c,m,w,!1,E,D,J),this.addHalfVertex(n,f,g,w,!0,-O,D,J)}}this.lineSoFar=s.w,this.scaledDistance=P;const k=this.evaluateElevationValue(this.distance);this.addHalfVertex(s,c,m,w,!1,E,D,k),this.addHalfVertex(s,f,g,w,!0,-O,D,k)}evaluateElevationValue(n){return this.hasZOffset?this.zOffsetValue.kind==="constant"?this.zOffsetValue.value:(this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):Er(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0):void 0}addCurrentVertex(n,s,c,m,f,g,E=!1){const O=s.x+s.y*c,D=s.y-s.x*c,w=s.y*m-s.x,C=-s.y-s.x*m;if(g!=null){const P=En+10,k=g,N=new DI(n.x,n.y,k,this.lineSoFar),W=T1(n,-10,P),X=this.lineSoFar,ee=this.distance;if(this.currentVertex)if(W){const ne=this.currentVertexIsOutside,J=this.currentVertex,he=new DI(n.x,n.y,k,this.lineSoFar);if(FI(J,he,-10,P),!T1(he,-10,P)){if(ne){this.e1=this.e2=-1,this.distance-=J.dist(N),this.lineSoFar=J.w;const ye=this.evaluateElevationValue(J.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(J,O,D,E,!1,c,f,ye),this.addHalfVertex(J,w,C,E,!0,-m,f,ye),this.prevDistance=this.distance}this.distance=this.prevDistance+J.dist(he),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(J,he,O,D,w,C,c,m,f,E),this.distance=ee,this.scaledDistance=this.distance/this.totalDistance}}else{const ne=this.currentVertex;if(this.currentVertexIsOutside){FI(ne,N,-10,P),this.e1=this.e2=-1,this.distance-=ne.dist(N),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ne.w;const J=this.evaluateElevationValue(ne.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ne,O,D,E,!1,c,f,J),this.addHalfVertex(ne,w,C,E,!0,-m,f,J),this.prevDistance=this.distance,this.distance=ee,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ne,N,O,D,w,C,c,m,f,E)}else W||(this.addHalfVertex(n,O,D,E,!1,c,f,g),this.addHalfVertex(n,w,C,E,!0,-m,f,g));this.currentVertex=N,this.currentVertexIsOutside=W,this.lineSoFar=X}else this.addHalfVertex(n,O,D,E,!1,c,f,g),this.addHalfVertex(n,w,C,E,!0,-m,f,g)}addHalfVertex({x:n,y:s},c,m,f,g,E,O,D){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,E)),this.layoutVertexArray.emplaceBack((n<<1)+(f?1:0),(s<<1)+(g?1:0),Math.round(63*c)+128,Math.round(63*m)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),O.primitiveLength++),g?this.e2=w:this.e1=w,D!=null&&this.zOffsetVertexArray.emplaceBack(D)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,s){this.prevDistance=this.distance,this.distance+=n.dist(s),this.updateScaledDistance()}}function T1(u,n,s){return u.x<n||u.x>s||u.y<n||u.y>s}let cC,hC;function fC(u,n,s){return n*(En/(u.tileSize*Math.pow(2,s-u.tileID.overscaledZ)))}kn(S1,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const dC=(u,n,s)=>(1-s)*u+s*n;function pC(u,n){return 1/fC(u,1,n.tileZoom)}function mC(u,n,s,c){return u.translatePosMatrix(c||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const gC=u=>{const n=[];_C(u)&&n.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=u.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const c=u.layout.get("line-join").constantOr("miter")==="none",m=!!u.paint.get("line-pattern").constantOr(1);return c&&m&&n.push("LINE_JOIN_NONE"),n};function _C(u){const n=u.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let E1;const yC=()=>E1||(E1={layout:cC||(cC=new Ni({"line-cap":new tr(Et.layout_line["line-cap"]),"line-join":new tr(Et.layout_line["line-join"]),"line-miter-limit":new vn(Et.layout_line["line-miter-limit"]),"line-round-limit":new vn(Et.layout_line["line-round-limit"]),"line-sort-key":new tr(Et.layout_line["line-sort-key"]),"line-z-offset":new tr(Et.layout_line["line-z-offset"]),"line-elevation-reference":new vn(Et.layout_line["line-elevation-reference"]),"line-cross-slope":new vn(Et.layout_line["line-cross-slope"]),visibility:new vn(Et.layout_line.visibility)})),paint:hC||(hC=new Ni({"line-opacity":new tr(Et.paint_line["line-opacity"]),"line-color":new tr(Et.paint_line["line-color"]),"line-translate":new vn(Et.paint_line["line-translate"]),"line-translate-anchor":new vn(Et.paint_line["line-translate-anchor"]),"line-width":new tr(Et.paint_line["line-width"]),"line-gap-width":new tr(Et.paint_line["line-gap-width"]),"line-offset":new tr(Et.paint_line["line-offset"]),"line-blur":new tr(Et.paint_line["line-blur"]),"line-dasharray":new tr(Et.paint_line["line-dasharray"]),"line-pattern":new tr(Et.paint_line["line-pattern"]),"line-gradient":new ps(Et.paint_line["line-gradient"]),"line-trim-offset":new vn(Et.paint_line["line-trim-offset"]),"line-trim-fade-range":new vn(Et.paint_line["line-trim-fade-range"]),"line-trim-color":new vn(Et.paint_line["line-trim-color"]),"line-emissive-strength":new vn(Et.paint_line["line-emissive-strength"]),"line-border-width":new tr(Et.paint_line["line-border-width"]),"line-border-color":new tr(Et.paint_line["line-border-color"]),"line-occlusion-opacity":new vn(Et.paint_line["line-occlusion-opacity"])}))},E1);class QU extends tr{possiblyEvaluate(n,s){return s=new Po(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,c,m){return s=Fi({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,c,m)}}let n_;function vC(u,n){return n>0?n+2*u:u}const e8=Ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),t8=Ti([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),n8=Ti([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const r8=Ti([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),i8=Ti([{name:"a_texb",components:2,type:"Uint16"}]),o8=Ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),a8=Ti([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const xC=Ti([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),s8=Ti([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ti([{name:"triangle",components:3,type:"Uint16"}]),Ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ti([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Ti([{type:"Float32",name:"offsetX"}]),Ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Gs=24;const Th=128;function A1(u,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Po(u+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:m}=s;let f=0;for(;f<c.length&&c[f]<=u;)f++;f=Math.max(0,f-1);let g=f;for(;g<c.length&&c[g]<u+1;)g++;g=Math.min(c.length-1,g);const E=c[f],O=c[g];return s.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:O,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:O,minSize:s.evaluate(new Po(E)),maxSize:s.evaluate(new Po(O)),interpolationType:m}}}function mv(u,{uSize:n,uSizeT:s},{lowerSize:c,upperSize:m}){return u.kind==="source"?c/Th:u.kind==="composite"?Yn(c/Th,m/Th,s):n}function Am(u,n,s=1){let c=0,m=0;if(u.kind==="constant")m=u.layoutSize*s;else if(u.kind!=="source"){const{interpolationType:f,minZoom:g,maxZoom:E}=u,O=f?lr(V.interpolationFactor(f,n,g,E),0,1):0;u.kind==="camera"?m=Yn(u.minSize,u.maxSize,O)*s:c=O*s}return{uSizeT:c,uSize:m}}var l8=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Th,evaluateSizeForFeature:mv,evaluateSizeForZoom:Am,getSizeData:A1});function u8(u,n,s){return u.sections.forEach(c=>{c.text=function(m,f,g){const E=f.layout.get("text-transform").evaluate(g,{});return E==="uppercase"?m=m.toLocaleUpperCase():E==="lowercase"&&(m=m.toLocaleLowerCase()),il.applyArabicShaping&&(m=il.applyArabicShaping(m)),m}(c.text,n,s)}),u}const r_={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function c8(u){return u==="︶"||u==="﹈"||u==="︸"||u==="﹄"||u==="﹂"||u==="︾"||u==="︼"||u==="︺"||u==="︘"||u==="﹀"||u==="︐"||u==="︓"||u==="︔"||u==="｀"||u==="￣"||u==="︑"||u==="︒"}function h8(u){return u==="︵"||u==="﹇"||u==="︷"||u==="﹃"||u==="﹁"||u==="︽"||u==="︻"||u==="︹"||u==="︗"||u==="︿"}var bC,P1,wC,M1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function f8(){return bC||(bC=1,M1.read=function(u,n,s,c,m){var f,g,E=8*m-c-1,O=(1<<E)-1,D=O>>1,w=-7,C=s?m-1:0,R=s?-1:1,P=u[n+C];for(C+=R,f=P&(1<<-w)-1,P>>=-w,w+=E;w>0;f=256*f+u[n+C],C+=R,w-=8);for(g=f&(1<<-w)-1,f>>=-w,w+=c;w>0;g=256*g+u[n+C],C+=R,w-=8);if(f===0)f=1-D;else{if(f===O)return g?NaN:1/0*(P?-1:1);g+=Math.pow(2,c),f-=D}return(P?-1:1)*g*Math.pow(2,f-c)},M1.write=function(u,n,s,c,m,f){var g,E,O,D=8*f-m-1,w=(1<<D)-1,C=w>>1,R=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=c?0:f-1,k=c?1:-1,N=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,g=w):(g=Math.floor(Math.log(n)/Math.LN2),n*(O=Math.pow(2,-g))<1&&(g--,O*=2),(n+=g+C>=1?R/O:R*Math.pow(2,1-C))*O>=2&&(g++,O/=2),g+C>=w?(E=0,g=w):g+C>=1?(E=(n*O-1)*Math.pow(2,m),g+=C):(E=n*Math.pow(2,C-1)*Math.pow(2,m),g=0));m>=8;u[s+P]=255&E,P+=k,E/=256,m-=8);for(g=g<<m|E,D+=m;D>0;u[s+P]=255&g,P+=k,g/=256,D-=8);u[s+P-k]|=128*N}),M1}function SC(){if(wC)return P1;wC=1,P1=n;var u=f8();function n(J){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(J)?J:new Uint8Array(J||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,c=1/s,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function f(J){return J.type===n.Bytes?J.readVarint()+J.pos:J.pos+1}function g(J,he,ye){return ye?4294967296*he+(J>>>0):4294967296*(he>>>0)+(J>>>0)}function E(J,he,ye){var Me=he<=16383?1:he<=2097151?2:he<=268435455?3:Math.floor(Math.log(he)/(7*Math.LN2));ye.realloc(Me);for(var Ve=ye.pos-1;Ve>=J;Ve--)ye.buf[Ve+Me]=ye.buf[Ve]}function O(J,he){for(var ye=0;ye<J.length;ye++)he.writeVarint(J[ye])}function D(J,he){for(var ye=0;ye<J.length;ye++)he.writeSVarint(J[ye])}function w(J,he){for(var ye=0;ye<J.length;ye++)he.writeFloat(J[ye])}function C(J,he){for(var ye=0;ye<J.length;ye++)he.writeDouble(J[ye])}function R(J,he){for(var ye=0;ye<J.length;ye++)he.writeBoolean(J[ye])}function P(J,he){for(var ye=0;ye<J.length;ye++)he.writeFixed32(J[ye])}function k(J,he){for(var ye=0;ye<J.length;ye++)he.writeSFixed32(J[ye])}function N(J,he){for(var ye=0;ye<J.length;ye++)he.writeFixed64(J[ye])}function W(J,he){for(var ye=0;ye<J.length;ye++)he.writeSFixed64(J[ye])}function X(J,he){return(J[he]|J[he+1]<<8|J[he+2]<<16)+16777216*J[he+3]}function ee(J,he,ye){J[ye]=he,J[ye+1]=he>>>8,J[ye+2]=he>>>16,J[ye+3]=he>>>24}function ne(J,he){return(J[he]|J[he+1]<<8|J[he+2]<<16)+(J[he+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(J,he,ye){for(ye=ye||this.length;this.pos<ye;){var Me=this.readVarint(),Ve=Me>>3,Ne=this.pos;this.type=7&Me,J(Ve,he,this),this.pos===Ne&&this.skip(Me)}return he},readMessage:function(J,he){return this.readFields(J,he,this.readVarint()+this.pos)},readFixed32:function(){var J=X(this.buf,this.pos);return this.pos+=4,J},readSFixed32:function(){var J=ne(this.buf,this.pos);return this.pos+=4,J},readFixed64:function(){var J=X(this.buf,this.pos)+X(this.buf,this.pos+4)*s;return this.pos+=8,J},readSFixed64:function(){var J=X(this.buf,this.pos)+ne(this.buf,this.pos+4)*s;return this.pos+=8,J},readFloat:function(){var J=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,J},readDouble:function(){var J=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,J},readVarint:function(J){var he,ye,Me=this.buf;return he=127&(ye=Me[this.pos++]),ye<128?he:(he|=(127&(ye=Me[this.pos++]))<<7,ye<128?he:(he|=(127&(ye=Me[this.pos++]))<<14,ye<128?he:(he|=(127&(ye=Me[this.pos++]))<<21,ye<128?he:function(Ve,Ne,$e){var ot,je,nt=$e.buf;if(ot=(112&(je=nt[$e.pos++]))>>4,je<128||(ot|=(127&(je=nt[$e.pos++]))<<3,je<128)||(ot|=(127&(je=nt[$e.pos++]))<<10,je<128)||(ot|=(127&(je=nt[$e.pos++]))<<17,je<128)||(ot|=(127&(je=nt[$e.pos++]))<<24,je<128)||(ot|=(1&(je=nt[$e.pos++]))<<31,je<128))return g(Ve,ot,Ne);throw new Error("Expected varint not more than 10 bytes")}(he|=(15&(ye=Me[this.pos]))<<28,J,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var J=this.readVarint();return J%2==1?(J+1)/-2:J/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var J=this.readVarint()+this.pos,he=this.pos;return this.pos=J,J-he>=12&&m?function(ye,Me,Ve){return m.decode(ye.subarray(Me,Ve))}(this.buf,he,J):function(ye,Me,Ve){for(var Ne="",$e=Me;$e<Ve;){var ot,je,nt,ct=ye[$e],ht=null,_t=ct>239?4:ct>223?3:ct>191?2:1;if($e+_t>Ve)break;_t===1?ct<128&&(ht=ct):_t===2?(192&(ot=ye[$e+1]))==128&&(ht=(31&ct)<<6|63&ot)<=127&&(ht=null):_t===3?(je=ye[$e+2],(192&(ot=ye[$e+1]))==128&&(192&je)==128&&((ht=(15&ct)<<12|(63&ot)<<6|63&je)<=2047||ht>=55296&&ht<=57343)&&(ht=null)):_t===4&&(je=ye[$e+2],nt=ye[$e+3],(192&(ot=ye[$e+1]))==128&&(192&je)==128&&(192&nt)==128&&((ht=(15&ct)<<18|(63&ot)<<12|(63&je)<<6|63&nt)<=65535||ht>=1114112)&&(ht=null)),ht===null?(ht=65533,_t=1):ht>65535&&(ht-=65536,Ne+=String.fromCharCode(ht>>>10&1023|55296),ht=56320|1023&ht),Ne+=String.fromCharCode(ht),$e+=_t}return Ne}(this.buf,he,J)},readBytes:function(){var J=this.readVarint()+this.pos,he=this.buf.subarray(this.pos,J);return this.pos=J,he},readPackedVarint:function(J,he){if(this.type!==n.Bytes)return J.push(this.readVarint(he));var ye=f(this);for(J=J||[];this.pos<ye;)J.push(this.readVarint(he));return J},readPackedSVarint:function(J){if(this.type!==n.Bytes)return J.push(this.readSVarint());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readSVarint());return J},readPackedBoolean:function(J){if(this.type!==n.Bytes)return J.push(this.readBoolean());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readBoolean());return J},readPackedFloat:function(J){if(this.type!==n.Bytes)return J.push(this.readFloat());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readFloat());return J},readPackedDouble:function(J){if(this.type!==n.Bytes)return J.push(this.readDouble());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readDouble());return J},readPackedFixed32:function(J){if(this.type!==n.Bytes)return J.push(this.readFixed32());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readFixed32());return J},readPackedSFixed32:function(J){if(this.type!==n.Bytes)return J.push(this.readSFixed32());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readSFixed32());return J},readPackedFixed64:function(J){if(this.type!==n.Bytes)return J.push(this.readFixed64());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readFixed64());return J},readPackedSFixed64:function(J){if(this.type!==n.Bytes)return J.push(this.readSFixed64());var he=f(this);for(J=J||[];this.pos<he;)J.push(this.readSFixed64());return J},skip:function(J){var he=7&J;if(he===n.Varint)for(;this.buf[this.pos++]>127;);else if(he===n.Bytes)this.pos=this.readVarint()+this.pos;else if(he===n.Fixed32)this.pos+=4;else{if(he!==n.Fixed64)throw new Error("Unimplemented type: "+he);this.pos+=8}},writeTag:function(J,he){this.writeVarint(J<<3|he)},realloc:function(J){for(var he=this.length||16;he<this.pos+J;)he*=2;if(he!==this.length){var ye=new Uint8Array(he);ye.set(this.buf),this.buf=ye,this.length=he}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(J){this.realloc(4),ee(this.buf,J,this.pos),this.pos+=4},writeSFixed32:function(J){this.realloc(4),ee(this.buf,J,this.pos),this.pos+=4},writeFixed64:function(J){this.realloc(8),ee(this.buf,-1&J,this.pos),ee(this.buf,Math.floor(J*c),this.pos+4),this.pos+=8},writeSFixed64:function(J){this.realloc(8),ee(this.buf,-1&J,this.pos),ee(this.buf,Math.floor(J*c),this.pos+4),this.pos+=8},writeVarint:function(J){(J=+J||0)>268435455||J<0?function(he,ye){var Me,Ve;if(he>=0?(Me=he%4294967296|0,Ve=he/4294967296|0):(Ve=~(-he/4294967296),4294967295^(Me=~(-he%4294967296))?Me=Me+1|0:(Me=0,Ve=Ve+1|0)),he>=18446744073709552e3||he<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ye.realloc(10),function(Ne,$e,ot){ot.buf[ot.pos++]=127&Ne|128,Ne>>>=7,ot.buf[ot.pos++]=127&Ne|128,Ne>>>=7,ot.buf[ot.pos++]=127&Ne|128,Ne>>>=7,ot.buf[ot.pos++]=127&Ne|128,ot.buf[ot.pos]=127&(Ne>>>=7)}(Me,0,ye),function(Ne,$e){var ot=(7&Ne)<<4;$e.buf[$e.pos++]|=ot|((Ne>>>=3)?128:0),Ne&&($e.buf[$e.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&($e.buf[$e.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&($e.buf[$e.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&($e.buf[$e.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&($e.buf[$e.pos++]=127&Ne)))))}(Ve,ye)}(J,this):(this.realloc(4),this.buf[this.pos++]=127&J|(J>127?128:0),J<=127||(this.buf[this.pos++]=127&(J>>>=7)|(J>127?128:0),J<=127||(this.buf[this.pos++]=127&(J>>>=7)|(J>127?128:0),J<=127||(this.buf[this.pos++]=J>>>7&127))))},writeSVarint:function(J){this.writeVarint(J<0?2*-J-1:2*J)},writeBoolean:function(J){this.writeVarint(!!J)},writeString:function(J){J=String(J),this.realloc(4*J.length),this.pos++;var he=this.pos;this.pos=function(Me,Ve,Ne){for(var $e,ot,je=0;je<Ve.length;je++){if(($e=Ve.charCodeAt(je))>55295&&$e<57344){if(!ot){$e>56319||je+1===Ve.length?(Me[Ne++]=239,Me[Ne++]=191,Me[Ne++]=189):ot=$e;continue}if($e<56320){Me[Ne++]=239,Me[Ne++]=191,Me[Ne++]=189,ot=$e;continue}$e=ot-55296<<10|$e-56320|65536,ot=null}else ot&&(Me[Ne++]=239,Me[Ne++]=191,Me[Ne++]=189,ot=null);$e<128?Me[Ne++]=$e:($e<2048?Me[Ne++]=$e>>6|192:($e<65536?Me[Ne++]=$e>>12|224:(Me[Ne++]=$e>>18|240,Me[Ne++]=$e>>12&63|128),Me[Ne++]=$e>>6&63|128),Me[Ne++]=63&$e|128)}return Ne}(this.buf,J,this.pos);var ye=this.pos-he;ye>=128&&E(he,ye,this),this.pos=he-1,this.writeVarint(ye),this.pos+=ye},writeFloat:function(J){this.realloc(4),u.write(this.buf,J,this.pos,!0,23,4),this.pos+=4},writeDouble:function(J){this.realloc(8),u.write(this.buf,J,this.pos,!0,52,8),this.pos+=8},writeBytes:function(J){var he=J.length;this.writeVarint(he),this.realloc(he);for(var ye=0;ye<he;ye++)this.buf[this.pos++]=J[ye]},writeRawMessage:function(J,he){this.pos++;var ye=this.pos;J(he,this);var Me=this.pos-ye;Me>=128&&E(ye,Me,this),this.pos=ye-1,this.writeVarint(Me),this.pos+=Me},writeMessage:function(J,he,ye){this.writeTag(J,n.Bytes),this.writeRawMessage(he,ye)},writePackedVarint:function(J,he){he.length&&this.writeMessage(J,O,he)},writePackedSVarint:function(J,he){he.length&&this.writeMessage(J,D,he)},writePackedBoolean:function(J,he){he.length&&this.writeMessage(J,R,he)},writePackedFloat:function(J,he){he.length&&this.writeMessage(J,w,he)},writePackedDouble:function(J,he){he.length&&this.writeMessage(J,C,he)},writePackedFixed32:function(J,he){he.length&&this.writeMessage(J,P,he)},writePackedSFixed32:function(J,he){he.length&&this.writeMessage(J,k,he)},writePackedFixed64:function(J,he){he.length&&this.writeMessage(J,N,he)},writePackedSFixed64:function(J,he){he.length&&this.writeMessage(J,W,he)},writeBytesField:function(J,he){this.writeTag(J,n.Bytes),this.writeBytes(he)},writeFixed32Field:function(J,he){this.writeTag(J,n.Fixed32),this.writeFixed32(he)},writeSFixed32Field:function(J,he){this.writeTag(J,n.Fixed32),this.writeSFixed32(he)},writeFixed64Field:function(J,he){this.writeTag(J,n.Fixed64),this.writeFixed64(he)},writeSFixed64Field:function(J,he){this.writeTag(J,n.Fixed64),this.writeSFixed64(he)},writeVarintField:function(J,he){this.writeTag(J,n.Varint),this.writeVarint(he)},writeSVarintField:function(J,he){this.writeTag(J,n.Varint),this.writeSVarint(he)},writeStringField:function(J,he){this.writeTag(J,n.Bytes),this.writeString(he)},writeFloatField:function(J,he){this.writeTag(J,n.Fixed32),this.writeFloat(he)},writeDoubleField:function(J,he){this.writeTag(J,n.Fixed64),this.writeDouble(he)},writeBooleanField:function(J,he){this.writeVarintField(J,!!he)}},P1}var gv=I(SC());const I1=3;function d8(u,n,s){n.glyphs=[],u===1&&s.readMessage(p8,n)}function p8(u,n,s){if(u===3){const{id:c,bitmap:m,width:f,height:g,left:E,top:O,advance:D}=s.readMessage(m8,{});n.glyphs.push({id:c,bitmap:new Yh({width:f+2*I1,height:g+2*I1},m),metrics:{width:f,height:g,left:E,top:O,advance:D}})}else u===4?n.ascender=s.readSVarint():u===5&&(n.descender=s.readSVarint())}function m8(u,n,s){u===1?n.id=s.readVarint():u===2?n.bitmap=s.readBytes():u===3?n.width=s.readVarint():u===4?n.height=s.readVarint():u===5?n.left=s.readSVarint():u===6?n.top=s.readSVarint():u===7&&(n.advance=s.readVarint())}const TC=I1,Ju={horizontal:1,vertical:2,horizontalOnly:3};class i_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const c=new i_;return c.scale=n||1,c.fontStack=s,c}static forImage(n){const s=new i_;return s.imageName=n,s}}class Pm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const c=new Pm;for(let m=0;m<n.sections.length;m++){const f=n.sections[m];f.image?c.addImageSection(f):c.addTextSection(f,s)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,c){let m="";for(let f=0;f<s.length;f++){const g=s.charCodeAt(f+1)||null,E=s.charCodeAt(f-1)||null;m+=!c&&(g&&$s(g)&&!r_[s[f+1]]||E&&$s(E)&&!r_[s[f-1]])||!r_[s[f]]?s[f]:r_[s[f]]}return m}(this.text,n)}trim(){let n=0;for(let c=0;c<this.text.length&&_v[this.text.charCodeAt(c)];c++)n++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&_v[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const c=new Pm;return c.text=this.text.substring(n,s),c.sectionIndex=this.sectionIndex.slice(n,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(i_.forText(n.scale,n.fontStack||s));const c=this.sections.length-1;for(let m=0;m<n.text.length;++m)this.sectionIndex.push(c)}addImageSection(n){const s=n.image?n.image.namePrimary:"";if(s.length===0)return void Er("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(i_.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Er("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function C1(u,n,s,c,m,f,g,E,O,D,w,C,R,P,k){const N=Pm.fromFeature(u,m);C===Ju.vertical&&N.verticalizePunctuation(R);let W=[];const X=function(ye,Me,Ve,Ne,$e,ot){if(!ye)return[];const je=[],nt=function(At,It,wt,Xt,pn,Ut){let Fn=0;for(let An=0;An<At.length();An++){const xn=At.getSection(An);Fn+=EC(At.getCodePoint(An),xn,Xt,pn,It,Ut)}return Fn/Math.max(1,Math.ceil(Fn/wt))}(ye,Me,Ve,Ne,$e,ot),ct=ye.text.indexOf("​")>=0;let ht=0;for(let At=0;At<ye.length();At++){const It=ye.getSection(At),wt=ye.getCodePoint(At);if(_v[wt]||(ht+=EC(wt,It,Ne,$e,Me,ot)),At<ye.length()-1){const Xt=!((_t=wt)<11904||!(Jn["Bopomofo Extended"](_t)||Jn.Bopomofo(_t)||Jn["CJK Compatibility Forms"](_t)||Jn["CJK Compatibility Ideographs"](_t)||Jn["CJK Compatibility"](_t)||Jn["CJK Radicals Supplement"](_t)||Jn["CJK Strokes"](_t)||Jn["CJK Symbols and Punctuation"](_t)||Jn["CJK Unified Ideographs Extension A"](_t)||Jn["CJK Unified Ideographs"](_t)||Jn["Enclosed CJK Letters and Months"](_t)||Jn["Halfwidth and Fullwidth Forms"](_t)||Jn.Hiragana(_t)||Jn["Ideographic Description Characters"](_t)||Jn["Kangxi Radicals"](_t)||Jn["Katakana Phonetic Extensions"](_t)||Jn.Katakana(_t)||Jn["Vertical Forms"](_t)||Jn["Yi Radicals"](_t)||Jn["Yi Syllables"](_t)));(g8[wt]||Xt||It.imageName)&&je.push(PC(At+1,ht,nt,je,_8(wt,ye.getCodePoint(At+1),Xt&&ct),!1))}}var _t;return MC(PC(ye.length(),ht,nt,je,0,!0))}(N,D,f,n,c,P),{processBidirectionalText:ee,processStyledBidirectionalText:ne}=il;if(ee&&N.sections.length===1){const ye=ee(N.toString(),X);for(const Me of ye){const Ve=new Pm;Ve.text=Me,Ve.sections=N.sections;for(let Ne=0;Ne<Me.length;Ne++)Ve.sectionIndex.push(0);W.push(Ve)}}else if(ne){const ye=ne(N.text,N.sectionIndex,X);for(const Me of ye){const Ve=new Pm;Ve.text=Me[0],Ve.sectionIndex=Me[1],Ve.sections=N.sections,W.push(Ve)}}else W=function(ye,Me){const Ve=[],Ne=ye.text;let $e=0;for(const ot of Me)Ve.push(ye.substring($e,ot)),$e=ot;return $e<Ne.length&&Ve.push(ye.substring($e,Ne.length)),Ve}(N,X);const J=[],he={positionedLines:J,text:N.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:C,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ye,Me,Ve,Ne,$e,ot,je,nt,ct,ht,_t,At){let It=0,wt=0,Xt=0;const pn=nt==="right"?1:nt==="left"?0:.5;let Ut=!1;for(const zn of $e){const qn=zn.getSections();for(const Lr of qn){if(Lr.imageName)continue;const Xr=Me[Lr.fontStack];if(Xr&&(Ut=Xr.ascender!==void 0&&Xr.descender!==void 0,!Ut))break}if(!Ut)break}let Fn=0;for(const zn of $e){zn.trim();const qn=zn.getMaxScale(),Lr=(qn-1)*Gs,Xr={positionedGlyphs:[],lineOffset:0};ye.positionedLines[Fn]=Xr;const ei=Xr.positionedGlyphs;let Vr=0;if(!zn.length()){wt+=ot,++Fn;continue}let fi=0,ui=0;for(let Yi=0;Yi<zn.length();Yi++){const Tr=zn.getSection(Yi),$i=zn.getSectionIndex(Yi),qi=zn.getCodePoint(Yi);let bo=Tr.scale,ga=null,La=null,_a=null,Jo=Gs,Ea=0;const Ga=!(ct===Ju.horizontal||!_t&&!rs(qi)||_t&&(_v[qi]||(An=qi,Jn.Arabic(An)||Jn["Arabic Supplement"](An)||Jn["Arabic Extended-A"](An)||Jn["Arabic Presentation Forms-A"](An)||Jn["Arabic Presentation Forms-B"](An))));if(Tr.imageName){const Hs=Ne[Tr.imageName];if(!Hs)continue;_a=Tr.imageName,ye.iconsInText=ye.iconsInText||!0,La=Hs.paddedRect;const mo=Hs.displaySize;bo=bo*Gs/At,ga={width:mo[0],height:mo[1],left:0,top:-TC,advance:Ga?mo[1]:mo[0],localGlyph:!1},Ea=Ut?-ga.height*bo:qn*Gs-17-mo[1]*bo,Jo=ga.advance;const nu=(Ga?mo[0]:mo[1])*bo-Gs*qn;nu>0&&nu>Vr&&(Vr=nu)}else{const Hs=Ve[Tr.fontStack];if(!Hs)continue;Hs[qi]&&(La=Hs[qi]);const mo=Me[Tr.fontStack];if(!mo)continue;const nu=mo.glyphs[qi];if(!nu)continue;if(ga=nu.metrics,Jo=qi!==8203?Gs:0,Ut){const Ih=mo.ascender!==void 0?Math.abs(mo.ascender):0,zc=mo.descender!==void 0?Math.abs(mo.descender):0,Fc=(Ih+zc)*bo;fi<Fc&&(fi=Fc,ui=(Ih-zc)/2*bo),Ea=-Ih*bo}else Ea=(qn-bo)*Gs-17}Ga?(ye.verticalizable=!0,ei.push({glyph:qi,imageName:_a,x:It,y:wt+Ea,vertical:Ga,scale:bo,localGlyph:ga.localGlyph,fontStack:Tr.fontStack,sectionIndex:$i,metrics:ga,rect:La}),It+=Jo*bo+ht):(ei.push({glyph:qi,imageName:_a,x:It,y:wt+Ea,vertical:Ga,scale:bo,localGlyph:ga.localGlyph,fontStack:Tr.fontStack,sectionIndex:$i,metrics:ga,rect:La}),It+=ga.advance*bo+ht)}ei.length!==0&&(Xt=Math.max(It-ht,Xt),Ut?IC(ei,pn,Vr,ui,ot*qn/2):IC(ei,pn,Vr,0,ot/2)),It=0;const oo=ot*qn+Vr;Xr.lineOffset=Math.max(Vr,Lr),wt+=oo,++Fn}var An;const xn=wt,{horizontalAlign:cn,verticalAlign:ur}=O1(je);(function(zn,qn,Lr,Xr,ei,Vr){const fi=(qn-Lr)*ei,ui=-Vr*Xr;for(const oo of zn)for(const Yi of oo.positionedGlyphs)Yi.x+=fi,Yi.y+=ui})(ye.positionedLines,pn,cn,ur,Xt,xn),ye.top+=-ur*xn,ye.bottom=ye.top+xn,ye.left+=-cn*Xt,ye.right=ye.left+Xt,ye.hasBaseline=Ut}(he,n,s,c,W,g,E,O,C,D,R,k),!function(ye){for(const Me of ye)if(Me.positionedGlyphs.length!==0)return!1;return!0}(J)&&he}const _v={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},g8={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function EC(u,n,s,c,m,f){if(n.imageName){const g=c[n.imageName];return g?g.displaySize[0]*n.scale*Gs/f+m:0}{const g=s[n.fontStack],E=g&&g.glyphs[u];return E?E.metrics.advance*n.scale+m:0}}function AC(u,n,s,c){const m=Math.pow(u-n,2);return c?u<n?m/2:2*m:m+Math.abs(s)*s}function _8(u,n,s){let c=0;return u===10&&(c-=1e4),s&&(c+=150),u!==40&&u!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function PC(u,n,s,c,m,f){let g=null,E=AC(n,s,m,f);for(const O of c){const D=AC(n-O.x,s,m,f)+O.badness;D<=E&&(g=O,E=D)}return{index:u,x:n,priorBreak:g,badness:E}}function MC(u){return u?MC(u.priorBreak).concat(u.index):[]}function O1(u){let n=.5,s=.5;switch(u){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function IC(u,n,s,c,m){if(!(n||s||c||m))return;const f=u.length-1,g=u[f],E=(g.x+g.metrics.advance*g.scale)*n;for(let O=0;O<=f;O++)u[O].x-=E,u[O].y+=s+c+m}function y8(u,n,s,c){const{horizontalAlign:m,verticalAlign:f}=O1(c),g=s[0]-u.displaySize[0]*m,E=s[1]-u.displaySize[1]*f;return{imagePrimary:u,imageSecondary:n,top:E,bottom:E+u.displaySize[1],left:g,right:g+u.displaySize[0]}}function CC(u,n,s,c,m,f){const g=u.imagePrimary;let E;if(g.content){const W=g.content,X=g.pixelRatio||1;E=[W[0]/X,W[1]/X,g.displaySize[0]-W[2]/X,g.displaySize[1]-W[3]/X]}const O=n.left*f,D=n.right*f;let w,C,R,P;s==="width"||s==="both"?(P=m[0]+O-c[3],C=m[0]+D+c[1]):(P=m[0]+(O+D-g.displaySize[0])/2,C=P+g.displaySize[0]);const k=n.top*f,N=n.bottom*f;return s==="height"||s==="both"?(w=m[1]+k-c[0],R=m[1]+N+c[2]):(w=m[1]+(k+N-g.displaySize[1])/2,R=w+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:w,right:C,bottom:R,left:P,collisionPadding:E}}class Uf extends Yt{constructor(n,s,c,m,f){super(n,s),this.angle=m,this.z=c,f!==void 0&&(this.segment=f)}clone(){return new Uf(this.x,this.y,this.z,this.angle,this.segment)}}function OC(u,n,s,c,m){if(n.segment===void 0)return!0;let f=n,g=n.segment+1,E=0;for(;E>-s/2;){if(g--,g<0)return!1;E-=u[g].dist(f),f=u[g]}E+=u[g].dist(u[g+1]),g++;const O=[];let D=0;for(;E<s/2;){const w=u[g],C=u[g+1];if(!C)return!1;let R=u[g-1].angleTo(w)-w.angleTo(C);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:E,angleDelta:R}),D+=R;E-O[0].distance>c;)D-=O.shift().angleDelta;if(D>m)return!1;g++,E+=w.dist(C)}return!0}function kC(u){let n=0;for(let s=0;s<u.length-1;s++)n+=u[s].dist(u[s+1]);return n}function RC(u,n,s){return u?.6*n*s:0}function LC(u,n){return Math.max(u?u.right-u.left:0,n?n.right-n.left:0)}function v8(u,n,s,c,m,f){const g=RC(s,m,f),E=LC(s,c)*f;let O=0;const D=kC(u)/2;for(let w=0;w<u.length-1;w++){const C=u[w],R=u[w+1],P=C.dist(R);if(O+P>D){const k=(D-O)/P,N=Yn(C.x,R.x,k),W=Yn(C.y,R.y,k),X=new Uf(N,W,0,R.angleTo(C),w);return!g||OC(u,X,E,g,n)?X:void 0}O+=P}}function x8(u,n,s,c,m,f,g,E,O){const D=RC(c,f,g),w=LC(c,m),C=w*g,R=u[0].x===0||u[0].x===O||u[0].y===0||u[0].y===O;return n-C<n/4&&(n=C+n/4),DC(u,R?n/2*E%n:(w/2+2*f)*g*E%n,n,D,s,C,R,!1,O)}function DC(u,n,s,c,m,f,g,E,O){const D=f/2,w=kC(u);let C=0,R=n-s,P=[];for(let k=0;k<u.length-1;k++){const N=u[k],W=u[k+1],X=N.dist(W),ee=W.angleTo(N);for(;R+s<C+X;){R+=s;const ne=(R-C)/X,J=Yn(N.x,W.x,ne),he=Yn(N.y,W.y,ne);if(J>=0&&J<O&&he>=0&&he<O&&R-D>=0&&R+D<=w){const ye=new Uf(J,he,0,ee,k);c&&!OC(u,ye,f,c,m)||P.push(ye)}}C+=X}return E||P.length||g||(P=DC(u,C/2,s,c,m,f,g,!0,O)),P}function zC(u,n,s,c,m){const f=[];for(let g=0;g<u.length;g++){const E=u[g];let O;for(let D=0;D<E.length-1;D++){let w=E[D],C=E[D+1];w.x<n&&C.x<n||(w.x<n?w=new Yt(n,w.y+(n-w.x)/(C.x-w.x)*(C.y-w.y))._round():C.x<n&&(C=new Yt(n,w.y+(n-w.x)/(C.x-w.x)*(C.y-w.y))._round()),w.y<s&&C.y<s||(w.y<s?w=new Yt(w.x+(s-w.y)/(C.y-w.y)*(C.x-w.x),s)._round():C.y<s&&(C=new Yt(w.x+(s-w.y)/(C.y-w.y)*(C.x-w.x),s)._round()),w.x>=c&&C.x>=c||(w.x>=c?w=new Yt(c,w.y+(c-w.x)/(C.x-w.x)*(C.y-w.y))._round():C.x>=c&&(C=new Yt(c,w.y+(c-w.x)/(C.x-w.x)*(C.y-w.y))._round()),w.y>=m&&C.y>=m||(w.y>=m?w=new Yt(w.x+(m-w.y)/(C.y-w.y)*(C.x-w.x),m)._round():C.y>=m&&(C=new Yt(w.x+(m-w.y)/(C.y-w.y)*(C.x-w.x),m)._round()),O&&w.equals(O[O.length-1])||(O=[w],f.push(O)),O.push(C)))))}}return f}function FC(u){let n=0,s=0;for(const g of u)n+=g.w*g.h,s=Math.max(s,g.w);u.sort((g,E)=>E.h-g.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let m=0,f=0;for(const g of u)for(let E=c.length-1;E>=0;E--){const O=c[E];if(!(g.w>O.w||g.h>O.h)){if(g.x=O.x,g.y=O.y,f=Math.max(f,g.y+g.h),m=Math.max(m,g.x+g.w),g.w===O.w&&g.h===O.h){const D=c.pop();E<c.length&&(c[E]=D)}else g.h===O.h?(O.x+=g.w,O.w-=g.w):g.w===O.w?(O.y+=g.h,O.h-=g.h):(c.push({x:O.x+g.w,y:O.y,w:O.w-g.w,h:g.h}),O.y+=g.h,O.h-=g.h);break}}return{w:m,h:f,fill:n/(m*f)||0}}kn(Uf,"Anchor");const o_=1;class k1{constructor(n,{pixelRatio:s,version:c,stretchX:m,stretchY:f,content:g},E){this.paddedRect=n,this.pixelRatio=s,this.stretchX=m,this.stretchY=f,this.content=g,this.version=c,this.padding=E}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class BC{constructor(n,s,c){const m={},f={};this.haveRenderCallbacks=[];const g=[];this.addImages(n,m,o_,g),this.addImages(s,f,2,g);const{w:E,h:O}=FC(g),D=new xs({width:E||1,height:O||1});for(const w in n){const C=n[w],R=m[w].paddedRect;xs.copy(C.data,D,{x:0,y:0},{x:R.x+o_,y:R.y+o_},C.data,c,C.sdf)}for(const w in s){const C=s[w],R=f[w].paddedRect;let P=f[w].padding;const k=R.x+P,N=R.y+P,W=C.data.width,X=C.data.height;P=P>1?P-1:P,xs.copy(C.data,D,{x:0,y:0},{x:k,y:N},C.data,c),xs.copy(C.data,D,{x:0,y:X-P},{x:k,y:N-P},{width:W,height:P},c),xs.copy(C.data,D,{x:0,y:0},{x:k,y:N+X},{width:W,height:P},c),xs.copy(C.data,D,{x:W-P,y:0},{x:k-P,y:N},{width:P,height:X},c),xs.copy(C.data,D,{x:0,y:0},{x:k+W,y:N},{width:P,height:X},c),xs.copy(C.data,D,{x:W-P,y:X-P},{x:k-P,y:N-P},{width:P,height:P},c),xs.copy(C.data,D,{x:0,y:X-P},{x:k+W,y:N-P},{width:P,height:P},c),xs.copy(C.data,D,{x:0,y:0},{x:k+W,y:N+X},{width:P,height:P},c),xs.copy(C.data,D,{x:W-P,y:0},{x:k-P,y:N+X},{width:P,height:P},c)}this.image=D,this.iconPositions=m,this.patternPositions=f}addImages(n,s,c,m){for(const f in n){const g=n[f],E={x:0,y:0,w:g.data.width+2*c,h:g.data.height+2*c};m.push(E),s[f]=new k1(E,g,c),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(n,s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>n.hasImage(m,c)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const m in n.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[m],n.getImage(m,c),s),this.patchUpdatedImage(this.patternPositions[m],n.getImage(m,c),s)}patchUpdatedImage(n,s,c){if(!n||!s||n.version===s.version)return;n.version=s.version;const[m,f]=n.tl;c.update(s.data,{position:{x:m,y:f}})}}kn(k1,"ImagePosition"),kn(BC,"ImageAtlas");const a_=1e20;function NC(u,n,s,c,m,f,g,E,O){for(let D=n;D<n+c;D++)jC(u,s*f+D,f,m,g,E,O);for(let D=s;D<s+m;D++)jC(u,D*f+n,1,c,g,E,O)}function jC(u,n,s,c,m,f,g){f[0]=0,g[0]=-a_,g[1]=a_,m[0]=u[n];for(let E=1,O=0,D=0;E<c;E++){m[E]=u[n+E*s];const w=E*E;do{const C=f[O];D=(m[E]-m[C]+w-C*C)/(E-C)/2}while(D<=g[O]&&--O>-1);O++,f[O]=E,g[O]=D,g[O+1]=a_}for(let E=0,O=0;E<c;E++){for(;g[O+1]<E;)O++;const D=f[O],w=E-D;u[n+E*s]=m[D]+w*w}}const Eh=2,R1={none:0,ideographs:1,all:2};class Mm{constructor(n,s,c){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,c){const m=[],f=this.urls[s]||re.GLYPHS_URL;for(const g in n)for(const E of n[g])m.push({stack:g,id:E});la(m,({stack:g,id:E},O)=>{let D=this.entries[g];D||(D=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=D.glyphs[E];if(w!==void 0)return void O(null,{stack:g,id:E,glyph:w});if(w=this._tinySDF(D,g,E),w)return D.glyphs[E]=w,void O(null,{stack:g,id:E,glyph:w});const C=Math.floor(E/256);if(256*C>65535)return Er("glyphs > 65535 not supported"),void O(null,{stack:g,id:E,glyph:w});if(D.ranges[C])return void O(null,{stack:g,id:E,glyph:w});let R=D.requests[C];R||(R=D.requests[C]=[],Mm.loadGlyphRange(g,C,f,this.requestManager,(P,k)=>{if(k){D.ascender=k.ascender,D.descender=k.descender;for(const N in k.glyphs)this._doesCharSupportLocalGlyph(+N)||(D.glyphs[+N]=k.glyphs[+N]);D.ranges[C]=!0}for(const N of R)N(P,k);delete D.requests[C]})),R.push((P,k)=>{P?O(P):k&&O(null,{stack:g,id:E,glyph:k.glyphs[E]||null})})},(g,E)=>{if(g)c(g);else if(E){const O={};for(const{stack:D,id:w,glyph:C}of E)O[D]===void 0&&(O[D]={}),O[D].glyphs===void 0&&(O[D].glyphs={}),O[D].glyphs[w]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},O[D].ascender=this.entries[D].ascender,O[D].descender=this.entries[D].descender;c(null,O)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==R1.none&&(this.localGlyphMode===R1.all?!!this.localFontFamily:!!this.localFontFamily&&(Jn["CJK Unified Ideographs"](n)||Jn["Hangul Syllables"](n)||Jn.Hiragana(n)||Jn.Katakana(n)||Jn["CJK Symbols and Punctuation"](n)||Jn["CJK Unified Ideographs Extension A"](n)||Jn["CJK Unified Ideographs Extension B"](n)||Jn.Osage(n)))}_tinySDF(n,s,c){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(c))return;let f=n.tinySDF;if(!f){let N="400";/bold/i.test(s)?N="900":/medium/i.test(s)?N="500":/light/i.test(s)&&(N="200"),f=n.tinySDF=new Mm.TinySDF({fontFamily:m,fontWeight:N,fontSize:24*Eh,buffer:3*Eh,radius:8*Eh}),f.fontWeight=N}if(this.localGlyphs[f.fontWeight][c])return this.localGlyphs[f.fontWeight][c];const g=String.fromCodePoint(c),{data:E,width:O,height:D,glyphWidth:w,glyphHeight:C,glyphLeft:R,glyphTop:P,glyphAdvance:k}=f.draw(g);return this.localGlyphs[f.fontWeight][c]={id:c,bitmap:new Yh({width:O,height:D},E),metrics:{width:w/Eh,height:C/Eh,left:R/Eh,top:P/Eh-27,advance:k/Eh,localGlyph:!0}}}}Mm.loadGlyphRange=function(u,n,s,c,m){const f=256*n,g=f+255,E=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",u).replace("{range}",`${f}-${g}`),ci.Glyphs);xa(E,(O,D)=>{if(O)m(O);else if(D){const w={},C=function(R){return new gv(R).readFields(d8,{})}(D);for(const R of C.glyphs)w[R.id]=R;m(null,{glyphs:w,ascender:C.ascender,descender:C.descender})}})},Mm.TinySDF=class{constructor({fontSize:u=24,buffer:n=3,radius:s=8,cutoff:c=.25,fontFamily:m="sans-serif",fontWeight:f="normal",fontStyle:g="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=s;const E=this.size=u+4*n,O=this._createCanvas(E),D=this.ctx=O.getContext("2d",{willReadFrequently:!0});D.font=`${g} ${f} ${u}px ${m}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(u){const n=document.createElement("canvas");return n.width=n.height=u,n}draw(u){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:m,actualBoundingBoxRight:f}=this.ctx.measureText(u),g=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-m))),O=Math.min(this.size-this.buffer,g+Math.ceil(c)),D=E+2*this.buffer,w=O+2*this.buffer,C=Math.max(D*w,0),R=new Uint8ClampedArray(C),P={data:R,width:D,height:w,glyphWidth:E,glyphHeight:O,glyphTop:g,glyphLeft:0,glyphAdvance:n};if(E===0||O===0)return P;const{ctx:k,buffer:N,gridInner:W,gridOuter:X}=this;k.clearRect(N,N,E,O),k.fillText(u,N,N+g);const ee=k.getImageData(N,N,E,O);X.fill(a_,0,C),W.fill(0,0,C);for(let ne=0;ne<O;ne++)for(let J=0;J<E;J++){const he=ee.data[4*(ne*E+J)+3]/255;if(he===0)continue;const ye=(ne+N)*D+J+N;if(he===1)X[ye]=0,W[ye]=a_;else{const Me=.5-he;X[ye]=Me>0?Me*Me:0,W[ye]=Me<0?Me*Me:0}}NC(X,0,0,D,w,D,this.f,this.v,this.z),NC(W,N,N,E,O,D,this.f,this.v,this.z);for(let ne=0;ne<C;ne++){const J=Math.sqrt(X[ne])-Math.sqrt(W[ne]);R[ne]=Math.round(255-255*(J/this.radius+this.cutoff))}return P}};const Rd=o_;function $C(u,n,s,c,m=1){const f=[],g=u.imagePrimary,E=g.pixelRatio,O=g.paddedRect.w-2*Rd,D=g.paddedRect.h-2*Rd,w=(u.right-u.left)*m,C=(u.bottom-u.top)*m,R=g.stretchX||[[0,O]],P=g.stretchY||[[0,D]],k=(je,nt)=>je+nt[1]-nt[0],N=R.reduce(k,0),W=P.reduce(k,0),X=O-N,ee=D-W;let ne=0,J=N,he=0,ye=W,Me=0,Ve=X,Ne=0,$e=ee;if(g.content&&c){const je=g.content;ne=yv(R,0,je[0]),he=yv(P,0,je[1]),J=yv(R,je[0],je[2]),ye=yv(P,je[1],je[3]),Me=je[0]-ne,Ne=je[1]-he,Ve=je[2]-je[0]-J,$e=je[3]-je[1]-ye}const ot=(je,nt,ct,ht)=>{const _t=vv(je.stretch-ne,J,w,u.left*m),At=xv(je.fixed-Me,Ve,je.stretch,N),It=vv(nt.stretch-he,ye,C,u.top*m),wt=xv(nt.fixed-Ne,$e,nt.stretch,W),Xt=vv(ct.stretch-ne,J,w,u.left*m),pn=xv(ct.fixed-Me,Ve,ct.stretch,N),Ut=vv(ht.stretch-he,ye,C,u.top*m),Fn=xv(ht.fixed-Ne,$e,ht.stretch,W),An=new Yt(_t,It),xn=new Yt(Xt,It),cn=new Yt(Xt,Ut),ur=new Yt(_t,Ut),zn=new Yt(At/E,wt/E),qn=new Yt(pn/E,Fn/E),Lr=n*Math.PI/180;if(Lr){const oo=Math.sin(Lr),Yi=Math.cos(Lr),Tr=[Yi,-oo,oo,Yi];An._matMult(Tr),xn._matMult(Tr),ur._matMult(Tr),cn._matMult(Tr)}const Xr=je.stretch+je.fixed,ei=ct.stretch+ct.fixed,Vr=nt.stretch+nt.fixed,fi=ht.stretch+ht.fixed,ui=u.imageSecondary;return{tl:An,tr:xn,bl:ur,br:cn,texPrimary:{x:g.paddedRect.x+Rd+Xr,y:g.paddedRect.y+Rd+Vr,w:ei-Xr,h:fi-Vr},texSecondary:ui?{x:ui.paddedRect.x+Rd+Xr,y:ui.paddedRect.y+Rd+Vr,w:ei-Xr,h:fi-Vr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:zn,pixelOffsetBR:qn,minFontScaleX:Ve/E/w,minFontScaleY:$e/E/C,isSDF:s}};if(c&&(g.stretchX||g.stretchY)){const je=UC(R,X,N),nt=UC(P,ee,W);for(let ct=0;ct<je.length-1;ct++){const ht=je[ct],_t=je[ct+1];for(let At=0;At<nt.length-1;At++)f.push(ot(ht,nt[At],_t,nt[At+1]))}}else f.push(ot({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:D+1}));return f}function yv(u,n,s){let c=0;for(const m of u)c+=Math.max(n,Math.min(s,m[1]))-Math.max(n,Math.min(s,m[0]));return c}function UC(u,n,s){const c=[{fixed:-Rd,stretch:0}];for(const[m,f]of u){const g=c[c.length-1];c.push({fixed:m-g.stretch,stretch:g.stretch}),c.push({fixed:m-g.stretch,stretch:g.stretch+(f-m)})}return c.push({fixed:n+Rd,stretch:s}),c}function vv(u,n,s,c){return u/n*s+c}function xv(u,n,s,c){return u-n*s/c}function b8(u,n,s,c){const m=n+u.positionedLines[c].lineOffset;return c===0?s+m/2:s+(m+(n+u.positionedLines[c-1].lineOffset))/2}function w8(u,n=1,s=!1){let c=1/0,m=1/0,f=-1/0,g=-1/0;const E=u[0];for(let P=0;P<E.length;P++){const k=E[P];(!P||k.x<c)&&(c=k.x),(!P||k.y<m)&&(m=k.y),(!P||k.x>f)&&(f=k.x),(!P||k.y>g)&&(g=k.y)}const O=Math.min(f-c,g-m);let D=O/2;const w=new cs([],S8);if(O===0)return new Yt(c,m);for(let P=c;P<f;P+=O)for(let k=m;k<g;k+=O)w.push(new Im(P+D,k+D,D,u));let C=function(P){let k=0,N=0,W=0;const X=P[0];for(let ee=0,ne=X.length,J=ne-1;ee<ne;J=ee++){const he=X[ee],ye=X[J],Me=he.x*ye.y-ye.x*he.y;N+=(he.x+ye.x)*Me,W+=(he.y+ye.y)*Me,k+=3*Me}return new Im(N/k,W/k,0,P)}(u),R=w.length;for(;w.length;){const P=w.pop();(P.d>C.d||!C.d)&&(C=P,s&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,R)),P.max-C.d<=n||(D=P.h/2,w.push(new Im(P.p.x-D,P.p.y-D,D,u)),w.push(new Im(P.p.x+D,P.p.y-D,D,u)),w.push(new Im(P.p.x-D,P.p.y+D,D,u)),w.push(new Im(P.p.x+D,P.p.y+D,D,u)),R+=4)}return s&&(console.log(`num probes: ${R}`),console.log(`best distance: ${C.d}`)),C.p}function S8(u,n){return n.max-u.max}class Im{constructor(n,s,c,m){this.p=new Yt(n,s),this.h=c,this.d=function(f,g){let E=!1,O=1/0;for(let D=0;D<g.length;D++){const w=g[D];for(let C=0,R=w.length,P=R-1;C<R;P=C++){const k=w[C],N=w[P];k.y>f.y!=N.y>f.y&&f.x<(N.x-k.x)*(f.y-k.y)/(N.y-k.y)+k.x&&(E=!E),O=Math.min(O,pr(f,k,N))}}return(E?1:-1)*Math.sqrt(O)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const L1=Number.POSITIVE_INFINITY,T8=Math.sqrt(2);function VC(u,[n,s]){let c=0,m=0;if(s===L1){n<0&&(n=0);const f=n/T8;switch(u){case"top-right":case"top-left":m=f-7;break;case"bottom-right":case"bottom-left":m=7-f;break;case"bottom":m=7-n;break;case"top":m=n-7}switch(u){case"top-right":case"bottom-right":c=-f;break;case"top-left":case"bottom-left":c=f;break;case"left":c=n;break;case"right":c=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),u){case"top-right":case"top-left":case"top":m=s-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-s}switch(u){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}}return[c,m]}function D1(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function E8(u,n,s,c,m,f,g,E,O,D,w,C,R,P,k){let N=f.textMaxSize.evaluate(n,{},C);N===void 0?N=g*f.textScaleFactor:N*=f.textScaleFactor;const W=u.layers[0].layout,X=W.get("icon-offset").evaluate(n,{},C),ee=GC(s.horizontal)||s.vertical,ne=R.name==="globe",J=Gs,he=g*f.textScaleFactor/J,ye=u.tilePixelRatio*N/J,Me=(ht=u.overscaling,u.zoom>18&&ht>2&&(ht>>=1),Math.max(En/(512*ht),1)*W.get("symbol-spacing")),Ve=W.get("text-padding")*u.tilePixelRatio,Ne=W.get("icon-padding")*u.tilePixelRatio,$e=sr(W.get("text-max-angle")),ot=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",je=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",nt=W.get("symbol-placement"),ct=Me/2;var ht;const _t=W.get("icon-text-fit").evaluate(n,{},C),At=W.get("icon-text-fit-padding").evaluate(n,{},C),It=_t!=="none";let wt;u.hasAnyIconTextFit===!1&&It&&(u.hasAnyIconTextFit=!0),c&&It&&(u.allowVerticalPlacement&&s.vertical&&(wt=CC(c,s.vertical,_t,At,X,he)),ee&&(c=CC(c,ee,_t,At,X,he)));const Xt=(pn,Ut,Fn)=>{if(Ut.x<0||Ut.x>=En||Ut.y<0||Ut.y>=En)return;let An=null;if(ne){const{x:xn,y:cn,z:ur}=R.projectTilePoint(Ut.x,Ut.y,Fn);An={anchor:new Uf(xn,cn,ur,0,void 0),up:R.upVector(Fn,Ut.x,Ut.y)}}(function(xn,cn,ur,zn,qn,Lr,Xr,ei,Vr,fi,ui,oo,Yi,Tr,$i,qi,bo,ga,La,_a,Jo,Ea,Ga,Hs,mo,nu,Ih){const zc=xn.addToLineVertexArray(cn,zn);let Fc,Tp,Bd,Ep,E_,hk,fk,dk=0,pk=0,mk=0,gk=0,cb=-1,hb=-1;const ef={};let _k=Cn("");const Ap=ur?ur.anchor:cn,fb=Vr.layout.get("icon-text-fit").evaluate(Jo,{},mo)!=="none";let db=0,pb=0;if(Vr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[db,pb]=Vr.layout.get("text-offset").evaluate(Jo,{},mo).map(Pu=>Pu*Gs):(db=Vr.layout.get("text-radial-offset").evaluate(Jo,{},mo)*Gs,pb=L1),xn.allowVerticalPlacement&&qn.vertical){const Pu=qn.vertical;if($i)hk=z1(Pu),ei&&(fk=z1(ei));else{const Mu=Vr.layout.get("text-rotate").evaluate(Jo,{},mo)+90;Bd=bv(fi,Ap,cn,ui,oo,Yi,Pu,Tr,Mu,qi),ei&&(Ep=bv(fi,Ap,cn,ui,oo,Yi,ei,ga,Mu))}}if(Lr){const Pu=Vr.layout.get("icon-rotate").evaluate(Jo,{},mo),Mu=$C(Lr,Pu,Ga,fb,Ea.iconScaleFactor),Fm=ei?$C(ei,Pu,Ga,fb,Ea.iconScaleFactor):void 0;Tp=bv(fi,Ap,cn,ui,oo,Yi,Lr,ga,Pu),dk=4*Mu.length;const yk=xn.iconSizeData;let Pp=null;yk.kind==="source"?(Pp=[Th*Vr.layout.get("icon-size").evaluate(Jo,{},mo)*Ea.iconScaleFactor],Pp[0]>Ld&&Er(`${xn.layerIds[0]}: Value for "icon-size" is >= ${s_}. Reduce your "icon-size".`)):yk.kind==="composite"&&(Pp=[Th*Ea.compositeIconSizes[0].evaluate(Jo,{},mo)*Ea.iconScaleFactor,Th*Ea.compositeIconSizes[1].evaluate(Jo,{},mo)*Ea.iconScaleFactor],(Pp[0]>Ld||Pp[1]>Ld)&&Er(`${xn.layerIds[0]}: Value for "icon-size" is >= ${s_}. Reduce your "icon-size".`)),xn.addSymbols(xn.icon,Mu,Pp,_a,La,Jo,!1,ur,cn,zc.lineStartIndex,zc.lineLength,-1,Hs,mo,nu,Ih),cb=xn.icon.placedSymbolArray.length-1,Fm&&(pk=4*Fm.length,xn.addSymbols(xn.icon,Fm,Pp,_a,La,Jo,Ju.vertical,ur,cn,zc.lineStartIndex,zc.lineLength,-1,Hs,mo,nu,Ih),hb=xn.icon.placedSymbolArray.length-1)}for(const Pu in qn.horizontal){const Mu=qn.horizontal[Pu];Fc||(_k=Cn(Mu.text),$i?E_=z1(Mu):Fc=bv(fi,Ap,cn,ui,oo,Yi,Mu,Tr,Vr.layout.get("text-rotate").evaluate(Jo,{},mo),qi));const Fm=Mu.positionedLines.length===1;if(mk+=qC(xn,ur,cn,Mu,Xr,Vr,$i,Jo,qi,zc,qn.vertical?Ju.horizontal:Ju.horizontalOnly,Fm?Object.keys(qn.horizontal):[Pu],ef,cb,Ea,Hs,mo,nu),Fm)break}qn.vertical&&(gk+=qC(xn,ur,cn,qn.vertical,Xr,Vr,$i,Jo,qi,zc,Ju.vertical,["vertical"],ef,hb,Ea,Hs,mo,nu));let Nd=-1;const mb=(Pu,Mu)=>Pu?Math.max(Pu,Mu):Mu;Nd=mb(E_,Nd),Nd=mb(hk,Nd),Nd=mb(fk,Nd);const jV=Nd>-1?1:0;xn.glyphOffsetArray.length>=65535&&Er("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jo.sortKey!==void 0&&xn.addToSortKeyRanges(xn.symbolInstances.length,Jo.sortKey),xn.symbolInstances.emplaceBack(cn.x,cn.y,Ap.x,Ap.y,Ap.z,ef.right>=0?ef.right:-1,ef.center>=0?ef.center:-1,ef.left>=0?ef.left:-1,ef.vertical>=0?ef.vertical:-1,cb,hb,_k,Fc!==void 0?Fc:xn.collisionBoxArray.length,Fc!==void 0?Fc+1:xn.collisionBoxArray.length,Bd!==void 0?Bd:xn.collisionBoxArray.length,Bd!==void 0?Bd+1:xn.collisionBoxArray.length,Tp!==void 0?Tp:xn.collisionBoxArray.length,Tp!==void 0?Tp+1:xn.collisionBoxArray.length,Ep||xn.collisionBoxArray.length,Ep?Ep+1:xn.collisionBoxArray.length,ui,mk,gk,dk,pk,jV,0,db,pb,Nd,0,fb?1:0)})(u,Ut,An,pn,s,c,m,wt,u.layers[0],u.collisionBoxArray,n.index,n.sourceLayerIndex,u.index,Ve,ot,O,0,Ne,je,X,n,f,D,w,C,P,k)};if(nt==="line")for(const pn of zC(n.geometry,0,0,En,En)){const Ut=x8(pn,Me,$e,s.vertical||ee,c,J,ye,u.overscaling,En);for(const Fn of Ut)ee&&A8(u,ee.text,ct,Fn)||Xt(pn,Fn,C)}else if(nt==="line-center"){for(const pn of n.geometry)if(pn.length>1){const Ut=v8(pn,$e,s.vertical||ee,c,J,ye);Ut&&Xt(pn,Ut,C)}}else if(n.type==="Polygon")for(const pn of mn(n.geometry,0)){const Ut=w8(pn,16);Xt(pn[0],new Uf(Ut.x,Ut.y,0,0,void 0),C)}else if(n.type==="LineString")for(const pn of n.geometry)Xt(pn,new Uf(pn[0].x,pn[0].y,0,0,void 0),C);else if(n.type==="Point")for(const pn of n.geometry)for(const Ut of pn)Xt([Ut],new Uf(Ut.x,Ut.y,0,0,void 0),C)}const s_=255,Ld=s_*Th;function qC(u,n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W,X){const ee=function(he,ye,Me,Ve,Ne,$e,ot,je){const nt=[];if(ye.positionedLines.length===0)return nt;const ct=Ve.layout.get("text-rotate").evaluate($e,{})*Math.PI/180,ht=function(Xt){const pn=Xt[0],Ut=Xt[1],Fn=pn*Ut;return Fn>0?[pn,-Ut]:Fn<0?[-pn,Ut]:pn===0?[Ut,pn]:[Ut,-pn]}(Me);let _t=Math.abs(ye.top-ye.bottom);for(const Xt of ye.positionedLines)_t-=Xt.lineOffset;const At=ye.positionedLines.length,It=_t/At;let wt=ye.top-Me[1];for(let Xt=0;Xt<At;++Xt){const pn=ye.positionedLines[Xt];wt=b8(ye,It,wt,Xt);for(const Ut of pn.positionedGlyphs){if(!Ut.rect)continue;const Fn=Ut.rect||{};let An=TC+1,xn=!0,cn=1,ur=0;if(Ut.imageName){const _a=ot[Ut.imageName];if(!_a)continue;if(_a.sdf){Er("SDF images are not supported in formatted text and will be ignored.");continue}xn=!1,cn=_a.pixelRatio,An=o_/cn}const zn=(Ne||je)&&Ut.vertical,qn=Ut.metrics.advance*Ut.scale/2,Lr=Ut.metrics,Xr=Ut.rect;if(Xr===null)continue;je&&ye.verticalizable&&(ur=Ut.imageName?qn-Ut.metrics.width*Ut.scale/2:0);const ei=Ne?[Ut.x+qn,Ut.y]:[0,0];let Vr=[0,0],fi=[0,0],ui=!1;Ne||(zn?(fi=[Ut.x+qn+ht[0],Ut.y+ht[1]-ur],ui=!0):Vr=[Ut.x+qn+Me[0],Ut.y+Me[1]-ur]);const oo=Xr.w*Ut.scale/(cn*(Ut.localGlyph?Eh:1)),Yi=Xr.h*Ut.scale/(cn*(Ut.localGlyph?Eh:1));let Tr,$i,qi,bo;if(zn){const _a=Ut.y-wt,Jo=new Yt(-qn,qn-_a),Ea=-Math.PI/2,Ga=new Yt(...fi);Tr=new Yt(-qn+Vr[0],Vr[1]),Tr._rotateAround(Ea,Jo)._add(Ga),Tr.x+=-_a+qn,Tr.y-=(Lr.left-An)*Ut.scale;const Hs=Ut.imageName?Lr.advance*Ut.scale:Gs*Ut.scale,mo=String.fromCodePoint(Ut.glyph);c8(mo)?Tr.x+=(1-An)*Ut.scale:h8(mo)?Tr.x+=Hs-Lr.height*Ut.scale+(-An-1)*Ut.scale:Tr.x+=Ut.imageName||Lr.width+2*An===Xr.w&&Lr.height+2*An===Xr.h?(Hs-Yi)/2:(Hs-(Lr.height+2*An)*Ut.scale)/2,$i=new Yt(Tr.x,Tr.y-oo),qi=new Yt(Tr.x+Yi,Tr.y),bo=new Yt(Tr.x+Yi,Tr.y-oo)}else{const _a=(Lr.left-An)*Ut.scale-qn+Vr[0],Jo=(-Lr.top-An)*Ut.scale+Vr[1],Ea=_a+oo,Ga=Jo+Yi;Tr=new Yt(_a,Jo),$i=new Yt(Ea,Jo),qi=new Yt(_a,Ga),bo=new Yt(Ea,Ga)}if(ct){let _a;_a=Ne?new Yt(0,0):ui?new Yt(ht[0],ht[1]):new Yt(Me[0],Me[1]),Tr._rotateAround(ct,_a),$i._rotateAround(ct,_a),qi._rotateAround(ct,_a),bo._rotateAround(ct,_a)}const ga=new Yt(0,0),La=new Yt(0,0);nt.push({tl:Tr,tr:$i,bl:qi,br:bo,texPrimary:Fn,texSecondary:void 0,writingMode:ye.writingMode,glyphOffset:ei,sectionIndex:Ut.sectionIndex,isSDF:xn,pixelOffsetTL:ga,pixelOffsetBR:La,minFontScaleX:0,minFontScaleY:0})}}return nt}(0,c,O,f,g,E,m,u.allowVerticalPlacement),ne=u.textSizeData;let J=null;ne.kind==="source"?(J=[Th*f.layout.get("text-size").evaluate(E,{},W)*k.textScaleFactor],J[0]>Ld&&Er(`${u.layerIds[0]}: Value for "text-size" is >= ${s_}. Reduce your "text-size".`)):ne.kind==="composite"&&(J=[Th*k.compositeTextSizes[0].evaluate(E,{},W)*k.textScaleFactor,Th*k.compositeTextSizes[1].evaluate(E,{},W)*k.textScaleFactor],(J[0]>Ld||J[1]>Ld)&&Er(`${u.layerIds[0]}: Value for "text-size" is >= ${s_}. Reduce your "text-size".`)),u.addSymbols(u.text,ee,J,O,g,E,w,n,s,D.lineStartIndex,D.lineLength,P,N,W,X,!1);for(const he of C)R[he]=u.text.placedSymbolArray.length-1;return 4*ee.length}function GC(u){for(const n in u)return u[n];return null}function bv(u,n,s,c,m,f,g,E,O,D){let w=g.top,C=g.bottom,R=g.left,P=g.right;const k=g.collisionPadding;if(k&&(R-=k[0],w-=k[1],P+=k[2],C+=k[3]),O){const N=new Yt(R,w),W=new Yt(P,w),X=new Yt(R,C),ee=new Yt(P,C),ne=sr(O);let J=new Yt(0,0);D&&(J=new Yt(D[0],D[1])),N._rotateAround(ne,J),W._rotateAround(ne,J),X._rotateAround(ne,J),ee._rotateAround(ne,J),R=Math.min(N.x,W.x,X.x,ee.x),P=Math.max(N.x,W.x,X.x,ee.x),w=Math.min(N.y,W.y,X.y,ee.y),C=Math.max(N.y,W.y,X.y,ee.y)}return u.emplaceBack(n.x,n.y,n.z,s.x,s.y,R,w,P,C,E,c,m,f),u.length-1}function z1(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const n=u.bottom-u.top;return n>0?Math.max(10,n):null}function A8(u,n,s,c){const m=u.compareText;if(n in m){const f=m[n];for(let g=f.length-1;g>=0;g--)if(c.dist(f[g])<s)return!0}else m[n]=[];return m[n].push(c),!1}function HC(u,n){const s=u.fovAboveCenter,c=u.elevation?u.elevation.getMinElevationBelowMSL()*n:0,m=(u._camera.position[2]*u.worldSize-c)/Math.cos(u._pitch),f=Math.sin(s)*m/Math.sin(Math.max(Math.PI/2-u._pitch-s,.01));let g=Math.sin(u._pitch)*f+m;const E=m*(1/u._horizonShift);return u.elevation&&u.elevation.exaggeration()!==0||(g*=1+Math.max(u.zoom-17,0)),Math.min(1.01*g,E)}function l_(u,n){if(!n.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:n};const s=Math.pow(2,-u.z),c=u.x*s,m=(u.x+1)*s,f=u.y*s,g=(u.y+1)*s,E=ze(c),O=ze(m),D=Ue(f),w=Ue(g),C=n.project(E,D),R=n.project(O,D),P=n.project(O,w),k=n.project(E,w);let N=Math.min(C.x,R.x,P.x,k.x),W=Math.min(C.y,R.y,P.y,k.y),X=Math.max(C.x,R.x,P.x,k.x),ee=Math.max(C.y,R.y,P.y,k.y);const ne=s/16;function J(ye,Me,Ve,Ne,$e,ot){const je=(Ve+$e)/2,nt=(Ne+ot)/2,ct=n.project(ze(je),Ue(nt)),ht=Math.max(0,N-ct.x,W-ct.y,ct.x-X,ct.y-ee);N=Math.min(N,ct.x),X=Math.max(X,ct.x),W=Math.min(W,ct.y),ee=Math.max(ee,ct.y),ht>ne&&(J(ye,ct,Ve,Ne,je,nt),J(ct,Me,je,nt,$e,ot))}J(C,R,c,f,m,f),J(R,P,m,f,m,g),J(P,k,m,g,c,g),J(k,C,c,g,c,f),N-=ne,W-=ne,X+=ne,ee+=ne;const he=1/Math.max(X-N,ee-W);return{scale:he,x:N*he,y:W*he,x2:X*he,y2:ee*he,projection:n}}function WC(u,{x:n,y:s},c=0){return new Yt(((n-c)*u.scale-u.x)*En,(s*u.scale-u.y)*En)}const P8=Ke.mat4.identity(new Float32Array(16));class Dd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new q(0,0)}projectTilePoint(n,s,c){return{x:n,y:s,z:0}}locationPoint(n,s,c=!0){return n._coordinatePoint(n.locationCoordinate(s),c)}pixelsPerMeter(n,s){return we(1,n)*s}pixelSpaceConversion(n,s,c){return 1}farthestPixelDistance(n){return HC(n,n.pixelsPerMeter)}pointCoordinate(n,s,c,m){const f=n.horizonLineFromTop(!1),g=new Yt(s,Math.max(f,c));return n.rayIntersectionCoordinate(n.pointRayIntersection(g,m))}pointCoordinate3D(n,s,c){const m=new Yt(s,c);if(n.elevation)return n.elevation.pointCoordinate(m);{const f=this.pointCoordinate(n,m.x,m.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const c=n.horizonLineFromTop();return s.y<c}createInversionMatrix(n,s){return P8}createTileMatrix(n,s,c){let m,f,g;const E=c.canonical,O=Ke.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=l_(E,this);m=1,f=D.x+c.wrap*D.scale,g=D.y,Ke.mat4.scale(O,O,[m/D.scale,m/D.scale,n.pixelsPerMeter/s])}else m=s/n.zoomScale(E.z),f=(E.x+Math.pow(2,E.z)*c.wrap)*m,g=E.y*m;return Ke.mat4.translate(O,O,[f,g,0]),Ke.mat4.scale(O,O,[m/En,m/En,1]),O}upVector(n,s,c){return[0,0,1]}upVectorScale(n,s,c){return{metersToTile:1}}}class M8 extends Dd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,c]=this.parallels=n.parallels||[29.5,45.5],m=Math.sin(sr(s));this.n=(m+Math.sin(sr(c)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:c,c:m,r0:f}=this,g=sr(n-this.center[0]),E=sr(s),O=Math.sqrt(m-2*c*Math.sin(E))/c;return{x:O*Math.sin(g*c),y:O*Math.cos(g*c)-f,z:0}}unproject(n,s){const{n:c,c:m,r0:f}=this,g=f+s;let E=Math.atan2(n,Math.abs(g))*Math.sign(g);g*c<0&&(E-=Math.PI*Math.sign(n)*Math.sign(g));const O=sr(this.center[0])*c;E=ea(E,-Math.PI-O,Math.PI-O);const D=lr(_i(E/c)+this.center[0],-180,180),w=Math.asin(lr((m-(n*n+g*g)*c*c)/(2*c),-1,1)),C=lr(_i(w),-He,He);return new q(D,C)}}const u_=1.340264,c_=-.081106,h_=893e-6,f_=.003796,wv=Math.sqrt(3)/2;class I8 extends Dd{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const c=Math.asin(wv*Math.sin(s)),m=c*c,f=m*m*m;return{x:.5*(n*Math.cos(c)/(wv*(u_+3*c_*m+f*(7*h_+9*f_*m)))/Math.PI+.5),y:1-.5*(c*(u_+c_*m+f*(h_+f_*m))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,m=c*c,f=m*m*m;for(let w,C,R,P=0;P<12&&(C=c*(u_+c_*m+f*(h_+f_*m))-s,R=u_+3*c_*m+f*(7*h_+9*f_*m),w=C/R,c=lr(c-w,-Math.PI/3,Math.PI/3),m=c*c,f=m*m*m,!(Math.abs(w)<1e-12));++P);const g=wv*n*(u_+3*c_*m+f*(7*h_+9*f_*m))/Math.cos(c),E=Math.asin(Math.sin(c)/wv),O=lr(180*g/Math.PI,-180,180),D=lr(180*E/Math.PI,-He,He);return new q(O,D)}}class C8 extends Dd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const c=360*(n-.5),m=lr(360*(.5-s),-He,He);return new q(c,m)}}const Cm=Math.PI/2;function Sv(u){return Math.tan((Cm+u)/2)}class O8 extends Dd{constructor(n){super(n),this.center=n.center||[0,30];const[s,c]=this.parallels=n.parallels||[30,30];let m=sr(s),f=sr(c);this.southernCenter=m+f<0,this.southernCenter&&(m=-m,f=-f);const g=Math.cos(m),E=Sv(m);this.n=m===f?Math.sin(m):Math.log(g/Math.cos(f))/Math.log(Sv(f)/E),this.f=g*Math.pow(Sv(m),this.n)/this.n}project(n,s){s=sr(s),this.southernCenter&&(s=-s),n=sr(n-this.center[0]);const c=1e-6,{n:m,f}=this;f>0?s<-Cm+c&&(s=-Cm+c):s>Cm-c&&(s=Cm-c);const g=f/Math.pow(Sv(s),m);let E=g*Math.sin(m*n),O=f-g*Math.cos(m*n);return E=.5*(E/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:E,y:this.southernCenter?O:1-O,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f:m}=this,f=m-s,g=Math.sign(f),E=Math.sign(c)*Math.sqrt(n*n+f*f);let O=Math.atan2(n,Math.abs(f))*g;f*c<0&&(O-=Math.PI*Math.sign(n)*g);const D=lr(_i(O/c)+this.center[0],-180,180),w=lr(_i(2*Math.atan(Math.pow(m/E,1/c))-Cm),-He,He);return new q(D,this.southernCenter?-w:w)}}class ZC extends Dd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:_e(n),y:Te(s),z:0}}unproject(n,s){const c=ze(n),m=Ue(s);return new q(c,m)}}const XC=sr(He);class k8 extends Dd{project(n,s){const c=(s=sr(s))*s,m=c*c;return{x:.5*((n=sr(n))*(.8707-.131979*c+m*(m*(.003971*c-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+m*(.028874*c-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,m=25,f=0,g=c*c;do{g=c*c;const D=g*g;f=(c*(1.007226+g*(.015085+D*(.028874*g-.044475-.005916*D)))-s)/(1.007226+g*(.045255+D*(.259866*g-.311325-.005916*11*D))),c=lr(c-f,-XC,XC)}while(Math.abs(f)>1e-6&&--m>0);g=c*c;const E=lr(_i(n/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),O=_i(c);return new q(E,O)}}const KC=sr(He);class R8 extends Dd{project(n,s){s=sr(s),n=sr(n);const c=Math.cos(s),m=2/Math.PI,f=Math.acos(c*Math.cos(n/2)),g=Math.sin(f)/f,E=.5*(n*m+2*c*Math.sin(n/2)/g)||0,O=.5*(s+Math.sin(s)/g)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(n,s){let c=n=(2*n-.5)*Math.PI,m=s=(2*(1-s)-1)*Math.PI,f=25;const g=1e-6;let E=0,O=0;do{const D=Math.cos(m),w=Math.sin(m),C=2*w*D,R=w*w,P=D*D,k=Math.cos(c/2),N=Math.sin(c/2),W=2*k*N,X=N*N,ee=1-P*k*k,ne=ee?1/ee:0,J=ee?Math.acos(D*k)*Math.sqrt(1/ee):0,he=.5*(2*J*D*N+2*c/Math.PI)-n,ye=.5*(J*w+m)-s,Me=.5*ne*(P*X+J*D*k*R)+1/Math.PI,Ve=ne*(W*C/4-J*w*N),Ne=.125*ne*(C*N-J*w*P*W),$e=.5*ne*(R*k+J*X*D)+.5,ot=Ve*Ne-$e*Me;E=(ye*Ve-he*$e)/ot,O=(he*Ne-ye*Me)/ot,c=lr(c-E,-Math.PI,Math.PI),m=lr(m-O,-KC,KC)}while((Math.abs(E)>g||Math.abs(O)>g)&&--f>0);return new q(_i(c),_i(m))}}class YC extends Dd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(sr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:c,cosPhi:m}=this;return{x:sr(n)*m*c+.5,y:-Math.sin(sr(s))/m*c+.5,z:0}}unproject(n,s){const{scale:c,cosPhi:m}=this,f=-(s-.5)/c,g=lr(_i((n-.5)/c)/m,-180,180),E=Math.asin(lr(f*m,-1,1)),O=lr(_i(E),-He,He);return new q(g,O)}}class L8 extends ZC{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,c){const m=Id(n,s,c),f=$f(qs(c));return Ke.vec3.transformMat4(m,m,f),{x:m[0],y:m[1],z:m[2]}}locationPoint(n,s){const c=F(s.lat,s.lng),m=Ke.vec3.normalize([],c),f=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,g=we(1,0)*En*f;Ke.vec3.scaleAndAdd(c,c,m,g);const E=Ke.mat4.identity(new Float64Array(16));return Ke.mat4.multiply(E,n.pixelMatrix,n.globeMatrix),Ke.vec3.transformMat4(c,c,E),new Yt(c[0],c[1])}pixelsPerMeter(n,s){return we(1,0)*s}pixelSpaceConversion(n,s,c){const m=we(1,n)*s,f=Yn(we(1,45)*s,m,c);return this.pixelsPerMeter(n,s)/f}createTileMatrix(n,s,c){const m=Ug(qs(c.canonical));return Ke.mat4.multiply(new Float64Array(16),n.globeMatrix,m)}createInversionMatrix(n,s){const{center:c}=n,m=$f(qs(s));return Ke.mat4.rotateY(m,m,sr(c.lng)),Ke.mat4.rotateX(m,m,sr(c.lat)),Ke.mat4.scale(m,m,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(n,s,c,m){return kc(n,s,c,!0)||new ft(0,0)}pointCoordinate3D(n,s,c){const m=this.pointCoordinate(n,s,c,0);return[m.x,m.y,m.z]}isPointAboveHorizon(n,s){return!kc(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(m,f){const g=m.cameraToCenterDistance,E=m._centerAltitude*f,O=m._camera,D=m._camera.forward(),w=Ke.vec3.add([],Ke.vec3.scale([],D,-g),[0,0,E]),C=m.worldSize/(2*Math.PI),R=[0,0,-C],P=m.width/m.height,k=Math.tan(m.fovAboveCenter),N=Ke.vec3.scale([],O.up(),k),W=Ke.vec3.scale([],O.right(),k*P),X=Ke.vec3.normalize([],Ke.vec3.add([],Ke.vec3.add([],D,N),W)),ee=[];let ne;if(new ys(w,X).closestPointOnSphere(R,C,ee)){const J=Ke.vec3.add([],ee,R),he=Ke.vec3.sub([],J,w);ne=Math.cos(m.fovAboveCenter)*Ke.vec3.length(he)}else{const J=Ke.vec3.sub([],w,R),he=Ke.vec3.sub([],R,w);Ke.vec3.normalize(he,he);const ye=Ke.vec3.length(J)-C;ne=Math.sqrt(ye*(ye+2*C));const Me=Math.acos(ne/(C+ye))-Math.acos(Ke.vec3.dot(D,he));ne*=Math.cos(Me)}return 1.01*ne}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),c=Ll(n.zoom);if(c>0){const m=HC(n,we(1,n.center.lat)*n.worldSize),f=n.worldSize/(2*Math.PI),g=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Yn(s,m+f*(1-Math.cos(g)),Math.pow(c,10))}return s}upVector(n,s,c){return Id(s,c,n,1)}upVectorScale(n){return{metersToTile:Qa(mp(qs(n)))}}}function JC(u){const n=u.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(u.name){case"mercator":return new ZC(u);case"equirectangular":return new C8(u);case"naturalEarth":return new k8(u);case"equalEarth":return new I8(u);case"winkelTripel":return new R8(u);case"albers":return s?new YC(u):new M8(u);case"lambertConformalConic":return s?new YC(u):new O8(u);case"globe":return new L8(u)}throw new Error(`Invalid projection name: ${u.name}`)}const D8=Em.VectorTileFeature.types,z8=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Tv(u,n,s,c,m,f,g,E,O,D,w,C,R){const P=E?Math.min(Ld,Math.round(E[0])):0,k=E?Math.min(Ld,Math.round(E[1])):0;u.emplaceBack(n,s,Math.round(32*c),Math.round(32*m),f,g,(P<<1)+(O?1:0),k,16*D,16*w,256*C,256*R)}function Ev(u,n,s){u.emplaceBack(n,s)}function Av(u,n,s,c,m,f,g){u.emplaceBack(n,s,c,m,f,g)}function Pv(u,n,s,c,m){u.emplaceBack(n,s,c,m),u.emplaceBack(n,s,c,m),u.emplaceBack(n,s,c,m),u.emplaceBack(n,s,c,m)}function F8(u){for(const n of u.sections)if(lm(n.text))return!0;return!1}class F1{constructor(n){this.layoutVertexArray=new Ec,this.indexArray=new po,this.programConfigurations=n,this.segments=new $o,this.dynamicLayoutVertexArray=new Il,this.opacityVertexArray=new Cf,this.placedSymbolArray=new Df,this.iconTransitioningVertexArray=new gs,this.globeExtVertexArray=new If,this.zOffsetVertexArray=new _h}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,c,m,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,e8.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,n8.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,z8,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,i8.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,t8.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||f)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,r8.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||m)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}kn(F1,"SymbolBuffers");class B1{constructor(n,s,c){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new c,this.segments=new $o,this.collisionVertexArray=new Mc,this.collisionVertexArrayExt=new Il}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,o8.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,a8.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}kn(B1,"CollisionBuffers");class Mv{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ke.mat4.identity([]),this.placementViewportMatrix=Ke.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=A1(this.zoom,s["text-size"]),this.iconSizeData=A1(this.zoom,s["icon-size"]);const c=this.layers[0].layout,m=c.get("symbol-sort-key"),f=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(g=>Ju[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new F1(new Rl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new F1(new Rl(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new lp,this.lineVertexArray=new xd,this.symbolInstances=new vd}calculateGlyphDependencies(n,s,c,m,f){for(const g of n){const E=g.codePointAt(0);if(E===void 0)break;if(s[E]=!0,m&&f&&E<=65535){const O=r_[g];O&&(s[O.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!v1(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}populate(n,s,c,m){const f=this.layers[0],g=f.layout,E=this.projection.name==="globe",O=g.get("text-font"),D=g.get("text-field"),w=g.get("icon-image"),C=(D.value.kind!=="constant"||D.value.value instanceof ro&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),R=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,P=g.get("symbol-sort-key");if(this.features=[],!C&&!R)return;const k=s.iconDependencies,N=s.glyphDependencies,W=s.availableImages,X=new Po(this.zoom);for(const{feature:ee,id:ne,index:J,sourceLayerIndex:he}of n){const ye=f._featureFilter.needGeometry,Me=Qt(ee,ye);if(!f._featureFilter.filter(X,Me,c))continue;if(ye||(Me.geometry=yt(ee,c,m)),E&&ee.type!==1&&c.z<=5){const ot=Me.geometry,je=.98078528056,nt=(ct,ht)=>{const _t=Id(ct.x,ct.y,c,1),At=Id(ht.x,ht.y,c,1);return Ke.vec3.dot(_t,At)<je};for(let ct=0;ct<ot.length;ct++)ot[ct]=$t(ot[ct],nt)}let Ve,Ne;if(C){const ot=f.getValueAndResolveTokens("text-field",Me,c,W),je=ro.factory(ot);F8(je)&&(this.hasRTLText=!0),(!this.hasRTLText||fh()==="unavailable"||this.hasRTLText&&il.isParsed())&&(Ve=u8(je,f,Me))}if(R){const ot=f.getValueAndResolveTokens("icon-image",Me,c,W);Ne=ot instanceof No?ot:No.fromString(ot)}if(!Ve&&!Ne)continue;const $e=this.sortFeaturesByKey?P.evaluate(Me,{},c):void 0;if(this.features.push({id:ne,text:Ve,icon:Ne,index:J,sourceLayerIndex:he,geometry:Me.geometry,properties:ee.properties,type:D8[ee.type],sortKey:$e}),Ne&&(k[Ne.namePrimary]=!0,Ne.nameSecondary&&(k[Ne.nameSecondary]=!0)),Ve){const ot=O.evaluate(Me,{},c).join(","),je=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ju.vertical)>=0;for(const nt of Ve.sections)if(nt.image)k[nt.image.namePrimary]=!0;else{const ct=ud(Ve.toString()),ht=nt.fontStack||ot,_t=N[ht]=N[ht]||{};this.calculateGlyphDependencies(nt.text,_t,je,this.allowVerticalPlacement,ct)}}}g.get("symbol-placement")==="line"&&(this.features=function(ee){const ne={},J={},he=[];let ye=0;function Me(ot){he.push(ee[ot]),ye++}function Ve(ot,je,nt){const ct=J[ot];return delete J[ot],J[je]=ct,he[ct].geometry[0].pop(),he[ct].geometry[0]=he[ct].geometry[0].concat(nt[0]),ct}function Ne(ot,je,nt){const ct=ne[je];return delete ne[je],ne[ot]=ct,he[ct].geometry[0].shift(),he[ct].geometry[0]=nt[0].concat(he[ct].geometry[0]),ct}function $e(ot,je,nt){const ct=nt?je[0][je[0].length-1]:je[0][0];return`${ot}:${ct.x}:${ct.y}`}for(let ot=0;ot<ee.length;ot++){const je=ee[ot],nt=je.geometry,ct=je.text?je.text.toString():null;if(!ct){Me(ot);continue}const ht=$e(ct,nt),_t=$e(ct,nt,!0);if(ht in J&&_t in ne&&J[ht]!==ne[_t]){const At=Ne(ht,_t,nt),It=Ve(ht,_t,he[At].geometry);delete ne[ht],delete J[_t],J[$e(ct,he[It].geometry,!0)]=It,he[At].geometry=null}else ht in J?Ve(ht,_t,nt):_t in ne?Ne(ht,_t,nt):(Me(ot),ne[ht]=ye-1,J[_t]=ye-1)}return he.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ee,ne)=>ee.sortKey-ne.sortKey)}update(n,s,c,m,f){const g=Object.keys(n).length!==0;if(g&&!this.stateDependentLayers.length)return;const E=g?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(n,s,E,c,m,f),this.icon.programConfigurations.updatePaintArrays(n,s,E,c,m,f)}updateZOffset(){const n=(f,g,E)=>{c+=g,c>f.length&&f.resize(c);for(let O=-g;O<0;O++)f.emplace(O+c,E)},s=(f,g,E)=>{m+=g,m>f.length&&f.resize(m);for(let O=-g;O<0;O++)f.emplace(O+m,E)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,m=0;for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f),{numHorizontalGlyphVertices:E,numVerticalGlyphVertices:O,numIconVertices:D}=g,w=g.zOffset,C=D>0;if((E>0||O>0)&&(n(this.text.zOffsetVertexArray,E,w),n(this.text.zOffsetVertexArray,O,w)),C){const{placedIconSymbolIndex:R,verticalPlacedIconSymbolIndex:P}=g;R>=0&&s(this.icon.zOffsetVertexArray,D,w),P>=0&&s(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=JC(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const c=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:m,y:f}of s)this.lineVertexArray.emplaceBack(m,f);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,s,c,m,f,g,E,O,D,w,C,R,P,k,N,W){const X=n.indexArray,ee=n.layoutVertexArray,ne=n.globeExtVertexArray,J=n.segments.prepareSegment(4*s.length,ee,X,this.canOverlap?g.sortKey:void 0),he=this.glyphOffsetArray.length,ye=J.vertexLength,Me=this.allowVerticalPlacement&&E===Ju.vertical?Math.PI/2:0,Ve=g.text&&g.text.sections;for(let $e=0;$e<s.length;$e++){const{tl:ot,tr:je,bl:nt,br:ct,texPrimary:ht,texSecondary:_t,pixelOffsetTL:At,pixelOffsetBR:It,minFontScaleX:wt,minFontScaleY:Xt,glyphOffset:pn,isSDF:Ut,sectionIndex:Fn}=s[$e],An=J.vertexLength,xn=pn[1];if(Tv(ee,D.x,D.y,ot.x,xn+ot.y,ht.x,ht.y,c,Ut,At.x,At.y,wt,Xt),Tv(ee,D.x,D.y,je.x,xn+je.y,ht.x+ht.w,ht.y,c,Ut,It.x,At.y,wt,Xt),Tv(ee,D.x,D.y,nt.x,xn+nt.y,ht.x,ht.y+ht.h,c,Ut,At.x,It.y,wt,Xt),Tv(ee,D.x,D.y,ct.x,xn+ct.y,ht.x+ht.w,ht.y+ht.h,c,Ut,It.x,It.y,wt,Xt),O){const{x:cn,y:ur,z:zn}=O.anchor,[qn,Lr,Xr]=O.up;Av(ne,cn,ur,zn,qn,Lr,Xr),Av(ne,cn,ur,zn,qn,Lr,Xr),Av(ne,cn,ur,zn,qn,Lr,Xr),Av(ne,cn,ur,zn,qn,Lr,Xr),Pv(n.dynamicLayoutVertexArray,cn,ur,zn,Me)}else Pv(n.dynamicLayoutVertexArray,D.x,D.y,D.z,Me);if(W){const cn=_t||ht;Ev(n.iconTransitioningVertexArray,cn.x,cn.y),Ev(n.iconTransitioningVertexArray,cn.x+cn.w,cn.y),Ev(n.iconTransitioningVertexArray,cn.x,cn.y+cn.h),Ev(n.iconTransitioningVertexArray,cn.x+cn.w,cn.y+cn.h)}X.emplaceBack(An,An+1,An+2),X.emplaceBack(An+1,An+2,An+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pn[0]),$e!==s.length-1&&Fn===s[$e+1].sectionIndex||n.programConfigurations.populatePaintArrays(ee.length,g,g.index,{},P,k,N,Ve&&Ve[Fn])}const Ne=O?O.anchor:D;n.placedSymbolArray.emplaceBack(Ne.x,Ne.y,Ne.z,D.x,D.y,he,this.glyphOffsetArray.length-he,ye,w,C,D.segment,c?c[0]:0,c?c[1]:0,m[0],m[1],E,0,!1,0,R,0)}_commitLayoutVertex(n,s,c,m,f,g,E){n.emplaceBack(s,c,m,f,g,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,s,c,m,f,g,E){const O=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),D=O.vertexLength,w=E.tileAnchorX,C=E.tileAnchorY;for(let P=0;P<4;P++)c.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,s,n.padding,E.zOffset),this._commitLayoutVertex(c.layoutVertexArray,m,f,g,w,C,new Yt(n.x1,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,m,f,g,w,C,new Yt(n.x2,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,m,f,g,w,C,new Yt(n.x2,n.y2)),this._commitLayoutVertex(c.layoutVertexArray,m,f,g,w,C,new Yt(n.x1,n.y2)),O.vertexLength+=4;const R=c.indexArray;R.emplaceBack(D,D+1),R.emplaceBack(D+1,D+2),R.emplaceBack(D+2,D+3),R.emplaceBack(D+3,D),O.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,c,m,f,g){for(let E=m;E<f;E++){const O=c.get(E),D=this.getSymbolInstanceTextSize(n,g,s,E);this._addCollisionDebugVertices(O,D,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(n,s,c,m,f,g){for(let E=m;E<f;E++){const O=c.get(E),D=this.getSymbolInstanceIconSize(n,s,g.placedIconSymbolIndex);this._addCollisionDebugVertices(O,D,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,g)}}generateCollisionDebugBuffers(n,s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new B1(Ac,xC.members,gs),this.iconCollisionBox=new B1(Ac,xC.members,gs);const m=Am(this.iconSizeData,n),f=Am(this.textSizeData,n,c);for(let g=0;g<this.symbolInstances.length;g++){const E=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(f,n,s,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(f,n,s,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(m,n,s,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(m,n,s,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(n,s,c,m){const f=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:m),g=mv(this.textSizeData,n,f)/Gs;return this.tilePixelRatio*g}getSymbolInstanceIconSize(n,s,c){const m=this.icon.placedSymbolArray.get(c),f=mv(this.iconSizeData,n,m);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(n,s,c,m){n.emplaceBack(s,-c,-c,m),n.emplaceBack(s,c,-c,m),n.emplaceBack(s,c,c,m),n.emplaceBack(s,-c,c,m)}_updateTextDebugCollisionBoxes(n,s,c,m,f,g,E){for(let O=m;O<f;O++){const D=c.get(O),w=this.getSymbolInstanceTextSize(n,g,s,O);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,D.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(n,s,c,m,f,g,E){for(let O=m;O<f;O++){const D=c.get(O),w=this.getSymbolInstanceIconSize(n,s,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,D.padding,g.zOffset)}}updateCollisionDebugBuffers(n,s,c,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=Am(this.iconSizeData,n,m),g=Am(this.textSizeData,n,c);for(let E=0;E<this.symbolInstances.length;E++){const O=this.symbolInstances.get(E);this._updateTextDebugCollisionBoxes(g,n,s,O.textBoxStartIndex,O.textBoxEndIndex,O,c),this._updateTextDebugCollisionBoxes(g,n,s,O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,c),this._updateIconDebugCollisionBoxes(f,n,s,O.iconBoxStartIndex,O.iconBoxEndIndex,O,m),this._updateIconDebugCollisionBoxes(f,n,s,O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,c,m,f,g,E,O,D){const w={};if(s<c){const{x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J,featureIndex:he}=n.get(s);w.textBox={x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J},w.textFeatureIndex=he}if(m<f){const{x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J,featureIndex:he}=n.get(m);w.verticalTextBox={x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J},w.verticalTextFeatureIndex=he}if(g<E){const{x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J,featureIndex:he}=n.get(g);w.iconBox={x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J},w.iconFeatureIndex=he}if(O<D){const{x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J,featureIndex:he}=n.get(O);w.verticalIconBox={x1:C,y1:R,x2:P,y2:k,padding:N,projectedAnchorX:W,projectedAnchorY:X,projectedAnchorZ:ee,tileAnchorX:ne,tileAnchorY:J},w.verticalIconFeatureIndex=he}return w}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const c=n.placedSymbolArray.get(s),m=c.vertexStartIndex+4*c.numGlyphs;for(let f=c.vertexStartIndex;f<m;f+=4)n.indexArray.emplaceBack(f,f+1,f+2),n.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),c=Math.cos(n),m=[],f=[],g=[];for(let E=0;E<this.symbolInstances.length;++E){g.push(E);const O=this.symbolInstances.get(E);m.push(0|Math.round(s*O.tileAnchorX+c*O.tileAnchorY)),f.push(O.featureIndex)}return g.sort((E,O)=>m[E]-m[O]||f[O]-f[E]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:D}=c;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),f>=0&&f!==m&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&g!==m&&this.addIndicesForPlacedSymbol(this.text,g),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let QC,eO,N1;kn(Mv,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Mv.addDynamicAttributes=Pv;class tO{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:ss,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kn(tO,"FormatSectionOverride",{omit:["defaultValue"]});const j1=()=>N1||(N1={layout:QC||(QC=new Ni({"symbol-placement":new vn(Et.layout_symbol["symbol-placement"]),"symbol-spacing":new vn(Et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vn(Et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new tr(Et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vn(Et.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new vn(Et.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new vn(Et.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new vn(Et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new vn(Et.layout_symbol["icon-ignore-placement"]),"icon-optional":new vn(Et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vn(Et.layout_symbol["icon-rotation-alignment"]),"icon-size":new tr(Et.layout_symbol["icon-size"]),"icon-size-scale-range":new vn(Et.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new tr(Et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tr(Et.layout_symbol["icon-text-fit-padding"]),"icon-image":new tr(Et.layout_symbol["icon-image"]),"icon-rotate":new tr(Et.layout_symbol["icon-rotate"]),"icon-padding":new vn(Et.layout_symbol["icon-padding"]),"icon-keep-upright":new vn(Et.layout_symbol["icon-keep-upright"]),"icon-offset":new tr(Et.layout_symbol["icon-offset"]),"icon-anchor":new tr(Et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vn(Et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vn(Et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vn(Et.layout_symbol["text-rotation-alignment"]),"text-field":new tr(Et.layout_symbol["text-field"]),"text-font":new tr(Et.layout_symbol["text-font"]),"text-size":new tr(Et.layout_symbol["text-size"]),"text-size-scale-range":new vn(Et.layout_symbol["text-size-scale-range"]),"text-max-width":new tr(Et.layout_symbol["text-max-width"]),"text-line-height":new tr(Et.layout_symbol["text-line-height"]),"text-letter-spacing":new tr(Et.layout_symbol["text-letter-spacing"]),"text-justify":new tr(Et.layout_symbol["text-justify"]),"text-radial-offset":new tr(Et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vn(Et.layout_symbol["text-variable-anchor"]),"text-anchor":new tr(Et.layout_symbol["text-anchor"]),"text-max-angle":new vn(Et.layout_symbol["text-max-angle"]),"text-writing-mode":new vn(Et.layout_symbol["text-writing-mode"]),"text-rotate":new tr(Et.layout_symbol["text-rotate"]),"text-padding":new vn(Et.layout_symbol["text-padding"]),"text-keep-upright":new vn(Et.layout_symbol["text-keep-upright"]),"text-transform":new tr(Et.layout_symbol["text-transform"]),"text-offset":new tr(Et.layout_symbol["text-offset"]),"text-allow-overlap":new vn(Et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new vn(Et.layout_symbol["text-ignore-placement"]),"text-optional":new vn(Et.layout_symbol["text-optional"]),visibility:new vn(Et.layout_symbol.visibility)})),paint:eO||(eO=new Ni({"icon-opacity":new tr(Et.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new tr(Et.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new tr(Et.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new tr(Et.paint_symbol["text-emissive-strength"]),"icon-color":new tr(Et.paint_symbol["icon-color"]),"icon-halo-color":new tr(Et.paint_symbol["icon-halo-color"]),"icon-halo-width":new tr(Et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new tr(Et.paint_symbol["icon-halo-blur"]),"icon-translate":new vn(Et.paint_symbol["icon-translate"]),"icon-translate-anchor":new vn(Et.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new tr(Et.paint_symbol["icon-image-cross-fade"]),"text-opacity":new tr(Et.paint_symbol["text-opacity"]),"text-occlusion-opacity":new tr(Et.paint_symbol["text-occlusion-opacity"]),"text-color":new tr(Et.paint_symbol["text-color"],{runtimeType:Eo,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new tr(Et.paint_symbol["text-halo-color"]),"text-halo-width":new tr(Et.paint_symbol["text-halo-width"]),"text-halo-blur":new tr(Et.paint_symbol["text-halo-blur"]),"text-translate":new vn(Et.paint_symbol["text-translate"]),"text-translate-anchor":new vn(Et.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new vn(Et.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new vn(Et.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new vn(Et.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new vn(Et.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new tr(Et.paint_symbol["symbol-z-offset"])}))},N1);class Iv extends ms{constructor(n,s,c,m){super(n,j1(),s,c,m),this._colorAdjustmentMatrix=Ke.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const m=[];for(const f of c)m.indexOf(f)<0&&m.push(f);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,c,m){return this._saturation===n&&this._contrast===s&&this._brightnessMin===c&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(f,g,E,O){f=Z(f),g=Se(g);const D=Ke.mat4.create(),w=f/3,C=1-2*w,R=[C,w,w,0,w,C,w,0,w,w,C,0,0,0,0,1],P=.5-.5*g,k=O-E;return Ke.mat4.multiply(D,[k,0,0,0,0,k,0,0,0,0,k,0,E,E,E,1],[g,0,0,0,0,g,0,0,0,0,g,0,P,P,P,1]),Ke.mat4.multiply(D,D,R),D}(n,s,c,m),this._saturation=n,this._contrast=s,this._brightnessMin=c,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,c,m){const f=this.layout.get(n).evaluate(s,{},c,m),g=this._unevaluatedLayout._values[n];return g.isDataDriven()||ah(g.value)||!f?f:function(E,O){return O.replace(/{([^{}]+)}/g,(D,w)=>w in E?String(E[w]):"")}(s.properties,f)}createBucket(n){return new Mv(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of j1().paint.overridableProperties){if(!Iv.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),c=new tO(s),m=new sd(c,s.property.specification,this.scope,this.options);let f=null;f=s.value.kind==="constant"||s.value.kind==="source"?new Al("source",m):new yc("composite",m,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new bc(s.property,f,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&Iv.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const c=n.get("text-field"),m=j1().paint.properties[s];let f=!1;const g=E=>{for(const O of E)if(m.overrides&&m.overrides.hasOverride(O))return void(f=!0)};if(c.value.kind==="constant"&&c.value.value instanceof ro)g(c.value.value.sections);else if(c.value.kind==="source"){const E=D=>{f||(D instanceof yo&&io(D.value)===ua?g(D.value.sections):D instanceof bl?g(D.sections):D.eachChild(E))},O=c.value;O._styleExpression&&E(O._styleExpression.expression)}return f}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,c){return{config:new Eu(this,{zoom:s,lut:c}),overrideFog:!1}}}let nO,rO,iO,oO;var $1=Ti([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function U1(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function V1(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class q1{constructor(n,s,c,m){this.context=n,this.format=c,this.useMipmap=m&&m.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:m&&m.premultiply})}update(n,s){const c=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,m=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:f}=this,{gl:g}=f,{x:E,y:O}=s&&s.position?s.position:{x:0,y:0},D=Math.max(E+c,this.size?this.size[0]:0),w=Math.max(O+m,this.size?this.size[1]:0);!this.size||this.size[0]===D&&this.size[1]===w||(g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(this.texture),this.texture=g.createTexture(),this.size=null),g.bindTexture(g.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA8&&(!s||s.premultiply!==!1));const C=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&D>0&&w>0){const R=this.useMipmap?Math.floor(Math.log2(Math.max(D,w)))+1:1;g.texStorage2D(g.TEXTURE_2D,R,this.format,D,w),this.size=[D,w]}if(this.size)if(C)g.texSubImage2D(g.TEXTURE_2D,0,E,O,U1(this.format),V1(this.format),n);else{const R=n.data;R&&g.texSubImage2D(g.TEXTURE_2D,0,E,O,c,m,U1(this.format),V1(this.format),R)}this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(n,s,c=!1){const{context:m}=this,{gl:f}=m;f.bindTexture(f.TEXTURE_2D,this.texture),n!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap&&!c?n===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,c,m){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),s!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?n===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),c!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,c),this.wrapS=c),m!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class Cv{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:c}=this,{gl:m}=c;m.bindTexture(m.TEXTURE_2D,this.texture),n!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrapS=s)}}function Ov(u,n,s,c,m,f,g,E){const O=[u,n,1,s,c,1,m,f,1],D=[g,E,1],w=Ke.mat3.adjoint([],O),[C,R,P]=Ke.vec3.transformMat3(D,D,w);return Ke.mat3.multiply(O,O,[C,0,0,0,R,0,0,0,P])}function aO(u,n,s,c,m,f,g,E){const O=function(D,w,C,R,P,k,N,W){const X=Ov(0,0,1,0,1,1,0,1),ee=Ov(D,w,C,R,P,k,N,W),ne=Ke.mat3.adjoint([],X);return Ke.mat3.multiply(ee,ee,ne)}(u,n,s,c,m,f,g,E);return[O[2]/O[8]/En,O[5]/O[8]/En]}function kv(u){return[u[0],Math.min(Math.max(u[1],-He),He)]}class sO extends So{constructor(n,s,c,m){super(),this.id=n,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new Gn("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=wi(this.map._requestManager.transformRequest(this.url,ci.Image),(c,m)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new Cr(c)):m&&(this.image=m instanceof HTMLImageElement?Wt.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Cv(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Gn("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Cv||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],c=n[0][1];for(const f of n)f[1]>c&&(c=f[1]),f[1]<s&&(s=f[1]);const m=(c+s)/2;if(m>He?this.onNorthPole=!0:m<-He&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const f=n.map(ft.fromLngLat);this.tileID=function(g){let E=1/0,O=1/0,D=-1/0,w=-1/0;for(const N of g)E=Math.min(E,N.x),O=Math.min(O,N.y),D=Math.max(D,N.x),w=Math.max(w,N.y);const C=Math.max(D-E,w-O),R=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),P=Math.pow(2,R);let k=Math.floor((E+D)/2*P);return k>1&&(k-=1),new Qi(R,k,Math.floor((O+w)/2*P))}(f),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Gn("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const X in this.tiles){const ee=this.tiles[X];ee.state!=="loaded"&&(ee.state="loaded",ee.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=l_(new Qi(0,0,0),this.map.transform.projection),c=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(X){const ee=X[1].x-X[0].x,ne=X[1].y-X[0].y,J=X[2].x-X[1].x,he=X[2].y-X[1].y,ye=X[3].x-X[2].x,Me=X[3].y-X[2].y,Ve=X[0].x-X[3].x,Ne=X[0].y-X[3].y,$e=ee*he-J*ne,ot=J*Me-ye*he,je=ye*Ne-Ve*Me,nt=Ve*ne-ee*Ne;return $e>0&&ot>0&&je>0&&nt>0||$e<0&&ot<0&&je<0&&nt<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=l_(this.tileID,this.map.transform.projection),[f,g,E,O]=this.coordinates.map(X=>{const ee=m.projection.project(X[0],X[1]);return WC(m,ee)._round()});this.perspectiveTransform=aO(f.x,f.y,g.x,g.y,E.x,E.y,O.x,O.y);const D=this._boundsArray=new Oo;D.emplaceBack(f.x,f.y,0,0),D.emplaceBack(g.x,g.y,En,0),D.emplaceBack(O.x,O.y,0,En),D.emplaceBack(E.x,E.y,En,En),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(D,$1.members),this.boundsSegments=$o.simpleSegment(0,0,4,2);const w=[],C=[kv((R=this.coordinates)[0]),kv(R[1]),kv(R[2]),kv(R[3])];var R;const[P,k,N,W]=function(X){let ee=X[0][0],ne=ee,J=X[0][1],he=J;for(let ye=1;ye<X.length;ye++)X[ye][0]<ee?ee=X[ye][0]:X[ye][0]>ne&&(ne=X[ye][0]),X[ye][1]<J?J=X[ye][1]:X[ye][1]>he&&(he=X[ye][1]);return[ee,J,ne-ee,he-J]}(C);{const X=new Oo,[ee,ne,J,he]=function(At){let It=At[0].x,wt=It,Xt=At[0].y,pn=Xt;for(let Ut=1;Ut<At.length;Ut++)At[Ut].x<It?It=At[Ut].x:At[Ut].x>wt&&(wt=At[Ut].x),At[Ut].y<Xt?Xt=At[Ut].y:At[Ut].y>pn&&(pn=At[Ut].y);return[It,Xt,wt-It,pn-Xt]}(c),ye=At=>[(At.x-ee)/J,(At.y-ne)/he],[Me,Ve,Ne,$e]=c.map(ye),ot=function(At,It,wt,Xt,pn,Ut,Fn,An){const xn=Ov(0,0,1,0,1,1,0,1),cn=Ov(At,It,wt,Xt,pn,Ut,Fn,An),ur=Ke.mat3.adjoint([],cn);return Ke.mat3.multiply(xn,xn,ur)}(Me[0],Me[1],Ve[0],Ve[1],Ne[0],Ne[1],$e[0],$e[1]);this.elevatedGlobePerspectiveTransform=aO(Me[0],Me[1],Ve[0],Ve[1],Ne[0],Ne[1],$e[0],$e[1]);const je=(At,It)=>{w.push(At.lng);const wt=Math.round((At.lng-P)/N*En),Xt=Math.round((At.lat-k)/W*En),pn=ye(It),Ut=Ke.vec3.transformMat3([],[pn[0],pn[1],1],ot),Fn=Math.round(Ut[0]/Ut[2]*En),An=Math.round(Ut[1]/Ut[2]*En);X.emplaceBack(wt,Xt,Fn,An)},nt=c[3].x-c[0].x,ct=c[3].y-c[0].y,ht=c[2].x-c[1].x,_t=c[2].y-c[1].y;for(let At=0;At<65;At++){const It=At/64,wt=[c[0].x+It*nt,c[0].y+It*ct],Xt=[c[1].x+It*ht,c[1].y+It*_t],pn=Xt[0]-wt[0],Ut=Xt[1]-wt[1];for(let Fn=0;Fn<65;Fn++){const An=Fn/64,xn={x:wt[0]+pn*An,y:wt[1]+Ut*An,z:0};je(s.projection.unproject(xn.x,xn.y),xn)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(X,$1.members)}{this.maxLongitudeTriangleSize=0;let X=[],ee=new po;const ne=(J,he,ye)=>{ee.emplaceBack(J,he,ye);const Me=w[J],Ve=w[he],Ne=w[ye],$e=Math.min(Math.min(Me,Ve),Ne),ot=Math.max(Math.max(Me,Ve),Ne)-$e;ot>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ot),X.push($e+ot/2)};for(let J=0;J<64;J++)for(let he=0;he<64;he++){const ye=65*J+he,Me=ye+1,Ve=ye+65,Ne=Ve+1;ne(ye,Ve,Me),ne(Me,Ve,Ne)}[X,ee]=function(J,he){const ye=Array.from({length:J.length},(Ne,$e)=>$e);ye.sort((Ne,$e)=>J[Ne]-J[$e]);const Me=[],Ve=new po;for(let Ne=0;Ne<ye.length;Ne++){const $e=ye[Ne];Me.push(J[$e]);const ot=3*$e,je=ot+1;Ve.emplaceBack(he.uint16[ot],he.uint16[je],he.uint16[je+1])}return[Me,Ve]}(X,ee),this.elevatedGlobeTrianglesCenterLongitudes=X,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(ee)}this.elevatedGlobeSegments=$o.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,N/En,0,W/En,0,0,k,P,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,c=s.gl;!this._dirty||this.texture instanceof Cv||(this.texture?this.texture.update(this.image):(this.texture=new q1(s,this.image,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let m=(f=n+180)+360*Math.round((c[0]-f)/360);var f;const g=new $o,E=(C,R)=>{g.segments.push({vertexOffset:0,primitiveOffset:C,vertexLength:s.segments[0].vertexLength,primitiveLength:R,sortKey:void 0,vaos:{}})},O=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-m)<=O){const C=kt(c,0,c.length,m+O);return C===c.length||E(C,na(c,C+1,c.length,m+360-O)-C),g}m<c[0]&&(m+=360);const D=na(c,0,c.length,m-O);if(D===c.length)return E(0,c.length),g;E(0,D-0);const w=kt(c,D+1,c.length,m+O);return w!==c.length&&E(w,c.length-w),g}}const B8=(Math.pow(256,2)-1)/16907520;class lO extends ms{constructor(n,s,c,m){super(n,{layout:iO||(iO=new Ni({visibility:new vn(Et.layout_raster.visibility)})),paint:oO||(oO=new Ni({"raster-opacity":new vn(Et.paint_raster["raster-opacity"]),"raster-color":new ps(Et.paint_raster["raster-color"]),"raster-color-mix":new vn(Et.paint_raster["raster-color-mix"]),"raster-color-range":new vn(Et.paint_raster["raster-color-range"]),"raster-hue-rotate":new vn(Et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vn(Et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vn(Et.paint_raster["raster-brightness-max"]),"raster-saturation":new vn(Et.paint_raster["raster-saturation"]),"raster-contrast":new vn(Et.paint_raster["raster-contrast"]),"raster-resampling":new vn(Et.paint_raster["raster-resampling"]),"raster-fade-duration":new vn(Et.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new vn(Et.paint_raster["raster-emissive-strength"]),"raster-array-band":new vn(Et.paint_raster["raster-array-band"]),"raster-elevation":new vn(Et.paint_raster["raster-elevation"])}))},s,c,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof sO&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[c,m]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(m)||c===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=Cd({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,m])}}let uO,cO,hO,fO,dO;class pO extends ms{constructor(n,s,c,m){super(n,{layout:uO||(uO=new Ni({visibility:new vn(Et["layout_raster-particle"].visibility)})),paint:cO||(cO=new Ni({"raster-particle-array-band":new vn(Et["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new vn(Et["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ps(Et["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new vn(Et["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new vn(Et["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new vn(Et["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new vn(Et["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new vn(Et["paint_raster-particle"]["raster-particle-elevation"])}))},s,c,m),this._updateColorRamp(),this.lastInvalidatedAt=Wt.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Cd({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Wt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class N8 extends ms{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function G1(u,n,s){const c=[0,0,1],m=Ke.quat.identity([]);return Ke.quat.rotateY(m,m,s?-sr(u)+Math.PI:sr(u)),Ke.quat.rotateX(m,m,-sr(n)),Ke.vec3.transformQuat(c,c,m),Ke.vec3.normalize(c,c)}function mO(u,n){const s=Rv(u.projection,u.zoom,u.width,u.height),c=function(f,g,E,O,D){const w=new q(E.lng-180*zd,E.lat),C=new q(E.lng+180*zd,E.lat),R=f.project(w.lng,w.lat),P=f.project(C.lng,C.lat),k=-Math.atan2(P.y-R.y,P.x-R.x),N=ft.fromLngLat(E);N.y=lr(N.y,-1+zd,1-zd);const W=N.toLngLat(),X=f.project(W.lng,W.lat),ee=ft.fromLngLat(W);ee.x+=zd;const ne=ee.toLngLat(),J=f.project(ne.lng,ne.lat),he=_O(J.x-X.x,J.y-X.y,k),ye=ft.fromLngLat(W);ye.y+=zd;const Me=ye.toLngLat(),Ve=f.project(Me.lng,Me.lat),Ne=_O(Ve.x-X.x,Ve.y-X.y,k),$e=Math.abs(he.x)/Math.abs(Ne.y),ot=Ke.mat4.identity([]);Ke.mat4.rotateZ(ot,ot,-k*(1-(D?0:O)));const je=Ke.mat4.identity([]);return Ke.mat4.scale(je,je,[1,1-(1-$e)*O,1]),je[4]=-Ne.x/Ne.y*O,Ke.mat4.rotateZ(je,je,k),Ke.mat4.multiply(je,ot,je),je}(u.projection,0,u.center,s,n),m=gO(u);return Ke.mat4.scale(c,c,[m,m,1]),c}function gO(u){const n=u.projection,s=Rv(u.projection,u.zoom,u.width,u.height),c=H1(n,u.center),m=H1(n,q.convert(n.center));return Math.pow(2,c*s+(1-s)*m)}function Rv(u,n,s,c,m=1/0){const f=u.range;if(!f)return 0;const g=Math.min(m,Math.max(s,c)),E=Math.log(g/1024)/Math.LN2;return qo(f[0]+E,f[1]+E,n)}const zd=1/4e4;function H1(u,n){const s=lr(n.lat,-He,He),c=new q(n.lng-180*zd,s),m=new q(n.lng+180*zd,s),f=u.project(c.lng,s),g=u.project(m.lng,s),E=ft.fromLngLat(c),O=ft.fromLngLat(m),D=g.x-f.x,w=g.y-f.y,C=O.x-E.x,R=O.y-E.y,P=Math.sqrt((C*C+R*R)/(D*D+w*w));return Math.log(P)/Math.LN2}function _O(u,n,s){const c=Math.cos(s),m=Math.sin(s);return{x:u*c-n*m,y:u*m+n*c}}function yO(u,n,s){Ke.mat4.identity(u),Ke.mat4.rotateZ(u,u,sr(n[2])),Ke.mat4.rotateX(u,u,sr(n[0])),Ke.mat4.rotateY(u,u,sr(n[1])),Ke.mat4.scale(u,u,s),Ke.mat4.multiply(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Lv(u,n,s,c,m,f,g,E){const O=[s[0]-n[0],s[1]-n[1],0],D=[c[0]-n[0],c[1]-n[1],0];if(Ke.vec3.length(O)<1e-12||Ke.vec3.length(D)<1e-12)return Ke.quat.identity(u);const w=Ke.vec3.cross([],O,D);Ke.vec3.normalize(w,w),Ke.vec3.subtract(D,c,n),O[2]=(f-m)*E,D[2]=(g-m)*E;const C=O;return Ke.vec3.cross(C,O,D),Ke.vec3.normalize(C,C),Ke.quat.rotationTo(u,w,C)}function W1(u,n,s=!1){const c=Ll(n.zoom),m=function(f,g,E){const O=g.worldSize,D=[f[12],f[13],f[14]],w=Ue(D[1]/O),C=ze(D[0]/O),R=Ke.mat4.identity([]),P=we(1,w)*O,k=we(1,0)*O*Ze(w,g.zoom),N=1/Vg(O);let W=k*N;if(E){const J=Rv(g.projection,g.zoom,g.width,g.height,1024);W=N*g.projection.pixelSpaceConversion(g.center.lat,O,J)}const X=F(w,C);Ke.vec3.add(X,X,Ke.vec3.scale([],Ke.vec3.normalize([],X),P*W*D[2]));const ee=function(J){const he=[J[0],J[1],J[2]];let ye=[0,1,0];const Me=Ke.vec3.cross([],ye,he);return Ke.vec3.cross(ye,he,Me),Ke.vec3.squaredLength(ye)===0&&(ye=[0,1,0],Ke.vec3.cross(Me,he,ye)),Ke.vec3.normalize(Me,Me),Ke.vec3.normalize(ye,ye),Ke.vec3.normalize(he,he),[Me[0],Me[1],Me[2],0,ye[0],ye[1],ye[2],0,he[0],he[1],he[2],0,J[0],J[1],J[2],1]}(X);Ke.mat4.scale(R,R,[W,W,W*P]),Ke.mat4.translate(R,R,[-D[0],-D[1],-D[2]]);const ne=Ke.mat4.multiply([],g.globeMatrix,ee);return Ke.mat4.multiply(ne,ne,R),Ke.mat4.multiply(ne,ne,f),ne}(u,n,s);if(c>0){const f=function(g,E){const O=E.worldSize,D=we(1,0)*O*Ze(E.center.lat,E.zoom)/Vg(O),w=we(1,E.center.lat)*O,C=Ke.mat4.identity([]);return Ke.mat4.rotateY(C,C,sr(E.center.lng)),Ke.mat4.rotateX(C,C,sr(E.center.lat)),Ke.mat4.translate(C,C,[0,0,Ya]),Ke.mat4.scale(C,C,[D,D,D*w]),Ke.mat4.translate(C,C,[E.point.x-.5*O,E.point.y-.5*O,0]),Ke.mat4.multiply(C,C,g),Ke.mat4.multiply(C,E.globeMatrix,C)}(u,n);return function(g,E,O){const D=(k,N,W)=>{const X=Ke.vec3.length(k),ee=Ke.vec3.length(N),ne=Rc(k,N,W);return Ke.vec3.scale(ne,ne,1/Ke.vec3.length(ne)*Yn(X,ee,W))},w=D([g[0],g[1],g[2]],[E[0],E[1],E[2]],O),C=D([g[4],g[5],g[6]],[E[4],E[5],E[6]],O),R=D([g[8],g[9],g[10]],[E[8],E[9],E[10]],O),P=Rc([g[12],g[13],g[14]],[E[12],E[13],E[14]],O);return[w[0],w[1],w[2],0,C[0],C[1],C[2],0,R[0],R[1],R[2],0,P[0],P[1],P[2],1]}(m,f,c)}return m}function vO(u,n,s,c){const m=pi.projectAabbCorners(c,s);let f=Number.MAX_VALUE,g=-1;for(let D=0;D<m.length;++D){const w=m[D];w[0]=(.5*w[0]+.5)*n.width,w[1]=(.5-.5*w[1])*n.height,w[2]<f&&(g=D,f=w[2])}const E=D=>new Yt(m[D][0],m[D][1]);let O;switch(g){case 0:case 6:O=[E(1),E(5),E(4),E(7),E(3),E(2),E(1)];break;case 1:case 7:O=[E(0),E(4),E(5),E(6),E(2),E(3),E(0)];break;case 3:case 5:O=[E(1),E(0),E(4),E(7),E(6),E(2),E(1)];break;default:O=[E(1),E(5),E(6),E(7),E(3),E(0),E(1)]}if(en(u,O))return f}const j8=Ti([{name:"a_pos_3f",components:3,type:"Float32"}]),$8=Ti([{name:"a_color_3f",components:3,type:"Float32"}]),U8=Ti([{name:"a_color_4f",components:4,type:"Float32"}]),V8=Ti([{name:"a_uv_2f",components:2,type:"Float32"}]),q8=Ti([{name:"a_normal_3f",components:3,type:"Float32"}]),G8=Ti([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),H8=Ti([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),xO={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Dv{constructor(n,s,c,m){this.message=(n?`${n}: `:"")+c,m&&(this.identifier=m),s!=null&&s.__line__&&(this.line=s.__line__)}}function bO(u,n){const s=u.indexOf("://")===-1;try{return new URL(u,s&&n?"http://example.com":void 0),!0}catch{return!1}}class wO{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class SO{constructor(){this.instancedDataArray=new Oc,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Z1{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,c,m){this.tileToMeter=it(c);const f=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:E,index:O,sourceLayerIndex:D}of n){const w=E??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),C=Qt(g,f);if(!this.layers[0]._featureFilter.filter(new Po(this.zoom),C,c))continue;const R={id:w,sourceLayerIndex:D,index:O,geometry:f?C.geometry:yt(g,c,m),properties:g.properties,type:g.type,patterns:{}},P=this.addFeature(R,R.geometry,C);P&&s.featureIndex.insert(g,R.geometry,O,D,this.index,this.instancesPerModel[P].instancedDataArray.length,En/32)}this.lookup=null}update(n,s,c,m){for(const f in this.instancesPerModel){const g=this.instancesPerModel[f];for(const E in n)g.idToFeaturesIndex.hasOwnProperty(E)&&(this.evaluate(g.features[g.idToFeaturesIndex[E]],n[E],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];for(const m of c.features){const f=this.layers[0],g=m.feature,E=this.canonical,O=f.paint.get("model-rotation").evaluate(g,{},E),D=f.paint.get("model-scale").evaluate(g,{},E),w=f.paint.get("model-translation").evaluate(g,{},E);Ke.vec3.exactEquals(m.rotation,O)&&Ke.vec3.exactEquals(m.scale,D)&&Ke.vec3.exactEquals(m.translation,w)||(this.evaluate(m,m.featureStates,c,!0),n=!0)}}return n}updateReplacement(n,s,c,m){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const f=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(v1(this.activeReplacements,f))return!1;this.activeReplacements=f;let g=!1;for(const E in this.instancesPerModel){const O=this.instancesPerModel[E],D=O.instancedDataArray;for(const w of O.features){const C=w.instancedDataOffset,R=w.instancedDataCount;for(let P=0;P<R;P++){const k=16*(P+C);let N=D.float32[k+0];const W=N>En;N=W?N-En:N;const X=Math.floor(N),ee=D.float32[k+1];let ne=!1;for(const J of this.activeReplacements)if(!BI(J,c,xO.Model,m)&&!(J.min.x>X||X>J.max.x||J.min.y>ee||ee>J.max.y)&&(ne=qI(VI(X,ee,n.canonical,J.footprintTileId.canonical),J.footprint),ne))break;D.float32[k]=ne?N+En:N,g=g||ne!==W}}}return g}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=n.createVertexBuffer(c.instancedDataArray,G8.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,c){const m=this.layers[0],f=m.layout.get("model-id").evaluate(c,{},this.canonical);if(!f)return Er(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),f;bO(f,!1)&&(this.modelUris.includes(f)||this.modelUris.push(f)),this.instancesPerModel[f]||(this.instancesPerModel[f]=new SO);const g=this.instancesPerModel[f],E=g.instancedDataArray,O=new wO(c,E.length);for(const D of s)for(const w of D){if(w.x<0||w.x>=En||w.y<0||w.y>=En)continue;const C=(this.lookupDim-1)/En,R=this.lookupDim*(w.y*C|0)+w.x*C|0;if(this.lookup){if(this.lookup[R]!==0)continue;this.lookup[R]=1}this.instanceCount++;const P=E.length;E.resize(P+1),g.instancesEvaluatedElevation.push(0),E.float32[16*P]=w.x,E.float32[16*P+1]=w.y}return O.instancedDataCount=g.instancedDataArray.length-O.instancedDataOffset,O.instancedDataCount>0&&(n.id&&(g.idToFeaturesIndex[n.id]=g.features.length),g.features.push(O),this.evaluate(O,{},g,!1)),f}getModelUris(){return this.modelUris}evaluate(n,s,c,m){const f=this.layers[0],g=n.feature,E=this.canonical,O=n.rotation=f.paint.get("model-rotation").evaluate(g,s,E),D=n.scale=f.paint.get("model-scale").evaluate(g,s,E),w=n.translation=f.paint.get("model-translation").evaluate(g,s,E),C=f.paint.get("model-color").evaluate(g,s,E);C.a=f.paint.get("model-color-mix-intensity").evaluate(g,s,E);const R=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,D[0]),Math.max(D[1],D[2])),yO(R,O,D);const P=Math.round(100*C.a)+C.b/1.05;for(let k=0;k<n.instancedDataCount;++k){const N=n.instancedDataOffset+k,W=16*N,X=c.instancedDataArray.float32;let ee=0;m&&(ee=X[W+6]-c.instancesEvaluatedElevation[N]);const ne=0|X[W+1];X[W]=(0|X[W])+C.r/1.05,X[W+1]=ne+C.g/1.05,X[W+2]=P,X[W+3]=1/(E.z>10?this.tileToMeter:it(E,ne)),X[W+4]=w[0],X[W+5]=w[1],X[W+6]=w[2]+ee,X[W+7]=R[0],X[W+8]=R[1],X[W+9]=R[2],X[W+10]=R[4],X[W+11]=R[5],X[W+12]=R[6],X[W+13]=R[8],X[W+14]=R[9],X[W+15]=R[10],c.instancesEvaluatedElevation[N]=w[2]}}}let TO,EO;kn(Z1,"ModelBucket",{omit:["layers"]}),kn(SO,"PerModelAttributes"),kn(wO,"ModelFeature");const bp=64,Om={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function AO(u,n,s,c,m,f,g,E,O,D=!1){const w=s.zoom,C=s.project(c),R=Ze(c.lat,w),P=1/R;Ke.mat4.identity(u),Ke.mat4.translate(u,u,[C.x+g[0]*P,C.y+g[1]*P,g[2]]);let k=1,N=1;const W=s.worldSize;if(D){if(s.projection.name==="mercator"){let J=0;s.elevation&&(J=s.elevation.getAtPointOrZero(new ft(C.x/W,C.y/W),0));const he=Ke.vec4.transformMat4([],[C.x,C.y,J,1],s.projMatrix)[3]/s.cameraToCenterDistance;k=he,N=he*Ze(s.center.lat,w)}else if(s.projection.name==="globe"){const J=W1(u,s),he=Ke.mat4.multiply([],s.projMatrix,J),ye=[0,0,0,1];Ke.vec4.transformMat4(ye,ye,he);const Me=ye[3]/s.cameraToCenterDistance,Ve=Ll(w),Ne=s.projection.pixelsPerMeter(c.lat,W)*Ze(c.lat,w),$e=s.projection.pixelsPerMeter(s.center.lat,W)*Ze(s.center.lat,w);k=Me/Yn(Ne,Ye(s.center.lat),Ve),N=Me*R/Ne,k*=$e,N*=$e}}else k=P;Ke.mat4.scale(u,u,[k,k,N]);const X=[...u],ee=n.orientation,ne=[];if(yO(ne,[ee[0]+m[0],ee[1]+m[1],ee[2]+m[2]],f),Ke.mat4.multiply(u,X,ne),E&&s.elevation){let J=0;const he=[];if(O&&s.elevation){J=function(Ve,Ne,$e,ot,je){const nt=Ne.elevation;if(!nt)return 0;const ct=pi.projectAabbCorners($e,ot),ht=we(1,je.lat)*Ne.worldSize,_t=function(ur,zn){const qn=[0,0,1],Lr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Xr of Lr){const ei=ur[Xr.corners[0]],Vr=ur[Xr.corners[1]],fi=ur[Xr.corners[2]],ui=[Vr[0]-ei[0],Vr[1]-ei[1],zn*(Vr[2]-ei[2])],oo=Ke.vec3.cross(ui,ui,[fi[0]-ei[0],fi[1]-ei[1],zn*(fi[2]-ei[2])]);Ke.vec3.normalize(oo,oo),Xr.dotProductWithUp=Ke.vec3.dot(oo,qn)}return Lr.sort((Xr,ei)=>Xr.dotProductWithUp-ei.dotProductWithUp),Lr[0].corners}(ct,ht),At=ct[_t[0]],It=ct[_t[1]],wt=ct[_t[2]],Xt=ct[_t[3]],pn=nt.getAtPointOrZero(new ft(At[0]/Ne.worldSize,At[1]/Ne.worldSize),0),Ut=nt.getAtPointOrZero(new ft(It[0]/Ne.worldSize,It[1]/Ne.worldSize),0),Fn=nt.getAtPointOrZero(new ft(wt[0]/Ne.worldSize,wt[1]/Ne.worldSize),0),An=nt.getAtPointOrZero(new ft(Xt[0]/Ne.worldSize,Xt[1]/Ne.worldSize),0),xn=(pn+An)/2,cn=(Ut+Fn)/2;return xn>cn?Ut<Fn?Lv(Ve,It,Xt,At,Ut,An,pn,ht):Lv(Ve,wt,At,Xt,Fn,pn,An,ht):pn<An?Lv(Ve,At,It,wt,pn,Ut,Fn,ht):Lv(Ve,Xt,wt,It,An,Fn,Ut,ht),Math.max(xn,cn)}(he,s,n.aabb,u,c);const ye=Ke.mat4.fromQuat([],he),Me=Ke.mat4.multiply([],ye,ne);Ke.mat4.multiply(u,X,Me)}else J=s.elevation.getAtPointOrZero(new ft(C.x/W,C.y/W),0);J!==0&&(u[14]+=J)}}function d_(u,n,s=!1){u.uploaded||(u.gfxTexture=new q1(n,u.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:u.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function W8(u,n,s){u.indexBuffer=n.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=n.createVertexBuffer(u.vertexArray,j8.members,!1,!0),u.normalArray&&(u.normalBuffer=n.createVertexBuffer(u.normalArray,q8.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=n.createVertexBuffer(u.texcoordArray,V8.members,!1,!0)),u.colorArray&&(u.colorBuffer=n.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?$8:U8).members,!1,!0)),u.featureArray&&(u.pbrBuffer=n.createVertexBuffer(u.featureArray,H8.members,!0)),u.segments=$o.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const c=u.material;c.pbrMetallicRoughness.baseColorTexture&&d_(c.pbrMetallicRoughness.baseColorTexture,n),c.pbrMetallicRoughness.metallicRoughnessTexture&&d_(c.pbrMetallicRoughness.metallicRoughnessTexture,n),c.normalTexture&&d_(c.normalTexture,n),c.occlusionTexture&&d_(c.occlusionTexture,n,s),c.emissionTexture&&d_(c.emissionTexture,n)}function X1(u,n,s){if(u.meshes)for(const c of u.meshes)W8(c,n,s);if(u.children)for(const c of u.children)X1(c,n,s)}function zv(u){if(u.meshes)for(const n of u.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(u.children)for(const n of u.children)zv(n)}function K1(u){if(u.meshes)for(const s of u.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(u.children)for(const s of u.children)K1(s)}class km{constructor(n,s,c){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(n,s,c){const m=c||n.findDEMTileFor(s);if(!m||!m.dem)return;const f=m.dem,g=m.tileID,E=1<<s.canonical.z-g.canonical.z;return new km(m,f.dim/En/E,[(s.canonical.x/E-g.canonical.x)*f.dim,(s.canonical.y/E-g.canonical.y)*f.dim])}tileCoordToPixel(n,s){const c=s*this._scale+this._offset[1],m=Math.floor(n*this._scale+this._offset[0]),f=Math.floor(c);return new Yt(m,f)}getElevationAt(n,s,c,m){const f=n*this._scale+this._offset[0],g=s*this._scale+this._offset[1],E=Math.floor(f),O=Math.floor(g),D=this._dem;return m=!!m,c?Yn(Yn(D.get(E,O,m),D.get(E,O+1,m),g-O),Yn(D.get(E+1,O,m),D.get(E+1,O+1,m),g-O),f-E):D.get(E,O,m)}getElevationAtPixel(n,s,c){return this._dem.get(n,s,!!c)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*we(1,n)*this._dem.stride}}const Y1=new Float32Array(262144),wp=new Uint8Array(262144);function PO(u){let n=0;if(u.meshes)for(const s of u.meshes)n=Math.max(n,s.aabb.max[2]);if(u.children)for(const s of u.children)n=Math.max(n,PO(s));return n}function MO(u,n,s){if(u.meshes)for(const c of u.meshes){if(c.aabb.min[0]===1/0)continue;const m=pi.applyTransform(c.aabb,u.matrix);s.insert(n,m.min[0],m.min[1],m.max[0],m.max[1])}if(u.children)for(const c of u.children)MO(c,n,s)}const IO=["","wall","door","roof","window","lamp","logo"];class CO{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:PO(n)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==n&&(c.transformedAabb=pi.applyTransformFast(c.aabb,this.node.matrix),s.encapsulate(c.transformedAabb)),n++;this.aabb=s}return this.aabb}}class Fv{constructor(n,s,c,m,f,g,E){this.id=c,this.layers=n,this.layerIds=this.layers.map(O=>O.fqid),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.modelTraits|=Om.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=Om.HasMapboxMeshFeatures),f&&(this.modelTraits|=Om.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const O of s)this.nodesInfo.push(new CO(O)),MO(O,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0)}updateFootprints(n,s){for(const c of this.getNodesInfo()){const m=c.node;m.footprint&&s.push({footprint:m.footprint,id:n})}}update(n){const s=Object.keys(n).length!==0;if(s&&!this.stateDependentLayers.length)return;const c=s?this.stateDependentLayers:this.layers;for(const m of c)this.evaluate(m,n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const c of s){const m=c.node;this.uploaded?this.updatePbrBuffer(m):X1(m,n,!0)}for(const c of s)zv(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const c of n.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),s=!0);return s}needsReEvaluation(n,s,c){const m=n.transform.projectionOptions,f=n.style.getBrightness(),g=this.brightness!==f;return!!(!this.uploaded||this.dirty||m.name!==this.projection.name||p_(c.paint.get("model-color").value,g)||p_(c.paint.get("model-color-mix-intensity").value,g)||p_(c.paint.get("model-roughness").value,g)||p_(c.paint.get("model-emissive-strength").value,g)||p_(c.paint.get("model-height-based-emissive-strength-multiplier").value,g))&&(this.projection=m,this.brightness=f,!0)}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const c=this.getNodesInfo(),m=this.id.canonical;for(const f of c){const g=f.feature;f.evaluatedScale=s.paint.get("model-scale").evaluate(g,{},m)}}evaluate(n,s){const c=this.getNodesInfo();for(const m of c){if(!m.node.meshes)continue;const f=m.feature,g=s&&s[f.id],E=m.node.meshes&&m.node.meshes[0].featureData,O=m.evaluatedColor[2],D=m.evaluatedRMEA[2],w=this.id.canonical;if(m.hasTranslucentParts=!1,E){for(let C=0;C<IO.length;C++){const R=IO[C];R.length&&(f.properties.part=R);const P=n.paint.get("model-color").evaluate(f,g,w).toRenderColor(null),k=n.paint.get("model-color-mix-intensity").evaluate(f,g,w);m.evaluatedColor[C]=[P.r,P.g,P.b,k],m.evaluatedRMEA[C][0]=n.paint.get("model-roughness").evaluate(f,g,w),m.evaluatedRMEA[C][2]=n.paint.get("model-emissive-strength").evaluate(f,g,w),m.evaluatedRMEA[C][3]=P.a,m.emissionHeightBasedParams[C]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(f,g,w),!m.hasTranslucentParts&&P.a<1&&(m.hasTranslucentParts=!0)}delete f.properties.part,X8(m,O!==m.evaluatedColor[2]||D!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(f,g,w);m.evaluatedScale=n.paint.get("model-scale").evaluate(f,g,w),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,c,m){const f=n.findDEMTileFor(c);if(f&&(f.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(f.dem&&f.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=f.tileID.overscaledZ;const g=km.create(n,c,f);if(!g)return;this.modelTraits&Om.HasMapboxMeshFeatures&&this.updateDEM(n,g,c,m);for(const E of this.getNodesInfo()){const O=E.node;if(!O.footprint||!O.footprint.vertices||!O.footprint.vertices.length)continue;const D=O.footprint.vertices;let w=g.getElevationAt(D[0].x,D[0].y,!0,!0);for(let C=1;C<D.length;C++)w=Math.min(w,g.getElevationAt(D[C].x,D[C].y,!0,!0));O.elevation=w}}this.terrainTile=f.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,c,m){let f=s._dem._modifiedForSources[m];if(f===void 0&&(s._dem._modifiedForSources[m]=[],f=s._dem._modifiedForSources[m]),f.includes(c.canonical))return;const g=s._dem.dim;f.push(c.canonical);let E=!1;for(const O of this.getNodesInfo()){const D=O.node;if(!D.footprint||!D.footprint.grid)continue;const w=D.footprint.grid,C=s.tileCoordToPixel(w.min.x,w.min.y),R=s.tileCoordToPixel(w.max.x,w.max.y),P=Math.min(Math.min(g-R.y,C.x),Math.min(C.y,g-R.x));if(P<0)continue;const k=lr(P,2,5);let N=Math.max(0,C.x-k),W=Math.max(0,C.y-k),X=Math.min(R.x+k,g-1),ee=Math.min(R.y+k,g-1);for(let ye=W;ye<=ee;++ye)for(let Me=N;Me<=X;++Me)wp[ye*g+Me]=255;let ne=0,J=0;for(let ye=0;ye<w.cellsY;++ye)for(let Me=0;Me<w.cellsX;++Me){if(!w.cells[ye*w.cellsX+Me])continue;const Ve=s.tileCoordToPixel(w.min.x+Me/w.xScale,w.min.y+ye/w.yScale),Ne=s.tileCoordToPixel(w.min.x+(Me+1)/w.xScale,w.min.y+(ye+1)/w.yScale);for(let $e=Ve.y;$e<=Math.min(Ne.y+1,g-1);++$e)for(let ot=Ve.x;ot<=Math.min(Ne.x+1,g-1);++ot)wp[$e*g+ot]===255&&(wp[$e*g+ot]=0,ne+=s.getElevationAtPixel(ot,$e),J++)}const he=ne/J;N=Math.max(1,C.x-k),W=Math.max(1,C.y-k),X=Math.min(R.x+k,g-2),ee=Math.min(R.y+k,g-2),E=!0;for(let ye=W;ye<=ee;++ye)for(let Me=N;Me<=X;++Me)wp[ye*g+Me]===0&&(Y1[ye*g+Me]=s._dem.set(Me,ye,he));for(let ye=1;ye<k;++ye){N=Math.max(1,C.x-ye),W=Math.max(1,C.y-ye),X=Math.min(R.x+ye,g-2),ee=Math.min(R.y+ye,g-2);for(let Me=W;Me<=ee;++Me)for(let Ve=N;Ve<=X;++Ve){const Ne=Me*g+Ve;if(wp[Ne]===255){let $e=0,ot=0,je=-1,nt=-1;for(let ct=-1;ct<=1;++ct)for(let ht=-1;ht<=1;++ht){const _t=(Me+ct)*g+Ve+ht;if(wp[_t]>=ye)continue;const At=Y1[_t],It=Math.abs(At);It>ot&&($e=At,ot=It,je=ht,nt=ct)}if(ot>.1){const ct=1-(ye+.5*Math.abs(je*nt))/k;let ht=s._dem.get(Ve,Me)+$e*ct;const _t=s._dem.get(Ve+je,Me+nt),At=s._dem.get(Ve-je,Me-nt,!0);(ht-_t)*(ht-At)>0&&(ht=(_t+At)/2),Y1[Ne]=s._dem.set(Ve,Me,ht),wp[Ne]=ye}}}}}E&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=Wt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)zv(s.node),K1(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(n.toUnwrapped()),m=this.getNodesInfo();for(let f=0;f<this.nodesInfo.length;f++){const g=m[f].node;m[f].hiddenByReplacement=!!g.footprint&&!c.find(E=>E.footprint===g.footprint)}}getHeightAtTileCoord(n,s){const c=this.getNodesInfo(),m=[],f=[0,0,0],g=Ke.mat4.identity([]);for(let E=0;E<this.nodesInfo.length;E++){const O=c[E],D=O.node.meshes[0],w=D.transformedAabb;if(n<w.min[0]||s<w.min[1]||n>w.max[0]||s>w.max[1])continue;if(O.node.hidden===!0)return{height:1/0,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};Ke.mat4.invert(g,O.node.matrix),f[0]=n,f[1]=s,Ke.vec3.transformMat4(f,f,g);const C=(f[0]-D.aabb.min[0])/(D.aabb.max[0]-D.aabb.min[0])*bp|0,R=Math.min(63,(f[1]-D.aabb.min[1])/(D.aabb.max[1]-D.aabb.min[1])*bp|0)*bp+Math.min(63,C),P=D.heightmap[R];if(!(P<0&&O.node.footprint))return O.hiddenByReplacement?void 0:{height:P,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};if(O.node.footprint.grid.query(new Yt(n,s),new Yt(n,s),m),m.length>0)return{height:void 0,maxHeight:O.feature.properties.height,hidden:O.hiddenByReplacement,verticalScale:O.evaluatedScale[2]}}}}function p_(u,n){return!u.isLightConstant&&n}function Z8(u,n,s,c,m,f,g,E){let O=(61440&n|(61440&n)>>4)>>8,D=(3840&n|(3840&n)>>4)>>4,w=240&n|(240&n)>>4;s[3]>0&&(O=Yn(O,255*s[0],s[3]),D=Yn(D,255*s[1],s[3]),w=Yn(w,255*s[2],s[3]));const C=O<<8|D,R=w<<8|Math.floor(255*c[3]),P=function(ye){const Me=lr(ye,0,2);return Math.min(Math.round(.5*Me*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],k=lr(m[0],0,1),N=lr(m[1],0,1),W=lr(m[2],0,1),X=lr(m[3],0,1);let ee,ne,J,he;if(k!==N&&g!==f&&N!==k){const ye=g-f;ne=1/(ye*(N-k)),J=-(f+ye*k)/(ye*(N-k));const Me=lr(m[4],-1,1);he=Math.pow(10,Me),ee=255*W<<8|255*X}else ee=65535,ne=0,J=1,he=1;if(u.emplaceBack(C,R,P,ee,ne,J,he),E){const ye=E.length;E.clear();for(let Me=0;Me<ye;Me++)E.emplaceBack(C,R,P,ee,ne,J,he)}}function X8(u,n,s){const c=u.node;let m=0;const f=s&Om.HasMeshoptCompression;for(const g of c.meshes){if(c.lights&&c.lightMeshIndex===m||!g.featureData)continue;g.featureArray=new kf,g.featureArray.reserve(g.featureData.length);let E=n;for(const O of g.featureData){const D=f?65535&O:O>>16&65535,w=f?O>>16&65535:65535&O,C=(15&w)<8?15&w:0,R=u.evaluatedRMEA[C],P=u.evaluatedColor[C],k=u.emissionHeightBasedParams[C];let N;if(E&&C===2&&c.lights&&(N=new kf,N.resize(10*c.lights.length)),Z8(g.featureArray,D,P,R,k,g.aabb.min[2],g.aabb.max[2],N),N&&E){E=!1;const W=c.meshes[c.lightMeshIndex];W.featureArray=N,W.featureArray._trim()}}g.featureArray._trim(),m++}}kn(Fv,"Tiled3dModelBucket",{omit:["layers"]}),kn(CO,"Tiled3dModelFeature");const K8=["id","tile","layer","source","sourceLayer","state"];class m_{constructor(n,s,c,m,f){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=c,this._y=m,this.properties=n.properties,this.id=f}clone(){const n=new m_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state={...this.state}),this.layer&&(n.layer={...this.layer}),this.namespace&&(n.namespace=this.namespace),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of K8)this[s]!==void 0&&(n[s]=this[s]);return n}}function OO(u,n,s,c){const m=1<<u.z;n.lat=Ue((c/En+u.y)/m),n.lng=ze((s/En+u.x)/m)}const Y8={circle:class extends ms{constructor(u,n,s,c){super(u,{layout:Ei||(Ei=new Ni({"circle-sort-key":new tr(Et.layout_circle["circle-sort-key"]),visibility:new vn(Et.layout_circle.visibility)})),paint:Ui||(Ui=new Ni({"circle-radius":new tr(Et.paint_circle["circle-radius"]),"circle-color":new tr(Et.paint_circle["circle-color"]),"circle-blur":new tr(Et.paint_circle["circle-blur"]),"circle-opacity":new tr(Et.paint_circle["circle-opacity"]),"circle-translate":new vn(Et.paint_circle["circle-translate"]),"circle-translate-anchor":new vn(Et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vn(Et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vn(Et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new tr(Et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new tr(Et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new tr(Et.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new vn(Et.paint_circle["circle-emissive-strength"])}))},n,s,c)}createBucket(u){return new rn(u)}queryRadius(u){const n=u;return li("circle-radius",this,n)+li("circle-stroke-width",this,n)+Rr(this.paint.get("circle-translate"))}queryIntersectsFeature(u,n,s,c,m,f,g,E){const O=Qr(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return nv(u,c,f,g,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,D)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,n,s){const c=tv(this);return{config:new Eu(this,{zoom:n,lut:s}),defines:c,overrideFog:!1}}},heatmap:class extends ms{createBucket(u){return new xm(u)}constructor(u,n,s,c){super(u,{layout:iv||(iv=new Ni({visibility:new vn(Et.layout_heatmap.visibility)})),paint:wh||(wh=new Ni({"heatmap-radius":new tr(Et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new tr(Et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vn(Et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ps(Et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vn(Et.paint_heatmap["heatmap-opacity"])}))},n,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return li("heatmap-radius",this,u)}queryIntersectsFeature(u,n,s,c,m,f,g,E){const O=this.paint.get("heatmap-radius").evaluate(n,s);return nv(u,c,f,g,E,!0,!0,new Yt(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,n,s){return u==="heatmap"?{config:new Eu(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends ms{constructor(u,n,s,c){super(u,{layout:gp||(gp=new Ni({visibility:new vn(Et.layout_hillshade.visibility)})),paint:Kh||(Kh=new Ni({"hillshade-illumination-direction":new vn(Et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vn(Et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vn(Et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vn(Et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vn(Et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vn(Et.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new vn(Et.paint_hillshade["hillshade-emissive-strength"])}))},n,s,c)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,n,s){return{overrideFog:!1}}},fill:class extends ms{constructor(u,n,s,c){super(u,{layout:zr||(zr=new Ni({"fill-sort-key":new tr(Et.layout_fill["fill-sort-key"]),visibility:new vn(Et.layout_fill.visibility),"fill-elevation-reference":new vn(Et.layout_fill["fill-elevation-reference"])})),paint:jr||(jr=new Ni({"fill-antialias":new vn(Et.paint_fill["fill-antialias"]),"fill-opacity":new tr(Et.paint_fill["fill-opacity"]),"fill-color":new tr(Et.paint_fill["fill-color"]),"fill-outline-color":new tr(Et.paint_fill["fill-outline-color"]),"fill-translate":new vn(Et.paint_fill["fill-translate"]),"fill-translate-anchor":new vn(Et.paint_fill["fill-translate-anchor"]),"fill-pattern":new tr(Et.paint_fill["fill-pattern"]),"fill-emissive-strength":new vn(Et.paint_fill["fill-emissive-strength"]),"fill-z-offset":new tr(Et.paint_fill["fill-z-offset"])}))},n,s,c)}getProgramIds(){const u=this.paint.get("fill-pattern"),n=u&&u.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(u,n,s){return{config:new Eu(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(u,n){super.recalculate(u,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new xr(u)}queryRadius(){return Rr(this.paint.get("fill-translate"))}queryIntersectsFeature(u,n,s,c,m,f){return!u.queryGeometry.isAboveHorizon&&er(Li(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends ms{constructor(u,n,s,c){super(u,{layout:oC||(oC=new Ni({visibility:new vn(Et["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new vn(Et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:aC||(aC=new Ni({"fill-extrusion-opacity":new vn(Et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new tr(Et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vn(Et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vn(Et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new tr(Et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new tr(Et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new tr(Et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new vn(Et["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new vn(Et["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new vn(Et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new vn(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new vn(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new vn(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new vn(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new vn(Et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new vn(Et["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new vn(Et["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new tr(Et["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new tr(Et["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new vn(Et["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new vn(Et["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new vn(Et["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new vn(Et["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new tr(Et["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new tr(Et["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new vn(Et["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},n,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new pv(u)}queryRadius(){return Rr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,n,s,c,m,f,g,E,O){const D=Qr(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(n,s),C=this.paint.get("fill-extrusion-base").evaluate(n,s),R=[0,0],P=E&&f.elevation,k=f.elevation?f.elevation.exaggeration():1,N=u.tile.getBucket(this);if(P&&N instanceof pv){const J=N.centroidVertexArray,he=O+1;he<J.length&&(R[0]=J.geta_centroid_pos0(he),R[1]=J.geta_centroid_pos1(he))}if(R[0]===0&&R[1]===1)return!1;f.projection.name==="globe"&&(c=iC([c],[new Yt(0,0),new Yt(En,En)],u.tileID.canonical).map(J=>J.polygon).flat());const W=P?E:null,[X,ee]=function(J,he,ye,Me,Ve,Ne,$e,ot,je,nt,ct){return J.projection.name==="globe"?function(ht,_t,At,It,wt,Xt,pn,Ut,Fn,An,xn){const cn=[],ur=[],zn=ht.projection.upVectorScale(xn,ht.center.lat,ht.worldSize).metersToTile,qn=[0,0,0,1],Lr=[0,0,0,1],Xr=(Vr,fi,ui,oo)=>{Vr[0]=fi,Vr[1]=ui,Vr[2]=oo,Vr[3]=1},ei=rC();At>0&&(At+=ei),It+=ei;for(const Vr of _t){const fi=[],ui=[];for(const oo of Vr){const Yi=oo.x+wt.x,Tr=oo.y+wt.y,$i=ht.projection.projectTilePoint(Yi,Tr,xn),qi=ht.projection.upVector(xn,oo.x,oo.y);let bo=At,ga=It;if(pn){const La=lC(Yi,Tr,At,It,pn,Ut,Fn,An);bo+=La.base,ga+=La.top}At!==0?Xr(qn,$i.x+qi[0]*zn*bo,$i.y+qi[1]*zn*bo,$i.z+qi[2]*zn*bo):Xr(qn,$i.x,$i.y,$i.z),Xr(Lr,$i.x+qi[0]*zn*ga,$i.y+qi[1]*zn*ga,$i.z+qi[2]*zn*ga),Ke.vec3.transformMat4(qn,qn,Xt),Ke.vec3.transformMat4(Lr,Lr,Xt),fi.push(new xp(qn[0],qn[1],qn[2])),ui.push(new xp(Lr[0],Lr[1],Lr[2]))}cn.push(fi),ur.push(ui)}return[cn,ur]}(J,he,ye,Me,Ve,Ne,$e,ot,je,nt,ct):$e?function(ht,_t,At,It,wt,Xt,pn,Ut,Fn){const An=[],xn=[],cn=[0,0,0,1];for(const ur of ht){const zn=[],qn=[];for(const Lr of ur){const Xr=Lr.x+It.x,ei=Lr.y+It.y,Vr=lC(Xr,ei,_t,At,Xt,pn,Ut,Fn);cn[0]=Xr,cn[1]=ei,cn[2]=Vr.base,cn[3]=1,Ke.vec4.transformMat4(cn,cn,wt),cn[3]=Math.max(cn[3],1e-5);const fi=new xp(cn[0]/cn[3],cn[1]/cn[3],cn[2]/cn[3]);cn[0]=Xr,cn[1]=ei,cn[2]=Vr.top,cn[3]=1,Ke.vec4.transformMat4(cn,cn,wt),cn[3]=Math.max(cn[3],1e-5);const ui=new xp(cn[0]/cn[3],cn[1]/cn[3],cn[2]/cn[3]);zn.push(fi),qn.push(ui)}An.push(zn),xn.push(qn)}return[An,xn]}(he,ye,Me,Ve,Ne,$e,ot,je,nt):function(ht,_t,At,It,wt){const Xt=[],pn=[],Ut=wt[8]*_t,Fn=wt[9]*_t,An=wt[10]*_t,xn=wt[11]*_t,cn=wt[8]*At,ur=wt[9]*At,zn=wt[10]*At,qn=wt[11]*At;for(const Lr of ht){const Xr=[],ei=[];for(const Vr of Lr){const fi=Vr.x+It.x,ui=Vr.y+It.y,oo=wt[0]*fi+wt[4]*ui+wt[12],Yi=wt[1]*fi+wt[5]*ui+wt[13],Tr=wt[2]*fi+wt[6]*ui+wt[14],$i=wt[3]*fi+wt[7]*ui+wt[15],qi=oo+Ut,bo=Yi+Fn,ga=Tr+An,La=Math.max($i+xn,1e-5),_a=oo+cn,Jo=Yi+ur,Ea=Tr+zn,Ga=Math.max($i+qn,1e-5);Xr.push(new xp(qi/La,bo/La,ga/La)),ei.push(new xp(_a/Ga,Jo/Ga,Ea/Ga))}Xt.push(Xr),pn.push(ei)}return[Xt,pn]}(he,ye,Me,Ve,Ne)}(f,c,C,w,D,g,W,R,k,f.center.lat,u.tileID.canonical),ne=u.queryGeometry;return function(J,he,ye){let Me=1/0;er(ye,he)&&(Me=sC(ye,he[0]));for(let Ve=0;Ve<he.length;Ve++){const Ne=he[Ve],$e=J[Ve];for(let ot=0;ot<Ne.length-1;ot++){const je=Ne[ot],nt=[je,Ne[ot+1],$e[ot+1],$e[ot],je];en(ye,nt)&&(Me=Math.min(Me,sC(ye,nt)))}}return Me!==1/0&&Me}(X,ee,ne.isPointQuery()?ne.screenBounds:ne.screenGeometry)}},line:class extends ms{constructor(u,n,s,c){const m=yC();super(u,m,n,s,c),m.layout&&(this.layout=new wc(m.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Uu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,n){super.recalculate(u,n),this.paint._values["line-floorwidth"]=(()=>{if(n_)return n_;const s=yC();return n_=new QU(s.paint.properties["line-width"].specification),n_.useIntegerZoom=!0,n_})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new S1(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,n,s){const c=gC(this);return{config:new Eu(this,{zoom:n,lut:s}),defines:c,overrideFog:!1}}queryRadius(u){const n=u,s=vC(li("line-width",this,n),li("line-gap-width",this,n)),c=li("line-offset",this,n);return s/2+Math.abs(c)+Rr(this.paint.get("line-translate"))}queryIntersectsFeature(u,n,s,c,m,f){if(u.queryGeometry.isAboveHorizon)return!1;const g=Li(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),E=u.pixelToTileUnitsFactor/2*vC(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),O=this.paint.get("line-offset").evaluate(n,s);return O&&(c=function(D,w){const C=[],R=new Yt(0,0);for(let P=0;P<D.length;P++){const k=D[P],N=[];for(let W=0;W<k.length;W++){const X=k[W],ee=k[W+1],ne=W===0?R:X.sub(k[W-1])._unit()._perp(),J=W===k.length-1?R:ee.sub(X)._unit()._perp(),he=ne._add(J)._unit();he._mult(1/(he.x*J.x+he.y*J.y)),N.push(he._mult(w)._add(X))}C.push(N)}return C}(c,O*u.pixelToTileUnitsFactor)),function(D,w,C){for(let R=0;R<w.length;R++){const P=w[R];if(D.length>=3){for(let k=0;k<P.length;k++)if(si(D,P[k]))return!0}if(or(D,P,C))return!0}return!1}(g,c,E)}isTileClipped(){return!0}isDraped(u){const n=this.layout.get("line-z-offset"),s=n.isConstant()&&!n.constantOr(0),c=this.layout.get("line-elevation-reference");return!(c==="sea"||c==="ground")&&(s||c!=="none")}},symbol:Iv,background:class extends ms{constructor(u,n,s,c){super(u,{layout:nO||(nO=new Ni({visibility:new vn(Et.layout_background.visibility)})),paint:rO||(rO=new Ni({"background-pitch-alignment":new vn(Et.paint_background["background-pitch-alignment"]),"background-color":new vn(Et.paint_background["background-color"]),"background-pattern":new vn(Et.paint_background["background-pattern"]),"background-opacity":new vn(Et.paint_background["background-opacity"]),"background-emissive-strength":new vn(Et.paint_background["background-emissive-strength"])}))},n,s,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:lO,"raster-particle":pO,sky:class extends ms{constructor(u,n,s,c){super(u,{layout:hO||(hO=new Ni({visibility:new vn(Et.layout_sky.visibility)})),paint:fO||(fO=new Ni({"sky-type":new vn(Et.paint_sky["sky-type"]),"sky-atmosphere-sun":new vn(Et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new vn(Et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new vn(Et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new vn(Et.paint_sky["sky-gradient-radius"]),"sky-gradient":new ps(Et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new vn(Et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new vn(Et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new vn(Et.paint_sky["sky-opacity"])}))},n,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Cd({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(u,n){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),m=!c,f=u.style.light,g=f.properties.get("position");return m&&f.properties.get("anchor")==="viewport"&&Er("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?G1(g.azimuthal,90-g.polar,n):G1(c[0],90-c[1],n)}const s=this.paint.get("sky-gradient-center");return G1(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends ms{constructor(u,n,s,c){super(u,{paint:dO||(dO=new Ni({}))},n,null)}},model:class extends ms{constructor(u,n,s,c){super(u,{layout:TO||(TO=new Ni({visibility:new vn(Et.layout_model.visibility),"model-id":new tr(Et.layout_model["model-id"])})),paint:EO||(EO=new Ni({"model-opacity":new vn(Et.paint_model["model-opacity"]),"model-rotation":new tr(Et.paint_model["model-rotation"]),"model-scale":new tr(Et.paint_model["model-scale"]),"model-translation":new tr(Et.paint_model["model-translation"]),"model-color":new tr(Et.paint_model["model-color"]),"model-color-mix-intensity":new tr(Et.paint_model["model-color-mix-intensity"]),"model-type":new vn(Et.paint_model["model-type"]),"model-cast-shadows":new vn(Et.paint_model["model-cast-shadows"]),"model-receive-shadows":new vn(Et.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new vn(Et.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new tr(Et.paint_model["model-emissive-strength"]),"model-roughness":new tr(Et.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new tr(Et.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new vn(Et.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new vn(Et.paint_model["model-front-cutoff"])}))},n,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new Z1(u)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof Fv?En-1:0}queryIntersectsFeature(u,n,s,c,m,f){if(!this.modelManager)return!1;const g=this.modelManager,E=u.tile.getBucket(this);if(!(E&&E instanceof Z1))return!1;const O=E;for(const D in O.instancesPerModel){const w=O.instancesPerModel[D],C=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(w.idToFeaturesIndex.hasOwnProperty(C)){const R=w.features[w.idToFeaturesIndex[C]],P=g.getModel(D,this.scope);if(!P)return!1;let k=Ke.mat4.create();const N=new q(0,0),W=O.canonical;let X=Number.MAX_VALUE;for(let ee=0;ee<R.instancedDataCount;++ee){const ne=16*(R.instancedDataOffset+ee),J=w.instancedDataArray.float32,he=[J[ne+4],J[ne+5],J[ne+6]];OO(W,N,J[ne],0|J[ne+1]),AO(k,P,f,N,R.rotation,R.scale,he,!1,!1,!1),f.projection.name==="globe"&&(k=W1(k,f));const ye=Ke.mat4.multiply([],f.projMatrix,k),Me=u.queryGeometry,Ve=vO(Me.isPointQuery()?Me.screenBounds:Me.screenGeometry,f,ye,P.aabb);Ve!=null&&(X=Math.min(Ve,X))}return X!==Number.MAX_VALUE&&X}}return!1}_handleOverridablePaintPropertyUpdate(u,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const n=this._transitionablePaint._values[u];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof yc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(u,n,s,c){const m=u.tile,f=m.getBucket(this);let g=null,E=Number.MAX_VALUE;if(!(f&&f instanceof Fv))return{queryFeature:g,intersectionZ:E};const O=f.getNodesInfo()[n];if(O.hiddenByReplacement||!O.node.meshes||!s.filter(new Po(m.tileID.overscaledZ),O.feature,m.tileID.canonical))return{queryFeature:g,intersectionZ:E};const D=O.node,w=c.calculatePosMatrix(m.tileID.toUnwrapped(),c.worldSize),C=O.evaluatedScale;let R=0;c.elevation&&D.elevation&&(R=D.elevation*c.elevation.exaggeration()),Ke.mat4.translate(w,w,[(D.anchor?D.anchor[0]:0)*(C[0]-1),(D.anchor?D.anchor[1]:0)*(C[1]-1),R]),Ke.mat4.scale(w,w,C);const P=u.queryGeometry,k=P.isPointQuery()?P.screenBounds:P.screenGeometry,N=function(J){const he=Ke.mat4.multiply([],w,J.matrix);Ke.mat4.multiply(he,c.expandedFarZProjMatrix,he);for(let ye=0;ye<J.meshes.length;++ye){const Me=J.meshes[ye];if(ye===J.lightMeshIndex)continue;const Ve=vO(k,c,he,Me.aabb);Ve!=null&&(E=Math.min(Ve,E))}if(J.children)for(const ye of J.children)N(ye)};if(N(D),E===Number.MAX_VALUE)return{queryFeature:g,intersectionZ:E};const W=new q(0,0);OO(m.tileID.canonical,W,O.node.anchor[0],O.node.anchor[1]);const{z:X,x:ee,y:ne}=m.tileID.canonical;return g=new m_({},X,ee,ne,O.feature.id),g.properties=O.feature.properties,g.geometry={type:"Point",coordinates:[W.lng,W.lat]},g.layer={...this.serialize(),id:this.fqid},g.state={},g.tile=m.tileID.canonical,{queryFeature:g,intersectionZ:E}}},clip:class extends ms{constructor(u,n,s,c){super(u,{layout:qa||(qa=new Ni({"clip-layer-types":new vn(Et.layout_clip["clip-layer-types"]),"clip-layer-scope":new vn(Et.layout_clip["clip-layer-scope"])})),paint:ln||(ln=new Ni({}))},n,s,c)}recalculate(u,n){super.recalculate(u,n)}createBucket(u){return new rr(u)}isTileClipped(){return!0}is3D(){return!0}}};class J8{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Q8{constructor(){this.tasks={},this.taskQueue=[],za(["process"],this),this.invoker=new J8(this.process),this.nextId=0}add(n,s){const c=this.nextId++,m=function({type:f,isSymbolTile:g,zoom:E}){return E=E||0,f==="message"?0:f!=="maybePrepare"||g?f!=="parseTile"||g?f==="parseTile"&&g?300-E:f==="maybePrepare"&&g?400-E:500:200-E:100-E}(s);if(m===0){try{n()}finally{}return null}return this.tasks[c]={fn:n,metadata:s,priority:m,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let m=0;m<this.taskQueue.length;m++){const f=this.tasks[this.taskQueue[m]];f.priority<s&&(s=f.priority,n=m)}if(n===null)return null;const c=this.taskQueue[n];return this.taskQueue.splice(n,1),c}remove(){this.invoker.remove()}}class kO{constructor(n,s,c){this.target=n,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},za(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Q8}send(n,s,c,m,f=!1,g){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=g,this.callbacks[E]=c);const O=new Set;return this.target.postMessage({id:E,type:n,hasCallback:!!c,targetMapId:m,mustQueue:f,sourceMapId:this.mapId,data:js(s,O)},O),{cancel:()=>{c&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(n){const s=n.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const m=this.cancelCallbacks[c];delete this.cancelCallbacks[c],m&&m.cancel()}else if(s.mustQueue||vi()){const m=this.callbacks[c],f=this.scheduler.add(()=>this.processTask(c,s),m&&m.metadata||{type:"message"});f&&(this.cancelCallbacks[c]=f)}else this.processTask(c,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const c=this.callbacks[n];delete this.callbacks[n],c&&(s.error?c(Sa(s.error)):c(null,Sa(s.data)))}else{const c=new Set,m=s.hasCallback?(g,E)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:g?js(g):null,data:js(E,c)},c)}:()=>{},f=Sa(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,f,m);else if(this.parent.getWorkerSource){const g=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,g[0],f.source,f.scope)[g[1]](f,m)}else m(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Rm{constructor(n,s){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=ta();const c=this.workerPool.acquire(this.id);for(let m=0;m<c.length;m++){const f=new Rm.Actor(c[m],s,this.id);f.name=`Worker ${m}`,this.actors.push(f)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,c){la(this.actors,(m,f)=>{m.send(n,s,f)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}Rm.Actor=kO;class RO{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const c=this.toIdx(n,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function LO(u,n,s,c){let m=0,f=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(c[g])<1e-15){if(s[g]<u[g]||s[g]>n[g])return null}else{const E=1/c[g];let O=(u[g]-s[g])*E,D=(n[g]-s[g])*E;if(O>D){const w=O;O=D,D=w}if(O>m&&(m=O),D<f&&(f=D),m>f)return null}return m}function DO(u,n,s,c,m,f,g,E,O,D,w){const C=c-u,R=m-n,P=f-s,k=g-u,N=E-n,W=O-s,X=w[1]*W-w[2]*N,ee=w[2]*k-w[0]*W,ne=w[0]*N-w[1]*k,J=C*X+R*ee+P*ne;if(Math.abs(J)<1e-15)return null;const he=1/J,ye=D[0]-u,Me=D[1]-n,Ve=D[2]-s,Ne=(ye*X+Me*ee+Ve*ne)*he;if(Ne<0||Ne>1)return null;const $e=Me*P-Ve*R,ot=Ve*C-ye*P,je=ye*R-Me*C,nt=(w[0]*$e+w[1]*ot+w[2]*je)*he;return nt<0||Ne+nt>1?null:(k*$e+N*ot+W*je)*he}function zO(u,n,s){return(u-n)/(s-n)}function FO(u,n,s,c,m,f,g,E,O){const D=1<<s,w=f-c,C=g-m,R=(u+1)/D*w+c,P=(n+0)/D*C+m,k=(n+1)/D*C+m;E[0]=(u+0)/D*w+c,E[1]=P,O[0]=R,O[1]=k}class BO{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(f){const g=Math.ceil(Math.log2(f.dim/8)),E=[];let O=Math.ceil(Math.pow(2,g));const D=1/O,w=(P,k,N,W,X)=>{const ee=W?1:0,ne=(P+1)*N-ee,J=k*N,he=(k+1)*N-ee;X[0]=P*N,X[1]=J,X[2]=ne,X[3]=he};let C=new RO(O);const R=[];for(let P=0;P<O*O;P++){w(P%O,Math.floor(P/O),D,!1,R);const k=Fd(R[0],R[1],f),N=Fd(R[2],R[1],f),W=Fd(R[2],R[3],f),X=Fd(R[0],R[3],f);C.minimums.push(Math.min(k,N,W,X)),C.maximums.push(Math.max(k,N,W,X)),C.leaves.push(1)}for(E.push(C),O/=2;O>=1;O/=2){const P=E[E.length-1];C=new RO(O);for(let k=0;k<O*O;k++){w(k%O,Math.floor(k/O),2,!0,R);const N=P.getElevation(R[0],R[1]),W=P.getElevation(R[2],R[1]),X=P.getElevation(R[2],R[3]),ee=P.getElevation(R[0],R[3]),ne=P.isLeaf(R[0],R[1]),J=P.isLeaf(R[2],R[1]),he=P.isLeaf(R[2],R[3]),ye=P.isLeaf(R[0],R[3]),Me=Math.min(N.min,W.min,X.min,ee.min),Ve=Math.max(N.max,W.max,X.max,ee.max),Ne=ne&&J&&he&&ye;C.maximums.push(Ve),C.minimums.push(Me),C.leaves.push(Ve-Me<=5&&Ne?1:0)}E.push(C)}return E}(this.dem),c=s.length-1,m=s[c];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(n,s,c,m,f,g,E=1){return LO([n,s,-100],[c,m,this.maximums[0]*E],f,g)}raycast(n,s,c,m,f,g,E=1){if(!this.nodeCount)return null;const O=this.raycastRoot(n,s,c,m,f,g,E);if(O==null)return null;const D=[],w=[],C=[],R=[],P=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;P.length>0;){const{idx:k,t:N,nodex:W,nodey:X,depth:ee}=P.pop();if(this.leaves[k]){FO(W,X,ee,n,s,c,m,C,R);const J=1<<ee,he=(W+0)/J,ye=(W+1)/J,Me=(X+0)/J,Ve=(X+1)/J,Ne=Fd(he,Me,this.dem)*E,$e=Fd(ye,Me,this.dem)*E,ot=Fd(ye,Ve,this.dem)*E,je=Fd(he,Ve,this.dem)*E,nt=DO(C[0],C[1],Ne,R[0],C[1],$e,R[0],R[1],ot,f,g),ct=DO(R[0],R[1],ot,C[0],R[1],je,C[0],C[1],Ne,f,g),ht=Math.min(nt!==null?nt:Number.MAX_VALUE,ct!==null?ct:Number.MAX_VALUE);if(ht!==Number.MAX_VALUE)return ht;{const _t=Ke.vec3.scaleAndAdd([],f,g,N);if(NO(Ne,$e,je,ot,zO(_t[0],C[0],R[0]),zO(_t[1],C[1],R[1]))>=_t[2])return N}continue}let ne=0;for(let J=0;J<this._siblingOffset.length;J++){FO((W<<1)+this._siblingOffset[J][0],(X<<1)+this._siblingOffset[J][1],ee+1,n,s,c,m,C,R),C[2]=-100,R[2]=this.maximums[this.childOffsets[k]+J]*E;const he=LO(C,R,f,g);if(he!=null){const ye=he;D[J]=ye;let Me=!1;for(let Ve=0;Ve<ne&&!Me;Ve++)ye>=D[w[Ve]]&&(w.splice(Ve,0,J),Me=!0);Me||(w[ne]=J),ne++}}for(let J=0;J<ne;J++){const he=w[J];P.push({idx:this.childOffsets[k]+he,t:D[he],nodex:(W<<1)+this._siblingOffset[he][0],nodey:(X<<1)+this._siblingOffset[he][1],depth:ee+1})}}return null}_addNode(n,s,c){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,c,m,f){if(n[m].isLeaf(s,c)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const g=m-1,E=n[g];let O=0,D=0;for(let w=0;w<this._siblingOffset.length;w++){const C=2*s+this._siblingOffset[w][0],R=2*c+this._siblingOffset[w][1],P=E.getElevation(C,R),k=E.isLeaf(C,R),N=this._addNode(P.min,P.max,k);k&&(O|=1<<w),D||(D=N)}for(let w=0;w<this._siblingOffset.length;w++)O&1<<w||this._construct(n,2*s+this._siblingOffset[w][0],2*c+this._siblingOffset[w][1],g,D+w)}}function NO(u,n,s,c,m,f){return Yn(Yn(u,s,f),Yn(n,c,f),m)}function Fd(u,n,s){const c=s.dim,m=lr(u*c-.5,0,c-1),f=lr(n*c-.5,0,c-1),g=Math.floor(m),E=Math.floor(f),O=Math.min(g+1,c-1),D=Math.min(E+1,c-1);return NO(s.get(g,E),s.get(O,E),s.get(g,D),s.get(O,D),m-g,f-E)}const eV={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function tV(u,n,s){return(256*u*256+256*n+s)/10-1e4}function nV(u,n,s){return 256*u+n+s/256-32768}class Bv{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,c,m=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void Er(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const f=this.dim=s.height-2,g=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let O=0;O<f;O++)g[this._idx(-1,O)]=g[this._idx(0,O)],g[this._idx(f,O)]=g[this._idx(f-1,O)],g[this._idx(O,-1)]=g[this._idx(O,0)],g[this._idx(O,f)]=g[this._idx(O,f-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(f,-1)]=g[this._idx(f-1,0)],g[this._idx(-1,f)]=g[this._idx(0,f-1)],g[this._idx(f,f)]=g[this._idx(f-1,f-1)]}const E=c==="terrarium"?nV:tV;for(let O=0;O<g.length;++O){const D=4*O;this.floatView[O]=E(this.pixels[D],this.pixels[D+1],this.pixels[D+2])}this._timestamp=Wt.now()}_buildQuadTree(){this._tree=new BO(this)}get(n,s,c=!1){c&&(n=lr(n,-1,this.dim),s=lr(s,-1,this.dim));const m=this._idx(n,s);return this.floatView[m]}set(n,s,c){const m=this._idx(n,s),f=this.floatView[m];return this.floatView[m]=c,c-f}static getUnpackVector(n){return eV[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const c=[0,0,0,0],m=Bv.getUnpackVector(s);let f=Math.floor((n+m[3])/m[2]);return c[2]=f%256,f=Math.floor(f/256),c[1]=f%256,f=Math.floor(f/256),c[0]=f,c}getPixels(){return new ov({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let m=s*this.dim,f=s*this.dim+this.dim,g=c*this.dim,E=c*this.dim+this.dim;switch(s){case-1:m=f-1;break;case 1:f=m+1}switch(c){case-1:g=E-1;break;case 1:E=g+1}const O=-s*this.dim,D=-c*this.dim;for(let w=g;w<E;w++)for(let C=m;C<f;C++){const R=4*this._idx(C,w),P=4*this._idx(C+O,w+D);this.pixels[R+0]=n.pixels[P+0],this.pixels[R+1]=n.pixels[P+1],this.pixels[R+2]=n.pixels[P+2],this.pixels[R+3]=n.pixels[P+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function rV(u,n,s){u===1?n.headerLength=s.readFixed32():u===2?n.x=s.readVarint():u===3?n.y=s.readVarint():u===4?n.z=s.readVarint():u===5&&n.layers.push(function(c,m){return c.readFields(lV,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(s,s.readVarint()+s.pos))}function iV(u,n,s){u===1?(n.delta_filter=function(c,m){return c.readFields(oV,{blockSize:0},m)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):u===2?(s.readVarint(),n.filter="zigzag_filter"):u===3?(s.readVarint(),n.filter="bitshuffle_filter"):u===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function oV(u,n,s){u===1&&(n.blockSize=s.readVarint())}function aV(u,n,s){u===1?(s.readVarint(),n.codec="gzip_data"):u===2?(s.readVarint(),n.codec="jpeg_image"):u===3?(s.readVarint(),n.codec="webp_image"):u===4&&(s.readVarint(),n.codec="png_image")}function sV(u,n,s){let c=0,m=0;u===1?n.firstByte=s.readFixed64():u===2?n.lastByte=s.readFixed64():u===3?n.filters.push(function(f,g){return f.readFields(iV,{},g)}(s,s.readVarint()+s.pos)):u===4?n.codec=function(f,g){return f.readFields(aV,{},g)}(s,s.readVarint()+s.pos):u===5?m=s.readFloat():u===6?c=s.readFloat():u===7?n.bands.push(s.readString()):u===8?n.offset=s.readDouble():u===9&&(n.scale=s.readDouble()),n.offset===0&&(n.offset=m),n.scale===0&&(n.scale=c)}function lV(u,n,s){u===1?n.version=s.readVarint():u===2?n.name=s.readString():u===3?n.units=s.readString():u===4?n.tileSize=s.readVarint():u===5?n.buffer=s.readVarint():u===6?n.pixelFormat=s.readVarint():u===7&&n.dataIndex.push(function(c,m){return c.readFields(sV,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(s,s.readVarint()+s.pos))}function uV(u,n,s){if(u===2)(function(c,m,f){c.readFields(cV,f,m)})(s,s.readVarint()+s.pos,n);else if(u===3)throw new Error("Not implemented")}function cV(u,n,s){if(u===1){let c=0;const m=s.readVarint()+s.pos;for(;s.pos<m;)n[c++]=s.readVarint()}}kn(Bv,"DEMData"),kn(BO,"DemMinMaxQuadTree",{omit:["dem"]});class hV{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}}function fV(u,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let c=2;c>=1;c--){const m=c===1?1:0,f=c===2?1:0;for(let g=0;g<n[0];g++){const E=n[1]*g;for(let O=m;O<n[1];O++){const D=n[2]*(O+E);for(let w=f;w<n[2];w++){const C=n[3]*(w+D);for(let R=0;R<n[3];R++){const P=C+R;u[P]+=u[P-s]}}}}s*=n[c]}return u}function dV(u){for(let n=0,s=u.length;n<s;n++)u[n]=u[n]>>>1^-(1&u[n]);return u}function pV(u,n){switch(n){case"uint32":return u;case"uint16":for(let s=0;s<u.length;s+=2){const c=u[s],m=u[s+1];u[s]=(240&c)>>4|(61440&c)>>8|(240&m)<<4|61440&m,u[s+1]=15&c|(3840&c)>>4|(15&m)<<8|(3840&m)<<4}return u;case"uint8":for(let s=0;s<u.length;s+=4){const c=u[s],m=u[s+1],f=u[s+2],g=u[s+3];u[s+0]=(192&c)>>6|(192&m)>>4|(192&f)>>2|192&g,u[s+1]=(48&c)>>4|(48&m)>>2|48&f|(48&g)<<2,u[s+2]=(12&c)>>2|12&m|(12&f)<<2|(12&g)<<4,u[s+3]=3&c|(3&m)<<2|(3&f)<<4|(3&g)<<6}return u;default:throw new Error(`Invalid pixel format, "${n}"`)}}var Qu=Uint8Array,g_=Uint16Array,mV=Int32Array,jO=new Qu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$O=new Qu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gV=new Qu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UO=function(u,n){for(var s=new g_(31),c=0;c<31;++c)s[c]=n+=1<<u[c-1];var m=new mV(s[30]);for(c=1;c<30;++c)for(var f=s[c];f<s[c+1];++f)m[f]=f-s[c]<<5|c;return{b:s,r:m}},VO=UO(jO,2),qO=VO.b,_V=VO.r;qO[28]=258,_V[258]=28;for(var yV=UO($O,0).b,GO=new g_(32768),Ra=0;Ra<32768;++Ra){var Lm=(43690&Ra)>>1|(21845&Ra)<<1;GO[Ra]=((65280&(Lm=(61680&(Lm=(52428&Lm)>>2|(13107&Lm)<<2))>>4|(3855&Lm)<<4))>>8|(255&Lm)<<8)>>1}var __=function(u,n,s){for(var c=u.length,m=0,f=new g_(n);m<c;++m)u[m]&&++f[u[m]-1];var g,E=new g_(n);for(m=1;m<n;++m)E[m]=E[m-1]+f[m-1]<<1;g=new g_(1<<n);var O=15-n;for(m=0;m<c;++m)if(u[m])for(var D=m<<4|u[m],w=n-u[m],C=E[u[m]-1]++<<w,R=C|(1<<w)-1;C<=R;++C)g[GO[C]>>O]=D;return g},y_=new Qu(288);for(Ra=0;Ra<144;++Ra)y_[Ra]=8;for(Ra=144;Ra<256;++Ra)y_[Ra]=9;for(Ra=256;Ra<280;++Ra)y_[Ra]=7;for(Ra=280;Ra<288;++Ra)y_[Ra]=8;var HO=new Qu(32);for(Ra=0;Ra<32;++Ra)HO[Ra]=5;var vV=__(y_,9),xV=__(HO,5),J1=function(u){for(var n=u[0],s=1;s<u.length;++s)u[s]>n&&(n=u[s]);return n},Ah=function(u,n,s){var c=n/8|0;return(u[c]|u[c+1]<<8)>>(7&n)&s},Q1=function(u,n){var s=n/8|0;return(u[s]|u[s+1]<<8|u[s+2]<<16)>>(7&n)},bV=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ph=function(u,n,s){var c=new Error(n||bV[u]);if(c.code=u,Error.captureStackTrace&&Error.captureStackTrace(c,Ph),!s)throw c;return c},wV=new Qu(0),SV=typeof TextDecoder<"u"&&new TextDecoder;try{SV.decode(wV,{stream:!0})}catch{}const TV={gzip_data:"gzip"};class Dc extends Error{constructor(n){super(n),this.name="MRTError"}}const EV={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},WO={uint32:1,uint16:2,uint8:4},AV={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let eb;class tb{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new Dc(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),c=new DataView(n);if(s[0]!==13)throw new Dc("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),c=this.getHeaderLength(n);if(s.length<c)throw new Dc(`Expected header with length >= ${c} but got buffer of length ${s.length}`);const m=function(f,g){return f.readFields(rV,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new eb(s.subarray(0,c)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new Dc(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const f of m.layers)this.layers[f.name]=new PV(f,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],c=this.getLayer(n.layerName);for(let m of n.blockIndices){const f=c.dataIndex[m],g=f.firstByte-n.firstByte,E=f.lastByte-n.firstByte;if(c._blocksInProgress.has(m))continue;const O={layerName:c.name,firstByte:g,lastByte:E,pixelFormat:c.pixelFormat,blockIndex:m,blockShape:[f.bands.length].concat(c.bandShape),buffer:c.buffer,codec:f.codec.codec,filters:f.filters.map(D=>D.filter)};c._blocksInProgress.add(m),s.push(O)}return new ZO(s,()=>{s.forEach(m=>c._blocksInProgress.delete(m.blockIndex))},(m,f)=>{if(s.forEach(g=>c._blocksInProgress.delete(g.blockIndex)),m)throw m;f.forEach(g=>{this.getLayer(g.layerName).processDecodedData(g)})})}}class PV{constructor({version:n,name:s,units:c,tileSize:m,pixelFormat:f,buffer:g,dataIndex:E},O){if(this.version=n,this.version!==1)throw new Dc(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=c,this.tileSize=m,this.buffer=g,this.pixelFormat=EV[f],this.dataIndex=E,this.bandShape=[m+2*g,m+2*g,WO[this.pixelFormat]],this._decodedBlocks=new hV(O?O.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return WO[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[c,m]of this.dataIndex.entries()){for(const[f,g]of m.bands.entries())if(g===n)return{bandIndex:s+f,blockIndex:c,blockBandIndex:f};s+=m.bands.length}break;case"number":for(const[c,m]of this.dataIndex.entries()){if(n>=s&&n<s+m.bands.length)return{bandIndex:n,blockIndex:c,blockBandIndex:n-s};s+=m.bands.length}break;default:throw new Dc(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new Dc(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,c=-1/0;const m=[],f=new Set;for(const g of n){const{blockIndex:E}=this.getBlockForBand(g);if(E<0)throw new Dc(`Invalid band: ${JSON.stringify(g)}`);const O=this.dataIndex[E];m.includes(E)||m.push(E),f.add(E),s=Math.min(s,O.firstByte),c=Math.max(c,O.lastByte)}if(f.size>this.cacheSize)throw new Dc(`Number of blocks to decode (${f.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:c,blockIndices:m}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:c}=this.getBlockForBand(n),m=this._decodedBlocks.get(s.toString());if(!m)throw new Dc(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const f=this.dataIndex[s],g=this.bandShape.reduce((D,w)=>D*w,1),E=c*g,O=m.subarray(E,E+g);return{data:O,bytes:new Uint8Array(O.buffer).subarray(O.byteOffset,O.byteOffset+O.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:f.offset,scale:f.scale}}}tb.setPbf=function(u){eb=u};class ZO{constructor(n,s,c){this.tasks=n,this._onCancel=s,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}tb.performDecoding=function(u,n){const s=new Uint8Array(u);return Promise.all(n.tasks.map(c=>{const{layerName:m,firstByte:f,lastByte:g,pixelFormat:E,blockShape:O,blockIndex:D,filters:w,codec:C}=c,R=s.subarray(f,g+1),P=new Uint32Array(O[0]*O[1]*O[2]);let k;if(C!=="gzip_data")throw new Dc(`Unhandled codec: ${C}`);return k=function(N,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((J=function(Me){Me[0]==31&&Me[1]==139&&Me[2]==8||Ph(6,"invalid gzip data");var Ve=Me[3],Ne=10;4&Ve&&(Ne+=2+(Me[10]|Me[11]<<8));for(var $e=(Ve>>3&1)+(Ve>>4&1);$e>0;$e-=!Me[Ne++]);return Ne+(2&Ve)}(ne=N))+8>ne.length&&Ph(6,"invalid gzip data"),function(Me,Ve,Ne,$e){var ot=Me.length;if(!ot||Ve.f&&!Ve.l)return Ne||new Qu(0);var je=!Ne,nt=je||Ve.i!=2,ct=Ve.i;je&&(Ne=new Qu(3*ot));var ht,_t,At=function(Bd){var Ep=Ne.length;if(Bd>Ep){var E_=new Qu(Math.max(2*Ep,Bd));E_.set(Ne),Ne=E_}},It=Ve.f||0,wt=Ve.p||0,Xt=Ve.b||0,pn=Ve.l,Ut=Ve.d,Fn=Ve.m,An=Ve.n,xn=8*ot;do{if(!pn){It=Ah(Me,wt,1);var cn=Ah(Me,wt+1,3);if(wt+=3,!cn){var ur=Me[(Tr=4+((wt+7)/8|0))-4]|Me[Tr-3]<<8,zn=Tr+ur;if(zn>ot){ct&&Ph(0);break}nt&&At(Xt+ur),Ne.set(Me.subarray(Tr,zn),Xt),Ve.b=Xt+=ur,Ve.p=wt=8*zn,Ve.f=It;continue}if(cn==1)pn=vV,Ut=xV,Fn=9,An=5;else if(cn==2){var qn=Ah(Me,wt,31)+257,Lr=Ah(Me,wt+10,15)+4,Xr=qn+Ah(Me,wt+5,31)+1;wt+=14;for(var ei=new Qu(Xr),Vr=new Qu(19),fi=0;fi<Lr;++fi)Vr[gV[fi]]=Ah(Me,wt+3*fi,7);wt+=3*Lr;var ui=J1(Vr),oo=(1<<ui)-1,Yi=__(Vr,ui);for(fi=0;fi<Xr;){var Tr,$i=Yi[Ah(Me,wt,oo)];if(wt+=15&$i,(Tr=$i>>4)<16)ei[fi++]=Tr;else{var qi=0,bo=0;for(Tr==16?(bo=3+Ah(Me,wt,3),wt+=2,qi=ei[fi-1]):Tr==17?(bo=3+Ah(Me,wt,7),wt+=3):Tr==18&&(bo=11+Ah(Me,wt,127),wt+=7);bo--;)ei[fi++]=qi}}var ga=ei.subarray(0,qn),La=ei.subarray(qn);Fn=J1(ga),An=J1(La),pn=__(ga,Fn),Ut=__(La,An)}else Ph(1);if(wt>xn){ct&&Ph(0);break}}nt&&At(Xt+131072);for(var _a=(1<<Fn)-1,Jo=(1<<An)-1,Ea=wt;;Ea=wt){var Ga=(qi=pn[Q1(Me,wt)&_a])>>4;if((wt+=15&qi)>xn){ct&&Ph(0);break}if(qi||Ph(2),Ga<256)Ne[Xt++]=Ga;else{if(Ga==256){Ea=wt,pn=null;break}var Hs=Ga-254;Ga>264&&(Hs=Ah(Me,wt,(1<<(Ih=jO[fi=Ga-257]))-1)+qO[fi],wt+=Ih);var mo=Ut[Q1(Me,wt)&Jo],nu=mo>>4;if(mo||Ph(3),wt+=15&mo,La=yV[nu],nu>3){var Ih=$O[nu];La+=Q1(Me,wt)&(1<<Ih)-1,wt+=Ih}if(wt>xn){ct&&Ph(0);break}nt&&At(Xt+131072);var zc=Xt+Hs;if(Xt<La){var Fc=0-La,Tp=Math.min(La,zc);for(Fc+Xt<0&&Ph(3);Xt<Tp;++Xt)Ne[Xt]=(void 0)[Fc+Xt]}for(;Xt<zc;++Xt)Ne[Xt]=Ne[Xt-La]}}Ve.l=pn,Ve.p=Ea,Ve.b=Xt,Ve.f=It,pn&&(It=1,Ve.m=Fn,Ve.d=Ut,Ve.n=An)}while(!It);return Xt!=Ne.length&&je?(ht=Ne,((_t=Xt)==null||_t>ht.length)&&(_t=ht.length),new Qu(ht.subarray(0,_t))):Ne.subarray(0,Xt)}(ne.subarray(J,-8),{i:2},new Qu(((X=ne)[(ee=X.length)-4]|X[ee-3]<<8|X[ee-2]<<16|X[ee-1]<<24)>>>0))));var X,ee,ne,J;const he=TV[W];if(!he)throw new Error(`Unhandled codec: ${W}`);const ye=new globalThis.DecompressionStream(he);return new Response(new Blob([N]).stream().pipeThrough(ye)).arrayBuffer().then(Me=>new Uint8Array(Me))}(R,C).then(N=>(function(W,X){W.readFields(uV,X)}(new eb(N),P),new AV[E](P.buffer))),k.then(N=>{for(let W=w.length-1;W>=0;W--)switch(w[W]){case"delta_filter":fV(N,O);break;case"zigzag_filter":dV(N);break;case"bitshuffle_filter":pV(N,E);break;default:throw new Dc(`Unhandled filter "${w[W]}"`)}return{layerName:m,blockIndex:D,data:N}}).catch(N=>{throw N})}))},kn(ZO,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var v_={workerUrl:"",workerClass:null,workerParams:void 0};const nb="mapboxgl_preloaded_worker_pool";class x_{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<x_.workerCount;)this.workers.push(v_.workerClass!=null?new v_.workerClass:new self.Worker(v_.workerUrl,v_.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[nb]}numActive(){return Object.keys(this.active).length}}let b_;function Nv(){return b_||(b_=new x_),b_}x_.workerCount=2;let w_,rb,Mh,Dm,ib,zm=null;function XO(){return vi()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:rb||re.DRACO_URL}function KO(){if(vi()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Dm)return Dm;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Dm=WebAssembly.validate(u)?re.MESHOPT_SIMD_URL:re.MESHOPT_URL,Dm}const jv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},MV={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},S_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function YO(u,n,s){const c=s.json.bufferViews.length,m=s.buffers.length;n.bufferView=c,s.json.bufferViews[c]={buffer:m,byteLength:u.byteLength},s.buffers[m]=u}const ob="KHR_draco_mesh_compression";function IV(u,n){const s=u.extensions&&u.extensions[ob];if(!s)return;const c=new Mh.Decoder,m=tk(n,s.bufferView),f=new Mh.Mesh;if(!c.DecodeArrayToMesh(m,m.byteLength,f))throw new Error("Failed to decode Draco mesh");const g=n.json.accessors[u.indices],E=jv[g.componentType],O=g.count*E.BYTES_PER_ELEMENT,D=Mh._malloc(O);E===Uint16Array?c.GetTrianglesUInt16Array(f,O,D):c.GetTrianglesUInt32Array(f,O,D),YO(Mh.memory.buffer.slice(D,D+O),g,n),Mh._free(D);for(const w of Object.keys(s.attributes)){const C=c.GetAttributeByUniqueId(f,s.attributes[w]),R=n.json.accessors[u.attributes[w]],P=MV[R.componentType],k=R.count*S_[R.type]*jv[R.componentType].BYTES_PER_ELEMENT,N=Mh._malloc(k);c.GetAttributeDataArrayForAllPoints(f,C,Mh[P],k,N),YO(Mh.memory.buffer.slice(N,N+k),R,n),Mh._free(N)}c.destroy(),f.destroy(),delete u.extensions[ob]}const $v="EXT_meshopt_compression";function CV(u,n){if(!u.extensions||!u.extensions[$v])return;const s=u.extensions[$v],c=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),m=new Uint8Array(s.count*s.byteStride);ib.decodeGltfBuffer(m,s.count,s.byteStride,c,s.mode,s.filter),u.buffer=n.buffers.length,u.byteOffset=0,n.buffers[u.buffer]=m.buffer,delete u.extensions[$v]}const JO=1179937895,QO=new TextDecoder("utf8");function ek(u,n){return new URL(u,n).href}function OV(u,n,s,c){return fetch(ek(u.uri,c)).then(m=>m.arrayBuffer()).then(m=>{n.buffers[s]=m})}function tk(u,n){const s=u.json.bufferViews[n];return new Uint8Array(u.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function kV(u,n,s,c){if(u.uri){const m=ek(u.uri,c);return fetch(m).then(f=>f.blob()).then(f=>createImageBitmap(f)).then(f=>{n.images[s]=f})}if(u.bufferView!==void 0){const m=tk(n,u.bufferView),f=new Blob([m],{type:u.mimeType});return createImageBitmap(f).then(g=>{n.images[s]=g})}}function nk(u,n=0,s){const c={json:null,images:[],buffers:[]};if(new Uint32Array(u,n,1)[0]===JO){const w=new Uint32Array(u,n);let C=2;const R=(w[C++]>>2)-3,P=w[C++]>>2;if(C++,c.json=JSON.parse(QO.decode(w.subarray(C,C+P))),C+=P,C<R){const k=w[C++];C++;const N=n+(C<<2);c.buffers[0]=u.slice(N,N+k)}}else c.json=JSON.parse(QO.decode(new Uint8Array(u,n)));const{buffers:m,images:f,meshes:g,extensionsUsed:E,bufferViews:O}=c.json;let D=Promise.resolve();if(m){const w=[];for(let C=0;C<m.length;C++){const R=m[C];R.uri?w.push(OV(R,c,C,s)):c.buffers[C]||(c.buffers[C]=null)}D=Promise.all(w)}return D.then(()=>{const w=[],C=E&&E.includes(ob),R=E&&E.includes($v);if(C&&w.push(function(){if(!Mh)return w_??(w_=function(P){let k,N=null;function W(){k=new Uint8Array(N.buffer)}function X(){throw new Error("Unexpected Draco error.")}const ee={a:{a:X,d:function(ne,J,he){return k.copyWithin(ne,J,J+he)},c:function(ne){const J=k.length,he=Math.max(ne>>>0,Math.ceil(1.2*J)),ye=Math.ceil((he-J)/65536);try{return N.grow(ye),W(),!0}catch{return!1}},b:X}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(P,ee):P.then(ne=>ne.arrayBuffer()).then(ne=>WebAssembly.instantiate(ne,ee))).then(ne=>{const{Rb:J,Qb:he,P:ye,T:Me,X:Ve,Ja:Ne,La:$e,Qa:ot,Va:je,Wa:nt,eb:ct,jb:ht,f:_t,e:At,yb:It,zb:wt,Ab:Xt,Bb:pn,Db:Ut,Gb:Fn}=ne.instance.exports;N=At;const An=(()=>{let xn=0,cn=0,ur=0,zn=0;return qn=>{ur&&(J(zn),J(xn),cn+=ur,ur=xn=0),xn||(cn+=128,xn=he(cn));const Lr=qn.length+7&-8;let Xr=xn;Lr>=cn&&(ur=Lr,Xr=zn=he(Lr));for(let ei=0;ei<qn.length;ei++)k[Xr+ei]=qn[ei];return Xr}})();return W(),_t(),{memory:At,_free:J,_malloc:he,Mesh:class{constructor(){this.ptr=ye()}destroy(){Me(this.ptr)}},Decoder:class{constructor(){this.ptr=Ne()}destroy(){ht(this.ptr)}DecodeArrayToMesh(xn,cn,ur){const zn=An(xn),qn=$e(this.ptr,zn,cn,ur.ptr);return!!Ve(qn)}GetAttributeByUniqueId(xn,cn){return{ptr:ot(this.ptr,xn.ptr,cn)}}GetTrianglesUInt16Array(xn,cn,ur){je(this.ptr,xn.ptr,cn,ur)}GetTrianglesUInt32Array(xn,cn,ur){nt(this.ptr,xn.ptr,cn,ur)}GetAttributeDataArrayForAllPoints(xn,cn,ur,zn,qn){ct(this.ptr,xn.ptr,cn.ptr,ur,zn,qn)}},DT_INT8:It(),DT_UINT8:wt(),DT_INT16:Xt(),DT_UINT16:pn(),DT_UINT32:Ut(),DT_FLOAT32:Fn()}})}(fetch(XO())),w_.then(P=>{Mh=P,w_=void 0}))}()),R&&w.push(function(){if(ib)return;const P=function(k){let N;const W=WebAssembly.instantiateStreaming(k,{}).then(ne=>{N=ne.instance,N.exports.__wasm_call_ctors()}),X={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ee={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(ne,J,he,ye,Me,Ve){(function(Ne,$e,ot,je,nt,ct,ht){const _t=Ne.exports.sbrk,At=je+3&-4,It=_t(At*nt),wt=_t(ct.length),Xt=new Uint8Array(Ne.exports.memory.buffer);Xt.set(ct,wt);const pn=$e(It,je,nt,wt,ct.length);if(pn===0&&ht&&ht(It,At,nt),ot.set(Xt.subarray(It,It+je*nt)),_t(It-_t(0)),pn!==0)throw new Error(`Malformed buffer data: ${pn}`)})(N,N.exports[ee[Me]],ne,J,he,ye,N.exports[X[Ve]])}}}(fetch(KO()));return P.ready.then(()=>{ib=P})}()),f)for(let P=0;P<f.length;P++)w.push(kV(f[P],c,P,s));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(C&&g)for(const{primitives:P}of g)for(const k of P)IV(k,c);if(R&&g&&O)for(const P of O)CV(P,c);return c})})}function Sp(u,n){const s=u.json.bufferViews[n.bufferView],c=jv[n.componentType];return new c(u.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==S_[n.type]*c.BYTES_PER_ELEMENT?s.byteStride/c.BYTES_PER_ELEMENT:S_[n.type]))}function ab(u,n,s,c){const m=jv[n.componentType],f=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),g=u.json.bufferViews[n.bufferView],E=g.byteStride?g.byteStride/m.BYTES_PER_ELEMENT:S_[n.type],O=s.float32,D=O.length/s.capacity;for(let w=0,C=0;w<n.count*E;w+=E,C+=D)for(let R=0;R<D;R++)O[C+R]=c[w+R]*f;s._trim()}function RV(u,n,s){const c=u.indices,m=u.attributes,f={};f.indexArray=new po;const g=n.json.accessors[c],E=g.count/3;f.indexArray.reserve(E);const O=Sp(n,g);for(let R=0;R<E;R++)f.indexArray.emplaceBack(O[3*R],O[3*R+1],O[3*R+2]);f.indexArray._trim(),f.vertexArray=new Cl;const D=n.json.accessors[m.POSITION];f.vertexArray.reserve(D.count);const w=Sp(n,D);for(let R=0;R<D.count;R++)f.vertexArray.emplaceBack(w[3*R],w[3*R+1],w[3*R+2]);if(f.vertexArray._trim(),f.aabb=new pi(D.min,D.max),f.centroid=function(R,P){const k=[0,0,0],N=R.length;if(N>0){for(let W=0;W<N;W++){const X=3*R[W];k[0]+=P[X],k[1]+=P[X+1],k[2]+=P[X+2]}k[0]/=N,k[1]/=N,k[2]/=N}return k}(O,w),m.COLOR_0!==void 0){const R=n.json.accessors[m.COLOR_0],P=S_[R.type],k=Sp(n,R);f.colorArray=P===3?new Cl:new Il,f.colorArray.resize(R.count),ab(n,R,f.colorArray,k)}if(m.NORMAL!==void 0){f.normalArray=new Cl;const R=n.json.accessors[m.NORMAL];f.normalArray.resize(R.count);const P=Sp(n,R);ab(n,R,f.normalArray,P)}if(m.TEXCOORD_0!==void 0&&s.length>0){f.texcoordArray=new Cc;const R=n.json.accessors[m.TEXCOORD_0];f.texcoordArray.resize(R.count);const P=Sp(n,R);ab(n,R,f.texcoordArray,P)}if(m._FEATURE_ID_RGBA4444!==void 0){const R=n.json.accessors[m._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(f.featureData=Sp(n,R))}m._FEATURE_RGBA4444!==void 0&&(f.featureData=new Uint32Array(Sp(n,n.json.accessors[m._FEATURE_RGBA4444]).buffer));const C=u.material;return f.material=function(R,P){const{emissiveFactor:k=[0,0,0],alphaMode:N="OPAQUE",alphaCutoff:W=.5,normalTexture:X,occlusionTexture:ee,emissiveTexture:ne,doubleSided:J}=R,{baseColorFactor:he=[1,1,1,1],metallicFactor:ye=1,roughnessFactor:Me=1,baseColorTexture:Ve,metallicRoughnessTexture:Ne}=R.pbrMetallicRoughness||{},$e=ee?P[ee.index]:void 0;if(ee&&ee.extensions&&ee.extensions.KHR_texture_transform&&$e){const ot=ee.extensions.KHR_texture_transform;$e.offsetScale=[ot.offset[0],ot.offset[1],ot.scale[0],ot.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Pr(...he),metallicFactor:ye,roughnessFactor:Me,baseColorTexture:Ve?P[Ve.index]:void 0,metallicRoughnessTexture:Ne?P[Ne.index]:void 0},doubleSided:J,emissiveFactor:k,alphaMode:N,alphaCutoff:W,normalTexture:X?P[X.index]:void 0,occlusionTexture:$e,emissionTexture:ne?P[ne.index]:void 0,defined:R.defined===void 0}}(C!==void 0?n.json.materials[C]:{defined:!1},s),f}function rk(u,n,s){const{matrix:c,rotation:m,translation:f,scale:g,mesh:E,extras:O,children:D}=u,w={};if(w.matrix=c||Ke.mat4.fromRotationTranslationScale([],m||[0,0,0,1],f||[0,0,0],g||[1,1,1]),E!==void 0){w.meshes=s[E];const C=w.anchor=[0,0];for(const R of w.meshes){const{min:P,max:k}=R.aabb;C[0]+=P[0]+k[0],C[1]+=P[1]+k[1]}C[0]=Math.floor(C[0]/w.meshes.length/2),C[1]=Math.floor(C[1]/w.meshes.length/2)}if(O&&(O.id&&(w.id=O.id),O.lights&&(w.lights=function(C){if(!C.length)return[];const R=function(X){const ee=atob(X),ne=new Uint8Array(ee.length);for(let J=0;J<ee.length;J++)ne[J]=ee.codePointAt(J);return ne}(C),P=[],k=R.length/24,N=new Uint16Array(R.buffer),W=new Float32Array(R.buffer);for(let X=0;X<k;X++){const ee=N[2*X*6]/30,ne=N[2*X*6+1]/30,J=N[2*X*6+10]/100,he=W[6*X+1],ye=W[6*X+2],Me=W[6*X+3],Ve=W[6*X+4],Ne=Me-he,$e=Ve-ye,ot=Math.hypot(Ne,$e);P.push({pos:[he+.5*Ne,ye+.5*$e,ne],normal:[$e/ot,-Ne/ot,0],width:ot,height:ee,depth:J,points:[he,ye,Me,Ve]})}return P}(O.lights))),D){const C=[];for(const R of D)C.push(rk(n.json.nodes[R],n,s));w.children=C}return w}function LV(u){if(u.vertices.length===0||u.indices.length===0)return null;const n=new qt(u.vertices,u.indices,8,256),[s,c]=[n.min.clone(),n.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:n,min:s,max:c}}function DV(u){if(!u.extras||!u.extras.ground)return null;const n=u.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const c=[];for(const g of s){if(!Array.isArray(g)||g.length!==2)continue;const E=g[0],O=g[1];typeof E=="number"&&typeof O=="number"&&c.push(new Yt(E,O))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let m=0;for(let g=0;g<c.length;g++){const E=c[g],O=c[(g+1)%c.length],D=c[(g+2)%c.length];m+=(E.x-O.x)*(D.y-O.y)-(D.x-O.x)*(E.y-O.y)}m>0&&c.reverse();const f=Jh(c.flatMap(g=>[g.x,g.y]),[]);return f.length===0?null:{vertices:c,indices:f}}function zV(u,n){const s=[],c=[];let m=0;const f=[];for(const g of u){m=s.length;const E=g.vertexArray.float32,O=g.indexArray.uint16;for(let D=0;D<g.vertexArray.length;D++)f[0]=E[3*D+0],f[1]=E[3*D+1],f[2]=E[3*D+2],Ke.vec3.transformMat4(f,f,n),s.push(new Yt(f[0],f[1]));for(let D=0;D<3*g.indexArray.length;D++)c.push(O[D]+m)}if(c.length%3!=0)return null;for(let g=0;g<c.length;g+=3){const E=s[c[g+0]],O=s[c[g+1]],D=s[c[g+2]];(E.x-O.x)*(D.y-O.y)-(D.x-O.x)*(E.y-O.y)>0&&([c[g+1],c[g+2]]=[c[g+2],c[g+1]])}return{vertices:s,indices:c}}function ik(u){const n=function(O,D){const w=[],C=WebGL2RenderingContext;if(O.json.textures)for(const R of O.json.textures){const P={magFilter:C.LINEAR,minFilter:C.NEAREST,wrapS:C.REPEAT,wrapT:C.REPEAT};R.sampler!==void 0&&Object.assign(P,O.json.samplers[R.sampler]),w.push({image:D[R.source],sampler:P,uploaded:!1})}return w}(u,u.images),s=function(O,D){const w=[];for(const C of O.json.meshes){const R=[];for(const P of C.primitives)R.push(RV(P,O,D));w.push(R)}return w}(u,n),{scenes:c,scene:m,nodes:f}=u.json,g=c?c[m||0].nodes:f,E=[];for(const O of g)E.push(rk(f[O],u,s));return function(O,D,w){const C={},R=new Set;for(let P=0;P<O.length;P++){const k=w[D[P]];if(!k.extras)continue;const N=k.extras["mapbox:footprint:version"],W=k.extras["mapbox:footprint:id"];(N||W)&&R.add(P),N==="1.0.0"&&W&&(C[W]=P)}for(let P=0;P<O.length;P++){if(R.has(P))continue;const k=O[P],N=w[D[P]];if(!N.extras)continue;let W=null;k.id in C&&(W=zV(O[C[k.id]].meshes,k.matrix)),W||(W=DV(N)),W&&(k.footprint=LV(W))}if(R.size>0){const P=Array.from(R.values()).sort((k,N)=>k-N);for(let k=P.length-1;k>=0;k--)O.splice(P[k],1)}}(E,g,u.json.nodes),E}function FV(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const n=u.vertexArray.float32,s=u.aabb.min[0]-1,c=u.aabb.min[1]-1,m=bp/(u.aabb.max[0]-s+2),f=bp/(u.aabb.max[1]-c+2);for(let g=0;g<n.length;g+=3){const E=n[g+2],O=(n[g+0]-s)*m|0,D=(n[g+1]-c)*f|0;E>u.heightmap[D*bp+O]&&(u.heightmap[D*bp+O]=E)}}function BV(u,n){const s={};s.indexArray=new po,s.indexArray.reserve(4*u.length),s.vertexArray=new Cl,s.vertexArray.reserve(10*u.length),s.colorArray=new Il,s.vertexArray.reserve(10*u.length);let c=0;for(const g of u){const E=Math.min(10,Math.max(4,1.3*g.height))*n,O=[-g.normal[1],g.normal[0],0],D=Math.min(.29,.1*g.width/g.depth),w=g.width-2*g.depth*n*(D+.01),C=Ke.vec3.scaleAndAdd([],g.pos,O,w/2),R=Ke.vec3.scaleAndAdd([],g.pos,O,-w/2),P=[C[0],C[1],C[2]+g.height],k=[R[0],R[1],R[2]+g.height],N=Ke.vec3.scaleAndAdd([],g.normal,O,D);Ke.vec3.scale(N,N,E);const W=Ke.vec3.scaleAndAdd([],g.normal,O,-D);Ke.vec3.scale(W,W,E),Ke.vec3.add(N,C,N),Ke.vec3.add(W,R,W),C[2]+=.1,R[2]+=.1,s.vertexArray.emplaceBack(N[0],N[1],N[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]),s.vertexArray.emplaceBack(C[0],C[1],C[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(k[0],k[1],k[2]),s.vertexArray.emplaceBack(C[0],C[1],C[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(N[0],N[1],N[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]);const X=w/E/2;s.colorArray.emplaceBack(-X-D,-1,X,.8),s.colorArray.emplaceBack(X+D,-1,X,.8),s.colorArray.emplaceBack(-X,0,X,1.3),s.colorArray.emplaceBack(X,0,X,1.3),s.colorArray.emplaceBack(X+D,-.8,X,.7),s.colorArray.emplaceBack(X+D,-.8,X,.7),s.colorArray.emplaceBack(0,0,X,1.3),s.colorArray.emplaceBack(0,0,X,1.3),s.colorArray.emplaceBack(X+D,-1.2,X,.8),s.colorArray.emplaceBack(X+D,-1.2,X,.8),s.indexArray.emplaceBack(6+c,4+c,8+c),s.indexArray.emplaceBack(7+c,9+c,5+c),s.indexArray.emplaceBack(0+c,1+c,2+c),s.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const m={defined:!0,emissiveFactor:[0,0,0]},f={};return f.baseColorFactor=Pr.white,m.pbrMetallicRoughness=f,s.material=m,s.aabb=new pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class ok{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const c=n[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}class ak{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new _u(En,16,0),this.featureIndexArray=new cm,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,s,c,m,f,g=0,E=0){const O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,m,f,g);const D=this.grid;for(let w=0;w<s.length;w++){const C=s[w],R=[1/0,1/0,-1/0,-1/0];for(let P=0;P<C.length;P++){const k=C[P];R[0]=Math.min(R[0],k.x),R[1]=Math.min(R[1],k.y),R[2]=Math.max(R[2],k.x),R[3]=Math.max(R[3],k.y)}E!==0&&(R[0]-=E,R[1]-=E,R[2]+=E,R[3]+=E),R[0]<En&&R[1]<En&&R[2]>=0&&R[3]>=0&&D.insert(O,R[0],R[1],R[2],R[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Em.VectorTile(new gv(this.rawTileData)).layers,this.sourceLayerCoder=new ok(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,c){this.loadVTLayers(),this.serializedLayersCache.clear();const m=Vh(n.filter),f=n.tileResult,g=n.transform,E=f.bufferedTilespaceBounds,O=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(R,P,k,N)=>Si(f.bufferedTilespaceGeometry,R,P,k,N));O.sort(NV);let D=null;g.elevation&&O.length>0&&(D=km.create(g.elevation,this.tileID));const w={};let C;for(let R=0;R<O.length;R++){const P=O[R];if(P===C)continue;C=P;const k=this.featureIndexArray.get(P);let N=null;if(this.is3DTile){const W=this.bucketLayerIDs[0][0],X=s[W];if(X.type!=="model")continue;const{queryFeature:ee,intersectionZ:ne}=X.queryIntersectsMatchingFeature(f,k.featureIndex,m,g);ee&&this.appendToResult(w,W,k.featureIndex,ee,ne)}else this.loadMatchingFeature(w,k,m,n.layers,n.availableImages,s,c,(W,X,ee,ne=0)=>(N||(N=yt(W,this.tileID.canonical,n.tileTransform)),X.queryIntersectsFeature(f,W,ee,N,this.z,n.transform,n.pixelPosMatrix,D,ne)))}return w}loadMatchingFeature(n,s,c,m,f,g,E,O){const{featureIndex:D,bucketIndex:w,sourceLayerIndex:C,layoutVertexArrayOffset:R}=s,P=this.bucketLayerIDs[w];if(m.length&&!function(X,ee){for(let ne=0;ne<X.length;ne++)if(ee.indexOf(X[ne])>=0)return!0;return!1}(m,P))return;const k=this.sourceLayerCoder.decode(C),N=this.vtLayers[k].feature(D);if(c.needGeometry){const X=Qt(N,!0);if(!c.filter(new Po(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!c.filter(new Po(this.tileID.overscaledZ),N))return;const W=this.getId(N,k);for(let X=0;X<P.length;X++){const ee=P[X];if(m.length&&m.indexOf(ee)<0)continue;const ne=g[ee];if(!ne)continue;let J={};W!==void 0&&E&&(J=E.getState(ne.sourceLayer||"_geojsonTileLayer",W));const he=!O||O(N,ne,J,R);if(!he)continue;const ye=new m_(N,this.z,this.x,this.y,W);let Me=this.serializedLayersCache.get(ee);Me||(Me=ne.serialize(),Me.id=ee,this.serializedLayersCache.set(ee,Me)),ye.layer=Fi({},Me),ye.tile=this.tileID.canonical,ye.layer.paint=sk(Me.paint,ne.paint,N,J,f),ye.layer.layout=sk(Me.layout,ne.layout,N,J,f),this.appendToResult(n,ee,D,ye,he)}}appendToResult(n,s,c,m,f){let g=n[s];g===void 0&&(g=n[s]=[]),g.push({featureIndex:c,feature:m,intersectionZ:f})}lookupSymbolFeatures(n,s,c,m,f,g,E){const O={};this.loadVTLayers();const D=Vh(m);for(const w of n)this.loadMatchingFeature(O,{bucketIndex:s,sourceLayerIndex:c,featureIndex:w,layoutVertexArrayOffset:0},D,f,g,E);return O}loadFeature(n){const{featureIndex:s,sourceLayerIndex:c}=n;this.loadVTLayers();const m=this.sourceLayerCoder.decode(c),f=this.vtFeatures[m];if(f[s])return f[s];const g=this.vtLayers[m].feature(s);return f[s]=g,g}hasLayer(n){for(const s of this.bucketLayerIDs)for(const c of s)if(n===c)return!0;return!1}getId(n,s){let c=n.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];m!=null&&(c=n.properties[m]),typeof c=="boolean"&&(c=Number(c))}return c}}function sk(u,n,s,c,m){return Lo(u,(f,g)=>{const E=n instanceof wc?n.get(g):null;return E&&E.evaluate?E.evaluate(s,c,m):E})}function NV(u,n){return n-u}kn(ak,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const lk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class sb{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=c>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const f=lk[15&c];if(!f)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new sb(E,g,f,n)}constructor(n,s=64,c=Float64Array,m){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const f=lk.indexOf(this.ArrayType),g=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-E%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${c}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+O,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+g+E+O),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+O,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=s,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return lb(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,c,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:E}=this,O=[0,f.length-1,0],D=[];for(;O.length;){const w=O.pop()||0,C=O.pop()||0,R=O.pop()||0;if(C-R<=E){for(let W=R;W<=C;W++){const X=g[2*W],ee=g[2*W+1];X>=n&&X<=c&&ee>=s&&ee<=m&&D.push(f[W])}continue}const P=R+C>>1,k=g[2*P],N=g[2*P+1];k>=n&&k<=c&&N>=s&&N<=m&&D.push(f[P]),(w===0?n<=k:s<=N)&&(O.push(R),O.push(P-1),O.push(1-w)),(w===0?c>=k:m>=N)&&(O.push(P+1),O.push(C),O.push(1-w))}return D}within(n,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:f,nodeSize:g}=this,E=[0,m.length-1,0],O=[],D=c*c;for(;E.length;){const w=E.pop()||0,C=E.pop()||0,R=E.pop()||0;if(C-R<=g){for(let W=R;W<=C;W++)ck(f[2*W],f[2*W+1],n,s)<=D&&O.push(m[W]);continue}const P=R+C>>1,k=f[2*P],N=f[2*P+1];ck(k,N,n,s)<=D&&O.push(m[P]),(w===0?n-c<=k:s-c<=N)&&(E.push(R),E.push(P-1),E.push(1-w)),(w===0?n+c>=k:s+c>=N)&&(E.push(P+1),E.push(C),E.push(1-w))}return O}}function lb(u,n,s,c,m,f){if(m-c<=s)return;const g=c+m>>1;uk(u,n,g,c,m,f),lb(u,n,s,c,g-1,1-f),lb(u,n,s,g+1,m,1-f)}function uk(u,n,s,c,m,f){for(;m>c;){if(m-c>600){const D=m-c+1,w=s-c+1,C=Math.log(D),R=.5*Math.exp(2*C/3),P=.5*Math.sqrt(C*R*(D-R)/D)*(w-D/2<0?-1:1);uk(u,n,s,Math.max(c,Math.floor(s-w*R/D+P)),Math.min(m,Math.floor(s+(D-w)*R/D+P)),f)}const g=n[2*s+f];let E=c,O=m;for(T_(u,n,c,s),n[2*m+f]>g&&T_(u,n,c,m);E<O;){for(T_(u,n,E,O),E++,O--;n[2*E+f]<g;)E++;for(;n[2*O+f]>g;)O--}n[2*c+f]===g?T_(u,n,c,O):(O++,T_(u,n,O,m)),O<=s&&(c=O+1),s<=O&&(m=O-1)}}function T_(u,n,s,c){ub(u,s,c),ub(n,2*s,2*c),ub(n,2*s+1,2*c+1)}function ub(u,n,s){const c=u[n];u[n]=u[s],u[s]=c}function ck(u,n,s,c){const m=u-s,f=n-c;return m*m+f*f}o.$=Tf,o.A=class extends Dv{},o.B=ls,o.C=Hr,o.D=dd,o.E=So,o.F=Io,o.G=El,o.H=Do,o.I=k1,o.J=ah,o.K=Us,o.L=Wu,o.M=sh,o.N=pl,o.O=zs,o.P=Yt,o.Q=fc,o.R=ci,o.S=wa,o.T=q1,o.U=Ba,o.V=Dv,o.W=yu,o.X=mu,o.Y=Hu,o.Z=function(u){const n=u.value;let s=[];if(!n)return s;const c=ls(n);return c!=="string"?(s=s.concat([new Dv(u.key,n,`string expected, "${c}" found`)]),s):(bO(n,!0)||(s=s.concat([new Dv(u.key,n,`invalid url "${n}"`)])),s)},o._=Et,o.a=function(u){return re.API_CDN_URL_REGEX.test(u)},o.a$=xu,o.a0=Ni,o.a1=vn,o.a2=class{constructor(u){this.specification=u}possiblyEvaluate(u,n){return Di(u.expression.evaluate(n))}interpolate(u,n,s){return{x:Yn(u.x,n.x,s),y:Yn(u.y,n.y,s),z:Yn(u.z,n.z,s),azimuthal:Yn(u.azimuthal,n.azimuthal,s),polar:Yn(u.polar,n.polar,s)}}},o.a3=Po,o.a4=yc,o.a5=ft,o.a6=Ke,o.a7=qo,o.a8=wc,o.a9=Ll,o.aA=ni,o.aB=lO,o.aC=pO,o.aD=sO,o.aE=function(u,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let c=0;c<u.length;c++){const m=document.createElement("source");lo(u[c])||(s.crossOrigin="Anonymous"),m.src=u[c],s.appendChild(m)}return{cancel:()=>{}}},o.aF=Cv,o.aG=function(u){return fetch(u).then(n=>n.arrayBuffer()).then(n=>nk(n,0,u))},o.aH=ik,o.aI=class{constructor(u,n,s,c){this.id=u,this.position=n!=null?new q(n[0],n[1]):new q(0,0),this.orientation=s??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,n){if(Ke.mat4.multiply(u.matrix,n,u.matrix),u.meshes)for(const s of u.meshes){const c=pi.applyTransformFast(s.aabb,u.matrix);this.aabb.encapsulate(c)}if(u.children)for(const s of u.children)this._applyTransformations(s,u.matrix)}computeBoundsAndApplyParent(){const u=Ke.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,u)}computeModelMatrix(u,n,s,c,m,f,g=!1){AO(this.matrix,this,u.transform,this.position,n,s,c,m,f,g)}upload(u){if(!this.uploaded){for(const n of this.nodes)X1(n,u);for(const n of this.nodes)zv(n);this.uploaded=!0}}destroy(){for(const u of this.nodes)K1(u)}},o.aJ=za,o.aK=function(u){return u.indexOf(Ql)>=0},o.aL=l_,o.aM=ze,o.aN=Ue,o.aO=Oo,o.aP=po,o.aQ=ta,o.aR=Lf,o.aS=Mv,o.aT=function(){il.isLoading()||il.isLoaded()||fh()!=="deferred"||Sf()},o.aU=Vh,o.aV=Qt,o.aW=m_,o.aX=bi,o.aY=S1,o.aZ=xr,o.a_=yt,o.aa=Yn,o.ab=En,o.ac=Wo,o.ad=class{constructor(u){this.specification=u}possiblyEvaluate(u,n){return function([s,c]){const m=Di([1,s,c]);return{x:m.x,y:m.y,z:m.z}}(u.expression.evaluate(n))}interpolate(u,n,s){return{x:Yn(u.x,n.x,s),y:Yn(u.y,n.y,s),z:Yn(u.z,n.z,s)}}},o.ae=function(u,n,s=0,c=!0){const m=new Yt(s,s),f=u.sub(m),g=n.add(m),E=[f,new Yt(g.x,f.y),g,new Yt(f.x,g.y)];return c&&E.push(f.clone()),E},o.af=function(u,n){const s=[];for(let c=0;c<u.length;c++){const m=ea(c-1,-1,u.length-1),f=ea(c+1,-1,u.length-1),g=u[c],E=u[f],O=u[m].sub(g).unit(),D=E.sub(g).unit(),w=D.angleWithSep(O.x,O.y),C=O.add(D).unit().mult(-1*n/Math.sin(w/2));s.push(g.add(C))}return s},o.ag=WC,o.ah=Si,o.ai=function(u,n,s=0){return Ke.vec3.fromValues(((n.x-s)*u.scale-u.x)*En,(n.y*u.scale-u.y)*En,ke(n.z,n.y))},o.aj=ys,o.ak=fC,o.al=function(u){let n=1/0,s=1/0,c=-1/0,m=-1/0;for(const f of u)n=Math.min(n,f.x),s=Math.min(s,f.y),c=Math.max(c,f.x),m=Math.max(m,f.y);return{min:new Yt(n,s),max:new Yt(c,m)}},o.am=_e,o.an=si,o.ao=at,o.ap=lr,o.aq=Ya,o.ar=function(u,n){const s={};for(let c=0;c<n.length;c++){const m=n[c];m in u&&(s[m]=u[m])}return s},o.as=Y,o.at=Te,o.au=class{constructor(u){this.entries={},this.scheduler=u}request(u,n,s,c){const m=this.entries[u]=this.entries[u]||{callbacks:[]};if(m.result){const[f,g]=m.result;return this.scheduler?this.scheduler.add(()=>{c(f,g)},n):c(f,g),()=>{}}return m.callbacks.push(c),m.cancel||(m.cancel=s((f,g)=>{m.result=[f,g];for(const E of m.callbacks)this.scheduler?this.scheduler.add(()=>{E(f,g)},n):E(f,g);setTimeout(()=>delete this.entries[u],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(f=>f!==c),m.callbacks.length||(m.cancel(),delete this.entries[u]))}}},o.av=qh,o.aw=function(u,n,s){const c=JSON.stringify(u.request);return u.data&&(this.deduped.entries[c]={result:[null,u.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},m=>{const f=xa(u.request,(g,E,O,D)=>{g?m(g):E&&m(null,{vectorTile:s?void 0:new Em.VectorTile(new gv(E)),rawData:E,cacheControl:O,expires:D})});return()=>{f.cancel(),m()}},n)},o.ax=function(u){nr++,nr>In&&(u.getActor().send("enforceCacheSizeLimit",Tn),nr=0)},o.ay=Tt,o.az=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},o.b=function(u){return re.API_FONTS_REGEX.test(u)},o.b$=os,o.b0=yd,o.b1=_s,o.b2=$o,o.b3=Jh,o.b4=$1,o.b5=function(u,n){const s=Ll(n.zoom);if(s===0)return qs(u);const c=Md(u),m=bh(c),f=_e(c.getWest())*n.worldSize,g=_e(c.getEast())*n.worldSize,E=Te(c.getNorth())*n.worldSize,O=Te(c.getSouth())*n.worldSize,D=[f,E,0],w=[g,E,0],C=[f,O,0],R=[g,O,0],P=Ke.mat4.invert([],n.globeMatrix);return Ke.vec3.transformMat4(D,D,P),Ke.vec3.transformMat4(w,w,P),Ke.vec3.transformMat4(C,C,P),Ke.vec3.transformMat4(R,R,P),m[0]=Rc(m[0],C,s),m[1]=Rc(m[1],R,s),m[2]=Rc(m[2],w,s),m[3]=Rc(m[3],D,s),pi.fromPoints(m)},o.b6=$f,o.b7=Id,o.b8=Rc,o.b9=bu,o.bA=Pr,o.bB=ea,o.bC=sr,o.bD=Fo,o.bE=we,o.bF=function(u,n,s){u[4*n+0]=s[0],u[4*n+1]=s[1],u[4*n+2]=s[2],u[4*n+3]=s[3]},o.bG=Wh,o.bH=Ol,o.bI=Bf,o.bJ=Uo,o.bK=Yu,o.bL=q,o.bM=JC,o.bN=xi,o.bO=Ja,o.bP=gO,o.bQ=Qi,o.bR=Zh,o.bS=function(u,n,s,c,m,f,g,E,O){if(O.name==="globe")return Zh(u,n,new Qi(s,c,m),!1);const D=l_({z:s,x:c,y:m},O);return new pi([(f+D.x/D.scale)*n,n*(D.y/D.scale),g],[(f+D.x2/D.scale)*n,n*(D.y2/D.scale),E])},o.bT=function(u,n,s){let c=0;for(let m=0;m<2;++m)u[m]>0&&(c+=(u[m]-0)*(u[m]-0)),n[m]<0&&(c+=(0-n[m])*(0-n[m]));return c},o.bU=He,o.bV=d,o.bW=function(u){const n=Ke.mat4.identity(new Float64Array(16));Ke.mat4.multiply(n,u.pixelMatrix,u.globeMatrix);const s=[0,x,0],c=[0,T,0];return Ke.vec3.transformMat4(s,s,n),Ke.vec3.transformMat4(c,c,n),[s[0]>0&&s[0]<=u.width&&s[1]>0&&s[1]<=u.height&&!Xh(u,new q(u.center.lat,90)),c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!Xh(u,new q(u.center.lat,-90))]},o.bX=function(u,n){const{scale:s}=u.tileTransform,c=s*En/(u.tileSize*Math.pow(2,n.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return Ke.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[c,c])},o.bY=Rv,o.bZ=mO,o.b_=function(u){const n=mO(u,!0);return Ke.mat2.invert([],[n[0],n[1],n[4],n[5]])},o.ba=pa,o.bb=tb,o.bc=gv,o.bd=xa,o.be=function(u){const n=[];for(const s in u)n.push(u[s]);return n},o.bf=function(u,n){const s=[];for(const c in u)c in n||s.push(c);return s},o.bg=la,o.bh=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.bi=Mr,o.bj=function(u,n){const{x:s,y:c}=u.point,m=Gg(s,c,u.worldSize/u._pixelsPerMercatorPixel,0,0);return Ke.mat4.multiply(m,m,Ug(qs(n)))},o.bk=Am,o.bl=Ju,o.bm=mv,o.bn=function(u,n,s,c,m){const f=5*n+2;u.float32[f+0]=s,u.float32[f+1]=c,u.float32[f+2]=m},o.bo=Pv,o.bp=zC,o.bq=en,o.br=Gs,o.bs=BI,o.bt=xO,o.bu=VI,o.bv=qI,o.bw=D1,o.bx=VC,o.by=O1,o.bz=sb,o.c=de,o.c$=Vi,o.c0=function(u){const{x:n,y:s}=u.point,{lng:c,lat:m}=u._center;return Gg(n,s,u.worldSize,c,m)},o.c1=_i,o.c2=di,o.c3=pp,o.c4=function(u){const n=Math.round((u+45+360)%360/90)%4;return Wi[n]},o.c5=45,o.c6=ge,o.c7=Sd,o.c8=function(u,n,s){const c=Math.sqrt(u*u+n*n+s*s),m=c>0?Math.acos(s/c)*Ar:0;let f=u!==0||n!==0?Math.atan2(-n,-u)*Ar+90:0;return f<0&&(f+=360),[c,f,m]},o.c9=it,o.cA=function(u){const n=He-5;u=lr(u,-n,n)/n*90;const s=Math.pow(Math.abs(Math.sin(sr(u))),3);return Math.round(s*(p.length-1))},o.cB=function(u,n,s,c){const m=n.getNorth(),f=n.getSouth(),g=n.getWest(),E=n.getEast(),O=1<<u.z,D=E-g,w=m-f,C=D/l,R=-w/p[s],P=[0,C,0,R,0,0,m,g,0];if(u.z>0){const k=180/c;Ke.mat3.multiply(P,P,[k/D+1,0,0,0,k/w+1,0,-.5*k/C,.5*k/R,1])}return P[2]=O,P[5]=u.x,P[8]=u.y,P},o.cC=qs,o.cD=function(u,n,s){const c=Ke.mat4.identity(new Float64Array(16)),m=(n/(1<<u)-.5)*Math.PI*2;return Ke.mat4.rotateY(c,s.globeMatrix,m),Float32Array.from(c)},o.cE=class{isDataAvailableAtPoint(u){const n=this._source();if(this.isUsingMockSource()||!n||u.y<0||u.y>1)return!1;const s=n.getSource().maxzoom,c=1<<s,m=Math.floor(u.x),f=Math.floor((u.x-m)*c),g=Math.floor(u.y*c),E=this.findDEMTileFor(new ni(s,m,s,f,g));return!(!E||!E.dem)}getAtPointOrZero(u,n=0){return this.getAtPoint(u,n)||0}getAtPoint(u,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const c=this._source();if(!c||u.y<0||u.y>1)return n;const m=c.getSource().maxzoom,f=1<<m,g=Math.floor(u.x),E=u.x-g,O=new ni(m,g,m,Math.floor(E*f),Math.floor(u.y*f)),D=this.findDEMTileFor(O);if(!D||!D.dem)return n;const w=D.dem,C=1<<D.tileID.canonical.z,R=(E*C-D.tileID.canonical.x)*w.dim,P=(u.y*C-D.tileID.canonical.y)*w.dim,k=Math.floor(R),N=Math.floor(P);return(s?this.exaggeration():1)*Yn(Yn(w.get(k,N),w.get(k,N+1),P-N),Yn(w.get(k+1,N),w.get(k+1,N+1),P-N),R-k)}getAtTileOffset(u,n,s){const c=1<<u.canonical.z;return this.getAtPointOrZero(new ft(u.wrap+(u.canonical.x+n/En)/c,(u.canonical.y+s/En)/c))}getAtTileOffsetFunc(u,n,s,c){return m=>{const f=this.getAtTileOffset(u,m.x,m.y),g=c.upVector(u.canonical,m.x,m.y),E=c.upVectorScale(u.canonical,n,s).metersToTile;return Ke.vec3.scale(g,g,f*E),g}}getForTilePoints(u,n,s,c){if(this.isUsingMockSource())return!1;const m=km.create(this,u,c);return!!m&&(n.forEach(f=>{f[2]=this.exaggeration()*m.getElevationAt(f[0],f[1],s)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(u);if(!n||!n.dem)return null;const s=n.dem.tree,c=n.tileID,m=1<<u.canonical.z-c.canonical.z;let f=u.canonical.x/m-c.canonical.x,g=u.canonical.y/m-c.canonical.y,E=0;for(let O=0;O<u.canonical.z-c.canonical.z&&!s.leaves[E];O++){f*=2,g*=2;const D=2*Math.floor(g)+Math.floor(f);E=s.childOffsets[E]+D,f%=1,g%=1}return{min:this.exaggeration()*s.minimums[E],max:this.exaggeration()*s.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let n=!1,s=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const m of u){const f=this.getMinMaxForTile(m.tileID);f&&(s=Math.min(s,f.min),c=Math.max(c,f.max),n=!0)}return n?{min:s,max:c}:null}},o.cF=ov,o.cG=Qa,o.cH=function(u,n){return[Math.pow(u[0],2.2)*n,Math.pow(u[1],2.2)*n,Math.pow(u[2],2.2)*n]},o.cI=qg,o.cJ=Z,o.cK=Se,o.cL=256,o.cM=function(u,n){const s=[0,0,0],c=$f(qs(n.canonical));return Ke.vec3.transformMat4(s,s,c),Ke.vec3.transformMat4(s,s,u),s},o.cN=u=>({u_camera_to_center_distance:new Uo(u),u_extrude_scale:new Ed(u),u_device_pixel_ratio:new Uo(u),u_matrix:new Wh(u),u_inv_rot_matrix:new Wh(u),u_merc_center:new Ol(u),u_tile_id:new Bf(u),u_zoom_transition:new Uo(u),u_up_dir:new Bf(u),u_emissive_strength:new Uo(u)}),o.cO=u=>({u_matrix:new Wh(u),u_pixels_to_tile_units:new Ed(u),u_device_pixel_ratio:new Uo(u),u_units_to_pixels:new Ol(u),u_dash_image:new Yu(u),u_gradient_image:new Yu(u),u_image_height:new Uo(u),u_texsize:new Ol(u),u_tile_units_to_pixels:new Uo(u),u_alpha_discard_threshold:new Uo(u),u_trim_offset:new Ol(u),u_trim_fade_range:new Ol(u),u_trim_color:new Sd(u),u_emissive_strength:new Uo(u),u_zbias_factor:new Uo(u),u_tile_to_meter:new Uo(u)}),o.cP=u=>({u_matrix:new Wh(u),u_texsize:new Ol(u),u_pixels_to_tile_units:new Ed(u),u_device_pixel_ratio:new Uo(u),u_image:new Yu(u),u_units_to_pixels:new Ol(u),u_tile_units_to_pixels:new Uo(u),u_alpha_discard_threshold:new Uo(u),u_trim_offset:new Ol(u),u_emissive_strength:new Uo(u),u_zbias_factor:new Uo(u),u_tile_to_meter:new Uo(u)}),o.cQ=Pc,o.cR=s8,o.cS=l8,o.cT=tv,o.cU=(u,n,s,c,m,f)=>{const g=u.transform,E=g.projection.name==="globe";let O;if(f.paint.get("circle-pitch-alignment")==="map")if(E){const w=qg(g.zoom,n.canonical)*g._pixelsPerMercatorPixel;O=Float32Array.from([w,0,0,w])}else O=g.calculatePixelsToTileUnitsMatrix(s);else O=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const D={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(g.projection),u_matrix:u.translatePosMatrix(n.projMatrix,s,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Wt.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:ev,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:f.paint.get("circle-emissive-strength")};if(E){D.u_inv_rot_matrix=c,D.u_merc_center=m,D.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],D.u_zoom_transition=Ll(g.zoom);const w=m[0]*En,C=m[1]*En;D.u_up_dir=g.projection.upVector(new Qi(0,0,0),w,C)}return D},o.cV=gC,o.cW=(u,n,s,c,m,f)=>{const g=u.transform,E=g.pitch<15?dC(.07,.7,lr((14-g.zoom)/5,0,1)):.07;return{u_matrix:mC(u,n,s,c),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:g.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:m,u_image:0,u_tile_units_to_pixels:pC(n,g),u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:f,u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:E,u_tile_to_meter:it(n.tileID.canonical,0)}},o.cX=(u,n,s,c,m,f,g)=>{const E=u.transform,O=E.calculatePixelsToTileUnitsMatrix(n),D=E.pitch<15?dC(.07,.7,lr((14-E.zoom)/5,0,1)):.07;return{u_matrix:mC(u,n,s,c),u_pixels_to_tile_units:O,u_device_pixel_ratio:f,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:_C(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:pC(n,u.transform),u_alpha_discard_threshold:0,u_trim_offset:g,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:it(n.tileID.canonical,0)}},o.cY=va,o.cZ=Cd,o.c_=rC,o.ca=pi,o.cb=Di,o.cc=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},o.cd=function(u){return u({pluginStatus:$a,pluginURL:rl}),rp.on("pluginStateChange",u),u},o.ce=Rm,o.cf=Nv,o.cg=Mm,o.ch=R1,o.ci=Xn,o.cj=hh,o.ck=Gt,o.cl=Cn,o.cm=Go,o.cn=function(u){const n=u.indexOf(Ql);return n>=0?u.slice(0,n):u},o.co=function(u){const n=u.indexOf(Ql);return n>=0?u.slice(n+1):""},o.cp=function(u){const n=[],s=u.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),u.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},o.cq=function(u,n,s,c){return u.type==="custom"?new N8(u,n):new Y8[u.type](u,n,s,c)},o.cr=es,o.cs=rp,o.ct=Gr,o.cu=Td,o.cv=class extends wu{constructor(u){super(u),this.current=pm}set(u,n,s){if(this.fetchUniformLocation(u,n)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},o.cw=ii,o.cx=function(u,n,s){const c=Ll(s.zoom),m=u.style.map._antialias,f=n.options.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return c===0&&!m&&!f},o.cy=function(u){const n=u.pixelsPerMeter,s=n/we(1,u.center.lat),c=Ke.mat4.identity(new Float64Array(16));return Ke.mat4.translate(c,c,[u.point.x,u.point.y,0]),Ke.mat4.scale(c,c,[s,s,n]),Float32Array.from(c)},o.cz=Md,o.d=function(u){return re.API_TILEJSON_REGEX.test(u)},o.d$=I,o.d0=pv,o.d1=kd,o.d2=450,o.d3=7,o.d4=B8,o.d5=Ti,o.d6=Gh,o.d7=256,o.d8=Ug,o.d9=Cl,o.dA=Qy,o.dB=function(u){const n=[0,0,0],s=Ke.mat4.identity(new Float64Array(16));return Ke.mat4.multiply(s,u.pixelMatrix,u.globeMatrix),Ke.vec3.transformMat4(n,n,s),new Yt(n[0],n[1])},o.dC=function(u,n,s=!1){if($a===hd||$a===uh||$a===ch)throw new Error("setRTLTextPlugin cannot be called multiple times.");rl=Wt.resolveURL(u),$a=hd,bf=n,wf(),s||Sf()},o.dD=fh,o.dE=function(){Nv().acquire(nb)},o.dF=function(){const u=b_;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(nb),b_=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},o.dG=x_,o.dH=function(u){const n=Zr();if(!n)return;const s=n.delete(gn);u&&s.catch(u).then(()=>u())},o.dI=v_,o.dJ=XO,o.dK=function(u){rb=Wt.resolveURL(u),zm||(zm=new Rm(Nv(),new So)),zm.broadcast("setDracoUrl",rb)},o.dL=KO,o.dM=function(u){Dm=Wt.resolveURL(u),zm||(zm=new Rm(Nv(),new So)),zm.broadcast("setMeshoptUrl",Dm)},o.dN=kn,o.dO=Yh,o.dP=Eh,o.dQ=ok,o.dR=ak,o.dS=uC,o.dT=Lo,o.dU=BC,o.dV=function(u,n,s,c,m,f,g,E,O,D,w=1,C){u.createArrays(),u.tilePixelRatio=En/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const R=u.layers[0].layout,P=u.layers[0]._unevaluatedLayout._values,k={};if(k.scaleFactor=w,k.textSizeScaleRange=R.get("text-size-scale-range"),k.iconSizeScaleRange=R.get("icon-size-scale-range"),k.textScaleFactor=lr(k.scaleFactor,k.textSizeScaleRange[0],k.textSizeScaleRange[1]),k.iconScaleFactor=lr(k.scaleFactor,k.iconSizeScaleRange[0],k.iconSizeScaleRange[1]),u.textSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ne}=u.textSizeData;k.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Po(ee),E),P["text-size"].possiblyEvaluate(new Po(ne),E)]}if(u.iconSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ne}=u.iconSizeData;k.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Po(ee),E),P["icon-size"].possiblyEvaluate(new Po(ne),E)]}k.layoutTextSize=P["text-size"].possiblyEvaluate(new Po(O+1),E),k.layoutIconSize=P["icon-size"].possiblyEvaluate(new Po(O+1),E),k.textMaxSize=P["text-size"].possiblyEvaluate(new Po(18),E);const N=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",W=R.get("text-size");let X=!1;for(const ee of u.features)if(ee.icon&&ee.icon.nameSecondary){X=!0;break}for(const ee of u.features){const ne=R.get("text-font").evaluate(ee,{},E).join(","),J=W.evaluate(ee,{},E)*k.textScaleFactor,he=k.layoutTextSize.evaluate(ee,{},E)*k.textScaleFactor,ye=(k.layoutIconSize.evaluate(ee,{},E),{horizontal:{},vertical:void 0}),Me=ee.text;let Ve,Ne=[0,0];if(Me){const je=Me.toString(),nt=R.get("text-letter-spacing").evaluate(ee,{},E)*Gs,ct=R.get("text-line-height").evaluate(ee,{},E)*Gs,ht=cd(je)?nt:0,_t=R.get("text-anchor").evaluate(ee,{},E),At=R.get("text-variable-anchor");if(!At){const Ut=R.get("text-radial-offset").evaluate(ee,{},E);Ne=Ut?VC(_t,[Ut*Gs,L1]):R.get("text-offset").evaluate(ee,{},E).map(Fn=>Fn*Gs)}let It=N?"center":R.get("text-justify").evaluate(ee,{},E);const wt=R.get("symbol-placement")==="point",Xt=wt?R.get("text-max-width").evaluate(ee,{},E)*Gs:1/0,pn=Ut=>{u.allowVerticalPlacement&&ud(je)&&(ye.vertical=C1(Me,n,s,m,ne,Xt,ct,_t,Ut,ht,Ne,Ju.vertical,!0,he,J))};if(!N&&At){const Ut=It==="auto"?At.map(An=>D1(An)):[It];let Fn=!1;for(let An=0;An<Ut.length;An++){const xn=Ut[An];if(!ye.horizontal[xn])if(Fn)ye.horizontal[xn]=ye.horizontal[0];else{const cn=C1(Me,n,s,m,ne,Xt,ct,"center",xn,ht,Ne,Ju.horizontal,!1,he,J);cn&&(ye.horizontal[xn]=cn,Fn=cn.positionedLines.length===1)}}pn("left")}else{if(It==="auto"&&(It=D1(_t)),wt||R.get("text-writing-mode").indexOf("horizontal")>=0||!ud(je)){const Ut=C1(Me,n,s,m,ne,Xt,ct,_t,It,ht,Ne,Ju.horizontal,!1,he,J);Ut&&(ye.horizontal[It]=Ut)}pn(wt?"left":It)}}let $e=!1;if(ee.icon&&ee.icon.namePrimary){const je=c[ee.icon.namePrimary];je&&(Ve=y8(m[ee.icon.namePrimary],ee.icon.nameSecondary?m[ee.icon.nameSecondary]:void 0,R.get("icon-offset").evaluate(ee,{},E),R.get("icon-anchor").evaluate(ee,{},E)),$e=je.sdf,u.sdfIcons===void 0?u.sdfIcons=je.sdf:u.sdfIcons!==je.sdf&&Er("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(je.pixelRatio!==u.pixelRatio||R.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const ot=GC(ye.horizontal)||ye.vertical;u.iconsInText||(u.iconsInText=!!ot&&ot.iconsInText),(ot||Ve)&&E8(u,ee,ye,Ve,c,k,he,0,Ne,$e,g,E,D,C,X)}f&&u.generateCollisionDebugBuffers(O,u.collisionBoxArray,k.textScaleFactor)},o.dW=Em,o.dX=Bv,o.dY=Dr,o.dZ=LI,o.d_=SC,o.da=Ic,o.db=_d,o.dc=function(u,n,s,c,m){return lr((u-n)/(s-n)*(m-c)+c,c,m)},o.dd=Zl,o.de=Ze,o.df=class{constructor(u,n,s,c){this.context=u,this.format=c,this.size=s,this.texture=u.gl.createTexture();const[m,f,g]=this.size,{gl:E}=u;E.bindTexture(E.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),E.texImage3D(E.TEXTURE_3D,0,this.format,m,f,g,0,U1(this.format),V1(this.format),n.data)}bind(u,n){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_3D,this.texture),u!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,u),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,u),this.minFilter=u),n!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,n),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},o.dg=W1,o.dh=[1,1,1],o.di=km,o.dj=Om,o.dk=gs,o.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Yt(1/0,1/0),max:new Yt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,n=!1){const s=jI(new Yt(0,0),new Yt(En,En),u),c=[];if(n&&!y1(s,this._globalClipBounds))return c;for(const m of this._activeRegions){if(m.hiddenByOverlap||!y1(s,m))continue;const f=LU(m.min,m.max,u);c.push({min:f.min,max:f.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return c}setSources(u){this._setSources(u.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const c of n.cache.getVisibleCoordinates()){const m=n.cache.getTile(c).buckets[n.layer];m&&m.updateFootprints(c.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(u){const n=u.getFootprints();if(n.length===0)return;const s=u.getOrder(),c=u.getClipMask(),m=u.getClipScope();for(const f of n){if(!f.footprint)continue;const g=jI(f.footprint.min,f.footprint.max,f.id);this._activeRegions.push({min:g.min,max:g.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:f.id,footprint:f.footprint,order:s,clipMask:c,clipScope:m})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||fv(n.min,s.min)||fv(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(c,m){const f=(g,E)=>g+E;return c.length-m.length||c.reduce(f,"").localeCompare(m.reduce(f,""))}(n.clipScope,s.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let n=0;for(;!u&&n!==this._activeRegions.length;){const s=this._activeRegions[n],c=this._prevRegions[n];u=s.priority!==c.priority||!NI(s,c)||s.order!==c.order||s.clipMask!==c.clipMask||!Mr(s.clipScope,c.clipScope),++n}}if(u){++this._updateTime;for(const s of this._activeRegions)s.order!==hv&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const c=this._activeRegions;if(s>=c.length)return s;const m=c[s].priority;for(;s<c.length&&c[s].priority===m;)++s;return s};if(this._sourceIds.length>1){let s=0,c=n(s);for(;s!==c;){let m=s;const f=s;for(;m!==c;){const g=this._activeRegions[m];g.hiddenByOverlap=!1;for(let E=0;E<f;E++){const O=this._activeRegions[E];if(!O.hiddenByOverlap&&g.order===hv&&y1(g,O)&&(g.hiddenByOverlap=UI(g.footprint,g.tileId,O.footprint,O.tileId),g.hiddenByOverlap))break}++m}s=c,c=n(s)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=u.length-1;n>=0;n--)this._addSource(u[n]);this._computeReplacement()}},o.dm=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,n){const s=new xu,c=new po,m=[],f=u+1+2,g=n[0]+1,E=n[0]+1+(1+n.length),O=(D,w,C)=>{let R=D===f-1?D-2:D===0?D:D-1;return R+=C?24575:0,[R,w]};for(let D=0;D<f;++D)s.emplaceBack(...O(D,0,!0));for(let D=0;D<g;++D)for(let w=0;w<f;++w)s.emplaceBack(...O(w,D,(w===0||w===f-1)&&!0));for(let D=0;D<n.length;++D){const w=n[D];for(let C=0;C<f;++C)s.emplaceBack(...O(C,w,!0))}for(let D=0;D<n.length;++D){const w=c.length,C=n[D]+1+2,R=new po;for(let N=0;N<C-1;N++){const W=N===C-2,X=W?f*(E-n.length+D-N):f;for(let ee=0;ee<f-1;ee++){const ne=N*f+ee;N===0||W||ee===0||ee===f-2?(R.emplaceBack(ne+1,ne,ne+X),R.emplaceBack(ne+X,ne+X+1,ne+1)):(c.emplaceBack(ne+1,ne,ne+X),c.emplaceBack(ne+X,ne+X+1,ne+1))}}const P=$o.simpleSegment(0,w,s.length,c.length-w);for(let N=0;N<R.uint16.length;N+=3)c.emplaceBack(R.uint16[N],R.uint16[N+1],R.uint16[N+2]);const k=$o.simpleSegment(0,w,s.length,c.length-w);m.push({withoutSkirts:P,withSkirts:k})}return{vertices:s,indices:c,segments:m}}_createGrid(u){const n=this._fillGridMeshWithLods(l,p);this._gridSegments=n.segments,this._gridBuffer=u.createVertexBuffer(n.vertices,_s.members),this._gridIndexBuffer=u.createIndexBuffer(n.indices,!0)}_createPoles(u){const n=new po;for(let g=0;g<=l;g++)n.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=u.createIndexBuffer(n,!0);const s=new Ic,c=new Ic,m=new Ic,f=new Ic;this._poleSegments=[];for(let g=0,E=0;g<pp;g++){const O=360/(1<<g);s.emplaceBack(0,-Ya,0,.5,0),c.emplaceBack(0,-Ya,0,.5,1),m.emplaceBack(0,-Ya,0,.5,.5),f.emplaceBack(0,-Ya,0,.5,.5);for(let D=0;D<=l;D++){let w=D/l,C=0;const R=Yn(0,O,w),[P,k,N]=A(Va,h1,R,Ya);s.emplaceBack(P,k,N,w,C),c.emplaceBack(P,k,N,w,1-C);const W=sr(R);w=.5+.5*Math.sin(W),C=.5+.5*Math.cos(W),m.emplaceBack(P,k,N,w,C),f.emplaceBack(P,k,N,w,1-C)}this._poleSegments.push($o.simpleSegment(E,0,66,64)),E+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(s,ji,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(c,ji,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(m,ji,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(f,ji,!1)}getGridBuffers(u,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},o.dn=hv,o.dp=Pi,o.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},o.dr=yi,o.ds=Qe,o.dt=F,o.du=function([u,n,s]){const c=Math.hypot(u,n,s),m=Math.atan2(u,s),f=.5*Math.PI-Math.acos(-n/c);return new q(_i(m),_i(f))},o.dv=H1,o.dw=j,o.dx=function(u){const n=u.navigator?u.navigator.userAgent:null;return!!function(s){if(Mi==null){const c=s.navigator?s.navigator.userAgent:null;Mi=!!s.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return Mi}(u)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.dy=function(u,n){Tn=u,In=n},o.dz=Xh,o.e=re,o.e0=function(u){let n=0;if(new Uint32Array(u,0,1)[0]!==JO){const s=new Uint32Array(u,0,7),[,,c,m,f,g]=s;n=s.byteLength+m+f+g+f,(c!==u.byteLength||n>=u.byteLength)&&Er("Invalid b3dm header information.")}return nk(u,n)},o.e1=function(u,n){const s=ik(u);for(const c of s){for(const m of c.meshes)FV(m);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(BV(c.lights,n)))}return s},o.e2=Fv,o.e3=kO,o.e4=il,o.e5=function(u){ri(),dr!=null&&dr.then(n=>{n.keys().then(s=>{for(let c=0;c<s.length-u;c++)n.delete(s[c])})})},o.f=function(u){return u.indexOf("mapbox:")===0},o.g=function(u,n){return Gr(Fi(u,{method:"GET"}),n)},o.h=ce,o.i=function(u){return re.API_STYLE_REGEX.test(u)&&!de(u)},o.j=function(u){return decodeURIComponent(atob(u).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},o.k=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},o.l=Fi,o.m=hn,o.n=function(u,n){return Gr(Fi(u,{type:"json"}),n)},o.o=wi,o.p=function(u,n){return Gr(Fi(u,{method:"POST"}),n)},o.q=Wt,o.r=xs,o.s=function(u){try{const n=self[u];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},o.t=Cr,o.u=function(){return function u(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},o.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},o.w=Er,o.x=Gn,o.y=2,o.z=FC}),v(["./shared"],function(o){function I(kt){const Se=kt?kt.url.toString():void 0;return Se?performance.getEntriesByName(Se):[]}function B(kt){if(typeof kt=="number"||typeof kt=="boolean"||typeof kt=="string"||kt==null)return JSON.stringify(kt);if(Array.isArray(kt)){let Z="[";for(const re of kt)Z+=`${B(re)},`;return`${Z}]`}let Se="{";for(const Z of Object.keys(kt).sort())Se+=`${Z}:${B(kt[Z])},`;return`${Se}}`}function $(kt){let Se="";for(const Z of o.bh)Se+=`/${B(kt[Z])}`;return Se}class U{constructor(Se){this.keyCache={},this._layers={},this._layerConfigs={},Se&&this.replace(Se)}replace(Se,Z){this._layerConfigs={},this._layers={},this.update(Se,[],Z)}update(Se,Z,re){this._options=re;for(const de of Se)this._layerConfigs[de.id]=de,(this._layers[de.id]=o.cq(de,this.scope,null,this._options)).compileFilter(re),this.keyCache[de.id]&&delete this.keyCache[de.id];for(const de of Z)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const ce=function(de,xe){const Ie={};for(let Be=0;Be<de.length;Be++){const tt=xe&&xe[de[Be].id]||$(de[Be]);xe&&(xe[de[Be].id]=tt);let ut=Ie[tt];ut||(ut=Ie[tt]=[]),ut.push(de[Be])}const Ae=[];for(const Be in Ie)Ae.push(Ie[Be]);return Ae}(o.be(this._layerConfigs),this.keyCache);for(const de of ce){const xe=de.map(Tt=>this._layers[Tt.id]),Ie=xe[0];if(Ie.visibility==="none")continue;const Ae=Ie.source||"";let Be=this.familiesBySource[Ae];Be||(Be=this.familiesBySource[Ae]={});const tt=Ie.sourceLayer||"_geojsonTileLayer";let ut=Be[tt];ut||(ut=Be[tt]=[]),ut.push(xe)}}}const K=1*o.dP;class te{constructor(Se){const Z={},re=[];for(const Ie in Se){const Ae=Se[Ie],Be=Z[Ie]={};for(const tt in Ae.glyphs){const ut=Ae.glyphs[+tt];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const Tt=ut.metrics.localGlyph?K:1,Wt={x:0,y:0,w:ut.bitmap.width+2*Tt,h:ut.bitmap.height+2*Tt};re.push(Wt),Be[tt]=Wt}}const{w:ce,h:de}=o.z(re),xe=new o.dO({width:ce||1,height:de||1});for(const Ie in Se){const Ae=Se[Ie];for(const Be in Ae.glyphs){const tt=Ae.glyphs[+Be];if(!tt||tt.bitmap.width===0||tt.bitmap.height===0)continue;const ut=Z[Ie][Be],Tt=tt.metrics.localGlyph?K:1;o.dO.copy(tt.bitmap,xe,{x:0,y:0},{x:ut.x+Tt,y:ut.y+Tt},tt.bitmap)}}this.image=xe,this.positions=Z}}o.dN(te,"GlyphAtlas");class le{constructor(Se){this.tileID=new o.aA(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),this.tileZoom=Se.tileZoom,this.uid=Se.uid,this.zoom=Se.zoom,this.lut=Se.lut,this.canonical=Se.tileID.canonical,this.pixelRatio=Se.pixelRatio,this.tileSize=Se.tileSize,this.source=Se.source,this.scope=Se.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Se.showCollisionBoxes,this.collectResourceTiming=!!Se.request&&Se.request.collectResourceTiming,this.promoteId=Se.promoteId,this.isSymbolTile=Se.isSymbolTile,this.tileTransform=o.aL(Se.tileID.canonical,Se.projection),this.projection=Se.projection,this.worldview=Se.worldview,this.localizableLayerIds=Se.localizableLayerIds,this.brightness=Se.brightness,this.extraShadowCaster=!!Se.extraShadowCaster,this.tessellationStep=Se.tessellationStep,this.scaleFactor=Se.scaleFactor}parse(Se,Z,re,ce,de){this.status="parsing",this.data=Se,this.collisionBoxArray=new o.aR;const xe=new o.dQ(Object.keys(Se.layers).sort()),Ie=new o.dR(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Ae={},Be=new o.dS(256,256),tt={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Be,availableImages:re,brightness:this.brightness},ut=Z.familiesBySource[this.source];for(const In in ut){const Ln=Se.layers[In];if(!Ln)continue;let dr=!1,Zn=!1,Zr=!1;for(const hn of ut[In])hn[0].type==="symbol"?dr=!0:Zn=!0,hn[0].is3D()&&hn[0].type!=="model"&&(Zr=!0);if(this.extraShadowCaster&&!Zr||this.isSymbolTile===!0&&!dr||this.isSymbolTile===!1&&!Zn)continue;Ln.version===1&&o.w(`Vector tile source "${this.source}" layer "${In}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ri=xe.encode(In),nr=[];for(let hn=0,Kn=0;hn<Ln.length;hn++){const br=Ln.feature(hn),oi=Ie.getId(br,In);if(this.localizableLayerIds&&this.localizableLayerIds.has(In)){const Ir=br.properties?br.properties.worldview:null;if(this.worldview&&typeof Ir=="string")if(Ir==="all")br.properties.$localized=!0;else{if(!Ir.split(",").includes(this.worldview))continue;br.properties.$localized=!0,br.properties.worldview=this.worldview}}nr.push({feature:br,id:oi,index:Kn,sourceLayerIndex:ri}),Kn++}for(const hn of ut[In]){const Kn=hn[0];(!this.extraShadowCaster||Kn.is3D()&&Kn.type!=="model")&&(this.isSymbolTile!==void 0&&Kn.type==="symbol"!==this.isSymbolTile||Kn.minzoom&&this.zoom<Math.floor(Kn.minzoom)||Kn.maxzoom&&this.zoom>=Kn.maxzoom||Kn.visibility!=="none"&&(se(hn,this.zoom,tt.brightness,re),(Ae[Kn.id]=Kn.createBucket({index:Ie.bucketLayerIDs.length,layers:hn,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ri,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(nr,tt,this.tileID.canonical,this.tileTransform),Ie.bucketLayerIDs.push(hn.map(br=>o.av(br.id,br.scope)))))}}let Tt,Wt,Vt,Gt;Be.trim();const gn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Tn=()=>{if(Tt)return this.status="done",de(Tt);if(this.extraShadowCaster)this.status="done",de(null,{buckets:o.be(Ae).filter(In=>!In.isEmpty()),featureIndex:Ie,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:tt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Wt&&Vt&&Gt){const In=new te(Wt),Ln=new o.dU(Vt,Gt,this.lut);for(const dr in Ae){const Zn=Ae[dr];Zn instanceof o.aS?(se(Zn.layers,this.zoom,tt.brightness,re),o.dV(Zn,Wt,In.positions,Vt,Ln.iconPositions,this.showCollisionBoxes,re,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.brightness)):Zn.hasPattern&&(Zn instanceof o.aY||Zn instanceof o.aZ||Zn instanceof o.d0)&&(se(Zn.layers,this.zoom,tt.brightness,re),Zn.addFeatures(tt,this.tileID.canonical,Ln.patternPositions,re,this.tileTransform,this.brightness))}this.status="done",de(null,{buckets:o.be(Ae).filter(dr=>!dr.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:In.image,lineAtlas:Be,imageAtlas:Ln,brightness:tt.brightness})}};if(!this.extraShadowCaster){const In=o.dT(tt.glyphDependencies,Zn=>Object.keys(Zn).map(Number));Object.keys(In).length?ce.send("getGlyphs",{uid:this.uid,stacks:In,scope:this.scope},(Zn,Zr)=>{Tt||(Tt=Zn,Wt=Zr,Tn())},void 0,!1,gn):Wt={};const Ln=Object.keys(tt.iconDependencies);Ln.length?ce.send("getImages",{icons:Ln,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Zn,Zr)=>{Tt||(Tt=Zn,Vt=Zr,Tn())},void 0,!1,gn):Vt={};const dr=Object.keys(tt.patternDependencies);dr.length?ce.send("getImages",{icons:dr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Zn,Zr)=>{Tt||(Tt=Zn,Gt=Zr,Tn())},void 0,!1,gn):Gt={}}Tn()}}function se(kt,Se,Z,re){const ce=new o.a3(Se,{brightness:Z});for(const de of kt)de.recalculate(ce,re)}class ue extends o.E{constructor(Se,Z,re,ce,de,xe){super(),this.actor=Se,this.layerIndex=Z,this.availableImages=re,this.loadVectorData=de||o.aw,this.loading={},this.loaded={},this.deduped=new o.au(Se.scheduler),this.isSpriteLoaded=ce,this.scheduler=Se.scheduler,this.brightness=xe}loadTile(Se,Z){const re=Se.uid,ce=Se&&Se.request,de=ce&&ce.collectResourceTiming,xe=this.loading[re]=new le(Se);xe.abort=this.loadVectorData(Se,(Ie,Ae)=>{const Be=!this.loading[re];if(delete this.loading[re],Be||Ie||!Ae)return xe.status="done",Be||(this.loaded[re]=xe),Z(Ie);const tt=Ae.rawData,ut={};Ae.expires&&(ut.expires=Ae.expires),Ae.cacheControl&&(ut.cacheControl=Ae.cacheControl),xe.vectorTile=Ae.vectorTile||new o.dW.VectorTile(new o.bc(tt));const Tt=()=>{xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,(Wt,Vt)=>{if(Wt||!Vt)return Z(Wt);const Gt={};if(de){const gn=I(ce);gn.length>0&&(Gt.resourceTiming=JSON.parse(JSON.stringify(gn)))}Z(null,o.l({rawTileData:tt.slice(0)},Vt,ut,Gt))})};this.isSpriteLoaded?Tt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Tt,{type:"parseTile",isSymbolTile:Se.isSymbolTile,zoom:Se.tileZoom}):Tt()}),this.loaded=this.loaded||{},this.loaded[re]=xe})}reloadTile(Se,Z){const re=this.loaded,ce=Se.uid;if(re&&re[ce]){const de=re[ce];de.scaleFactor=Se.scaleFactor,de.showCollisionBoxes=Se.showCollisionBoxes,de.projection=Se.projection,de.brightness=Se.brightness,de.tileTransform=o.aL(Se.tileID.canonical,Se.projection),de.extraShadowCaster=Se.extraShadowCaster,de.lut=Se.lut;const xe=(Ie,Ae)=>{const Be=de.reloadCallback;Be&&(delete de.reloadCallback,de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,Be)),Z(Ie,Ae)};de.status==="parsing"?de.reloadCallback=xe:de.status==="done"&&(de.vectorTile?de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,xe):xe())}else Z(null,void 0)}abortTile(Se,Z){const re=Se.uid,ce=this.loading[re];ce&&(ce.abort&&ce.abort(),delete this.loading[re]),Z()}removeTile(Se,Z){const re=this.loaded,ce=Se.uid;re&&re[ce]&&delete re[ce],Z()}}class be{loadTile(Se,Z){const{uid:re,encoding:ce,rawImageData:de,padding:xe}=Se,Ie=ImageBitmap&&de instanceof ImageBitmap?this.getImageData(de,xe):de;Z(null,new o.dX(re,Ie,ce,xe<1))}getImageData(Se,Z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Se.width,Se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Se.width,this.offscreenCanvas.height=Se.height,this.offscreenCanvasContext.drawImage(Se,0,0,Se.width,Se.height);const re=this.offscreenCanvasContext.getImageData(-Z,-Z,Se.width+2*Z,Se.height+2*Z);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),re}}o.bb.setPbf(o.bc);class Ce{decodeRasterArray({task:Se,buffer:Z},re){o.bb.performDecoding(Z,Se).then(ce=>{re(null,ce)},ce=>{re(ce)})}}const Re=o.dW.VectorTileFeature.prototype.toGeoJSON;class De{constructor(Se){this._feature=Se,this.extent=o.ab,this.type=Se.type,this.properties=Se.tags,"id"in Se&&!isNaN(Se.id)&&(this.id=parseInt(Se.id,10))}loadGeometry(){if(this._feature.type===1){const Se=[];for(const Z of this._feature.geometry)Se.push([new o.P(Z[0],Z[1])]);return Se}{const Se=[];for(const Z of this._feature.geometry){const re=[];for(const ce of Z)re.push(new o.P(ce[0],ce[1]));Se.push(re)}return Se}}toGeoJSON(Se,Z,re){return Re.call(this,Se,Z,re)}}class ve{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.ab,this.length=Se.length,this._features=Se}feature(Se){return new De(this._features[Se])}}const Le=64/4096,Fe=128;class lt{constructor(){this.features=new Map}clear(){this.features.clear()}load(Se=[],Z){for(const re of Se){const ce=re.id;if(ce==null)continue;let de=this.features.get(ce);de&&this.updateCache(de,Z),re.geometry?(de=gt(re),this.updateCache(de,Z),this.features.set(ce,de)):this.features.delete(ce),this.updateCache(de,Z)}}updateCache(Se,Z){for(const{canonical:re,uid:ce}of Object.values(Z)){const{z:de,x:xe,y:Ie}=re;xt(Se,Math.pow(2,de),xe,Ie)&&delete Z[ce]}}getTile(Se,Z,re){const ce=Math.pow(2,Se),de=[];for(const xe of this.features.values())xt(xe,ce,Z,re)&&de.push(Ht(xe,ce,Z,re));return{features:de}}getFeatures(){return[...this.features.values()]}}function xt({minX:kt,minY:Se,maxX:Z,maxY:re},ce,de,xe){return kt<(de+1+Le)/ce&&Se<(xe+1+Le)/ce&&Z>(de-Le)/ce&&re>(xe-Le)/ce}function gt(kt){const{id:Se,geometry:Z,properties:re}=kt;if(!Z)return;if(Z.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ce,coordinates:de}=Z,xe={id:Se,type:1,geometry:[],tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Ie=xe.geometry;if(ce==="Point")Je(de,Ie,xe);else if(ce==="MultiPoint")for(const Ae of de)Je(Ae,Ie,xe);else if(ce==="LineString")xe.type=2,St(de,Ie,xe);else if(ce==="MultiLineString")xe.type=2,Nt(de,Ie,xe);else if(ce==="Polygon")xe.type=3,Nt(de,Ie,xe,!0);else{if(ce!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xe.type=3;for(const Ae of de)Nt(Ae,Ie,xe,!0)}return xe}function Je([kt,Se],Z,re){const ce=o.am(kt);let de=o.at(Se);de=de<0?0:de>1?1:de,Z.push(ce,de),re.minX=Math.min(re.minX,ce),re.minY=Math.min(re.minY,de),re.maxX=Math.max(re.maxX,ce),re.maxY=Math.max(re.maxY,de)}function St(kt,Se,Z,re=!1,ce=!1){const de=[];for(const xe of kt)Je(xe,de,Z);Se.push(de),re&&function(xe,Ie){let Ae=0;for(let Be=0,tt=xe.length,ut=tt-2;Be<tt;ut=Be,Be+=2)Ae+=(xe[Be]-xe[ut])*(xe[Be+1]+xe[ut+1]);if(Ae>0===Ie)for(let Be=0,tt=xe.length;Be<tt/2;Be+=2){const ut=xe[Be],Tt=xe[Be+1];xe[Be]=xe[tt-2-Be],xe[Be+1]=xe[tt-1-Be],xe[tt-2-Be]=ut,xe[tt-1-Be]=Tt}}(de,ce)}function Nt(kt,Se,Z,re=!1){for(let ce=0;ce<kt.length;ce++)St(kt[ce],Se,Z,re,ce===0)}function Ht(kt,Se,Z,re){const{id:ce,type:de,geometry:xe,tags:Ie}=kt,Ae=[];if(de===1)(function(Be,tt,ut,Tt,Wt){for(let Vt=0;Vt<Be.length;Vt+=2){const Gt=Math.round(o.ab*(Be[Vt+0]*tt-ut)),gn=Math.round(o.ab*(Be[Vt+1]*tt-Tt));Wt.push([Gt,gn])}})(xe,Se,Z,re,Ae);else for(const Be of xe)Ct(Be,Se,Z,re,Ae);return{id:ce,type:de,geometry:Ae,tags:Ie}}function Ct(kt,Se,Z,re,ce){const de=-Fe,xe=o.ab+Fe;let Ie;for(let Ae=0;Ae<kt.length-2;Ae+=2){let Be=Math.round(o.ab*(kt[Ae+0]*Se-Z)),tt=Math.round(o.ab*(kt[Ae+1]*Se-re)),ut=Math.round(o.ab*(kt[Ae+2]*Se-Z)),Tt=Math.round(o.ab*(kt[Ae+3]*Se-re));const Wt=ut-Be,Vt=Tt-tt;Be<de&&ut<de||(Be<de?(tt+=Math.round(Vt*((de-Be)/Wt)),Be=de):ut<de&&(Tt=tt+Math.round(Vt*((de-Be)/Wt)),ut=de),tt<de&&Tt<de||(tt<de?(Be+=Math.round(Wt*((de-tt)/Vt)),tt=de):Tt<de&&(ut=Be+Math.round(Wt*((de-tt)/Vt)),Tt=de),Be>=xe&&ut>=xe||(Be>=xe?(tt+=Math.round(Vt*((xe-Be)/Wt)),Be=xe):ut>=xe&&(Tt=tt+Math.round(Vt*((xe-Be)/Wt)),ut=xe),tt>=xe&&Tt>=xe||(tt>=xe?(Be+=Math.round(Wt*((xe-tt)/Vt)),tt=xe):Tt>=xe&&(ut=Be+Math.round(Wt*((xe-tt)/Vt)),Tt=xe),Ie&&Be===Ie[Ie.length-1][0]&&tt===Ie[Ie.length-1][1]||(Ie=[[Be,tt]],ce.push(Ie)),Ie.push([ut,Tt])))))}}var Kt,Lt,et,vt={exports:{}},Ot=function(){if(et)return vt.exports;et=1;var kt=o.d_(),Se=function(){if(Lt)return Kt;Lt=1;var tt=o.dY(),ut=o.dZ().VectorTileFeature;function Tt(Vt,Gt){this.options=Gt||{},this.features=Vt,this.length=Vt.length}function Wt(Vt,Gt){this.id=typeof Vt.id=="number"?Vt.id:void 0,this.type=Vt.type,this.rawGeometry=Vt.type===1?[Vt.geometry]:Vt.geometry,this.properties=Vt.tags,this.extent=Gt||4096}return Kt=Tt,Tt.prototype.feature=function(Vt){return new Wt(this.features[Vt],this.options.extent)},Wt.prototype.loadGeometry=function(){var Vt=this.rawGeometry;this.geometry=[];for(var Gt=0;Gt<Vt.length;Gt++){for(var gn=Vt[Gt],Tn=[],In=0;In<gn.length;In++)Tn.push(new tt(gn[In][0],gn[In][1]));this.geometry.push(Tn)}return this.geometry},Wt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Vt=this.geometry,Gt=1/0,gn=-1/0,Tn=1/0,In=-1/0,Ln=0;Ln<Vt.length;Ln++)for(var dr=Vt[Ln],Zn=0;Zn<dr.length;Zn++){var Zr=dr[Zn];Gt=Math.min(Gt,Zr.x),gn=Math.max(gn,Zr.x),Tn=Math.min(Tn,Zr.y),In=Math.max(In,Zr.y)}return[Gt,Tn,gn,In]},Wt.prototype.toGeoJSON=ut.prototype.toGeoJSON,Kt}();function Z(tt){var ut=new kt;return function(Tt,Wt){for(var Vt in Tt.layers)Wt.writeMessage(3,re,Tt.layers[Vt])}(tt,ut),ut.finish()}function re(tt,ut){var Tt;ut.writeVarintField(15,tt.version||1),ut.writeStringField(1,tt.name||""),ut.writeVarintField(5,tt.extent||4096);var Wt={keys:[],values:[],keycache:{},valuecache:{}};for(Tt=0;Tt<tt.length;Tt++)Wt.feature=tt.feature(Tt),ut.writeMessage(2,ce,Wt);var Vt=Wt.keys;for(Tt=0;Tt<Vt.length;Tt++)ut.writeStringField(3,Vt[Tt]);var Gt=Wt.values;for(Tt=0;Tt<Gt.length;Tt++)ut.writeMessage(4,Be,Gt[Tt])}function ce(tt,ut){var Tt=tt.feature;Tt.id!==void 0&&ut.writeVarintField(1,Tt.id),ut.writeMessage(2,de,tt),ut.writeVarintField(3,Tt.type),ut.writeMessage(4,Ae,Tt)}function de(tt,ut){var Tt=tt.feature,Wt=tt.keys,Vt=tt.values,Gt=tt.keycache,gn=tt.valuecache;for(var Tn in Tt.properties){var In=Tt.properties[Tn],Ln=Gt[Tn];if(In!==null){Ln===void 0&&(Wt.push(Tn),Gt[Tn]=Ln=Wt.length-1),ut.writeVarint(Ln);var dr=typeof In;dr!=="string"&&dr!=="boolean"&&dr!=="number"&&(In=JSON.stringify(In));var Zn=dr+":"+In,Zr=gn[Zn];Zr===void 0&&(Vt.push(In),gn[Zn]=Zr=Vt.length-1),ut.writeVarint(Zr)}}}function xe(tt,ut){return(ut<<3)+(7&tt)}function Ie(tt){return tt<<1^tt>>31}function Ae(tt,ut){for(var Tt=tt.loadGeometry(),Wt=tt.type,Vt=0,Gt=0,gn=Tt.length,Tn=0;Tn<gn;Tn++){var In=Tt[Tn],Ln=1;Wt===1&&(Ln=In.length),ut.writeVarint(xe(1,Ln));for(var dr=Wt===3?In.length-1:In.length,Zn=0;Zn<dr;Zn++){Zn===1&&Wt!==1&&ut.writeVarint(xe(2,dr-1));var Zr=In[Zn].x-Vt,ri=In[Zn].y-Gt;ut.writeVarint(Ie(Zr)),ut.writeVarint(Ie(ri)),Vt+=Zr,Gt+=ri}Wt===3&&ut.writeVarint(xe(7,1))}}function Be(tt,ut){var Tt=typeof tt;Tt==="string"?ut.writeStringField(1,tt):Tt==="boolean"?ut.writeBooleanField(7,tt):Tt==="number"&&(tt%1!=0?ut.writeDoubleField(3,tt):tt<0?ut.writeSVarintField(6,tt):ut.writeVarintField(5,tt))}return vt.exports=Z,vt.exports.fromVectorTileJs=Z,vt.exports.fromGeojsonVt=function(tt,ut){ut=ut||{};var Tt={};for(var Wt in tt)Tt[Wt]=new Se(tt[Wt].features,ut),Tt[Wt].name=Wt,Tt[Wt].version=ut.version,Tt[Wt].extent=ut.extent;return Z({layers:Tt})},vt.exports.GeoJSONWrapper=Se,vt.exports}(),mt=o.d$(Ot);const zt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:kt=>kt},Jt=Math.fround||(Un=new Float32Array(1),kt=>(Un[0]=+kt,Un[0]));var Un;const $n=3,Bn=5,$r=6;class _r{constructor(Se){this.options=Object.assign(Object.create(zt),Se),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Se){const{log:Z,minZoom:re,maxZoom:ce}=this.options;Z&&console.time("total time");const de=`prepare ${Se.length} points`;Z&&console.time(de),this.points=Se;const xe=[];for(let Ae=0;Ae<Se.length;Ae++){const Be=Se[Ae];if(!Be.geometry)continue;const[tt,ut]=Be.geometry.coordinates,Tt=Jt(mr(tt)),Wt=Jt(Sn(ut));xe.push(Tt,Wt,1/0,Ae,-1,1),this.options.reduce&&xe.push(0)}let Ie=this.trees[ce+1]=this._createTree(xe);Z&&console.timeEnd(de);for(let Ae=ce;Ae>=re;Ae--){const Be=+Date.now();Ie=this.trees[Ae]=this._createTree(this._cluster(Ie,Ae)),Z&&console.log("z%d: %d clusters in %dms",Ae,Ie.numItems,+Date.now()-Be)}return Z&&console.timeEnd("total time"),this}getClusters(Se,Z){let re=((Se[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,Se[1]));let de=Se[2]===180?180:((Se[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,Se[3]));if(Se[2]-Se[0]>=360)re=-180,de=180;else if(re>de){const ut=this.getClusters([re,ce,180,xe],Z),Tt=this.getClusters([-180,ce,de,xe],Z);return ut.concat(Tt)}const Ie=this.trees[this._limitZoom(Z)],Ae=Ie.range(mr(re),Sn(xe),mr(de),Sn(ce)),Be=Ie.data,tt=[];for(const ut of Ae){const Tt=this.stride*ut;tt.push(Be[Tt+Bn]>1?Pn(Be,Tt,this.clusterProps):this.points[Be[Tt+$n]])}return tt}getChildren(Se){const Z=this._getOriginId(Se),re=this._getOriginZoom(Se),ce="No cluster with the specified id.",de=this.trees[re];if(!de)throw new Error(ce);const xe=de.data;if(Z*this.stride>=xe.length)throw new Error(ce);const Ie=this.options.radius/(this.options.extent*Math.pow(2,re-1)),Ae=de.within(xe[Z*this.stride],xe[Z*this.stride+1],Ie),Be=[];for(const tt of Ae){const ut=tt*this.stride;xe[ut+4]===Se&&Be.push(xe[ut+Bn]>1?Pn(xe,ut,this.clusterProps):this.points[xe[ut+$n]])}if(Be.length===0)throw new Error(ce);return Be}getLeaves(Se,Z,re){const ce=[];return this._appendLeaves(ce,Se,Z=Z||10,re=re||0,0),ce}getTile(Se,Z,re){const ce=this.trees[this._limitZoom(Se)],de=Math.pow(2,Se),{extent:xe,radius:Ie}=this.options,Ae=Ie/xe,Be=(re-Ae)/de,tt=(re+1+Ae)/de,ut={features:[]};return this._addTileFeatures(ce.range((Z-Ae)/de,Be,(Z+1+Ae)/de,tt),ce.data,Z,re,de,ut),Z===0&&this._addTileFeatures(ce.range(1-Ae/de,Be,1,tt),ce.data,de,re,de,ut),Z===de-1&&this._addTileFeatures(ce.range(0,Be,Ae/de,tt),ce.data,-1,re,de,ut),ut.features.length?ut:null}getClusterExpansionZoom(Se){let Z=this._getOriginZoom(Se)-1;for(;Z<=this.options.maxZoom;){const re=this.getChildren(Se);if(Z++,re.length!==1)break;Se=re[0].properties.cluster_id}return Z}_appendLeaves(Se,Z,re,ce,de){const xe=this.getChildren(Z);for(const Ie of xe){const Ae=Ie.properties;if(Ae&&Ae.cluster?de+Ae.point_count<=ce?de+=Ae.point_count:de=this._appendLeaves(Se,Ae.cluster_id,re,ce,de):de<ce?de++:Se.push(Ie),Se.length===re)break}return de}_createTree(Se){const Z=new o.bz(Se.length/this.stride|0,this.options.nodeSize,Float32Array);for(let re=0;re<Se.length;re+=this.stride)Z.add(Se[re],Se[re+1]);return Z.finish(),Z.data=Se,Z}_addTileFeatures(Se,Z,re,ce,de,xe){for(const Ie of Se){const Ae=Ie*this.stride,Be=Z[Ae+Bn]>1;let tt,ut,Tt;if(Be)tt=Ke(Z,Ae,this.clusterProps),ut=Z[Ae],Tt=Z[Ae+1];else{const Gt=this.points[Z[Ae+$n]];tt=Gt.properties;const[gn,Tn]=Gt.geometry.coordinates;ut=mr(gn),Tt=Sn(Tn)}const Wt={type:1,geometry:[[Math.round(this.options.extent*(ut*de-re)),Math.round(this.options.extent*(Tt*de-ce))]],tags:tt};let Vt;Vt=Be||this.options.generateId?Z[Ae+$n]:this.points[Z[Ae+$n]].id,Vt!==void 0&&(Wt.id=Vt),xe.features.push(Wt)}}_limitZoom(Se){return Math.max(this.options.minZoom,Math.min(Math.floor(+Se),this.options.maxZoom+1))}_cluster(Se,Z){const{radius:re,extent:ce,reduce:de,minPoints:xe}=this.options,Ie=re/(ce*Math.pow(2,Z)),Ae=Se.data,Be=[],tt=this.stride;for(let ut=0;ut<Ae.length;ut+=tt){if(Ae[ut+2]<=Z)continue;Ae[ut+2]=Z;const Tt=Ae[ut],Wt=Ae[ut+1],Vt=Se.within(Ae[ut],Ae[ut+1],Ie),Gt=Ae[ut+Bn];let gn=Gt;for(const Tn of Vt){const In=Tn*tt;Ae[In+2]>Z&&(gn+=Ae[In+Bn])}if(gn>Gt&&gn>=xe){let Tn,In=Tt*Gt,Ln=Wt*Gt,dr=-1;const Zn=(ut/tt<<5)+(Z+1)+this.points.length;for(const Zr of Vt){const ri=Zr*tt;if(Ae[ri+2]<=Z)continue;Ae[ri+2]=Z;const nr=Ae[ri+Bn];In+=Ae[ri]*nr,Ln+=Ae[ri+1]*nr,Ae[ri+4]=Zn,de&&(Tn||(Tn=this._map(Ae,ut,!0),dr=this.clusterProps.length,this.clusterProps.push(Tn)),de(Tn,this._map(Ae,ri)))}Ae[ut+4]=Zn,Be.push(In/gn,Ln/gn,1/0,Zn,-1,gn),de&&Be.push(dr)}else{for(let Tn=0;Tn<tt;Tn++)Be.push(Ae[ut+Tn]);if(gn>1)for(const Tn of Vt){const In=Tn*tt;if(!(Ae[In+2]<=Z)){Ae[In+2]=Z;for(let Ln=0;Ln<tt;Ln++)Be.push(Ae[In+Ln])}}}}return Be}_getOriginId(Se){return Se-this.points.length>>5}_getOriginZoom(Se){return(Se-this.points.length)%32}_map(Se,Z,re){if(Se[Z+Bn]>1){const xe=this.clusterProps[Se[Z+$r]];return re?Object.assign({},xe):xe}const ce=this.points[Se[Z+$n]].properties,de=this.options.map(ce);return re&&de===ce?Object.assign({},de):de}}function Pn(kt,Se,Z){return{type:"Feature",id:kt[Se+$n],properties:Ke(kt,Se,Z),geometry:{type:"Point",coordinates:[(re=kt[Se],360*(re-.5)),Dr(kt[Se+1])]}};var re}function Ke(kt,Se,Z){const re=kt[Se+Bn],ce=re>=1e4?`${Math.round(re/1e3)}k`:re>=1e3?Math.round(re/100)/10+"k":re,de=kt[Se+$r],xe=de===-1?{}:Object.assign({},Z[de]);return Object.assign(xe,{cluster:!0,cluster_id:kt[Se+$n],point_count:re,point_count_abbreviated:ce})}function mr(kt){return kt/360+.5}function Sn(kt){const Se=Math.sin(kt*Math.PI/180),Z=.5-.25*Math.log((1+Se)/(1-Se))/Math.PI;return Z<0?0:Z>1?1:Z}function Dr(kt){const Se=(180-360*kt)*Math.PI/180;return 360*Math.atan(Math.exp(Se))/Math.PI-90}function Yt(kt,Se,Z,re){let ce=re;const de=Se+(Z-Se>>1);let xe,Ie=Z-Se;const Ae=kt[Se],Be=kt[Se+1],tt=kt[Z],ut=kt[Z+1];for(let Tt=Se+3;Tt<Z;Tt+=3){const Wt=Mr(kt[Tt],kt[Tt+1],Ae,Be,tt,ut);if(Wt>ce)xe=Tt,ce=Wt;else if(Wt===ce){const Vt=Math.abs(Tt-de);Vt<Ie&&(xe=Tt,Ie=Vt)}}ce>re&&(xe-Se>3&&Yt(kt,Se,xe,re),kt[xe+2]=ce,Z-xe>3&&Yt(kt,xe,Z,re))}function Mr(kt,Se,Z,re,ce,de){let xe=ce-Z,Ie=de-re;if(xe!==0||Ie!==0){const Ae=((kt-Z)*xe+(Se-re)*Ie)/(xe*xe+Ie*Ie);Ae>1?(Z=ce,re=de):Ae>0&&(Z+=xe*Ae,re+=Ie*Ae)}return xe=kt-Z,Ie=Se-re,xe*xe+Ie*Ie}function Qn(kt,Se,Z,re){const ce={id:kt??null,type:Se,geometry:Z,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")Ar(ce,Z);else if(Se==="Polygon")Ar(ce,Z[0]);else if(Se==="MultiLineString")for(const de of Z)Ar(ce,de);else if(Se==="MultiPolygon")for(const de of Z)Ar(ce,de[0]);return ce}function Ar(kt,Se){for(let Z=0;Z<Se.length;Z+=3)kt.minX=Math.min(kt.minX,Se[Z]),kt.minY=Math.min(kt.minY,Se[Z+1]),kt.maxX=Math.max(kt.maxX,Se[Z]),kt.maxY=Math.max(kt.maxY,Se[Z+1])}function sr(kt,Se,Z,re){if(!Se.geometry)return;const ce=Se.geometry.coordinates;if(ce&&ce.length===0)return;const de=Se.geometry.type,xe=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2);let Ie=[],Ae=Se.id;if(Z.promoteId?Ae=Se.properties[Z.promoteId]:Z.generateId&&(Ae=re||0),de==="Point")_i(ce,Ie);else if(de==="MultiPoint")for(const Be of ce)_i(Be,Ie);else if(de==="LineString")Wi(ce,Ie,xe,!1);else if(de==="MultiLineString"){if(Z.lineMetrics){for(const Be of ce)Ie=[],Wi(Be,Ie,xe,!1),kt.push(Qn(Ae,"LineString",Ie,Se.properties));return}ii(ce,Ie,xe,!1)}else if(de==="Polygon")ii(ce,Ie,xe,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(const Be of Se.geometry.geometries)sr(kt,{id:Ae,geometry:Be,properties:Se.properties},Z,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of ce){const tt=[];ii(Be,tt,xe,!0),Ie.push(tt)}}kt.push(Qn(Ae,de,Ie,Se.properties))}function _i(kt,Se){Se.push(Pi(kt[0]),yi(kt[1]),0)}function Wi(kt,Se,Z,re){let ce,de,xe=0;for(let Ae=0;Ae<kt.length;Ae++){const Be=Pi(kt[Ae][0]),tt=yi(kt[Ae][1]);Se.push(Be,tt,0),Ae>0&&(xe+=re?(ce*tt-Be*de)/2:Math.sqrt(Math.pow(Be-ce,2)+Math.pow(tt-de,2))),ce=Be,de=tt}const Ie=Se.length-3;Se[2]=1,Yt(Se,0,Ie,Z),Se[Ie+2]=1,Se.size=Math.abs(xe),Se.start=0,Se.end=Se.size}function ii(kt,Se,Z,re){for(let ce=0;ce<kt.length;ce++){const de=[];Wi(kt[ce],de,Z,re),Se.push(de)}}function Pi(kt){return kt/360+.5}function yi(kt){const Se=Math.sin(kt*Math.PI/180),Z=.5-.25*Math.log((1+Se)/(1-Se))/Math.PI;return Z<0?0:Z>1?1:Z}function lr(kt,Se,Z,re,ce,de,xe,Ie){if(re/=Se,de>=(Z/=Se)&&xe<re)return kt;if(xe<Z||de>=re)return null;const Ae=[];for(const Be of kt){const tt=Be.geometry;let ut=Be.type;const Tt=ce===0?Be.minX:Be.minY,Wt=ce===0?Be.maxX:Be.maxY;if(Tt>=Z&&Wt<re){Ae.push(Be);continue}if(Wt<Z||Tt>=re)continue;let Vt=[];if(ut==="Point"||ut==="MultiPoint")qo(tt,Vt,Z,re,ce);else if(ut==="LineString")ea(tt,Vt,Z,re,ce,!1,Ie.lineMetrics);else if(ut==="MultiLineString")Fi(tt,Vt,Z,re,ce,!1);else if(ut==="Polygon")Fi(tt,Vt,Z,re,ce,!0);else if(ut==="MultiPolygon")for(const Gt of tt){const gn=[];Fi(Gt,gn,Z,re,ce,!0),gn.length&&Vt.push(gn)}if(Vt.length){if(Ie.lineMetrics&&ut==="LineString"){for(const Gt of Vt)Ae.push(Qn(Be.id,ut,Gt,Be.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(Vt.length===1?(ut="LineString",Vt=Vt[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=Vt.length===3?"Point":"MultiPoint"),Ae.push(Qn(Be.id,ut,Vt,Be.tags))}}return Ae.length?Ae:null}function qo(kt,Se,Z,re,ce){for(let de=0;de<kt.length;de+=3){const xe=kt[de+ce];xe>=Z&&xe<=re&&Mo(Se,kt[de],kt[de+1],kt[de+2])}}function ea(kt,Se,Z,re,ce,de,xe){let Ie=la(kt);const Ae=ce===0?ta:va;let Be,tt,ut=kt.start;for(let gn=0;gn<kt.length-3;gn+=3){const Tn=kt[gn],In=kt[gn+1],Ln=kt[gn+2],dr=kt[gn+3],Zn=kt[gn+4],Zr=ce===0?Tn:In,ri=ce===0?dr:Zn;let nr=!1;xe&&(Be=Math.sqrt(Math.pow(Tn-dr,2)+Math.pow(In-Zn,2))),Zr<Z?ri>Z&&(tt=Ae(Ie,Tn,In,dr,Zn,Z),xe&&(Ie.start=ut+Be*tt)):Zr>re?ri<re&&(tt=Ae(Ie,Tn,In,dr,Zn,re),xe&&(Ie.start=ut+Be*tt)):Mo(Ie,Tn,In,Ln),ri<Z&&Zr>=Z&&(tt=Ae(Ie,Tn,In,dr,Zn,Z),nr=!0),ri>re&&Zr<=re&&(tt=Ae(Ie,Tn,In,dr,Zn,re),nr=!0),!de&&nr&&(xe&&(Ie.end=ut+Be*tt),Se.push(Ie),Ie=la(kt)),xe&&(ut+=Be)}let Tt=kt.length-3;const Wt=kt[Tt],Vt=kt[Tt+1],Gt=ce===0?Wt:Vt;Gt>=Z&&Gt<=re&&Mo(Ie,Wt,Vt,kt[Tt+2]),Tt=Ie.length-3,de&&Tt>=3&&(Ie[Tt]!==Ie[0]||Ie[Tt+1]!==Ie[1])&&Mo(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&Se.push(Ie)}function la(kt){const Se=[];return Se.size=kt.size,Se.start=kt.start,Se.end=kt.end,Se}function Fi(kt,Se,Z,re,ce,de){for(const xe of kt)ea(xe,Se,Z,re,ce,de,!1)}function Mo(kt,Se,Z,re){kt.push(Se,Z,re)}function ta(kt,Se,Z,re,ce,de){const xe=(de-Se)/(re-Se);return Mo(kt,de,Z+(ce-Z)*xe,1),xe}function va(kt,Se,Z,re,ce,de){const xe=(de-Z)/(ce-Z);return Mo(kt,Se+(re-Se)*xe,de,1),xe}function za(kt,Se){const Z=[];for(let re=0;re<kt.length;re++){const ce=kt[re],de=ce.type;let xe;if(de==="Point"||de==="MultiPoint"||de==="LineString")xe=so(ce.geometry,Se);else if(de==="MultiLineString"||de==="Polygon"){xe=[];for(const Ie of ce.geometry)xe.push(so(Ie,Se))}else if(de==="MultiPolygon"){xe=[];for(const Ie of ce.geometry){const Ae=[];for(const Be of Ie)Ae.push(so(Be,Se));xe.push(Ae)}}Z.push(Qn(ce.id,de,xe,ce.tags))}return Z}function so(kt,Se){const Z=[];Z.size=kt.size,kt.start!==void 0&&(Z.start=kt.start,Z.end=kt.end);for(let re=0;re<kt.length;re+=3)Z.push(kt[re]+Se,kt[re+1],kt[re+2]);return Z}function Lo(kt,Se){if(kt.transformed)return kt;const Z=1<<kt.z,re=kt.x,ce=kt.y;for(const de of kt.features){const xe=de.geometry,Ie=de.type;if(de.geometry=[],Ie===1)for(let Ae=0;Ae<xe.length;Ae+=2)de.geometry.push(es(xe[Ae],xe[Ae+1],Se,Z,re,ce));else for(let Ae=0;Ae<xe.length;Ae++){const Be=[];for(let tt=0;tt<xe[Ae].length;tt+=2)Be.push(es(xe[Ae][tt],xe[Ae][tt+1],Se,Z,re,ce));de.geometry.push(Be)}}return kt.transformed=!0,kt}function es(kt,Se,Z,re,ce,de){return[Math.round(Z*(kt*re-ce)),Math.round(Z*(Se*re-de))]}function Go(kt,Se,Z,re,ce){const de=Se===ce.maxZoom?0:ce.tolerance/((1<<Se)*ce.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:kt.length,source:null,x:Z,y:re,z:Se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ie of kt)Fa(xe,Ie,de,ce);return xe}function Fa(kt,Se,Z,re){const ce=Se.geometry,de=Se.type,xe=[];if(kt.minX=Math.min(kt.minX,Se.minX),kt.minY=Math.min(kt.minY,Se.minY),kt.maxX=Math.max(kt.maxX,Se.maxX),kt.maxY=Math.max(kt.maxY,Se.maxY),de==="Point"||de==="MultiPoint")for(let Ie=0;Ie<ce.length;Ie+=3)xe.push(ce[Ie],ce[Ie+1]),kt.numPoints++,kt.numSimplified++;else if(de==="LineString")Er(xe,ce,kt,Z,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(let Ie=0;Ie<ce.length;Ie++)Er(xe,ce[Ie],kt,Z,de==="Polygon",Ie===0);else if(de==="MultiPolygon")for(let Ie=0;Ie<ce.length;Ie++){const Ae=ce[Ie];for(let Be=0;Be<Ae.length;Be++)Er(xe,Ae[Be],kt,Z,!0,Be===0)}if(xe.length){let Ie=Se.tags||null;if(de==="LineString"&&re.lineMetrics){Ie={};for(const Be in Se.tags)Ie[Be]=Se.tags[Be];Ie.mapbox_clip_start=ce.start/ce.size,Ie.mapbox_clip_end=ce.end/ce.size}const Ae={geometry:xe,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Ie};Se.id!==null&&(Ae.id=Se.id),kt.features.push(Ae)}}function Er(kt,Se,Z,re,ce,de){const xe=re*re;if(re>0&&Se.size<(ce?xe:re))return void(Z.numPoints+=Se.length/3);const Ie=[];for(let Ae=0;Ae<Se.length;Ae+=3)(re===0||Se[Ae+2]>xe)&&(Z.numSimplified++,Ie.push(Se[Ae],Se[Ae+1])),Z.numPoints++;ce&&function(Ae,Be){let tt=0;for(let ut=0,Tt=Ae.length,Wt=Tt-2;ut<Tt;Wt=ut,ut+=2)tt+=(Ae[ut]-Ae[Wt])*(Ae[ut+1]+Ae[Wt+1]);if(tt>0===Be)for(let ut=0,Tt=Ae.length;ut<Tt/2;ut+=2){const Wt=Ae[ut],Vt=Ae[ut+1];Ae[ut]=Ae[Tt-2-ut],Ae[ut+1]=Ae[Tt-1-ut],Ae[Tt-2-ut]=Wt,Ae[Tt-1-ut]=Vt}}(Ie,de),kt.push(Ie)}const go={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ia{constructor(Se,Z){const re=(Z=this.options=function(de,xe){for(const Ie in xe)de[Ie]=xe[Ie];return de}(Object.create(go),Z)).debug;if(re&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");let ce=function(de,xe){const Ie=[];if(de.type==="FeatureCollection")for(let Ae=0;Ae<de.features.length;Ae++)sr(Ie,de.features[Ae],xe,Ae);else sr(Ie,de.type==="Feature"?de:{geometry:de},xe);return Ie}(Se,Z);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ce=function(de,xe){const Ie=xe.buffer/xe.extent;let Ae=de;const Be=lr(de,1,-1-Ie,Ie,0,-1,2,xe),tt=lr(de,1,1-Ie,2+Ie,0,-1,2,xe);return(Be||tt)&&(Ae=lr(de,1,-Ie,1+Ie,0,-1,2,xe)||[],Be&&(Ae=za(Be,1).concat(Ae)),tt&&(Ae=Ae.concat(za(tt,-1)))),Ae}(ce,Z),ce.length&&this.splitTile(ce,0,0,0),re&&(ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Se,Z,re,ce,de,xe,Ie){const Ae=[Se,Z,re,ce],Be=this.options,tt=Be.debug;for(;Ae.length;){ce=Ae.pop(),re=Ae.pop(),Z=Ae.pop(),Se=Ae.pop();const ut=1<<Z,Tt=Di(Z,re,ce);let Wt=this.tiles[Tt];if(!Wt&&(tt>1&&console.time("creation"),Wt=this.tiles[Tt]=Go(Se,Z,re,ce,Be),this.tileCoords.push({z:Z,x:re,y:ce}),tt)){tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,re,ce,Wt.numFeatures,Wt.numPoints,Wt.numSimplified),console.timeEnd("creation"));const nr=`z${Z}`;this.stats[nr]=(this.stats[nr]||0)+1,this.total++}if(Wt.source=Se,de==null){if(Z===Be.indexMaxZoom||Wt.numPoints<=Be.indexMaxPoints)continue}else{if(Z===Be.maxZoom||Z===de)continue;if(de!=null){const nr=de-Z;if(re!==xe>>nr||ce!==Ie>>nr)continue}}if(Wt.source=null,Se.length===0)continue;tt>1&&console.time("clipping");const Vt=.5*Be.buffer/Be.extent,Gt=.5-Vt,gn=.5+Vt,Tn=1+Vt;let In=null,Ln=null,dr=null,Zn=null,Zr=lr(Se,ut,re-Vt,re+gn,0,Wt.minX,Wt.maxX,Be),ri=lr(Se,ut,re+Gt,re+Tn,0,Wt.minX,Wt.maxX,Be);Se=null,Zr&&(In=lr(Zr,ut,ce-Vt,ce+gn,1,Wt.minY,Wt.maxY,Be),Ln=lr(Zr,ut,ce+Gt,ce+Tn,1,Wt.minY,Wt.maxY,Be),Zr=null),ri&&(dr=lr(ri,ut,ce-Vt,ce+gn,1,Wt.minY,Wt.maxY,Be),Zn=lr(ri,ut,ce+Gt,ce+Tn,1,Wt.minY,Wt.maxY,Be),ri=null),tt>1&&console.timeEnd("clipping"),Ae.push(In||[],Z+1,2*re,2*ce),Ae.push(Ln||[],Z+1,2*re,2*ce+1),Ae.push(dr||[],Z+1,2*re+1,2*ce),Ae.push(Zn||[],Z+1,2*re+1,2*ce+1)}}getTile(Se,Z,re){Se=+Se,Z=+Z,re=+re;const ce=this.options,{extent:de,debug:xe}=ce;if(Se<0||Se>24)return null;const Ie=1<<Se,Ae=Di(Se,Z=Z+Ie&Ie-1,re);if(this.tiles[Ae])return Lo(this.tiles[Ae],de);xe>1&&console.log("drilling down to z%d-%d-%d",Se,Z,re);let Be,tt=Se,ut=Z,Tt=re;for(;!Be&&tt>0;)tt--,ut>>=1,Tt>>=1,Be=this.tiles[Di(tt,ut,Tt)];return Be&&Be.source?(xe>1&&(console.log("found parent tile z%d-%d-%d",tt,ut,Tt),console.time("drilling down")),this.splitTile(Be.source,tt,ut,Tt,Se,Z,re),xe>1&&console.timeEnd("drilling down"),this.tiles[Ae]?Lo(this.tiles[Ae],de):null):null}}function Di(kt,Se,Z){return 32*((1<<kt)*Z+Se)+kt}function vi(kt,Se){const Z=kt.tileID.canonical;if(!this._geoJSONIndex)return void Se(null,null);const re=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!re)return void Se(null,null);const ce=new ve(re.features);let de=mt(ce);de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),Se(null,{vectorTile:ce,rawData:de.buffer})}class bi extends ue{constructor(Se,Z,re,ce,de,xe){super(Se,Z,re,ce,vi,xe),de&&(this.loadGeoJSON=de),this._dynamicIndex=new lt}loadData(Se,Z){const re=Se&&Se.request,ce=re&&re.collectResourceTiming;this.loadGeoJSON(Se,(de,xe)=>{if(de||!xe)return Z(de);if(typeof xe!="object")return Z(new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`));{try{if(Se.filter){const Ae=o.M(Se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ae.result==="error")throw new Error(Ae.value.map(Be=>`${Be.key}: ${Be.message}`).join(", "));xe.features=xe.features.filter(Be=>Ae.value.evaluate({zoom:0},Be))}Se.dynamic?(xe.type==="Feature"&&(xe={type:"FeatureCollection",features:[xe]}),Se.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xe.features,this.loaded),Se.cluster&&(xe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Se.cluster?new _r(function({superclusterOptions:Ae,clusterProperties:Be}){if(!Be||!Ae)return Ae;const tt={},ut={},Tt={accumulated:null,zoom:0},Wt={properties:null},Vt=Object.keys(Be);for(const Gt of Vt){const[gn,Tn]=Be[Gt],In=o.M(Tn),Ln=o.M(typeof gn=="string"?[gn,["accumulated"],["get",Gt]]:gn);tt[Gt]=In.value,ut[Gt]=Ln.value}return Ae.map=Gt=>{Wt.properties=Gt;const gn={};for(const Tn of Vt)gn[Tn]=tt[Tn].evaluate(Tt,Wt);return gn},Ae.reduce=(Gt,gn)=>{Wt.properties=gn;for(const Tn of Vt)Tt.accumulated=Gt[Tn],Gt[Tn]=ut[Tn].evaluate(Tt,Wt)},Ae}(Se)).load(xe.features):Se.dynamic?this._dynamicIndex:function(Ae,Be){return new Ia(Ae,Be)}(xe,Se.geojsonVtOptions)}catch(Ae){return Z(Ae)}const Ie={};if(ce){const Ae=I(re);Ae&&(Ie.resourceTiming={},Ie.resourceTiming[Se.source]=JSON.parse(JSON.stringify(Ae)))}Z(null,Ie)}})}reloadTile(Se,Z){const re=this.loaded;return re&&re[Se.uid]?Se.partial?Z(null,void 0):super.reloadTile(Se,Z):this.loadTile(Se,Z)}loadGeoJSON(Se,Z){if(Se.request)o.n(Se.request,Z);else{if(typeof Se.data!="string")return Z(new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`));try{return Z(null,JSON.parse(Se.data))}catch{return Z(new Error(`Input data given to '${Se.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Se,Z){try{Z(null,this._geoJSONIndex.getClusterExpansionZoom(Se.clusterId))}catch(re){Z(re)}}getClusterChildren(Se,Z){try{Z(null,this._geoJSONIndex.getChildren(Se.clusterId))}catch(re){Z(re)}}getClusterLeaves(Se,Z){try{Z(null,this._geoJSONIndex.getLeaves(Se.clusterId,Se.limit,Se.offset))}catch(re){Z(re)}}}class Mi{constructor(Se,Z){this.tileID=new o.aA(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),this.tileZoom=Se.tileZoom,this.uid=Se.uid,this.zoom=Se.zoom,this.canonical=Se.tileID.canonical,this.pixelRatio=Se.pixelRatio,this.tileSize=Se.tileSize,this.source=Se.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Se.projection,this.brightness=Z}parse(Se,Z,re,ce){this.status="parsing";const de=new o.aA(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),xe=[],Ie=Z.familiesBySource[re.source],Ae=new o.dR(de,re.promoteId);return Ae.bucketLayerIDs=[],Ae.is3DTile=!0,o.e0(Se).then(Be=>{if(!Be)return ce(new Error("Could not parse tile"));const tt=o.e1(Be,1/o.c9(re.tileID.canonical)),ut=Be.json.extensionsUsed&&Be.json.extensionsUsed.includes("MAPBOX_mesh_features")||Be.json.asset.extras&&Be.json.asset.extras.MAPBOX_mesh_features,Tt=Be.json.extensionsUsed&&Be.json.extensionsUsed.includes("EXT_meshopt_compression"),Wt=new o.a3(this.zoom,{brightness:this.brightness});for(const Vt in Ie)for(const Gt of Ie[Vt]){const gn=Gt[0];Ae.bucketLayerIDs.push(Gt.map(In=>o.av(In.id,In.scope))),gn.recalculate(Wt,[]);const Tn=new o.e2(Gt,tt,de,ut,Tt,this.brightness,Ae);ut||(Tn.needsUpload=!0),xe.push(Tn),Tn.evaluate(gn)}this.status="done",ce(null,{buckets:xe,featureIndex:Ae,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Be=>ce(new Error(Be.message)))}}class Fo{constructor(Se,Z,re,ce,de,xe){this.actor=Se,this.layerIndex=Z,this.availableImages=re,this.brightness=xe,this.loading={},this.loaded={}}loadTile(Se,Z){const re=Se.uid,ce=this.loading[re]=new Mi(Se,this.brightness);o.bd(Se.request,(de,xe)=>{const Ie=!this.loading[re];return delete this.loading[re],Ie||de?(ce.status="done",Ie||(this.loaded[re]=ce),Z(de)):xe&&xe.byteLength!==0?void ce.parse(xe,this.layerIndex,Se,(Ae,Be)=>{ce.status="done",this.loaded=this.loaded||{},this.loaded[re]=ce,Ae||!Be?Z(Ae):Z(null,Be)}):(ce.status="done",this.loaded[re]=ce,Z())})}reloadTile(Se,Z){const re=this.loaded,ce=Se.uid;if(re&&re[ce]){const de=re[ce];de.projection=Se.projection,de.brightness=Se.brightness;const xe=(Ie,Ae)=>{de.reloadCallback&&(delete de.reloadCallback,this.loadTile(Se,Z)),Z(Ie,Ae)};de.status==="parsing"?de.reloadCallback=xe:de.status==="done"&&this.loadTile(Se,Z)}}abortTile(Se,Z){const re=Se.uid;this.loading[re]&&delete this.loading[re],Z()}removeTile(Se,Z){const re=this.loaded,ce=Se.uid;re&&re[ce]&&delete re[ce],Z()}}class na{constructor(Se){this.self=Se,this.actor=new o.e3(Se,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.bM({name:"mercator"}),this.workerSourceTypes={vector:ue,geojson:bi,"batched-model":Fo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Z,re)=>{if(this.workerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.workerSourceTypes[Z]=re},this.self.registerRTLTextPlugin=Z=>{if(o.e4.isParsed())throw new Error("RTL text plugin already registered.");o.e4.applyArabicShaping=Z.applyArabicShaping,o.e4.processBidirectionalText=Z.processBidirectionalText,o.e4.processStyledBidirectionalText=Z.processStyledBidirectionalText}}clearCaches(Se,Z,re){delete this.layerIndexes[Se],delete this.availableImages[Se],delete this.workerSources[Se],delete this.demWorkerSources[Se],delete this.rasterArrayWorkerSource,re()}checkIfReady(Se,Z,re){re()}setReferrer(Se,Z){this.referrer=Z}spriteLoaded(Se,{scope:Z,isLoaded:re}){if(this.isSpriteLoaded[Se]||(this.isSpriteLoaded[Se]={}),this.isSpriteLoaded[Se][Z]=re,this.workerSources[Se]&&this.workerSources[Se][Z])for(const ce in this.workerSources[Se][Z]){const de=this.workerSources[Se][Z][ce];for(const xe in de){const Ie=de[xe];Ie instanceof ue&&(Ie.isSpriteLoaded=re,Ie.fire(new o.x("isSpriteLoaded")))}}}setImages(Se,{scope:Z,images:re},ce){if(this.availableImages[Se]||(this.availableImages[Se]={}),this.availableImages[Se][Z]=re,this.workerSources[Se]&&this.workerSources[Se][Z]){for(const de in this.workerSources[Se][Z]){const xe=this.workerSources[Se][Z][de];for(const Ie in xe)xe[Ie].availableImages=re}ce()}else ce()}setProjection(Se,Z){this.projections[Se]=o.bM(Z)}setBrightness(Se,Z,re){this.brightness=Z,re()}setLayers(Se,Z,re){this.getLayerIndex(Se,Z.scope).replace(Z.layers,Z.options),re()}updateLayers(Se,Z,re){this.getLayerIndex(Se,Z.scope).update(Z.layers,Z.removedIds,Z.options),re()}loadTile(Se,Z,re){Z.projection=this.projections[Se]||this.defaultProjection,this.getWorkerSource(Se,Z.type,Z.source,Z.scope).loadTile(Z,re)}loadDEMTile(Se,Z,re){this.getDEMWorkerSource(Se,Z.source,Z.scope).loadTile(Z,re)}decodeRasterArray(Se,Z,re){this.getRasterArrayWorkerSource().decodeRasterArray(Z,re)}reloadTile(Se,Z,re){Z.projection=this.projections[Se]||this.defaultProjection,this.getWorkerSource(Se,Z.type,Z.source,Z.scope).reloadTile(Z,re)}abortTile(Se,Z,re){this.getWorkerSource(Se,Z.type,Z.source,Z.scope).abortTile(Z,re)}removeTile(Se,Z,re){this.getWorkerSource(Se,Z.type,Z.source,Z.scope).removeTile(Z,re)}removeSource(Se,Z,re){if(!(this.workerSources[Se]&&this.workerSources[Se][Z.scope]&&this.workerSources[Se][Z.scope][Z.type]&&this.workerSources[Se][Z.scope][Z.type][Z.source]))return;const ce=this.workerSources[Se][Z.scope][Z.type][Z.source];delete this.workerSources[Se][Z.scope][Z.type][Z.source],ce.removeSource!==void 0?ce.removeSource(Z,re):re()}loadWorkerSource(Se,Z,re){try{this.self.importScripts(Z.url),re()}catch(ce){re(ce.toString())}}syncRTLPluginState(Se,Z,re){try{o.e4.setState(Z);const ce=o.e4.getPluginURL();if(o.e4.isLoaded()&&!o.e4.isParsed()&&ce!=null){this.self.importScripts(ce);const de=o.e4.isParsed();re(de?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),de)}}catch(ce){re(ce.toString())}}setDracoUrl(Se,Z){this.dracoUrl=Z}getAvailableImages(Se,Z){this.availableImages[Se]||(this.availableImages[Se]={});let re=this.availableImages[Se][Z];return re||(re=[]),re}getLayerIndex(Se,Z){this.layerIndexes[Se]||(this.layerIndexes[Se]={});let re=this.layerIndexes[Se][Z];return re||(re=this.layerIndexes[Se][Z]=new U,re.scope=Z),re}getWorkerSource(Se,Z,re,ce){return this.workerSources[Se]||(this.workerSources[Se]={}),this.workerSources[Se][ce]||(this.workerSources[Se][ce]={}),this.workerSources[Se][ce][Z]||(this.workerSources[Se][ce][Z]={}),this.isSpriteLoaded[Se]||(this.isSpriteLoaded[Se]={}),this.workerSources[Se][ce][Z][re]||(this.workerSources[Se][ce][Z][re]=new this.workerSourceTypes[Z]({send:(de,xe,Ie,Ae,Be,tt)=>{this.actor.send(de,xe,Ie,Se,Be,tt)},scheduler:this.actor.scheduler},this.getLayerIndex(Se,ce),this.getAvailableImages(Se,ce),this.isSpriteLoaded[Se][ce],void 0,this.brightness)),this.workerSources[Se][ce][Z][re]}getDEMWorkerSource(Se,Z,re){return this.demWorkerSources[Se]||(this.demWorkerSources[Se]={}),this.demWorkerSources[Se][re]||(this.demWorkerSources[Se][re]={}),this.demWorkerSources[Se][re][Z]||(this.demWorkerSources[Se][re][Z]=new be),this.demWorkerSources[Se][re][Z]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Ce),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Se,Z){o.e5(Z)}getWorkerPerformanceMetrics(Se,Z,re){re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new na(self)),na}),v(["./shared"],function(o){var I="3.8.0";const B={create:"create",load:"load",fullLoad:"fullLoad"},$={mark(d){performance.mark(d)},measure(d,r,l){performance.measure(d,r,l)}};function U(d){const r=d.name.split("?")[0];return o.a(r)&&r.includes("mapbox-gl.js")?"javascript":o.a(r)&&r.includes("mapbox-gl.css")?"css":o.b(r)?"fontRange":o.c(r)?"sprite":o.i(r)?"style":o.d(r)?"tilejson":"other"}var K,te={},le=function(){if(K)return te;function d(p){return!r(p)}function r(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var T,A,F=new Blob([""],{type:"text/javascript"}),j=URL.createObjectURL(F);try{A=new Worker(j),T=!0}catch{T=!1}return A&&A.terminate(),URL.revokeObjectURL(j),T}()?function(){var T=document.createElement("canvas");T.width=T.height=1;var A=T.getContext("2d");if(!A)return!1;var F=A.getImageData(0,0,1,1);return F&&F.width===T.width}()?(l[x=p&&p.failIfMajorPerformanceCaveat]===void 0&&(l[x]=function(T){var A,F=function(j){var H=document.createElement("canvas"),q=Object.create(d.webGLContextAttributes);return q.failIfMajorPerformanceCaveat=j,H.getContext("webgl2",q)}(T);if(!F)return!1;try{A=F.createShader(F.VERTEX_SHADER)}catch{return!1}return!(!A||F.isContextLost())&&(F.shaderSource(A,"void main() {}"),F.compileShader(A),F.getShaderParameter(A,F.COMPILE_STATUS)===!0)}(x)),l[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}K=1,te.supported=d,te.notSupportedReason=r;var l={};return d.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},te}();function se(d,r,l){const p=document.createElement(d);return r!=null&&(p.className=r),l&&l.appendChild(p),p}function ue(d,r,l){const p=document.createElementNS("http://www.w3.org/2000/svg",d);for(const x of Object.keys(r))p.setAttributeNS(null,x,String(r[x]));return l&&l.appendChild(p),p}const be=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Ce=be&&be.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Re;function De(){be&&Ce&&(Re=be[Ce],be[Ce]="none")}function ve(){be&&Ce&&(be[Ce]=Re)}function Le(d){d.preventDefault(),d.stopPropagation(),window.removeEventListener("click",Le,!0)}function Fe(){window.addEventListener("click",Le,!0),window.setTimeout(()=>{window.removeEventListener("click",Le,!0)},0)}function lt(d,r){const l=d.getBoundingClientRect();return Je(d,l,r)}function xt(d,r){const l=d.getBoundingClientRect(),p=[];for(let x=0;x<r.length;x++)p.push(Je(d,l,r[x]));return p}function gt(d){return window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function Je(d,r,l){const p=d.offsetWidth===r.width?1:d.offsetWidth/r.width;return new o.P((l.clientX-r.left)*p,(l.clientY-r.top)*p)}const St="01",Nt="NO_ACCESS_TOKEN";class Ht{constructor(r,l,p){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let p=0;p<10;p++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",St,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!o.f(r))return r;const p=Kt(r);return p.params.push(`sdk=js-${I}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!o.f(r))return r;const p=Kt(r);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeModelURL(r,l){if(!o.f(r))return r;const p=Kt(r);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeSourceURL(r,l,p,x){if(!o.f(r))return r;const T=Kt(r);return T.path=`/v4/${T.authority}.json`,T.params.push("secure"),p&&T.params.push(`language=${p}`),x&&T.params.push(`worldview=${x}`),this._makeAPIURL(T,this._customAccessToken||l)}normalizeSpriteURL(r,l,p,x){const T=Kt(r);return o.f(r)?(T.path=`/styles/v1${T.path}/sprite${l}${p}`,this._makeAPIURL(T,this._customAccessToken||x)):(T.path+=`${l}${p}`,Lt(T))}normalizeTileURL(r,l,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!o.f(r))return r;const x=Kt(r);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||p&&x.authority!=="raster"&&p===512?"@2x":""}${o.m.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${o.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${o.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${o.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${o.e.TILE_URL_VERSION}${x.path}`);const T=this._customAccessToken||function(A){for(const F of A){const j=F.match(/^access_token=(.*)$/);if(j)return j[1]}return null}(x.params)||o.e.ACCESS_TOKEN;return o.e.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,T)}canonicalizeTileURL(r,l){const p=Kt(r);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return r;let x="mapbox://";p.path.match(/^\/raster\/v1\//)?x+=`raster/${p.path.replace(`/${o.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${p.path.replace(`/${o.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${p.path.replace(`/${o.e.TILE_URL_VERSION}/`,"")}`;let T=p.params;return l&&(T=T.filter(A=>!A.match(/^access_token=/))),T.length&&(x+=`?${T.join("&")}`),x}canonicalizeTileset(r,l){const p=!!l&&o.f(l),x=[];for(const T of r.tiles||[])o.h(T)?x.push(this.canonicalizeTileURL(T,p)):x.push(T);return x}_makeAPIURL(r,l){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=Kt(o.e.API_URL);if(r.protocol=x.protocol,r.authority=x.authority,r.protocol==="http"){const T=r.params.indexOf("secure");T>=0&&r.params.splice(T,1)}if(x.path!=="/"&&(r.path=`${x.path}${r.path}`),!o.e.REQUIRE_ACCESS_TOKEN)return Lt(r);if(l=l||o.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return r.params=r.params.filter(T=>T.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),Lt(r)}}const Ct=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Kt(d){const r=d.match(Ct);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Lt(d){const r=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${r}`}const et="mapbox.eventData";function vt(d){if(!d)return null;const r=d.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(o.j(r[1]))}catch{return null}}class Ot{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=vt(o.e.ACCESS_TOKEN);let p="";return p=l&&l.u?o.k(l.u):o.e.ACCESS_TOKEN||"",r?`${et}.${r}:${p}`:`${et}:${p}`}fetchEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const x=localStorage.getItem(l);x&&(this.eventData=JSON.parse(x));const T=localStorage.getItem(p);T&&(this.anonId=T)}catch{o.w("Unable to read from LocalStorage")}}saveEventData(){const r=o.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid"),x=this.anonId;if(r&&x)try{localStorage.setItem(p,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{o.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,p,x){if(!o.e.EVENTS_URL)return;const T=Kt(o.e.EVENTS_URL);T.params.push(`access_token=${x||o.e.ACCESS_TOKEN||""}`);const A={event:this.type,created:new Date(r).toISOString()},F=l?o.l(A,l):A,j={url:Lt(T),headers:{"Content-Type":"text/plain"},body:JSON.stringify([F])};this.pendingRequest=o.p(j,H=>{this.pendingRequest=null,p(H),this.saveEventData(),this.processRequests(x)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const mt=new class extends Ot{constructor(d){super("appUserTurnstile"),this._customAccessToken=d}postTurnstileEvent(d,r){o.e.EVENTS_URL&&o.e.ACCESS_TOKEN&&Array.isArray(d)&&d.some(l=>o.f(l)||o.h(l))&&this.queueRequest(Date.now(),r)}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=vt(o.e.ACCESS_TOKEN),l=r?r.u:o.e.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;o.v(this.anonId)||(this.anonId=o.u(),p=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const T=new Date(this.eventData.lastSuccess),A=new Date(x),F=(x-this.eventData.lastSuccess)/864e5;p=p||F>=1||F<-1||T.getDate()!==A.getDate()}else p=!0;p?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:St,"enabled.telemetry":!1,userId:this.anonId},T=>{T||(this.eventData.lastSuccess=x,this.eventData.tokenU=l)},d):this.processRequests()}},zt=mt.postTurnstileEvent.bind(mt),Jt=new class extends Ot{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(d,r,l,p){this.skuToken=r,this.errorCb=p,o.e.EVENTS_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:d,timestamp:Date.now()},l):this.errorCb(new Error(Nt)))}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),o.v(this.anonId)||(this.anonId=o.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:St,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},d))}remove(){this.errorCb=null}},Un=Jt.postMapLoadEvent.bind(Jt),$n=new class extends Ot{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(d){let r=this.mapInstanceIdMap.get(d);return r||(r=o.u(),this.mapInstanceIdMap.set(d,r)),r}getEventId(d){const r=this.eventIdPerMapInstanceMap.get(d)||0;return this.eventIdPerMapInstanceMap.set(d,r+1),r}postStyleLoadEvent(d,r){const{map:l,style:p,importedStyles:x}=r;if(!o.e.EVENTS_URL||!d&&!o.e.ACCESS_TOKEN)return;const T=this.getMapInstanceId(l),A={mapInstanceId:T,eventId:this.getEventId(T),style:p};x.length&&(A.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:A},d)}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},d)}},Bn=$n.postStyleLoadEvent.bind($n),$r=new class extends Ot{constructor(){super("gljs.performance")}postPerformanceEvent(d,r){o.e.EVENTS_URL&&(d||o.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},d)}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),p=function(x){const T=performance.getEntriesByType("resource"),A=performance.getEntriesByType("mark"),F=function(ae){const ge={};if(ae){for(const _e in ae)if(_e!=="other")for(const Te of ae[_e]){const we=`${_e}ResolveRangeMin`,ze=`${_e}ResolveRangeMax`,Ue=`${_e}RequestCount`,ke=`${_e}RequestCachedCount`;ge[we]=Math.min(ge[we]||1/0,Te.startTime),ge[ze]=Math.max(ge[ze]||-1/0,Te.responseEnd);const He=Ye=>{ge[Ye]===void 0&&(ge[Ye]=0),++ge[Ye]};Te.transferSize!==void 0&&Te.transferSize===0&&He(ke),He(Ue)}}return ge}(function(ae,ge){const _e={};if(ae)for(const Te of ae){const we=ge(Te);_e[we]===void 0&&(_e[we]=[]),_e[we].push(Te)}return _e}(T,U)),j=window.devicePixelRatio,H=navigator.connection||navigator.mozConnection||navigator.webkitConnection,q=H?H.effectiveType:void 0,Y={counters:[],metadata:[],attributes:[]},Q=(ae,ge,_e)=>{_e!=null&&ae.push({name:ge,value:_e.toString()})};for(const ae in F)Q(Y.counters,ae,F[ae]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(Q(Y.counters,"interactionRangeMin",x.interactionRange[0]),Q(Y.counters,"interactionRangeMax",x.interactionRange[1])),A)for(const ae of Object.keys(B)){const ge=B[ae],_e=A.find(Te=>Te.name===ge);_e&&Q(Y.counters,ge,_e.startTime)}return Q(Y.counters,"visibilityHidden",x.visibilityHidden),Q(Y.attributes,"style",function(ae){if(ae)for(const ge of ae){const _e=ge.name.split("?")[0];if(o.i(_e)){const Te=_e.split("/").slice(-2);if(Te.length===2)return`mapbox://styles/${Te[0]}/${Te[1]}`}}}(T)),Q(Y.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),Q(Y.attributes,"fogEnabled",x.fogEnabled?"true":"false"),Q(Y.attributes,"projection",x.projection),Q(Y.attributes,"zoom",x.zoom),Q(Y.metadata,"devicePixelRatio",j),Q(Y.metadata,"connectionEffectiveType",q),Q(Y.metadata,"navigatorUserAgent",navigator.userAgent),Q(Y.metadata,"screenWidth",window.screen.width),Q(Y.metadata,"screenHeight",window.screen.height),Q(Y.metadata,"windowWidth",window.innerWidth),Q(Y.metadata,"windowHeight",window.innerHeight),Q(Y.metadata,"mapWidth",x.width/j),Q(Y.metadata,"mapHeight",x.height/j),Q(Y.metadata,"webglRenderer",x.renderer),Q(Y.metadata,"webglVendor",x.vendor),Q(Y.metadata,"sdkVersion",I),Q(Y.metadata,"sdkIdentifier","mapbox-gl-js"),Y}(l);for(const x of p.metadata);for(const x of p.counters);for(const x of p.attributes);this.postEvent(r,p,()=>{},d)}},_r=$r.postPerformanceEvent.bind($r),Pn=new class extends Ot{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(d,r,l,p){if(!o.e.API_URL||!o.e.SESSION_PATH)return;const x=Kt(o.e.API_URL+o.e.SESSION_PATH);x.params.push(`sku=${r||""}`),x.params.push(`access_token=${p||o.e.ACCESS_TOKEN||""}`);const T={url:Lt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=o.g(T,A=>{this.pendingRequest=null,l(A),this.saveEventData(),this.processRequests(p)})}getSessionAPI(d,r,l,p){this.skuToken=r,this.errorCb=p,o.e.SESSION_PATH&&o.e.API_URL&&(l||o.e.ACCESS_TOKEN?this.queueRequest({id:d,timestamp:Date.now()},l):this.errorCb(new Error(Nt)))}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},d)}remove(){this.errorCb=null}},Ke=Pn.getSessionAPI.bind(Pn),mr=new Set;function Sn(d,r){r?mr.add(d):mr.delete(d)}class Dr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Yt(d){const{userImage:r}=d;return!!(r&&r.render&&r.render())&&(d.data.replace(new Uint8Array(r.data.buffer)),!0)}class Mr extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new o.r({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,l){if(this.loaded[l]!==r&&(this.loaded[l]=r,r)){for(const{ids:p,callback:x}of this.requestors)this._notify(p,l,x);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images[l][r]}addImage(r,l,p){this._validate(r,p)&&(this.images[l][r]=p)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new o.t(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const x of r){if(x[0]<p||x[1]<x[0]||l<x[1])return!1;p=x[1]}return!0}_validateContent(r,l){return!(r&&(r.length!==4||r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,l,p){p.version=this.images[l][r].version+1,this.images[l][r]=p,this.updatedImages[l][r]=!0}removeImage(r,l){const p=this.images[l][r];delete this.images[l][r],delete this.patterns[l][r],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,l,p){let x=!0;const T=!!this.loaded[l];if(!T)for(const A of r)this.images[l][A]||(x=!1);T||x?this._notify(r,l,p):this.requestors.push({ids:r,scope:l,callback:p})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,l,p){const x={};for(const T of r){this.images[l][T]||this.fire(new o.x("styleimagemissing",{id:T}));const A=this.images[l][T];A?x[T]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:o.w(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,x)}getPixelSize(r){const{width:l,height:p}=this.atlasImage[r];return{width:l,height:p}}getPattern(r,l,p){const x=this.patterns[l][r],T=this.getImage(r,l);if(!T)return null;if(x&&x.position.version===T.version)return x.position;if(x)x.position.version=T.version;else{const A={w:T.data.width+2*o.y,h:T.data.height+2*o.y,x:0,y:0},F=new o.I(A,T,o.y);this.patterns[l][r]={bin:A,position:F}}return this._updatePatternAtlas(l,p),this.patterns[l][r].position}bind(r,l){const p=r.gl;let x=this.atlasTexture[l];x?this.dirty&&(x.update(this.atlasImage[l]),this.dirty=!1):(x=new o.T(r,this.atlasImage[l],p.RGBA8),this.atlasTexture[l]=x),x.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const p=[];for(const F in this.patterns[r])p.push(this.patterns[r][F].bin);const{w:x,h:T}=o.z(p),A=this.atlasImage[r];A.resize({width:x||1,height:T||1});for(const F in this.patterns[r]){const{bin:j,position:H}=this.patterns[r][F];let q=H.padding;const Y=j.x+q,Q=j.y+q,ae=this.images[r][F].data,ge=ae.width,_e=ae.height;q=q>1?q-1:q,o.r.copy(ae,A,{x:0,y:0},{x:Y,y:Q},{width:ge,height:_e},l),o.r.copy(ae,A,{x:0,y:_e-q},{x:Y,y:Q-q},{width:ge,height:q},l),o.r.copy(ae,A,{x:0,y:0},{x:Y,y:Q+_e},{width:ge,height:q},l),o.r.copy(ae,A,{x:ge-q,y:0},{x:Y-q,y:Q},{width:q,height:_e},l),o.r.copy(ae,A,{x:0,y:0},{x:Y+ge,y:Q},{width:q,height:_e},l),o.r.copy(ae,A,{x:ge-q,y:_e-q},{x:Y-q,y:Q-q},{width:q,height:q},l),o.r.copy(ae,A,{x:0,y:_e-q},{x:Y+ge,y:Q-q},{width:q,height:q},l),o.r.copy(ae,A,{x:0,y:0},{x:Y+ge,y:Q+_e},{width:q,height:q},l),o.r.copy(ae,A,{x:ge-q,y:0},{x:Y-q,y:Q+_e},{width:q,height:q},l)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,l){for(const p of r){if(this.callbackDispatchedThisFrame[l][p])continue;this.callbackDispatchedThisFrame[l][p]=!0;const x=this.images[l][p];Yt(x)&&this.updateImage(p,l,x)}}}function Qn(d){const r=d.key,l=d.value,p=d.valueSpec||{},x=d.objectElementValidators||{},T=d.style,A=d.styleSpec;let F=[];const j=o.B(l);if(j!=="object")return[new o.V(r,l,`object expected, ${j} found`)];for(const H in l){const q=H.split(".")[0];let Y;x[q]?Y=x[q]:p[q]?Y=Er:x["*"]?Y=x["*"]:p["*"]&&(Y=Er),Y?F=F.concat(Y({key:(r&&`${r}.`)+H,value:l[H],valueSpec:p[q]||p["*"],style:T,styleSpec:A,object:l,objectKey:H},l)):F.push(new o.A(r,l[H],`unknown property "${H}"`))}for(const H in p)x[H]||p[H].required&&p[H].default===void 0&&l[H]===void 0&&F.push(new o.V(r,l,`missing required property "${H}"`));return F}function Ar(d){const r=d.value,l=d.valueSpec,p=d.style,x=d.styleSpec,T=d.key,A=d.arrayElementValidator||Er;if(o.B(r)!=="array")return[new o.V(T,r,`array expected, ${o.B(r)} found`)];if(l.length&&r.length!==l.length)return[new o.V(T,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new o.V(T,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let F={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};x.$version<7&&(F.function=l.function),o.B(l.value)==="object"&&(F=l.value);let j=[];for(let H=0;H<r.length;H++)j=j.concat(A({array:r,arrayIndex:H,value:r[H],valueSpec:F,style:p,styleSpec:x,key:`${T}[${H}]`},!0));return j}function sr(d){const r=d.key,l=d.value,p=d.valueSpec;let x=o.B(l);if(x==="number"&&l!=l&&(x="NaN"),x!=="number")return[new o.V(r,l,`number expected, ${x} found`)];if("minimum"in p){let T=p.minimum;if(o.B(p.minimum)==="array"&&(T=p.minimum[d.arrayIndex]),l<T)return[new o.V(r,l,`${l} is less than the minimum value ${T}`)]}if("maximum"in p){let T=p.maximum;if(o.B(p.maximum)==="array"&&(T=p.maximum[d.arrayIndex]),l>T)return[new o.V(r,l,`${l} is greater than the maximum value ${T}`)]}return[]}function _i(d){const r=d.valueSpec,l=o.D(d.value.type);let p,x,T,A={};const F=l!=="categorical"&&d.value.property===void 0,j=!F,H=o.B(d.value.stops)==="array"&&o.B(d.value.stops[0])==="array"&&o.B(d.value.stops[0][0])==="object",q=Qn({key:d.key,value:d.value,valueSpec:d.styleSpec.function,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(ae){if(l==="identity")return[new o.V(ae.key,ae.value,'identity function may not have a "stops" property')];let ge=[];const _e=ae.value;return ge=ge.concat(Ar({key:ae.key,value:_e,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:Y})),o.B(_e)==="array"&&_e.length===0&&ge.push(new o.V(ae.key,_e,"array must have at least one stop")),ge},default:function(ae){return Er({key:ae.key,value:ae.value,valueSpec:r,style:ae.style,styleSpec:ae.styleSpec})}}});return l==="identity"&&F&&q.push(new o.V(d.key,d.value,'missing required property "property"')),l==="identity"||d.value.stops||q.push(new o.V(d.key,d.value,'missing required property "stops"')),l==="exponential"&&d.valueSpec.expression&&!o.F(d.valueSpec)&&q.push(new o.V(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(j&&!o.G(d.valueSpec)?q.push(new o.V(d.key,d.value,"property functions not supported")):F&&!o.H(d.valueSpec)&&q.push(new o.V(d.key,d.value,"zoom functions not supported"))),l!=="categorical"&&!H||d.value.property!==void 0||q.push(new o.V(d.key,d.value,'"property" property is required')),q;function Y(ae){let ge=[];const _e=ae.value,Te=ae.key;if(o.B(_e)!=="array")return[new o.V(Te,_e,`array expected, ${o.B(_e)} found`)];if(_e.length!==2)return[new o.V(Te,_e,`array length 2 expected, length ${_e.length} found`)];if(H){if(o.B(_e[0])!=="object")return[new o.V(Te,_e,`object expected, ${o.B(_e[0])} found`)];if(_e[0].zoom===void 0)return[new o.V(Te,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new o.V(Te,_e,"object stop key must have value")];const we=o.D(_e[0].zoom);if(typeof we!="number")return[new o.V(Te,_e[0].zoom,"stop zoom values must be numbers")];if(T&&T>we)return[new o.V(Te,_e[0].zoom,"stop zoom values must appear in ascending order")];we!==T&&(T=we,x=void 0,A={}),ge=ge.concat(Qn({key:`${Te}[0]`,value:_e[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:sr,value:Q}}))}else ge=ge.concat(Q({key:`${Te}[0]`,value:_e[0],valueSpec:{},style:ae.style,styleSpec:ae.styleSpec},_e));return o.J(o.K(_e[1]))?ge.concat([new o.V(`${Te}[1]`,_e[1],"expressions are not allowed in function stops.")]):ge.concat(Er({key:`${Te}[1]`,value:_e[1],valueSpec:r,style:ae.style,styleSpec:ae.styleSpec}))}function Q(ae,ge){const _e=o.B(ae.value),Te=o.D(ae.value),we=ae.value!==null?ae.value:ge;if(p){if(_e!==p)return[new o.V(ae.key,we,`${_e} stop domain type must match previous stop domain type ${p}`)]}else p=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean"&&typeof Te!="number"&&typeof Te!="string"&&typeof Te!="boolean")return[new o.V(ae.key,we,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&l!=="categorical"){let ze=`number expected, ${_e} found`;return o.G(r)&&l===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new o.V(ae.key,we,ze)]}return l!=="categorical"||_e!=="number"||typeof Te=="number"&&isFinite(Te)&&Math.floor(Te)===Te?l!=="categorical"&&_e==="number"&&typeof Te=="number"&&typeof x=="number"&&x!==void 0&&Te<x?[new o.V(ae.key,we,"stop domain values must appear in ascending order")]:(x=Te,l==="categorical"&&Te in A?[new o.V(ae.key,we,"stop domain values must be unique")]:(A[Te]=!0,[])):[new o.V(ae.key,we,`integer expected, found ${String(Te)}`)]}}function Wi(d){const r=(d.expressionContext==="property"?o.L:o.M)(o.K(d.value),d.valueSpec);if(r.result==="error")return r.value.map(p=>new o.V(`${d.key}${p.key}`,d.value,p.message));const l=r.value.expression||r.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!l.outputDefined())return[new o.V(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!o.N(l))return[new o.V(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter")return ii(l,d);if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!o.O(l,["zoom","feature-state"]))return[new o.V(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!o.Q(l))return[new o.V(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ii(d,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const x of r.valueSpec.expression.parameters)l.delete(x);if(l.size===0)return[];const p=[];return d instanceof o.S&&l.has(d.name)?[new o.V(r.key,r.value,`["${d.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(d.eachChild(x=>{p.push(...ii(x,r))}),p)}function Pi(d){const r=d.key,l=d.value,p=d.valueSpec,x=[];return Array.isArray(p.values)?p.values.indexOf(o.D(l))===-1&&x.push(new o.V(r,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(o.D(l))===-1&&x.push(new o.V(r,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),x}function yi(d){return o.W(o.K(d.value))?Wi(o.C({},d,{expressionContext:"filter",valueSpec:d.styleSpec[`filter_${d.layerType||"fill"}`]})):lr(d)}function lr(d){const r=d.value,l=d.key;if(o.B(r)!=="array")return[new o.V(l,r,`array expected, ${o.B(r)} found`)];const p=d.styleSpec;let x,T=[];if(r.length<1)return[new o.V(l,r,"filter array must have at least 1 element")];switch(T=T.concat(Pi({key:`${l}[0]`,value:r[0],valueSpec:p.filter_operator,style:d.style,styleSpec:d.styleSpec})),o.D(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&o.D(r[1])==="$type"&&T.push(new o.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&T.push(new o.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(x=o.B(r[1]),x!=="string"&&T.push(new o.V(`${l}[1]`,r[1],`string expected, ${x} found`)));for(let A=2;A<r.length;A++)x=o.B(r[A]),o.D(r[1])==="$type"?T=T.concat(Pi({key:`${l}[${A}]`,value:r[A],valueSpec:p.geometry_type,style:d.style,styleSpec:d.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&T.push(new o.V(`${l}[${A}]`,r[A],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let A=1;A<r.length;A++)T=T.concat(lr({key:`${l}[${A}]`,value:r[A],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":x=o.B(r[1]),r.length!==2?T.push(new o.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):x!=="string"&&T.push(new o.V(`${l}[1]`,r[1],`string expected, ${x} found`))}return T}function qo(d,r){const l=d.key,p=d.style,x=d.layer,T=d.styleSpec,A=d.value,F=d.objectKey,j=T[`${r}_${d.layerType}`];if(!j)return[];const H=F.match(/^(.*)-transition$/);if(r==="paint"&&H&&j[H[1]]&&j[H[1]].transition)return Er({key:l,value:A,valueSpec:T.transition,style:p,styleSpec:T});const q=d.valueSpec||j[F];if(!q)return[new o.A(l,A,`unknown property "${F}"`)];let Y;if(o.B(A)==="string"&&o.G(q)&&!q.tokens&&(Y=/^{([^}]+)}$/.exec(A))){const ae=`\`{ "type": "identity", "property": ${Y?JSON.stringify(Y[1]):'"_"'} }\``;return[new o.V(l,A,`"${F}" does not support interpolation syntax
Use an identity property function instead: ${ae}.`)]}const Q=[];if(d.layerType==="symbol")F!=="text-field"||!p||p.glyphs||p.imports||Q.push(new o.V(l,A,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&o.X(o.K(A))&&o.D(A.type)==="identity"&&Q.push(new o.V(l,A,'"text-font" does not support identity functions'));else if(d.layerType==="model"&&r==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&o.G(q)&&(o.Y(q)||o.H(q))){const ae=o.L(o.K(A),q),ge=ae.value.expression||ae.value._styleExpression.expression;ge&&!o.O(ge,["measure-light"])&&(F==="model-emissive-strength"&&o.Q(ge)&&o.N(ge)||Q.push(new o.V(l,A,`${F} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Q.concat(Er({key:d.key,value:A,valueSpec:q,style:p,styleSpec:T,expressionContext:"property",propertyType:r,propertyKey:F}))}function ea(d){return qo(d,"paint")}function la(d){return qo(d,"layout")}function Fi(d){let r=[];const l=d.value,p=d.key,x=d.style,T=d.styleSpec;l.type||l.ref||r.push(new o.V(p,l,'either "type" or "ref" is required'));let A=o.D(l.type);const F=o.D(l.ref);if(l.id){const j=o.D(l.id);for(let H=0;H<d.arrayIndex;H++){const q=x.layers[H];o.D(q.id)===j&&r.push(new o.V(p,l.id,`duplicate layer id "${l.id}", previously used at line ${q.id.__line__}`))}}if("ref"in l){let j;["type","source","source-layer","filter","layout"].forEach(H=>{H in l&&r.push(new o.V(p,l[H],`"${H}" is prohibited for ref layers`))}),x.layers.forEach(H=>{o.D(H.id)===F&&(j=H)}),j?j.ref?r.push(new o.V(p,l.ref,"ref cannot reference another ref layer")):A=o.D(j.type):typeof F=="string"&&r.push(new o.V(p,l.ref,`ref layer "${F}" not found`))}else if(A!=="background"&&A!=="sky"&&A!=="slot")if(l.source){const j=x.sources&&x.sources[l.source],H=j&&o.D(j.type);j?H==="vector"&&A==="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a raster source`)):H==="raster"&&A!=="raster"?r.push(new o.V(p,l.source,`layer "${l.id}" requires a vector source`)):H!=="vector"||l["source-layer"]?H==="raster-dem"&&A!=="hillshade"?r.push(new o.V(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):H!=="raster-array"||["raster","raster-particle"].includes(A)?A!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||H==="geojson"&&j.lineMetrics?A==="raster-particle"&&H!=="raster-array"&&r.push(new o.V(p,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new o.V(p,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new o.V(p,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new o.V(p,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new o.V(p,l.source,`source "${l.source}" not found`))}else r.push(new o.V(p,l,'missing required property "source"'));return r=r.concat(Qn({key:p,value:l,valueSpec:T.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Er({key:`${p}.type`,value:l.type,valueSpec:T.layer.type,style:d.style,styleSpec:d.styleSpec,object:l,objectKey:"type"}),filter:j=>yi(o.C({layerType:A},j)),layout:j=>Qn({layer:l,key:j.key,value:j.value,valueSpec:{},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{"*":H=>la(o.C({layerType:A},H))}}),paint:j=>Qn({layer:l,key:j.key,value:j.value,valueSpec:{},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{"*":H=>ea(o.C({layerType:A,layer:l},H))}})}})),r}function Mo(d){const r=d.value,l=d.key,p=o.B(r);return p!=="string"?[new o.V(l,r,`string expected, ${p} found`)]:[]}const ta={promoteId:function({key:d,value:r}){if(o.B(r)==="string")return Mo({key:d,value:r});{const l=[];for(const p in r)l.push(...Mo({key:`${d}.${p}`,value:r[p]}));return l}}};function va(d){const r=d.value,l=d.key,p=d.styleSpec,x=d.style;if(!r.type)return[new o.V(l,r,'"type" is required')];const T=o.D(r.type);let A=[];switch(["vector","raster","raster-dem","raster-array"].includes(T)&&(r.url||r.tiles||A.push(new o.A(l,r,'Either "url" or "tiles" is required.'))),T){case"vector":case"raster":case"raster-dem":case"raster-array":return A=A.concat(Qn({key:l,value:r,valueSpec:p[`source_${T.replace("-","_")}`],style:d.style,styleSpec:p,objectElementValidators:ta})),A;case"geojson":if(A=Qn({key:l,value:r,valueSpec:p.source_geojson,style:x,styleSpec:p,objectElementValidators:ta}),r.cluster)for(const F in r.clusterProperties){const[j,H]=r.clusterProperties[F],q=typeof j=="string"?[j,["accumulated"],["get",F]]:j;A.push(...Wi({key:`${l}.${F}.map`,value:H,expressionContext:"cluster-map"})),A.push(...Wi({key:`${l}.${F}.reduce`,value:q,expressionContext:"cluster-reduce"}))}return A;case"video":return Qn({key:l,value:r,valueSpec:p.source_video,style:x,styleSpec:p});case"image":return Qn({key:l,value:r,valueSpec:p.source_image,style:x,styleSpec:p});case"canvas":return[new o.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pi({key:`${l}.type`,value:r.type,valueSpec:{values:za(p)},style:x,styleSpec:p})}}function za(d){return d.source.reduce((r,l)=>{const p=d[l];return p.type.type==="enum"&&(r=r.concat(Object.keys(p.type.values))),r},[])}function so(d){const r=d.value,l=d.styleSpec,p=l.light,x=d.style;let T=[];const A=o.B(r);if(r===void 0)return T;if(A!=="object")return T=T.concat([new o.V("light",r,`object expected, ${A} found`)]),T;for(const F in r){const j=F.match(/^(.*)-transition$/);T=T.concat(j&&p[j[1]]&&p[j[1]].transition?Er({key:F,value:r[F],valueSpec:l.transition,style:x,styleSpec:l}):p[F]?Er({key:F,value:r[F],valueSpec:p[F],style:x,styleSpec:l}):[new o.V(F,r[F],`unknown property "${F}"`)])}return T}function Lo(d){const r=d.value;let l=[];if(!r)return l;const p=o.B(r);if(p!=="object")return l=l.concat([new o.V("light-3d",r,`object expected, ${p} found`)]),l;const x=d.styleSpec,T=x["light-3d"],A=d.key,F=d.style,j=d.style.lights;for(const Y of["type","id"])if(!(Y in r))return l=l.concat([new o.V("light-3d",r,`missing property ${Y} on light`)]),l;if(r.type&&j)for(let Y=0;Y<d.arrayIndex;Y++){const Q=o.D(r.type),ae=j[Y];o.D(ae.type)===Q&&l.push(new o.V(A,r.id,`duplicate light type "${r.type}", previously defined at line ${ae.id.__line__}`))}const H=`properties_light_${r.type}`;if(!(H in x))return l=l.concat([new o.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const q=x[H];for(const Y in r)if(Y==="properties"){const Q=r[Y],ae=o.B(Q);if(ae!=="object")return l=l.concat([new o.V("properties",Q,`object expected, ${ae} found`)]),l;for(const ge in Q)l=l.concat(q[ge]?Er({key:ge,value:Q[ge],valueSpec:q[ge],style:F,styleSpec:x}):[new o.A(d.key,Q[ge],`unknown property "${ge}"`)])}else{const Q=Y.match(/^(.*)-transition$/);l=l.concat(Q&&T[Q[1]]&&T[Q[1]].transition?Er({key:Y,value:r[Y],valueSpec:x.transition,style:F,styleSpec:x}):T[Y]?Er({key:Y,value:r[Y],valueSpec:T[Y],style:F,styleSpec:x}):[new o.A(Y,r[Y],`unknown property "${Y}"`)])}return l}function es(d){const r=d.value,l=d.key,p=d.style,x=d.styleSpec,T=x.terrain;let A=[];const F=o.B(r);if(r===void 0||F==="null")return A;if(F!=="object")return A=A.concat([new o.V("terrain",r,`object expected, ${F} found`)]),A;for(const j in r){const H=j.match(/^(.*)-transition$/);A=A.concat(H&&T[H[1]]&&T[H[1]].transition?Er({key:j,value:r[j],valueSpec:x.transition,style:p,styleSpec:x}):T[j]?Er({key:j,value:r[j],valueSpec:T[j],style:p,styleSpec:x}):[new o.A(j,r[j],`unknown property "${j}"`)])}if(r.source){const j=p.sources&&p.sources[r.source],H=j&&o.D(j.type);j?H!=="raster-dem"&&A.push(new o.V(l,r.source,`terrain cannot be used with a source of type ${String(H)}, it only be used with a "raster-dem" source type`)):A.push(new o.V(l,r.source,`source "${r.source}" not found`))}else A.push(new o.V(l,r,'terrain is missing required property "source"'));return A}function Go(d){const r=d.value,l=d.style,p=d.styleSpec,x=p.fog;let T=[];const A=o.B(r);if(r===void 0)return T;if(A!=="object")return T=T.concat([new o.V("fog",r,`object expected, ${A} found`)]),T;for(const F in r){const j=F.match(/^(.*)-transition$/);T=T.concat(j&&x[j[1]]&&x[j[1]].transition?Er({key:F,value:r[F],valueSpec:p.transition,style:l,styleSpec:p}):x[F]?Er({key:F,value:r[F],valueSpec:x[F],style:l,styleSpec:p}):[new o.A(F,r[F],`unknown property "${F}"`)])}return T}const Fa={"*":()=>[],array:Ar,boolean:function(d){const r=d.value,l=d.key,p=o.B(r);return p!=="boolean"?[new o.V(l,r,`boolean expected, ${p} found`)]:[]},number:sr,color:function(d){const r=d.key,l=d.value,p=o.B(l);return p!=="string"?[new o.V(r,l,`color expected, ${p} found`)]:o.U.parseCSSColor(l)===null?[new o.V(r,l,`color expected, "${l}" found`)]:[]},enum:Pi,filter:yi,function:_i,layer:Fi,object:Qn,source:va,model:o.Z,light:so,"light-3d":Lo,terrain:es,fog:Go,string:Mo,formatted:function(d){return Mo(d).length===0?[]:Wi(d)},resolvedImage:function(d){return Mo(d).length===0?[]:Wi(d)},projection:function(d){const r=d.value,l=d.styleSpec,p=l.projection,x=d.style;let T=[];const A=o.B(r);if(A==="object")for(const F in r)T=T.concat(Er({key:F,value:r[F],valueSpec:p[F],style:x,styleSpec:l}));else A!=="string"&&(T=T.concat([new o.V("projection",r,`object or string expected, ${A} found`)]));return T},import:function(d){const{value:r,styleSpec:l}=d,{data:p,...x}=r;Object.defineProperty(x,"__line__",{value:r.__line__,enumerable:!1});let T=Qn(o.C({},d,{value:x,valueSpec:l.import}));return o.D(x.id)===""&&T.push(new o.V(`${d.key}.id`,x,"import id can't be an empty string")),p&&(T=T.concat(Ia(p,l,{key:`${d.key}.data`}))),T}};function Er(d,r=!1){const l=d.value,p=d.valueSpec,x=d.styleSpec;if(p.expression&&o.X(o.D(l)))return _i(d);if(p.expression&&o.J(o.K(l)))return Wi(d);if(p.type&&Fa[p.type]){const T=Fa[p.type](d);return r===!0&&T.length>0&&o.B(d.value)==="array"?Wi(d):T}return Qn(o.C({},d,{valueSpec:p.type?x[p.type]:p}))}function go(d){const r=d.value,l=d.key,p=Mo(d);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new o.V(l,r,'"glyphs" url must include a "{range}" token'))),p}function Ia(d,r=o._,l={}){return Er({key:l.key||"",value:d,valueSpec:r.$root,styleSpec:r,style:d,objectElementValidators:{glyphs:go,"*":()=>[]}})}function Di(d,r=o._){return de(Ia(d,r))}const vi=d=>de(va(d)),bi=d=>de(so(d)),Mi=d=>de(Lo(d)),Fo=d=>de(es(d)),na=d=>de(Go(d)),kt=d=>de(Fi(d)),Se=d=>de(yi(d)),Z=d=>de(ea(d)),re=d=>de(la(d)),ce=d=>de(o.Z(d));function de(d){return d.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function xe(d,r){let l=!1;if(r&&r.length)for(const p of r)p instanceof o.A?o.w(p.message):(d.fire(new o.t(new Error(p.message))),l=!0);return l}let Ie;class Ae extends o.E{constructor(r,l="flat"){super(),this._transitionable=new o.$(Ie||(Ie=new o.a0({anchor:new o.a1(o._.light.anchor),position:new o.a2(o._.light.position),color:new o.a1(o._.light.color),intensity:new o.a1(o._.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,p={}){this._validate(bi,r,p)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&xe(this,r.call(Di,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}let Be=class extends o.E{constructor(d,r,l,p){super(),this.scope=l,this._transitionable=new o.$(new o.a0({source:new o.a1(o._.terrain.source),exaggeration:new o.a1(o._.terrain.exaggeration)}),l,p),this._transitionable.setTransitionOrValue(d,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(d,r){this._transitionable.setTransitionOrValue(d,r)}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}getExaggeration(d){return this._transitioning.possiblyEvaluate(new o.a3(d)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const d=this._transitionable._values.exaggeration;if(!d)return null;const r=d.value.expression;if(!r)return null;let l=-1,p=-1,x=1;for(const T of r.zoomStops)x=r.evaluate(new o.a3(T)),x>.01?(l=T,p=-1):p=T;return x<.01&&l>0&&p>l?[l,p]:null}isZoomDependent(){const d=this._transitionable._values.exaggeration;return d!=null&&d.value!=null&&d.value.expression!=null&&d.value.expression instanceof o.a4}};const tt=45,ut=65,Tt=.05;function Wt(d,r,l,p){const x=o.a7(tt,ut,l),[T,A]=Vt(d,p);let F=1-Math.min(1,Math.exp((r-T)/(A-T)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*x*d.alpha}function Vt(d,r){const l=.5/Math.tan(.5*r);return[d.range[0]+l,d.range[1]+l]}function Gt(d,r,l,p,x){const T=o.a6.vec3.transformMat4([],[r,l,p],x.mercatorFogMatrix);return Wt(d,o.a6.vec3.length(T),x.pitch,x._fov)}function gn(d,r,l,p,x,T,A){const F=[[l,p,0],[x,p,0],[x,T,0],[l,T,0]];let j=Number.MAX_VALUE,H=-Number.MAX_VALUE;for(const q of F){const Y=o.a6.vec3.transformMat4([],q,r),Q=o.a6.vec3.length(Y);j=Math.min(j,Q),H=Math.max(H,Q)}return[Wt(d,j,A.pitch,A._fov),Wt(d,H,A.pitch,A._fov)]}class Tn extends o.E{constructor(r,l,p,x){super();const T=new o.a0({range:new o.a1(o._.fog.range),color:new o.a1(o._.fog.color),"high-color":new o.a1(o._.fog["high-color"]),"space-color":new o.a1(o._.fog["space-color"]),"horizon-blend":new o.a1(o._.fog["horizon-blend"]),"star-intensity":new o.a1(o._.fog["star-intensity"]),"vertical-range":new o.a1(o._.fog["vertical-range"])});this._transitionable=new o.$(T,p,new Map(x)),this.set(r,x),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new o.a8(T),this.scope=p}get state(){const r=this._transform,l=r.projection.name==="globe",p=o.a9(r.zoom),x=this.properties.get("range"),T=[.5,3];return{range:l?[o.aa(T[0],x[0],p),o.aa(T[1],x[1],p)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,p={}){if(this._validate(na,r,p))return;const x=o.l({},r);for(const T of Object.keys(o._.fog))x[T]===void 0&&(x[T]=o._.fog[T].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.a7(tt,ut,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,x,T){const A=o.a5.fromLngLat(x),F=T.elevation?T.elevation.getAtPointOrZero(A):0;return Gt(p,A.x,A.y,F,T)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return gn(this.state,l,0,0,o.ab,o.ab,this._transform)}getOpacityForBounds(r,l,p,x,T){return this._transform.projection.supportsFog?gn(this.state,r,l,p,x,T,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Vt(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const p of l){const x=r.points[p];let T;if(x[2]>=0)T=x;else{const A=r.points[p-4];T=o.ac(A,x,A[2]/(A[2]-x[2]))}if(Gt(this.state,T[0],T[1],0,this._transform)>=Tt)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&xe(this,r.call(Di,o.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o._})))}}class In extends o.E{constructor(r,l,p,x){super(),this.scope=p,this._options=r,this.properties=new o.a8(l),this._transitionable=new o.$(l,p,new Map(x)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let Ln,dr;class Zn{constructor(r,l,p,x){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(r,l){let p,x;if(r instanceof o.P||typeof r[0]=="number"){const T=o.P.convert(r);p=[T],x=l.isPointAboveHorizon(T)}else{const T=o.P.convert(r[0]),A=o.P.convert(r[1]);p=[T,A],x=o.ae(T,A).every(F=>l.isPointAboveHorizon(F))}return new Zn(p,l.getCameraPoint(),x,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return o.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],x=o.ae(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?x[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(x[3]=this.cameraPoint)),o.af(x,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new o.P(1,1)):this.screenBounds[1],x=o.ae(l,p,r),T=this.cameraPoint.clone();switch(3*((T.y>l.y)+(T.y>p.y))+((T.x>l.x)+(T.x>p.x))){case 0:x[0]=T,x[4]=T.clone();break;case 1:x.splice(1,0,T);break;case 2:x[1]=T;break;case 3:x.splice(4,0,T);break;case 5:x.splice(2,0,T);break;case 6:x[3]=T;break;case 7:x.splice(3,0,T);break;case 8:x[2]=T}return x}containsTile(r,l,p,x=0){const T=r.queryPadding/l._pixelsPerMercatorPixel+1,A=p?this._bufferedCameraMercator(T,l):this._bufferedScreenMercator(T,l);let F=r.tileID.wrap+(A.unwrapped?x:0);const j=A.polygon.map(Te=>o.ag(r.tileTransform,Te,F));if(!o.ah(j,0,0,o.ab,o.ab))return;F=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const H=this.screenGeometryMercator.polygon.map(Te=>o.ai(r.tileTransform,Te,F)),q=H.map(Te=>new o.P(Te[0],Te[1])),Y=l.getFreeCameraOptions().position||new o.a5(0,0,0),Q=o.ai(r.tileTransform,Y,F),ae=H.map(Te=>{const we=o.a6.vec3.sub(Te,Te,Q);return o.a6.vec3.normalize(we,we),new o.aj(Q,we)}),ge=o.ak(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:q,tilespaceRays:ae,bufferedTilespaceGeometry:j,bufferedTilespaceBounds:(_e=o.al(j),_e.min.x=o.ap(_e.min.x,0,o.ab),_e.min.y=o.ap(_e.min.y,0,o.ab),_e.max.x=o.ap(_e.max.x,0,o.ab),_e.max.y=o.ap(_e.max.y,0,o.ab),_e),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:ge};var _e}_bufferedScreenMercator(r,l){const p=nr(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let x;return x=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(T=>l.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[p]=x,x}}_bufferedCameraMercator(r,l){const p=nr(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let x;return x=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(T=>l.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[p]=x,x}}_projectAndResample(r,l){const p=function(T,A){const F=o.a6.mat4.multiply([],A.pixelMatrix,A.globeMatrix),j=[0,-o.aq,0,1],H=[0,o.aq,0,1],q=[0,0,0,1];o.a6.vec4.transformMat4(j,j,F),o.a6.vec4.transformMat4(H,H,F),o.a6.vec4.transformMat4(q,q,F);const Y=new o.P(j[0]/j[3],j[1]/j[3]),Q=new o.P(H[0]/H[3],H[1]/H[3]),ae=o.an(T,Y)&&j[3]<q[3],ge=o.an(T,Q)&&H[3]<q[3];if(!ae&&!ge)return null;const _e=function(Ze,Qe,it){for(let ft=1;ft<Ze.length;ft++){const st=ri(Qe.pointCoordinate3D(Ze[ft-1]).x),at=ri(Qe.pointCoordinate3D(Ze[ft]).x);if(it<0){if(st<at)return{idx:ft,t:-st/(at-1-st)}}else if(at<st)return{idx:ft,t:(1-st)/(at+1-st)}}return null}(T,A,ae?-1:1);if(!_e)return null;const{idx:Te,t:we}=_e;let ze=Te>1?Zr(T.slice(0,Te),A):[],Ue=Te<T.length?Zr(T.slice(Te),A):[];ze=ze.map(Ze=>new o.P(ri(Ze.x),Ze.y)),Ue=Ue.map(Ze=>new o.P(ri(Ze.x),Ze.y));const ke=[...ze];ke.length===0&&ke.push(Ue[Ue.length-1]);const He=o.aa(ke[ke.length-1].y,(Ue.length===0?ze[0]:Ue[0]).y,we);let Ye;return Ye=ae?[new o.P(0,He),new o.P(0,0),new o.P(1,0),new o.P(1,He)]:[new o.P(1,He),new o.P(1,1),new o.P(0,1),new o.P(0,He)],ke.push(...Ye),Ue.length===0?ke.push(ze[0]):ke.push(...Ue),{polygon:ke.map(Ze=>new o.a5(Ze.x,Ze.y)),unwrapped:!1}}(r,l);if(p)return p;const x=function(T,A){let F=!1,j=-1/0,H=0;for(let Y=0;Y<T.length-1;Y++)T[Y].x>j&&(j=T[Y].x,H=Y);for(let Y=0;Y<T.length-1;Y++){const Q=(H+Y)%(T.length-1),ae=T[Q],ge=T[Q+1];Math.abs(ae.x-ge.x)>.5&&(ae.x<ge.x?(ae.x+=1,Q===0&&(T[T.length-1].x+=1)):(ge.x+=1,Q+1===T.length-1&&(T[0].x+=1)),F=!0)}const q=o.am(A.center.lng);return F&&q<Math.abs(q-1)&&T.forEach(Y=>{Y.x-=1}),{polygon:T,unwrapped:F}}(Zr(r,l).map(T=>new o.P(ri(T.x),T.y)),l);return{polygon:x.polygon.map(T=>new o.a5(T.x,T.y)),unwrapped:x.unwrapped}}}function Zr(d,r){return o.ao(d,l=>{const p=r.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function ri(d){return d<0?1+d%1:d%1}function nr(d){return 100*d|0}function hn(d,r,l,p,x){const T=function(F,j){if(F)return x(F);if(j){if(d.url&&j.tiles&&d.tiles&&delete d.tiles,j.variants){if(!Array.isArray(j.variants))return x(new Error("variants must be an array"));for(const q of j.variants){if(q==null||typeof q!="object"||q.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(q.capabilities))return x(new Error("capabilities must be an array"));if(q.capabilities.length===1&&q.capabilities[0]==="meshopt"){j=o.l(j,q);break}}}const H=o.ar(o.l({},j,d),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);H.tiles=r.canonicalizeTileset(H,d.url),x(null,H)}},A=function(F,j,H){if(!F)return null;if(!j&&!H)return F;H=H||F.worldview_default;const q=Object.values(F.language||{});if(q.length===0)return null;const Y=Object.values(F.worldview||{});if(Y.length===0)return null;const Q=q.every(ge=>ge===j),ae=Y.every(ge=>ge===H);return Q&&ae?F:j in(F.language_options||{})||H in(F.worldview_options||{})?null:F.language_options&&F.worldview_options?F:null}(d.data,l,p);return A?o.q.frame(()=>T(null,A)):d.url?o.n(r.transformRequest(r.normalizeSourceURL(d.url,null,l,p),o.R.Source),T):o.q.frame(()=>{const{data:F,...j}=d;T(null,j)})}class Kn{constructor(r,l,p){this.bounds=o.as.convert(this.validateBounds(r)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const l=Math.pow(2,r.z),p=Math.floor(o.am(this.bounds.getWest())*l),x=Math.floor(o.at(this.bounds.getNorth())*l),T=Math.ceil(o.am(this.bounds.getEast())*l),A=Math.ceil(o.at(this.bounds.getSouth())*l);return r.x>=p&&r.x<T&&r.y>=x&&r.y<A}}class br extends o.E{constructor(r,l,p,x){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.l(this,o.ar(l,["url","scheme","tileSize","promoteId"])),this._options=o.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new o.au}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=hn(this._options,this.map._requestManager,l,p,(x,T)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new o.t(x));else if(T){if(o.l(this,T),this.hasWorldviews=!!T.worldview_options,T.worldview_default&&(this.worldviewDefault=T.worldview_default),T.vector_layers){this.vectorLayers=T.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const A of T.vector_layers)this.vectorLayerIds.push(A.id),T.worldview&&T.worldview[A.source]&&this.localizableLayerIds.add(A.id)}T.bounds&&(this.tileBounds=new Kn(T.bounds,this.minzoom,this.maxzoom)),zt(T.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}r&&r(x)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}loadTile(r,l){const p=r.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(p),T=this.map._requestManager.transformRequest(x,o.R.Tile),A=this.map.style?this.map.style.getLut(this.scope):null,F=A?{image:A.image.clone()}:null,j={request:T,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:F,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&o.f(p)&&(j.worldview=this.map.getWorldview()||this.worldviewDefault,j.localizableLayerIds=this.localizableLayerIds),j.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",j,H.bind(this));else if(r.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",j,H.bind(this),void 0,!0);else{const q=o.aw.call({deduped:this._deduped},j,(Y,Q)=>{Y||!Q?H.call(this,Y):(j.data={cacheControl:Q.cacheControl,expires:Q.expires,rawData:Q.rawData.slice(0)},r.actor&&r.actor.send("loadTile",j,H.bind(this),void 0,!0))},!0);r.request={cancel:q}}function H(q,Y){return delete r.request,r.aborted?l(null):q&&q.status!==404?l(q):(Y&&Y.resourceTiming&&(r.resourceTiming=Y.resourceTiming),this.map._refreshExpiredTiles&&Y&&r.setExpiryData(Y),r.loadVectorData(Y,this.map.painter),o.ax(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class oi extends o.E{constructor(r,l,p,x){super(),this.id=r,this.dispatcher=p,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.l({type:"raster"},l),o.l(this,o.ar(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._tileJSONRequest=hn(this._options,this.map._requestManager,null,null,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.t(l)):p&&(o.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(x=>x.id)),p.bounds&&(this.tileBounds=new Kn(p.bounds,this.minzoom,this.maxzoom)),zt(p.tiles),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=o.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return o.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=o.q.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=o.o(this.map._requestManager.transformRequest(x,o.R.Tile),(T,A,F,j)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):T?(r.state="errored",l(T)):A?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:F,expires:j}),r.setTexture(A,this.map.painter),r.state="loaded",o.ax(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof o.T?(r.destroy(!0),r.texture&&r.texture instanceof o.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ir extends oi{constructor(r,l,p,x){super(r,l,p,x),this.type="raster-array",this.maxzoom=22,this._options=o.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);l&&l.enabled&&p&&l._clearRenderCacheForTile(p.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(p,o.R.Tile);r.requestParams=x,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(T,A,F,j)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(T)return T.code===20?void 0:(r.state="errored",l(T));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:F,expires:j}),r.state="empty",l(null)})}unloadTile(r,l){const p=r.texture;p&&p instanceof o.T?(r.destroy(!0),this.map.painter.saveTileTexture(p)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,p){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,p,(x,T)=>{if(x)return r.state="errored",this.fire(new o.t(x)),void this.triggerRepaint(r);T&&(r.setTexture(T,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:T})=>T===r),p=l&&l.fields,x=p&&p.bands&&p.bands;return x?x[0]:0}getTextureDescriptor(r,l,p){if(!r)return;const x=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let T=null;l instanceof o.aB?T=l.paint.get("raster-array-band"):l instanceof o.aC&&(T=l.paint.get("raster-particle-array-band"));const A=T||this.getInitialBand(x);if(A!=null)if(r.textureDescriptor){if(!r.updateNeeded(x,A)||p)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,x,A)}}const Kr={vector:br,raster:oi,"raster-dem":class extends oi{constructor(d,r,l,p){super(d,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=o.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(d,r){const l=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(x,T){x&&(d.state="errored",r(x)),T&&(d.dem=T,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",r(null))}d.request=o.o(this.map._requestManager.transformRequest(l,o.R.Tile),(function(x,T,A,F){if(delete d.request,d.aborted)d.state="unloaded",r(null);else if(x)d.state="errored",r(x);else if(T){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:A,expires:F});const j=ImageBitmap&&T instanceof ImageBitmap&&o.ay(),H=1-(T.width-o.az(T.width))/2;H<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const q=j?T:o.q.getImageData(T,H),Y={uid:d.uid,coord:d.tileID,source:this.id,scope:this.scope,rawImageData:q,encoding:this.encoding,padding:H};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",Y,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(d){const r=d.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,x=r.x===0?d.wrap-1:d.wrap,T=(r.x+1+l)%l,A=r.x+1===l?d.wrap+1:d.wrap,F={};return F[new o.aA(d.overscaledZ,x,r.z,p,r.y).key]={backfilled:!1},F[new o.aA(d.overscaledZ,A,r.z,T,r.y).key]={backfilled:!1},r.y>0&&(F[new o.aA(d.overscaledZ,x,r.z,p,r.y-1).key]={backfilled:!1},F[new o.aA(d.overscaledZ,d.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},F[new o.aA(d.overscaledZ,A,r.z,T,r.y-1).key]={backfilled:!1}),r.y+1<l&&(F[new o.aA(d.overscaledZ,x,r.z,p,r.y+1).key]={backfilled:!1},F[new o.aA(d.overscaledZ,d.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},F[new o.aA(d.overscaledZ,A,r.z,T,r.y+1).key]={backfilled:!1}),F}},"raster-array":Ir,geojson:class extends o.E{constructor(d,r,l,p){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=o.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const x=o.ab/this.tileSize;this.workerOptions=o.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*x,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*x,extent:o.ab,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:o.ab,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*x,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}updateData(d){if(!this._options.dynamic)return this.fire(new o.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof d!="string"&&(d.type==="Feature"&&(d={type:"FeatureCollection",features:[d]}),d.type!=="FeatureCollection"))return this.fire(new o.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof d!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of d.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=d;return this._updateWorkerData(!0),this}getClusterExpansionZoom(d,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id,scope:this.scope},r),this}getClusterChildren(d,r){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id,scope:this.scope},r),this}getClusterLeaves(d,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:d,limit:r,offset:l},p),this}_updateWorkerData(d=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.x("dataloading",{dataType:"source"})),this._loaded=!1;const r=o.l({append:d},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(o.q.resolveURL(l),o.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(p,x)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new o.t(p));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(T.resourceTiming=x.resourceTiming[this.id]),d&&(this._partialReload=!0),this.fire(new o.x("data",T)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(d),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,r){const l=d.actor?"reloadTile":"loadTile";d.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,x=p?{image:p.image.clone()}:null,T=this._partialReload,A={type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:o.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:T};d.request=this.actor.send(l,A,(F,j)=>T&&!j?(d.state="loaded",r(null)):(delete d.request,d.destroy(),d.aborted?r(null):F?r(F):(d.loadVectorData(j,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d,r){this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id,scope:this.scope}),d.destroy()}onRemove(d){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends o.aD{constructor(d,r,l,p){super(d,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const r of d.urls)this.urls.push(this.map._requestManager.transformRequest(r,o.R.Source).url);o.aE(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new o.t(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const r=this.video.seekable;d<r.start(0)||d>r.end(0)?this.fire(new o.t(new o.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,r=d.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(d,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:o.aD,model:class extends o.E{constructor(d,r,l,p){super(),this.id=d,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const d=[];for(const r in this._options.models){const l=this._options.models[r],p=o.aG(this.map._requestManager.transformRequest(l.uri,o.R.Model).url).then(x=>{if(!x)return;const T=o.aH(x),A=new o.aI(r,l.position,l.orientation,T);A.computeBoundsAndApplyParent(),this.models.push(A)}).catch(x=>{this.fire(new o.t(new Error(`Could not load model ${r} from ${l.uri}: ${x.message}`)))});d.push(p)}return Promise.allSettled(d).then(()=>{this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new o.t(new Error(`Could not load models: ${r.message}`)))})}onAdd(d){this.map=d,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(d,r){}serialize(){return{type:"model"}}},"batched-model":class extends o.E{constructor(d,r,l,p){super(),this.type="batched-model",this.id=d,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(d){this.map=d,this.load()}load(d){this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=hn(this._options,this.map._requestManager,r,l,(p,x)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new o.t(p))):x&&(o.l(this,x),x.bounds&&(this.tileBounds=new Kn(x.bounds,this.minzoom,this.maxzoom)),zt(x.tiles,this.map._requestManager._customAccessToken),this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))),d&&d(p)})}hasTransition(){return!1}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loaded(){return this._loaded}loadTile(d,r){const l=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,o.R.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:d.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(d.actor&&d.state!=="expired")if(d.state==="loading")d.reloadCallback=r;else{if(d.buckets){const T=Object.values(d.buckets);for(const A of T)A.dirty=!0;return void(d.state="loaded")}d.request=d.actor.send("reloadTile",p,x.bind(this))}else d.actor=this.dispatcher.getActor(),d.request=d.actor.send("loadTile",p,x.bind(this),void 0,!0);function x(T,A){return d.aborted?r(null):T&&T.status!==404?r(T):(this.map._refreshExpiredTiles&&A&&d.setExpiryData(A),d.loadModelData(A,this.map.painter),d.state="loaded",void r(null))}}serialize(){return o.l({},this._options)}},canvas:class extends o.aD{constructor(d,r,l,p){super(d,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(T=>typeof T!="number"))||this.fire(new o.t(new o.V(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.t(new o.V(`sources.${d}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new o.t(new o.V(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new o.t(new o.V(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.t(new o.V(`sources.${d}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(d){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!d&&!this._playing||this.texture instanceof o.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends o.E{constructor(d,r,l,p){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Kn(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),o.l(this,o.ar(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this.map=d,this._loaded=!1,this.fire(new o.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:r,y:l,z:p}=d.canonical;return this._implementation.hasTile({x:r,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,r){const{x:l,y:p,z:x}=d.tileID.canonical,T=new AbortController;d.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:x},{signal:T.signal})).then((function(A){return delete d.request,d.aborted?(d.state="unloaded",r(null)):A===void 0?(d.state="errored",r(null)):A===null?(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",r(null)):function(F){return F instanceof ImageData||F instanceof HTMLCanvasElement||F instanceof ImageBitmap||F instanceof HTMLImageElement}(A)?(this.loadTileData(d,A),d.state="loaded",void r(null)):(d.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(A=>{A.code!==20&&(d.state="errored",r(A))}),d.request.cancel=()=>T.abort()}loadTileData(d,r){d.setTexture(r,this.map.painter)}unloadTile(d,r){if(d.texture&&d.texture instanceof o.T?(d.destroy(!0),d.texture&&d.texture instanceof o.T&&this.map.painter.saveTileTexture(d.texture)):d.destroy(),this._implementation.unloadTile){const{x:l,y:p,z:x}=d.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:x})}r&&r()}abortTile(d,r){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_clearTiles(){const d=o.av(this.id,this.scope);this.map.style.clearSource(d)}_update(){this.fire(new o.x("data",{dataType:"source",sourceDataType:"content"}))}}},qr=function(d,r,l,p){const x=new Kr[r.type](d,r,l,p);if(x.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${x.id}`);return o.aJ(["load","abort","unload","serialize","prepare"],x),x};function ci(d,r){const l=o.a6.mat4.identity([]);return o.a6.mat4.scale(l,l,[.5*d.width,.5*-d.height,1]),o.a6.mat4.translate(l,l,[1,-1,0]),o.a6.mat4.multiply(l,l,d.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(l)}function Zi(d,r,l,p,x,T,A,F,j=!1){const H=d.tilesIn(l,F,j);H.sort(Gr);const q=[];for(const Q of H)q.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(r,d._state,Q,p,x,T,A,ci(d.transform,Q.tile.tileID),j)});const Y=function(Q){const ae={},ge={};for(const _e of Q){const Te=_e.queryResults,we=_e.wrappedTileID,ze=ge[we]=ge[we]||{};for(const Ue in Te){const ke=Te[Ue],He=ze[Ue]=ze[Ue]||{},Ye=ae[Ue]=ae[Ue]||[];for(const Ze of ke)He[Ze.featureIndex]||(He[Ze.featureIndex]=!0,Ye.push(Ze))}}return ae}(q);for(const Q in Y)Y[Q].forEach(ae=>{const ge=ae.feature,_e=ge.layer;_e&&_e.type!=="background"&&_e.type!=="sky"&&_e.type!=="slot"&&(o.aK(Q)||(ge.source=_e.source,_e["source-layer"]&&(ge.sourceLayer=_e["source-layer"])),ge.state=ge.id!==void 0?d.getFeatureState(_e["source-layer"],ge.id):{})});return Y}function Xn(d,r){const l=d.getRenderableIds().map(T=>d.getTileByID(T)),p=[],x={};for(let T=0;T<l.length;T++){const A=l[T],F=A.tileID.canonical.key;x[F]||(x[F]=!0,A.querySourceFeatures(p,r))}return p}function Gr(d,r){const l=d.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function xa(d,r){const l={};if(!r)return l;for(const p of d){const x=p.layerIds.map(T=>r.getLayer(T)).filter(Boolean);if(x.length!==0){p.layers=x,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(T=>x.filter(A=>A.id===T)[0]));for(const T of x)l[T.fqid]=p}}return l}const lo=32,uo=33,wo=new Uint16Array(8184);for(let d=0;d<2046;d++){let r=d+2,l=0,p=0,x=0,T=0,A=0,F=0;for(1&r?x=T=A=lo:l=p=F=lo;(r>>=1)>1;){const H=l+x>>1,q=p+T>>1;1&r?(x=l,T=p,l=A,p=F):(l=x,p=T,x=A,T=F),A=H,F=q}const j=4*d;wo[j+0]=l,wo[j+1]=p,wo[j+2]=x,wo[j+3]=T}const yr=new Uint16Array(2178),wi=new Uint8Array(1089),fe=new Uint16Array(1089);function Oe(d){return d===0?-.03125:d===32?.03125:0}const We={type:2,extent:o.ab,loadGeometry:()=>[[new o.P(0,0),new o.P(o.ab+1,0),new o.P(o.ab+1,o.ab+1),new o.P(0,o.ab+1),new o.P(0,0)]]};class dt{constructor(r,l,p,x,T){this.tileID=r,this.uid=o.aQ(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=T,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<o.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=o.aL(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=xa(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const T=this.buckets[x];if(T instanceof o.aS){if(this.hasSymbolBuckets=!0,!p)break;T.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const T=this.buckets[x];if(T instanceof o.aS&&T.hasRTLText){this.hasRTLText=!0,o.aT();break}}this.queryPadding=0;for(const x in this.buckets){const T=this.buckets[x],A=l.style.getOwnLayer(x);if(!A)continue;const F=A.queryRadius(T);this.queryPadding=Math.max(this.queryPadding,F)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new o.aR}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,p){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets={...this.buckets,...xa(r.buckets,l.style)},r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const x in this.buckets){const T=this.buckets[x];T.uploadPending()&&T.upload(r)}const l=r.gl,p=this.imageAtlas;if(p&&!p.uploaded){const x=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new o.T(r,p.image,l.RGBA8,{useMipmap:x}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new o.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,p),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=l.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this._lastUpdatedBrightness=x,this.updateBuckets(l)))}queryRenderedFeatures(r,l,p,x,T,A,F,j,H){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:j,transform:F,filter:x,layers:T,availableImages:A,tileTransform:this.tileTransform},r,l):{}}querySourceFeatures(r,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const x=p.loadVTLayers(),T=l?l.sourceLayer:"",A=x._geojsonTileLayer||x[T];if(!A)return;const F=o.aU(l&&l.filter),{z:j,x:H,y:q}=this.tileID.canonical,Y={z:j,x:H,y:q};for(let Q=0;Q<A.length;Q++){const ae=A.feature(Q);if(F.needGeometry){const Te=o.aV(ae,!0);if(!F.filter(new o.a3(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!F.filter(new o.a3(this.tileID.overscaledZ),ae))continue;const ge=p.getId(ae,T),_e=new o.aW(ae,j,H,q,ge);_e.tile=Y,r.push(_e)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const p=o.aX(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let x=!1;if(this.expirationTime>p)x=!1;else if(l)if(this.expirationTime<l)x=!0;else{const T=this.expirationTime-l;T?this.expirationTime=p+Math.max(T,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),p=r.style.listImages(),x=r.style.getBrightness();for(const T in this.buckets){if(!r.style.hasLayer(T))continue;const A=this.buckets[T],F=A.layers[0],j=F.sourceLayer||"_geojsonTileLayer",H=l[j],q=r.style.getSourceCache(F.source,F.scope);let Y={};q&&(Y=q._state.getState(j,void 0)),A.update(Y,H,p,this.imageAtlas&&this.imageAtlas.patternPositions||{},x),(A instanceof o.aY||A instanceof o.aZ)&&r._terrain&&r._terrain.enabled&&q&&A.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(q.id,this.tileID);const Q=r&&r.style&&r.style.getOwnLayer(T);Q&&(this.queryPadding=Math.max(this.queryPadding,Q.queryRadius(A)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.q.now()+r}setTexture(r,l){const p=l.context,x=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r):(this.texture=new o.T(p,r,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(r,l){const p={};for(const x of l)p[x]=!0;this.dependencies[r]=p}hasDependency(r,l){for(const p of r){const x=this.dependencies[p];if(x){for(const T of l)if(x[T])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const p=o.a_(We,this.tileID.canonical,this.tileTransform)[0],x=new o.a$,T=new o.b0;for(let A=0;A<p.length;A++){const{x:F,y:j}=p[A];x.emplaceBack(F,j),T.emplaceBack(A)}T.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(T),this._tileDebugBuffer=r.createVertexBuffer(x,o.b1.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,x.length,T.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const p=o.a_(We,this.tileID.canonical,this.tileTransform)[0];let x,T;if(this.isRaster){const A=function(F,j){const H=o.aL(F,j),q=Math.pow(2,F.z);for(let Te=0;Te<uo;Te++)for(let we=0;we<uo;we++){const ze=o.aM((F.x+(we+Oe(we))/lo)/q),Ue=o.aN((F.y+(Te+Oe(Te))/lo)/q),ke=j.project(ze,Ue),He=Te*uo+we;yr[2*He+0]=Math.round((ke.x*H.scale-H.x)*o.ab),yr[2*He+1]=Math.round((ke.y*H.scale-H.y)*o.ab)}wi.fill(0),fe.fill(0);for(let Te=2045;Te>=0;Te--){const we=4*Te,ze=wo[we+0],Ue=wo[we+1],ke=wo[we+2],He=wo[we+3],Ye=ze+ke>>1,Ze=Ue+He>>1,Qe=Ye+Ze-Ue,it=Ze+ze-Ye,ft=Ue*uo+ze,st=He*uo+ke,at=Ze*uo+Ye,Rt=Math.hypot((yr[2*ft+0]+yr[2*st+0])/2-yr[2*at+0],(yr[2*ft+1]+yr[2*st+1])/2-yr[2*at+1])>=16;wi[at]=wi[at]||(Rt?1:0),Te<1022&&(wi[at]=wi[at]||wi[(Ue+it>>1)*uo+(ze+Qe>>1)]||wi[(He+it>>1)*uo+(ke+Qe>>1)])}const Y=new o.aO,Q=new o.aP;let ae=0;function ge(Te,we){const ze=we*uo+Te;return fe[ze]===0&&(Y.emplaceBack(yr[2*ze+0],yr[2*ze+1],Te*o.ab/lo,we*o.ab/lo),fe[ze]=++ae),fe[ze]-1}function _e(Te,we,ze,Ue,ke,He){const Ye=Te+ze>>1,Ze=we+Ue>>1;if(Math.abs(Te-ke)+Math.abs(we-He)>1&&wi[Ze*uo+Ye])_e(ke,He,Te,we,Ye,Ze),_e(ze,Ue,ke,He,Ye,Ze);else{const Qe=ge(Te,we),it=ge(ze,Ue),ft=ge(ke,He);Q.emplaceBack(Qe,it,ft)}}return _e(0,0,lo,lo,lo,0),_e(lo,lo,0,0,0,lo),{vertices:Y,indices:Q}}(this.tileID.canonical,l);x=A.vertices,T=A.indices}else{x=new o.aO,T=new o.aP;for(const{x:F,y:j}of p)x.emplaceBack(F,j,0,0);const A=o.b3(x.int16,void 0,4);for(let F=0;F<A.length;F+=3)T.emplaceBack(A[F],A[F+1],A[F+2])}this._tileBoundsBuffer=r.createVertexBuffer(x,o.b4.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(T),this._tileBoundsSegments=o.b2.simpleSegment(0,0,x.length,T.length)}_makeGlobeTileDebugBuffers(r,l){const p=l.projection;if(!p||p.name!=="globe"||l.freezeTileCoverage)return;const x=this.tileID.canonical,T=o.b5(x,l),A=o.b6(T),F=o.a9(l.zoom);let j;F>0&&(j=o.a6.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,x,l,A,j,F),this._makeGlobeTileDebugTextBuffer(r,x,l,A,j,F)}_globePoint(r,l,p,x,T,A,F){let j=o.b7(r,l,p);if(A){const H=1<<p.z,q=o.am(x.center.lng),Y=o.at(x.center.lat),Q=(p.x+.5)/H-q;let ae=0;Q>.5?ae=-1:Q<-.5&&(ae=1);let ge=(r/o.ab+p.x)/H+ae,_e=(l/o.ab+p.y)/H;ge=(ge-q)*x._pixelsPerMercatorPixel+q,_e=(_e-Y)*x._pixelsPerMercatorPixel+Y;const Te=[ge*x.worldSize,_e*x.worldSize,0];o.a6.vec3.transformMat4(Te,Te,A),j=o.b8(j,Te,F)}return o.a6.vec3.transformMat4(j,j,T)}_makeGlobeTileDebugBorderBuffer(r,l,p,x,T,A){const F=new o.a$,j=new o.b0,H=new o.b9,q=(Q,ae,ge,_e,Te)=>{const we=(ge-Q)/(Te-1),ze=(_e-ae)/(Te-1),Ue=F.length;for(let ke=0;ke<Te;ke++){const He=Q+ke*we,Ye=ae+ke*ze;F.emplaceBack(He,Ye);const Ze=this._globePoint(He,Ye,l,p,x,T,A);H.emplaceBack(Ze[0],Ze[1],Ze[2]),j.emplaceBack(Ue+ke)}},Y=o.ab;q(0,0,Y,0,16),q(Y,0,Y,Y,16),q(Y,Y,0,Y,16),q(0,Y,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(j),this._tileDebugBuffer=r.createVertexBuffer(F,o.b1.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(H,o.ba.members),this._tileDebugSegments=o.b2.simpleSegment(0,0,F.length,j.length)}_makeGlobeTileDebugTextBuffer(r,l,p,x,T,A){const F=o.ab/4,j=new o.a$,H=new o.aP,q=new o.b9,Y=25;H.reserve(32),j.reserve(Y),q.reserve(Y);const Q=(ae,ge)=>Y*ae+ge;for(let ae=0;ae<Y;ae++){const ge=ae*F;for(let _e=0;_e<Y;_e++){const Te=_e*F;j.emplaceBack(Te,ge);const we=this._globePoint(Te,ge,l,p,x,T,A);q.emplaceBack(we[0],we[1],we[2])}}for(let ae=0;ae<4;ae++)for(let ge=0;ge<4;ge++){const _e=Q(ae,ge),Te=Q(ae,ge+1),we=Q(ae+1,ge),ze=Q(ae+1,ge+1);H.emplaceBack(_e,Te,we),H.emplaceBack(we,Te,ze)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(H),this._tileDebugTextBuffer=r.createVertexBuffer(j,o.b1.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(q,o.ba.members),this._tileDebugTextSegments=o.b2.simpleSegment(0,0,Y,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof o.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}o.bb.setPbf(o.bc);class nn extends dt{constructor(r,l,p,x,T){super(r,l,p,x,T),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(r,l){const p=l.context,x=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof o.T?this.texture.update(r,{premultiply:!1}):this.texture=new o.T(p,r,x.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const p=this._mrt=new o.bb(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=o.bd(x,(T,A,F,j)=>{if(T)l(T);else try{const H=p.getHeaderLength(A);if(H>r)return void(this.request=this.fetchHeader(H,l));p.parseHeader(A),this._isHeaderLoaded=!0;let q=0;for(const Y of Object.values(p.layers))q=Math.max(q,Y.dataIndex[Y.dataIndex.length-1].last_byte);A.byteLength>=q&&(this.entireBuffer=A),l(null,this.entireBuffer||A,F,j)}catch(H){l(H)}}),this.request}fetchBand(r,l,p){const x=this._mrt;if(!this._isHeaderLoaded||!x)return void p(new Error("Tile header is not ready"));const T=this.actor;if(!T)return void p(new Error("Can't fetch tile band without an actor"));let A;const F=(Y,Q)=>{A.complete(Y,Q),Y?p(Y):(this.updateTextureDescriptor(r,l),p(null,this.textureDescriptor&&this.textureDescriptor.img))},j=(Y,Q)=>{if(Y)return p(Y);const ae=T.send("decodeRasterArray",{buffer:Q,task:A},F,void 0,!0);this._workQueue.push(()=>{ae&&ae.cancel(),A.cancel()})},H=x.getLayer(r);if(!H)return void p(new Error(`Unknown sourceLayer "${r}"`));if(H.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const q=H.getDataRange([l]);if(A=x.createDecodingTask(q),!A||A.tasks.length)if(this.flushQueues(),this.entireBuffer)j(null,this.entireBuffer.slice(q.firstByte,q.lastByte+1));else{const Y=Object.assign({},this.requestParams,{headers:{Range:`bytes=${q.firstByte}-${q.lastByte}`}}),Q=o.bd(Y,j);this._fetchQueue.push(()=>{Q.cancel(),A.cancel()})}else p(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const p=this._mrt.getLayer(r);if(!p||!p.hasBand(l)||!p.hasDataForBand(l))return;const{bytes:x,tileSize:T,buffer:A,offset:F,scale:j}=p.getBandView(l),H=T+2*A,q={data:x,width:H,height:H},Y=this.texture;Y&&Y instanceof o.T&&Y.update(q,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:q,buffer:A,offset:F,tileSize:T,format:p.pixelFormat,mix:[j,256*j,65536*j,16777216*j]}}}class Zt{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,p){const x=r.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const T={value:l,timeout:void 0};if(p!==void 0&&(T.timeout=setTimeout(()=>{this.remove(r,T)},p)),this.data[x].push(T),this.order.push(x),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const p=r.wrapped().key,x=l===void 0?0:this.data[p].indexOf(l),T=this.data[p][x];return this.data[p].splice(x,1),T.timeout&&clearTimeout(T.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(T.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const p in this.data)for(const x of this.data[p])r(x.value)||l.push(x);for(const p of l)this.remove(p.value.tileID,p)}}class fn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,p){const x=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][x]=this.stateChanges[r][x]||{},o.l(this.stateChanges[r][x],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const T in this.state[r])T!==x&&(this.deletedStates[r][T]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][x]===null){this.deletedStates[r][x]={};for(const T in this.state[r][x])p[T]||(this.deletedStates[r][x][T]=null)}else for(const T in p)this.deletedStates[r]&&this.deletedStates[r][x]&&this.deletedStates[r][x][T]===null&&delete this.deletedStates[r][x][T]}removeFeatureState(r,l,p){if(this.deletedStates[r]===null)return;const x=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&l!==void 0)this.deletedStates[r][x]!==null&&(this.deletedStates[r][x]=this.deletedStates[r][x]||{},this.deletedStates[r][x][p]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][x])for(p in this.deletedStates[r][x]={},this.stateChanges[r][x])this.deletedStates[r][x][p]=null;else this.deletedStates[r][x]=null;else this.deletedStates[r]=null}getState(r,l){const p=this.state[r]||{},x=this.stateChanges[r]||{},T=this.deletedStates[r];if(T===null)return{};if(l!==void 0){const F=String(l),j=o.l({},p[F],x[F]);if(T){const H=T[l];if(H===null)return{};for(const q in H)delete j[q]}return j}const A=o.l({},p,x);if(T)for(const F in T)delete A[F];return A}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const p={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const T={};for(const A in this.stateChanges[x])this.state[x][A]||(this.state[x][A]={}),o.l(this.state[x][A],this.stateChanges[x][A]),T[A]=this.state[x][A];p[x]=T}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const T={};if(this.deletedStates[x]===null)for(const A in this.state[x])T[A]={},this.state[x][A]={};else for(const A in this.deletedStates[x]){if(this.deletedStates[x][A]===null)this.state[x][A]={};else if(this.state[x][A])for(const F of Object.keys(this.deletedStates[x][A]))delete this.state[x][A][F];T[A]=this.state[x][A]}p[x]=p[x]||{},o.l(p[x],T)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const x in r)r[x].refreshFeatureState(l)}}class Cn extends o.E{constructor(r,l,p){super(),this.id=r,this._onlySymbols=p,l.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new Zt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new fn,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const l=this._tiles[r];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(r),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return o.be(this._tiles).map(r=>r.tileID).sort(Gn).map(r=>r.key)}getRenderableIds(r,l){const p=[];for(const x in this._tiles)this._isIdRenderable(+x,r,l)&&p.push(this._tiles[x]);return r?p.sort((x,T)=>{const A=x.tileID,F=T.tileID,j=new o.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle),H=new o.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return A.overscaledZ-F.overscaledZ||H.y-j.y||H.x-j.x}).map(x=>x.tileID.key):p.map(x=>x.tileID).sort(Gn).map(x=>x.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,p){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(p||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,r,l)))}_tileLoaded(r,l,p,x){if(x)if(r.state="errored",x.status!==404)this._source.fire(new o.t(x,{tile:r}));else{if(this._source.fire(new o.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const T=this.map.painter.terrain;this.update(this.transform,T.getScaledDemTileSize(),!0),T.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=o.q.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new o.x("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let x=0;x<l.length;x++){const T=l[x];if(r.neighboringTiles&&r.neighboringTiles[T]){const A=this.getTileByID(T);p(r,A),p(A,r)}}function p(x,T){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let A=T.tileID.canonical.x-x.tileID.canonical.x;const F=T.tileID.canonical.y-x.tileID.canonical.y,j=Math.pow(2,x.tileID.canonical.z),H=T.tileID.key;A===0&&F===0||Math.abs(F)>1||(Math.abs(A)>1&&(Math.abs(A+j)===1?A+=j:Math.abs(A-j)===1&&(A-=j)),T.dem&&x.dem&&(x.dem.backfillBorder(T.dem,A,F),x.neighboringTiles&&x.neighboringTiles[H]&&(x.neighboringTiles[H].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,p,x){for(const T in this._tiles){let A=this._tiles[T];if(x[T]||!A.hasData()||A.tileID.overscaledZ<=l||A.tileID.overscaledZ>p)continue;let F=A.tileID;for(;A&&A.tileID.overscaledZ>l+1;){const H=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[H.key],A&&A.hasData()&&(F=H)}let j=F;for(;j.overscaledZ>l;)if(j=j.scaledTo(j.overscaledZ-1),r[j.key]){x[F.key]=F;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=r.overscaledZ-1;p>=l;p--){const x=r.scaledTo(p),T=this._getLoadedTile(x);if(T)return T}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const p=Math.ceil(r.width/l)+1,x=Math.ceil(r.height/l)+1,T=Math.floor(p*x*5),A=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,T):T,F=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(F)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const p={};for(const x in this._tiles){const T=this._tiles[x];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+l),p[T.tileID.key]=T}this._tiles=p;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(r,l,p,x){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const T=this._source.type==="batched-model";let A,F=this._source.maxzoom;const j=this.map&&this.map.painter?this.map.painter._terrain:null;if(j&&j.sourceCache===this&&j.attenuationRange()){const Y=j.attenuationRange()[0],Q=Math.floor(Y)-Math.log2(j.getDemUpscale());F>Q&&(F=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)A=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(Y=>new o.aA(Y.canonical.z,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y));else if(this.tileCoverLift!==0){const Y=r.clone();Y.tileCoverLift=this.tileCoverLift,A=Y.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:F,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:T}),this._source.minzoom<=1&&r.projection.name==="globe"&&(A.push(new o.aA(1,0,1,0,0)),A.push(new o.aA(1,0,1,1,0)),A.push(new o.aA(1,0,1,0,1)),A.push(new o.aA(1,0,1,1,1)))}else if(A=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:F,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:T}),this._source.hasTile){const Y=this._source.hasTile.bind(this._source);A=A.filter(Q=>Y(Q))}}else A=[];if(A.length>0&&this.castsShadows&&x&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Cr(this._source.type)){const Y=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),Q=Math.min(Y,this._source.maxzoom);if(T){const ae=r.extendTileCover(A,Q);for(const ge of ae)A.push(ge)}else{const ae=r.extendTileCover(A,Q,x);for(const ge of ae)this._shadowCasterTiles[ge.key]=!0,A.push(ge)}}const H=this._updateRetainedTiles(A);if(Cr(this._source.type)&&A.length!==0){const Y={},Q={},ae=Object.keys(H);for(const _e of ae){const Te=H[_e],we=this._tiles[_e];if(!we||we.fadeEndTime&&we.fadeEndTime<=o.q.now())continue;const ze=this.findLoadedParent(Te,Math.max(Te.overscaledZ-Cn.maxOverzooming,this._source.minzoom));ze&&(this._addTile(ze.tileID),Y[ze.tileID.key]=ze.tileID),Q[_e]=Te}const ge=A[A.length-1].overscaledZ;for(const _e in this._tiles){const Te=this._tiles[_e];if(H[_e]||!Te.hasData())continue;let we=Te.tileID;for(;we.overscaledZ>ge;){we=we.scaledTo(we.overscaledZ-1);const ze=this._tiles[we.key];if(ze&&ze.hasData()&&Q[we.key]){H[_e]=Te.tileID;break}}}for(const _e in Y)H[_e]||(this._coveredTiles[_e]=!0,H[_e]=Y[_e])}for(const Y in H)this._tiles[Y].clearFadeHold();const q=o.bf(this._tiles,H);for(const Y of q){const Q=this._tiles[Y];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+Y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const p={},x=r.reduce((H,q)=>Math.min(H,q.overscaledZ),1/0),T=r[0].overscaledZ,A=Math.max(T-Cn.maxOverzooming,this._source.minzoom),F=Math.max(T+Cn.maxUnderzooming,this._source.minzoom),j={};for(const H of r){const q=this._addTile(H);l[H.key]=H,q.hasData()||x<this._source.maxzoom&&(j[H.key]=H)}this._retainLoadedChildren(j,x,F,l);for(const H of r){let q=this._tiles[H.key];if(q.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const Q=H.children(this._source.maxzoom)[0],ae=this.getTile(Q);if(ae&&ae.hasData()){l[Q.key]=Q;continue}}else{const Q=H.children(this._source.maxzoom);if(l[Q[0].key]&&l[Q[1].key]&&l[Q[2].key]&&l[Q[3].key])continue}let Y=q.wasRequested();for(let Q=H.overscaledZ-1;Q>=A;--Q){const ae=H.scaledTo(Q);if(p[ae.key]||(p[ae.key]=!0,q=this.getTile(ae),!q&&Y&&(q=this._addTile(ae)),q&&(l[ae.key]=ae,Y=q.wasRequested(),q.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let p,x=this._tiles[r].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){p=this._loadedParentTiles[x.key];break}l.push(x.key);const T=x.scaledTo(x.overscaledZ-1);if(p=this._getLoadedTile(T),p)break;x=T}for(const T of l)this._loadedParentTiles[T]=p}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const p=!!l;if(!p){const x=this.map?this.map.painter:null,T=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new nn(r,T,this.transform.tileZoom,x,this._isRaster):new dt(r,T,this.transform.tileZoom,x,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l?(l.uses++,this._tiles[r.key]=l,p||this._source.fire(new o.x("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=l.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,p){const x=[],T=this.transform;if(!T)return x;const A=T.projection.name==="globe",F=o.am(T.center.lng);for(const j in this._tiles){const H=this._tiles[j];if(p&&H.clearQueryDebugViz(),H.holdingForFade())continue;let q;if(A){const Y=H.tileID.canonical;if(Y.z===0){const Q=[Math.abs(o.ap(F,...Ur(Y,-1))-F),Math.abs(o.ap(F,...Ur(Y,1))-F)];q=[0,2*Q.indexOf(Math.min(...Q))-1]}else{const Q=[Math.abs(o.ap(F,...Ur(Y,-1))-F),Math.abs(o.ap(F,...Ur(Y,0))-F),Math.abs(o.ap(F,...Ur(Y,1))-F)];q=[Q.indexOf(Math.min(...Q))-1]}}else q=[0];for(const Y of q){const Q=r.containsTile(H,T,l,Y);Q&&x.push(Q)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const p=this.getRenderableIds(r,l).map(T=>this._tiles[T].tileID),x=this.transform.projection.name==="globe";for(const T of p)T.projMatrix=this.transform.calculateProjMatrix(T.toUnwrapped()),T.expandedProjMatrix=x?this.transform.calculateProjMatrix(T.toUnwrapped(),!1,!0):T.projMatrix;return p}sortCoordinatesByDistance(r){const l=r.slice(),p=this.transform._camera.position,x=this.transform._camera.forward(),T={};for(const A of l){const F=1/(1<<A.canonical.z);T[A.key]=((A.canonical.x+.5)*F+A.wrap-p[0])*x[0]+((A.canonical.y+.5)*F-p[1])*x[1]-p[2]*x[2]}return l.sort((A,F)=>T[A.key]-T[F.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Cr(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.q.now())return!0}return!1}setFeatureState(r,l,p){this._state.updateState(r=r||"_geojsonTileLayer",l,p)}removeFeatureState(r,l,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,p)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,p){const x=this._tiles[r];x&&x.setDependencies(l,p)}reloadTilesForDependencies(r,l){for(const p in this._tiles)this._tiles[p].hasDependency(r,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const j=()=>{this._sourceLoaded&&(this._source.off("data",j),this._preloadTiles(r,l))};return void this._source.on("data",j)}const p=new Map,x=Array.isArray(r)?r:[r],T=this.map.painter.terrain,A=this.usedForTerrain&&T?T.getScaledDemTileSize():this._source.tileSize;for(const j of x){const H=j.coveringTiles({tileSize:A,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const q of H)p.set(q.key,q);this.usedForTerrain&&j.updateElevation(!1)}const F=Array.from(p.values());o.bg(F,(j,H)=>{const q=new dt(j,this._source.tileSize*j.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(q,Y=>{this._source.type==="raster-dem"&&q.dem&&this._backfillDEM(q),H(Y,q)})},l)}}function Gn(d,r){const l=Math.abs(2*d.wrap)-+(d.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return d.overscaledZ-r.overscaledZ||p-l||r.canonical.y-d.canonical.y||r.canonical.x-d.canonical.x}function Cr(d){return d==="raster"||d==="image"||d==="video"||d==="custom"}function Ur(d,r){const l=1<<d.z;return[d.x/l+r,(d.x+1)/l+r]}Cn.maxOverzooming=10,Cn.maxUnderzooming=3;class Ri{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const p in this.style._mergedLayers){const x=this.style._mergedLayers[p];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:r,visibilityChanged:l});else if(x.type==="model"){const T=this.style.getLayerSource(x);T&&T.type==="batched-model"&&this.layers.push({layer:x,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const p=l.layer;let x=!1;p.type==="fill-extrusion"?x=!p.isHidden(r)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(x=!p.isHidden(r)&&p.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!x&&l.visible,l.visible=x}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const x of this.layers){const T=x.layer,A=this.style.getLayerSourceCache(T);let F=1;T.type==="fill-extrusion"&&(F=x.visible?T.paint.get("fill-extrusion-vertical-scale"):0);let j=A?A.getTile(l):null;if(!j&&A&&l.canonical.z>A.getSource().minzoom){let H=l.scaledTo(Math.min(A.getSource().maxzoom,l.overscaledZ-1));for(;H.overscaledZ>=A.getSource().minzoom&&(j=A.getTile(H),!j&&H.overscaledZ!==0);)H=H.scaledTo(H.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:j?j.getBucket(T):null,tileID:j?j.tileID:l,verticalScale:F})}r.hasAnyZOffset=!1;let p=!1;for(let x=0;x<r.symbolInstances.length;x++){const T=r.symbolInstances.get(x),A=T.zOffset,F=this._getHeightAtTileOffset(l,T.tileAnchorX,T.tileAnchorY);T.zOffset=F!==Number.NEGATIVE_INFINITY?F:A,p||A===T.zOffset||(p=!0),r.hasAnyZOffset||T.zOffset===0||(r.hasAnyZOffset=!0)}p&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,p,x){let T=l,A=p;if(r.canonical.z!==x.canonical.z){const F=x.canonical,j=1/(1<<r.canonical.z-F.z);T=(l+r.canonical.x*o.ab)*j-F.x*o.ab|0,A=(p+r.canonical.y*o.ab)*j-F.y*o.ab|0}return{tileX:T,tileY:A}}_getHeightAtTileOffset(r,l,p){let x,T;for(let A=0;A<this.layers.length;++A){if(this.layers[A].layer.type!=="fill-extrusion")continue;const{bucket:F,tileID:j,verticalScale:H}=this.currentBuildingBuckets[A];if(!F)continue;const{tileX:q,tileY:Y}=this._mapCoordToOverlappingTile(r,l,p,j),Q=F.getHeightAtTileCoord(q,Y);Q&&Q.height!==void 0&&(Q.hidden?x=Q.height:T=Math.max(Q.height*H,T||0))}if(T!==void 0)return T;for(let A=0;A<this.layers.length;++A){const F=this.layers[A];if(F.layer.type!=="model"||!F.visible)continue;const{bucket:j,tileID:H}=this.currentBuildingBuckets[A];if(!j)continue;const{tileX:q,tileY:Y}=this._mapCoordToOverlappingTile(r,l,p,H),Q=j.getHeightAtTileCoord(q,Y);if(Q&&!Q.hidden)return Q.height===void 0&&x!==void 0?Math.min(Q.maxHeight,x)*Q.verticalScale:Q.height?Q.height*Q.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function So(d,r){const l={};for(const p in d)p!=="ref"&&(l[p]=d[p]);return o.bh.forEach(p=>{p in r&&(l[p]=r[p])}),l}function To(d){d=d.slice();const r=Object.create(null);for(let l=0;l<d.length;l++)r[d[l].id]=d[l];for(let l=0;l<d.length;l++)"ref"in d[l]&&(d[l]=So(d[l],r[d[l].ref]));return d}const wr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Ba(d,r,l){l.push({command:wr.addSource,args:[d,r[d]]})}function Pr(d,r,l){r.push({command:wr.removeSource,args:[d]}),l[d]=!0}function Ho(d,r,l,p){Pr(d,l,p),Ba(d,r,l)}function Yn(d,r,l){let p;for(p in d[l])if(d[l].hasOwnProperty(p)&&p!=="data"&&!o.bi(d[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!o.bi(d[l][p],r[l][p]))return!1;return!0}function Wo(d,r,l,p,x,T){let A;for(A in r=r||{},d=d||{})d.hasOwnProperty(A)&&(o.bi(d[A],r[A])||l.push({command:T,args:[p,A,r[A],x]}));for(A in r)r.hasOwnProperty(A)&&!d.hasOwnProperty(A)&&(o.bi(d[A],r[A])||l.push({command:T,args:[p,A,r[A],x]}))}function ba(d){return d.id}function Hr(d,r){return d[r.id]=r,d}class fo{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ap(r,0,1);let l=1,p=this._distances[l];const x=r*this.paddedLength+this.padding;for(;p<x&&l<this._distances.length;)p=this._distances[++l];const T=l-1,A=this._distances[T],F=p-A,j=F>0?(x-A)/F:0;return this.points[T].mult(1-j).add(this.points[l].mult(j))}}class no{constructor(r,l,p){const x=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,x,T){this._forEachCell(l,p,x,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(T)}insertCircle(r,l,p,x){this._forEachCell(l-x,p-x,l+x,p+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(x)}_insertBoxCell(r,l,p,x,T,A){this.boxCells[T].push(A)}_insertCircleCell(r,l,p,x,T,A){this.circleCells[T].push(A)}_query(r,l,p,x,T,A){if(p<0||r>this.width||x<0||l>this.height)return!T&&[];const F=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=x){if(T)return!0;for(let j=0;j<this.boxKeys.length;j++)F.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const H=this.circles[3*j],q=this.circles[3*j+1],Y=this.circles[3*j+2];F.push({key:this.circleKeys[j],x1:H-Y,y1:q-Y,x2:H+Y,y2:q+Y})}return A?F.filter(A):F}return this._forEachCell(r,l,p,x,this._queryCell,F,{hitTest:T,seenUids:{box:{},circle:{}}},A),T?F.length>0:F}_queryCircle(r,l,p,x,T){const A=r-p,F=r+p,j=l-p,H=l+p;if(F<0||A>this.width||H<0||j>this.height)return!x&&[];const q=[];return this._forEachCell(A,j,F,H,this._queryCellCircle,q,{hitTest:x,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},T),x?q.length>0:q}query(r,l,p,x,T){return this._query(r,l,p,x,!1,T)}hitTest(r,l,p,x,T){return this._query(r,l,p,x,!0,T)}hitTestCircle(r,l,p,x){return this._queryCircle(r,l,p,!0,x)}_queryCell(r,l,p,x,T,A,F,j){const H=F.seenUids,q=this.boxCells[T];if(q!==null){const Q=this.bboxes;for(const ae of q)if(!H.box[ae]){H.box[ae]=!0;const ge=4*ae;if(r<=Q[ge+2]&&l<=Q[ge+3]&&p>=Q[ge+0]&&x>=Q[ge+1]&&(!j||j(this.boxKeys[ae]))){if(F.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[ae],x1:Q[ge],y1:Q[ge+1],x2:Q[ge+2],y2:Q[ge+3]})}}}const Y=this.circleCells[T];if(Y!==null){const Q=this.circles;for(const ae of Y)if(!H.circle[ae]){H.circle[ae]=!0;const ge=3*ae;if(this._circleAndRectCollide(Q[ge],Q[ge+1],Q[ge+2],r,l,p,x)&&(!j||j(this.circleKeys[ae]))){if(F.hitTest)return A.push(!0),!0;{const _e=Q[ge],Te=Q[ge+1],we=Q[ge+2];A.push({key:this.circleKeys[ae],x1:_e-we,y1:Te-we,x2:_e+we,y2:Te+we})}}}}}_queryCellCircle(r,l,p,x,T,A,F,j){const H=F.circle,q=F.seenUids,Y=this.boxCells[T];if(Y!==null){const ae=this.bboxes;for(const ge of Y)if(!q.box[ge]){q.box[ge]=!0;const _e=4*ge;if(this._circleAndRectCollide(H.x,H.y,H.radius,ae[_e+0],ae[_e+1],ae[_e+2],ae[_e+3])&&(!j||j(this.boxKeys[ge])))return A.push(!0),!0}}const Q=this.circleCells[T];if(Q!==null){const ae=this.circles;for(const ge of Q)if(!q.circle[ge]){q.circle[ge]=!0;const _e=3*ge;if(this._circlesCollide(ae[_e],ae[_e+1],ae[_e+2],H.x,H.y,H.radius)&&(!j||j(this.circleKeys[ge])))return A.push(!0),!0}}}_forEachCell(r,l,p,x,T,A,F,j){const H=this._convertToXCellCoord(r),q=this._convertToYCellCoord(l),Y=this._convertToXCellCoord(p),Q=this._convertToYCellCoord(x);for(let ae=H;ae<=Y;ae++)for(let ge=q;ge<=Q;ge++)if(T.call(this,r,l,p,x,this.xCellCount*ge+ae,A,F,j))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,x,T,A){const F=x-r,j=T-l,H=p+A;return H*H>F*F+j*j}_circleAndRectCollide(r,l,p,x,T,A,F){const j=(A-x)/2,H=Math.abs(r-(x+j));if(H>j+p)return!1;const q=(F-T)/2,Y=Math.abs(l-(T+q));if(Y>q+p)return!1;if(H<=j||Y<=q)return!0;const Q=H-j,ae=Y-q;return Q*Q+ae*ae<=p*p}}const ss={unknown:0,flipRequired:1,flipNotRequired:2},Dn=Math.tan(85*Math.PI/180);function ai(d,r,l,p,x,T,A){const F=o.a6.mat4.create();if(l)if(T.name==="globe"){const j=o.bj(x,r);o.a6.mat4.multiply(F,F,j)}else{const j=o.a6.mat2.invert([],A);F[0]=j[0],F[1]=j[1],F[4]=j[2],F[5]=j[3],p||o.a6.mat4.rotateZ(F,F,x.angle)}else o.a6.mat4.multiply(F,x.labelPlaneMatrix,d);return F}function Br(d,r,l,p,x,T,A){const F=ai(d,r,l,p,x,T,A);return T.name==="globe"&&l||(F[2]=F[6]=F[10]=F[14]=0),F}function Eo(d,r,l,p,x,T,A){if(l){if(T.name==="globe"){const F=ai(d,r,l,p,x,T,A);return o.a6.mat4.invert(F,F),o.a6.mat4.multiply(F,d,F),F}{const F=o.a6.mat4.clone(d),j=o.a6.mat4.identity([]);return j[0]=A[0],j[1]=A[1],j[4]=A[2],j[5]=A[3],o.a6.mat4.multiply(F,F,j),p||o.a6.mat4.rotateZ(F,F,-x.angle),F}}return x.glCoordMatrix}function Bo(d,r,l,p){const x=[d,r,l,1];l?o.a6.vec4.transformMat4(x,x,p):Oi(x,x,p);const T=x[3];return x[0]/=T,x[1]/=T,x[2]/=T,x}function cr(d,r){return Math.min(.5+d/r*.5,1.5)}function co(d,r){const l=d[0]/d[3],p=d[1]/d[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function ua(d,r,l,p,x,T,A,F,j,H){const q=l.transform,Y=p?d.textSizeData:d.iconSizeData,Q=o.bk(Y,l.transform.zoom),ae=q.projection.name==="globe",ge=[256/l.width*2+1,256/l.height*2+1],_e=p?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;_e.clear();let Te=null;ae&&(Te=p?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const we=d.lineVertexArray,ze=p?d.text.placedSymbolArray:d.icon.placedSymbolArray,Ue=l.transform.width/l.transform.height;let ke,He=!1;for(let Ye=0;Ye<ze.length;Ye++){const Ze=ze.get(Ye),{numGlyphs:Qe,writingMode:it}=Ze;if(it!==o.bl.vertical||He||ke===o.bl.horizontal||(He=!0),ke=it,(Ze.hidden||it===o.bl.vertical)&&!He){Za(Qe,_e);continue}He=!1;const ft=new o.P(Ze.tileAnchorX,Ze.tileAnchorY);let{x:st,y:at,z:Rt}=q.projection.projectTilePoint(ft.x,ft.y,H.canonical);if(j){const[en,bn,er]=j(ft);st+=en,at+=bn,Rt+=er}const $t=[st,at,Rt,1];if(o.a6.vec4.transformMat4($t,$t,r),!co($t,ge)){Za(Qe,_e);continue}const sn=$t[3],_n=cr(l.transform.getCameraToCenterDistance(q.projection),sn),yn=o.bm(Y,Q,Ze),yt=A?yn/_n:yn*_n,Qt=Bo(st,at,Rt,x);if(Qt[3]<=0){Za(Qe,_e);continue}let jt={};const tn=A?null:j,rn=ho(Ze,yt,!1,F,r,x,T,d.glyphOffsetArray,we,_e,Te,Qt,ft,jt,Ue,tn,q.projection,H,A);He=rn.useVertical,tn&&rn.needsFlipping&&(jt={}),(rn.notEnoughRoom||He||rn.needsFlipping&&ho(Ze,yt,!0,F,r,x,T,d.glyphOffsetArray,we,_e,Te,Qt,ft,jt,Ue,tn,q.projection,H,A).notEnoughRoom)&&Za(Qe,_e)}p?(d.text.dynamicLayoutVertexBuffer.updateData(_e),Te&&d.text.globeExtVertexBuffer&&d.text.globeExtVertexBuffer.updateData(Te)):(d.icon.dynamicLayoutVertexBuffer.updateData(_e),Te&&d.icon.globeExtVertexBuffer&&d.icon.globeExtVertexBuffer.updateData(Te))}function Na(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e){const{lineStartIndex:Te,glyphStartIndex:we,segment:ze}=F,Ue=we+F.numGlyphs,ke=Te+F.lineLength,He=r.getoffsetX(we),Ye=r.getoffsetX(Ue-1),Ze=Rs(d*He,l,p,x,T,A,ze,Te,ke,j,H,q,Y,Q,!0,ae,ge,_e);if(!Ze)return null;const Qe=Rs(d*Ye,l,p,x,T,A,ze,Te,ke,j,H,q,Y,Q,!0,ae,ge,_e);return Qe?{first:Ze,last:Qe}:null}function _o(d,r,l,p){return d===o.bl.horizontal&&Math.abs(p)>Math.abs(l)?{useVertical:!0}:d===o.bl.vertical?p>0?{needsFlipping:!0}:null:r!==ss.unknown&&function(x,T){return x===0||Math.abs(T/x)>Dn}(l,p)?r===ss.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function ho(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we,ze){const Ue=r/24,ke=d.lineOffsetX*Ue,He=d.lineOffsetY*Ue,{lineStartIndex:Ye,glyphStartIndex:Ze,numGlyphs:Qe,segment:it,writingMode:ft,flipState:st}=d,at=Ye+d.lineLength,Rt=$t=>{if(q){const[yt,Qt,jt]=$t.up,tn=H.length;o.bn(q,tn+0,yt,Qt,jt),o.bn(q,tn+1,yt,Qt,jt),o.bn(q,tn+2,yt,Qt,jt),o.bn(q,tn+3,yt,Qt,jt)}const[sn,_n,yn]=$t.point;o.bo(H,sn,_n,yn,$t.angle)};if(Qe>1){const $t=Na(Ue,F,ke,He,l,Y,Q,d,j,T,ae,_e,!1,Te,we,ze);if(!$t)return{notEnoughRoom:!0};if(p&&!l){let[sn,_n,yn]=$t.first.point,[yt,Qt,jt]=$t.last.point;[sn,_n]=Bo(sn,_n,yn,A),[yt,Qt]=Bo(yt,Qt,jt,A);const tn=_o(ft,st,(yt-sn)*ge,Qt-_n);if(d.flipState=tn&&tn.needsFlipping?ss.flipRequired:ss.flipNotRequired,tn)return tn}Rt($t.first);for(let sn=Ze+1;sn<Ze+Qe-1;sn++){const _n=Rs(Ue*F.getoffsetX(sn),ke,He,l,Y,Q,it,Ye,at,j,T,ae,_e,!1,!1,Te,we,ze);if(!_n)return H.length-=4*(sn-Ze),{notEnoughRoom:!0};Rt(_n)}Rt($t.last)}else{if(p&&!l){const sn=Bo(Q.x,Q.y,0,x),_n=Ye+it+1,yn=new o.P(j.getx(_n),j.gety(_n)),yt=Bo(yn.x,yn.y,0,x),Qt=yt[3]>0?yt:ks(Q,yn,sn,1,x,void 0,Te,we.canonical),jt=_o(ft,st,(Qt[0]-sn[0])*ge,Qt[1]-sn[1]);if(d.flipState=jt&&jt.needsFlipping?ss.flipRequired:ss.flipNotRequired,jt)return jt}const $t=Rs(Ue*F.getoffsetX(Ze),ke,He,l,Y,Q,it,Ye,at,j,T,ae,_e,!1,!1,Te,we,ze);if(!$t)return{notEnoughRoom:!0};Rt($t)}return{}}function hl(d,r,l,p,x){const{x:T,y:A,z:F}=p.projectTilePoint(d.x,d.y,r);if(!x)return Bo(T,A,F,l);const[j,H,q]=x(d);return Bo(T+j,A+H,F+q,l)}function ks(d,r,l,p,x,T,A,F){const j=hl(d.sub(r)._unit()._add(d),F,x,A,T);return o.a6.vec3.sub(j,l,j),o.a6.vec3.normalize(j,j),o.a6.vec3.scaleAndAdd(j,l,j,p)}function Rs(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we){const ze=p?d-r:d+r;let Ue=ze>0?1:-1,ke=0;p&&(Ue*=-1,ke=Math.PI),Ue<0&&(ke+=Math.PI);let He=F+A+(Ue>0?0:1)|0,Ye=x,Ze=x,Qe=0,it=0;const ft=Math.abs(ze),st=[],at=[];let Rt=T,$t=Rt;const sn=()=>ks($t,Rt,Ze,ft-Qe+1,q,Q,_e,Te.canonical);for(;Qe+it<=ft;){if(He+=Ue,He<F||He>=j)return null;if(Ze=Ye,$t=Rt,st.push(Ze),ae&&at.push($t),Rt=new o.P(H.getx(He),H.gety(He)),Ye=Y[He],!Ye){const bn=hl(Rt,Te.canonical,q,_e,Q);Ye=bn[3]>0?Y[He]=bn:sn()}Qe+=it,it=o.a6.vec3.distance(Ze,Ye)}ge&&Q&&(Y[He]&&(Ye=sn(),it=o.a6.vec3.distance(Ze,Ye)),Y[He]=Ye);const _n=(ft-Qe)/it,yn=Rt.sub($t)._mult(_n)._add($t),yt=o.a6.vec3.sub([],Ye,Ze),Qt=o.a6.vec3.scaleAndAdd([],Ze,yt,_n);let jt=[0,0,1],tn=yt[0],rn=yt[1];if(we&&(jt=_e.upVector(Te.canonical,yn.x,yn.y),jt[0]!==0||jt[1]!==0||jt[2]!==1)){const bn=[jt[2],0,-jt[0]],er=o.a6.vec3.cross([],jt,bn);o.a6.vec3.normalize(bn,bn),o.a6.vec3.normalize(er,er),tn=o.a6.vec3.dot(yt,bn),rn=o.a6.vec3.dot(yt,er)}if(l){const bn=o.a6.vec3.cross([],jt,yt);o.a6.vec3.normalize(bn,bn),o.a6.vec3.scaleAndAdd(Qt,Qt,bn,l*Ue)}const en=ke+Math.atan2(rn,tn);return st.push(Qt),ae&&at.push(yn),{point:Qt,angle:en,path:st,tilePath:at,up:jt}}function Za(d,r){const l=r.length,p=l+4*d;r.resize(p),r.float32.fill(-1/0,4*l,4*p)}function Oi(d,r,l){const p=r[0],x=r[1];return d[0]=l[0]*p+l[4]*x+l[12],d[1]=l[1]*p+l[5]*x+l[13],d[3]=l[3]*p+l[7]*x+l[15],d}const Zo=100;class ro{constructor(r,l,p=new no(r.width+200,r.height+200,25),x=new no(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=x,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Zo,this.screenBottomBoundary=r.height+Zo,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,x,T,A,F,j){let H=p.projectedAnchorX,q=p.projectedAnchorY,Y=p.projectedAnchorZ;const Q=p.elevation,ae=p.tileID,ge=r.getProjection();if(Q&&ae){const[Ye,Ze,Qe]=ge.upVector(ae.canonical,p.tileAnchorX,p.tileAnchorY),it=ge.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=Ye*Q*it,q+=Ze*Q*it,Y+=Qe*Q*it}const _e=this.projectAndGetPerspectiveRatio(F,H,q,Y,p.tileID,ge.name==="globe"||!!Q||this.transform.pitch>0,ge),Te=A*_e.perspectiveRatio,we=(p.x1*l+x.x-p.padding)*Te+_e.point.x,ze=(p.y1*l+x.y-p.padding)*Te+_e.point.y,Ue=(p.x2*l+x.x+p.padding)*Te+_e.point.x,ke=(p.y2*l+x.y+p.padding)*Te+_e.point.y,He=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(we,ze,Ue,ke)||!T&&this.grid.hitTest(we,ze,Ue,ke,j)||He?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[we,ze,Ue,ke],offscreen:this.isOffscreen(we,ze,Ue,ke),occluded:!1}}placeCollisionCircles(r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e){const Te=[],we=this.transform.elevation,ze=r.getProjection(),Ue=we?we.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,ze):null,ke=new o.P(p.tileAnchorX,p.tileAnchorY);let{x:He,y:Ye,z:Ze}=ze.projectTilePoint(ke.x,ke.y,_e.canonical);if(Ue){const[yn,yt,Qt]=Ue(ke);He+=yn,Ye+=yt,Ze+=Qt}const Qe=ze.name==="globe",it=this.projectAndGetPerspectiveRatio(F,He,Ye,Ze,_e,Qe||!!we||this.transform.pitch>0,ze),{perspectiveRatio:ft}=it,st=(Y?A/ft:A*ft)/o.br,at=Bo(He,Ye,Ze,j),Rt=it.signedDistanceFromCamera>0?Na(st,T,p.lineOffsetX*st,p.lineOffsetY*st,!1,at,ke,p,x,j,{},we&&!Y?Ue:null,Y&&!!we,ze,_e,Y):null;let $t=!1,sn=!1,_n=!0;if(Rt&&!it.occluded){const yn=.5*ae*ft+ge,yt=new o.P(-100,-100),Qt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),jt=new fo,{first:tn,last:rn}=Rt,en=tn.path.length;let bn=[];for(let Nn=en-1;Nn>=1;Nn--)bn.push(tn.path[Nn]);for(let Nn=1;Nn<rn.path.length;Nn++)bn.push(rn.path[Nn]);const er=2.5*yn;H&&(bn=bn.map(([Nn,ar,On],pr)=>(Ue&&!Qe&&(On=Ue(pr<en-1?tn.tilePath[en-1-pr]:rn.tilePath[pr-en+2])[2]),Bo(Nn,ar,On,H))),bn.some(Nn=>Nn[3]<=0)&&(bn=[]));let or=[];if(bn.length>0){let Nn=1/0,ar=-1/0,On=1/0,pr=-1/0;for(const kr of bn)Nn=Math.min(Nn,kr[0]),On=Math.min(On,kr[1]),ar=Math.max(ar,kr[0]),pr=Math.max(pr,kr[1]);ar>=yt.x&&Nn<=Qt.x&&pr>=yt.y&&On<=Qt.y&&(or=[bn.map(kr=>new o.P(kr[0],kr[1]))],(Nn<yt.x||ar>Qt.x||On<yt.y||pr>Qt.y)&&(or=o.bp(or,yt.x,yt.y,Qt.x,Qt.y)))}for(const Nn of or){jt.reset(Nn,.25*yn);let ar=0;ar=jt.length<=.5*yn?1:Math.ceil(jt.paddedLength/er)+1;for(let On=0;On<ar;On++){const pr=On/Math.max(ar-1,1),kr=jt.lerp(pr),si=kr.x+Zo,Si=kr.y+Zo;Te.push(si,Si,yn,0);const fr=si-yn,hi=Si-yn,Nr=si+yn,li=Si+yn;if(_n=_n&&this.isOffscreen(fr,hi,Nr,li),sn=sn||this.isInsideGrid(fr,hi,Nr,li),!l&&this.grid.hitTestCircle(si,Si,yn,Q)&&($t=!0,!q))return{circles:[],offscreen:!1,collisionDetected:$t,occluded:!1}}}}return{circles:!q&&$t||!sn?[]:Te,offscreen:_n,collisionDetected:$t,occluded:it.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,x=1/0,T=-1/0,A=-1/0;for(const q of r){const Y=new o.P(q.x+Zo,q.y+Zo);p=Math.min(p,Y.x),x=Math.min(x,Y.y),T=Math.max(T,Y.x),A=Math.max(A,Y.y),l.push(Y)}const F=this.grid.query(p,x,T,A).concat(this.ignoredGrid.query(p,x,T,A)),j={},H={};for(const q of F){const Y=q.key;if(j[Y.bucketInstanceId]===void 0&&(j[Y.bucketInstanceId]={}),j[Y.bucketInstanceId][Y.featureIndex])continue;const Q=[new o.P(q.x1,q.y1),new o.P(q.x2,q.y1),new o.P(q.x2,q.y2),new o.P(q.x1,q.y2)];o.bq(l,Q)&&(j[Y.bucketInstanceId][Y.featureIndex]=!0,H[Y.bucketInstanceId]===void 0&&(H[Y.bucketInstanceId]=[]),H[Y.bucketInstanceId].push(Y.featureIndex))}return H}insertCollisionBox(r,l,p,x,T){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:x,collisionGroupID:T},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,x,T){const A=l?this.ignoredGrid:this.grid,F={bucketInstanceId:p,featureIndex:x,collisionGroupID:T};for(let j=0;j<r.length;j+=4)A.insertCircle(F,r[j],r[j+1],r[j+2])}projectAndGetPerspectiveRatio(r,l,p,x,T,A,F){const j=[l,p,x,1];let H=!1;x||this.transform.pitch>0?(o.a6.vec4.transformMat4(j,j,r),this.fogState&&T&&F.name!=="globe"&&(H=function(Q,ae,ge,_e,Te,we){const ze=we.calculateFogTileMatrix(Te),Ue=[ae,ge,_e];return o.a6.vec3.transformMat4(Ue,Ue,ze),Wt(Q,o.a6.vec3.length(Ue),we.pitch,we._fov)}(this.fogState,l,p,x,T.toUnwrapped(),this.transform)>.9)):Oi(j,j,r);const q=j[3];return{point:new o.P((j[0]/q+1)/2*this.transform.width+Zo,(-j[1]/q+1)/2*this.transform.height+Zo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(F)/q*.5,1.5),signedDistanceFromCamera:q,occluded:A&&j[2]>q||H}}isOffscreen(r,l,p,x){return p<Zo||r>=this.screenRightBoundary||x<Zo||l>this.screenBottomBoundary}isInsideGrid(r,l,p,x){return p>=0&&r<this.gridRightBoundary&&x>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=o.a6.mat4.identity([]);return o.a6.mat4.translate(r,r,[-100,-100,0]),r}}function No(d,r,l){const p=r.createTileMatrix(d,d.worldSize,l.toUnwrapped());return o.a6.mat4.multiply(new Float32Array(16),d.projMatrix,p)}function ac(d,r,l){if(r.projection.name===l.projection.name)return d.projMatrix;const p=l.clone();return p.setProjection(r.projection),No(p,r.getProjection(),d)}function ts(d,r,l){return r.name===l.projection.name?d.projMatrix:No(l,r,d)}class io{constructor(r,l,p,x){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):x&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ca{constructor(r,l,p,x,T,A=!1){this.text=new io(r?r.text:null,l,p,T),this.icon=new io(r?r.icon:null,l,x,T),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class yo{constructor(r,l,p,x=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=x}}class Ao{constructor(){this.invProjMatrix=o.a6.mat4.create(),this.viewportMatrix=o.a6.mat4.create(),this.circles=[]}}class fl{constructor(r,l,p,x,T){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=x,this.tileID=T}}class Ca{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function bl(d,r,l,p,x){const{horizontalAlign:T,verticalAlign:A}=o.by(d),F=-(T-.5)*r,j=-(A-.5)*l,H=o.bx(d,p);return new o.P(F+H[0]*x,j+H[1]*x)}function Xo(d,r,l,p,x){const T=new o.P(d,r);return l&&T._rotate(p?x:-x),T}class ls{constructor(r,l,p,x,T,A){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new ro(this.transform,T),this.buildingIndex=A,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Ca(p),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,x,T=1){const A=p.getBucket(l),F=p.latestFeatureIndex;if(!A||!F||l.fqid!==A.layerIds[0])return;const j=A.layers[0].layout,H=A.layers[0].paint,q=p.collisionBoxArray,Y=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),Q=p.tileSize/o.ab,ae=p.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ge=(_e=p.tileID,Te=A.getProjection(),we=this.transform,Te.name===this.projection?we.calculateProjMatrix(_e.toUnwrapped()):No(we,Te,_e));var _e,Te,we;const ze=j.get("text-pitch-alignment")==="map",Ue=j.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const ke=l.dynamicFilter(),He=l.dynamicFilterNeedsFeature(),Ye=this.transform.calculatePixelsToTileUnitsMatrix(p),Ze=Br(ge,p.tileID.canonical,ze,Ue,this.transform,A.getProjection(),Ye);let Qe=null;if(ze){const sn=Eo(ge,p.tileID.canonical,ze,Ue,this.transform,A.getProjection(),Ye);Qe=o.a6.mat4.multiply([],this.transform.labelPlaneMatrix,sn)}let it=null;ke&&p.latestFeatureIndex&&(it={unwrappedTileID:ae,dynamicFilter:ke,dynamicFilterNeedsFeature:He}),this.retainedQueryData[A.bucketInstanceId]=new fl(A.bucketInstanceId,F,A.sourceLayerIndex,A.index,p.tileID);const ft=A.layers[0].layout.get("text-size-scale-range"),st=o.ap(T,ft[0],ft[1]),at=A.layers[0].layout.get("icon-size-scale-range"),Rt=o.ap(T,at[0],at[1]),$t={bucket:A,layout:j,paint:H,posMatrix:ge,textLabelPlaneMatrix:Ze,labelToScreenMatrix:Qe,clippingData:it,scale:Y,textPixelRatio:Q,holdingForFade:p.holdingForFade(),collisionBoxArray:q,partiallyEvaluatedTextSize:o.bk(A.textSizeData,this.transform.zoom,st),partiallyEvaluatedIconSize:o.bk(A.iconSizeData,this.transform.zoom,Rt),collisionGroup:this.collisionGroups.get(A.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(x)for(const sn of A.sortKeyRanges){const{sortKey:_n,symbolInstanceStart:yn,symbolInstanceEnd:yt}=sn;r.push({sortKey:_n,symbolInstanceStart:yn,symbolInstanceEnd:yt,parameters:$t})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:$t})}attemptAnchorPlacement(r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we,ze){const{textOffset0:Ue,textOffset1:ke,crossTileID:He}=Q,Ye=[Ue,ke],Ze=bl(r,p,x,Ye,T),Qe=this.collisionIndex.placeCollisionBox(ge,T,l,Xo(Ze.x,Ze.y,A,F,this.transform.angle),Y,j,H,q.predicate);if(Te){const it=ge.getSymbolInstanceIconSize(ze,this.transform.zoom,Q.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ge,it,Te,Xo(Ze.x,Ze.y,A,F,this.transform.angle),Y,j,H,q.predicate).box.length===0)return}if(Qe.box.length>0){let it;return this.prevPlacement&&this.prevPlacement.variableOffsets[He]&&this.prevPlacement.placements[He]&&this.prevPlacement.placements[He].text&&(it=this.prevPlacement.variableOffsets[He].anchor),this.variableOffsets[He]={textOffset:Ye,width:p,height:x,anchor:r,textScale:T,prevAnchor:it},this.markUsedJustification(ge,r,Q,_e),ge.allowVerticalPlacement&&(this.markUsedOrientation(ge,_e,Q),this.placedOrientations[He]=_e),{shift:Ze,placedGlyphBoxes:Qe}}}placeLayerBucketPart(r,l,p,x,T=1){const{bucket:A,layout:F,paint:j,posMatrix:H,textLabelPlaneMatrix:q,labelToScreenMatrix:Y,clippingData:Q,textPixelRatio:ae,holdingForFade:ge,collisionBoxArray:_e,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:we,collisionGroup:ze,latestFeatureIndex:Ue}=r.parameters,ke=F.get("text-optional"),He=F.get("icon-optional"),Ye=F.get("text-allow-overlap"),Ze=F.get("icon-allow-overlap"),Qe=F.get("text-rotation-alignment")==="map",it=F.get("text-pitch-alignment")==="map",ft=F.get("symbol-z-elevate"),st=j.get("symbol-z-offset"),at=F.get("symbol-elevation-reference")==="sea",Rt=F.get("text-size-scale-range"),$t=F.get("icon-size-scale-range"),sn=o.ap(T,Rt[0],Rt[1]),_n=o.ap(T,$t[0],$t[1]);this.transform.setProjection(A.projection);let yn=Ye&&(Ze||!A.hasIconData()||He),yt=Ze&&(Ye||!A.hasTextData()||ke);const Qt=!st.isConstant();!A.collisionArrays&&_e&&A.deserializeCollisionBoxes(_e),p&&x&&A.updateCollisionDebugBuffers(this.transform.zoom,_e,sn,_n);const jt=(tn,rn,en)=>{const{crossTileID:bn,numVerticalGlyphVertices:er}=tn;let or=null;if(Q&&Q.dynamicFilterNeedsFeature||Qt){const xi=this.retainedQueryData[A.bucketInstanceId];or=Ue.loadFeature({featureIndex:tn.featureIndex,bucketIndex:xi.bucketIndex,sourceLayerIndex:xi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Q&&!(0,Q.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},or,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new o.P(tn.tileAnchorX,tn.tileAnchorY),this.transform.calculateDistanceTileData(Q.unwrappedTileID)))return this.placements[bn]=new yo(!1,!1,!1,!0),void l.add(bn);const Nn=st.evaluate(or,{});if(l.has(bn))return;if(ge)return void(this.placements[bn]=new yo(!1,!1,!1));let ar=!1,On=!1,pr=!0,kr=!1,si=!1,Si=null,fr={box:null,offscreen:null,occluded:null},hi={box:null,offscreen:null,occluded:null},Nr=null,li=null,Rr=null,Li=0,Qr=0,Ei=0;en.textFeatureIndex?Li=en.textFeatureIndex:tn.useRuntimeCollisionCircles&&(Li=tn.featureIndex),en.verticalTextFeatureIndex&&(Qr=en.verticalTextFeatureIndex);const Ui=xi=>{xi.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const ni=this.transform.elevation;xi.elevation=at?Nn:Nn+(ni?ni.getAtTileOffset(xi.tileID,xi.tileAnchorX,xi.tileAnchorY):0),xi.elevation+=tn.zOffset},Yo=en.textBox;if(Yo){Ui(Yo);const xi=di=>{let Vi=o.bl.horizontal;if(A.allowVerticalPlacement&&!di&&this.prevPlacement){const ko=this.prevPlacement.placedOrientations[bn];ko&&(this.placedOrientations[bn]=ko,Vi=ko,this.markUsedOrientation(A,Vi,tn))}return Vi},ni=(di,Vi)=>{if(A.allowVerticalPlacement&&er>0&&en.verticalTextBox){for(const ko of A.writingModes)if(ko===o.bl.vertical?(fr=Vi(),hi=fr):fr=di(),fr&&fr.box&&fr.box.length)break}else fr=di()};if(F.get("text-variable-anchor")){let di=F.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[bn]){const ji=this.prevPlacement.variableOffsets[bn];di.indexOf(ji.anchor)>0&&(di=di.filter(pa=>pa!==ji.anchor),di.unshift(ji.anchor))}const Vi=(ji,pa,_s)=>{const ys=A.getSymbolInstanceTextSize(Te,tn,this.transform.zoom,rn),os=(ji.x2-ji.x1)*ys+2*ji.padding,al=(ji.y2-ji.y1)*ys+2*ji.padding,sl=tn.hasIconTextFit&&!Ze?pa:null;sl&&Ui(sl);let vs={box:[],offscreen:!1,occluded:!1};const ma=Ye?2*di.length:di.length;for(let Ja=0;Ja<ma;++Ja){const pi=this.attemptAnchorPlacement(di[Ja%di.length],ji,os,al,ys,Qe,it,ae,H,ze,Ja>=di.length,tn,rn,A,_s,sl,Te,we);if(pi&&(vs=pi.placedGlyphBoxes,vs&&vs.box&&vs.box.length)){ar=!0,Si=pi.shift;break}}return vs};ni(()=>Vi(Yo,en.iconBox,o.bl.horizontal),()=>{const ji=en.verticalTextBox;return ji&&Ui(ji),A.allowVerticalPlacement&&!(fr&&fr.box&&fr.box.length)&&er>0&&ji?Vi(ji,en.verticalIconBox,o.bl.vertical):{box:null,offscreen:null,occluded:null}}),fr&&(ar=fr.box,pr=fr.offscreen,kr=fr.occluded);const ko=xi(!(!fr||!fr.box));if(!ar&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[bn];ji&&(this.variableOffsets[bn]=ji,this.markUsedJustification(A,ji.anchor,tn,ko))}}else{const di=(Vi,ko)=>{const ji=A.getSymbolInstanceTextSize(Te,tn,this.transform.zoom,rn,T),pa=this.collisionIndex.placeCollisionBox(A,ji,Vi,new o.P(0,0),Ye,ae,H,ze.predicate);return pa&&pa.box&&pa.box.length&&(this.markUsedOrientation(A,ko,tn),this.placedOrientations[bn]=ko),pa};ni(()=>di(Yo,o.bl.horizontal),()=>{const Vi=en.verticalTextBox;return A.allowVerticalPlacement&&er>0&&Vi?(Ui(Vi),di(Vi,o.bl.vertical)):{box:null,offscreen:null,occluded:null}}),xi(!!(fr&&fr.box&&fr.box.length))}}if(Nr=fr,ar=Nr&&Nr.box&&Nr.box.length>0,pr=Nr&&Nr.offscreen,kr=Nr&&Nr.occluded,tn.useRuntimeCollisionCircles){const xi=A.text.placedSymbolArray.get(tn.centerJustifiedTextSymbolIndex>=0?tn.centerJustifiedTextSymbolIndex:tn.verticalPlacedTextSymbolIndex),ni=o.bm(A.textSizeData,Te,xi),di=F.get("text-padding");li=this.collisionIndex.placeCollisionCircles(A,Ye,xi,A.lineVertexArray,A.glyphOffsetArray,ni,H,q,Y,p,it,ze.predicate,tn.collisionCircleDiameter*ni/o.br,di,this.retainedQueryData[A.bucketInstanceId].tileID),ar=Ye||li.circles.length>0&&!li.collisionDetected,pr=pr&&li.offscreen,kr=li.occluded}if(en.iconFeatureIndex&&(Ei=en.iconFeatureIndex),en.iconBox){const xi=ni=>{Ui(ni);const di=tn.hasIconTextFit&&Si?Xo(Si.x,Si.y,Qe,it,this.transform.angle):new o.P(0,0),Vi=A.getSymbolInstanceIconSize(we,this.transform.zoom,tn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,Vi,ni,di,Ze,ae,H,ze.predicate)};hi&&hi.box&&hi.box.length&&en.verticalIconBox?(Rr=xi(en.verticalIconBox),On=Rr.box.length>0):(Rr=xi(en.iconBox),On=Rr.box.length>0),pr=pr&&Rr.offscreen,si=Rr.occluded}const Vs=ke||tn.numHorizontalGlyphVertices===0&&er===0,Ps=He||tn.numIconVertices===0;if(Vs||Ps?Ps?Vs||(On=On&&ar):ar=On&&ar:On=ar=On&&ar,ar&&Nr&&Nr.box&&this.collisionIndex.insertCollisionBox(Nr.box,F.get("text-ignore-placement"),A.bucketInstanceId,hi&&hi.box&&Qr?Qr:Li,ze.ID),On&&Rr&&this.collisionIndex.insertCollisionBox(Rr.box,F.get("icon-ignore-placement"),A.bucketInstanceId,Ei,ze.ID),li&&(ar&&this.collisionIndex.insertCollisionCircles(li.circles,F.get("text-ignore-placement"),A.bucketInstanceId,Li,ze.ID),p)){const xi=A.bucketInstanceId;let ni=this.collisionCircleArrays[xi];ni===void 0&&(ni=this.collisionCircleArrays[xi]=new Ao);for(let di=0;di<li.circles.length;di+=4)ni.circles.push(li.circles[di+0]),ni.circles.push(li.circles[di+1]),ni.circles.push(li.circles[di+2]),ni.circles.push(li.collisionDetected?1:0)}const Qi=A.projection.name!=="globe";yn=yn&&(Qi||!kr),yt=yt&&(Qi||!si),this.placements[bn]=new yo(ar||yn,On||yt,pr||A.justReloaded),l.add(bn)};if(ft&&this.buildingIndex&&(this.buildingIndex.updateZOffset(A,this.retainedQueryData[A.bucketInstanceId].tileID),A.updateZOffset()),A.sortFeaturesByY){const tn=A.getSortedSymbolIndexes(this.transform.angle);for(let rn=tn.length-1;rn>=0;--rn){const en=tn[rn];jt(A.symbolInstances.get(en),en,A.collisionArrays[en])}A.hasAnyZOffset&&o.w(`${A.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(A.hasAnyZOffset){const tn=A.getSortedIndexesByZOffset();for(let rn=0;rn<tn.length;++rn){const en=tn[rn];jt(A.symbolInstances.get(en),en,A.collisionArrays[en])}}else for(let tn=r.symbolInstanceStart;tn<r.symbolInstanceEnd;tn++)jt(A.symbolInstances.get(tn),tn,A.collisionArrays[tn]);if(p&&A.bucketInstanceId in this.collisionCircleArrays){const tn=this.collisionCircleArrays[A.bucketInstanceId];o.a6.mat4.invert(tn.invProjMatrix,H),tn.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(r,l,p,x){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:j,crossTileID:H}=p,q=o.bw(l),Y=x===o.bl.vertical?j:q==="left"?T:q==="center"?A:q==="right"?F:-1;T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=Y>=0&&T!==Y?0:H),A>=0&&(r.text.placedSymbolArray.get(A).crossTileID=Y>=0&&A!==Y?0:H),F>=0&&(r.text.placedSymbolArray.get(F).crossTileID=Y>=0&&F!==Y?0:H),j>=0&&(r.text.placedSymbolArray.get(j).crossTileID=Y>=0&&j!==Y?0:H)}markUsedOrientation(r,l,p){const x=l===o.bl.horizontal||l===o.bl.horizontalOnly?l:0,T=l===o.bl.vertical?l:0,{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:j,verticalPlacedTextSymbolIndex:H}=p,q=r.text.placedSymbolArray;A>=0&&(q.get(A).placedOrientation=x),F>=0&&(q.get(F).placedOrientation=x),j>=0&&(q.get(j).placedOrientation=x),H>=0&&(q.get(H).placedOrientation=T)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const x=l?l.symbolFadeChange(r):1,T=l?l.opacities:{},A=l?l.variableOffsets:{},F=l?l.placedOrientations:{};for(const j in this.placements){const H=this.placements[j],q=T[j];q?(this.opacities[j]=new ca(q,x,H.text,H.icon,null,H.clipped),p=p||H.text!==q.text.placed||H.icon!==q.icon.placed):(this.opacities[j]=new ca(null,x,H.text,H.icon,H.skipFade,H.clipped),p=p||H.text||H.icon)}for(const j in T){const H=T[j];if(!this.opacities[j]){const q=new ca(H,x,!1,!1);q.isHidden()||(this.opacities[j]=q,p=p||H.text.placed||H.icon.placed)}}for(const j in A)this.variableOffsets[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.variableOffsets[j]=A[j]);for(const j in F)this.placedOrientations[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.placedOrientations[j]=F[j]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,p,x){const T=new Set;for(const A of l){const F=A.getBucket(r);F&&A.latestFeatureIndex&&r.fqid===F.layerIds[0]&&(this.updateBucketOpacities(F,T,A,A.collisionBoxArray,p,x,A.tileID,r.scope),F.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(F,A.tileID),F.updateZOffset()))}}updateBucketOpacities(r,l,p,x,T,A,F,j){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const H=r.layers[0].layout,q=r.layers[0].paint,Y=!!r.layers[0].dynamicFilter(),Q=new ca(null,0,!1,!1,!0),ae=H.get("text-allow-overlap"),ge=H.get("icon-allow-overlap"),_e=H.get("text-variable-anchor"),Te=H.get("text-rotation-alignment")==="map",we=H.get("text-pitch-alignment")==="map",ze=q.get("symbol-z-offset"),Ue=H.get("symbol-elevation-reference")==="sea",ke=!ze.isConstant(),He=new ca(null,0,ae&&(ge||!r.hasIconData()||H.get("icon-optional")),ge&&(ae||!r.hasTextData()||H.get("text-optional")),!0);!r.collisionArrays&&x&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(x);const Ye=(Qe,it,ft)=>{for(let st=0;st<it/4;st++)Qe.opacityVertexArray.emplaceBack(ft)};let Ze=0;A&&r.updateReplacement(F,A);for(let Qe=0;Qe<r.symbolInstances.length;Qe++){const it=r.symbolInstances.get(Qe),{numHorizontalGlyphVertices:ft,numVerticalGlyphVertices:st,crossTileID:at,numIconVertices:Rt,tileAnchorX:$t,tileAnchorY:sn}=it;let _n=null;const yn=this.retainedQueryData[r.bucketInstanceId];ke&&it&&yn&&(_n=p.latestFeatureIndex.loadFeature({featureIndex:it.featureIndex,bucketIndex:yn.bucketIndex,sourceLayerIndex:yn.sourceLayerIndex,layoutVertexArrayOffset:0}));const yt=ze.evaluate(_n,{}),Qt=l.has(at);let jt=this.opacities[at];Qt?jt=Q:jt||(jt=He,this.opacities[at]=jt),l.add(at);const tn=ft>0||st>0,rn=Rt>0,en=this.placedOrientations[at],bn=en===o.bl.vertical,er=en===o.bl.horizontal||en===o.bl.horizontalOnly;!tn&&!rn||jt.isHidden()||Ze++;let or=!1;if((tn||rn)&&A)for(const Nn of r.activeReplacements){if(o.bs(Nn,T,o.bt.Symbol,j)||Nn.min.x>$t||$t>Nn.max.x||Nn.min.y>sn||sn>Nn.max.y)continue;const ar=o.bu($t,sn,F.canonical,Nn.footprintTileId.canonical);if(or=o.bv(ar,Nn.footprint),or)break}if(tn){const Nn=or?$l:lu(jt.text);Ye(r.text,ft,bn?$l:Nn),Ye(r.text,st,er?$l:Nn);const ar=jt.text.isHidden(),{leftJustifiedTextSymbolIndex:On,centerJustifiedTextSymbolIndex:pr,rightJustifiedTextSymbolIndex:kr,verticalPlacedTextSymbolIndex:si}=it,Si=r.text.placedSymbolArray,fr=ar||bn?1:0;On>=0&&(Si.get(On).hidden=fr),pr>=0&&(Si.get(pr).hidden=fr),kr>=0&&(Si.get(kr).hidden=fr),si>=0&&(Si.get(si).hidden=ar||er?1:0);const hi=this.variableOffsets[at];hi&&this.markUsedJustification(r,hi.anchor,it,en);const Nr=this.placedOrientations[at];Nr&&(this.markUsedJustification(r,"left",it,Nr),this.markUsedOrientation(r,Nr,it))}if(rn){const Nn=or?$l:lu(jt.icon),{placedIconSymbolIndex:ar,verticalPlacedIconSymbolIndex:On}=it,pr=r.icon.placedSymbolArray,kr=jt.icon.isHidden()?1:0;ar>=0&&(Ye(r.icon,Rt,bn?$l:Nn),pr.get(ar).hidden=kr),On>=0&&(Ye(r.icon,it.numVerticalIconVertices,er?$l:Nn),pr.get(On).hidden=kr)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Nn=r.collisionArrays[Qe];if(Nn){let ar=new o.P(0,0),On=!0;if(Nn.textBox||Nn.verticalTextBox){if(_e){const kr=this.variableOffsets[at];kr?(ar=bl(kr.anchor,kr.width,kr.height,kr.textOffset,kr.textScale),Te&&ar._rotate(we?this.transform.angle:-this.transform.angle)):On=!1}Y&&(On=!jt.clipped),Nn.textBox&&bs(r.textCollisionBox.collisionVertexArray,jt.text.placed,!On||bn,yt,Ue,ar.x,ar.y),Nn.verticalTextBox&&bs(r.textCollisionBox.collisionVertexArray,jt.text.placed,!On||er,yt,Ue,ar.x,ar.y)}const pr=On&&!!(!er&&Nn.verticalIconBox);Nn.iconBox&&bs(r.iconCollisionBox.collisionVertexArray,jt.icon.placed,pr,yt,Ue,it.hasIconTextFit?ar.x:0,it.hasIconTextFit?ar.y:0),Nn.verticalIconBox&&bs(r.iconCollisionBox.collisionVertexArray,jt.icon.placed,!pr,yt,Ue,it.hasIconTextFit?ar.x:0,it.hasIconTextFit?ar.y:0)}}}if(r.fullyClipped=Ze===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Qe=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Qe.invProjMatrix,r.placementViewportMatrix=Qe.viewportMatrix,r.collisionCircleArray=Qe.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function bs(d,r,l,p,x,T,A){d.emplaceBack(r?1:0,l?1:0,T||0,A||0,p,x?1:0),d.emplaceBack(r?1:0,l?1:0,T||0,A||0,p,x?1:0),d.emplaceBack(r?1:0,l?1:0,T||0,A||0,p,x?1:0),d.emplaceBack(r?1:0,l?1:0,T||0,A||0,p,x?1:0)}const ra=Math.pow(2,25),sc=Math.pow(2,24),lc=Math.pow(2,17),wa=Math.pow(2,16),us=Math.pow(2,9),wl=Math.pow(2,8),Ru=Math.pow(2,1);function lu(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const r=d.placed?1:0,l=Math.floor(127*d.opacity);return l*ra+r*sc+l*lc+r*wa+l*us+r*wl+l*Ru+r}const $l=0;class uu{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,p,x,T,A){const F=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(F,x,r[this._currentTileIndex],this._sortAcrossTiles,A),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((j,H)=>j.sortKey-H.sortKey));this._currentPartIndex<F.length;){const j=F[this._currentPartIndex];if(l.placeLayerBucketPart(j,this._seenCrossTileIDs,p,j.symbolInstanceStart===0,A),this._currentPartIndex++,T())return!0}return!1}}class cu{constructor(r,l,p,x,T,A,F,j,H){this.placement=new ls(r,T,A,F,j,H),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p,x,T){const A=o.q.now(),F=()=>{const j=o.q.now()-A;return!this._forceFullPlacement&&j>2};for(;this._currentPlacementIndex>=0;){const j=l[r[this._currentPlacementIndex]],H=this.placement.collisionIndex.transform.zoom;if(j.type==="symbol"&&(!j.minzoom||j.minzoom<=H)&&(!j.maxzoom||j.maxzoom>H)){const q=j,Y=q.layout.get("symbol-z-elevate"),Q=q.layout.get("symbol-sort-key").constantOr(1)!==void 0,ae=q.layout.get("symbol-z-order"),ge=ae==="viewport-y"||ae==="auto"&&!(ae!=="viewport-y"&&Q),_e=q.layout.get("text-allow-overlap")||q.layout.get("icon-allow-overlap")||q.layout.get("text-ignore-placement")||q.layout.get("icon-ignore-placement"),Te=ge&&_e,we=this._inProgressLayer=this._inProgressLayer||new uu(q),ze=o.av(j.source,j.scope);if(we.continuePlacement(Y||Te?x[ze]:p[ze],this.placement,this._showCollisionBoxes,j,F,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Ks=512/o.ab/2;class Lu{constructor(r,l,p){this.tileID=r,this.bucketInstanceId=p,this.index=new o.bz(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=r.canonical.x*o.ab,T=r.canonical.y*o.ab;for(let A=0;A<l.length;A++){const{key:F,crossTileID:j,tileAnchorX:H,tileAnchorY:q}=l.get(A),Y=Math.floor((x+H)*Ks),Q=Math.floor((T+q)*Ks);this.index.add(Y,Q),this.keys.push(F),this.crossTileIDs.push(j)}this.index.finish()}findMatches(r,l,p){const x=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),T=Ks/Math.pow(2,l.canonical.z-this.tileID.canonical.z),A=l.canonical.x*o.ab,F=l.canonical.y*o.ab;for(let j=0;j<r.length;j++){const H=r.get(j);if(H.crossTileID)continue;const{key:q,tileAnchorX:Y,tileAnchorY:Q}=H,ae=Math.floor((A+Y)*T),ge=Math.floor((F+Q)*T),_e=this.index.range(ae-x,ge-x,ae+x,ge+x);for(const Te of _e){const we=this.crossTileIDs[Te];if(this.keys[Te]===q&&!p.has(we)){p.add(we),H.crossTileID=we;break}}}}}class ws{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class dl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const x=this.indexes[p],T={};for(const A in x){const F=x[A];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+l),T[F.tileID.key]=F}this.indexes[p]=T}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let T=0;T<l.symbolInstances.length;T++)l.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const x=this.usedCrossTileIDs[r.overscaledZ];for(const T in this.indexes){const A=this.indexes[T];if(Number(T)>r.overscaledZ)for(const F in A){const j=A[F];j.tileID.isChildOf(r)&&j.findMatches(l.symbolInstances,r,x)}else{const F=A[r.scaledTo(Number(T)).key];F&&F.findMatches(l.symbolInstances,r,x)}}for(let T=0;T<l.symbolInstances.length;T++){const A=l.symbolInstances.get(T);A.crossTileID||(A.crossTileID=p.generate(),x.add(A.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Lu(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p of l.crossTileIDs)this.usedCrossTileIDs[r].delete(p)}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const x=this.indexes[p];for(const T in x)r[x[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,x[T]),delete x[T],l=!0)}return l}}class Du{constructor(){this.layerIndexes={},this.crossTileIDs=new ws,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,x){let T=this.layerIndexes[r.fqid];T===void 0&&(T=this.layerIndexes[r.fqid]=new dl);let A=!1;const F={};x.name!=="globe"&&T.handleWrapJump(p);for(const j of l){const H=j.getBucket(r);H&&r.fqid===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(j.tileID,H,this.crossTileIDs)&&(A=!0),F[H.bucketInstanceId]=!0)}return T.removeStaleBuckets(F)&&(A=!0),A}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const ia=771;class Sr{constructor(r,l,p,x){this.blendFunction=r,this.blendColor=l,this.mask=p,this.blendEquation=x}}Sr.Replace=[1,0,1,0],Sr.disabled=new Sr(Sr.Replace,o.bA.transparent,[!1,!1,!1,!1]),Sr.unblended=new Sr(Sr.Replace,o.bA.transparent,[!0,!0,!0,!0]),Sr.alphaBlended=new Sr([1,ia,1,ia],o.bA.transparent,[!0,!0,!0,!0]),Sr.alphaBlendedNonPremultiplied=new Sr([770,ia,770,ia],o.bA.transparent,[!0,!0,!0,!0]),Sr.multiply=new Sr([774,0,774,0],o.bA.transparent,[!0,!0,!0,!0]);class ir{constructor(r,l,p){this.func=r,this.mask=l,this.range=p}}ir.ReadOnly=!1,ir.ReadWrite=!0,ir.disabled=new ir(519,ir.ReadOnly,[0,1]);const pe=7680;class Pe{constructor(r,l,p,x,T,A){this.test=r,this.ref=l,this.mask=p,this.fail=x,this.depthFail=T,this.pass=A}}Pe.disabled=new Pe({func:519,mask:0},0,0,pe,pe,pe);const Xe=1029,pt=2305;class Mt{constructor(r,l,p){this.enable=r,this.mode=l,this.frontFace=p}}function an(d,r){const l=o.bD(d,3);o.a6.mat4.fromQuat(d,r),o.bF(d,3,l)}function wn(d,r){const l=o.a6.quat.identity([]);return o.a6.quat.rotateZ(l,l,-r),o.a6.quat.rotateX(l,l,-d),l}function Hn(d,r){const l=[d[0],d[1],0],p=[r[0],r[1],0];if(o.a6.vec3.length(l)>=1e-15){const A=o.a6.vec3.normalize([],l);o.a6.vec3.scale(p,A,o.a6.vec3.dot(p,A)),r[0]=p[0],r[1]=p[1]}const x=o.a6.vec3.cross([],r,d);if(o.a6.vec3.len(x)<1e-15)return null;const T=Math.atan2(-x[1],x[0]);return wn(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),T)}Mt.disabled=new Mt(!1,Xe,pt),Mt.backCCW=new Mt(!0,Xe,pt),Mt.backCW=new Mt(!0,Xe,2304),Mt.frontCW=new Mt(!0,1028,2304),Mt.frontCCW=new Mt(!0,1028,pt);class vr{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof o.a5?r:new o.a5(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=o.bB(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this.position,x=this._elevation?this._elevation.getAtPointOrZero(o.a5.fromLngLat(r)):0,T=o.a5.fromLngLat(r,x),A=[T.x-p.x,T.y-p.y,T.z-p.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=Hn(A,l)}setPitchBearing(r,l){this.orientation=wn(o.bC(r),o.bC(-l))}}class Yr{constructor(r,l){this._transform=o.a6.mat4.identity([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new o.a5(r[0],r[1],r[2])}get position(){const r=o.bD(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&o.bF(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||o.a6.quat.identity([]),r&&an(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=wn(r,l),an(this._transform,this._orientation)}forward(){const r=o.bD(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=o.bD(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=o.bD(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return o.a6.mat4.invert(p,this.getWorldToCamera(r,l)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,p){const x=this.position;o.a6.vec3.scale(x,x,-r);const T=new Float64Array(16);return o.a6.mat4.fromScaling(T,[p,p,p]),o.a6.mat4.translate(T,T,x),T[10]*=l,T}getWorldToCamera(r,l){const p=new Float64Array(16),x=new Float64Array(4),T=this.position;return o.a6.quat.conjugate(x,this._orientation),o.a6.vec3.scale(T,T,-r),o.a6.mat4.fromQuat(p,x),o.a6.mat4.translate(p,p,T),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,x){const T=new Float64Array(16);return o.a6.mat4.perspective(T,r,l,p,x),T}getCameraToClipOrthographic(r,l,p,x,T,A){const F=new Float64Array(16);return o.a6.mat4.ortho(F,r,l,p,x,T,A),F}getDistanceToElevation(r,l=!1){const p=r===0?0:o.bE(r,l?o.aN(this.position[1]):this.position[1]),x=this.forward();return(p-this.position[2])/x[2]}clone(){return new Yr([...this.position],[...this.orientation])}}const Or={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class zi{constructor(r=0,l=0,p=0,x=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=x}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=o.aa(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=o.aa(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=o.aa(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=o.aa(r.right,l.right,p)),this}getCenter(r,l){const p=o.ap((this.left+r-this.right)/2,0,r),x=o.ap((this.top+l-this.bottom)/2,0,l);return new o.P(p,x)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new zi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const ha=(d,r,l)=>(1-l)*d+l*r,jo=d=>d*d*d*d*d;class Xa{constructor(r,l,p,x,T,A,F){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p??0,this._maxPitch=x??60,this.setProjection(A),this.setMaxBounds(F),this.width=0,this.height=0,this._center=new o.bL(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new zi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Yr,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new Xa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return o.ar(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=o.bM(this.projectionOptions);const p=this.getProjection(),x=!o.bi(l,p);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.bM({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.bE(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return o.bB(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=o.a6.mat2.create(),o.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=o.ap(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=o.bC(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let x=0,T=0;for(let A=0;A<l.length;A++){const F=new o.P(l[A][0]*this.width,p+l[A][1]*(this.height-p)),j=r.pointCoordinate(F);if(!j)continue;const H=1/Math.hypot(j[0]-this._camera.position[0],j[1]-this._camera.position[1]);x+=j[3]*H,T+=H}return T===0?NaN:x/T}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,x=this._mercatorZfromZoom(r),T=this._mercatorZfromZoom(this._maxZoom),A=Math.max(x-p,T);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const x=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,p));return o.ap(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!o.a6.quat.exactEquals(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];o.a6.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new vr;return l.position=new o.a5(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!o.a6.quat.length(r))return!1;o.a6.quat.normalize(r,r);const l=o.a6.vec3.transformQuat([],[0,0,-1],r),p=o.a6.vec3.transformQuat([],[0,-1,0],r);if(p[2]<0)return!1;const x=Hn(l,p);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;r[2]=o.ap(r[2],x/p,x/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new o.bN(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new o.P(0,0)),x=this.pointCoordinate(new o.P(this.width,0)),T=this.pointCoordinate(new o.P(this.width,this.height)),A=this.pointCoordinate(new o.P(0,this.height)),F=Math.floor(Math.min(p.x,x.x,T.x,A.x)),j=Math.floor(Math.max(p.x,x.x,T.x,A.x)),H=1;for(let q=F-H;q<=j+H;q++)q!==0&&l.push(new o.bN(q,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,p){let x=[];const T=p!==void 0,A=!T;if(A&&this.zoom<l||T&&p[0]===0&&p[1]===0)return x;const F=new Set,j=(q,Y,Q,ae,ge)=>{const _e=o.c2(Y,q,Q,ae,ge);F.has(_e)||(x.push(new o.aA(q,Y,Q,ae,ge)),F.add(_e))};for(let q=0;q<r.length;q++){const Y=r[q];if(A&&Y.canonical.z!==l)continue;const Q=Y.canonical,ae=Y.overscaledZ,ge=Y.wrap,_e=1<<Q.z,Te=Q.x+1<_e,we=Q.x>0,ze=Q.y+1<_e,Ue=Q.y>0,ke=Y.wrap-(we?0:1),He=Y.wrap+(Te?0:1),Ye=we?Q.x-1:_e-1,Ze=Te?Q.x+1:0;if(T)p[0]<0?(j(ae,He,Q.z,Ze,Q.y),p[1]<0&&ze&&(j(ae,ge,Q.z,Q.x,Q.y+1),j(ae,He,Q.z,Ze,Q.y+1)),p[1]>0&&Ue&&(j(ae,ge,Q.z,Q.x,Q.y-1),j(ae,He,Q.z,Ze,Q.y-1))):p[0]>0?(j(ae,ke,Q.z,Ye,Q.y),p[1]<0&&ze&&(j(ae,ge,Q.z,Q.x,Q.y+1),j(ae,ke,Q.z,Ye,Q.y+1)),p[1]>0&&Ue&&(j(ae,ge,Q.z,Q.x,Q.y-1),j(ae,ke,Q.z,Ye,Q.y-1))):p[1]<0&&ze?j(ae,ge,Q.z,Q.x,Q.y+1):Ue&&j(ae,ge,Q.z,Q.x,Q.y-1);else{const Qe=Y.visibleQuadrants;1&Qe&&(j(ae,ke,Q.z,Ye,Q.y),Ue&&(j(ae,ge,Q.z,Q.x,Q.y-1),j(ae,ke,Q.z,Ye,Q.y-1))),2&Qe&&(j(ae,He,Q.z,Ze,Q.y),Ue&&(j(ae,ge,Q.z,Q.x,Q.y-1),j(ae,He,Q.z,Ze,Q.y-1))),4&Qe&&(j(ae,ke,Q.z,Ye,Q.y),ze&&(j(ae,ge,Q.z,Q.x,Q.y+1),j(ae,ke,Q.z,Ye,Q.y+1))),8&Qe&&(j(ae,He,Q.z,Ze,Q.y),ze&&(j(ae,ge,Q.z,Q.x,Q.y+1),j(ae,He,Q.z,Ze,Q.y+1)))}}const H=[];for(const q of x)x.some(Y=>q.isChildOf(Y))||H.push(q);if(x=H.filter(q=>!r.some(Y=>!!(q.overscaledZ<l&&Y.isChildOf(q))||q.equals(Y)||q.isChildOf(Y))),A){const q=1<<l,Y=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=[q*Y.x,q*Y.y],ae=4,ge=ae*ae;x=x.filter(_e=>{const Te=_e.canonical.x+.5-Q[0],we=_e.canonical.y+.5-Q[1];return Te*Te+we*we<ge})}return x}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,x=this.elevation&&this.elevation.exaggeration(),T=x&&!r.isTerrainDEM,A=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const F=this.locationCoordinate(this.center),j=this.center.lat,H=1<<l,q=[H*F.x,H*F.y,0],Y=this.projection.name==="globe",Q=!Y,ae=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,Q),ge=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=H*o.bE(1,this.center.lat),Te=this._camera.position[2]/o.bE(1,this.center.lat),we=[H*ge.x,H*ge.y,Te*(Q?1:_e)],ze=Y||x,Ue=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),ke=this.isLODDisabled(!0)?l:0;let He;if(this._elevation&&r.isTerrainDEM)He=1e4*this._elevation.exaggeration();else if(this._elevation){const yt=this._elevation.getMinMaxForVisibleTiles();He=yt?yt.max:this._centerAltitude}else He=this._centerAltitude;const Ye=r.isTerrainDEM?-He:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ze=this.projection.isReprojectedInTileSpace?o.bP(this):1,Qe=yt=>{const jt=new o.a5(yt.x+25e-6,yt.y,yt.z),tn=new o.a5(yt.x,yt.y+25e-6,yt.z),rn=yt.toLngLat(),en=jt.toLngLat(),bn=tn.toLngLat(),er=this.locationCoordinate(rn),or=this.locationCoordinate(en),Nn=this.locationCoordinate(bn),ar=Math.hypot(or.x-er.x,or.y-er.y),On=Math.hypot(Nn.x-er.x,Nn.y-er.y);return Math.sqrt(ar*On)*Ze/25e-6},it=yt=>{const Qt=He,jt=Ye;return{aabb:o.bS(this,H,0,0,0,yt,jt,Qt,this.projection),zoom:0,x:0,y:0,minZ:jt,maxZ:Qt,wrap:yt,fullyVisible:!1}},ft=[];let st=[];const at=l,Rt=r.reparseOverscaled?p:l,$t=(Te-this._centerAltitude)*_e,sn=yt=>{if(!this._elevation||!yt.tileID||!A)return;const Qt=this._elevation.getMinMaxForTile(yt.tileID),jt=yt.aabb;Qt?(jt.min[2]=Qt.min,jt.max[2]=Qt.max,jt.center[2]=(jt.min[2]+jt.max[2])/2):(yt.shouldSplit=yn(yt),yt.shouldSplit||(jt.min[2]=jt.max[2]=jt.center[2]=this._centerAltitude))},_n=(yt,Qt)=>{if(.707*Qt<yt)return 1;const jt=Qt/yt;return jt/(1.4144271570014144+(Math.pow(1.1,jt-1.4144271570014144+1)-1)/(1.1-1)-1)},yn=yt=>{if(yt.zoom<ke)return!0;if(yt.zoom===at)return!1;if(yt.shouldSplit!=null)return yt.shouldSplit;const Qt=yt.aabb.distanceX(we),jt=yt.aabb.distanceY(we);let tn=$t,rn=1;if(Y){tn=yt.aabb.distanceZ(we);const On=Math.pow(2,yt.zoom),pr=o.aN((yt.y+1)/On),kr=o.aN(yt.y/On),si=Math.min(Math.max(j,pr),kr),Si=o.c6(si)/o.c6(j);if(rn=si===j?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Si/this._mercatorScaleRatio),this.zoom<=o.c3&&yt.zoom===at-1&&Si>=.9)return!0}else if(T&&(tn=yt.aabb.distanceZ(we)*_e),this.projection.isReprojectedInTileSpace&&p<=5){const On=Math.pow(2,yt.zoom),pr=Qe(new o.a5((yt.x+.5)/On,(yt.y+.5)/On));rn=pr>.85?1:pr}if(!A){const On=Math.sqrt(Qt*Qt+jt*jt+tn*tn);let pr=(1<<at-yt.zoom)*Ue*rn;return pr*=_n(Math.max(tn,$t),On),On<pr}let en=Number.MAX_VALUE,bn=0;const er=yt.aabb.getCorners(),or=[];for(const On of er){o.a6.vec3.sub(or,On,we),Y||(T?or[2]*=_e:or[2]=$t);const pr=o.a6.vec3.dot(or,this._camera.forward());pr<en&&(en=pr,bn=Math.abs(or[2]))}let Nn=(1<<at-yt.zoom)*Ue*rn;if(Nn*=_n(Math.max(bn,$t),en),en<Nn)return!0;const ar=yt.aabb.closestPoint(q);return ar[0]===q[0]&&ar[1]===q[1]};if(this.renderWorldCopies)for(let yt=1;yt<=3;yt++)ft.push(it(-yt)),ft.push(it(yt));for(ft.push(it(0));ft.length>0;){const yt=ft.pop(),Qt=yt.x,jt=yt.y;let tn=yt.fullyVisible;const rn=()=>this.projection.name==="globe"&&(yt.y===0||yt.y===(1<<yt.zoom)-1);if(!tn){let en=ze?yt.aabb.intersects(ae):yt.aabb.intersectsFlat(ae);if(en===0&&rn()){const bn=new o.bQ(yt.zoom,Qt,jt);en=o.bR(this,H,bn,!0).intersects(ae)}if(en===0)continue;tn=en===2}if(yt.zoom!==at&&yn(yt))for(let en=0;en<4;en++){const bn=(Qt<<1)+en%2,er=(jt<<1)+(en>>1),or={aabb:A?yt.aabb.quadrant(en):o.bS(this,H,yt.zoom+1,bn,er,yt.wrap,yt.minZ,yt.maxZ,this.projection),zoom:yt.zoom+1,x:bn,y:er,wrap:yt.wrap,fullyVisible:tn,tileID:void 0,shouldSplit:void 0,minZ:yt.minZ,maxZ:yt.maxZ};T&&!Y&&(or.tileID=new o.aA(yt.zoom+1===at?Rt:yt.zoom+1,yt.wrap,yt.zoom+1,bn,er),sn(or)),ft.push(or)}else{const en=yt.zoom===at?Rt:yt.zoom;if(r.minzoom&&r.minzoom>en)continue;let bn=0;if(!tn){let ar=ze?yt.aabb.intersectsPrecise(ae):yt.aabb.intersectsPreciseFlat(ae);if(ar===0&&rn()){const On=new o.bQ(yt.zoom,Qt,jt);ar=o.bR(this,H,On,!0).intersectsPrecise(ae)}if(ar===0)continue;if(r.calculateQuadrantVisibility)if(ae.containsPoint(yt.aabb.center))bn=15;else for(let On=0;On<4;On++)yt.aabb.quadrant(On).intersects(ae)!==0&&(bn|=1<<On)}const er=q[0]-(.5+Qt+(yt.wrap<<yt.zoom))*(1<<l-yt.zoom),or=q[1]-.5-jt,Nn=yt.tileID?yt.tileID:new o.aA(en,yt.wrap,yt.zoom,Qt,jt);r.calculateQuadrantVisibility&&(Nn.visibleQuadrants=bn),st.push({tileID:Nn,distanceSq:er*er+or*or})}}if(this.fogCullDistSq){const yt=this.fogCullDistSq,Qt=this.horizonLineFromTop();st=st.filter(jt=>{const tn=[0,0,0,1],rn=[o.ab,o.ab,0,1],en=this.calculateFogTileMatrix(jt.tileID.toUnwrapped());o.a6.vec4.transformMat4(tn,tn,en),o.a6.vec4.transformMat4(rn,rn,en);const bn=o.a6.vec4.min([],tn,rn),er=o.a6.vec4.max([],tn,rn),or=o.bT(bn,er);if(or===0)return!0;let Nn=!1;const ar=this._elevation;if(ar&&or>yt&&Qt!==0){const On=this.calculateProjMatrix(jt.tileID.toUnwrapped());let pr;r.isTerrainDEM||(pr=ar.getMinMaxForTile(jt.tileID)),pr||(pr={min:Ye,max:He});const kr=o.c4(this.rotation),si=[kr[0]*o.ab,kr[1]*o.ab,pr.max];o.a6.vec3.transformMat4(si,si,On),Nn=(1-si[1])*this.height*.5<Qt}return or<yt||Nn})}return st.sort((yt,Qt)=>yt.distanceSq-Qt.distanceSq).map(yt=>yt.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=o.ap(r.lat,-o.bU,o.bU),p=this.projection.project(r.lng,l);return new o.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.bE(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let p,x;const T=this.centerPoint;if(this.projection.name==="globe"){const F=this.worldSize;p=(l.x-T.x)/F,x=(l.y-T.y)/F}else{const F=this.pointCoordinate(l),j=this.pointCoordinate(T);p=F.x-j.x,x=F.y-j.y}const A=this.locationCoordinate(r);this.setLocation(new o.a5(A.x-p,A.y-x))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,l){const p=l?o.bE(l,r.lat):void 0,x=this.projection.project(r.lng,r.lat);return new o.a5(x.x,x.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l??this._centerAltitude,x=[r.x,r.y,0,1],T=[r.x,r.y,1,1];o.a6.vec4.transformMat4(x,x,this.pixelMatrixInverse),o.a6.vec4.transformMat4(T,T,this.pixelMatrixInverse);const A=T[3];o.a6.vec4.scale(x,x,1/x[3]),o.a6.vec4.scale(T,T,1/A);const F=x[2],j=T[2];return{p0:x,p1:T,t:F===j?0:(p-F)/(j-F)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return o.a6.vec4.transformMat4(l,l,this.pixelMatrixInverse),o.a6.vec4.transformMat4(p,p,this.pixelMatrixInverse),o.a6.vec4.scale(l,l,1/l[3]),o.a6.vec4.scale(p,p,1/p[3]),l[2]=o.bE(l[2],this._center.lat)*this.worldSize,p[2]=o.bE(p[2],this._center.lat)*this.worldSize,o.a6.vec4.scale(l,l,1/this.worldSize),o.a6.vec4.scale(p,p,1/this.worldSize),new o.aj([l[0],l[1],l[2]],o.a6.vec3.normalize([],o.a6.vec3.sub([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:x}=r,T=o.bE(l[2],this._center.lat),A=o.bE(p[2],this._center.lat);return new o.a5(o.aa(l[0],p[0],x)/this.worldSize,o.aa(l[1],p[1],x)/this.worldSize,o.aa(T,A,x))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let l=this.projection.pointCoordinate3D(this,r.x,r.y);if(l)return new o.a5(l[0],l[1],l[2]);let p=0,x=this.horizonLineFromTop();if(r.y>x)return this.pointCoordinate(r);const T=.02*x,A=r.clone();for(let F=0;F<10&&x-p>T;F++){A.y=o.aa(p,x,.66);const j=this.projection.pointCoordinate3D(this,A.x,A.y);j?(x=A.y,l=j):p=A.y}return l?new o.a5(l[0],l[1],l[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=o.bV)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,x=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return o.a6.vec4.transformMat4(x,x,this.pixelMatrix),x[3]>0?new o.P(x[0]/x[3],x[1]/x[3]):new o.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,T=this.pointLocation3D(new o.P(l,r)),A=this.pointLocation3D(new o.P(x,r)),F=this.pointLocation3D(new o.P(x,p)),j=this.pointLocation3D(new o.P(l,p));let H=Math.min(T.lng,A.lng,F.lng,j.lng),q=Math.max(T.lng,A.lng,F.lng,j.lng),Y=Math.min(T.lat,A.lat,F.lat,j.lat),Q=Math.max(T.lat,A.lat,F.lat,j.lat);const ae=Math.pow(2,-this.zoom)/16*270,ge=this.projection.name==="globe"?1:4,_e=(Te,we,ze,Ue,ke)=>{const He=(Te+ze)/2,Ye=(we+Ue)/2,Ze=new o.P(He,Ye),{lng:Qe,lat:it}=this.pointLocation3D(Ze),ft=Math.max(0,H-Qe,Y-it,Qe-q,it-Q);H=Math.min(H,Qe),q=Math.max(q,Qe),Y=Math.min(Y,it),Q=Math.max(Q,it),(ke<ge||ft>ae)&&(_e(Te,we,He,Ye,ke+1),_e(He,Ye,ze,Ue,ke+1))};if(_e(l,r,x,r,1),_e(x,r,x,p,1),_e(x,p,l,p,1),_e(l,p,l,r,1),this.projection.name==="globe"){const[Te,we]=o.bW(this);Te?(Q=90,q=180,H=-180):we&&(Y=-90,q=180,H=-180)}return new o.as(new o.bL(H,Y),new o.bL(q,Q))}_getBoundsRectangular(r,l){const{top:p,left:x}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,A=this.width-this._edgeInsets.right,F=new o.P(x,p),j=new o.P(A,p),H=new o.P(A,T),q=new o.P(x,T);let Y=this.pointCoordinate(F,r),Q=this.pointCoordinate(j,r);const ae=this.pointCoordinate(H,l),ge=this.pointCoordinate(q,l),_e=(Te,we)=>(we.y-Te.y)/(we.x-Te.x);return Y.y>1&&Q.y>=0?Y=new o.a5((1-ge.y)/_e(ge,Y)+ge.x,1):Y.y<0&&Q.y<=1&&(Y=new o.a5(-ge.y/_e(ge,Y)+ge.x,0)),Q.y>1&&Y.y>=0?Q=new o.a5((1-ae.y)/_e(ae,Q)+ae.x,1):Q.y<0&&Y.y<=1&&(Q=new o.a5(-ae.y/_e(ae,Q)+ae.x,0)),new o.as().extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(ge)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((p,x)=>{if(x.dem){const T=x.dem.tree;p.min=Math.min(p.min,T.minimums[0]),p.max=Math.max(p.max,T.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-o.bU,this.maxLat=o.bU,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.am(this.minLng)*this.tileSize,this.worldMaxX=o.am(this.maxLng)*this.tileSize,this.worldMinY=o.at(this.maxLat)*this.tileSize,this.worldMaxY=o.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const x=r.canonical,T=1/this.height,A=this.cameraWorldSize,F=A/this.zoomScale(x.z),j=(x.x+Math.pow(2,x.z)*r.wrap)*F,H=x.y*F,q=this.point;q.x*=A/this.worldSize,q.y*=A/this.worldSize;const Y=this.angle,Q=Math.sin(-Y),ae=-Math.cos(-Y);return p[l]={bearing:[Q,ae],center:[(q.x-j)*T,(q.y-H)*T],scale:F/o.ab*T},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return o.a6.mat4.multiply(x,this.worldToFogMatrix,x),p[l]=new Float32Array(x),p[l]}calculateProjMatrix(r,l=!1,p=!1){const x=r.key;let T;if(T=p?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,T[x])return T[x];const A=this.calculatePosMatrix(r,this.worldSize);let F;return F=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,o.a6.mat4.multiply(A,F,A),T[x]=new Float32Array(A),T[x]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const x=o.bX(r,this);return p[l]=x,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=o.a6.mat4.fromScaling([],[r,r,r]);return o.a6.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=o.bE(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),x=this._camera.forward(),T=o.bE(1,this._center.lat);p[2]/=T,x[2]/=T,o.a6.vec3.normalize(x,x);const A=r.raycast(p,x,r.exaggeration());if(A){const F=o.a6.vec3.scaleAndAdd([],p,x,A),j=new o.a5(F[0],F[1],o.bE(F[2],o.aN(F[1]))),H=(j.z+o.a6.vec3.length([j.x-p[0],j.y-p[1],j.z-p[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=j.toAltitude(),this._center=this.coordinateLocation(j),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,p=o.bE(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(p),T=l.getAtPointOrZero(new o.a5(...x)),A=this.pixelsPerMeter/this.worldSize*T,F=this._minimumHeightOverTerrain(),j=x[2]-A;if(j<=F)if(j<0||r){const H=this.locationCoordinate(this._center,this._centerAltitude),q=[x[0],x[1],H.z-x[2]],Y=o.a6.vec3.length(q);q[2]-=(F-j)/this._pixelsPerMercatorPixel;const Q=o.a6.vec3.length(q);if(Q===0)return;o.a6.vec3.scale(q,q,Y/Q*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],H.z*this._pixelsPerMercatorPixel-q[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const Q=this.center;return Q.lat=o.ap(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(Q.lng=o.ap(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:x}=this.point;let T=0,A=p,F=x;const j=this.width/2,H=this.height/2,q=this.worldMinY*this.scale,Y=this.worldMaxY*this.scale;if(x-H<q&&(F=q+H),x+H>Y&&(F=Y-H),Y-q<this.height&&(T=Math.max(T,this.height/(Y-q)),F=(Y+q)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ge=this.worldSize/2-(Q+ae)/2;A=(p+ge+this.worldSize)%this.worldSize-ge,A-j<Q&&(A=Q+j),A+j>ae&&(A=ae-j),ae-Q<this.width&&(T=Math.max(T,this.width/(ae-Q)),A=(ae+Q)/2)}A===p&&F===x||(this.center=this.unproject(new o.P(A,F))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.bE(1,this.center.lat)/o.bE(1,o.c5));const x=o.bY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?p:1,A=this._camera.getWorldToCamera(this.worldSize,T);let F;const j=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(j[8]=2*-r.x/this.width,j[9]=2*r.y/this.height,this.isOrthographic){let it=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ft=it*this.aspect,st=-ft,at=-it;ft-=r.x,st-=r.x,it+=r.y,at+=r.y,F=this._camera.getCameraToClipOrthographic(st,ft,at,it,this._nearZ,this._farZ),((Rt,$t,sn,_n)=>{for(let yn=0;yn<16;yn++)Rt[yn]=ha($t[yn],sn[yn],_n)})(F,F,j,jo(this.pitch>=15?1:this.pitch/15))}else F=j;const H=o.a6.mat4.mul([],j,A);let q=o.a6.mat4.mul([],F,A);if(this.projection.isReprojectedInTileSpace){const it=this.locationCoordinate(this.center),ft=o.a6.mat4.identity([]);o.a6.mat4.translate(ft,ft,[it.x*this.worldSize,it.y*this.worldSize,0]),o.a6.mat4.multiply(ft,ft,o.bZ(this)),o.a6.mat4.translate(ft,ft,[-it.x*this.worldSize,-it.y*this.worldSize,0]),o.a6.mat4.multiply(q,q,ft),o.a6.mat4.multiply(H,H,ft),this.inverseAdjustmentMatrix=o.b_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=o.a6.mat4.scale([],q,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=q,this.invProjMatrix=o.a6.mat4.invert(new Float64Array(16),this.projMatrix),l){const it=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);it[8]=2*-r.x/this.width,it[9]=2*r.y/this.height,this.expandedFarZProjMatrix=o.a6.mat4.mul([],it,A)}else this.expandedFarZProjMatrix=this.projMatrix;const Y=o.a6.mat4.invert([],F);this.frustumCorners=o.b$.fromInvProjectionMatrix(Y,this.horizonLineFromTop(),this.height),this.cameraFrustum=o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const Q=new Float32Array(16);o.a6.mat4.identity(Q),o.a6.mat4.scale(Q,Q,[1,-1,1]),o.a6.mat4.rotateX(Q,Q,this._pitch),o.a6.mat4.rotateZ(Q,Q,this.angle);const ae=o.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=o.a6.mat4.clone(ae);const ge=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-r.x/this.width,ae[9]=2*(r.y+ge)/this.height,this.skyboxMatrix=o.a6.mat4.multiply(Q,ae,Q);const _e=this.point,Te=_e.x,we=_e.y,ze=this.width%2/2,Ue=this.height%2/2,ke=Math.cos(this.angle),He=Math.sin(this.angle),Ye=Te-Math.round(Te)+ke*ze+He*Ue,Ze=we-Math.round(we)+ke*Ue+He*ze,Qe=new Float64Array(q);if(o.a6.mat4.translate(Qe,Qe,[Ye>.5?Ye-1:Ye,Ze>.5?Ze-1:Ze,0]),this.alignedProjMatrix=Qe,q=o.a6.mat4.create(),o.a6.mat4.scale(q,q,[this.width/2,-this.height/2,1]),o.a6.mat4.translate(q,q,[1,-1,0]),this.labelPlaneMatrix=q,q=o.a6.mat4.create(),o.a6.mat4.scale(q,q,[1,-1,1]),o.a6.mat4.translate(q,q,[-1,-1,0]),o.a6.mat4.scale(q,q,[2/this.width,2/this.height,1]),this.glCoordMatrix=q,this.pixelMatrix=o.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,H),this._calcFogMatrices(),this._distanceTileDataCache={},q=o.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!q)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=q,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.c0(this);const it=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.a6.vec3.transformMat4(it,it,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=q;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,p=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,T=[r,r,l];o.a6.vec3.scale(T,T,x),o.a6.vec3.scale(p,p,-1),o.a6.vec3.multiply(p,p,T);const A=o.a6.mat4.create();o.a6.mat4.translate(A,A,p),o.a6.mat4.scale(A,A,T),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,x)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),x=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-p[0]*T,x.y/this.worldSize-p[1]*T,r/this.worldSize*this._centerAltitude-p[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],x=r[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(T=Math.min((l-p)/x,1)),this._camera.position=o.a6.vec3.scaleAndAdd([],this._camera.position,r,T),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:x}=this._camera.getPitchBearing(),T=o.bE(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.bC(this._maxPitch)),F=Math.max((r[2]-T)/Math.cos(p),A),j=this._zoomFromMercatorZ(F);o.a6.vec3.scaleAndAdd(r,r,l,F),this._pitch=o.ap(p,o.bC(this.minPitch),o.bC(this.maxPitch)),this.angle=o.bB(x,-Math.PI,Math.PI),this._setZoom(o.ap(j,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.a5(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,p=o.bV,x=0,T=1/0;for(;p-l>1e-6&&p>l;){const A=l+.5*(p-l),F=this.tileSize*Math.pow(2,A),j=this.getCameraToCenterDistance(this.projection,A,F),H=this.scaleZoom(j/(r*this.tileSize)),q=Math.abs(A-H);q<T&&(T=q,x=A),A<H?l=A:p=A}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),x=Math.max(r.x,l.x),T=Math.min(r.y,l.y),A=Math.max(r.y,l.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const F=[new o.P(p,T),new o.P(x,A),new o.P(p,A),new o.P(x,T)],j=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const q of F){const Y=this.pointRayIntersection(q);if(Y.t<0)return!0;const Q=this.rayIntersectionCoordinate(Y);if(Q.x<j||Q.y<0||Q.x>H||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.c1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.P(0,0),new o.P(this.width,this.height))}zoomDeltaToMovement(r,l){const p=o.a6.vec3.length(o.a6.vec3.sub([],this._camera.position,r)),x=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,p,x],T){const A=[l,p,x,1];o.a6.vec4.transformMat4(A,A,T);const F=A[3]=Math.max(A[3],1e-6);return A[0]/=F,A[1]/=F,A[2]/=F,A}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,p=this.worldSize){const x=o.bY(r,l,this.width,this.height,1024),T=r.pixelSpaceConversion(this.center.lat,p,x);let A=.5/Math.tan(.5*this._fov)*this.height*T;return this.isOrthographic&&(A=ha(1,A,jo(this.pitch>=15?1:this.pitch/15))),A}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.a6.mat4.multiply(r,r,this.globeMatrix),r}getFrustum(r){return o.bO.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const Oa=(d,r)=>{if(r>0&&d.terrain&&o.w("Cutoff is currently disabled on terrain"),r<=0||d.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=d.transform,p=Math.max(Math.abs(l._zoom-(d.minCutoffZoom-1)),1),x=l.isLODDisabled(!1)?o.a7(60,45,l.pitch):o.a7(30,15,l.pitch),T=l._farZ-l._nearZ,A=r*l.height,F=((1-(j=x))*l.cameraToCenterDistance+j*(l._farZ+A))*p;var j;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(F-l._nearZ)/T,(F-A-l._nearZ)/T]}}},Ji={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class cs{constructor(r,l){this.aabb=r,this.lastCascade=l}}class En{add(r,l){const p=this.receivers[r.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],l.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],l.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],l.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],l.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],l.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],l.max[2])):this.receivers[r.key]=new cs(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,p){const x=o.ca.fromPoints(r.points);let T=0;for(const A in this.receivers){const F=this.receivers[A];if(!F||!x.intersectsAabb(F.aabb))continue;F.aabb.min=x.closestPoint(F.aabb.min),F.aabb.max=x.closestPoint(F.aabb.max);const j=F.aabb.getCorners();for(let H=0;H<p.length;H++){let q=!0;for(const Y of j){const Q=[Y[0]*l,Y[1]*l,Y[2]];if(o.a6.vec3.transformMat4(Q,Q,p[H].matrix),Q[0]<-1||Q[0]>1||Q[1]<-1||Q[1]>1){q=!1;break}}if(F.lastCascade=H,T=Math.max(T,H),q)break}}return T+1}}class Ul{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new En,this._depthMode=new ir(r.context.gl.LEQUAL,ir.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(Ji,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Ji,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(Ji,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const x=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||x<=0||(this._shadowLayerCount=p.style.order.reduce((ge,_e)=>{const Te=p.style._mergedLayers[_e];return ge+(Te.hasShadowPass()&&!Te.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const T=p.context,A=Ji.shadowMapResolution,F=Ji.shadowMapResolution;if(this._cascades.length===0||Ji.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ge=0;ge<Ji.cascadeCount;++ge){const _e=p._shadowMapDebug,Te=T.gl,we=T.createFramebuffer(A,F,_e,"texture"),ze=new o.T(T,{width:A,height:F,data:null},Te.DEPTH_COMPONENT16);if(we.depthAttachment.set(ze.texture),_e){const Ue=new o.T(T,{width:A,height:F,data:null},Te.RGBA8);we.colorAttachment.set(Ue.texture)}this._cascades.push({framebuffer:we,texture:ze,matrix:[],far:0,boundingSphereRadius:0,frustum:new o.bO,scale:0})}}this.shadowDirection=Qc(l);let j=0;if(r.elevation){const ge=r.elevation,_e=[1e4,-1e4];ge.visibleDemTiles.filter(Te=>Te.dem).forEach(Te=>{const we=Te.dem.tree;_e[0]=Math.min(_e[0],we.minimums[0]),_e[1]=Math.max(_e[1],we.maximums[0])}),_e[0]!==1e4&&(j=(_e[1]-_e[0])*ge.exaggeration())}const H=1.5*r.cameraToCenterDistance,q=3*H,Y=new Float64Array(16);for(let ge=0;ge<this._cascades.length;++ge){const _e=this._cascades[ge];let Te=r.height/50,we=1;Ji.cascadeCount===1?we=q:ge===0?we=H:(Te=H,we=q);const[ze,Ue]=hu(r,this.shadowDirection,Te,we,Ji.shadowMapResolution,j);_e.scale=r.scale,_e.matrix=ze,_e.boundingSphereRadius=Ue,o.a6.mat4.invert(Y,_e.matrix),_e.frustum=o.bO.fromInvProjectionMatrix(Y,1,0,!0),_e.far=we}const Q=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Q].far,this._cascades[Q].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ji.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ji.shadowMapResolution,this._uniformValues.u_shadowmap_0=Or.ShadowMap0,this._uniformValues.u_shadowmap_1=Or.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ae=p.transform.elevation;for(const ge of this._groundShadowTiles){let _e={min:0,max:0};if(ae){const Te=ae.getMinMaxForTile(ge);Te&&(_e=Te)}this.addShadowReceiver(ge.toUnwrapped(),_e.min,_e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const p=this.painter,x=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),x.viewport.set([0,0,Ji.shadowMapResolution,Ji.shadowMapResolution]);for(let T=0;T<this._numCascadesToRender;++T){p.currentShadowCascade=T,x.bindFramebuffer.set(this._cascades[T].framebuffer.framebuffer),x.clear({color:o.bA.white,depth:1});for(const A of r.order){const F=r._mergedLayers[A];if(!F.hasShadowPass()||F.isHidden(p.transform.zoom))continue;const j=r.getLayerSourceCache(F),H=j?l[j.id]:void 0;(F.type==="model"||H&&H.length)&&p.renderLayer(p,j,F,H)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,p=r.context,x=l.directionalLight,T=l.ambientLight;if(!x||!T)return;const A=[],F=Oa(r,r.longestCutoffRange);F.shouldRenderCutoff&&A.push("RENDER_CUTOFF"),A.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&A.push("NORMAL_OFFSET");const j=zu(l,x,T),H=new ir(p.gl.LEQUAL,ir.ReadOnly,r.depthRangeFor3D);for(const q of this._groundShadowTiles){const Y=q.toUnwrapped(),Q=r.isTileAffectedByFog(q),ae=r.getOrCreateProgram("groundShadow",{defines:A,overrideFog:Q});this.setupShadows(Y,ae),r.uploadCommonUniforms(p,ae,Y,null,F);const ge={u_matrix:r.transform.calculateProjMatrix(Y),u_ground_shadow_factor:j};ae.draw(r,p.gl.TRIANGLES,H,Pe.disabled,Sr.multiply,Mt.disabled,ge,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Sr.unblended:Sr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,p=l.calculatePosMatrix(r,l.worldSize);return o.a6.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(r){return o.a6.mat4.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,p,x=0){if(!this.enabled)return;const T=this.painter.transform,A=this.painter.context,F=A.gl,j=this._uniformValues,H=new Float64Array(16),q=T.calculatePosMatrix(r,T.worldSize);for(let Y=0;Y<this._cascades.length;Y++)o.a6.mat4.multiply(H,this._cascades[Y].matrix,q),j[Y===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(H),A.activeTexture.set(F.TEXTURE0+Or.ShadowMap0+Y),this._cascades[Y].texture.bind(F.NEAREST,F.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const Y=o.c9(r.canonical),Q=2/T.tileSize*o.ab/Ji.shadowMapResolution,ae=Q*this._cascades[0].boundingSphereRadius,ge=Q*this._cascades[this._cascades.length-1].boundingSphereRadius,_e=(p==="vector-tile"?1:3)/Math.pow(2,x-r.canonical.z-(1-T.zoom+Math.floor(T.zoom)));j.u_shadow_normal_offset=[Y,ae*_e,ge*_e],j.u_shadow_bias=[6e-5,.0012,.012]}else j.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(A,j)}setupShadowsFromMatrix(r,l,p=!1){if(!this.enabled)return;const x=this.painter.context,T=x.gl,A=this._uniformValues,F=new Float64Array(16);for(let j=0;j<Ji.cascadeCount;j++)o.a6.mat4.multiply(F,this._cascades[j].matrix,r),A[j===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(F),x.activeTexture.set(T.TEXTURE0+Or.ShadowMap0+j),this._cascades[j].texture.bind(T.NEAREST,T.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const j=Ji.normalOffset;A.u_shadow_normal_offset=[1,j,j],A.u_shadow_bias=[6e-5,.0012,.012]}else A.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(x,A)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,p,x){if(x[2]>=0)return{};const T=function(j,H,q){const Y=q/(1<<j.canonical.z);return new o.ca([j.canonical.x*Y+j.wrap*q,j.canonical.y*Y+j.wrap*q,0],[(j.canonical.x+1)*Y+j.wrap*q,(j.canonical.y+1)*Y+j.wrap*q,H])}(r,l,p).getCorners(),A=l/-x[2];x[0]<0?(o.a6.vec3.add(T[0],T[0],[x[0]*A,0,0]),o.a6.vec3.add(T[3],T[3],[x[0]*A,0,0])):x[0]>0&&(o.a6.vec3.add(T[1],T[1],[x[0]*A,0,0]),o.a6.vec3.add(T[2],T[2],[x[0]*A,0,0])),x[1]<0?(o.a6.vec3.add(T[0],T[0],[0,x[1]*A,0]),o.a6.vec3.add(T[1],T[1],[0,x[1]*A,0])):x[1]>0&&(o.a6.vec3.add(T[2],T[2],[0,x[1]*A,0]),o.a6.vec3.add(T[3],T[3],[0,x[1]*A,0]));const F={};return F.vertices=T,F.planes=[Vl(T[1],T[0],T[4]),Vl(T[2],T[1],T[5]),Vl(T[3],T[2],T[6]),Vl(T[0],T[3],T[7])],F}addShadowReceiver(r,l,p){this._receivers.add(r,o.ca.fromTileIdAndHeight(r,l,p))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function Vl(d,r,l){const p=o.a6.vec3.sub([],l,r),x=o.a6.vec3.sub([],d,r),T=o.a6.vec3.cross([],p,x),A=o.a6.vec3.length(T);return A===0?[0,0,1,0]:(o.a6.vec3.scale(T,T,1/A),[T[0],T[1],T[2],-o.a6.vec3.dot(T,r)])}function Qc(d){const r=d.properties.get("direction"),l=o.c8(r.x,r.y,r.z);l[2]=o.ap(l[2],0,75);const p=o.cb([l[0],l[1],l[2]]);return o.a6.vec3.fromValues(p.x,p.y,p.z)}function zu(d,r,l){const p=r.properties.get("color"),x=r.properties.get("intensity"),T=r.properties.get("direction"),A=[T.x,T.y,T.z],F=l.properties.get("color"),j=l.properties.get("intensity"),H=Math.max(o.a6.vec3.dot([0,0,1],A),0),q=[0,0,0];o.a6.vec3.scale(q,F.toRenderColor(d.getLut(r.scope)).toArray01Linear().slice(0,3),j);const Y=[0,0,0];return o.a6.vec3.scale(Y,p.toRenderColor(d.getLut(l.scope)).toArray01Linear().slice(0,3),H*x),o.cc([q[0]>0?q[0]/(q[0]+Y[0]):0,q[1]>0?q[1]/(q[1]+Y[1]):0,q[2]>0?q[2]/(q[2]+Y[2]):0])}function hu(d,r,l,p,x,T){const A=d.zoom,F=d.scale,j=d.worldSize,H=1/j,q=d.aspect,Y=Math.sqrt(1+q*q)*Math.tan(.5*d.fovX),Q=Y*Y,ae=p-l,ge=p+l;let _e,Te;Q>ae/ge?(_e=p,Te=p*Y):(_e=.5*ge*(1+Q),Te=.5*Math.sqrt(ae*ae+2*(p*p+l*l)*Q+ge*ge*Q*Q));const we=d.projection.pixelsPerMeter(d.center.lat,j),ze=d._camera.getCameraToWorldMercator(),Ue=[0,0,-_e*H];o.a6.vec3.transformMat4(Ue,Ue,ze);let ke=Te*H;const He=d._edgeInsets;if(!(He.left===0&&He.top===0&&He.right===0&&He.bottom===0||He.left===He.right&&He.top===He.bottom)){const tn=d._camera.getWorldToCamera(d.worldSize,d.projection.zAxisUnit==="meters"?we:1),rn=d._camera.getCameraToClipPerspective(d._fov,d.width/d.height,l,p);rn[8]=2*-d.centerOffset.x/d.width,rn[9]=2*d.centerOffset.y/d.height;const en=new Float64Array(16);o.a6.mat4.mul(en,rn,tn);const bn=new Float64Array(16);o.a6.mat4.invert(bn,en);const er=o.bO.fromInvProjectionMatrix(bn,j,A,!0);for(const or of er.points){const Nn=((Ye=or)[0]/=F,Ye[1]/=F,Ye[2]=o.bE(Ye[2],d._center.lat),Ye);ke=Math.max(ke,o.a6.vec3.len(o.a6.vec3.subtract([],Ue,Nn)))}}var Ye;ke*=x/(x-1);const Ze=Math.acos(r[2]),Qe=Math.atan2(-r[0],-r[1]),it=new Yr;it.position=Ue,it.setPitchBearing(Ze,Qe);const ft=it.getWorldToCamera(j,we),st=ke*j,at=Math.min(d._mercatorZfromZoom(17)*j*-2,-2*st),Rt=it.getCameraToClipOrthographic(-st,st,-st,st,at,(st+T*we)/r[2]),$t=new Float64Array(16);o.a6.mat4.multiply($t,Rt,ft);const sn=o.a6.vec3.fromValues(Math.floor(1e6*Ue[0])/1e6*j,Math.floor(1e6*Ue[1])/1e6*j,0),_n=.5*x,yn=[0,0,0];o.a6.vec3.transformMat4(yn,sn,$t),o.a6.vec3.scale(yn,yn,_n);const yt=[Math.floor(yn[0]),Math.floor(yn[1]),Math.floor(yn[2])],Qt=[0,0,0];o.a6.vec3.sub(Qt,yn,yt),o.a6.vec3.scale(Qt,Qt,-1/_n);const jt=new Float64Array(16);return o.a6.mat4.identity(jt),o.a6.mat4.translate(jt,jt,Qt),o.a6.mat4.multiply($t,jt,$t),[$t,st]}class fa extends o.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,l){return o.aG(this.requestManager.transformRequest(l,o.R.Model).url).then(p=>{if(!p)return;const x=o.aH(p),T=new o.aI(r,void 0,void 0,x);return T.computeBoundsAndApplyParent(),T}).catch(p=>{if(p&&p.status===404)return null;this.fire(new o.t(new Error(`Could not load model ${r} from ${l}: ${p.message}`)))})}load(r,l){this.models[l]||(this.models[l]={});const p=Object.keys(r);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+p.length;const x=[];for(const T of p)x.push(this.loadModel(T,r[T]));Promise.allSettled(x).then(T=>{for(let A=0;A<T.length;A++){const{status:F,value:j}=T[A];F==="fulfilled"&&j&&(this.models[l][p[A]]={model:j,numReferences:1})}this.numModelsLoading[l]-=p.length,this.fire(new o.x("data",{dataType:"style"}))}).catch(T=>{this.fire(new o.t(new Error(`Could not load models: ${T.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l){return!!this.getModel(r,l)}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}addModel(r,l,p){this.models[p]||(this.models[p]={}),this.hasModel(r,p)&&this.models[p][r].numReferences++,this.load({[r]:this.requestManager.normalizeModelURL(l)},p)}addModels(r,l){this.models[l]||(this.models[l]={});const p={};for(const x in r)this.models[l][x]={},p[x]=this.requestManager.normalizeModelURL(r[x]);this.load(p,l)}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={});const p={};for(const x of r)this.hasModel(x,l)?this.models[l][x].numReferences++:p[x]=this.requestManager.normalizeModelURL(x);this.load(p,l)}removeModel(r,l){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const p=this.models[l][r].model;delete this.models[l][r],p.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const p in this.models[l])this.models[l][p].model&&this.models[l][p].model.upload(r.context)}}const ff=new o.a0({data:new o.a1(o._.colorTheme.data)}),da=(d,r)=>xe(d,r&&r.filter(l=>l.identifier!=="source.canvas")),zh=o.ar(wr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),hs=o.ar(wr,["setCenter","setZoom","setBearing","setPitch"]),Fu={version:8,layers:[],sources:{}},eh={duration:300,delay:0};class ns extends o.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=o.l({},eh),this._buildingIndex=new Ri(this),this.crossTileSymbolIndex=new Du,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._mergedLayerSelectors=new Map,this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Dr,this.dispatcher=l.dispatcher?l.dispatcher:new o.ce(o.cf(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Mr,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new o.cg(r._requestManager,l.localFontFamily?o.ch.all:l.localIdeographFontFamily?o.ch.ideographs:o.ch.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new fa(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",o.ci());const p=this;this._rtlTextPluginCallback=ns.registerForPluginStateChange(x=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(T,A)=>{if(o.cj(T),A&&A.every(F=>F))for(const F in p._sourceCaches){const j=p._sourceCaches[F],H=j.getSource().type;H!=="vector"&&H!=="geojson"||j.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const T=this.getOwnSource(x.sourceId);if(T&&T.vectorLayerIds)for(const A in this._layers){const F=this._layers[A];F.source===T.id&&this._validateLayer(F)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(o.f(r))return r;const l=o.ck(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${o.cl(JSON.stringify(r))}`}_diffStyle(r,l,p){this.globalId=this._getGlobalId(r);const x=(T,A)=>{try{A(null,this.setState(T,p))}catch(F){A(F,!1)}};if(typeof r=="string"){const T=this.map._requestManager.normalizeStyleURL(r),A=this.map._requestManager.transformRequest(T,o.R.Style);o.n(A,(F,j)=>{F?this.fire(new o.t(F)):j&&x(j,l)})}else typeof r=="object"&&x(r,l)}loadURL(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!o.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const x=this.importsCache.get(r);if(x)return this._load(x,p);const T=this.map._requestManager.transformRequest(r,o.R.Style);this._request=o.n(T,(A,F)=>{if(this._request=null,A)this.fire(new o.t(A));else if(F)return this.importsCache.set(r,F),this._load(F,p)})}loadJSON(r,l={}){this.fire(new o.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=o.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new o.x("dataloading",{dataType:"style"})),this._load(Fu,!1)}_loadImports(r,l,p){if(this.importDepth>=4)return o.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const T of r){const A=this._createFragmentStyle(T),F=new Promise(q=>{A.once("style.import.load",q),A.once("error",q)}).then(()=>this.mergeAll());if(x.push(F),this.resolvedImports.has(T.url)){A.loadEmpty();continue}const j=T.data||this.importsCache.get(T.url);j?(A.loadJSON(j,{validate:l}),this._isInternalStyle(j)&&(A.globalId=null)):T.url?A.loadURL(T.url,{validate:l}):A.loadEmpty();const H={style:A,id:T.id,config:T.config};if(p){const q=this.fragments.findIndex(({id:Y})=>Y===p);this.fragments=this.fragments.slice(0,q).concat(H).concat(this.fragments.slice(q))}else this.fragments.push(H)}return Promise.allSettled(x)}getImportGlobalIds(r=this,l=new Set){for(const p of r.fragments)p.style.globalId&&l.add(p.style.globalId),this.getImportGlobalIds(p.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?o.av(r.id,this.scope):r.id;let p;const x=this._initialConfig&&this._initialConfig[l];(r.config||x)&&(p=o.l({},r.config,x));const T=new ns(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,configDependentLayers:this._configDependentLayers});return T.setEventedParent(this.map,{style:T}),T}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const p=r.schema;if(this._isInternalStyle(r)){const A=o.l({},Fu,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(A,l)}if(this.updateConfig(this._config,p),l&&da(this,Di(r)))return;this._loaded=!0,this.stylesheet=o.cm(r);const x=()=>{for(const H in r.sources)this.addSource(H,r.sources[H],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const A=To(this.stylesheet.layers);if(this._order=A.map(H=>H.id),this.stylesheet.light&&o.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const H=this.stylesheet.lights[0];this.light=new Ae(H.properties,H.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ae(this.stylesheet.light)),this._layers={};for(const H of A){const q=o.cq(H,this.scope,this._styleColorTheme.lut,this.options);q.configDependencies.size!==0&&this._configDependentLayers.add(q.fqid),q.setEventedParent(this,{layer:{id:q.id}}),this._layers[q.id]=q;const Y=this.getOwnLayerSourceCache(q),Q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Y&&q.canCastShadows()&&Q&&(Y.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const F=this.stylesheet.terrain;F&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(F,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new o.x("data",{dataType:"style"}));const j=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new o.x(j?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new o.x(j?"style.load":"style.import.load")))},T=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=T,T){const A=this._evaluateColorThemeData(T);this._loadColorTheme(A).then(()=>{x()}).catch(F=>{o.w(`Couldn't load color theme from the stylesheet: ${F}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,p,x,T,A,F,j;const H={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(q=>{if(q.stylesheet){if(q.light!=null&&(r=q.light),q.stylesheet.lights)for(const Y of q.stylesheet.lights)Y.type==="ambient"&&q.ambientLight!=null&&(l=q.ambientLight),Y.type==="directional"&&q.directionalLight!=null&&(p=q.directionalLight);x=this._prioritizeTerrain(x,q.terrain,q.stylesheet.terrain),q.stylesheet.fog&&q.fog!=null&&(T=q.fog),q.stylesheet.camera!=null&&(j=q.stylesheet.camera),q.stylesheet.projection!=null&&(A=q.stylesheet.projection),q.stylesheet.transition!=null&&(F=q.stylesheet.transition),H[q.scope]=q._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=p,this.fog=T,this._styleColorThemeForScope=H,x===null?delete this.terrain:this.terrain=x,this.camera=j||{"camera-projection":"perspective"},this.projection=A||{name:"mercator"},this.transition=o.l({},eh,F),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=p=>{for(const x of p.fragments)l(x.style);r(p)};l(this)}_prioritizeTerrain(r,l,p){const x=r&&r.drapeRenderMode===0;return p===null?l&&l.drapeRenderMode===0?l:x?r:null:l!=null&&(!r||x||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},p={};this.forEachFragmentStyle(x=>{for(const T in x._sourceCaches){const A=o.av(T,x.scope);r[A]=x._sourceCaches[T]}for(const T in x._otherSourceCaches){const A=o.av(T,x.scope);l[A]=x._otherSourceCaches[T]}for(const T in x._symbolSourceCaches){const A=o.av(T,x.scope);p[A]=x._symbolSourceCaches[T]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=p}mergeLayers(){const r={},l=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._mergedLayerSelectors.clear(),this.forEachFragmentStyle(T=>{for(const F of T._order){const j=T._layers[F];if(j.type==="slot"){const H=o.cn(F);if(r[H])continue;r[H]=[]}j.slot&&r[j.slot]?r[j.slot].push(j):l.push(j)}const{featuresets:A}=T.stylesheet||{};if(A)for(const F in A){const{selectors:j}=A[F];for(const H of j){const q=T._layers[H.layer],Y=this._mergedLayerSelectors.get(q.fqid)||[];let Q;if(H.properties)for(const ae in H.properties){const ge=o.M(H.properties[ae]);ge.result==="success"&&(Q=Q||{},Q[ae]=ge.value)}Y.push({featuresetId:F,featureNamespace:H.featureNamespace,properties:Q}),this._mergedLayerSelectors.set(q.fqid,Y)}}}),this._mergedOrder=[];const x=(T=[])=>{for(const A of T)if(A.type==="slot"){const F=o.cn(A.id);r[F]&&x(r[F]),this._mergedSlots.push(F)}else{const F=o.av(A.id,A.scope);this._mergedOrder.push(F),p[F]=A,A.is3D()&&(this._has3DLayers=!0),A.type==="circle"&&(this._hasCircleLayers=!0),A.type==="symbol"&&(this._hasSymbolLayers=!0),A.type==="clip"&&(this._clipLayerPresent=!0)}};x(l),this._mergedOrder.sort((T,A)=>{const F=p[T],j=p[A];return F.hasInitialOcclusionOpacityProperties?j.is3D()?1:0:F.is3D()&&j.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=o.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,p,x){const T=o.l({},p);for(const F of Object.keys(o._.colorTheme))T[F]===void 0&&(T[F]=o._.colorTheme[F].default);const A=new o.$(ff,l,new Map(x));return A.setTransitionOrValue(T,x),A.untransitioned().possiblyEvaluate(new o.a3(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,x)=>{const T="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let A=r;A.startsWith(T)||(A=T+A);const F="mapbox-reserved-lut",j=new Image;j.src=A,j.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},j.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void p();this._styleColorTheme.lutLoading=!1;const{width:H,height:q,data:Y}=o.q.getImageData(j);if(q>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(H!==q*q)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(F)&&this.removeImage(F),this.addImage(F,{data:new o.r({width:H,height:q},Y),pixelRatio:1,sdf:!1,version:0});const Q=this.imageManager.getImage(F,this.scope);Q?(this._styleColorTheme.lut={image:Q.data,data:r},p()):x(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,p,x){let T,A,F;const j=o.q.devicePixelRatio>1?"@2x":"";let H=o.n(p.transformRequest(p.normalizeSpriteURL(l,j,".json"),o.R.SpriteJSON),(Q,ae)=>{H=null,F||(F=Q,T=ae,Y())}),q=o.o(p.transformRequest(p.normalizeSpriteURL(l,j,".png"),o.R.SpriteImage),(Q,ae)=>{q=null,F||(F=Q,A=ae,Y())});function Y(){if(F)x(F);else if(T&&A){const Q=o.q.getImageData(A),ae={};for(const ge in T){const{width:_e,height:Te,x:we,y:ze,sdf:Ue,pixelRatio:ke,stretchX:He,stretchY:Ye,content:Ze}=T[ge],Qe=new o.r({width:_e,height:Te});o.r.copy(Q,Qe,{x:we,y:ze},{x:0,y:0},{width:_e,height:Te},null),ae[ge]={data:Qe,pixelRatio:ke,sdf:Ue,stretchX:He,stretchY:Ye,content:Ze}}x(null,ae)}}return{cancel(){H&&(H.cancel(),H=null),q&&(q.cancel(),q=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new o.t(l));else if(p)for(const x in p)this.imageManager.addImage(x,this.scope,p[x]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new o.x("data",{dataType:"style"}))})}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.t(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const p=this.fragments[l];return p&&p.style&&(r.data=p.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return r}_serializeLayers(r){const l=[];for(const p of r){const x=this._layers[p];x&&x.type!=="custom"&&l.push(x.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new o.t(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new o.t(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const p=this.map.painter;if(p)for(let x=r.minzoom||0;x<(r.maxzoom||25.5);x++){const T=r.getProgramIds();if(T)for(const A of T){const F=r.getDefaultProgramParams(A,l.zoom,this._styleColorTheme.lut);F&&(p.style=this,this.fog&&(p._fogVisible=!0,F.overrideFog=!0,p.getOrCreateProgram(A,F)),p._fogVisible=!1,F.overrideFog=!1,p.getOrCreateProgram(A,F),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(F.overrideRtt=!0,p.getOrCreateProgram(A,F)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const p=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const F in A){const{updatedIds:j,removedIds:H}=A[F];(j||H)&&(this._updateWorkerLayers(F,j,H),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const T={};for(const A in this._mergedSourceCaches){const F=this._mergedSourceCaches[A];T[A]=F.used,F.used=!1,F.tileCoverLift=0}for(const A of this._mergedOrder){const F=this._mergedLayers[A];if(F.recalculate(r,this._availableImages),!F.isHidden(r.zoom)){const j=this.getLayerSourceCache(F);j&&(j.used=!0,j.tileCoverLift=Math.max(j.tileCoverLift,F.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(F,r)}):this.precompilePrograms(F,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();for(const A in T){const F=this._mergedSourceCaches[A];T[A]!==F.used&&F.getSource().fire(new o.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:F.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new o.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,l,p){const x=this.getFragmentStyle(r);x&&this.dispatcher.broadcast("updateLayers",{layers:l?x._serializeLayers(l):[],scope:r,removedIds:p||[],options:x.options})}setState(r,l){if(this._checkLoaded(),da(this,Di(r)))return!1;(r=o.cm(r)).layers=To(r.layers);const p=function(A,F){if(!A)return[{command:wr.setStyle,args:[F]}];let j=[];try{if(!o.bi(A.version,F.version))return[{command:wr.setStyle,args:[F]}];if(o.bi(A.center,F.center)||j.push({command:wr.setCenter,args:[F.center]}),o.bi(A.zoom,F.zoom)||j.push({command:wr.setZoom,args:[F.zoom]}),o.bi(A.bearing,F.bearing)||j.push({command:wr.setBearing,args:[F.bearing]}),o.bi(A.pitch,F.pitch)||j.push({command:wr.setPitch,args:[F.pitch]}),o.bi(A.sprite,F.sprite)||j.push({command:wr.setSprite,args:[F.sprite]}),o.bi(A.glyphs,F.glyphs)||j.push({command:wr.setGlyphs,args:[F.glyphs]}),o.bi(A.imports,F.imports)||function(ae=[],ge=[],_e){ge=ge||[];const Te=(ae=ae||[]).map(ba),we=ge.map(ba),ze=ae.reduce(Hr,{}),Ue=ge.reduce(Hr,{}),ke=Te.slice();let He,Ye,Ze,Qe;for(He=0,Ye=0;He<Te.length;He++)Ze=Te[He],Ue.hasOwnProperty(Ze)?Ye++:(_e.push({command:wr.removeImport,args:[Ze]}),ke.splice(ke.indexOf(Ze,Ye),1));for(He=0,Ye=0;He<we.length;He++)Ze=we[we.length-1-He],ke[ke.length-1-He]!==Ze&&(ze.hasOwnProperty(Ze)?(_e.push({command:wr.removeImport,args:[Ze]}),ke.splice(ke.lastIndexOf(Ze,ke.length-Ye),1)):Ye++,Qe=ke[ke.length-He],_e.push({command:wr.addImport,args:[Ue[Ze],Qe]}),ke.splice(ke.length-He,0,Ze));for(const it of ge){const ft=ze[it.id];ft&&!o.bi(ft,it)&&_e.push({command:wr.updateImport,args:[it.id,it]})}}(A.imports,F.imports,j),o.bi(A.transition,F.transition)||j.push({command:wr.setTransition,args:[F.transition]}),o.bi(A.light,F.light)||j.push({command:wr.setLight,args:[F.light]}),o.bi(A.fog,F.fog)||j.push({command:wr.setFog,args:[F.fog]}),o.bi(A.projection,F.projection)||j.push({command:wr.setProjection,args:[F.projection]}),o.bi(A.lights,F.lights)||j.push({command:wr.setLights,args:[F.lights]}),o.bi(A.camera,F.camera)||j.push({command:wr.setCamera,args:[F.camera]}),!o.bi(A["color-theme"],F["color-theme"]))return[{command:wr.setStyle,args:[F]}];const H={},q=[];(function(ae,ge,_e,Te){let we;for(we in ge=ge||{},ae=ae||{})ae.hasOwnProperty(we)&&(ge.hasOwnProperty(we)||Pr(we,_e,Te));for(we in ge){if(!ge.hasOwnProperty(we))continue;const ze=ge[we];ae.hasOwnProperty(we)?o.bi(ae[we],ze)||(ae[we].type==="geojson"&&ze.type==="geojson"&&Yn(ae,ge,we)?_e.push({command:wr.setGeoJSONSourceData,args:[we,ze.data]}):Ho(we,ge,_e,Te)):Ba(we,ge,_e)}})(A.sources,F.sources,q,H);const Y=[];A.layers&&A.layers.forEach(ae=>{ae.source&&H[ae.source]?j.push({command:wr.removeLayer,args:[ae.id]}):Y.push(ae)});let Q=A.terrain;Q&&H[Q.source]&&(j.push({command:wr.setTerrain,args:[void 0]}),Q=void 0),j=j.concat(q),o.bi(Q,F.terrain)||j.push({command:wr.setTerrain,args:[F.terrain]}),function(ae,ge,_e){ge=ge||[];const Te=(ae=ae||[]).map(ba),we=ge.map(ba),ze=ae.reduce(Hr,{}),Ue=ge.reduce(Hr,{}),ke=Te.slice(),He=Object.create(null);let Ye,Ze,Qe,it,ft,st,at;for(Ye=0,Ze=0;Ye<Te.length;Ye++)Qe=Te[Ye],Ue.hasOwnProperty(Qe)?Ze++:(_e.push({command:wr.removeLayer,args:[Qe]}),ke.splice(ke.indexOf(Qe,Ze),1));for(Ye=0,Ze=0;Ye<we.length;Ye++)Qe=we[we.length-1-Ye],ke[ke.length-1-Ye]!==Qe&&(ze.hasOwnProperty(Qe)?(_e.push({command:wr.removeLayer,args:[Qe]}),ke.splice(ke.lastIndexOf(Qe,ke.length-Ze),1)):Ze++,st=ke[ke.length-Ye],_e.push({command:wr.addLayer,args:[Ue[Qe],st]}),ke.splice(ke.length-Ye,0,Qe),He[Qe]=!0);for(Ye=0;Ye<we.length;Ye++)if(Qe=we[Ye],it=ze[Qe],ft=Ue[Qe],!He[Qe]&&!o.bi(it,ft))if(o.bi(it.source,ft.source)&&o.bi(it["source-layer"],ft["source-layer"])&&o.bi(it.type,ft.type)){for(at in Wo(it.layout,ft.layout,_e,Qe,null,wr.setLayoutProperty),Wo(it.paint,ft.paint,_e,Qe,null,wr.setPaintProperty),o.bi(it.slot,ft.slot)||_e.push({command:wr.setSlot,args:[Qe,ft.slot]}),o.bi(it.filter,ft.filter)||_e.push({command:wr.setFilter,args:[Qe,ft.filter]}),o.bi(it.minzoom,ft.minzoom)&&o.bi(it.maxzoom,ft.maxzoom)||_e.push({command:wr.setLayerZoomRange,args:[Qe,ft.minzoom,ft.maxzoom]}),it)it.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&at!=="slot"&&(at.indexOf("paint.")===0?Wo(it[at],ft[at],_e,Qe,at.slice(6),wr.setPaintProperty):o.bi(it[at],ft[at])||_e.push({command:wr.setLayerProperty,args:[Qe,at,ft[at]]}));for(at in ft)ft.hasOwnProperty(at)&&!it.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&at!=="slot"&&(at.indexOf("paint.")===0?Wo(it[at],ft[at],_e,Qe,at.slice(6),wr.setPaintProperty):o.bi(it[at],ft[at])||_e.push({command:wr.setLayerProperty,args:[Qe,at,ft[at]]}))}else _e.push({command:wr.removeLayer,args:[Qe]}),st=ke[ke.lastIndexOf(Qe)+1],_e.push({command:wr.addLayer,args:[ft,st]})}(Y,F.layers,j)}catch(H){console.warn("Unable to compute style diff:",H),j=[{command:wr.setStyle,args:[F]}]}return j}(this.serialize(),r).filter(A=>!(A.command in hs));if(p.length===0)return!1;const x=p.filter(A=>!(A.command in zh));if(x.length>0)throw new Error(`Unimplemented: ${x.map(A=>A.command).join(", ")}.`);const T=[];return p.forEach(A=>{T.push(this[A.command].apply(this,A.args))}),l&&Promise.all(T).then(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,l){return this.getImage(r)?this.fire(new o.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,l),this._afterImageUpdated(r),this)}updateImage(r,l){this.imageManager.updateImage(r,this.scope,l)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new o.t(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new o.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,l,p={}){return this._checkLoaded(),this._validate(ce,`models.${r}`,l,null,p)||(this.modelManager.addModel(r,l,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new o.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,p={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(vi,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const x=qr(r,l,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const T=A=>{const F=(A?"symbol:":"other:")+x.id,j=o.av(F,this.scope),H=this._sourceCaches[F]=new Cn(j,x,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=H,H.onAdd(this.map)};T(!1),l.type!=="vector"&&l.type!=="geojson"||T(!0),x.onAdd&&x.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new o.t(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(r);for(const x of p){const T=o.cn(x.id);delete this._sourceCaches[T],this._changes.discardSourceCacheUpdate(x.id),x.fire(new o.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const p=this.getOwnSourceCache(l);p&&r.push(p.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const p=r[l]._tiles;for(const x in p){const T=p[x];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const x of r){if(this._validate(Mi,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){const T=this.ambientLight;T.set(x),T.updateTransitions(l)}else this.ambientLight=new In(x,Ln||(Ln=new o.a0({color:new o.a1(o._.properties_light_ambient.color),intensity:new o.a1(o._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const T=this.directionalLight;T.set(x),T.updateTransitions(l)}else this.directionalLight=new In(x,dr||(dr=new o.a0({direction:new o.ad(o._.properties_light_directional.direction),color:new o.a1(o._.properties_light_directional.color),intensity:new o.a1(o._.properties_light_directional.intensity),"cast-shadows":new o.a1(o._.properties_light_directional["cast-shadows"]),"shadow-intensity":new o.a1(o._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new o.a3(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const p=Q=>.2126*(Q[0]<=.03928?Q[0]/12.92:Math.pow((Q[0]+.055)/1.055,2.4))+.7152*(Q[1]<=.03928?Q[1]/12.92:Math.pow((Q[1]+.055)/1.055,2.4))+.0722*(Q[2]<=.03928?Q[2]/12.92:Math.pow((Q[2]+.055)/1.055,2.4)),x=r.properties.get("color").toRenderColor(null).toArray01(),T=r.properties.get("intensity"),A=r.properties.get("direction"),F=1-o.c8(A.x,A.y,A.z)[2]/90,j=p(x)*T*F,H=l.properties.get("color").toRenderColor(null).toArray01(),q=l.properties.get("intensity"),Y=p(H)*q;return Number(((j+Y)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(o.aK(r)){const l=o.co(r),p=this.fragments.find(({id:T})=>T===l);if(!p)throw new Error(`Style import '${r}' not found`);const x=o.cn(r);return p.style.getFragmentStyle(x)}{const l=this.fragments.find(({id:p})=>p===r);if(!l)throw new Error(`Style import '${r}' not found`);return l.style}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const p=[];for(const x in l.stylesheet.featuresets)p.push({featuresetId:x,importId:l.scope?l.scope:void 0});return p}getFeaturesetLayers(r,l){const p=this.getFragmentStyle(l),x=p.stylesheet.featuresets;if(!x||!x[r])return this.fire(new o.t(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const T=[];for(const A of x[r].selectors){const F=p.getOwnLayer(A.layer);F&&T.push(F)}return T}getConfigProperty(r,l){const p=this.getFragmentStyle(r);if(!p)return null;const x=o.av(l,p.scope),T=p.options.get(x),A=T?T.value||T.default:null;return A?A.serialize():null}setConfigProperty(r,l,p){const x=this.getFragmentStyle(r);if(!x)return;const T=x.stylesheet.schema;if(!T||!T[l])return;const A=o.M(p);if(A.result!=="success")return void da(this,A.value);const F=A.value.expression,j=o.av(l,x.scope),H=x.options.get(j);if(!H)return;let q;const{minValue:Y,maxValue:Q,stepValue:ae,type:ge,values:_e}=T[l],Te=o.M(T[l].default);Te.result==="success"&&(q=Te.value.expression),q?(this.options.set(j,{...H,value:F,default:q,minValue:Y,maxValue:Q,stepValue:ae,type:ge,values:_e}),this.updateConfigDependencies(l)):this.fire(new o.t(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const p=l.stylesheet.schema;if(!p)return null;const x={};for(const T in p){const A=o.av(T,l.scope),F=l.options.get(A),j=F?F.value||F.default:null;x[T]=j?j.serialize():null}return x}setConfig(r,l){const p=this.getFragmentStyle(r);p&&(p.updateConfig(l,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const p=this.getFragmentStyle(r);p&&(p.stylesheet.schema=l,p.updateConfig(p._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const p in l){let x,T;const A=o.M(l[p].default);if(A.result==="success"&&(x=A.value.expression),r&&r[p]!==void 0){const Q=o.M(r[p]);Q.result==="success"&&(T=Q.value.expression)}const{minValue:F,maxValue:j,stepValue:H,type:q,values:Y}=l[p];if(x){const Q=o.av(p,this.scope);this.options.set(Q,{default:x,value:T,minValue:F,maxValue:j,stepValue:H,type:q,values:Y})}else this.fire(new o.t(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new o.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const p=this.getLayer(l);if(p){if(r&&!p.configDependencies.has(r))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const p=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut&&p!==""||l._styleColorTheme.lut&&p!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(r,l,p={}){this._checkLoaded();const x=r.id;if(this._layers[x])return void this.fire(new o.t(new Error(`Layer with id "${x}" already exists on this map`)));let T;if(r.type==="custom"){if(da(this,o.cp(r)))return;T=o.cq(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(x,r.source),r=o.cm(r),r=o.l(r,{source:x})),this._validate(kt,`layers.${x}`,r,{arrayIndex:-1},p))return;T=o.cq(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(T),T.setEventedParent(this,{layer:{id:x}})}T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid);let A=this._order.length;if(l){const q=this._order.indexOf(l);if(q===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));T.slot===this._layers[l].slot?A=q:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=T;const F=this.getOwnLayerSourceCache(T),j=!!this.directionalLight&&this.directionalLight.shadowsEnabled();F&&T.canCastShadows()&&j&&(F.castsShadows=!0);const H=this._changes.getRemovedLayer(T);if(H&&T.source&&F&&T.type!=="custom"){this._changes.discardLayerRemoval(T);const q=o.av(T.source,T.scope);H.type!==T.type?this._changes.updateSourceCache(q,"clear"):(this._changes.updateSourceCache(q,"reload"),F.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),T.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const p=this._checkLayer(r);if(!p||r===l)return;const x=this._order.indexOf(r);this._order.splice(x,1);let T=this._order.length;if(l){const A=this._order.indexOf(l);if(A===-1)return void this.fire(new o.t(new Error(`Layer with id "${l}" does not exist on this map.`)));p.slot===this._layers[l].slot?T=A:o.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(T,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const x=this.getOwnLayerSourceCache(l);if(x&&x.castsShadows){let T=!1;for(const A in this._layers)if(this._layers[A].source===l.source&&this._layers[A].canCastShadows()){T=!0;break}x.castsShadows=T}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const x=this._checkLayer(r);x&&(x.minzoom===l&&x.maxzoom===p||(l!=null&&(x.minzoom=l),p!=null&&(x.maxzoom=p),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const p=this._checkLayer(r);p&&p.slot!==l&&(p.slot=l,this._updateLayer(p))}setFilter(r,l,p={}){this._checkLoaded();const x=this._checkLayer(r);if(x&&!o.bi(x.filter,l))return l==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(Se,`layers.${x.id}.filter`,l,{layerType:x.type},p)||(x.filter=o.cm(l),this._updateLayer(x)))}getFilter(r){const l=this._checkLayer(r);if(l)return o.cm(l.filter)}setLayoutProperty(r,l,p,x={}){this._checkLoaded();const T=this._checkLayer(r);if(T&&!o.bi(T.getLayoutProperty(l),p)){if(p!=null&&(!x||x.validate!==!1)&&da(T,re.call(Di,{key:`layers.${r}.layout.${l}`,layerType:T.type,objectKey:l,value:p,styleSpec:o._,style:{glyphs:!0,sprite:!0}})))return;T.setLayoutProperty(l,p),T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),this._updateLayer(T)}}getLayoutProperty(r,l){const p=this._checkLayer(r);if(p)return p.getLayoutProperty(l)}setPaintProperty(r,l,p,x={}){this._checkLoaded();const T=this._checkLayer(r);if(!T||o.bi(T.getPaintProperty(l),p)||p!=null&&(!x||x.validate!==!1)&&da(T,Z.call(Di,{key:`layers.${r}.paint.${l}`,layerType:T.type,objectKey:l,value:p,styleSpec:o._})))return;const A=T.setPaintProperty(l,p);T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),A&&this._updateLayer(T),this._changes.updatePaintProperties(T)}getPaintProperty(r,l){const p=this._checkLayer(r);if(p)return p.getPaintProperty(l)}setFeatureState(r,l){this._checkLoaded();const p=r.featureset;if(p){if("featuresetId"in p){const H=this.getFragmentStyle(p.importId),q=H.getFeaturesetLayers(p.featuresetId);for(const{source:Y,sourceLayer:Q}of q)H.setFeatureState({id:r.id,source:Y,sourceLayer:Q},l)}else if("layerId"in p){const H=this.getLayer(p.layerId);this.setFeatureState({id:r.id,source:H.source,sourceLayer:H.sourceLayer},l)}return}const x=r.source,T=r.sourceLayer,A=this._checkSource(x);if(!A)return;const F=A.type;if(F==="geojson"&&T)return void this.fire(new o.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(F==="vector"&&!T)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided.")));const j=this.getOwnSourceCaches(x);for(const H of j)H.setFeatureState(T,r.id,l)}removeFeatureState(r,l){this._checkLoaded();const p=r.featureset;if(p){if("featuresetId"in p){const H=this.getFragmentStyle(p.importId),q=H.getFeaturesetLayers(p.featuresetId);for(const{source:Y,sourceLayer:Q}of q)H.removeFeatureState({id:r.id,source:Y,sourceLayer:Q},l)}else if("layerId"in p){const H=this.getLayer(p.layerId);this.removeFeatureState({id:r.id,source:H.source,sourceLayer:H.sourceLayer},l)}return}const x=r.source,T=this._checkSource(x);if(!T)return;const A=T.type,F=A==="vector"?r.sourceLayer:void 0;if(A==="vector"&&!F)return void this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new o.t(new Error("A feature id is required to remove its specific state property.")));const j=this.getOwnSourceCaches(x);for(const H of j)H.removeFeatureState(F,r.id,l)}getFeatureState(r){this._checkLoaded();const l=r.featureset;if(l){let A;if("featuresetId"in l){const F=this.getFragmentStyle(l.importId),j=F.getFeaturesetLayers(l.featuresetId);for(const{source:H,sourceLayer:q}of j){const Y=F.getFeatureState({id:r.id,source:H,sourceLayer:q});if(Y&&!A)A=Y;else if(!o.bi(A,Y))return void this.fire(new o.t(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r){const F=this.getLayer(l.layerId);A=this.getFeatureState({id:r.id,source:F.source,sourceLayer:F.sourceLayer})}return A}const p=r.source,x=r.sourceLayer,T=this._checkSource(p);if(T){if(T.type!=="vector"||x)return r.id===void 0&&this.fire(new o.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(p)[0].getFeatureState(x,r.id);this.fire(new o.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=o.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return o.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return o.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),p=o.av(r.source,r.scope),x=this._changes.getUpdatedSourceCaches();r.source&&!x[p]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=F=>this._mergedLayers[F].is3D(),p=this.order,x={},T=[];for(let F=p.length-1;F>=0;F--){const j=p[F];if(l(j)){x[j]=F;for(const H of r){const q=H[j];if(q)for(const Y of q)T.push(Y)}}}T.sort((F,j)=>j.intersectionZ-F.intersectionZ);const A=[];for(let F=p.length-1;F>=0;F--){const j=p[F];if(l(j))for(let H=T.length-1;H>=0;H--){const q=T[H].feature;if(q.layer&&x[q.layer.id]<F)break;A.push(q),T.pop()}else for(const H of r){const q=H[j];if(q)for(const Y of q)A.push(Y.feature)}}return A}queryRenderedFeatures(r,l,p){l&&!Array.isArray(l)&&l.filter&&this._validate(Se,"queryRenderedFeatures.filter",l.filter,null,l);let x,T=!1;const A=new Set;if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.t(new Error("parameters.layers must be an Array."))),[];x=[];for(const q of l.layers){const Y=this._mergedLayers[q];if(!Y)return this.fire(new o.t(new Error(`The layer '${q}' does not exist in the map's style and cannot be queried for features.`))),[];Y.is3D()&&(T=!0),A.add(Y.source),x.push(q)}}else T=this.has3DLayers();const F=this._queryRenderedFeatures(r,p,{layerIds:x,filter:l.filter,has3DLayers:T,includedSources:A}),j=this._flattenAndSortRenderedFeatures(F),H=[];for(const q of j)o.co(q.layer.id)===this.scope&&H.push(q);return H}queryRenderedFeaturesForInteractions(r,l,p){let x=[];for(const{featureset:j,filter:H,radius:q}of l){let Y=!1;const Q=[],ae=new Set;if("featuresetId"in j){const _e=this.getFeaturesetLayers(j.featuresetId,j.importId);if(_e.length===0)continue;for(const Te of _e)Te.is3D()&&(Y=!0),ae.add(Te.source),Q.push(Te.fqid)}else if("layerId"in j){const _e=this._mergedLayers[j.layerId];if(!_e)return this.fire(new o.t(new Error(`The layer '${j.layerId}' does not exist in the map's style and cannot be queried for features.`))),[];_e.is3D()&&(Y=!0),ae.add(_e.source),Q.push(j.layerId)}let ge=r;if(q)if(r instanceof o.P||typeof r[0]=="number"){const _e=o.P.convert(r);ge=[[_e.x-q,_e.y-q],[_e.x+q,_e.y+q]]}else{const _e=o.P.convert(r[0]),Te=o.P.convert(r[1]);ge=[[_e.x-q,_e.y-q],[Te.x+q,Te.y+q]]}x=x.concat(this._queryRenderedFeatures(ge,p,{layerIds:Q,filter:H,has3DLayers:Y,includedSources:ae}))}const T=this._flattenAndSortRenderedFeatures(x),A=(j,H,q)=>{const Y=j.clone();if(delete Y.layer,Y.featureset=H,q&&q.featureNamespace&&(Y.namespace=q.featureNamespace),q&&q.properties){const Q={},ae=this.map.transform.zoom;for(const ge of Object.keys(q.properties)){const _e=q.properties[ge].evaluate({zoom:ae},j._vectorTileFeature,j.state,j.tile,this._availableImages);_e!=null&&(Q[ge]=_e)}Y.properties=Q}return Y},F=[];for(const j of T){const H=j.layer.id,q=o.cn(H),Y=o.co(H);for(const{featureset:Q}of l){if("layerId"in Q&&Q.layerId!==H)continue;if("layerId"in Q&&Q.layerId===H){const ge=A(j,Q);F.push(ge);continue}if("featuresetId"in Q&&(Q.importId!==Y||!this.getFeaturesetLayers(Q.featuresetId,Q.importId).map(ge=>ge.id).includes(q)))continue;const ae=this._mergedLayerSelectors.get(H)||[];for(const ge of ae){const _e=A(j,Q,ge);F.push(_e)}}}return F}_queryRenderedFeatures(r,l,p){const{layerIds:x,filter:T,has3DLayers:A,includedSources:F}=p,j=[],H=Zn.createFromScreenPoints(r,l);for(const q in this._mergedSourceCaches){if(!this._mergedSourceCaches[q].getSource())continue;const Y=this._mergedSourceCaches[q].getSource().id;x&&!F.has(Y)||j.push(Zi(this._mergedSourceCaches[q],this._mergedLayers,H,T,x||[],this._availableImages,l,A,!!this.map._showQueryGeometry))}return this.placement&&j.push(function(q,Y,Q,ae,ge,_e,Te,we){const ze={},Ue=Te.queryRenderedSymbols(Q),ke=[];for(const He of Object.keys(Ue).map(Number))ke.push(we[He]);ke.sort(Gr);for(const He of ke){const Ye=He.featureIndex.lookupSymbolFeatures(Ue[He.bucketInstanceId],He.bucketIndex,He.sourceLayerIndex,ae,ge,_e,q);for(const Ze in Ye){const Qe=ze[Ze]=ze[Ze]||[],it=Ye[Ze];it.sort((ft,st)=>{const at=He.featureSortOrder;if(at){const Rt=at.indexOf(ft.featureIndex);return at.indexOf(st.featureIndex)-Rt}return st.featureIndex-ft.featureIndex});for(const ft of it)Qe.push(ft)}}for(const He in ze)ze[He].forEach(Ye=>{const Ze=Ye.feature,Qe=q[He],it=Y(Qe);if(!it)return;const ft=it.getFeatureState(Ze.layer["source-layer"],Ze.id);Ze.state=ft,o.aK(Qe.id)||(Ze.source=Ze.layer.source,Ze.layer["source-layer"]&&(Ze.sourceLayer=Ze.layer["source-layer"]))});return ze}(this._mergedLayers,this.getLayerSourceCache.bind(this),H.screenGeometry,T,x||[],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData)),j}querySourceFeatures(r,l){const p=l&&l.filter;p&&this._validate(Se,"querySourceFeatures.filter",p,null,l);let x=[];const T=this.getOwnSourceCaches(r);for(const A of T)x=x.concat(Xn(A,l));return x}addSourceType(r,l,p){return ns.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(ns.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,p={}){this._checkLoaded();const x=this.light.getLight();let T=!1;for(const F in r)if(!o.bi(r[F],x[F])){T=!0;break}if(!T)return;const A=this._getTransitionParameters();this.light.setLight(r,l,p),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=o.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&o.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=r;const x=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const F="terrain-dem-src";this.addSource(F,p.source),p=o.cm(p),p=o.l(p,{source:F})}const T=o.l({},p),A={};if(this.terrain&&x){T.source=this.terrain.get().source;const F=this.terrain?this.getFragmentStyle(this.terrain.scope):null;F&&(A.style=F.serialize())}if(this._validate(Fo,"terrain",T,A))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&l!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,l),this.fire(new o.x("data",{dataType:"style"}))}else{const T=this.terrain,A=T.get();for(const F of Object.keys(o._.terrain))!p.hasOwnProperty(F)&&o._.terrain[F].default&&(p[F]=o._.terrain[F].default);for(const F in r)if(!o.bi(r[F],A[F])){T.set(r,this.options),this.stylesheet.terrain=r;const j=this._getTransitionParameters({duration:0});T.updateTransitions(j),this.fire(new o.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new Tn(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!o.bi(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createFog(r);this._markersNeedUpdate=!0}setColorTheme(r){this._checkLoaded();const l=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()};if(this._styleColorTheme.colorTheme=r,!r)return this._styleColorTheme.lut=null,void l();const p=this._evaluateColorThemeData(r);this._loadColorTheme(p).then(()=>{this.fire(new o.x("colorthemeset")),l()}).catch(x=>{o.w(`Couldn't set color theme: ${x}`)})}_getTransitionParameters(r){return{now:o.q.now(),transition:o.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?r.push(p):l.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new Be(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});p.updateTransitions(x)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,x,T={}){if(T&&T.validate===!1)return!1;const A=o.l({},this.serialize());return da(this,r.call(Di,o.l({key:l,style:A,value:p,styleSpec:o._},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const p of l)p.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const p of l)p.resume(),p.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let l;this.directionalLight&&(l=Qc(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(r,void 0,void 0,l)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,x,T,A,F=!1){let j=!1,H=!1;const q={},Y={};for(const Q of this._mergedOrder){const ae=this._mergedLayers[Q];if(ae.type!=="symbol")continue;const ge=o.av(ae.source,ae.scope);let _e=q[ge];if(!_e){const we=this.getLayerSourceCache(ae);if(!we)continue;const ze=we.getRenderableIds(!0).map(Ue=>we.getTileByID(Ue));Y[ge]=ze.slice(),_e=q[ge]=ze.sort((Ue,ke)=>ke.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(ke.tileID)?-1:1))}const Te=this.crossTileSymbolIndex.addLayer(ae,_e,l.center.lng,l.projection);j=j||Te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),F=F||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new o.x("neworder")),(F||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.q.now(),l.zoom))&&(this.pauseablePlacement=new cu(l,this._mergedOrder,F,p,x,T,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,q,Y,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.q.now()),H=!0),j&&this.pauseablePlacement.placement.setStale()),H||j){this._buildingIndex.onNewFrame(l.zoom);for(let Q=0;Q<this._mergedOrder.length;Q++){const ae=this._mergedLayers[this._mergedOrder[Q]];if(ae.type!=="symbol")continue;const ge=this.isLayerClipped(ae);this.placement.updateLayerOpacities(ae,q[o.av(ae.source,ae.scope)],Q,ge?A:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:T})=>T===r.id)!==-1)return void this.fire(new o.t(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return p.push(r),this._loadImports([r],!0);const x=p.findIndex(({id:T})=>T===l);return x===-1&&this.fire(new o.t(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,x).concat(r).concat(p.slice(x)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],x=this.getImportIndex(r);return x===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==p[x].url&&this.setImportUrl(r,l.url),o.bi(l.config,p[x].config)||this.setImportConfig(r,l.config),o.bi(l.data,p[x].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let p=this.stylesheet.imports||[];const x=this.getImportIndex(r);if(x===-1)return this;const T=this.getImportIndex(l);if(T===-1)return this;const A=p[x],F=this.fragments[x];return p=p.filter(({id:j})=>j!==r),this.fragments=this.fragments.filter(({id:j})=>j!==r),this.stylesheet.imports=p.slice(0,T).concat(A).concat(p.slice(T)),this.fragments=this.fragments.slice(0,T).concat(F).concat(this.fragments.slice(T)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],x=this.getImportIndex(r);if(x===-1)return this;p[x].url=l;const T=this.fragments[x];return T.style=this._createFragmentStyle(p[x]),T.style.on("style.import.load",()=>this.mergeAll()),T.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const p=this.getImportIndex(r),x=this.stylesheet.imports||[];return p===-1?this:l?(this.fragments[p].style.setState(l),this._reloadImports(),this):(delete x[p].data,this.setImportUrl(r,x[p].url))}setImportConfig(r,l){this._checkLoaded();const p=this.getImportIndex(r),x=this.stylesheet.imports||[];if(p===-1)return this;l?x[p].config=l:delete x[p].config;const T=this.fragments[p],A=T.style.stylesheet&&T.style.stylesheet.schema;return T.config=l,T.style.updateConfig(l,A),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],p=this.getImportIndex(r);p!==-1&&(l.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(p=>p.id===r);return l===-1&&this.fire(new o.t(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[l];p&&r.push(p.getSource())}return r}getSource(r,l){const p=this.getSourceCache(r,l);return p&&p.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const p=o.av(r,l);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(r){const l=o.av(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const p=r[l];p==="reload"?this.reloadSource(l):p==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const p of l){const x=this.getLayer(p);x&&x.updateTransitions(r)}}getImages(r,l,p){this.imageManager.getImages(l.icons,l.scope,p),this._updateTilesForChangedImages();const x=T=>{T&&T.setDependencies(l.tileID.key,l.type,l.icons)};x(this._otherSourceCaches[l.source]),x(this._symbolSourceCaches[l.source])}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,l.scope,p)}getResource(r,l,p){return o.ct(l,p)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new o.t(new Error(`There is no source with ID '${r}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const p=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D()){if(p||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ns.getSourceType=function(d){return Kr[d]},ns.setSourceType=function(d,r){Kr[d]=r},ns.registerForPluginStateChange=o.cd;var uc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,cc=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,hc=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,ql="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",th=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Fh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,df=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Ys=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Sl=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,pf=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Bu=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const nh=[];Ds(uc,nh),Ds(hc,nh),Ds(cc,nh);const Nu={"_prelude_fog.vertex.glsl":Fh,"_prelude_terrain.vertex.glsl":th,"_prelude_shadow.vertex.glsl":pf,"_prelude_fog.fragment.glsl":df,"_prelude_shadow.fragment.glsl":Bu,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Ys,"_prelude_raster_particle.glsl":Sl},fu={};ti("",th),ti(df,Fh),ti(Bu,pf),ti(Ys,""),ti(Sl,"");const Ss=ti(cc,hc),ju=uc;var Ls={background:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ti("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ti(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ti(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ti("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ti("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ti("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:ti(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ti(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:ti(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:ti(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:ti("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:ti("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:ti(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:ti(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:ti("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:ti(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ql),skyboxGradient:ti(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,ql),skyboxCapture:ti(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ti(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ti(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ti(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ti(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:ti("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:ti("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),occlusion:ti("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ds(d,r){const l=d.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of l)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=p.split(" ");for(const T of x)r.includes(T)||r.push(T)}}function ti(d,r){const l=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let x=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(H=>{const q=H.split(" ");return q[q.length-1]}),x=[...new Set(x)]);const T={},A=[],F=[];if(d=d.replace(l,(H,q)=>(F.push(q),"")),(r=r.replace(l,(H,q)=>(A.push(q),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let j=[...nh];Ds(d,j),Ds(r,j);for(const H of[...A,...F])Nu[H]||console.error(`Undefined include: ${H}`),fu[H]||(fu[H]=[],Ds(Nu[H],fu[H])),j=[...j,...fu[H]];return{fragmentSource:d=d.replace(p,(H,q,Y,Q,ae)=>(T[ae]=!0,q==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${Y} ${Q} ${ae};
#else
uniform ${Y} ${Q} u_${ae};
#endif
`:q==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${Y} ${Q} ${ae} = u_${ae};
#endif
`:q==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${Y} ${Q} ${ae};
#endif
`:q==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(p,(H,q,Y,Q,ae)=>{const ge=Q==="float"?"vec2":Q,_e=ae.match(/color/)?"color":ge;return q==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${Y} ${Q} a_${ae};
#endif
`:T[ae]?q==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${Y} ${ge} a_${ae};
out ${Y} ${Q} ${ae};
#else
uniform ${Y} ${Q} u_${ae};
#endif
`:q==="initialize"?_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${Y} ${Q} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${_e}(a_${ae}, u_${ae}_t);
#else
    ${Y} ${Q} ${ae} = u_${ae};
#endif
`:q==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${Y} ${Q} a_${ae};
    out ${Y} ${Q} ${ae};
#endif
`:q==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:q==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${Y} ${ge} a_${ae};
#else
uniform ${Y} ${Q} u_${ae};
#endif
`:q==="define-instanced"?_e==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${Y} ${Q} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Y} ${ge} a_${ae};
#else
uniform ${Y} ${Q} u_${ae};
#endif
`:q==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${Y} ${Q} ${ae} = a_${ae};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${Y} ${Q} ${ae} = a_${ae};
#else
    ${Y} ${Q} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${Y} ${Q} ${ae} = unpack_mix_${_e}(a_${ae}, u_${ae}_t);
#else
    ${Y} ${Q} ${ae} = u_${ae};
#endif
`}),staticAttributes:x,usedDefines:j,vertexIncludes:A,fragmentIncludes:F}}class Gl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,p,x,T,A,F,j){this.context=r;let H=this.boundPaintVertexBuffers.length!==x.length;for(let Y=0;!H&&Y<x.length;Y++)this.boundPaintVertexBuffers[Y]!==x[Y]&&(H=!0);let q=this.boundDynamicVertexBuffers.length!==F.length;for(let Y=0;!q&&Y<F.length;Y++)this.boundDynamicVertexBuffers[Y]!==F[Y]&&(q=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||H||q||this.boundIndexBuffer!==T||this.boundVertexOffset!==A)this.freshBind(l,p,x,T,A,F,j);else{r.bindVertexArrayOES.set(this.vao);for(const Y of F)Y&&(Y.bind(),j&&Y.instanceCount&&Y.setVertexAttribDivisor(r.gl,l,j));T&&T.dynamicDraw&&T.bind()}}freshBind(r,l,p,x,T,A,F){const j=r.numAttributes,H=this.context,q=H.gl;this.vao&&this.destroy(),this.vao=H.gl.createVertexArray(),H.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=x,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=A,l.enableAttributes(q,r),l.bind(),l.setVertexAttribPointers(q,r,T);for(const Y of p)Y.enableAttributes(q,r),Y.bind(),Y.setVertexAttribPointers(q,r,T);for(const Y of A)Y&&(Y.enableAttributes(q,r),Y.bind(),Y.setVertexAttribPointers(q,r,T),F&&Y.instanceCount&&Y.setVertexAttribDivisor(q,r,F));x&&x.bind(),H.currentNumAttributes=j}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function fc(d,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new o.a5(0,p/l).toLngLat().lat,new o.a5(0,(p+1)/l).toLngLat().lat]}function pl(d,r,l,p,x,T,A){const F=d.context,j=F.gl,H=l.hillshadeFBO;if(!H)return;d.prepareDrawTile();const q=d.isTileAffectedByFog(r),Y=d.getOrCreateProgram("hillshade",{overrideFog:q});F.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,H.colorAttachment.get());const Q=((Te,we,ze,Ue)=>{const ke=ze.paint.get("hillshade-shadow-color"),He=ze.paint.get("hillshade-highlight-color"),Ye=ze.paint.get("hillshade-accent-color"),Ze=ze.paint.get("hillshade-emissive-strength");let Qe=o.bC(ze.paint.get("hillshade-illumination-direction"));if(ze.paint.get("hillshade-illumination-anchor")==="viewport")Qe-=Te.transform.angle;else if(Te.style&&Te.style.enable3dLights()&&Te.style.directionalLight){const ft=Te.style.directionalLight.properties.get("direction"),st=o.c8(ft.x,ft.y,ft.z);Qe=o.bC(st[1])}const it=!Te.options.moving;return{u_matrix:Ue||Te.transform.calculateProjMatrix(we.tileID.toUnwrapped(),it),u_image:0,u_latrange:fc(0,we.tileID),u_light:[ze.paint.get("hillshade-exaggeration"),Qe],u_shadow:ke.toRenderColor(ze.lut),u_highlight:He.toRenderColor(ze.lut),u_emissive_strength:Ze,u_accent:Ye.toRenderColor(ze.lut)}})(d,l,p,d.terrain?r.projMatrix:null);d.uploadCommonUniforms(F,Y,r.toUnwrapped());const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:ge,tileBoundsSegments:_e}=d.getTileBoundsBuffers(l);Y.draw(d,j.TRIANGLES,x,T,A,Mt.disabled,Q,p.id,ae,ge,_e)}function Tl(d,r,l){if(!r.needsDEMTextureUpload)return;const p=d.context,x=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||d.getTileTexture(l.stride);const T=l.getPixels();r.demTexture?r.demTexture.update(T,{premultiply:!1}):r.demTexture=new o.T(p,T,x.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function zs(d,r,l){const p=d.context,x=p.gl;if(!r.dem)return;const T=r.dem;if(p.activeTexture.set(x.TEXTURE1),Tl(d,r,T),!r.demTexture)return;r.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const A=T.dim;p.activeTexture.set(x.TEXTURE0);let F=r.hillshadeFBO;if(!F){const Q=new o.T(p,{width:A,height:A,data:null},x.RGBA8);Q.bind(x.LINEAR,x.CLAMP_TO_EDGE),F=r.hillshadeFBO=p.createFramebuffer(A,A,!0,"renderbuffer"),F.colorAttachment.set(Q.texture)}p.bindFramebuffer.set(F.framebuffer),p.viewport.set([0,0,A,A]);const{tileBoundsBuffer:j,tileBoundsIndexBuffer:H,tileBoundsSegments:q}=d.getMercatorTileBoundsBuffers(),Y=[];d.linearFloatFilteringSupported()&&Y.push("TERRAIN_DEM_FLOAT_FORMAT"),d.getOrCreateProgram("hillshadePrepare",{defines:Y}).draw(d,x.TRIANGLES,ir.disabled,Pe.disabled,Sr.unblended,Mt.disabled,((Q,ae)=>{const ge=ae.stride,_e=o.a6.mat4.create();return o.a6.mat4.ortho(_e,0,o.ab,-o.ab,0,0,1),o.a6.mat4.translate(_e,_e,[0,-o.ab,0]),{u_matrix:_e,u_image:1,u_dimension:[ge,ge],u_zoom:Q.overscaledZ}})(r.tileID,T),l.id,j,H,q),r.needsHillshadePrepare=!1}class Bi{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class $u extends Bi{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class mf extends Bi{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Js extends Bi{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class dc extends Bi{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Uu extends Bi{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Vu extends Bi{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class gf extends Bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Qs extends Bi{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class el extends Bi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class rh extends Bi{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ad extends Bi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class tp extends Bi{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class pc extends Bi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class Bh extends Bi{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ih extends Bi{getDefault(){return o.bA.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class oh extends Bi{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class vo extends Bi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class Nh extends Bi{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class mc extends Bi{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let gc=class extends Bi{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}};class _c extends Bi{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class y extends Bi{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class M extends Bi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class V extends Bi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ie extends Bi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Ee extends Bi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Ge extends Bi{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Pt extends Bi{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class on extends Bi{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class dn extends Bi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Rn extends Bi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class hr extends Bi{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class Jr extends hr{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ii extends hr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ja extends hr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Ko extends Ii{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Fs=(d,r,l)=>({u_matrix:d,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),fs=(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:x,u_merc_center:T,u_image0:0,u_frustum_tl:A,u_frustum_tr:F,u_frustum_br:j,u_frustum_bl:H,u_globe_pos:q,u_globe_radius:Y,u_viewport:Q,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:ge});function qu(d,r){return d!=null&&r!=null&&!(!d.hasData()||!r.hasData())&&d.demTexture!=null&&r.demTexture!=null&&d.tileID.key!==r.tileID.key}const du=new class{constructor(){this.operations={}}newMorphing(d,r,l,p,x){if(d in this.operations){const T=this.operations[d];T.to.tileID.key!==l.tileID.key&&(T.queued=l)}else this.operations[d]={startTime:p,phase:0,duration:x,from:r,to:l,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const r=this.operations[d];return{from:r.from,to:r.to,phase:r.phase}}update(d){for(const r in this.operations){const l=this.operations[r];for(l.phase=(d-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,d)){delete this.operations[r];break}}}_nextOp(d,r){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=r,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},Hl={0:null,1:"TERRAIN_VERTEX_MORPHING"};function _f(d,r,l){if(r===0)return 0;const p=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-d)*Math.max(r,1)*p}function Wl(d,r){const l=1<<d.z;return!r&&(d.x===0||d.x===l-1)||d.y===0||d.y===l-1}const Ts=d=>({u_matrix:d});function Zl(d,r,l,p,x){if(x>0){const T=o.q.now(),A=(T-d.timeAdded)/x,F=r?(T-r.timeAdded)/x:-1,j=l.getSource(),H=p.coveringZoomLevel({tileSize:j.tileSize,roundZoom:j.roundZoom}),q=!r||Math.abs(r.tileID.overscaledZ-H)>Math.abs(d.tileID.overscaledZ-H),Y=q&&d.refreshedUponExpiration?1:o.ap(q?A:1-F,0,1);return d.refreshedUponExpiration&&A>=1&&(d.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}class Xi extends Cn{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new o.ce(o.cf(),null),x=qr("mock-dem",l,p,r.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class Gu extends Cn{constructor(r){const l=qr("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new o.ce(o.cf(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const x=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,A)=>{if(T[A.key]="",!this._tiles[A.key]){const F=new dt(A,this._source.tileSize*A.overscaleFactor(),r.tileZoom);F.state="loaded",this._tiles[A.key]=F}return T},{});for(const T in this._tiles)T in x||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class yf extends o.aA{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class vf extends o.cE{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,x,T]=function(j){const H=new o.a$,q=new o.aP,Y=131;H.reserve(17161),q.reserve(33800);const Q=o.ab/128,ae=o.ab+Q/2,ge=ae+Q;for(let Te=-Q;Te<ge;Te+=Q)for(let we=-Q;we<ge;we+=Q){const ze=we<0||we>ae||Te<0||Te>ae?24575:0,Ue=o.ap(Math.round(we),0,o.ab),ke=o.ap(Math.round(Te),0,o.ab);H.emplaceBack(Ue+ze,ke)}const _e=(Te,we)=>{const ze=we*Y+Te;q.emplaceBack(ze+1,ze,ze+Y),q.emplaceBack(ze+Y,ze+Y+1,ze+1)};for(let Te=1;Te<129;Te++)for(let we=1;we<129;we++)_e(we,Te);return[0,129].forEach(Te=>{for(let we=0;we<130;we++)_e(we,Te),_e(Te,we)}),[H,q,32768]}(),A=r.context;this.gridBuffer=A.createVertexBuffer(p,o.b1.members),this.gridIndexBuffer=A.createIndexBuffer(x),this.gridSegments=o.b2.simpleSegment(0,0,p.length,x.length),this.gridNoSkirtSegments=o.b2.simpleSegment(0,0,p.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Gu(l.map),this.orthoMatrix=o.a6.mat4.create(),o.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.ab,0,o.ab,0,1);const F=A.gl;this._overlapStencilMode=new Pe({func:F.GEQUAL,mask:255},0,255,F.KEEP,F.KEEP,F.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Xi(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const x=r.terrain.properties,T=r.terrain.drapeRenderMode===0,A=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=o.q.now();const F=r.terrain&&r.terrain.scope,j=x.get("source"),H=T?this._mockSourceCache:r.getSourceCache(j,F);if(!H)return void o.w(`Couldn't find terrain source "${j}".`);if(this.sourceCache=H,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=A?this.calculateExaggeration(l):x.get("exaggeration"),!l.projection.requiresDraping&&A&&this._exaggeration===0)return void this._disable();this.enabled=!0;const q=()=>{this.sourceCache.used&&o.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Y=this.getScaledDemTileSize();this.sourceCache.update(l,Y,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,q(),this._initializing=!0),q(),l.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,p=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=p;const x=l!=null?p-l:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const T=r.zoom,A=this._style.terrain;if(!this._previousUpdateTimestamp)return A.getExaggeration(T);let F=T-this._previousZoom;const j=this._previousUpdateTimestamp;let H=T;this._evaluationZoom!=null&&(H=this._evaluationZoom,Math.abs(T-H)>.5&&(F=.5*(T-H+F)),F*x<0&&(H+=F)),this._evaluationZoom=H;const q=A.getExaggeration(H),Y=q===A.getExaggeration(Math.max(0,H-.1));if(Y&&Math.abs(q-this._exaggeration)<.01)return q;let Q=Math.min(.1,.00375*(this._updateTimestamp-j));return(Y||q<.1||Math.abs(F)<1e-4)&&(Q=Math.min(.2,4*Q)),o.aa(this._exaggeration,q,Q)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(o.a5.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=l.getIds().map(j=>{const H=l.getTileByID(j).tileID;return H.projMatrix=p.calculateProjMatrix(H.toUnwrapped()),H});(function(j,H){const q=H.transform.pointCoordinate(H.transform.getCameraPoint()),Y=new o.P(q.x,q.y);j.sort((Q,ae)=>{if(ae.overscaledZ-Q.overscaledZ)return ae.overscaledZ-Q.overscaledZ;const ge=new o.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),_e=new o.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),Te=Y.mult(1<<Q.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(ge)-Te.distSqr(_e)})})(x,this.painter);const T=this.proxyToSource||{};this.proxyToSource={},x.forEach(j=>{this.proxyToSource[j.key]={}}),this.terrainTileForTile={};const A=this._style._mergedSourceCaches;for(const j in A){const H=A[j];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,r[j],T),H.usedForTerrain))continue;const q=r[j];H.getSource().reparseOverscaled&&this._assignTerrainTiles(q)}this.proxiedCoords[l.id]=x.map(j=>new yf(j,j.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1;const F={};this._visibleDemTiles=[];for(const j of this.proxyCoords){const H=this.terrainTileForTile[j.key];if(!H)continue;const q=H.tileID.key;q in F||(this._visibleDemTiles.push(H),F[q]=q)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const x=this.terrainTileForTile[p],T=x.dem;!T||x.demTexture&&!x.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),Tl(this.painter,x,T))}}_prepareDemTileUniforms(r,l,p,x){if(!l||l.demTexture==null)return!1;const T=r.tileID.canonical,A=Math.pow(2,l.tileID.canonical.z-T.z),F=x||"";return p[`u_dem_tl${F}`]=[T.x*A%1,T.y*A%1],p[`u_dem_scale${F}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((p,x)=>{if(!x.dem)return p;const T=x.dem.tree.minimums[0];return T>0&&r++,p+T},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),x=new o.cF({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(x,{premultiply:!1}):T=this._emptyDEMTexture=new o.T(r,x,l.R32F,{premultiply:!1}),T}setupElevationDraw(r,l,p){const x=this.painter.context,T=x.gl,A={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};A.u_exaggeration=this.exaggeration();let F=null,j=null,H=1;if(p&&p.morphing&&this._useVertexMorphing){const ae=p.morphing.srcDemTile,ge=p.morphing.dstDemTile;H=p.morphing.phase,ae&&ge&&(this._prepareDemTileUniforms(r,ae,A,"_prev")&&(j=ae),this._prepareDemTileUniforms(r,ge,A)&&(F=ge))}const q=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?T.LINEAR:T.NEAREST;let Y=null;var Q;if(this.enabled?j&&F?(Y=F.demTexture,x.activeTexture.set(T.TEXTURE4),j.demTexture.bind(q(j),T.CLAMP_TO_EDGE),A.u_dem_lerp=H):(F=this.terrainTileForTile[r.tileID.key],Y=this._prepareDemTileUniforms(r,F,A)?F.demTexture:this.emptyDEMTexture):Y=this.emptyDEMTexture,x.activeTexture.set(T.TEXTURE2),Y&&(A.u_dem_size=(Q=Y).size[0]===1?1:Q.size[0]-2,Y.bind(q(F),T.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,l,A),p&&p.useMeterToDem&&F){const ae=(1<<F.tileID.canonical.z)*o.bE(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=ae}if(p&&p.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(x,A),this.painter.transform.projection.name==="globe"){const ae=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(x,ae)}}globeUniformValues(r,l,p){const x=r.projection;return{u_tile_tl_up:x.upVector(l,0,0),u_tile_tr_up:x.upVector(l,o.ab,0),u_tile_br_up:x.upVector(l,o.ab,o.ab),u_tile_bl_up:x.upVector(l,0,o.ab),u_tile_up_scale:p?o.cG(1):x.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,T,A,F,j){if(x.transform.projection.name==="globe")(function(H,q,Y,Q,ae){const ge=H.context,_e=ge.gl;let Te,we;const ze=H.transform,Ue=o.cx(H,ge,ze),ke=(Rt,$t)=>{if(we===$t)return;const sn=[Hl[$t],"PROJECTION_GLOBE_VIEW"];Ue&&sn.push("CUSTOM_ANTIALIASING");const _n=H.isTileAffectedByFog(Rt);Te=H.getOrCreateProgram("globeRaster",{defines:sn,overrideFog:_n}),we=$t},He=H.colorModeForRenderPass(),Ye=new ir(_e.LEQUAL,ir.ReadWrite,H.depthRangeFor3D);du.update(ae);const Ze=o.cy(ze),Qe=[o.am(ze.center.lng),o.at(ze.center.lat)],it=H.globeSharedBuffers,ft=[ze.width*o.q.devicePixelRatio,ze.height*o.q.devicePixelRatio],st=Float32Array.from(ze.globeMatrix),at={useDenormalizedUpVectorScale:!0};{const Rt=H.transform,$t=_f(Rt.zoom,q.exaggeration(),q.sourceCache._source.tileSize);we=-1;const sn=_e.TRIANGLES;for(const _n of Q){const yn=Y.getTile(_n),yt=Pe.disabled,Qt=q.prevTerrainTileForTile[_n.key],jt=q.terrainTileForTile[_n.key];qu(Qt,jt)&&du.newMorphing(_n.key,Qt,jt,ae,250),ge.activeTexture.set(_e.TEXTURE0),yn.texture&&yn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const tn=du.getMorphValuesForProxy(_n.key),rn=tn?1:0;tn&&o.C(at,{morphing:{srcDemTile:tn.from,dstDemTile:tn.to,phase:o.cw(tn.phase)}});const en=o.cz(_n.canonical),bn=o.cA(en.getCenter().lat),er=o.cB(_n.canonical,en,bn,Rt.worldSize/Rt._pixelsPerMercatorPixel),or=o.b6(o.cC(_n.canonical)),Nn=fs(Rt.expandedFarZProjMatrix,st,Ze,or,o.a9(Rt.zoom),Qe,Rt.frustumCorners.TL,Rt.frustumCorners.TR,Rt.frustumCorners.BR,Rt.frustumCorners.BL,Rt.globeCenterInViewSpace,Rt.globeRadius,ft,$t,Rt._farZ,er);if(ke(_n,rn),Te&&(q.setupElevationDraw(yn,Te,at),H.uploadCommonUniforms(ge,Te,_n.toUnwrapped()),it)){const[ar,On,pr]=it.getGridBuffers(bn,$t!==0);Te.draw(H,sn,Ye,yt,He,Mt.backCCW,Nn,"globe_raster",ar,On,pr)}}}if(it&&(H.renderDefaultNorthPole||H.renderDefaultSouthPole)){const Rt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ue&&Rt.push("CUSTOM_ANTIALIASING"),Te=H.getOrCreateProgram("globeRaster",{defines:Rt});for(const $t of Q){const{x:sn,y:_n,z:yn}=$t.canonical,yt=_n===0,Qt=_n===(1<<yn)-1,[jt,tn,rn,en]=it.getPoleBuffers(yn,!1);if(en&&(yt||Qt)){const bn=Y.getTile($t);ge.activeTexture.set(_e.TEXTURE0),bn.texture&&bn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let er=o.cD(yn,sn,ze);const or=o.b6(o.cC($t.canonical)),Nn=(ar,On)=>ar.draw(H,_e.TRIANGLES,Ye,Pe.disabled,He,Mt.disabled,fs(ze.expandedFarZProjMatrix,er,er,or,0,Qe,ze.frustumCorners.TL,ze.frustumCorners.TR,ze.frustumCorners.BR,ze.frustumCorners.BL,ze.globeCenterInViewSpace,ze.globeRadius,ft,0,ze._farZ),"globe_pole_raster",On,rn,en);q.setupElevationDraw(bn,Te,at),H.uploadCommonUniforms(ge,Te,$t.toUnwrapped()),yt&&H.renderDefaultNorthPole&&Nn(Te,jt),Qt&&H.renderDefaultSouthPole&&(er=o.a6.mat4.scale(o.a6.mat4.create(),er,[1,-1,1]),Nn(Te,tn))}}}})(x,T,A,F,j);else{const H=x.context,q=H.gl;let Y,Q;const ae=x.shadowRenderer,ge=Oa(x,x.longestCutoffRange),_e=He=>{if(Q===He)return;const Ye=[];Ye.push(Hl[He]),ge.shouldRenderCutoff&&Ye.push("RENDER_CUTOFF"),ae&&(Ye.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&Ye.push("NORMAL_OFFSET")),Y=x.getOrCreateProgram("terrainRaster",{defines:Ye}),Q=He},Te=x.colorModeForRenderPass(),we=new ir(q.LEQUAL,ir.ReadWrite,x.depthRangeFor3D);du.update(j);const ze=x.transform,Ue=_f(ze.zoom,T.exaggeration(),T.sourceCache._source.tileSize);let ke=[0,0,0];if(ae){const He=x.style.directionalLight,Ye=x.style.ambientLight;He&&Ye&&(ke=zu(x.style,He,Ye))}{Q=-1;const He=q.TRIANGLES,[Ye,Ze]=[T.gridIndexBuffer,T.gridSegments];for(const Qe of F){const it=A.getTile(Qe),ft=Pe.disabled,st=T.prevTerrainTileForTile[Qe.key],at=T.terrainTileForTile[Qe.key];qu(st,at)&&du.newMorphing(Qe.key,st,at,j,250),H.activeTexture.set(q.TEXTURE0),it.texture&&it.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE);const Rt=du.getMorphValuesForProxy(Qe.key),$t=Rt?1:0;let sn;Rt&&(sn={morphing:{srcDemTile:Rt.from,dstDemTile:Rt.to,phase:o.cw(Rt.phase)}});const _n=Fs(Qe.projMatrix,Wl(Qe.canonical,ze.renderWorldCopies)?Ue/10:Ue,ke);if(_e($t),!Y)continue;T.setupElevationDraw(it,Y,sn);const yn=Qe.toUnwrapped();ae&&ae.setupShadows(yn,Y),x.uploadCommonUniforms(H,Y,yn,null,ge),Y.draw(x,He,we,ft,Te,Mt.backCCW,_n,"terrain_raster",T.gridBuffer,Ye,Ze)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,x=this.proxySourceCache,T=this.proxiedCoords[x.id],A=this._drapedRenderBatches.shift(),F=l.style.order,j=[];let H=0;for(const q of T){const Y=x.getTileByID(q.proxyTileKey),Q=x.proxyCachedFBO[q.key]?x.proxyCachedFBO[q.key][r]:void 0,ae=Q!==void 0?x.renderCache[Q]:this.pool[H++],ge=Q!==void 0;if(Y.texture=ae.tex,ge&&!ae.dirty){j.push(Y.tileID);continue}let _e;p.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(p.clear({color:o.bA.transparent,stencil:0}),ae.dirty=!1);for(let Te=A.start;Te<=A.end;++Te){const we=l.style._mergedLayers[F[Te]];if(we.isHidden(l.transform.zoom))continue;const ze=l.style.getLayerSourceCache(we),Ue=ze?this.proxyToSource[q.key][ze.id]:[q];if(!Ue)continue;const ke=Ue;p.viewport.set([0,0,ae.fb.width,ae.fb.height]),_e!==(ze?ze.id:null)&&(this._setupStencil(ae,Ue,we,ze),_e=ze?ze.id:null),l.renderLayer(l,ze,we,ke)}if(this._drapedRenderBatches.length===0)for(const Te of this._pendingGroundEffectLayers){const we=l.style._mergedLayers[F[Te]];if(we.isHidden(l.transform.zoom))continue;const ze=l.style.getLayerSourceCache(we),Ue=ze?this.proxyToSource[q.key][ze.id]:[q];if(!Ue)continue;const ke=Ue;p.viewport.set([0,0,ae.fb.width,ae.fb.height]),_e!==(ze?ze.id:null)&&(this._setupStencil(ae,Ue,we,ze),_e=ze?ze.id:null),l.renderLayer(l,ze,we,ke)}this.renderedToTile?(ae.dirty=!0,j.push(Y.tileID)):ge||--H,H===5&&(H=0,this.renderToBackBuffer(j))}return this.renderToBackBuffer(j),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),A.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let p=-1,x=l;for(let T=0;T<l;++T)this._style.isLayerDraped(r._mergedLayers[r.order[T]])?p=Math.max(p,T):x=Math.min(x,T);return x>p}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const A=T.tileID,F=1<<A.overscaledZ,{x:j,y:H}=A.canonical,q=j/F,Y=(j+1)/F,Q=H/F,ae=(H+1)/F;return{minx:q,miny:Q,maxx:Y,maxy:ae,t:T.dem.tree.raycastRoot(q,Q,Y,ae,r,l,p),tile:T}});x.sort((T,A)=>(T.t!==null?T.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const T of x){if(T.t==null)return null;const A=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,r,l,p);if(A!=null)return A}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const x=new o.T(r,{width:p[0],height:p[1],data:null},l.RGBA8);x.bind(l.LINEAR,l.CLAMP_TO_EDGE);const T=r.createFramebuffer(p[0],p[1],!0,null);return T.colorAttachment.set(x.texture),T.depthAttachment=new Ko(r,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:T,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],p=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!p&&l.shouldRedrape():!p&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style.getSources())if(p instanceof br){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const x=this._style._mergedLayers[this._style.order[p]],T=this._style.getLayerSourceCache(x);if(T&&!l[T.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof o.a4){l[T.id]=!0;for(const A of this.proxyCoords){const F=this.proxyToSource[A.key][T.id];if(F)for(const j of F)this._clearRenderCacheForTile(T.id,j)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof oi){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const x=this._style._mergedLayers[this._style.order[p]],T=this._style.getLayerSourceCache(x);if(!T||l[T.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const A=x.paint.get("raster-fade-duration");for(const F of this.proxyCoords){const j=this.proxyToSource[F.key][T.id];if(j)for(const H of j){const q=Zl(T.getTile(H),T.findLoadedParent(H,0),T,this.painter.transform,A);(q.opacity!==1||q.mix!==0)&&this._clearRenderCacheForTile(T.id,H)}}}}_setupDrapedRenderBatches(){const r=this._style.order,l=r.length;if(l===0)return;const p=[];this._pendingGroundEffectLayers=[];let x,T=0,A=this._style._mergedLayers[r[T]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++T<l;)A=this._style._mergedLayers[r[T]];for(;T<l;++T){const F=this._style._mergedLayers[r[T]];F.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(F)?x===void 0&&(x=T):(F.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(T),x!==void 0&&(p.push({start:x,end:T-1}),x=void 0)))}if(x!==void 0&&p.push({start:x,end:T-1}),p.length!==0){const F=p[p.length-1];this._pendingGroundEffectLayers.every(j=>j>F.end)||o.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const A=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let F=0;F<A.length;++F){const j=Object.values(A[F]);l.renderCachePool.push(...j)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,x=this._tilesDirty;for(let A=p.length-1;A>=0;A--){const F=p[A];if(l.getTileByID(F.key),l.proxyCachedFBO[F.key]!==void 0){const j=r[F.key],H=this.proxyToSource[F.key];let q=0;for(const Y in H){const Q=H[Y],ae=j[Y];if(!ae||ae.length!==Q.length||Q.some((ge,_e)=>ge!==ae[_e]||x[Y]&&x[Y].hasOwnProperty(ge.key))){q=-1;break}++q}for(const Y in l.proxyCachedFBO[F.key])l.renderCache[l.proxyCachedFBO[F.key][Y]].dirty=q<0||q!==Object.values(j).length}}const T=[...this._drapedRenderBatches];T.sort((A,F)=>F.end-F.start-(A.end-A.start));for(const A of T)for(const F of p){if(l.proxyCachedFBO[F.key])continue;let j=l.renderCachePool.pop();j===void 0&&l.renderCache.length<50&&(j=l.renderCache.length,l.renderCache.push(this._createFBO())),j!==void 0&&(l.proxyCachedFBO[F.key]={},l.proxyCachedFBO[F.key][A.start]=j,l.renderCache[j].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,A=T.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let F;if(p.isTileClipped())F=l.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);F=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+F>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=F,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):Pe.disabled}_renderTileClippingMasks(r,l){const p=this.painter,x=this.painter.context,T=x.gl;p._tileClippingMaskIDs={},x.setColorMode(Sr.disabled),x.setDepthMode(ir.disabled);const A=p.getOrCreateProgram("clippingMask");for(const F of r){const j=p._tileClippingMaskIDs[F.key]=--l;A.draw(p,T.TRIANGLES,ir.disabled,new Pe({func:T.ALWAYS,mask:0},j,255,T.KEEP,T.KEEP,T.REPLACE),Sr.disabled,Mt.disabled,Ts(F.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];o.a6.vec4.transformMat4(p,p,l.pixelMatrixInverse),o.a6.vec4.scale(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const x=l._camera.position,T=o.bE(1,l.center.lat),A=[x[0],x[1],x[2]/T,0],F=o.a6.vec3.subtract([],p.slice(0,3),A);o.a6.vec3.normalize(F,F);const j=this.raycast(A,F,this._exaggeration);return j!==null&&j?(o.a6.vec3.scaleAndAdd(A,A,F,j),A[3]=A[2],A[2]*=T,A):null}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof o.aD)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const x=this.proxiedCoords[r.id]=[],T=this.proxyCoords;for(let j=0;j<T.length;j++){const H=T[j],q=this._findTileCoveringTileID(H,r);if(q){const Y=this._createProxiedId(H,q,p[H.key]&&p[H.key][r.id]);x.push(Y),this.proxyToSource[H.key][r.id]=[Y]}}let A=!1;const F=new Set;for(let j=0;j<l.length;j++){const H=r.getTile(l[j]);if(!H||!H.hasData())continue;const q=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(q&&q.tileID.canonical.z!==H.tileID.canonical.z){const Y=this.proxyToSource[q.tileID.key][r.id],Q=this._createProxiedId(q.tileID,H,p[q.tileID.key]&&p[q.tileID.key][r.id]);Y?Y.splice(Y.length-1,0,Q):this.proxyToSource[q.tileID.key][r.id]=[Q];const ae=this.proxyToSource[q.tileID.key][r.id];F.has(ae)||F.add(ae),x.push(Q),A=!0}}if(this._sourceTilesOverlap[r.id]=A,A&&this._debugParams.sortTilesHiZFirst)for(const j of F)j.sort((H,q)=>q.overscaledZ-H.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const x=this.proxiedCoords[r.id]=[],T=this.proxyCoords,A=r.getSource(),F=A.tileID;if(!F)return;const j=new o.P(F.x,F.y)._div(1<<F.z),H=A.coordinates.map(o.a5.fromLngLat).reduce((Y,Q)=>(Y.min.x=Math.min(Y.min.x,Q.x-j.x),Y.min.y=Math.min(Y.min.y,Q.y-j.y),Y.max.x=Math.max(Y.max.x,Q.x-j.x),Y.max.y=Math.max(Y.max.y,Q.y-j.y),Y),{min:new o.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),q=(Y,Q)=>{const ae=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),ge=Y.canonical.y/(1<<Y.canonical.z),_e=o.ab/(1<<Y.canonical.z),Te=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),we=Q.canonical.y/(1<<Q.canonical.z);return ae+_e<Te+H.min.x||ae>Te+H.max.x||ge+_e<we+H.min.y||ge>we+H.max.y};for(let Y=0;Y<T.length;Y++){const Q=T[Y];for(let ae=0;ae<l.length;ae++){const ge=r.getTile(l[ae]);if(!ge||!ge.hasData()||q(Q,ge.tileID))continue;const _e=this._createProxiedId(Q,ge,p[Q.key]&&p[Q.key][r.id]),Te=this.proxyToSource[Q.key][r.id];Te?Te.push(_e):this.proxyToSource[Q.key][r.id]=[_e],x.push(_e)}}}_createProxiedId(r,l,p){let x=this.orthoMatrix;if(p){const T=p.find(A=>A.key===l.tileID.key);if(T)return T}if(l.tileID.key!==r.key){const T=r.canonical.z-l.tileID.canonical.z;let A,F,j;x=o.a6.mat4.create();const H=l.tileID.wrap-r.wrap<<r.overscaledZ;T>0?(A=o.ab>>T,F=A*((l.tileID.canonical.x<<T)-r.canonical.x+H),j=A*((l.tileID.canonical.y<<T)-r.canonical.y)):(A=o.ab<<-T,F=o.ab*(l.tileID.canonical.x-(r.canonical.x+H<<-T)),j=o.ab*(l.tileID.canonical.y-(r.canonical.y<<-T))),o.a6.mat4.ortho(x,0,A,0,A,0,1),o.a6.mat4.translate(x,x,[F,j,0])}return new yf(l.tileID,r.key,x)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const x=this._findCoveringTileCache[l.id],T=x[r.key];if(p=T?l.getTileByID(T):null,p&&p.hasData()||T===null)return p;let A=p?p.tileID:r,F=A.overscaledZ;const j=l.getSource().minzoom,H=[];if(!T){const Y=l.getSource().maxzoom;if(r.canonical.z>=Y){const Q=r.canonical.z-Y;l.getSource().reparseOverscaled?(F=Math.max(r.canonical.z+2,l.transform.tileZoom),A=new o.aA(F,r.wrap,Y,r.canonical.x>>Q,r.canonical.y>>Q)):Q!==0&&(F=Y,A=new o.aA(F,r.wrap,Y,r.canonical.x>>Q,r.canonical.y>>Q))}A.key!==r.key&&(H.push(A.key),p=l.getTile(A))}const q=Y=>{H.forEach(Q=>{x[Q]=Y}),H.length=0};for(F-=1;F>=j&&(!p||!p.hasData());F--){p&&q(p.tileID.key);const Y=A.calculateScaledKey(F);if(p=l.getTileByID(Y),p&&p.hasData())break;const Q=x[Y];if(Q===null)break;Q===void 0?H.push(Y):p=l.getTileByID(Q)}return q(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}}function Xl(d,r,l){const p=function(F,j,H){const q=o.a6.vec3.dot(j,F),Y=o.a6.vec3.dot(H,[.2126,.7152,.0722]),Q=(ge,_e,Te)=>(1-Te)*ge+Te*_e,ae=Q(1-.3*Math.min(Y,1),1,Math.min(q+1,1));return Q(.92,1,Math.asin(o.ap(j[2],-1,1))/Math.PI+.5)*ae}(d,[0,0,1],r),x=[0,0,0];o.a6.vec3.scale(x,l.slice(0,3),p);const T=[0,0,0];o.a6.vec3.scale(T,r.slice(0,3),d[2]);const A=[0,0,0];return o.a6.vec3.add(A,x,T),o.cc(A)}const Bs=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],pu=["stars","rain_particle","snow_particle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class tl{static cacheKey(r,l,p,x){let T=`${l}${x?x.cacheKey:""}`;for(const A of p)r.usedDefines.includes(A)&&(T+=`/${A}`);return T}constructor(r,l,p,x,T,A){const F=r.gl;this.program=F.createProgram(),this.configuration=x,this.name=l,this.fixedDefines=[...A];const j=x?x.getBinderAttributes():[],H=(p.staticAttributes||[]).concat(j);let q=x?x.defines():[];q=q.concat(A.map(Te=>`#define ${Te}`));const Y=`#version 300 es
`;let Q=Y+q.concat("precision mediump float;",ju,Ss.fragmentSource).join(`
`);for(const Te of p.fragmentIncludes)Q+=`
${Nu[Te]}`;Q+=`
${p.fragmentSource}`;let ae=Y+q.concat("precision highp float;",ju,Ss.vertexSource).join(`
`);for(const Te of p.vertexIncludes)ae+=`
${Nu[Te]}`;ae+=`
${p.vertexSource}`;const ge=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);F.shaderSource(ge,Q),F.compileShader(ge),F.attachShader(this.program,ge);const _e=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())this.failedToCreate=!0;else{F.shaderSource(_e,ae),F.compileShader(_e),F.attachShader(this.program,_e),this.attributes={},this.numAttributes=H.length;for(let Te=0;Te<this.numAttributes;Te++)if(H[Te]){const we=H[Te].startsWith("a_")?H[Te]:`a_${H[Te]}`;F.bindAttribLocation(this.program,Te,we),this.attributes[we]=Te}F.linkProgram(this.program),F.deleteShader(_e),F.deleteShader(ge),this.fixedUniforms=T(r),this.binderUniforms=x?x.getUniforms(r):[],(A.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(Te=>({u_dem:new o.bK(Te),u_dem_prev:new o.bK(Te),u_dem_tl:new o.bH(Te),u_dem_scale:new o.bJ(Te),u_dem_tl_prev:new o.bH(Te),u_dem_scale_prev:new o.bJ(Te),u_dem_size:new o.bJ(Te),u_dem_lerp:new o.bJ(Te),u_exaggeration:new o.bJ(Te),u_depth:new o.bK(Te),u_depth_size_inv:new o.bH(Te),u_depth_range_unpack:new o.bH(Te),u_occluder_half_size:new o.bJ(Te),u_occlusion_depth_offset:new o.bJ(Te),u_meter_to_dem:new o.bJ(Te),u_label_plane_matrix_inv:new o.bG(Te)}))(r)),A.includes("GLOBE")&&(this.globeUniforms=(Te=>({u_tile_tl_up:new o.bI(Te),u_tile_tr_up:new o.bI(Te),u_tile_br_up:new o.bI(Te),u_tile_bl_up:new o.bI(Te),u_tile_up_scale:new o.bJ(Te)}))(r)),A.includes("FOG")&&(this.fogUniforms=(Te=>({u_fog_matrix:new o.bG(Te),u_fog_range:new o.bH(Te),u_fog_color:new o.c7(Te),u_fog_horizon_blend:new o.bJ(Te),u_fog_vertical_limit:new o.bH(Te),u_fog_temporal_offset:new o.bJ(Te),u_frustum_tl:new o.bI(Te),u_frustum_tr:new o.bI(Te),u_frustum_br:new o.bI(Te),u_frustum_bl:new o.bI(Te),u_globe_pos:new o.bI(Te),u_globe_radius:new o.bJ(Te),u_globe_transition:new o.bJ(Te),u_is_globe:new o.bK(Te),u_viewport:new o.bH(Te)}))(r)),A.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Te=>({u_cutoff_params:new o.c7(Te)}))(r)),A.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Te=>({u_lighting_ambient_color:new o.bI(Te),u_lighting_directional_dir:new o.bI(Te),u_lighting_directional_color:new o.bI(Te),u_ground_radiance:new o.bI(Te)}))(r)),A.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Te=>({u_light_matrix_0:new o.bG(Te),u_light_matrix_1:new o.bG(Te),u_fade_range:new o.bH(Te),u_shadow_normal_offset:new o.bI(Te),u_shadow_intensity:new o.bJ(Te),u_shadow_texel_size:new o.bJ(Te),u_shadow_map_resolution:new o.bJ(Te),u_shadow_direction:new o.bI(Te),u_shadow_bias:new o.bI(Te),u_shadowmap_0:new o.bK(Te),u_shadowmap_1:new o.bK(Te)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)p[x]&&p[x].set(this.program,x,l[x])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)p[x]&&p[x].set(this.program,x,l[x])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)p[x].set(this.program,x,l[x])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)p[x].set(this.program,x,l[x])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const x in l)p[x].set(this.program,x,l[x])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;r.program.set(this.program);for(const x in l)p[x].set(this.program,x,l[x])}_drawDebugWireframe(r,l,p,x,T,A,F,j,H,q){const Y=r.options.wireframe;if(Y.terrain===!1&&Y.layers2D===!1&&Y.layers3D===!1)return;const Q=r.context;if(!(!(!Y.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Y.layers2D||r._terrain&&r._terrain.renderingToTexture||!Bs.includes(this.name))||!(!Y.layers3D||!pu.includes(this.name))))return;const ae=Q.gl,ge=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,T,Q);if(!ge)return;const _e=[...this.fixedDefines];_e.push("DEBUG_WIREFRAME");const Te=r.getOrCreateProgram(this.name,{config:this.configuration,defines:_e});Q.program.set(Te.program);const we=(ke,He,Ye)=>{if(He[ke]&&Ye[ke])for(const Ze in He[ke])Ye[ke][Ze]&&Ye[ke][Ze].set(Ye.program,Ze,He[ke][Ze].current)};H&&H.setUniforms(Te.program,Q,Te.binderUniforms,F,{zoom:j}),we("fixedUniforms",this,Te),we("terrainUniforms",this,Te),we("globeUniforms",this,Te),we("fogUniforms",this,Te),we("lightsUniforms",this,Te),we("shadowUniforms",this,Te),ge.bind(),Q.setColorMode(new Sr([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],o.bA.transparent,[!0,!0,!0,!1])),Q.setDepthMode(new ir(l.func===ae.LESS?ae.LEQUAL:l.func,ir.ReadOnly,l.range)),Q.setStencilMode(Pe.disabled);const ze=3*A.primitiveLength*2,Ue=3*A.primitiveOffset*2*2;q&&q>1?ae.drawElementsInstanced(ae.LINES,ze,ae.UNSIGNED_SHORT,Ue,q):ae.drawElements(ae.LINES,ze,ae.UNSIGNED_SHORT,Ue),T.bind(),Q.program.set(this.program),Q.setDepthMode(l),Q.setStencilMode(p),Q.setColorMode(x)}checkUniforms(r,l,p){if(this.fixedDefines.includes(l)){for(const x of Object.keys(p))if(!p[x].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${x} not set but required by ${l} being defined`)}}draw(r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te){const we=r.context,ze=we.gl;if(this.failedToCreate)return;we.program.set(this.program),we.setDepthMode(p),we.setStencilMode(x),we.setColorMode(T),we.setCullFace(A);for(const He of Object.keys(this.fixedUniforms))this.fixedUniforms[He].set(this.program,He,F[He]);ge&&ge.setUniforms(this.program,we,this.binderUniforms,Q,{zoom:ae});const Ue={[ze.POINTS]:1,[ze.LINES]:2,[ze.TRIANGLES]:3,[ze.LINE_STRIP]:1}[l];this.checkUniforms(j,"RENDER_SHADOWS",this.shadowUniforms);const ke=Te&&Te>0?1:void 0;for(const He of Y.get()){const Ye=He.vaos||(He.vaos={});(Ye[j]||(Ye[j]=new Gl)).bind(we,this,H,ge?ge.getPaintVertexBuffers():[],q,He.vertexOffset,_e||[],ke),Te&&Te>1?ze.drawElementsInstanced(l,He.primitiveLength*Ue,ze.UNSIGNED_SHORT,He.primitiveOffset*Ue*2,Te):q?ze.drawElements(l,He.primitiveLength*Ue,ze.UNSIGNED_SHORT,He.primitiveOffset*Ue*2):ze.drawArrays(l,He.vertexOffset,He.vertexLength),l===ze.TRIANGLES&&q&&this._drawDebugWireframe(r,p,x,T,q,He,Q,ae,ge,Te)}}}function jh(d,r){const l=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,d.transform.tileZoom)/l,x=p*(r.tileID.canonical.x+r.tileID.wrap*l),T=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/o.ak(r,1,d.transform.tileZoom),u_pixel_coord_upper:[x>>16,T>>16],u_pixel_coord_lower:[65535&x,65535&T]}}const El={terrain:0,flat:1},Hu=o.a6.mat4.create(),Do=(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we)=>{const ze=r.style.light,Ue=ze.properties.get("position"),ke=[Ue.x,Ue.y,Ue.z],He=o.a6.mat3.create();ze.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(He,-r.transform.angle),o.a6.vec3.transformMat3(ke,ke,He));const Ye=ze.properties.get("color"),Ze=r.transform,Qe={u_matrix:d,u_lightpos:ke,u_lightintensity:ze.properties.get("intensity"),u_lightcolor:[Ye.r,Ye.g,Ye.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Hu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:El[H],u_base_type:El[q],u_ao:x,u_edge_radius:T,u_width_scale:A,u_flood_light_color:ge,u_vertical_scale:_e,u_flood_light_intensity:Te,u_ground_shadow_factor:we};return Ze.projection.name==="globe"&&(Qe.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],Qe.u_zoom_transition=Y,Qe.u_inv_rot_matrix=ae,Qe.u_merc_center=Q,Qe.u_up_dir=Ze.projection.upVector(new o.bQ(0,0,0),Q[0]*o.ab,Q[1]*o.ab),Qe.u_height_lift=j),Qe},Io=(d,r,l,p,x,T)=>({u_matrix:d,u_edge_radius:r,u_width_scale:l,u_vertical_scale:p,u_height_type:El[x],u_base_type:El[T]}),mu=(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te)=>{const we=Do(d,r,l,p,x,T,A,F,H,q,Y,Q,ae,ge,_e,Te,1,[0,0,0]),ze={u_height_factor:-Math.pow(2,F.overscaledZ)/j.tileSize/8};return o.l(we,jh(r,j),ze)},ds=(d,r)=>({u_matrix:d,u_emissive_strength:r}),Es=(d,r,l,p)=>o.l(ds(d,r),jh(l,p)),Kl=(d,r,l)=>({u_matrix:d,u_world:l,u_emissive_strength:r}),$h=(d,r,l,p,x)=>o.l(Es(d,r,l,p),{u_world:x}),nl=(d,r,l,p)=>{const x=o.ab/l.tileSize;return{u_matrix:d,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/x,r.pixelsToGLUnits[1]/x]}},Uh=(d,r,l=1)=>({u_matrix:d,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),sm=o.a6.mat4.create(),sd=(d,r,l,p,x,T,A)=>{const F=d.transform,j=F.projection.name==="globe",H=j?o.cI(F.zoom,r.canonical)*F._pixelsPerMercatorPixel:o.ak(l,1,T),q={u_matrix:r.projMatrix,u_extrude_scale:H,u_intensity:A,u_inv_rot_matrix:sm,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(j){q.u_inv_rot_matrix=p,q.u_merc_center=x,q.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],q.u_zoom_transition=o.a9(F.zoom);const Y=x[0]*o.ab,Q=x[1]*o.ab;q.u_up_dir=F.projection.upVector(new o.bQ(0,0,0),Y,Q)}return q};function ah(d,[r,l,p,x],[T,A]){if(T===A)return[0,0,0,0];const F=255*(d-1)/(d*(A-T));return[r*F,l*F,p*F,x*F]}function sh(d,r,[l,p]){return l===p?0:.5/d+(r-l)*(d-1)/(d*(p-l))}const Al=(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we,ze,Ue,ke)=>({u_matrix:d,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:x,u_tl_parent:T,u_scale_parent:H,u_fade_t:q.mix,u_opacity:q.opacity*Y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Y.paint.get("raster-brightness-min"),u_brightness_high:Y.paint.get("raster-brightness-max"),u_saturation_factor:o.cJ(Y.paint.get("raster-saturation")),u_contrast_factor:o.cK(Y.paint.get("raster-contrast")),u_spin_weights:yc(Y.paint.get("raster-hue-rotate")),u_perspective_transform:Q,u_raster_elevation:ae,u_zoom_transition:A,u_merc_center:F,u_cutoff_params:j,u_colorization_mix:ah(o.cL,_e,we),u_colorization_offset:sh(o.cL,Te,we),u_color_ramp:ge,u_texture_offset:[Ue/(ze+2*Ue),ze/(ze+2*Ue)],u_texture_res:[ze+2*Ue,ze+2*Ue],u_emissive_strength:ke});function yc(d){d*=Math.PI/180;const r=Math.sin(d),l=Math.cos(d);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Wu=.05,xf=(d,r,l,p,x,T,A,F,j,H,q,Y)=>({u_matrix:d,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:x,u_tl_parent:T,u_scale_parent:H,u_fade_t:q.mix,u_opacity:q.opacity,u_image0:0,u_image1:1,u_raster_elevation:Y,u_zoom_transition:A,u_merc_center:F,u_cutoff_params:j}),ld=(d,r,l,p,x,T,A,F,j,H)=>({u_particle_texture:d,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:p,u_color_ramp:T,u_velocity_res:x,u_max_speed:A,u_uv_offset:F,u_data_scale:[255*j[0],255*j[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[Wu,Wu]}),gu=(d,r,l,p,x,T,A,F,j,H)=>({u_particle_texture:d,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:p,u_max_speed:x,u_speed_factor:T,u_reset_rate:A,u_rand_seed:Math.random(),u_uv_offset:F,u_data_scale:[255*j[0],255*j[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[Wu,Wu]}),vc=o.a6.mat4.create(),lh=(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we,ze,Ue,ke,He)=>{const Ye=x.transform,Ze={u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Ye.getCameraToCenterDistance(ze),u_rotate_symbol:+l,u_aspect_ratio:Ye.width/Ye.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:A,u_coord_matrix:F,u_is_text:+H,u_elevation_from_sea:j?1:0,u_pitch_with_map:+p,u_texsize:q,u_texsize_icon:Y,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:vc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:vc,u_up_vector:[0,-1,0],u_color_adj_mat:Ue,u_icon_transition:ke||0,u_gamma_scale:p?x.transform.getCameraToCenterDistance(ze)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:o.q.devicePixelRatio,u_is_halo:+Q,u_scale_factor:He||1};return ze.name==="globe"&&(Ze.u_tile_id=[ae.canonical.x,ae.canonical.y,1<<ae.canonical.z],Ze.u_zoom_transition=ge,Ze.u_inv_rot_matrix=Te,Ze.u_merc_center=_e,Ze.u_camera_forward=Ye._camera.forward(),Ze.u_ecef_origin=o.cM(Ye.globeMatrix,ae.toUnwrapped()),Ze.u_tile_matrix=Float32Array.from(Ye.globeMatrix),Ze.u_up_vector=we),Ze},_u=(d,r,l,p)=>({u_matrix:d,u_emissive_strength:r,u_opacity:l,u_color:p}),xc=(d,r,l,p,x,T,A,F,j)=>o.l(function(H,q,Y,Q,ae,ge){const{width:_e,height:Te}=Q.imageManager.getPixelSize(q),we=Math.pow(2,ge.tileID.overscaledZ),ze=ge.tileSize*Math.pow(2,Q.transform.tileZoom)/we,Ue=ze*(ge.tileID.canonical.x+ge.tileID.wrap*we),ke=ze*ge.tileID.canonical.y;return{u_image:0,u_pattern_tl:Y.tl,u_pattern_br:Y.br,u_texsize:[_e,Te],u_pattern_size:Y.displaySize,u_pattern_units_to_pixels:ae?[Q.transform.width,-1*Q.transform.height]:[1/o.ak(ge,1,Q.transform.tileZoom),1/o.ak(ge,1,Q.transform.tileZoom)],u_pixel_coord_upper:[Ue>>16,ke>>16],u_pixel_coord_lower:[65535&Ue,65535&ke]}}(0,T,A,p,F,j),{u_matrix:d,u_emissive_strength:r,u_opacity:l}),kn=new Float32Array(o.a6.mat4.identity([])),Ns=(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae=[0,0,0],ge)=>{const _e=x.style.light,Te=_e.properties.get("position"),we=[-Te.x,-Te.y,Te.z],ze=o.a6.mat3.create();_e.properties.get("anchor")==="viewport"&&(o.a6.mat3.fromRotation(ze,-x.transform.angle),o.a6.vec3.transformMat3(we,we,ze));const Ue=q.alphaMode==="MASK",ke=_e.properties.get("color").toRenderColor(null),He=Q.paint.get("model-ambient-occlusion-intensity"),Ye=Q.paint.get("model-color").constantOr(o.bA.white).toRenderColor(null),Ze=Q.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:d,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:p||kn,u_lightpos:we,u_lightintensity:_e.properties.get("intensity"),u_lightcolor:[ke.r,ke.g,ke.b],u_camera_pos:ae,u_opacity:T,u_baseTextureIsAlpha:0,u_alphaMask:+Ue,u_alphaCutoff:q.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[F[0],F[1],F[2],1],u_metallicFactor:j,u_roughnessFactor:H,u_baseColorTexture:Or.BaseColor,u_metallicRoughnessTexture:Or.MetallicRoughness,u_normalTexture:Or.Normal,u_occlusionTexture:Or.Occlusion,u_emissionTexture:Or.Emission,u_lutTexture:Or.LUT,u_color_mix:[Ye.r,Ye.g,Ye.b,Ze],u_aoIntensity:He,u_emissive_strength:Y,u_occlusionTextureTransform:ge||[0,0,0,0]}},Zu=(d,r=kn,l=kn)=>({u_matrix:d,u_instance:r,u_node_matrix:l}),js={fillExtrusion:d=>({u_matrix:new o.bG(d),u_lightpos:new o.bI(d),u_lightintensity:new o.bJ(d),u_lightcolor:new o.bI(d),u_vertical_gradient:new o.bJ(d),u_opacity:new o.bJ(d),u_edge_radius:new o.bJ(d),u_width_scale:new o.bJ(d),u_ao:new o.bH(d),u_height_type:new o.bK(d),u_base_type:new o.bK(d),u_tile_id:new o.bI(d),u_zoom_transition:new o.bJ(d),u_inv_rot_matrix:new o.bG(d),u_merc_center:new o.bH(d),u_up_dir:new o.bI(d),u_height_lift:new o.bJ(d),u_flood_light_color:new o.bI(d),u_vertical_scale:new o.bJ(d),u_flood_light_intensity:new o.bJ(d),u_ground_shadow_factor:new o.bI(d)}),fillExtrusionDepth:d=>({u_matrix:new o.bG(d),u_edge_radius:new o.bJ(d),u_width_scale:new o.bJ(d),u_vertical_scale:new o.bJ(d),u_height_type:new o.bK(d),u_base_type:new o.bK(d)}),fillExtrusionPattern:d=>({u_matrix:new o.bG(d),u_lightpos:new o.bI(d),u_lightintensity:new o.bJ(d),u_lightcolor:new o.bI(d),u_vertical_gradient:new o.bJ(d),u_height_factor:new o.bJ(d),u_edge_radius:new o.bJ(d),u_width_scale:new o.bJ(d),u_ao:new o.bH(d),u_height_type:new o.bK(d),u_base_type:new o.bK(d),u_tile_id:new o.bI(d),u_zoom_transition:new o.bJ(d),u_inv_rot_matrix:new o.bG(d),u_merc_center:new o.bH(d),u_up_dir:new o.bI(d),u_height_lift:new o.bJ(d),u_image:new o.bK(d),u_texsize:new o.bH(d),u_pixel_coord_upper:new o.bH(d),u_pixel_coord_lower:new o.bH(d),u_tile_units_to_pixels:new o.bJ(d),u_opacity:new o.bJ(d)}),fillExtrusionGroundEffect:d=>({u_matrix:new o.bG(d),u_opacity:new o.bJ(d),u_ao_pass:new o.bJ(d),u_meter_to_tile:new o.bJ(d),u_ao:new o.bH(d),u_flood_light_intensity:new o.bJ(d),u_flood_light_color:new o.bI(d),u_attenuation:new o.bJ(d),u_edge_radius:new o.bJ(d),u_fb:new o.bK(d),u_fb_size:new o.bJ(d),u_dynamic_offset:new o.bJ(d)}),fill:d=>({u_matrix:new o.bG(d),u_emissive_strength:new o.bJ(d)}),fillPattern:d=>({u_matrix:new o.bG(d),u_emissive_strength:new o.bJ(d),u_image:new o.bK(d),u_texsize:new o.bH(d),u_pixel_coord_upper:new o.bH(d),u_pixel_coord_lower:new o.bH(d),u_tile_units_to_pixels:new o.bJ(d)}),fillOutline:d=>({u_matrix:new o.bG(d),u_emissive_strength:new o.bJ(d),u_world:new o.bH(d)}),fillOutlinePattern:d=>({u_matrix:new o.bG(d),u_emissive_strength:new o.bJ(d),u_world:new o.bH(d),u_image:new o.bK(d),u_texsize:new o.bH(d),u_pixel_coord_upper:new o.bH(d),u_pixel_coord_lower:new o.bH(d),u_tile_units_to_pixels:new o.bJ(d)}),circle:o.cN,collisionBox:d=>({u_matrix:new o.bG(d),u_camera_to_center_distance:new o.bJ(d),u_extrude_scale:new o.bH(d)}),collisionCircle:d=>({u_matrix:new o.bG(d),u_inv_matrix:new o.bG(d),u_camera_to_center_distance:new o.bJ(d),u_viewport_size:new o.bH(d)}),debug:d=>({u_color:new o.cu(d),u_matrix:new o.bG(d),u_overlay:new o.bK(d),u_overlay_scale:new o.bJ(d)}),clippingMask:d=>({u_matrix:new o.bG(d)}),heatmap:d=>({u_extrude_scale:new o.bJ(d),u_intensity:new o.bJ(d),u_matrix:new o.bG(d),u_inv_rot_matrix:new o.bG(d),u_merc_center:new o.bH(d),u_tile_id:new o.bI(d),u_zoom_transition:new o.bJ(d),u_up_dir:new o.bI(d)}),heatmapTexture:d=>({u_image:new o.bK(d),u_color_ramp:new o.bK(d),u_opacity:new o.bJ(d)}),hillshade:d=>({u_matrix:new o.bG(d),u_image:new o.bK(d),u_latrange:new o.bH(d),u_light:new o.bH(d),u_shadow:new o.cu(d),u_highlight:new o.cu(d),u_emissive_strength:new o.bJ(d),u_accent:new o.cu(d)}),hillshadePrepare:d=>({u_matrix:new o.bG(d),u_image:new o.bK(d),u_dimension:new o.bH(d),u_zoom:new o.bJ(d)}),line:o.cO,linePattern:o.cP,raster:d=>({u_matrix:new o.bG(d),u_normalize_matrix:new o.bG(d),u_globe_matrix:new o.bG(d),u_merc_matrix:new o.bG(d),u_grid_matrix:new o.cv(d),u_tl_parent:new o.bH(d),u_scale_parent:new o.bJ(d),u_fade_t:new o.bJ(d),u_opacity:new o.bJ(d),u_image0:new o.bK(d),u_image1:new o.bK(d),u_brightness_low:new o.bJ(d),u_brightness_high:new o.bJ(d),u_saturation_factor:new o.bJ(d),u_contrast_factor:new o.bJ(d),u_spin_weights:new o.bI(d),u_perspective_transform:new o.bH(d),u_raster_elevation:new o.bJ(d),u_zoom_transition:new o.bJ(d),u_merc_center:new o.bH(d),u_cutoff_params:new o.c7(d),u_colorization_mix:new o.c7(d),u_colorization_offset:new o.bJ(d),u_color_ramp:new o.bK(d),u_texture_offset:new o.bH(d),u_texture_res:new o.bH(d),u_emissive_strength:new o.bJ(d)}),rasterParticle:d=>({u_matrix:new o.bG(d),u_normalize_matrix:new o.bG(d),u_globe_matrix:new o.bG(d),u_merc_matrix:new o.bG(d),u_grid_matrix:new o.cv(d),u_tl_parent:new o.bH(d),u_scale_parent:new o.bJ(d),u_fade_t:new o.bJ(d),u_opacity:new o.bJ(d),u_image0:new o.bK(d),u_image1:new o.bK(d),u_raster_elevation:new o.bJ(d),u_zoom_transition:new o.bJ(d),u_merc_center:new o.bH(d),u_cutoff_params:new o.c7(d)}),rasterParticleTexture:d=>({u_texture:new o.bK(d),u_opacity:new o.bJ(d)}),rasterParticleDraw:d=>({u_particle_texture:new o.bK(d),u_particle_texture_side_len:new o.bJ(d),u_tile_offset:new o.bH(d),u_velocity:new o.bK(d),u_color_ramp:new o.bK(d),u_velocity_res:new o.bH(d),u_max_speed:new o.bJ(d),u_uv_offset:new o.bH(d),u_data_scale:new o.bH(d),u_data_offset:new o.bJ(d),u_particle_pos_scale:new o.bJ(d),u_particle_pos_offset:new o.bH(d)}),rasterParticleUpdate:d=>({u_particle_texture:new o.bK(d),u_particle_texture_side_len:new o.bJ(d),u_velocity:new o.bK(d),u_velocity_res:new o.bH(d),u_max_speed:new o.bJ(d),u_speed_factor:new o.bJ(d),u_reset_rate:new o.bJ(d),u_rand_seed:new o.bJ(d),u_uv_offset:new o.bH(d),u_data_scale:new o.bH(d),u_data_offset:new o.bJ(d),u_particle_pos_scale:new o.bJ(d),u_particle_pos_offset:new o.bH(d)}),symbol:d=>({u_is_size_zoom_constant:new o.bK(d),u_is_size_feature_constant:new o.bK(d),u_size_t:new o.bJ(d),u_size:new o.bJ(d),u_camera_to_center_distance:new o.bJ(d),u_rotate_symbol:new o.bK(d),u_aspect_ratio:new o.bJ(d),u_fade_change:new o.bJ(d),u_matrix:new o.bG(d),u_label_plane_matrix:new o.bG(d),u_coord_matrix:new o.bG(d),u_is_text:new o.bK(d),u_elevation_from_sea:new o.bK(d),u_pitch_with_map:new o.bK(d),u_texsize:new o.bH(d),u_texsize_icon:new o.bH(d),u_texture:new o.bK(d),u_texture_icon:new o.bK(d),u_gamma_scale:new o.bJ(d),u_device_pixel_ratio:new o.bJ(d),u_tile_id:new o.bI(d),u_zoom_transition:new o.bJ(d),u_inv_rot_matrix:new o.bG(d),u_merc_center:new o.bH(d),u_camera_forward:new o.bI(d),u_tile_matrix:new o.bG(d),u_up_vector:new o.bI(d),u_ecef_origin:new o.bI(d),u_is_halo:new o.bK(d),u_icon_transition:new o.bJ(d),u_color_adj_mat:new o.bG(d),u_scale_factor:new o.bJ(d)}),background:d=>({u_matrix:new o.bG(d),u_emissive_strength:new o.bJ(d),u_opacity:new o.bJ(d),u_color:new o.cu(d)}),backgroundPattern:d=>({u_matrix:new o.bG(d),u_emissive_strength:new o.bJ(d),u_opacity:new o.bJ(d),u_image:new o.bK(d),u_pattern_tl:new o.bH(d),u_pattern_br:new o.bH(d),u_texsize:new o.bH(d),u_pattern_size:new o.bH(d),u_pixel_coord_upper:new o.bH(d),u_pixel_coord_lower:new o.bH(d),u_pattern_units_to_pixels:new o.bH(d)}),terrainRaster:d=>({u_matrix:new o.bG(d),u_image0:new o.bK(d),u_skirt_height:new o.bJ(d),u_ground_shadow_factor:new o.bI(d)}),skybox:d=>({u_matrix:new o.bG(d),u_sun_direction:new o.bI(d),u_cubemap:new o.bK(d),u_opacity:new o.bJ(d),u_temporal_offset:new o.bJ(d)}),skyboxGradient:d=>({u_matrix:new o.bG(d),u_color_ramp:new o.bK(d),u_center_direction:new o.bI(d),u_radius:new o.bJ(d),u_opacity:new o.bJ(d),u_temporal_offset:new o.bJ(d)}),skyboxCapture:d=>({u_matrix_3f:new o.cv(d),u_sun_direction:new o.bI(d),u_sun_intensity:new o.bJ(d),u_color_tint_r:new o.c7(d),u_color_tint_m:new o.c7(d),u_luminance:new o.bJ(d)}),globeRaster:d=>({u_proj_matrix:new o.bG(d),u_globe_matrix:new o.bG(d),u_normalize_matrix:new o.bG(d),u_merc_matrix:new o.bG(d),u_zoom_transition:new o.bJ(d),u_merc_center:new o.bH(d),u_image0:new o.bK(d),u_grid_matrix:new o.cv(d),u_skirt_height:new o.bJ(d),u_far_z_cutoff:new o.bJ(d),u_frustum_tl:new o.bI(d),u_frustum_tr:new o.bI(d),u_frustum_br:new o.bI(d),u_frustum_bl:new o.bI(d),u_globe_pos:new o.bI(d),u_globe_radius:new o.bJ(d),u_viewport:new o.bH(d)}),globeAtmosphere:d=>({u_frustum_tl:new o.bI(d),u_frustum_tr:new o.bI(d),u_frustum_br:new o.bI(d),u_frustum_bl:new o.bI(d),u_horizon:new o.bJ(d),u_transition:new o.bJ(d),u_fadeout_range:new o.bJ(d),u_color:new o.c7(d),u_high_color:new o.c7(d),u_space_color:new o.c7(d),u_temporal_offset:new o.bJ(d),u_horizon_angle:new o.bJ(d)}),model:d=>({u_matrix:new o.bG(d),u_lighting_matrix:new o.bG(d),u_normal_matrix:new o.bG(d),u_node_matrix:new o.bG(d),u_lightpos:new o.bI(d),u_lightintensity:new o.bJ(d),u_lightcolor:new o.bI(d),u_camera_pos:new o.bI(d),u_opacity:new o.bJ(d),u_baseColorFactor:new o.c7(d),u_emissiveFactor:new o.c7(d),u_metallicFactor:new o.bJ(d),u_roughnessFactor:new o.bJ(d),u_baseTextureIsAlpha:new o.bK(d),u_alphaMask:new o.bK(d),u_alphaCutoff:new o.bJ(d),u_baseColorTexture:new o.bK(d),u_metallicRoughnessTexture:new o.bK(d),u_normalTexture:new o.bK(d),u_occlusionTexture:new o.bK(d),u_emissionTexture:new o.bK(d),u_lutTexture:new o.bK(d),u_color_mix:new o.c7(d),u_aoIntensity:new o.bJ(d),u_emissive_strength:new o.bJ(d),u_occlusionTextureTransform:new o.c7(d)}),modelDepth:d=>({u_matrix:new o.bG(d),u_instance:new o.bG(d),u_node_matrix:new o.bG(d)}),groundShadow:d=>({u_matrix:new o.bG(d),u_ground_shadow_factor:new o.bI(d)}),stars:d=>({u_matrix:new o.bG(d),u_up:new o.bI(d),u_right:new o.bI(d),u_intensity_multiplier:new o.bJ(d)}),snowParticle:d=>({u_modelview:new o.bG(d),u_projection:new o.bG(d),u_time:new o.bJ(d),u_cam_pos:new o.bI(d),u_velocityConeAperture:new o.bJ(d),u_velocity:new o.bJ(d),u_horizontalOscillationRadius:new o.bJ(d),u_horizontalOscillationRate:new o.bJ(d),u_boxSize:new o.bJ(d),u_billboardSize:new o.bJ(d),u_simpleShapeParameters:new o.bH(d),u_screenSize:new o.bH(d),u_thinningCenterPos:new o.bH(d),u_thinningShape:new o.bI(d),u_thinningAffectedRatio:new o.bJ(d),u_thinningParticleOffset:new o.bJ(d),u_particleColor:new o.c7(d),u_direction:new o.bI(d)}),rainParticle:d=>({u_modelview:new o.bG(d),u_projection:new o.bG(d),u_time:new o.bJ(d),u_cam_pos:new o.bI(d),u_texScreen:new o.bK(d),u_velocityConeAperture:new o.bJ(d),u_velocity:new o.bJ(d),u_boxSize:new o.bJ(d),u_rainDropletSize:new o.bH(d),u_distortionStrength:new o.bJ(d),u_rainDirection:new o.bI(d),u_color:new o.c7(d),u_screenSize:new o.bH(d),u_thinningCenterPos:new o.bH(d),u_thinningShape:new o.bI(d),u_thinningAffectedRatio:new o.bJ(d),u_thinningParticleOffset:new o.bJ(d),u_shapeDirectionalPower:new o.bJ(d),u_mode:new o.bJ(d)}),occlusion:d=>({u_matrix:new o.bG(d),u_anchorPos:new o.bI(d),u_screenSizePx:new o.bH(d),u_occluderSizePx:new o.bH(d),u_color:new o.c7(d)})};class Sa{constructor(r,l,p,x){this.id=Sa.uniqueIdxCounter,Sa.uniqueIdxCounter++,this.context=r;const T=r.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||x||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=Sa.uniqueIdxCounter,Sa.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Sa.uniqueIdxCounter=0;const Jn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ud{constructor(r,l,p,x,T,A){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=x,this.instanceCount=A,this.context=r;const F=r.gl;this.buffer=F.createBuffer(),r.bindVertexBuffer.set(this.buffer),F.bufferData(F.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?F.DYNAMIC_DRAW:F.STATIC_DRAW),this.dynamicDraw||T||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const x=l.attributes[this.attributes[p].name];x!==void 0&&r.enableVertexAttribArray(x)}}setVertexAttribPointers(r,l,p){for(let x=0;x<this.attributes.length;x++){const T=this.attributes[x],A=l.attributes[T.name];A!==void 0&&r.vertexAttribPointer(A,T.components,r[Jn[T.type]],!1,this.itemSize,T.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(r,l,p){for(let x=0;x<this.attributes.length;x++){const T=l.attributes[this.attributes[x].name];T!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(T,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class cd{constructor(r,l,p,x,T){this.context=r,this.width=l,this.height=p;const A=this.framebuffer=r.gl.createFramebuffer();x&&(this.colorAttachment=new Jr(r,A)),T&&(this.depthAttachmentType=T,this.depthAttachment=T==="renderbuffer"?new Ii(r,A):new ja(r,A))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class np{constructor(r,l){this.gl=r,this.clearColor=new $u(this),this.clearDepth=new mf(this),this.clearStencil=new Js(this),this.colorMask=new dc(this),this.depthMask=new Uu(this),this.stencilMask=new Vu(this),this.stencilFunc=new gf(this),this.stencilOp=new Qs(this),this.stencilTest=new el(this),this.depthRange=new rh(this),this.depthTest=new ad(this),this.depthFunc=new tp(this),this.blend=new pc(this),this.blendFunc=new Bh(this),this.blendColor=new ih(this),this.blendEquation=new oh(this),this.cullFace=new vo(this),this.cullFaceSide=new Nh(this),this.frontFace=new mc(this),this.program=new gc(this),this.activeTexture=new _c(this),this.viewport=new y(this),this.bindFramebuffer=new M(this),this.bindRenderbuffer=new V(this),this.bindTexture=new ie(this),this.bindVertexBuffer=new Ee(this),this.bindElementBuffer=new Ge(this),this.bindVertexArrayOES=new Pt(this),this.pixelStoreUnpack=new on(this),this.pixelStoreUnpackPremultiplyAlpha=new dn(this),this.pixelStoreUnpackFlipY=new Rn(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,p){return new Sa(this,r,l,p)}createVertexBuffer(r,l,p,x,T){return new ud(this,r,l,p,x,T)}createRenderbuffer(r,l,p){const x=this.gl,T=x.createRenderbuffer();return this.bindRenderbuffer.set(T),x.renderbufferStorage(x.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),T}createFramebuffer(r,l,p,x){return new cd(this,r,l,p,x)}clear({color:r,depth:l,stencil:p,colorMask:x}){const T=this.gl;let A=0;r&&(A|=T.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(x||[!0,!0,!0,!0])),l!==void 0&&(A|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(A|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),T.clear(A)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bi(r.blendFunction,Sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let rs;function $s(d,r,l,p,x,T,A){const F=d.context,j=F.gl,H=d.transform,q=d.getOrCreateProgram("collisionBox"),Y=[];let Q=0,ae=0;for(let ke=0;ke<p.length;ke++){const He=p[ke],Ye=r.getTile(He),Ze=Ye.getBucket(l);if(!Ze)continue;const Qe=ac(He,Ze,H);let it=Qe;x[0]===0&&x[1]===0||(it=d.translatePosMatrix(Qe,Ye,x,T));const ft=A?Ze.textCollisionBox:Ze.iconCollisionBox,st=Ze.collisionCircleArray;if(st.length>0){const at=o.a6.mat4.create(),Rt=it;o.a6.mat4.mul(at,Ze.placementInvProjMatrix,H.glCoordMatrix),o.a6.mat4.mul(at,at,Ze.placementViewportMatrix),Y.push({circleArray:st,circleOffset:ae,transform:Rt,invTransform:at,projection:Ze.getProjection()}),Q+=st.length/4,ae=Q}ft&&(d.terrain&&d.terrain.setupElevationDraw(Ye,q),q.draw(d,j.LINES,ir.disabled,Pe.disabled,d.colorModeForRenderPass(),Mt.disabled,nl(it,H,Ye,Ze.getProjection()),l.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,null,H.zoom,null,[ft.collisionVertexBuffer,ft.collisionVertexBufferExt]))}if(!A||!Y.length)return;const ge=d.getOrCreateProgram("collisionCircle"),_e=new o.cQ;_e.resize(4*Q),_e._trim();let Te=0;for(const ke of Y)for(let He=0;He<ke.circleArray.length/4;He++){const Ye=4*He,Ze=ke.circleArray[Ye+0],Qe=ke.circleArray[Ye+1],it=ke.circleArray[Ye+2],ft=ke.circleArray[Ye+3];_e.emplace(Te++,Ze,Qe,it,ft,0),_e.emplace(Te++,Ze,Qe,it,ft,1),_e.emplace(Te++,Ze,Qe,it,ft,2),_e.emplace(Te++,Ze,Qe,it,ft,3)}(!rs||rs.length<2*Q)&&(rs=function(ke){const He=2*ke,Ye=new o.aP;Ye.resize(He),Ye._trim();for(let Ze=0;Ze<He;Ze++){const Qe=6*Ze;Ye.uint16[Qe+0]=4*Ze+0,Ye.uint16[Qe+1]=4*Ze+1,Ye.uint16[Qe+2]=4*Ze+2,Ye.uint16[Qe+3]=4*Ze+2,Ye.uint16[Qe+4]=4*Ze+3,Ye.uint16[Qe+5]=4*Ze+0}return Ye}(Q));const we=F.createIndexBuffer(rs,!0),ze=F.createVertexBuffer(_e,o.cR.members,!0);for(const ke of Y){const He={u_matrix:ke.transform,u_inv_matrix:ke.invTransform,u_camera_to_center_distance:(Ue=H).getCameraToCenterDistance(ke.projection),u_viewport_size:[Ue.width,Ue.height]};ge.draw(d,j.TRIANGLES,ir.disabled,Pe.disabled,d.colorModeForRenderPass(),Mt.disabled,He,l.id,ze,we,o.b2.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,H.zoom)}var Ue;ze.destroy(),we.destroy()}const Co=o.a6.mat4.create();function Pl(d){const r=d._camera.getWorldToCamera(d.worldSize,1),l=o.a6.mat4.multiply([],r,d.globeMatrix);o.a6.mat4.invert(l,l);const p=[0,0,0],x=[0,1,0,0];return o.a6.vec4.transformMat4(x,x,l),p[0]=x[0],p[1]=x[1],p[2]=x[2],o.a6.vec3.normalize(p,p),p}function lm({width:d,height:r,anchor:l,textOffset:p,textScale:x},T){const{horizontalAlign:A,verticalAlign:F}=o.by(l),j=-(A-.5)*d,H=-(F-.5)*r,q=o.bx(l,p);return new o.P((j/x+q[0])*T,(H/x+q[1])*T)}function hd(d,r,l,p,x,T,A,F,j,H,q){const Y=d.text.placedSymbolArray,Q=d.text.dynamicLayoutVertexArray,ae=d.icon.dynamicLayoutVertexArray,ge={},_e=d.getProjection(),Te=ts(F,_e,T),we=T.elevation,ze=_e.upVectorScale(F.canonical,T.center.lat,T.worldSize).metersToTile;Q.clear();for(let Ue=0;Ue<Y.length;Ue++){const ke=Y.get(Ue),{tileAnchorX:He,tileAnchorY:Ye,numGlyphs:Ze}=ke,Qe=ke.hidden||!ke.crossTileID||d.allowVerticalPlacement&&!ke.placedOrientation?null:p[ke.crossTileID];if(Qe){let it=0,ft=0,st=0;if(we){const jt=we?we.getAtTileOffset(F,He,Ye):0,[tn,rn,en]=_e.upVector(F.canonical,He,Ye);it=jt*tn*ze,ft=jt*rn*ze,st=jt*en*ze}let[at,Rt,$t,sn]=Bo(ke.projectedAnchorX+it,ke.projectedAnchorY+ft,ke.projectedAnchorZ+st,l?Te:A);const _n=cr(T.getCameraToCenterDistance(_e),sn);let yn=x.evaluateSizeForFeature(d.textSizeData,H,ke)*_n/o.br;l&&(yn*=d.tilePixelRatio/j);const yt=lm(Qe,yn);l?({x:at,y:Rt,z:$t}=_e.projectTilePoint(He+yt.x,Ye+yt.y,F.canonical),[at,Rt,$t]=Bo(at+it,Rt+ft,$t+st,A)):(r&&yt._rotate(-T.angle),at+=yt.x,Rt+=yt.y,$t=0);const Qt=d.allowVerticalPlacement&&ke.placedOrientation===o.bl.vertical?Math.PI/2:0;for(let jt=0;jt<Ze;jt++)o.bo(Q,at,Rt,$t,Qt);q&&ke.associatedIconIndex>=0&&(ge[ke.associatedIconIndex]={x:at,y:Rt,z:$t,angle:Qt})}else Za(Ze,Q)}if(q){ae.clear();const Ue=d.icon.placedSymbolArray;for(let ke=0;ke<Ue.length;ke++){const He=Ue.get(ke),{numGlyphs:Ye}=He,Ze=ge[ke];if(He.hidden||!Ze)Za(Ye,ae);else{const{x:Qe,y:it,z:ft,angle:st}=Ze;for(let at=0;at<Ye;at++)o.bo(ae,Qe,it,ft,st)}}d.icon.dynamicLayoutVertexBuffer.updateData(ae)}d.text.dynamicLayoutVertexBuffer.updateData(Q)}function uh(d,r,l,p,x,T,A={}){const F=l.paint.get("icon-translate"),j=l.paint.get("text-translate"),H=l.paint.get("icon-translate-anchor"),q=l.paint.get("text-translate-anchor"),Y=l.layout.get("icon-rotation-alignment"),Q=l.layout.get("text-rotation-alignment"),ae=l.layout.get("icon-pitch-alignment"),ge=l.layout.get("text-pitch-alignment"),_e=l.layout.get("icon-keep-upright"),Te=l.layout.get("text-keep-upright"),we=l.paint.get("icon-color-saturation"),ze=l.paint.get("icon-color-contrast"),Ue=l.paint.get("icon-color-brightness-min"),ke=l.paint.get("icon-color-brightness-max"),He=l.layout.get("symbol-elevation-reference")==="sea",Ye=d.context,Ze=Ye.gl,Qe=d.transform,it=Y==="map",ft=Q==="map",st=ae==="map",at=ge==="map",Rt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let $t=!1;const sn=d.depthModeForSublayer(0,ir.ReadOnly),_n=[o.am(Qe.center.lng),o.at(Qe.center.lat)],yn=l.layout.get("text-variable-anchor"),yt=Qe.projection.name==="globe",Qt=[],jt=[0,-1,0];for(const tn of p){const rn=r.getTile(tn),en=rn.getBucket(l);if(!en||en.projection.name==="mercator"&&yt||en.fullyClipped)continue;const bn=en.projection.name==="globe",er=bn?o.a9(Qe.zoom):0,or=ts(tn,en.getProjection(),Qe),Nn=Qe.calculatePixelsToTileUnitsMatrix(rn),ar=yn&&en.hasTextData(),On=en.hasIconTextFit()&&ar&&en.hasIconData(),pr=en.getProjection().createInversionMatrix(Qe,tn.canonical),kr=Qr=>{Qe.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||d.terrain)&&(Qr.push("DEPTH_D24"),Qr.push("DEPTH_OCCLUSION"))},si=()=>{const Qr=it&&l.layout.get("symbol-placement")!=="point",Ei=[];kr(Ei);const Ui=Qr||On,Yo=l.paint.get("icon-image-cross-fade").constantOr(0);d.terrainRenderModeElevated()&&st&&Ei.push("PITCH_WITH_MAP_TERRAIN"),bn&&(Ei.push("PROJECTION_GLOBE_VIEW"),Ui&&Ei.push("PROJECTED_POS_ON_VIEWPORT")),Yo>0&&Ei.push("ICON_TRANSITION"),en.icon.zOffsetVertexBuffer&&Ei.push("Z_OFFSET"),we===0&&ze===0&&Ue===0&&ke===1||Ei.push("COLOR_ADJUSTMENT"),en.sdfIcons&&Ei.push("RENDER_SDF");const Vs=en.icon.programConfigurations.get(l.id),Ps=d.getOrCreateProgram("symbol",{config:Vs,defines:Ei}),Qi=rn.imageAtlasTexture?rn.imageAtlasTexture.size:[0,0],xi=en.iconSizeData,ni=o.bk(xi,Qe.zoom),di=st||Qe.pitch!==0,Vi=ai(or,rn.tileID.canonical,st,it,Qe,en.getProjection(),Nn),ko=Eo(or,rn.tileID.canonical,st,it,Qe,en.getProjection(),Nn),ji=d.translatePosMatrix(ko,rn,F,H,!0),pa=d.translatePosMatrix(or,rn,F,H),_s=Ui?Co:Vi,ys=it&&!st&&!Qr;let os=jt;!yt&&!Qe.mercatorFromTransition||it||(os=Pl(Qe));const al=bn?os:jt,sl=l.getColorAdjustmentMatrix(we,ze,Ue,ke),vs=lh(xi.kind,ni,ys,st,d,pa,_s,ji,He,!1,Qi,[0,0],!0,tn,er,_n,pr,al,en.getProjection(),sl,Yo),ma=rn.imageAtlasTexture?rn.imageAtlasTexture:null,Ja=l.layout.get("icon-size").constantOr(0)!==1||en.iconsNeedLinear,pi=en.sdfIcons||d.options.rotating||d.options.zooming||Ja||di?Ze.LINEAR:Ze.NEAREST,Qa=en.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,Pd=d.terrain&&st&&Qr?o.a6.mat4.invert(o.a6.mat4.create(),Vi):Co;if(Qr&&en.icon){const kc=Qe.elevation,Nf=kc?kc.getAtTileOffsetFunc(tn,Qe.center.lat,Qe.worldSize,en.getProjection()):null,jf=Br(or,rn.tileID.canonical,st,it,Qe,en.getProjection(),Nn);ua(en,or,d,!1,jf,ko,st,_e,Nf,tn)}return{program:Ps,buffers:en.icon,uniformValues:vs,atlasTexture:ma,atlasTextureIcon:null,atlasInterpolation:pi,atlasInterpolationIcon:null,isSDF:en.sdfIcons,hasHalo:Qa,tile:rn,labelPlaneMatrixInv:Pd}},Si=()=>{const Qr=ft&&l.layout.get("symbol-placement")!=="point",Ei=[],Ui=Qr||yn||On;d.terrainRenderModeElevated()&&at&&Ei.push("PITCH_WITH_MAP_TERRAIN"),bn&&(Ei.push("PROJECTION_GLOBE_VIEW"),Ui&&Ei.push("PROJECTED_POS_ON_VIEWPORT")),en.text.zOffsetVertexBuffer&&Ei.push("Z_OFFSET"),en.iconsInText&&Ei.push("RENDER_TEXT_AND_SYMBOL"),Ei.push("RENDER_SDF"),kr(Ei);const Yo=en.text.programConfigurations.get(l.id),Vs=d.getOrCreateProgram("symbol",{config:Yo,defines:Ei});let Ps,Qi=[0,0],xi=null;const ni=en.textSizeData;en.iconsInText&&(Qi=rn.imageAtlasTexture?rn.imageAtlasTexture.size:[0,0],xi=rn.imageAtlasTexture?rn.imageAtlasTexture:null,Ps=at||Qe.pitch!==0||d.options.rotating||d.options.zooming||ni.kind==="composite"||ni.kind==="camera"?Ze.LINEAR:Ze.NEAREST);const di=rn.glyphAtlasTexture?rn.glyphAtlasTexture.size:[0,0],Vi=l.layout.get("text-size-scale-range"),ko=o.ap(d.scaleFactor,Vi[0],Vi[1]),ji=o.bk(ni,Qe.zoom,ko),pa=ai(or,rn.tileID.canonical,at,ft,Qe,en.getProjection(),Nn),_s=Eo(or,rn.tileID.canonical,at,ft,Qe,en.getProjection(),Nn),ys=d.translatePosMatrix(_s,rn,j,q,!0),os=d.translatePosMatrix(or,rn,j,q),al=Ui?Co:pa,sl=ft&&!at&&!Qr;let vs=jt;!yt&&!Qe.mercatorFromTransition||ft||(vs=Pl(Qe));const ma=lh(ni.kind,ji,sl,at,d,os,al,ys,He,!0,di,Qi,!0,tn,er,_n,pr,bn?vs:jt,en.getProjection(),null,null,ko),Ja=rn.glyphAtlasTexture?rn.glyphAtlasTexture:null,pi=Ze.LINEAR,Qa=l.paint.get("text-halo-width").constantOr(1)!==0,Pd=d.terrain&&at&&Qr?o.a6.mat4.invert(o.a6.mat4.create(),pa):Co;if(Qr&&en.text){const kc=Qe.elevation,Nf=kc?kc.getAtTileOffsetFunc(tn,Qe.center.lat,Qe.worldSize,en.getProjection()):null,jf=Br(or,rn.tileID.canonical,at,ft,Qe,en.getProjection(),Nn);ua(en,or,d,!0,jf,_s,at,Te,Nf,tn)}return{program:Vs,buffers:en.text,uniformValues:ma,atlasTexture:Ja,atlasTextureIcon:xi,atlasInterpolation:pi,atlasInterpolationIcon:Ps,isSDF:!0,hasHalo:Qa,tile:rn,labelPlaneMatrixInv:Pd}},fr=en.icon.segments.get().length,hi=en.text.segments.get().length,Nr=fr&&!A.onlyText?si():null,li=hi&&!A.onlyIcons?Si():null,Rr=l.paint.get("icon-opacity").constantOr(1),Li=l.paint.get("text-opacity").constantOr(1);if(Rt&&en.canOverlap){$t=!0;const Qr=Rr&&!A.onlyText?en.icon.segments.get():[],Ei=Li&&!A.onlyIcons?en.text.segments.get():[];for(const Ui of Qr)Qt.push({segments:new o.b2([Ui]),sortKey:Ui.sortKey,state:Nr});for(const Ui of Ei)Qt.push({segments:new o.b2([Ui]),sortKey:Ui.sortKey,state:li})}else A.onlyText||Qt.push({segments:Rr?en.icon.segments:new o.b2([]),sortKey:0,state:Nr}),A.onlyIcons||Qt.push({segments:Li?en.text.segments:new o.b2([]),sortKey:0,state:li})}$t&&Qt.sort((tn,rn)=>tn.sortKey-rn.sortKey);for(const tn of Qt){const rn=tn.state;if(rn)if(d.terrain?d.terrain.setupElevationDraw(rn.tile,rn.program,{useDepthForOcclusion:Qe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:rn.labelPlaneMatrixInv}):d.setupDepthForOcclusion(Qe.depthOcclusionForSymbolsAndCircles,rn.program),Ye.activeTexture.set(Ze.TEXTURE0),rn.atlasTexture&&rn.atlasTexture.bind(rn.atlasInterpolation,Ze.CLAMP_TO_EDGE,!0),rn.atlasTextureIcon&&(Ye.activeTexture.set(Ze.TEXTURE1),rn.atlasTextureIcon&&rn.atlasTextureIcon.bind(rn.atlasInterpolationIcon,Ze.CLAMP_TO_EDGE,!0)),d.uploadCommonLightUniforms(d.context,rn.program),rn.hasHalo){const en=rn.uniformValues;en.u_is_halo=1,ch(rn.buffers,tn.segments,l,d,rn.program,sn,x,T,en,2),en.u_is_halo=0}else{if(rn.isSDF){const en=rn.uniformValues;rn.hasHalo&&(en.u_is_halo=1,ch(rn.buffers,tn.segments,l,d,rn.program,sn,x,T,en,1)),en.u_is_halo=0}ch(rn.buffers,tn.segments,l,d,rn.program,sn,x,T,rn.uniformValues,1)}}}function ch(d,r,l,p,x,T,A,F,j,H){const q=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.iconTransitioningVertexBuffer,d.globeExtVertexBuffer,d.zOffsetVertexBuffer];x.draw(p,p.context.gl.TRIANGLES,T,A,F,Mt.disabled,j,l.id,d.layoutVertexBuffer,d.indexBuffer,r,l.paint,p.transform.zoom,d.programConfigurations.get(l.id),q,H)}function bf(d,r,l,p,x,T,A){const F=d.context.gl,j=l.paint.get("fill-pattern"),H=l.is3D(),q=H?d.stencilModeFor3D():Pe.disabled,Y=j&&j.constantOr(1);let Q,ae,ge,_e,Te;A?(ae=Y&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=F.LINES):(ae=Y?"fillPattern":"fill",Q=F.TRIANGLES);for(const we of p){const ze=r.getTile(we);if(Y&&!ze.patternsLoaded())continue;const Ue=ze.getBucket(l);if(!Ue)continue;d.prepareDrawTile();const ke=Ue.programConfigurations.get(l.id),He=d.isTileAffectedByFog(we),Ye=d.getOrCreateProgram(ae,{config:ke,overrideFog:He});Y&&(d.context.activeTexture.set(F.TEXTURE0),ze.imageAtlasTexture&&ze.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),ke.updatePaintBuffers());const Ze=j.constantOr(null);if(Ze&&ze.imageAtlas){const ft=ze.imageAtlas.patternPositions[Ze.toString()];ft&&ke.setConstantPatternPositions(ft)}const Qe=d.translatePosMatrix(we.projMatrix,ze,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),it=l.paint.get("fill-emissive-strength");if(A){_e=Ue.indexBuffer2,Te=Ue.segments2;const ft=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[F.drawingBufferWidth,F.drawingBufferHeight];ge=ae==="fillOutlinePattern"&&Y?$h(Qe,it,d,ze,ft):Kl(Qe,it,ft)}else _e=Ue.indexBuffer,Te=Ue.segments,ge=Y?Es(Qe,it,d,ze):ds(Qe,it);d.uploadCommonUniforms(d.context,Ye,we.toUnwrapped()),Ye.draw(d,Q,x,H?q:d.stencilModeForClipping(we),T,Mt.disabled,ge,l.id,Ue.layoutVertexBuffer,_e,Te,l.paint,d.transform.zoom,ke,void 0)}}function $a(d,r,l,p,x,T,A,F){l.resetLayerRenderingStats(d);const j=d.context,H=j.gl,q=d.transform,Y=l.paint.get("fill-extrusion-pattern"),Q=Y.constantOr(1),ae=l.paint.get("fill-extrusion-opacity"),ge=d.style.enable3dLights(),_e=l.paint.get(ge&&!Q?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],we=l.layout.get("fill-extrusion-edge-radius"),ze=we>0&&!l.paint.get("fill-extrusion-rounded-roof"),Ue=ze?0:we,ke=q.projection.name==="globe"?o.c_():0,He=q.projection.name==="globe",Ye=He?o.a9(q.zoom):0,Ze=[o.am(q.center.lng),o.at(q.center.lat)],Qe=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),it=l.paint.get("fill-extrusion-flood-light-intensity"),ft=l.paint.get("fill-extrusion-vertical-scale"),st=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,at=l.paint.get("fill-extrusion-height-alignment"),Rt=l.paint.get("fill-extrusion-base-alignment"),$t=Oa(d,l.paint.get("fill-extrusion-cutoff-fade-range")),sn=[];let _n;He&&sn.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&sn.push("FAUX_AO"),ze&&sn.push("ZERO_ROOF_RADIUS"),F&&sn.push("HAS_CENTROID"),it>0&&sn.push("FLOOD_LIGHT"),$t.shouldRenderCutoff&&sn.push("RENDER_CUTOFF"),st&&sn.push("RENDER_WALL_MODE");const yn=d.renderPass==="shadow",yt=d.shadowRenderer,Qt=yn&&!!yt;d.shadowRenderer&&(d.shadowRenderer.useNormalOffset=!0);let jt=[0,0,0];if(yt){const en=d.style.directionalLight,bn=d.style.ambientLight;en&&bn&&(jt=zu(d.style,en,bn)),yn||(sn.push("RENDER_SHADOWS","DEPTH_TEXTURE"),yt.useNormalOffset&&sn.push("NORMAL_OFFSET")),_n=sn.concat(["SHADOWS_SINGLE_CASCADE"])}const tn=Qt?"fillExtrusionDepth":Q?"fillExtrusionPattern":"fillExtrusion",rn=l.getLayerRenderingStats();for(const en of p){const bn=r.getTile(en),er=bn.getBucket(l);if(!er||er.projection.name!==q.projection.name)continue;let or=!1;yt&&(or=yt.getMaxCascadeForTile(en.toUnwrapped())===0);const Nn=d.isTileAffectedByFog(en),ar=er.programConfigurations.get(l.id),On=d.getOrCreateProgram(tn,{config:ar,defines:or?_n:sn,overrideFog:Nn});if(d.terrain&&d.terrain.setupElevationDraw(bn,On,{useMeterToDem:!0}),!er.centroidVertexBuffer){const Nr=On.attributes.a_centroid_pos;Nr!==void 0&&H.vertexAttrib2f(Nr,0,0)}!yn&&yt&&yt.setupShadows(bn.tileID.toUnwrapped(),On,"vector-tile",bn.tileID.overscaledZ),Q&&(d.context.activeTexture.set(H.TEXTURE0),bn.imageAtlasTexture&&bn.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),ar.updatePaintBuffers());const pr=Y.constantOr(null);if(pr&&bn.imageAtlas){const Nr=bn.imageAtlas.patternPositions[pr.toString()];Nr&&ar.setConstantPatternPositions(Nr)}const kr=l.paint.get("fill-extrusion-vertical-gradient"),si=1/er.tileToMeter;let Si;if(yn&&yt){if(Sf(bn.tileID,er,d))continue;const Nr=yt.calculateShadowPassMatrixFromTile(bn.tileID.toUnwrapped());Si=Io(Nr,Ue,si,ft,at,Rt)}else{const Nr=d.translatePosMatrix(en.expandedProjMatrix,bn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),li=q.projection.createInversionMatrix(q,en.canonical);Si=Q?mu(Nr,d,kr,ae,Te,Ue,si,en,bn,ke,at,Rt,Ye,Ze,li,Qe,ft):Do(Nr,d,kr,ae,Te,Ue,si,en,ke,at,Rt,Ye,Ze,li,Qe,ft,it,jt)}d.uploadCommonUniforms(j,On,en.toUnwrapped(),null,$t);let fr=er.segments;if(q.projection.name==="mercator"&&!yn&&(fr=er.getVisibleSegments(bn.tileID,d.terrain,d.transform.getFrustum(0)),!fr.get().length))continue;if(rn)if(yn)for(const Nr of fr.get())rn.numRenderedVerticesInShadowPass+=Nr.primitiveLength;else for(const Nr of fr.get())rn.numRenderedVerticesInTransparentPass+=Nr.primitiveLength;const hi=[];(d.terrain||F)&&hi.push(er.centroidVertexBuffer),He&&hi.push(er.layoutVertexExtBuffer),st&&hi.push(er.wallVertexBuffer),On.draw(d,j.gl.TRIANGLES,x,T,A,Mt.backCCW,Si,l.id,er.layoutVertexBuffer,er.indexBuffer,fr,l.paint,d.transform.zoom,ar,hi)}d.shadowRenderer&&(d.shadowRenderer.useNormalOffset=!1)}function rl(d,r,l,p,x,T,A,F,j,H,q,Y,Q,ae,ge,_e,Te,we,ze){const Ue=d.context,ke=Ue.gl,He=d.transform,Ye=d.transform.zoom,Ze=[],Qe=Oa(d,l.paint.get("fill-extrusion-cutoff-fade-range"));H==="clear"?(Ze.push("CLEAR_SUBPASS"),ze&&(Ze.push("CLEAR_FROM_TEXTURE"),Ue.activeTexture.set(ke.TEXTURE0),ze.bind(ke.LINEAR,ke.CLAMP_TO_EDGE))):H==="sdf"&&Ze.push("SDF_SUBPASS"),Te&&Ze.push("HAS_CENTROID"),Qe.shouldRenderCutoff&&Ze.push("RENDER_CUTOFF");const it=l.layout.get("fill-extrusion-edge-radius"),ft=(st,at,Rt,$t,sn)=>{const _n=at.programConfigurations.get(l.id),yn=d.isTileAffectedByFog(st),yt=d.getOrCreateProgram("fillExtrusionGroundEffect",{config:_n,defines:Ze,overrideFog:yn}),Qt=((tn,rn,en,bn,er,or,Nn,ar,On,pr,kr)=>({u_matrix:rn,u_opacity:en,u_ao_pass:bn?1:0,u_meter_to_tile:er,u_ao:or,u_flood_light_intensity:Nn,u_flood_light_color:ar,u_attenuation:On,u_edge_radius:pr,u_fb:0,u_fb_size:kr,u_dynamic_offset:1}))(0,$t,q,j,sn,[Y,Q*sn],ae,ge,_e,Ye>=17?0:it*sn,ze?ze.size[0]:0),jt=[];Te&&jt.push(at.hiddenByLandmarkVertexBuffer),d.uploadCommonUniforms(Ue,yt,st.toUnwrapped(),null,Qe),yt.draw(d,Ue.gl.TRIANGLES,x,T,A,F,Qt,l.id,at.vertexBuffer,at.indexBuffer,Rt,l.paint,Ye,_n,jt)};for(const st of p){const at=r.getTile(st),Rt=at.getBucket(l);if(!Rt||Rt.projection.name!==He.projection.name||!Rt.groundEffect||Rt.groundEffect&&!Rt.groundEffect.hasData())continue;const $t=Rt.groundEffect,sn=1/Rt.tileToMeter;{const _n=d.translatePosMatrix(st.projMatrix,at,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),yn=$t.getDefaultSegment();ft(st,$t,yn,_n,sn)}if(we)for(let _n=0;_n<4;_n++){const yn=o.c$[_n](st),yt=r.getTile(yn);if(!yt)continue;const Qt=yt.getBucket(l);if(!Qt||Qt.projection.name!==He.projection.name||!Qt.groundEffect||Qt.groundEffect&&!Qt.groundEffect.hasData())continue;const jt=Qt.groundEffect;let tn,rn;_n===0?(tn=[-o.ab,0,0],rn=1):_n===1?(tn=[o.ab,0,0],rn=0):_n===2?(tn=[0,-o.ab,0],rn=3):(tn=[0,o.ab,0],rn=2);const en=jt.regionSegments[rn];if(!en)continue;const bn=new Float32Array(16);o.a6.mat4.translate(bn,st.projMatrix,tn),ft(st,jt,en,d.translatePosMatrix(bn,at,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),sn)}}}function hh(d,r,l,p,x,T,A){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const F=T?T.findDEMTileFor(l):null;if(!(F&&F.dem||A))return;const j=we=>new o.P(Math.ceil((we+o.d2)*o.d3),0),H=we=>{const ze=r.getSource().minzoom,Ue=He=>{const Ye=r.getTileByID(He);if(Ye&&Ye.hasData())return Ye.getBucket(x)},ke=[0,-1,1];for(const He of ke){if(we.overscaledZ+He<ze)continue;const Ye=Ue(we.calculateScaledKey(we.overscaledZ+He));if(Ye)return Ye}},q=[0,0,0],Y=(we,ze)=>(q[0]=Math.min(we.min.y,ze.min.y),q[1]=Math.max(we.max.y,ze.max.y),q[2]=o.ab-ze.min.x>we.max.x?ze.min.x-o.ab:we.max.x,q),Q=(we,ze)=>(q[0]=Math.min(we.min.x,ze.min.x),q[1]=Math.max(we.max.x,ze.max.x),q[2]=o.ab-ze.min.y>we.max.y?ze.min.y-o.ab:we.max.y,q),ae=[(we,ze)=>Y(we,ze),(we,ze)=>Y(ze,we),(we,ze)=>Q(we,ze),(we,ze)=>Q(ze,we)],ge=(we,ze,Ue,ke,He,Ye,Ze)=>{if(!T)return 0;const Qe=[[Ye?Ue:we,Ye?we:Ue,0],[Ye?Ue:ze,Ye?ze:Ue,0]],it=Ze<0?o.ab+Ze:Ze,ft=[Ye?it:(we+ze)/2,Ye?(we+ze)/2:it,0];return Ue===0&&Ze<0||Ue!==0&&Ze>0?T.getForTilePoints(He,[ft],!0,ke):Qe.push(ft),T.getForTilePoints(l,Qe,!0,F),Math.max(Qe[0][2],Qe[1][2],ft[2])/T.exaggeration()};for(let we=0;we<4;we++){const ze=p.borderFeatureIndices[we];if(ze.length===0)continue;const Ue=o.c$[we](l),ke=H(Ue);if(!(ke&&ke instanceof o.d0)||p.borderDoneWithNeighborZ[we]===ke.canonical.z)continue;ke.centroidVertexArray.length===0&&ke.createCentroidsBuffer();const He=T?T.findDEMTileFor(Ue):null;if(!(He&&He.dem||A))continue;const Ye=(we<2?1:5)-we,Ze=ke.borderDoneWithNeighborZ[Ye]!==p.canonical.z,Qe=ke.borderFeatureIndices[Ye];let it=0;if(p.canonical.z!==ke.canonical.z){for(const ft of ze)p.showCentroid(p.featuresOnBorder[ft]);if(Ze)for(const ft of Qe)ke.showCentroid(ke.featuresOnBorder[ft]);p.borderDoneWithNeighborZ[we]=ke.canonical.z,ke.borderDoneWithNeighborZ[Ye]=p.canonical.z}for(const ft of ze){const st=p.featuresOnBorder[ft],at=p.centroidData[st.centroidDataIndex],Rt=st.borders[we];let $t;for(;it<Qe.length;){$t=ke.featuresOnBorder[Qe[it]];const sn=$t.borders[Ye];if(sn[1]>Rt[0]+3||sn[0]>Rt[0]-3)break;ke.showCentroid($t),it++}if($t&&it<Qe.length){const sn=it;let _n=0;for(;!($t.borders[Ye][0]>Rt[1]-3)&&(_n++,++it!==Qe.length);)$t=ke.featuresOnBorder[Qe[it]];$t=ke.featuresOnBorder[Qe[sn]];let yn=!1;if(_n>=1){const jt=$t.borders[Ye];Math.abs(Rt[0]-jt[0])<3&&Math.abs(Rt[1]-jt[1])<3&&(_n=1,yn=!0,it=sn+1)}else if(_n===0){p.showCentroid(st);continue}const yt=ke.centroidData[$t.centroidDataIndex];A&&yn&&(((_e=at).flags|(Te=yt).flags)&o.d1?(_e.flags|=o.d1,Te.flags|=o.d1):(_e.flags&=~o.d1,Te.flags&=~o.d1));const Qt=st.intersectsCount()>1||$t.intersectsCount()>1;if(_n>1)it=sn,at.centroidXY=yt.centroidXY=new o.P(0,0);else if(He&&He.dem&&!Qt){const jt=ae[we](at,yt),tn=we%2?o.ab-1:0,rn=ge(jt[0],Math.min(o.ab-1,jt[1]),tn,He,Ue,we<2,jt[2]);at.centroidXY=yt.centroidXY=j(rn)}else Qt?at.centroidXY=yt.centroidXY=new o.P(0,0):(at.centroidXY=p.encodeBorderCentroid(st),yt.centroidXY=ke.encodeBorderCentroid($t));p.writeCentroidToBuffer(at),ke.writeCentroidToBuffer(yt)}else p.showCentroid(st)}p.borderDoneWithNeighborZ[we]=ke.canonical.z,ke.borderDoneWithNeighborZ[Ye]=p.canonical.z}var _e,Te;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(d)}const wf=[1,0,0],rp=[0,1,0],fh=[0,0,1];function Sf(d,r,l){const p=l.transform,x=l.shadowRenderer;if(!x)return!0;const T=d.toUnwrapped(),A=p.tileSize*x._cascades[l.currentShadowCascade].scale;let F=r.maxHeight;if(p.elevation){const _e=p.elevation.getMinMaxForTile(d);_e&&(F+=_e.max)}const j=[...x.shadowDirection];j[2]=-j[2];const H=x.computeSimplifiedTileShadowVolume(T,F,A,j);if(!H)return!1;const q=[wf,rp,fh,j,[j[0],0,j[2]],[0,j[1],j[2]]],Y=p.projection.name==="globe",Q=p.scaleZoom(A),ae=o.bO.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,Q,!Y),ge=x.getCurrentCascadeFrustum();return ae.intersectsPrecise(H.vertices,H.planes,q)===0||ge.intersectsPrecise(H.vertices,H.planes,q)===0}function il(d){return[d[0]*o.d4,d[1]*o.d4,d[2]*o.d4,0]}function Po(d,r,l,p,x,T,A,F,j){const H=p.getSource(),q=l.globeSharedBuffers;if(!q)return;let Y,Q,ae;if(r&&(Y=p.getTile(r)),H instanceof o.aD?(Q=H.texture,ae=o.cD(0,0,l.transform)):Y&&r&&(Q=Y.texture,ae=o.cD(r.canonical.z,r.canonical.x,l.transform)),!Q||!ae)return;d||(ae=o.a6.mat4.scale(o.a6.mat4.create(),ae,[1,-1,1]));const ge=l.context,_e=ge.gl,Te=x.paint.get("raster-resampling")==="nearest"?_e.NEAREST:_e.LINEAR,we=l.colorModeForDrapableLayerRenderPass(T),ze=A.defines;ze.push("GLOBE_POLES");const Ue=new ir(_e.LEQUAL,ir.ReadWrite,l.depthRangeFor3D),ke=Float32Array.from(l.transform.expandedFarZProjMatrix),He=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ge.activeTexture.set(_e.TEXTURE0),Q.bind(Te,_e.CLAMP_TO_EDGE),ge.activeTexture.set(_e.TEXTURE1),Q.bind(Te,_e.CLAMP_TO_EDGE),Q.useMipmap&&ge.extTextureFilterAnisotropic&&l.transform.pitch>20&&_e.texParameterf(_e.TEXTURE_2D,ge.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ge.extTextureFilterAnisotropicMax);const[Ye,Ze,Qe,it]=r?q.getPoleBuffers(r.canonical.z,!1):q.getPoleBuffers(0,!0),ft=x.paint.get("raster-elevation");let st;d?(st=Ye,l.renderDefaultNorthPole=ft!==0):(st=Ze,l.renderDefaultSouthPole=ft!==0);const at=il(A.mix),Rt=((sn,_n,yn,yt,Qt,jt,tn,rn,en,bn,er,or,Nn)=>Al(sn,_n,yn,new Float32Array(16),new Float32Array(9),[0,0],yt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},jt,[0,0],rn,2,bn,er,or,1,0,Nn))(ke,He,ae,o.a9(l.transform.zoom),0,x,0,ft,0,at,A.offset,A.range,T),$t=l.getOrCreateProgram("raster",{defines:ze});l.uploadCommonUniforms(ge,$t,null),$t.draw(l,_e.TRIANGLES,Ue,j,we,F,Rt,x.id,st,Qe,it)}function Xu(d){const r=d._nearZ,l=d.projection.farthestPixelDistance(d),p=l-r,x=.2*d.height,T=r+x;return[r,l,(T-x-r)/p,(T-r)/p]}function fd(d,r,l,p){if(d)return r instanceof Ir&&d instanceof nn?r.getTextureDescriptor(d,l,!0):{texture:d.texture,mix:il(p.mix),offset:p.offset,buffer:0,tileSize:1}}var Tf=o.d5([{name:"a_index",type:"Int16",components:1}]);class Ef{constructor(r,l,p,x){const T={width:p[0],height:p[1],data:null},A=r.gl;this.targetColorTexture=new o.T(r,T,A.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new o.T(r,T,A.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,x),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,x=l.width*l.height;this.particleTexture0=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new o.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1});const T=new o.d6;T.reserve(x);for(let A=0;A<x;A++)T.emplaceBack(A);this.particleIndexBuffer=this.context.createVertexBuffer(T,Tf.members,!0),this.particleSegment=o.b2.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=o.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function dh(d,r,l){if(!d)return null;const p=r.getTextureDescriptor(d,l,!0);if(!p)return null;let{texture:x,mix:T,offset:A,tileSize:F,buffer:j,format:H}=p;if(!x||!H)return null;let q=!1;return H==="uint32"&&(q=!0,T[3]=0,T=ah(o.d7,T,[0,l.paint.get("raster-particle-max-speed")]),A=sh(o.d7,A,[0,l.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[j/(F+2*j),F/(F+2*j)],tileSize:F,scalarData:q,scale:T,offset:A,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[H]]}}function ip(d){const r=d._nearZ,l=d.projection.farthestPixelDistance(d),p=l-r,x=.2*d.height,T=r+x;return[r,l,(T-x-r)/p,(T-r)/p]}const bc=new o.bA(1,0,0,1),wc=new o.bA(0,1,0,1),vn=new o.bA(0,0,1,1),tr=new o.bA(1,0,1,1),ps=new o.bA(0,1,1,1);function Ni(d,r,l,p,x,T,A){const F=d.context,j=d.transform,H=F.gl,q=j.projection.name==="globe",Y=q?["PROJECTION_GLOBE_VIEW"]:[];let Q=o.a6.mat4.clone(l.projMatrix);if(q&&o.a9(j.zoom)>0){const at=o.b5(l.canonical,j),Rt=o.d8(at);Q=o.a6.mat4.multiply(new Float32Array(16),j.globeMatrix,Rt),o.a6.mat4.multiply(Q,j.projMatrix,Q)}const ae=o.a6.mat4.create();ae[12]+=2*x/(o.q.devicePixelRatio*j.width),ae[13]+=2*T/(o.q.devicePixelRatio*j.height),o.a6.mat4.multiply(Q,ae,Q);const ge=d.getOrCreateProgram("debug",{defines:Y}),_e=r.getTileByID(l.key);d.terrain&&d.terrain.setupElevationDraw(_e,ge);const Te=ir.disabled,we=Pe.disabled,ze=d.colorModeForRenderPass(),Ue="$debug";F.activeTexture.set(H.TEXTURE0),d.emptyTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),q?_e._makeGlobeTileDebugBuffers(d.context,j):_e._makeDebugTileBoundsBuffers(d.context,j.projection);const ke=_e._tileDebugBuffer||d.debugBuffer,He=_e._tileDebugIndexBuffer||d.debugIndexBuffer,Ye=_e._tileDebugSegments||d.debugSegments;if(ge.draw(d,H.LINE_STRIP,Te,we,ze,Mt.disabled,Uh(Q,p),Ue,ke,He,Ye,null,null,null,[_e._globeTileDebugBorderBuffer]),A){const at=_e.latestRawTileData,Rt=Math.floor((at&&at.byteLength||0)/1024);let $t=l.canonical.toString();l.overscaledZ!==l.canonical.z&&($t+=` => ${l.overscaledZ}`),$t+=` ${_e.state}`,$t+=` ${Rt}kb`,function(sn,_n){sn.initDebugOverlayCanvas();const yn=sn.debugOverlayCanvas,yt=sn.context.gl,Qt=sn.debugOverlayCanvas.getContext("2d");Qt.clearRect(0,0,yn.width,yn.height),Qt.shadowColor="white",Qt.shadowBlur=2,Qt.lineWidth=1.5,Qt.strokeStyle="white",Qt.textBaseline="top",Qt.font="bold 36px Open Sans, sans-serif",Qt.fillText(_n,5,5),Qt.strokeText(_n,5,5),sn.debugOverlayTexture.update(yn),sn.debugOverlayTexture.bind(yt.LINEAR,yt.CLAMP_TO_EDGE)}(d,$t)}const Ze=r.getTile(l).tileSize,Qe=512/Math.min(Ze,512)*(l.overscaledZ/j.zoom)*.5,it=_e._tileDebugTextBuffer||d.debugBuffer,ft=_e._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,st=_e._tileDebugTextSegments||d.debugSegments;ge.draw(d,H.TRIANGLES,Te,we,Sr.alphaBlended,Mt.disabled,Uh(Q,o.bA.transparent,Qe),Ue,it,ft,st,null,null,null,[_e._globeTileDebugTextBuffer])}function Et(d,r,l,p){Us(d,0,r+l/2,d.transform.width,l,p)}function dd(d,r,l,p){Us(d,r-l/2,0,l,d.transform.height,p)}function Us(d,r,l,p,x,T){const A=d.context,F=A.gl;F.enable(F.SCISSOR_TEST),F.scissor(r*o.q.devicePixelRatio,l*o.q.devicePixelRatio,p*o.q.devicePixelRatio,x*o.q.devicePixelRatio),A.clear({color:T}),F.disable(F.SCISSOR_TEST)}const yu=o.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Vh}=yu;function vu(d,r,l,p){d.emplaceBack(r,l,p)}class Yl{constructor(r){this.vertexArray=new o.d9,this.indices=new o.aP,vu(this.vertexArray,-1,-1,1),vu(this.vertexArray,1,-1,1),vu(this.vertexArray,-1,1,1),vu(this.vertexArray,1,1,1),vu(this.vertexArray,-1,-1,-1),vu(this.vertexArray,1,-1,-1),vu(this.vertexArray,-1,1,-1),vu(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,Vh),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=o.b2.simpleSegment(0,0,36,12)}}function is(d,r,l,p,x,T){const A=d.context.gl,F=r.paint.get("sky-atmosphere-color"),j=r.paint.get("sky-atmosphere-halo-color"),H=r.paint.get("sky-atmosphere-sun-intensity"),q=((Y,Q,ae,ge,_e)=>({u_matrix_3f:Y,u_sun_direction:Q,u_sun_intensity:ae,u_color_tint_r:[ge.r,ge.g,ge.b,ge.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(o.a6.mat3.fromMat4(o.a6.mat3.create(),p),x,H,F,j);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+T,r.skyboxTexture,0),l.draw(d,A.TRIANGLES,ir.disabled,Pe.disabled,Sr.unblended,Mt.frontCW,q,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const pd=o.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class um{constructor(r){const l=new o.da;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new o.aP;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,pd.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=o.b2.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Af=o.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Pf{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ph{constructor(r){this.colorModeAlphaBlendedWriteRGB=new Sr([1,ia,1,ia],o.bA.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Sr([1,0,1,0],o.bA.transparent,[!1,!1,!1,!0]),this.params=new Pf,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new um(l);const p=this.params.sizeRange,x=this.params.intensityRange,T=function(q){const Y=o.dd(30),Q=[];for(let ae=0;ae<q;++ae){const ge=2*Math.PI*Y(),_e=Math.acos(1-2*Y())-.5*Math.PI;Q.push(o.a6.vec3.fromValues(Math.cos(_e)*Math.cos(ge),Math.cos(_e)*Math.sin(ge),Math.sin(_e)))}return Q}(this.params.starsCount),A=o.dd(300),F=new o.db,j=new o.aP;let H=0;for(let q=0;q<T.length;++q){const Y=o.a6.vec3.scale([],T[q],200),Q=Math.max(0,1+.01*p*(1*A()-.5)),ae=Math.max(0,1+.01*x*(1*A()-.5));F.emplaceBack(Y[0],Y[1],Y[2],-1,-1,Q,ae),F.emplaceBack(Y[0],Y[1],Y[2],1,-1,Q,ae),F.emplaceBack(Y[0],Y[1],Y[2],1,1,Q,ae),F.emplaceBack(Y[0],Y[1],Y[2],-1,1,Q,ae),j.emplaceBack(H+0,H+1,H+2),j.emplaceBack(H+0,H+2,H+3),H+=4}this.starsVx=l.createVertexBuffer(F,Af.members),this.starsIdx=l.createIndexBuffer(j),this.starsSegments=o.b2.simpleSegment(0,0,F.length,j.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const p=r.context,x=p.gl,T=r.transform,A=new ir(x.LEQUAL,ir.ReadOnly,[0,1]),F=o.a9(T.zoom),j=r.style.getLut(l.scope),H=l.properties.get("color").toRenderColor(j).toArray01(),q=l.properties.get("high-color").toRenderColor(j).toArray01(),Y=l.properties.get("space-color").toRenderColor(j).toArray01PremultipliedAlpha(),Q=5e-4,ae=o.dc(l.properties.get("horizon-blend"),0,1,Q,.25),ge=o.cx(r,p,T)&&ae===Q?T.worldSize/(2*Math.PI*1.025)-1:T.globeRadius,_e=r.frameCounter/1e3%1,Te=o.a6.vec3.length(T.globeCenterInViewSpace),we=Math.sqrt(Math.pow(Te,2)-Math.pow(ge,2)),ze=Math.acos(we/Te),Ue=ke=>{const He=T.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ke&&He.push("ALPHA_PASS");const Ye=r.getOrCreateProgram("globeAtmosphere",{defines:He}),Ze=((it,ft,st,at,Rt,$t,sn,_n,yn,yt,Qt,jt)=>({u_frustum_tl:it,u_frustum_tr:ft,u_frustum_br:st,u_frustum_bl:at,u_horizon:Rt,u_transition:$t,u_fadeout_range:sn,u_color:_n,u_high_color:yn,u_space_color:yt,u_temporal_offset:Qt,u_horizon_angle:jt}))(T.frustumCorners.TL,T.frustumCorners.TR,T.frustumCorners.BR,T.frustumCorners.BL,T.frustumCorners.horizon,F,ae,H,q,Y,_e,ze);r.uploadCommonUniforms(p,Ye);const Qe=this.atmosphereBuffer;Qe&&Ye.draw(r,x.TRIANGLES,A,Pe.disabled,ke?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Mt.backCW,Ze,ke?"atmosphere_glow_alpha":"atmosphere_glow",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)};Ue(!1),Ue(!0)}drawStars(r,l){const p=o.ap(l.properties.get("star-intensity"),0,1);if(p===0)return;const x=r.context,T=x.gl,A=r.transform,F=r.getOrCreateProgram("stars"),j=o.a6.quat.identity([]);o.a6.quat.rotateX(j,j,-A._pitch),o.a6.quat.rotateZ(j,j,-A.angle),o.a6.quat.rotateX(j,j,o.bC(A._center.lat)),o.a6.quat.rotateY(j,j,-o.bC(A._center.lng));const H=o.a6.mat4.fromQuat(new Float32Array(16),j),q=o.a6.mat4.multiply([],A.starsProjMatrix,H),Y=o.a6.mat3.fromMat4([],H),Q=o.a6.mat3.invert([],Y),ae=[0,1,0];o.a6.vec3.transformMat3(ae,ae,Q),o.a6.vec3.scale(ae,ae,this.params.sizeMultiplier);const ge=[1,0,0];o.a6.vec3.transformMat3(ge,ge,Q),o.a6.vec3.scale(ge,ge,this.params.sizeMultiplier);const _e=(Te=ae,we=ge,ze=p,{u_matrix:Float32Array.from(q),u_up:Te,u_right:we,u_intensity_multiplier:ze});var Te,we,ze;r.uploadCommonUniforms(x,F),this.starsVx&&this.starsIdx&&F.draw(r,T.TRIANGLES,ir.disabled,Pe.disabled,this.colorModeAlphaBlendedWriteRGB,Mt.disabled,_e,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Ml(d,r){const l=[...d],p=r.cameraWorldSizeForFog/r.worldSize,x=o.a6.mat4.identity([]);return o.a6.mat4.scale(x,x,[p,p,1]),o.a6.mat4.multiply(l,x,l),o.a6.mat4.multiply(l,r.worldToFogMatrix,l),l}function Sc(d,r,l,p,x){const T=l.material,A=p.context,{baseColorTexture:F,metallicRoughnessTexture:j}=T.pbrMetallicRoughness,{normalTexture:H,occlusionTexture:q,emissionTexture:Y}=T;function Q(ge,_e,Te){if(ge&&(d.push(_e),A.activeTexture.set(A.gl.TEXTURE0+Te),ge.gfxTexture)){const{minFilter:we,magFilter:ze,wrapS:Ue,wrapT:ke}=ge.sampler;ge.gfxTexture.bindExtraParam(we,ze,Ue,ke)}}Q(F,"HAS_TEXTURE_u_baseColorTexture",Or.BaseColor),Q(j,"HAS_TEXTURE_u_metallicRoughnessTexture",Or.MetallicRoughness),Q(H,"HAS_TEXTURE_u_normalTexture",Or.Normal),Q(q,"HAS_TEXTURE_u_occlusionTexture",Or.Occlusion),Q(Y,"HAS_TEXTURE_u_emissionTexture",Or.Emission),x&&(x.texture||(x.texture=new o.df(p.context,x.image,[x.image.height,x.image.height,x.image.height],A.gl.RGBA8)),A.activeTexture.set(A.gl.TEXTURE0+Or.LUT),x.texture&&x.texture.bind(A.gl.LINEAR,A.gl.CLAMP_TO_EDGE),d.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(d.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(d.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(d.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(d.push("HAS_ATTRIBUTE_a_pbr"),d.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),T.alphaMode!=="OPAQUE"&&T.alphaMode!=="MASK"||d.push("UNPREMULT_TEXTURE_IN_SHADER"),T.defined||d.push("DIFFUSE_SHADED"),d.push("USE_STANDARD_DERIVATIVES");const ae=p.shadowRenderer;ae&&(d.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&d.push("NORMAL_OFFSET"))}function Jl(d,r,l,p,x,T){const A=l.paint.get("model-opacity"),F=r.context,j=new ir(r.context.gl.LEQUAL,ir.ReadWrite,r.depthRangeFor3D),H=r.transform,q=d.mesh,Y=q.material,Q=Y.pbrMetallicRoughness,ae=r.style.fog;let ge;ge=r.transform.projection.zAxisUnit==="pixels"?[...d.nodeModelMatrix]:o.a6.mat4.multiply([],p.zScaleMatrix,d.nodeModelMatrix),o.a6.mat4.multiply(ge,p.negCameraPosMatrix,ge);const _e=o.a6.mat4.invert([],ge);o.a6.mat4.transpose(_e,_e);const Te=l.paint.get("model-emissive-strength").constantOr(0),we=Ns(new Float32Array(d.worldViewProjection),new Float32Array(ge),new Float32Array(_e),null,r,A,Q.baseColorFactor.toRenderColor(null),Y.emissiveFactor,Q.metallicFactor,Q.roughnessFactor,Y,Te,l),ze={defines:[]},Ue=[],ke=r.shadowRenderer;ke&&(ke.useNormalOffset=!1),Sc(ze.defines,Ue,q,r,l.lut);let He=null;if(ae){const Qe=Ml(d.nodeModelMatrix,r.transform);if(He=new Float32Array(Qe),H.projection.name!=="globe"){const it=q.aabb.min,ft=q.aabb.max,[st,at]=ae.getOpacityForBounds(Qe,it[0],it[1],ft[0],ft[1]);ze.overrideFog=st>=Tt||at>=Tt}}const Ye=Oa(r,l.paint.get("model-cutoff-fade-range"));Ye.shouldRenderCutoff&&ze.defines.push("RENDER_CUTOFF");const Ze=r.getOrCreateProgram("model",ze);r.uploadCommonUniforms(F,Ze,null,He,Ye),r.renderPass!=="shadow"&&ke&&ke.setupShadowsFromMatrix(d.nodeModelMatrix,Ze),Ze.draw(r,F.gl.TRIANGLES,j,x,T,q.material.doubleSided?Mt.disabled:Mt.backCCW,we,l.id,q.vertexBuffer,q.indexBuffer,q.segments,l.paint,r.transform.zoom,void 0,Ue)}function Ql(d,r,l,p,x,T,A){let F;F=d.projection.name==="globe"?o.dg(l,d):[...l],o.a6.mat4.multiply(F,F,r.matrix);const j=o.a6.mat4.multiply([],p,F);if(r.meshes)for(const H of r.meshes){if(H.material.alphaMode!=="BLEND"){A.push({mesh:H,depth:0,modelIndex:x,worldViewProjection:j,nodeModelMatrix:F});continue}const q=o.a6.vec3.transformMat4([],H.centroid,j);q[2]>0&&T.push({mesh:H,depth:q[2],modelIndex:x,worldViewProjection:j,nodeModelMatrix:F})}if(r.children)for(const H of r.children)Ql(d,H,l,p,x,T,A)}function qh(d,r,l,p){const x=l.shadowRenderer;if(!x)return;const T=x.getShadowPassDepthMode(),A=x.getShadowPassColorMode(),F=x.calculateShadowPassMatrixFromMatrix(r),j=Zu(F);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,T,Pe.disabled,A,Mt.backCCW,j,p.id,d.vertexBuffer,d.indexBuffer,d.segments,p.paint,l.transform.zoom,void 0,void 0)}function mh(d,r,l){const p=r.updateZoomBasedPaintProperties(),x=function(T,A,F){let j,H,q,Y=T.terrain?T.terrain.exaggeration():0;if(T.terrain&&Y>0){const Q=T.terrain,ae=Q.findDEMTileFor(F);ae&&ae.dem?j=o.di.create(Q,F,ae):Y=0}if(Y===0&&(A.terrainElevationMin=0,A.terrainElevationMax=0),Y===A.validForExaggeration&&(Y===0||j&&j._demTile&&j._demTile.tileID===A.validForDEMTile.id&&j._dem._timestamp===A.validForDEMTile.timestamp))return!1;for(const Q in A.instancesPerModel){const ae=A.instancesPerModel[Q];for(let ge=0;ge<ae.instancedDataArray.length;++ge){const _e=(j?Y*j.getElevationAt(0|ae.instancedDataArray.float32[16*ge],0|ae.instancedDataArray.float32[16*ge+1],!0,!0):0)+ae.instancesEvaluatedElevation[ge];ae.instancedDataArray.float32[16*ge+6]=_e,H=H?Math.min(A.terrainElevationMin,_e):_e,q=q?Math.max(A.terrainElevationMax,_e):_e}}return A.terrainElevationMin=H||0,A.terrainElevationMax=q||0,A.validForExaggeration=Y,A.validForDEMTile=j&&j._demTile?{id:j._demTile.tileID,timestamp:j._dem._timestamp}:{id:void 0,timestamp:0},!0}(d,r,l);(p||x)&&(r.uploaded=!1,r.upload(d.context))}const eu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new o.ca([0,0,0],[o.ab,o.ab,0])};function ms(d,r){const l=1<<d.canonical.z,p=r.getFreeCameraOptions().position,x=r.elevation,T=d.canonical.x/l,A=(d.canonical.x+1)/l,F=d.canonical.y/l,j=(d.canonical.y+1)/l;let H=r._centerAltitude;if(x){const ae=x.getMinMaxForTile(d);ae&&ae.max>H&&(H=ae.max)}const q=o.ap(p.x,T,A)-p.x,Y=o.ap(p.y,F,j)-p.y,Q=o.bE(H,r.center.lat)-p.z;return r._zoomFromMercatorZ(Math.sqrt(q*q+Y*Y+Q*Q))}function oa(d,r,l,p,x,T,A){const F=d.context,j=d.renderPass==="shadow",H=d.shadowRenderer,q=j&&H?H.getShadowPassDepthMode():new ir(F.gl.LEQUAL,ir.ReadWrite,d.depthRangeFor3D),Y=d.isTileAffectedByFog(T);if(l.meshes)for(const Q of l.meshes){const ae=["MODEL_POSITION_ON_GPU"],ge=[];let _e,Te,we;p.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");const ze=Oa(d,r.paint.get("model-cutoff-fade-range"));if(ze.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),j&&H)_e=d.getOrCreateProgram("modelDepth",{defines:ae}),Te=Zu(A.shadowTileMatrix,A.shadowTileMatrix,Float32Array.from(l.matrix)),we=H.getShadowPassColorMode();else{Sc(ae,ge,Q,d,r.lut),_e=d.getOrCreateProgram("model",{defines:ae,overrideFog:Y});const ke=Q.material,He=ke.pbrMetallicRoughness,Ye=r.paint.get("model-opacity"),Ze=r.paint.get("model-emissive-strength").constantOr(0);Te=Ns(T.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,d,Ye,He.baseColorFactor.toRenderColor(null),ke.emissiveFactor,He.metallicFactor,He.roughnessFactor,ke,Ze,r,x),H&&(A.shadowUniformsInitialized?_e.setShadowUniformValues(F,H.getShadowUniformValues()):(H.setupShadows(T.toUnwrapped(),_e,"model-tile",T.overscaledZ),A.shadowUniformsInitialized=!0)),we=ze.shouldRenderCutoff||Ye<1||ke.alphaMode!=="OPAQUE"?Sr.alphaBlended:Sr.unblended}d.uploadCommonUniforms(F,_e,T.toUnwrapped(),null,ze);const Ue=Q.material.doubleSided?Mt.disabled:Mt.backCCW;if(p.instancedDataArray.length>20)ge.push(p.instancedDataBuffer),_e.draw(d,F.gl.TRIANGLES,q,Pe.disabled,we,Ue,Te,r.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,r.paint,d.transform.zoom,void 0,ge,p.instancedDataArray.length);else{const ke=j?"u_instance":"u_normal_matrix";for(let He=0;He<p.instancedDataArray.length;++He)Te[ke]=new Float32Array(p.instancedDataArray.arrayBuffer,64*He,16),_e.draw(d,F.gl.TRIANGLES,q,Pe.disabled,we,Ue,Te,r.id,Q.vertexBuffer,Q.indexBuffer,Q.segments,r.paint,d.transform.zoom,void 0,ge)}}if(l.children)for(const Q of l.children)oa(d,r,Q,p,x,T,A)}const Tc=[1,-1,1];function Ki(d,r,l,p){if(!l.modelManager)return!0;const x=l.modelManager;if(!l.shadowRenderer)return!0;const T=l.shadowRenderer,A=r.aabb;let F=!0,j=d.maxHeight;if(j===0){let q=0;for(const Y in d.instancesPerModel){const Q=x.getModel(Y,p);Q?q=Math.max(q,Math.max(Math.max(Q.aabb.max[0],Q.aabb.max[1]),Q.aabb.max[2])):F=!1}j=d.maxScale*q*1.41+d.maxVerticalOffset,F&&(d.maxHeight=j)}A.max[2]=j,A.min[2]+=d.terrainElevationMin,A.max[2]+=d.terrainElevationMax,o.a6.vec3.transformMat4(A.min,A.min,r.tileMatrix),o.a6.vec3.transformMat4(A.max,A.max,r.tileMatrix);const H=A.intersects(T.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(d.isInsideFirstShadowMapFrustum=H===2),H===0}function Ti(d,r){const l=d.uniformValues.u_cutoff_params[0],p=d.uniformValues.u_cutoff_params[1],x=d.uniformValues.u_cutoff_params[2],T=d.uniformValues.u_cutoff_params[3];return p===l||T===x?1:o.ap(((r-l)/(p-l)-x)/(T-x),0,1)}function Mf(d,r,l,p){if(r.pitch<20)return 1;const x=r.getWorldToCameraMatrix();o.a6.mat4.multiply(x,x,d);const T=o.a6.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let A=o.a6.vec4.transformMat4(o.a6.vec4.create(),T,x),F=A,j=A;T[1]=l.max[1],A=o.a6.vec4.transformMat4(o.a6.vec4.create(),T,x),F=A[1]<F[1]?A:F,j=A[1]>j[1]?A:j,T[0]=l.max[0],A=o.a6.vec4.transformMat4(o.a6.vec4.create(),T,x),F=A[1]<F[1]?A:F,j=A[1]>j[1]?A:j,T[1]=l.min[1],A=o.a6.vec4.transformMat4(o.a6.vec4.create(),T,x),F=A[1]<F[1]?A:F,j=A[1]>j[1]?A:j;const H=o.ap(p[0],0,1),q=100*r.pixelsPerMeter*o.ap(p[1],0,1),Y=o.ap(p[2],0,1),Q=o.a6.vec4.lerp(o.a6.vec4.create(),F,j,H),ae=Math.tan(.5*r.fovX),ge=-Q[2]*ae;if(q===0)return Q[1]<-Math.abs(ge)?Y:1;const _e=(-Math.abs(ge)-Q[1])/q,Te=(ze,Ue,ke)=>(1-ke)*ze+ke*Ue,we=o.ap(Te(1,Y,_e),Y,1);return Te(1,we,o.ap((r.pitch-20)/20,0,1))}class xu{}class bu{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,p){{const Y=this._storage.get(l.id);if(Y)return Y.lastUsedFrameIdx=r,Y.buf}const x=p.gl,T=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),A=new ArrayBuffer(T),F=new Int16Array(A);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(A));const j=new o.dk;for(let Y=0;Y<T/2;Y+=3){const Q=F[Y],ae=F[Y+1],ge=F[Y+2];j.emplaceBack(Q,ae),j.emplaceBack(ae,ge),j.emplaceBack(ge,Q)}const H=p.bindVertexArrayOES.current,q=new xu;return q.buf=new Sa(p,j),q.lastUsedFrameIdx=r,this._storage.set(l.id,q),p.bindVertexArrayOES.set(H),q.buf}update(r){for(const[l,p]of this._storage)r-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class Oo{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}class ka{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const Ta={symbol:function(d,r,l,p,x){if(d.renderPass!=="translucent")return;const T=Pe.disabled,A=d.colorModeForRenderPass(),F=l.layout.get("text-variable-anchor"),j=l.layout.get("text-size-scale-range"),H=o.ap(d.scaleFactor,j[0],j[1]);F&&function(Q,ae,ge,_e,Te,we,ze,Ue){const ke=ae.transform,He=Te==="map",Ye=we==="map";for(const Ze of Q){const Qe=_e.getTile(Ze),it=Qe.getBucket(ge);if(!it||!it.text||!it.text.segments.get().length)continue;const ft=o.bk(it.textSizeData,ke.zoom,Ue),st=ts(Ze,it.getProjection(),ke),at=ke.calculatePixelsToTileUnitsMatrix(Qe),Rt=ai(st,Qe.tileID.canonical,Ye,He,ke,it.getProjection(),at),$t=it.hasIconTextFit()&&it.hasIconData();if(ft){const sn=Math.pow(2,ke.zoom-Qe.tileID.overscaledZ);hd(it,He,Ye,ze,o.cS,ke,Rt,Ze,sn,ft,$t)}}}(p,d,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),x,H);const q=l.paint.get("icon-opacity").constantOr(1)!==0,Y=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(q||Y)?uh(d,r,l,p,T,A):(q&&uh(d,r,l,p,T,A,{onlyIcons:!0}),Y&&uh(d,r,l,p,T,A,{onlyText:!0})),r.map.showCollisionBoxes&&($s(d,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),$s(d,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(d,r,l,p){if(d.renderPass!=="translucent")return;const x=l.paint.get("circle-opacity"),T=l.paint.get("circle-stroke-width"),A=l.paint.get("circle-stroke-opacity"),F=l.layout.get("circle-sort-key").constantOr(1)!==void 0,j=l.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(T.constantOr(1)===0||A.constantOr(1)===0))return;const H=d.context,q=H.gl,Y=d.transform,Q=d.depthModeForSublayer(0,ir.ReadOnly),ae=Pe.disabled,ge=d.colorModeForDrapableLayerRenderPass(j),_e=Y.projection.name==="globe",Te=[o.am(Y.center.lng),o.at(Y.center.lat)],we=[];for(let Ue=0;Ue<p.length;Ue++){const ke=p[Ue],He=r.getTile(ke),Ye=He.getBucket(l);if(!Ye||Ye.projection.name!==Y.projection.name)continue;const Ze=Ye.programConfigurations.get(l.id),Qe=o.cT(l),it=d.isTileAffectedByFog(ke);_e&&Qe.push("PROJECTION_GLOBE_VIEW"),Qe.push("DEPTH_D24"),d.terrain&&Y.depthOcclusionForSymbolsAndCircles&&Qe.push("DEPTH_OCCLUSION");const ft=d.getOrCreateProgram("circle",{config:Ze,defines:Qe,overrideFog:it}),st=Ye.layoutVertexBuffer,at=Ye.globeExtVertexBuffer,Rt=Ye.indexBuffer,$t=Y.projection.createInversionMatrix(Y,ke.canonical),sn={programConfiguration:Ze,program:ft,layoutVertexBuffer:st,globeExtVertexBuffer:at,indexBuffer:Rt,uniformValues:o.cU(d,ke,He,$t,Te,l),tile:He};if(F){const _n=Ye.segments.get();for(const yn of _n)we.push({segments:new o.b2([yn]),sortKey:yn.sortKey,state:sn})}else we.push({segments:Ye.segments,sortKey:0,state:sn})}F&&we.sort((Ue,ke)=>Ue.sortKey-ke.sortKey);const ze={useDepthForOcclusion:Y.depthOcclusionForSymbolsAndCircles};for(const Ue of we){const{programConfiguration:ke,program:He,layoutVertexBuffer:Ye,globeExtVertexBuffer:Ze,indexBuffer:Qe,uniformValues:it,tile:ft}=Ue.state,st=Ue.segments;d.terrain&&d.terrain.setupElevationDraw(ft,He,ze),d.uploadCommonUniforms(H,He,ft.tileID.toUnwrapped()),He.draw(d,q.TRIANGLES,Q,ae,ge,Mt.disabled,it,l.id,Ye,Qe,st,l.paint,Y.zoom,ke,[Ze])}},heatmap:function(d,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const x=d.context,T=x.gl,A=Pe.disabled,F=new Sr([T.ONE,T.ONE,T.ONE,T.ONE],o.bA.transparent,[!0,!0,!0,!0]);(function(ae,ge,_e,Te){const we=ae.gl,ze=ge.width*Te,Ue=ge.height*Te;ae.activeTexture.set(we.TEXTURE1),ae.viewport.set([0,0,ze,Ue]);let ke=_e.heatmapFbo;if(!ke||ke&&(ke.width!==ze||ke.height!==Ue)){ke&&ke.destroy();const He=we.createTexture();we.bindTexture(we.TEXTURE_2D,He),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,we.LINEAR),ke=_e.heatmapFbo=ae.createFramebuffer(ze,Ue,!0,null),function(Ye,Ze,Qe,it,ft,st){const at=Ye.gl;at.texImage2D(at.TEXTURE_2D,0,Ye.extRenderToTextureHalfFloat?at.RGBA16F:at.RGBA,ft,st,0,at.RGBA,Ye.extRenderToTextureHalfFloat?at.HALF_FLOAT:at.UNSIGNED_BYTE,null),it.colorAttachment.set(Qe)}(ae,0,He,ke,ze,Ue)}else we.bindTexture(we.TEXTURE_2D,ke.colorAttachment.get()),ae.bindFramebuffer.set(ke.framebuffer)})(x,d,l,d.transform.projection.name==="globe"?.5:.25),x.clear({color:o.bA.transparent});const j=d.transform,H=j.projection.name==="globe",q=H?["PROJECTION_GLOBE_VIEW"]:[],Y=H?Mt.frontCCW:Mt.disabled,Q=[o.am(j.center.lng),o.at(j.center.lat)];for(let ae=0;ae<p.length;ae++){const ge=p[ae];if(r.hasRenderableParent(ge))continue;const _e=r.getTile(ge),Te=_e.getBucket(l);if(!Te||Te.projection.name!==j.projection.name)continue;const we=d.isTileAffectedByFog(ge),ze=Te.programConfigurations.get(l.id),Ue=d.getOrCreateProgram("heatmap",{config:ze,defines:q,overrideFog:we}),{zoom:ke}=d.transform;d.terrain&&d.terrain.setupElevationDraw(_e,Ue),d.uploadCommonUniforms(x,Ue,ge.toUnwrapped());const He=j.projection.createInversionMatrix(j,ge.canonical);Ue.draw(d,T.TRIANGLES,ir.disabled,A,F,Y,sd(d,ge,_e,He,Q,ke,l.paint.get("heatmap-intensity")),l.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,l.paint,d.transform.zoom,ze,H?[Te.globeExtVertexBuffer]:null)}x.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(x,T){const A=x.context,F=A.gl,j=T.heatmapFbo;if(!j)return;A.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,j.colorAttachment.get()),A.activeTexture.set(F.TEXTURE1);let H=T.colorRampTexture;H||(H=T.colorRampTexture=new o.T(A,T.colorRamp,F.RGBA8)),H.bind(F.LINEAR,F.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,F.TRIANGLES,ir.disabled,Pe.disabled,x.colorModeForRenderPass(),Mt.disabled,((q,Y,Q,ae)=>({u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}))(0,T),T.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,T.paint,x.transform.zoom)}(d,l))},line:function(d,r,l,p){if(d.renderPass!=="translucent")return;const x=l.paint.get("line-opacity"),T=l.paint.get("line-width");if(x.constantOr(1)===0||T.constantOr(1)===0)return;const A=l.paint.get("line-emissive-strength"),F=l.paint.get("line-occlusion-opacity"),j=l.layout.get("line-elevation-reference")==="sea",H=d.context,q=H.gl,Y=!l.isDraped();if(Y&&d.transform.projection.name==="globe")return;const Q=l.layout.get("line-cross-slope"),ae=Q!==void 0,ge=Q<1,_e=Y?new ir(d.depthOcclusion?q.GREATER:q.LEQUAL,ir.ReadOnly,d.depthRangeFor3D):d.depthModeForSublayer(0,ir.ReadOnly),Te=d.colorModeForDrapableLayerRenderPass(A),we=d.terrain&&d.terrain.renderingToTexture,ze=we?1:o.q.devicePixelRatio,Ue=l.paint.get("line-dasharray"),ke=Ue.constantOr(1),He=l.layout.get("line-cap"),Ye=Ue.constantOr(null),Ze=He.constantOr(null),Qe=l.paint.get("line-pattern"),it=Qe.constantOr(1),ft=Qe.constantOr(null),st=l.paint.get("line-opacity").constantOr(1);let at=!it&&st!==1||d.depthOcclusion&&F>0&&F<1;const Rt=l.paint.get("line-gradient"),$t=it?"linePattern":"line",sn=o.cV(l);let _n;if(we&&d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(at=!1),F!==0&&d.depthOcclusion){const yt=l.paint._values["line-opacity"];yt&&yt.value&&yt.value.kind==="constant"?_n=yt.value:o.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if(Y&&(d.forceTerrainMode=!0),!Y&&F!==0&&d.terrain&&!we)return void o.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`);const yn=at&&Y?d.stencilModeFor3D():Pe.disabled;Y&&(sn.push("ELEVATED"),ae&&sn.push(ge?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),j&&sn.push("ELEVATION_REFERENCE_SEA"));for(const yt of p){const Qt=r.getTile(yt);if(it&&!Qt.patternsLoaded())continue;const jt=Qt.getBucket(l);if(!jt)continue;d.prepareDrawTile();const tn=jt.programConfigurations.get(l.id),rn=d.isTileAffectedByFog(yt),en=d.getOrCreateProgram($t,{config:tn,defines:sn,overrideFog:rn,overrideRtt:!Y&&void 0});if(ft&&Qt.imageAtlas){const On=Qt.imageAtlas.patternPositions[ft.toString()];On&&tn.setConstantPatternPositions(On)}if(!it&&Ye&&Ze&&Qt.lineAtlas){const On=Qt.lineAtlas.getDash(Ye,Ze);On&&tn.setConstantPatternPositions(On)}let[bn,er]=l.paint.get("line-trim-offset");(Ze==="round"||Ze==="square")&&bn!==er&&(bn===0&&(bn-=1),er===1&&(er+=1));const or=we?yt.projMatrix:null,Nn=it?o.cW(d,Qt,l,or,ze,[bn,er]):o.cX(d,Qt,l,or,jt.lineClipsArray.length,ze,[bn,er]);if(Rt){const On=jt.gradients[l.id];let pr=On.texture;if(l.gradientVersion!==On.version){let kr=256;if(l.stepInterpolant){const si=r.getSource().maxzoom,Si=yt.canonical.z===si?Math.ceil(1<<d.transform.maxZoom-yt.canonical.z):1;kr=o.ap(o.cY(jt.maxLineLength/o.ab*1024*Si),256,H.maxTextureSize)}On.gradient=o.cZ({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:kr,image:On.gradient||void 0,clips:jt.lineClipsArray}),On.texture?On.texture.update(On.gradient):On.texture=new o.T(H,On.gradient,q.RGBA8),On.version=l.gradientVersion,pr=On.texture}H.activeTexture.set(q.TEXTURE1),pr.bind(l.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}ke&&(H.activeTexture.set(q.TEXTURE0),Qt.lineAtlasTexture&&Qt.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),tn.updatePaintBuffers()),it&&(H.activeTexture.set(q.TEXTURE0),Qt.imageAtlasTexture&&Qt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),tn.updatePaintBuffers()),Y&&!j&&d.terrain.setupElevationDraw(Qt,en),d.uploadCommonUniforms(H,en,yt.toUnwrapped());const ar=On=>{_n!=null&&(_n.value=st*F),en.draw(d,q.TRIANGLES,_e,On,Te,Mt.disabled,Nn,l.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,l.paint,d.transform.zoom,tn,[jt.layoutVertexBuffer2,jt.patternVertexBuffer,jt.zOffsetVertexBuffer]),_n!=null&&(_n.value=st)};if(at&&!Y){const On=d.stencilModeForClipping(yt).ref;On===0&&we&&H.clear({stencil:0});const pr={func:q.EQUAL,mask:255};Nn.u_alpha_discard_threshold=.8,ar(new Pe(pr,On,255,q.KEEP,q.KEEP,q.INVERT)),Nn.u_alpha_discard_threshold=0,ar(new Pe(pr,On,255,q.KEEP,q.KEEP,q.KEEP))}else at&&Y&&(Nn.u_alpha_discard_threshold=.001),ar(Y?yn:d.stencilModeForClipping(yt))}Y&&(d.forceTerrainMode=!1),at&&(d.resetStencilClippingMasks(),we&&H.clear({stencil:0})),F===0||d.depthOcclusion||we||d.layersWithOcclusionOpacity.push(d.currentLayer)},fill:function(d,r,l,p){const x=l.paint.get("fill-color"),T=l.paint.get("fill-opacity"),A=l.is3D(),F=new ir(d.context.gl.LEQUAL,ir.ReadWrite,d.depthRangeFor3D);if(T.constantOr(1)===0)return;const j=l.paint.get("fill-emissive-strength"),H=d.colorModeForDrapableLayerRenderPass(j),q=l.paint.get("fill-pattern"),Y=d.opaquePassEnabledForLayer()&&!q.constantOr(1)&&x.constantOr(o.bA.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===Y){const Q=A?F:d.depthModeForSublayer(1,d.renderPass==="opaque"?ir.ReadWrite:ir.ReadOnly);bf(d,r,l,p,Q,H,!1)}if(!A&&d.renderPass==="translucent"&&l.paint.get("fill-antialias")){const Q=A?F:d.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,ir.ReadOnly);bf(d,r,l,p,Q,H,!0)}},"fill-extrusion":function(d,r,l,p){const x=l.paint.get("fill-extrusion-opacity"),T=d.context,A=T.gl,F=d.terrain,j=F&&F.renderingToTexture;if(x===0)return;const H=d.conflationActive&&d.style.isLayerClipped(l,r.getSource()),q=d.style.order.indexOf(l.fqid);if(H&&function(Y,Q,ae,ge,_e){for(const Te of ge){const we=Q.getTile(Te).getBucket(ae);we&&(we.updateReplacement(Te,Y.replacementSource,_e),we.uploadCentroid(Y.context))}}(d,r,l,p,q),F||H)for(const Y of p){const Q=r.getTile(Y).getBucket(l);Q&&hh(d.context,r,Y,Q,l,F,H)}if(d.renderPass==="shadow"&&d.shadowRenderer){const Y=d.shadowRenderer;if(F&&x<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof o.a4)return;const Q=Y.getShadowPassDepthMode(),ae=Y.getShadowPassColorMode();$a(d,r,l,p,Q,Pe.disabled,ae,H)}else if(d.renderPass==="translucent"){const Y=!l.paint.get("fill-extrusion-pattern").constantOr(1),Q=l.paint.get("fill-extrusion-color").constantOr(o.bA.white);if(!j&&Q.a!==0){const ae=new ir(d.context.gl.LEQUAL,ir.ReadWrite,d.depthRangeFor3D);x===1&&Y?$a(d,r,l,p,ae,Pe.disabled,Sr.unblended,H):($a(d,r,l,p,ae,Pe.disabled,Sr.disabled,H),$a(d,r,l,p,ae,d.stencilModeFor3D(),d.colorModeForRenderPass(),H),d.resetStencilClippingMasks())}if(d.style.enable3dLights()&&Y&&(!F&&d.transform.projection.name!=="globe"||j)){const ae=l.paint.get("fill-extrusion-opacity"),ge=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Te=l.paint.get("fill-extrusion-flood-light-intensity"),we=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),ze=ge>0&&_e>0,Ue=Te>0,ke=(Ye,Ze,Qe)=>(1-Qe)*Ye+Qe*Ze,He=Ye=>{const Ze=d.depthModeForSublayer(1,ir.ReadOnly,A.LEQUAL,!0),Qe=l.paint.get(Ye?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),it=ke(.1,3,Qe),ft=d._showOverdrawInspector;if(!ft){const st=new Pe({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),at=new Sr([A.ONE,A.ONE,A.ONE,A.ONE],o.bA.transparent,[!1,!1,!1,!0],A.MIN);rl(d,r,l,p,Ze,st,at,Mt.disabled,Ye,"sdf",ae,ge,_e,Te,we,it,H,!1)}{const st=ft?Pe.disabled:new Pe({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),at=ft?d.colorModeForRenderPass():new Sr([A.ONE_MINUS_DST_ALPHA,A.DST_ALPHA,A.ONE,A.ONE],o.bA.transparent,[!0,!0,!0,!0]);rl(d,r,l,p,Ze,st,at,Mt.disabled,Ye,"color",ae,ge,_e,Te,we,it,H,!1)}};if(j){const Ye=(Ze,Qe,it)=>{const ft=d.depthModeForSublayer(1,ir.ReadOnly,A.LEQUAL,!1),st=l.paint.get(Ze?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),at=ke(.1,3,st);{const Rt=new Sr([A.ONE,A.ONE,A.ONE,A.ONE],o.bA.transparent,[!1,!1,!1,!0]);rl(d,r,l,p,ft,Pe.disabled,Rt,Mt.disabled,Ze,"clear",ae,ge,_e,Te,we,at,H,Qe)}{const Rt=new Pe({func:A.ALWAYS,mask:255},255,255,A.KEEP,A.KEEP,A.REPLACE),$t=new Sr([A.ONE,A.ONE,A.ONE,A.ONE],o.bA.transparent,[!1,!1,!1,!0],A.MIN);rl(d,r,l,p,ft,Rt,$t,Mt.disabled,Ze,"sdf",ae,ge,_e,Te,we,at,H,Qe)}{const Rt=Ze?A.ZERO:A.ONE_MINUS_DST_ALPHA,$t=new Pe({func:A.EQUAL,mask:255},255,255,A.KEEP,A.DECR,A.DECR),sn=new Sr([Rt,A.DST_ALPHA,A.ONE_MINUS_DST_ALPHA,A.ZERO],o.bA.transparent,[!0,!0,!0,!0]);rl(d,r,l,p,ft,$t,sn,Mt.disabled,Ze,"color",ae,ge,_e,Te,we,at,H,Qe)}{const Rt=new Sr([A.ONE,A.ONE,A.ONE,Ze?A.ZERO:A.ONE],o.bA.transparent,[!1,!1,!1,!0],Ze?A.FUNC_ADD:A.MAX);rl(d,r,l,p,ft,Pe.disabled,Rt,Mt.disabled,Ze,"clear",ae,ge,_e,Te,we,at,H,Qe,it)}};if(ze||Ue){let Ze;if(d.prepareDrawTile(),F){const Qe=F.drapeBufferSize[0],it=F.drapeBufferSize[1];Ze=F.framebufferCopyTexture,Ze&&(!Ze||Ze.size[0]===Qe&&Ze.size[1]===it)||(Ze&&Ze.destroy(),Ze=F.framebufferCopyTexture=new o.T(T,new o.r({width:Qe,height:it}),A.RGBA8)),Ze.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.copyTexSubImage2D(A.TEXTURE_2D,0,0,0,0,0,Qe,it)}ze&&Ye(!0,!1,Ze),Ue&&Ye(!1,!0,Ze)}}else ze&&He(!0),Ue&&He(!1),(ze||Ue)&&d.resetStencilClippingMasks()}}},hillshade:function(d,r,l,p){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent"||d.style.disableElevatedTerrain)return;const x=d.context,T=d.terrain&&d.terrain.renderingToTexture,[A,F]=d.renderPass!=="translucent"||T?[{},p]:d.stencilConfigForOverlap(p);for(const j of F){const H=r.getTile(j);if(H.needsHillshadePrepare&&d.renderPass==="offscreen")zs(d,H,l);else if(d.renderPass==="translucent"){const q=d.depthModeForSublayer(0,ir.ReadOnly),Y=l.paint.get("hillshade-emissive-strength"),Q=d.colorModeForDrapableLayerRenderPass(Y),ae=T&&d.terrain?d.terrain.stencilModeForRTTOverlap(j):A[j.overscaledZ];pl(d,j,H,l,q,ae,Q)}}x.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,r,l,p,x,T){if(d.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const A=d.transform.projection.name==="globe",F=l.paint.get("raster-elevation")!==0,j=F&&A;if(d.renderElevatedRasterBackface&&!j)return;const H=d.context,q=H.gl,Y=r.getSource(),Q=function(Ye,Ze,Qe,it){const ft=Ze.paint.get("raster-color"),st=Ye.type==="raster-array",at=[],Rt=Ze.paint.get("raster-resampling"),$t=Ze.paint.get("raster-color-mix");let sn=Ze.paint.get("raster-color-range");const _n=[$t[0],$t[1],$t[2],0],yn=$t[3];let yt=Rt==="nearest"?it.NEAREST:it.LINEAR;if(st&&(at.push("RASTER_ARRAY"),ft||at.push("RASTER_COLOR"),Rt==="linear"&&at.push("RASTER_ARRAY_LINEAR"),yt=it.NEAREST,!sn&&Ye.rasterLayers)){const Qt=Ye.rasterLayers.find(({id:jt})=>jt===Ze.sourceLayer);Qt&&Qt.fields&&Qt.fields.range&&(sn=Qt.fields.range)}if(sn=sn||[0,1],ft){at.push("RASTER_COLOR"),Qe.activeTexture.set(it.TEXTURE2),Ze.updateColorRamp(sn);let Qt=Ze.colorRampTexture;Qt||(Qt=Ze.colorRampTexture=new o.T(Qe,Ze.colorRamp,it.RGBA8)),Qt.bind(it.LINEAR,it.CLAMP_TO_EDGE)}return{mix:_n,range:sn,offset:yn,defines:at,resampling:yt}}(Y,l,H,q);if(Y instanceof o.aD&&!p.length&&!A)return;const ae=l.paint.get("raster-emissive-strength"),ge=d.colorModeForDrapableLayerRenderPass(ae),_e=d.terrain&&d.terrain.renderingToTexture,Te=!d.options.moving,we=l.paint.get("raster-resampling")==="nearest"?q.NEAREST:q.LINEAR;if(Y instanceof o.aD&&!p.length&&(Y.onNorthPole||Y.onSouthPole)){const Ye=F?d.stencilModeFor3D():Pe.disabled;return void Po(!!Y.onNorthPole,null,d,r,l,ae,Q,Mt.disabled,Ye)}if(!p.length)return;const[ze,Ue]=Y instanceof o.aD||_e?[{},p]:d.stencilConfigForOverlap(p),ke=Ue[Ue.length-1].overscaledZ;j&&Q.defines.push("PROJECTION_GLOBE_VIEW"),F&&Q.defines.push("RENDER_CUTOFF");const He=(Ye,Ze,Qe)=>{for(const it of Ye){const ft=it.toUnwrapped(),st=r.getTile(it);if(_e&&(!st||!st.hasData()))continue;H.activeTexture.set(q.TEXTURE0);const at=fd(st,Y,l,Q);if(!at||!at.texture)continue;const{texture:Rt,mix:$t,offset:sn,tileSize:_n,buffer:yn}=at;let yt,Qt;_e?(yt=ir.disabled,Qt=it.projMatrix):F?(yt=new ir(q.LEQUAL,ir.ReadWrite,d.depthRangeFor3D),Qt=A?Float32Array.from(d.transform.expandedFarZProjMatrix):d.transform.calculateProjMatrix(ft,Te)):(yt=d.depthModeForSublayer(it.overscaledZ-ke,l.paint.get("raster-opacity")===1?ir.ReadWrite:ir.ReadOnly,q.LESS),Qt=d.transform.calculateProjMatrix(ft,Te));const jt=d.terrain&&_e?d.terrain.stencilModeForRTTOverlap(it):ze[it.overscaledZ],tn=T?0:l.paint.get("raster-fade-duration");st.registerFadeDuration(tn);const rn=r.findLoadedParent(it,0),en=Zl(st,rn,r,d.transform,tn);let bn,er;d.terrain&&d.terrain.prepareDrawTile(),H.activeTexture.set(q.TEXTURE0),Rt.bind(we,q.CLAMP_TO_EDGE),H.activeTexture.set(q.TEXTURE1),rn?(rn.texture&&rn.texture.bind(we,q.CLAMP_TO_EDGE),bn=Math.pow(2,rn.tileID.overscaledZ-st.tileID.overscaledZ),er=[st.tileID.canonical.x*bn%1,st.tileID.canonical.y*bn%1]):Rt.bind(we,q.CLAMP_TO_EDGE),Rt.useMipmap&&H.extTextureFilterAnisotropic&&d.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const or=d.transform;let Nn;const ar=F?Xu(or):[0,0,0,0];let On,pr,kr,si,Si,fr=0;if(j&&Y instanceof o.aD&&Y.coordinates.length>3)On=Float32Array.from(o.b6(o.cC(new o.bQ(0,0,0)))),pr=Float32Array.from(or.globeMatrix),kr=Float32Array.from(o.cy(or)),si=[o.am(or.center.lng),o.at(or.center.lat)],Nn=Y.elevatedGlobePerspectiveTransform,Si=Y.elevatedGlobeGridMatrix||new Float32Array(9);else if(j){const Rr=o.cz(it.canonical);fr=o.cA(Rr.getCenter().lat),On=Float32Array.from(o.b6(o.cC(it.canonical))),pr=Float32Array.from(or.globeMatrix),kr=Float32Array.from(o.cy(or)),si=[o.am(or.center.lng),o.at(or.center.lat)],Nn=[0,0],Si=Float32Array.from(o.cB(it.canonical,Rr,fr,or.worldSize/or._pixelsPerMercatorPixel))}else Nn=Y instanceof o.aD?Y.perspectiveTransform:[0,0],On=new Float32Array(16),pr=new Float32Array(9),kr=new Float32Array(16),si=[0,0],Si=new Float32Array(9);const hi=Al(Qt,On,pr,kr,Si,er||[0,0],o.a9(d.transform.zoom),si,ar,bn||1,en,l,Nn,F?l.paint.get("raster-elevation"):0,2,$t,sn,Q.range,_n,yn,ae),Nr=d.isTileAffectedByFog(it),li=d.getOrCreateProgram("raster",{defines:Q.defines,overrideFog:Nr});if(d.uploadCommonUniforms(H,li,ft),Y instanceof o.aD){const Rr=Y.elevatedGlobeVertexBuffer,Li=Y.elevatedGlobeIndexBuffer;if(_e||!A)Y.boundsBuffer&&Y.boundsSegments&&li.draw(d,q.TRIANGLES,yt,Pe.disabled,ge,Mt.disabled,hi,l.id,Y.boundsBuffer,d.quadTriangleIndexBuffer,Y.boundsSegments);else if(Rr&&Li){const Qr=or.zoom<=o.c3?Y.elevatedGlobeSegments:Y.getSegmentsForLongitude(or.center.lng);Qr&&li.draw(d,q.TRIANGLES,yt,Pe.disabled,ge,Ze,hi,l.id,Rr,Li,Qr)}}else if(j){yt=new ir(q.LEQUAL,ir.ReadOnly,d.depthRangeFor3D);const Rr=d.globeSharedBuffers;if(Rr){const[Li,Qr,Ei]=Rr.getGridBuffers(fr,!1);li.draw(d,q.TRIANGLES,yt,Qe||jt,d.colorModeForRenderPass(),Ze,hi,l.id,Li,Qr,Ei)}}else{const{tileBoundsBuffer:Rr,tileBoundsIndexBuffer:Li,tileBoundsSegments:Qr}=d.getTileBoundsBuffers(st);li.draw(d,q.TRIANGLES,yt,jt,ge,Mt.disabled,hi,l.id,Rr,Li,Qr)}}if(!(Y instanceof o.aD)&&j)for(const it of Ye){const ft=it.canonical.y===(1<<it.canonical.z)-1;it.canonical.y===0&&Po(!0,it,d,r,l,ae,Q,Ze,Qe||Pe.disabled),ft&&Po(!1,it,d,r,l,ae,Q,Ze===Mt.frontCW?Mt.backCW:Mt.frontCW,Qe||Pe.disabled)}};j?He(Ue,d.renderElevatedRasterBackface?Mt.backCW:Mt.frontCW,d.stencilModeFor3D()):He(Ue,Mt.disabled,void 0),d.resetStencilClippingMasks()},"raster-particle":function(d,r,l,p,x,T){d.renderPass==="offscreen"&&function(A,F,j,H){if(!H.length)return;const q=A.context,Y=q.gl,Q=F.getSource();if(!(Q instanceof Ir))return;const ae=Math.ceil(Math.sqrt(j.paint.get("raster-particle-count")));let ge=j.particlePositionRGBAImage;if(!ge||ge.width!==ae){const Ue=function(ke){const He=ke*ke,Ye=new Uint8Array(4*He),Ze=function(it){return it|=0,it=Math.imul(2747636419^it,2654435769),it=Math.imul(it^it>>>16,2654435769),((it=Math.imul(it^it>>>16,2654435769))>>>0)/4294967296},Qe=1/1.1;for(let it=0;it<He;it++){const ft=Qe*(Ze(2*it+0)+Wu),st=Qe*(Ze(2*it+1)+Wu),at=255*ft%1,Rt=255*st%1,$t=at,sn=st-Rt/255,_n=Rt;Ye[4*it+0]=255*(ft-at/255),Ye[4*it+1]=255*$t,Ye[4*it+2]=255*sn,Ye[4*it+3]=255*_n}return Ye}(ae);ge=j.particlePositionRGBAImage=new o.r({width:ae,height:ae},Ue)}let _e=j.particleFramebuffer;_e?_e.width!==ae&&(_e.destroy(),_e=j.particleFramebuffer=q.createFramebuffer(ae,ae,!0,null)):_e=j.particleFramebuffer=q.createFramebuffer(ae,ae,!0,null);const Te=[];for(const Ue of H){const ke=F.getTile(Ue);if(!(ke instanceof nn))continue;const He=dh(ke,Q,j);if(!He)continue;const Ye=[ke.tileSize,ke.tileSize];let Ze=j.tileFramebuffer;Ze||(Ze=j.tileFramebuffer=q.createFramebuffer(Ye[0],Ye[1],!0,null));let Qe=ke.rasterParticleState;Qe||(Qe=ke.rasterParticleState=new Ef(q,Ue,Ye,ge));const it=Qe.update(j.lastInvalidatedAt);Qe.particleTextureDimension!==ae&&Qe.updateParticleTexture(Ue,ge);const ft=Qe.targetColorTexture;Qe.targetColorTexture=Qe.backgroundColorTexture,Qe.backgroundColorTexture=ft;const st=Qe.particleTexture0;Qe.particleTexture0=Qe.particleTexture1,Qe.particleTexture1=st,Te.push([Ue,He,Qe,it])}if(Te.length===0)return;const we=o.q.now(),ze=j.previousDrawTimestamp?.001*(we-j.previousDrawTimestamp):.0167;if(j.previousDrawTimestamp=we,j.hasColorMap()){q.activeTexture.set(Y.TEXTURE0+2);let Ue=j.colorRampTexture;Ue||(Ue=j.colorRampTexture=new o.T(q,j.colorRamp,Y.RGBA8)),Ue.bind(Y.LINEAR,Y.CLAMP_TO_EDGE)}q.bindFramebuffer.set(j.tileFramebuffer.framebuffer),function(Ue,ke,He){const Ye=Ue.context,Ze=Ye.gl,Qe=ke.tileFramebuffer;Ye.activeTexture.set(Ze.TEXTURE0);const it={u_texture:0,u_opacity:1.05*(st=ke.paint.get("raster-particle-fade-opacity-factor"))/(st+.05)},ft=Ue.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var st;for(const at of He){const[,,Rt,$t]=at;Qe.colorAttachment.set(Rt.targetColorTexture.texture),Ye.viewport.set([0,0,Qe.width,Qe.height]),Ye.clear({color:o.bA.transparent}),$t&&(Rt.backgroundColorTexture.bind(Ze.NEAREST,Ze.CLAMP_TO_EDGE),ft.draw(Ue,Ze.TRIANGLES,ir.disabled,Pe.disabled,Sr.alphaBlended,Mt.disabled,it,ke.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments))}}(A,j,Te),function(Ue,ke,He,Ye){const Ze=Ue.context,Qe=Ze.gl,it=He.tileFramebuffer,ft=Ue.transform.projection.name==="globe",st=He.paint.get("raster-particle-max-speed");for(const at of Ye){const[Rt,$t,sn]=at;Ze.activeTexture.set(Qe.TEXTURE0+0),$t.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE),it.colorAttachment.set(sn.targetColorTexture.texture);const _n=Ue.getOrCreateProgram("rasterParticleDraw",{defines:$t.defines,overrideFog:!1});Ze.activeTexture.set(Qe.TEXTURE0+1);const yn=$t.scalarData?[]:[0,1,2,3].map(jt=>o.c$[jt](Rt));yn.push(Rt);const yt=Rt.canonical.x,Qt=Rt.canonical.y;for(const jt of yn){const tn=ke.getTile(ft?jt.wrapped():jt);if(!tn)continue;const rn=tn.rasterParticleState;if(!rn)continue;const en=jt.canonical.x+(1<<jt.canonical.z)*(jt.wrap-Rt.wrap),bn=jt.canonical.y;rn.particleTexture0.bind(Qe.NEAREST,Qe.CLAMP_TO_EDGE);const er=ld(1,rn.particleTexture0.size[0],[en-yt,bn-Qt],0,$t.texture.size,2,st,$t.textureOffset,$t.scale,$t.offset);_n.draw(Ue,Qe.POINTS,ir.disabled,Pe.disabled,Sr.alphaBlended,Mt.disabled,er,He.id,rn.particleIndexBuffer,void 0,rn.particleSegment)}}}(A,F,j,Te),q.bindFramebuffer.set(j.particleFramebuffer.framebuffer),function(Ue,ke,He,Ye){const Ze=Ue.context,Qe=Ze.gl,it=ke.paint.get("raster-particle-max-speed"),ft=Ye*ke.paint.get("raster-particle-speed-factor")*.15,st=function(Rt){return Math.pow(Rt,6)}(.01+1*ke.paint.get("raster-particle-reset-rate-factor")),at=ke.particleFramebuffer;Ze.viewport.set([0,0,at.width,at.height]);for(const Rt of He){const[,$t,sn]=Rt;Ze.activeTexture.set(Qe.TEXTURE0+0),$t.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE),Ze.activeTexture.set(Qe.TEXTURE0+1);const _n=sn.particleTexture0;_n.bind(Qe.NEAREST,Qe.CLAMP_TO_EDGE);const yn=gu(1,_n.size[0],0,$t.texture.size,it,ft,st,$t.textureOffset,$t.scale,$t.offset);at.colorAttachment.set(sn.particleTexture1.texture),Ze.clear({color:o.bA.transparent}),Ue.getOrCreateProgram("rasterParticleUpdate",{defines:$t.defines}).draw(Ue,Qe.TRIANGLES,ir.disabled,Pe.disabled,Sr.unblended,Mt.disabled,yn,ke.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments)}}(A,j,Te,ze)}(d,r,l,p),d.renderPass==="translucent"&&(function(A,F,j,H,q){const Y=A.context,Q=Y.gl,ae=F.getSource().tileSize,ge=5*(1-o.a7(o.bV,o.bV+1,A.transform.zoom))*ae+j.paint.get("raster-particle-elevation"),_e=!A.options.moving,Te=A.transform.projection.name==="globe";if(!H.length)return;const[we,ze]=A.stencilConfigForOverlap(H),Ue=[];Te&&Ue.push("PROJECTION_GLOBE_VIEW");const ke=A.stencilModeFor3D();for(const He of ze){const Ye=He.toUnwrapped(),Ze=F.getTile(He);if(!Ze.rasterParticleState)continue;const Qe=Ze.rasterParticleState,it=100;Ze.registerFadeDuration(it);const ft=F.findLoadedParent(He,0),st=Zl(Ze,ft,F,A.transform,it);let at,Rt;A.terrain&&A.terrain.prepareDrawTile(),Y.activeTexture.set(Q.TEXTURE0),Qe.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Y.activeTexture.set(Q.TEXTURE1),ft&&ft.rasterParticleState?(ft.rasterParticleState.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),at=Math.pow(2,ft.tileID.overscaledZ-Ze.tileID.overscaledZ),Rt=[Ze.tileID.canonical.x*at%1,Ze.tileID.canonical.y*at%1]):Qe.targetColorTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const $t=Te?Float32Array.from(A.transform.expandedFarZProjMatrix):A.transform.calculateProjMatrix(Ye,_e),sn=A.transform,_n=ip(sn),yn=o.cz(He.canonical),yt=o.cA(yn.getCenter().lat);let Qt,jt,tn,rn,en;Te?(Qt=Float32Array.from(o.b6(o.cC(He.canonical))),jt=Float32Array.from(sn.globeMatrix),tn=Float32Array.from(o.cy(sn)),rn=[o.am(sn.center.lng),o.at(sn.center.lat)],en=Float32Array.from(o.cB(He.canonical,yn,yt,sn.worldSize/sn._pixelsPerMercatorPixel))):(Qt=new Float32Array(16),jt=new Float32Array(9),tn=new Float32Array(16),rn=[0,0],en=new Float32Array(9));const bn=xf($t,Qt,jt,tn,en,Rt||[0,0],o.a9(A.transform.zoom),rn,_n,at||1,st,ge),er=A.isTileAffectedByFog(He),or=A.getOrCreateProgram("rasterParticle",{defines:Ue,overrideFog:er});if(A.uploadCommonUniforms(Y,or,Ye),Te){const Nn=new ir(Q.LEQUAL,ir.ReadOnly,A.depthRangeFor3D),ar=0,On=A.globeSharedBuffers;if(On){const[pr,kr,si]=On.getGridBuffers(yt,ar!==0);or.draw(A,Q.TRIANGLES,Nn,ke,Sr.alphaBlended,A.renderElevatedRasterBackface?Mt.frontCCW:Mt.backCCW,bn,j.id,pr,kr,si)}}else{const Nn=A.depthModeForSublayer(0,ir.ReadOnly),ar=we[He.overscaledZ],{tileBoundsBuffer:On,tileBoundsIndexBuffer:pr,tileBoundsSegments:kr}=A.getTileBoundsBuffers(Ze);or.draw(A,Q.TRIANGLES,Nn,ar,Sr.alphaBlended,Mt.disabled,bn,j.id,On,pr,kr)}}A.resetStencilClippingMasks()}(d,r,l,p),d.style.map.triggerRepaint())},background:function(d,r,l,p){const x=l.paint.get("background-color"),T=l.paint.get("background-opacity"),A=l.paint.get("background-emissive-strength"),F=l.paint.get("background-pitch-alignment")==="viewport";if(T===0)return;const j=d.context,H=j.gl,q=d.transform,Y=q.tileSize,Q=l.paint.get("background-pattern");let ae;if(Q!==void 0&&(Q===null||(ae=d.imageManager.getPattern(Q.toString(),l.scope,d.style.getLut(l.scope)),!ae)))return;const ge=!Q&&x.a===1&&T===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==ge)return;const _e=Pe.disabled,Te=d.depthModeForSublayer(0,ge==="opaque"?ir.ReadWrite:ir.ReadOnly),we=d.colorModeForDrapableLayerRenderPass(A),ze=Q?"backgroundPattern":"background";let Ue,ke=p;if(ke||(Ue=d.getBackgroundTiles(),ke=Object.values(Ue).map(He=>He.tileID)),Q&&(j.activeTexture.set(H.TEXTURE0),d.imageManager.bind(d.context,l.scope)),F){const He=d.getOrCreateProgram(ze,{overrideFog:!1,overrideRtt:!0}),Ye=new Float32Array(o.a6.mat4.identity([])),Ze=new o.aA(0,0,0,0,0),Qe=Q?xc(Ye,A,T,d,0,l.scope,ae,F,{tileID:Ze,tileSize:Y}):_u(Ye,A,T,x.toRenderColor(l.lut));He.draw(d,H.TRIANGLES,Te,_e,we,Mt.disabled,Qe,l.id,d.viewportBuffer,d.quadTriangleIndexBuffer,d.viewportSegments)}else for(const He of ke){const Ye=d.isTileAffectedByFog(He),Ze=d.getOrCreateProgram(ze,{overrideFog:Ye}),Qe=He.toUnwrapped(),it=p?He.projMatrix:d.transform.calculateProjMatrix(Qe);d.prepareDrawTile();const ft=r?r.getTile(He):Ue?Ue[He.key]:new dt(He,Y,q.zoom,d),st=Q?xc(it,A,T,d,0,l.scope,ae,F,{tileID:He,tileSize:Y}):_u(it,A,T,x.toRenderColor(l.lut));d.uploadCommonUniforms(j,Ze,Qe);const{tileBoundsBuffer:at,tileBoundsIndexBuffer:Rt,tileBoundsSegments:$t}=d.getTileBoundsBuffers(ft);Ze.draw(d,H.TRIANGLES,Te,_e,we,Mt.disabled,st,l.id,at,Rt,$t)}},sky:function(d,r,l){const p=d._atmosphere?o.a9(d.transform.zoom):1,x=l.paint.get("sky-opacity")*p;if(x===0)return;const T=d.context,A=l.paint.get("sky-type"),F=new ir(T.gl.LEQUAL,ir.ReadOnly,[0,1]),j=d.frameCounter/1e3%1;A==="atmosphere"?d.renderPass==="offscreen"?l.needsSkyboxCapture(d)&&(function(H,q,Y,Q){const ae=H.context,ge=ae.gl;let _e=q.skyboxFbo;if(!_e){_e=q.skyboxFbo=ae.createFramebuffer(32,32,!0,null),q.skyboxGeometry=new Yl(ae),q.skyboxTexture=ae.gl.createTexture(),ge.bindTexture(ge.TEXTURE_CUBE_MAP,q.skyboxTexture),ge.texParameteri(ge.TEXTURE_CUBE_MAP,ge.TEXTURE_WRAP_S,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_CUBE_MAP,ge.TEXTURE_WRAP_T,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_CUBE_MAP,ge.TEXTURE_MIN_FILTER,ge.LINEAR),ge.texParameteri(ge.TEXTURE_CUBE_MAP,ge.TEXTURE_MAG_FILTER,ge.LINEAR);for(let Ue=0;Ue<6;++Ue)ge.texImage2D(ge.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,ge.RGBA,32,32,0,ge.RGBA,ge.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(_e.framebuffer),ae.viewport.set([0,0,32,32]);const Te=q.getCenter(H,!0),we=H.getOrCreateProgram("skyboxCapture"),ze=new Float64Array(16);o.a6.mat4.identity(ze),o.a6.mat4.rotateY(ze,ze,.5*-Math.PI),is(H,q,we,ze,Te,0),o.a6.mat4.identity(ze),o.a6.mat4.rotateY(ze,ze,.5*Math.PI),is(H,q,we,ze,Te,1),o.a6.mat4.identity(ze),o.a6.mat4.rotateX(ze,ze,.5*-Math.PI),is(H,q,we,ze,Te,2),o.a6.mat4.identity(ze),o.a6.mat4.rotateX(ze,ze,.5*Math.PI),is(H,q,we,ze,Te,3),o.a6.mat4.identity(ze),is(H,q,we,ze,Te,4),o.a6.mat4.identity(ze),o.a6.mat4.rotateY(ze,ze,Math.PI),is(H,q,we,ze,Te,5),ae.viewport.set([0,0,H.width,H.height])}(d,l),l.markSkyboxValid(d)):d.renderPass==="sky"&&function(H,q,Y,Q,ae){const ge=H.context,_e=ge.gl,Te=H.transform,we=H.getOrCreateProgram("skybox");ge.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,q.skyboxTexture);const ze=((Ue,ke,He,Ye,Ze)=>({u_matrix:Ue,u_sun_direction:ke,u_cubemap:0,u_opacity:Ye,u_temporal_offset:Ze}))(Te.skyboxMatrix,q.getCenter(H,!1),0,Q,ae);H.uploadCommonUniforms(ge,we),we.draw(H,_e.TRIANGLES,Y,Pe.disabled,H.colorModeForRenderPass(),Mt.backCW,ze,"skybox",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(d,l,F,x,j):A==="gradient"&&d.renderPass==="sky"&&function(H,q,Y,Q,ae){const ge=H.context,_e=ge.gl,Te=H.transform,we=H.getOrCreateProgram("skyboxGradient");q.skyboxGeometry||(q.skyboxGeometry=new Yl(ge)),ge.activeTexture.set(_e.TEXTURE0);let ze=q.colorRampTexture;ze||(ze=q.colorRampTexture=new o.T(ge,q.colorRamp,_e.RGBA8)),ze.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Ue=((ke,He,Ye,Ze,Qe)=>({u_matrix:ke,u_color_ramp:0,u_center_direction:He,u_radius:o.bC(Ye),u_opacity:Ze,u_temporal_offset:Qe}))(Te.skyboxMatrix,q.getCenter(H,!1),q.paint.get("sky-gradient-radius"),Q,ae);H.uploadCommonUniforms(ge,we),we.draw(H,_e.TRIANGLES,Y,Pe.disabled,H.colorModeForRenderPass(),Mt.backCW,Ue,"skyboxGradient",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(d,l,F,x,j)},debug:function(d,r,l,p,x,T){for(let A=0;A<l.length;A++)if(x){const H=new o.bA(p.r*.8,p.g*.8,p.b*.8,1);Ni(d,r,l[A],p,-1,-1,T),Ni(d,r,l[A],p,-1,1,T),Ni(d,r,l[A],p,1,1,T),Ni(d,r,l[A],p,1,-1,T),Ni(d,r,l[A],H,0,0,T)}else Ni(d,r,l[A],p,0,0,T)},custom:function(d,r,l,p){const x=d.context,T=l.implementation;if(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes("custom")||d.terrain&&(d.terrain.renderingToTexture||d.renderPass==="offscreen")&&l.isDraped(r)){if(d.renderPass==="offscreen"){const A=T.prerender;if(A){if(d.setCustomLayerDefaults(),x.setColorMode(d.colorModeForRenderPass()),d.transform.projection.name==="globe"){const F=d.transform.pointMerc;A.call(T,x.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),o.a9(d.transform.zoom),[F.x,F.y],d.transform.pixelsPerMeterRatio)}else A.call(T,x.gl,d.transform.customLayerMatrix());x.setDirty(),d.setBaseState()}}else if(d.renderPass==="translucent"){if(d.terrain&&d.terrain.renderingToTexture){const F=T.renderToTile;if(F){const j=p[0].canonical,H=new o.a5(j.x+p[0].wrap*(1<<j.z),j.y,j.z);x.setDepthMode(ir.disabled),x.setStencilMode(Pe.disabled),x.setColorMode(d.colorModeForRenderPass()),d.setCustomLayerDefaults(),F.call(T,x.gl,H),x.setDirty(),d.setBaseState()}return}d.setCustomLayerDefaults(),x.setColorMode(d.colorModeForRenderPass()),x.setStencilMode(Pe.disabled);const A=T.renderingMode==="3d"?new ir(d.context.gl.LEQUAL,ir.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,ir.ReadOnly);if(x.setDepthMode(A),d.transform.projection.name==="globe"){const F=d.transform.pointMerc;T.render(x.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),o.a9(d.transform.zoom),[F.x,F.y],d.transform.pixelsPerMeterRatio)}else T.render(x.gl,d.transform.customLayerMatrix());x.setDirty(),d.setBaseState(),x.bindFramebuffer.set(null)}}else o.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(d,r,l,p){if(d.renderPass==="opaque")return;const x=l.paint.get("model-opacity");if(x===0)return;const T=l.paint.get("model-cast-shadows");if(d.renderPass==="shadow"&&(!T||d.terrain&&x<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof o.a4))return;const A=d.shadowRenderer,F=l.paint.get("model-receive-shadows");A&&(A.useNormalOffset=!0,F||(A.enabled=!1));const j=()=>{A&&(A.useNormalOffset=!0,F||(A.enabled=!0))},H=r.getSource();if(d.renderPass==="light-beam"&&H.type!=="batched-model")return;if(H.type==="vector"||H.type==="geojson")return function(we,ze,Ue,ke,He){const Ye=we.transform;if(Ye.projection.name!=="mercator")return void o.w(`Drawing 3D models for ${Ye.projection.name} projection is not yet implemented`);const Ze=Ye.getFreeCameraOptions().position;if(!we.modelManager)return;const Qe=we.modelManager;Ue.modelManager=Qe;const it=we.shadowRenderer;if(!Ue._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ft=Ue._unevaluatedLayout._values["model-id"],st={...Ue.layout.get("model-id").parameters},at=we.style.order.indexOf(Ue.fqid);for(const Rt of ke){const $t=ze.getTile(Rt).getBucket(Ue);if(!$t||$t.projection.name!==Ye.projection.name)continue;const sn=$t.getModelUris();sn&&!$t.modelsRequested&&(Qe.addModelsFromBucket(sn,He),$t.modelsRequested=!0);const _n=ms(Rt,Ye);st.zoom=_n;const yn=ft.possiblyEvaluate(st);if(mh(we,$t,Rt),eu.shadowUniformsInitialized=!1,eu.useSingleShadowCascade=!!it&&it.getMaxCascadeForTile(Rt.toUnwrapped())===0,we.renderPass==="shadow"&&it){if(we.currentShadowCascade===1&&$t.isInsideFirstShadowMapFrustum)continue;const jt=Ye.calculatePosMatrix(Rt.toUnwrapped(),Ye.worldSize);if(eu.tileMatrix.set(jt),eu.shadowTileMatrix=Float32Array.from(it.calculateShadowPassMatrixFromMatrix(jt)),eu.aabb.min.fill(0),eu.aabb.max[0]=eu.aabb.max[1]=o.ab,eu.aabb.max[2]=0,Ki($t,eu,we,Ue.scope))continue}const yt=1<<Rt.canonical.z,Qt=[((Ze.x-Rt.wrap)*yt-Rt.canonical.x)*o.ab,(Ze.y*yt-Rt.canonical.y)*o.ab,Ze.z*yt*o.ab];we.conflationActive&&Object.keys($t.instancesPerModel).length>0&&we.style.isLayerClipped(Ue,ze.getSource())&&$t.updateReplacement(Rt,we.replacementSource,at,He)&&($t.uploaded=!1,$t.upload(we.context));for(let jt in $t.instancesPerModel){const tn=$t.instancesPerModel[jt];tn.features.length>0&&(jt=yn.evaluate(tn.features[0].feature,{}));const rn=Qe.getModel(jt,He);if(rn&&rn.uploaded)for(const en of rn.nodes)oa(we,Ue,en,tn,Qt,Rt,eu)}}}(d,r,l,p,H.type==="vector"?l.scope:""),void j();if(!H.loaded())return;if(H.type==="batched-model")return function(we,ze,Ue,ke){Ue.resetLayerRenderingStats(we);const He=we.context,Ye=we.transform,Ze=we.style.fog,Qe=we.shadowRenderer;if(Ye.projection.name!=="mercator")return void o.w(`Drawing 3D landmark models for ${Ye.projection.name} projection is not yet implemented`);const it=we.transform.getFreeCameraOptions().position,ft=o.a6.vec3.scale([],[it.x,it.y,it.z],we.transform.worldSize),st=o.a6.vec3.negate([],ft),at=o.a6.mat4.identity([]),Rt=o.de(Ye.center.lat,Ye.zoom),$t=o.a6.mat4.fromScaling([],[1,1,1/Rt]);o.a6.mat4.translate(at,at,st);const sn=Ue.paint.get("model-opacity"),_n=new ir(He.gl.LEQUAL,ir.ReadWrite,we.depthRangeFor3D),yn=new ir(He.gl.LEQUAL,ir.ReadOnly,we.depthRangeFor3D),yt=new o.ca([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Qt=we.renderPass==="shadow",jt=Qt&&Qe?Qe.getCurrentCascadeFrustum():Ye.getFrustum(Ye.scaleZoom(Ye.worldSize)),tn=Ue.paint.get("model-front-cutoff"),rn=tn[2]<1,en=Oa(we,Ue.paint.get("model-cutoff-fade-range")),bn=Ue.getLayerRenderingStats();(function(er,or,Nn,ar){const On=er.terrain?er.terrain.exaggeration():0,pr=er.transform.zoom;for(const kr of ar){const si=or.getTile(kr).getBucket(Nn);si&&(er.conflationActive&&si.updateReplacement(kr,er.replacementSource),si.evaluateScale(er,Nn),er.terrain&&On>0&&si.elevationUpdate(er.terrain,On,kr,Nn.source),si.needsReEvaluation(er,pr,Nn)&&si.evaluate(Nn))}})(we,ze,Ue,ke),function(){let er,or,Nn;rn?(er=ke.length-1,or=-1,Nn=-1):(er=0,or=ke.length,Nn=1);const ar=new Float64Array(16),On=o.a6.vec3.create(),pr=new o.P(0,0);for(let kr=er;kr!==or;kr+=Nn){const si=ke[kr],Si=ze.getTile(si).getBucket(Ue);if(!Si||!Si.uploaded)continue;let fr=!1;Qe&&(fr=Qe.getMaxCascadeForTile(si.toUnwrapped())===0);const hi=Ye.calculatePosMatrix(si.toUnwrapped(),Ye.worldSize),Nr=Si.modelTraits;!Qt&&rn&&(o.a6.mat4.invert(ar,hi),o.a6.vec3.transformMat4(On,ft,ar),pr.x=On[0],pr.y=On[1]);const li=[];for(const Rr of Si.getNodesInfo()){if(Rr.hiddenByReplacement||!Rr.node.meshes)continue;const Li=Rr.node;let Qr=0;we.terrain&&Li.elevation&&(Qr=Li.elevation*we.terrain.exaggeration());const Ei=(()=>{const ko=Rr.aabb;return yt.min=[...ko.min],yt.max=[...ko.max],yt.min[2]+=Qr,yt.max[2]+=Qr,o.a6.vec3.transformMat4(yt.min,yt.min,hi),o.a6.vec3.transformMat4(yt.max,yt.max,hi),yt})(),Ui=Rr.evaluatedScale;if(Ui[0]<=1&&Ui[1]<=1&&Ui[2]<=1&&Ei.intersects(jt)===0)continue;if(!Qt&&rn){const ko=.16666666666666666;Rr.cameraCollisionOpacity=ft[0]>Ei.min[0]&&ft[0]<Ei.max[0]&&ft[1]>Ei.min[1]&&ft[1]<Ei.max[1]&&ft[2]*Rt<Ei.max[2]&&Li.footprint&&o.bv(pr,Li.footprint)?Math.max(Rr.cameraCollisionOpacity-ko,0):Math.min(1,Rr.cameraCollisionOpacity+ko)}const Yo=[...hi],Vs=Li.anchor?Li.anchor[0]:0,Ps=Li.anchor?Li.anchor[1]:0;o.a6.mat4.translate(Yo,Yo,[Vs*(Ui[0]-1),Ps*(Ui[1]-1),Qr]),o.a6.vec3.exactEquals(Ui,o.dh)||o.a6.mat4.scale(Yo,Yo,Ui);const Qi=o.a6.mat4.multiply([],Yo,Li.matrix),xi=o.a6.mat4.multiply([],Ye.expandedFarZProjMatrix,Qi),ni=o.a6.mat4.multiply([],Ye.expandedFarZProjMatrix,Yo),di=o.a6.vec4.transformMat4([],[Vs,Ps,Qr,1],xi)[2];Li.hidden=!1;let Vi=sn;Qt||(rn&&(Vi*=Rr.cameraCollisionOpacity,Vi*=Mf(Yo,Ye,Rr.aabb,tn)),Vi*=Ti(en,di)),Vi!==0?li.push({nodeInfo:Rr,depth:di,opacity:Vi,wvpForNode:xi,wvpForTile:ni,nodeModelMatrix:Qi,tileModelMatrix:Yo}):Li.hidden=!0}Qt||li.sort((Rr,Li)=>!rn||Rr.opacity===1&&Li.opacity===1?Rr.depth<Li.depth?-1:1:Rr.opacity===1?-1:Li.opacity===1?1:Rr.depth>Li.depth?-1:1);for(const Rr of li){const Li=Rr.nodeInfo,Qr=Li.node;let Ei=o.a6.mat4.multiply([],$t,Rr.tileModelMatrix);o.a6.mat4.multiply(Ei,at,Ei);const Ui=o.a6.mat4.invert([],Ei);o.a6.mat4.transpose(Ui,Ui),o.a6.mat4.scale(Ui,Ui,Tc),Ei=o.a6.mat4.multiply(Ei,Ei,Qr.matrix);const Yo=we.renderPass==="light-beam",Vs=Nr&o.dj.HasMapboxMeshFeatures,Ps=Vs?0:Li.evaluatedRMEA[0][2];for(let Qi=0;Qi<Qr.meshes.length;++Qi){const xi=Qr.meshes[Qi],ni=Qi===Qr.lightMeshIndex;let di=Rr.wvpForNode;if(ni){if(!Yo&&!we.terrain&&we.shadowRenderer){we.currentLayer<we.firstLightBeamLayer&&(we.firstLightBeamLayer=we.currentLayer);continue}di=Rr.wvpForTile}else if(Yo)continue;const Vi={defines:[]},ko=[];if(!Qt&&Qe&&(Qe.useNormalOffset=!!xi.normalBuffer),Sc(Vi.defines,ko,xi,we,Ue.lut),Vs||Vi.defines.push("DIFFUSE_SHADED"),fr&&Vi.defines.push("SHADOWS_SINGLE_CASCADE"),bn&&(Qt?bn.numRenderedVerticesInShadowPass+=xi.vertexArray.length:bn.numRenderedVerticesInTransparentPass+=xi.vertexArray.length),Qt){qh(xi,Rr.nodeModelMatrix,we,Ue);continue}let ji=null;if(Ze){const sl=Ml(Rr.nodeModelMatrix,we.transform);if(ji=new Float32Array(sl),Ye.projection.name!=="globe"){const vs=xi.aabb.min,ma=xi.aabb.max,[Ja,pi]=Ze.getOpacityForBounds(sl,vs[0],vs[1],ma[0],ma[1]);Vi.overrideFog=Ja>=Tt||pi>=Tt}}const pa=xi.material;let _s;pa.occlusionTexture&&pa.occlusionTexture.offsetScale&&(_s=pa.occlusionTexture.offsetScale,Vi.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ys=we.getOrCreateProgram("model",Vi);!Qt&&Qe&&Qe.setupShadowsFromMatrix(Rr.tileModelMatrix,ys,Qe.useNormalOffset),we.uploadCommonUniforms(He,ys,null,ji);const os=pa.pbrMetallicRoughness;os.metallicFactor=.9,os.roughnessFactor=.5;const al=Ns(new Float32Array(di),new Float32Array(Ei),new Float32Array(Ui),new Float32Array(Qr.matrix),we,Rr.opacity,os.baseColorFactor.toRenderColor(null),pa.emissiveFactor,os.metallicFactor,os.roughnessFactor,pa,Ps,Ue,[0,0,0],_s);!ni&&(Li.hasTranslucentParts||Rr.opacity<1)&&ys.draw(we,He.gl.TRIANGLES,_n,Pe.disabled,Sr.disabled,Mt.backCCW,al,Ue.id,xi.vertexBuffer,xi.indexBuffer,xi.segments,Ue.paint,we.transform.zoom,void 0,ko),ys.draw(we,He.gl.TRIANGLES,ni?yn:_n,Pe.disabled,ni||Rr.opacity<1||Li.hasTranslucentParts?Sr.alphaBlended:Sr.unblended,Mt.backCCW,al,Ue.id,xi.vertexBuffer,xi.indexBuffer,xi.segments,Ue.paint,we.transform.zoom,void 0,ko)}}}}()}(d,r,l,p),void j();if(H.type!=="model")return;const q=H.getModels(),Y=[],Q=d.transform.getFreeCameraOptions().position,ae=o.a6.vec3.scale([],[Q.x,Q.y,Q.z],d.transform.worldSize);o.a6.vec3.negate(ae,ae);const ge=[],_e=[];let Te=0;for(const we of q){const ze=l.paint.get("model-rotation").constantOr(null),Ue=l.paint.get("model-scale").constantOr(null),ke=l.paint.get("model-translation").constantOr(null);we.computeModelMatrix(d,ze,Ue,ke,!0,!0,!1);const He=o.a6.mat4.identity([]),Ye=o.de(we.position.lat,d.transform.zoom),Ze=o.a6.mat4.fromScaling([],[1,1,1/Ye]);o.a6.mat4.translate(He,He,ae),Y.push({zScaleMatrix:Ze,negCameraPosMatrix:He});for(const Qe of we.nodes)Ql(d.transform,Qe,we.matrix,d.transform.expandedFarZProjMatrix,Te,ge,_e);Te++}if(ge.sort((we,ze)=>ze.depth-we.depth),d.renderPass!=="shadow"){if(x===1)for(const we of _e)Jl(we,d,l,Y[we.modelIndex],Pe.disabled,d.colorModeForRenderPass());else{for(const we of _e)Jl(we,d,l,Y[we.modelIndex],Pe.disabled,Sr.disabled);for(const we of _e)Jl(we,d,l,Y[we.modelIndex],d.stencilModeFor3D(),d.colorModeForRenderPass());d.resetStencilClippingMasks()}for(const we of ge)Jl(we,d,l,Y[we.modelIndex],Pe.disabled,d.colorModeForRenderPass());j()}else{for(const we of _e)qh(we.mesh,we.nodeModelMatrix,d,l);for(const we of ge)qh(we.mesh,we.nodeModelMatrix,d,l);j()}}},Il={model:function(d,r,l){const p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,p.type==="vector"?d.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const x=p.getModels();for(const T of x)T.upload(l.context)},raster:function(d,r,l){const p=r.getSource();if(!(p instanceof Ir&&p.loaded()))return;const x=d.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!x)return;const T=d.paint.get("raster-array-band")||p.getInitialBand(x);if(T==null)return;const A=r.getIds().map(F=>r.getTileByID(F));for(const F of A)F.updateNeeded(x,T)&&p.prepareTile(F,x,T)},"raster-particle":function(d,r,l){const p=r.getSource();if(!(p instanceof Ir&&p.loaded()))return;const x=d.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!x)return;const T=d.paint.get("raster-particle-array-band")||p.getInitialBand(x);if(T==null)return;const A=r.getIds().map(F=>r.getTileByID(F));for(const F of A)F.updateNeeded(x,T)&&p.prepareTile(F,x,T)}};class Cl{constructor(r,l,p,x,T){this.context=new np(r,l),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=T,this._timeStamp=o.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const A=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const j of A)this._debugParams.enabledLayers[j]=!0;T.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),T.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),T.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),T.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),T.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),T.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const j of A)T.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],j);this.occlusionParams=new Oo(T),this.setup(),this.numSublayers=Cn.maxUnderzooming+Cn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new o.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Ul(this),this._wireframeDebugCache=new bu,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const F=new o.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new o.T(this.context,F,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new vf(this,r));const x=this._terrain;this.transform.elevation=p?x:null,x.update(r,this.transform,l),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,x]=l.getFovAdjustedRange(this.transform._fov);if(p>x)return void(this.transform.fogCullDistSq=null);const T=p+.78*(x-p);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new vf(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*o.q.devicePixelRatio,this.height=l*o.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const r=this.context,l=new o.a$;l.emplaceBack(0,0),l.emplaceBack(o.ab,0),l.emplaceBack(0,o.ab),l.emplaceBack(o.ab,o.ab),this.tileExtentBuffer=r.createVertexBuffer(l,o.b1.members),this.tileExtentSegments=o.b2.simpleSegment(0,0,4,2);const p=new o.a$;p.emplaceBack(0,0),p.emplaceBack(o.ab,0),p.emplaceBack(0,o.ab),p.emplaceBack(o.ab,o.ab),this.debugBuffer=r.createVertexBuffer(p,o.b1.members),this.debugSegments=o.b2.simpleSegment(0,0,4,5);const x=new o.a$;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(x,o.b1.members),this.viewportSegments=o.b2.simpleSegment(0,0,4,2);const T=new o.aO;T.emplaceBack(0,0,0,0),T.emplaceBack(o.ab,0,o.ab,0),T.emplaceBack(0,o.ab,0,o.ab),T.emplaceBack(o.ab,o.ab,o.ab,o.ab),this.mercatorBoundsBuffer=r.createVertexBuffer(T,o.b4.members),this.mercatorBoundsSegments=o.b2.simpleSegment(0,0,4,2);const A=new o.aP;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(A);const F=new o.b0;for(const H of[0,1,3,2,0])F.emplaceBack(H);this.debugIndexBuffer=r.createIndexBuffer(F),this.emptyTexture=new o.T(r,new o.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=o.a6.mat4.create();const j=this.context.gl;this.stencilClearMode=new Pe({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,ir.disabled,this.stencilClearMode,Sr.disabled,Mt.disabled,Ts(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let F=!1;for(const j of p)if(this._tileClippingMaskIDs[j.key]===void 0){F=!0;break}if(!F)return}this.currentStencilSource=l.id;const x=this.context,T=x.gl;this.nextStencilID+p.length>256&&this.clearStencil(),x.setColorMode(Sr.disabled),x.setDepthMode(ir.disabled);const A=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of p){const j=l.getTile(F),H=this._tileClippingMaskIDs[F.key]=this.nextStencilID++,{tileBoundsBuffer:q,tileBoundsIndexBuffer:Y,tileBoundsSegments:Q}=this.getTileBoundsBuffers(j);A.draw(this,T.TRIANGLES,ir.disabled,new Pe({func:T.ALWAYS,mask:0},H,255,T.KEEP,T.KEEP,T.REPLACE),Sr.disabled,Mt.disabled,Ts(F.projMatrix),"$clipping",q,Y,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new Pe({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new Pe({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((A,F)=>F.overscaledZ-A.overscaledZ),x=p[p.length-1].overscaledZ,T=p[0].overscaledZ-x+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const A={};for(let F=0;F<T;F++)A[F+x]=new Pe({func:l.GEQUAL,mask:255},F+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=T,[A,p]}return[{[x]:Pe.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Sr([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new o.bA(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Sr.unblended:Sr.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Sr([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new o.bA(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,p,x=!1){if(this.depthOcclusion)return new ir(this.context.gl.GREATER,ir.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return ir.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new ir(p||this.context.gl.LEQUAL,l,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),p=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),T=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&p!==0&&(this.depthFBO=new cd(this.context,l,p,!1,"texture"),this.depthTexture=new o.T(this.context,{width:l,height:p,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),r.bindTexture(r.TEXTURE_2D,T),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,p,0,0,l,p,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const p=o.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const x=this.style._mergedLayers,T=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(st=>{const at=x[st];return!(at.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[at.type]});let A=!1,F=!1;for(const st of T){const at=x[st];at.type==="circle"&&(A=!0),at.type==="symbol"&&(at.hasInitialOcclusionOpacityProperties?F=!0:A=!0)}const j=T.map(st=>x[st]),H=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.q.now()),this.imageManager.beginFrame();let q=0,Y=!1;for(const st in H){const at=H[st];at.used&&(at.prepare(this.context),at.getSource().usedInConflation&&++q)}let Q=!1;for(const st of j)st.isHidden(this.transform.zoom)||(st.type==="clip"&&(Q=!0),this.prepareLayer(st));const ae={},ge={},_e={},Te={},we={};for(const st in H){const at=H[st];ae[st]=at.getVisibleCoordinates(),ge[st]=ae[st].slice().reverse(),_e[st]=at.getVisibleCoordinates(!0).reverse(),Te[st]=at.getShadowCasterCoordinates(),we[st]=at.sortCoordinatesByDistance(ae[st])}const ze=st=>{const at=this.style.getLayerSourceCache(st);return at&&at.used?at.getSource():null};if(q||Q||this._clippingActiveLastFrame){const st=[],at=[];let Rt=0;for(const $t of j)this.isSourceForClippingOrConflation($t,ze($t))&&(st.push($t),at.push(Rt)),Rt++;if(st&&(Q||st.length>1)||this._clippingActiveLastFrame){Q=!1;const $t=[];for(let sn=0;sn<st.length;sn++){const _n=st[sn],yn=at[sn],yt=this.style.getLayerSourceCache(_n);if(!yt||!yt.used||!yt.getSource().usedInConflation&&_n.type!=="clip")continue;let Qt=o.dn,jt=o.bt.None;const tn=[];let rn=!0;if(_n.type==="clip"){Qt=yn;for(const en of _n.layout.get("clip-layer-types"))jt|=en==="model"?o.bt.Model:en==="symbol"?o.bt.Symbol:o.bt.FillExtrusion;for(const en of _n.layout.get("clip-layer-scope"))tn.push(en);_n.isHidden(this.transform.zoom)?rn=!1:Q=!0}rn&&$t.push({layer:_n.fqid,cache:yt,order:Qt,clipMask:jt,clipScope:tn})}this.replacementSource.setSources($t),Y=!0}}this._clippingActiveLastFrame=Q,Y||this.replacementSource.clear(),this.conflationActive=Y,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let st=0;st<j.length;st++){const at=j[st],Rt=at.cutoffRange();if(this.longestCutoffRange=Math.max(Rt,this.longestCutoffRange),Rt>0){const $t=ze(at);$t&&(this.minCutoffZoom=Math.max($t.minzoom,this.minCutoffZoom)),at.minzoom&&(this.minCutoffZoom=Math.max(at.minzoom,this.minCutoffZoom))}at.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=st),this._lastOcclusionLayer=st)}const Ue=this.style&&this.style.fog;Ue?(this._fogVisible=Ue.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ue.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0);const ke=this._shadowRenderer;if(ke){ke.updateShadowParameters(this.transform,this.style.directionalLight);for(const st in H)for(const at of ae[st]){let Rt={min:0,max:0};this.terrain&&(Rt=this.terrain.getMinMaxForTile(at)||Rt),ke.addShadowReceiver(at.toUnwrapped(),Rt.min,Rt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ph(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!mr.has(this.context.gl))return;this.renderPass="offscreen";for(const st of j){const at=r.getLayerSourceCache(st);if(!st.hasOffscreenPass()||st.isHidden(this.transform.zoom))continue;const Rt=at?ge[at.id]:void 0;(st.type==="custom"||st.type==="raster"||st.type==="raster-particle"||st.isSky()||Rt&&Rt.length)&&this.renderLayer(this,at,st,Rt)}this.depthRangeFor3D=[0,1-(j.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const He=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ye=(()=>{if(l.showOverdrawInspector)return o.bA.black;const st=this.style.fog;if(st&&this.transform.projection.supportsFog){const at=this.style.getLut(st.scope);if(!He){const Rt=st.properties.get("color").toRenderColor(at).toArray01();return new o.bA(...Rt)}if(He){const Rt=st.properties.get("space-color").toRenderColor(at).toArray01();return new o.bA(...Rt)}}return o.bA.transparent})();if(this.context.clear({color:Ye,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&He&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=T.length-1;this.currentLayer>=0;this.currentLayer--){const st=j[this.currentLayer],at=r.getLayerSourceCache(st);if(st.isSky())continue;const Rt=at?(st.is3D()?we:ge)[at.id]:void 0;this._renderTileClippingMasks(st,at,Rt),this.renderLayer(this,at,st,Rt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&He&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||o.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<T.length;this.currentLayer++){const st=j[this.currentLayer],at=r.getLayerSourceCache(st);st.isSky()&&this.renderLayer(this,at,st,at?ge[at.id]:void 0)}function Ze(st,at){let Rt;return at&&(Rt=(st.type==="symbol"?_e:st.is3D()?we:ge)[at.id]),Rt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<T.length;){const st=j[this.currentLayer];if(st.type==="raster"||st.type==="raster-particle"){const at=r.getLayerSourceCache(st);this.renderLayer(this,at,st,Ze(st,at))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Qe=0;ke&&(Qe=ke.getShadowCastingLayerCount());let it=!1,ft=-1;for(let st=0;st<T.length;++st){const at=j[st];at.isHidden(this.transform.zoom)||at.is3D()&&(ft=st)}for(F&&ft===-1&&(A=!0);this.currentLayer<T.length;){const st=j[this.currentLayer],at=r.getLayerSourceCache(st);if(st.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(st)){if(st.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(A&&!it&&this.terrain&&!this.transform.isOrthographic&&(it=!0,this.blitDepth()),F&&ft!==-1&&this.currentLayer===ft+1&&!this.transform.isOrthographic&&this.blitDepth(),st.is3D()||this.terrain||this._renderTileClippingMasks(st,at,at?ae[at.id]:void 0),this.renderLayer(this,at,st,Ze(st,at)),!this.terrain&&ke&&Qe>0&&st.hasShadowPass()&&--Qe==0&&(ke.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Rt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Rt;this.currentLayer++){const $t=j[this.currentLayer];if(!$t.hasLightBeamPass())continue;const sn=r.getLayerSourceCache($t);this.renderLayer(this,sn,$t,sn?ge[sn.id]:void 0)}this.currentLayer=Rt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Rt=this.currentLayer;this.depthOcclusion=!0;for(const $t of this.layersWithOcclusionOpacity){this.currentLayer=$t;const sn=j[this.currentLayer],_n=r.getLayerSourceCache(sn),yn=_n?ge[_n.id]:void 0;sn.is3D()||this.terrain||this._renderTileClippingMasks(sn,_n,_n?ae[_n.id]:void 0),this.renderLayer(this,_n,sn,yn)}this.depthOcclusion=!1,this.currentLayer=Rt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let st=null;j.forEach(at=>{const Rt=r.getLayerSourceCache(at);Rt&&!at.isHidden(this.transform.zoom)&&Rt.getVisibleCoordinates().length&&(!st||st.getSource().maxzoom<Rt.getSource().maxzoom)&&(st=Rt)}),st&&this.options.showTileBoundaries&&Ta.debug(this,st,st.getVisibleCoordinates(),o.bA.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Ta.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new o.bA(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(st){const at=st.transform.padding;Et(st,st.transform.height-(at.top||0),3,bc),Et(st,at.bottom||0,3,wc),dd(st,at.left||0,3,vn),dd(st,st.transform.width-(at.right||0),3,tr);const Rt=st.transform.centerPoint;(function($t,sn,_n,yn){Us($t,sn-1,_n-10,2,20,yn),Us($t,sn-10,_n-1,20,2,yn)})(st,Rt.x,st.transform.height-Rt.y,ps)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Y||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,p=!l||!l.includes(r.type);if(Il[r.type]&&(p||this.terrain&&r.type==="custom")){const x=this.style.getLayerSourceCache(r);Il[r.type](r,x,this)}this.gpuTimingEnd()}renderLayer(r,l,p,x){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||x&&x.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)&&(!r.terrain||p.type!=="custom")||p.type==="clip"||Ta[p.type](r,l,p,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,p=this.context.gl;let x=this.gpuTimers[r.id];x||(x=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:p.createQuery()}),x.calls++,p.beginQuery(l.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,p=l.createQuery();this.deferredRenderGpuTimeQueries.push(p),l.beginQuery(r.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const p in r){const x=r[p],T=this.context.extTimerQuery,A=T.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;T.deleteQueryEXT(x.query),l[p]=A}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let p=0;for(const x of r)p+=l.getQueryParameter(x,l.QUERY_RESULT)/1e6,l.deleteQuery(x);return p}translatePosMatrix(r,l,p,x,T){if(!p[0]&&!p[1])return r;const A=T?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(A){const H=Math.sin(A),q=Math.cos(A);p=[p[0]*q-p[1]*H,p[0]*H+p[1]*q]}const F=[T?p[0]:o.ak(l,p[0],this.transform.zoom),T?p[1]:o.ak(l,p[1],this.transform.zoom),0],j=new Float32Array(16);return o.a6.mat4.translate(j,r,F),j}saveTileTexture(r){const l=r.size[0],p=this._tileTextures[l];p?p.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,p){const x=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,T=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(T.push("LIGHTING_3D_MODE"),T.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||T.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||T.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(T.push("TERRAIN"),this.linearFloatFilteringSupported()&&T.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&T.push("GLOBE"),!this._fogVisible||x||l!==void 0&&!l||T.push("FOG","FOG_DITHERING"),x&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}getOrCreateProgram(r,l){this.cache=this.cache||{};const p=l&&l.defines||[],x=l&&l.config,T=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(p),A=tl.cacheKey(Ls[r],r,T,x);return this.cache[A]||(this.cache[A]=new tl(this.context,r,Ls[r],x,js[r],T)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const p=this.style.directionalLight,x=this.style.ambientLight;if(p&&x){const T=((A,F,j)=>{const H=A.properties.get("direction"),q=A.properties.get("color").toRenderColor(j.getLut(A.scope)).toArray01(),Y=A.properties.get("intensity"),Q=F.properties.get("color").toRenderColor(j.getLut(F.scope)).toArray01(),ae=F.properties.get("intensity"),ge=[H.x,H.y,H.z],_e=o.cH(Q,ae),Te=o.cH(q,Y);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:ge,u_lighting_directional_color:Te,u_ground_radiance:Xl(ge,Te,_e)}})(p,x,this.style);l.setLightsUniformValues(r,T)}}}uploadCommonUniforms(r,l,p,x,T){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const A=this.style.fog;if(A){const F=A.getOpacity(this.transform.pitch),j=((H,q,Y,Q,ae,ge,_e,Te,we,ze,Ue,ke)=>{const He=H.transform,Ye=q.properties.get("color").toRenderColor(H.style.getLut(q.scope)).toArray01();Ye[3]=Q;const Ze=H.frameCounter/1e3%1,[Qe,it]=q.properties.get("vertical-range");return{u_fog_matrix:Y?He.calculateFogTileMatrix(Y):ke||H.identityMat,u_fog_range:q.getFovAdjustedRange(He._fov),u_fog_color:Ye,u_fog_horizon_blend:q.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Qe,it),it],u_fog_temporal_offset:Ze,u_frustum_tl:ae,u_frustum_tr:ge,u_frustum_br:_e,u_frustum_bl:Te,u_globe_pos:we,u_globe_radius:ze,u_viewport:Ue,u_globe_transition:o.a9(He.zoom),u_is_globe:+(He.projection.name==="globe")}})(this,A,p,F,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.q.devicePixelRatio,this.transform.height*o.q.devicePixelRatio],x);l.setFogUniformValues(r,j)}T&&l.setCutoffUniformValues(r,T.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const x of p)l[x.key]=r[x.key]||new dt(x,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D()||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=Tt||l[1]>=Tt}setupDepthForOcclusion(r,l,p){const x=this.context,T=x.gl,A=!!p;var F;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(T.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((F=this.depthRangeFor3D)[1]-F[0]),-1-2*F[0]/(F[1]-F[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),x.activeTexture.set(T.TEXTURE0),A||l.setTerrainUniformValues(x,p)}}function ml(d,r){let l=!1,p=null;const x=()=>{p=null,l&&(d(),p=setTimeout(x,r),l=!1)};return()=>(l=!0,p||x(),p)}class md{constructor(r){this._hashName=r&&encodeURIComponent(r),o.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ml(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=Ua(r);if(this._hashName){const p=this._hashName;let x=!1;const T=location.hash.slice(1).split("&").map(A=>{const F=A.split("=")[0];return F===p?(x=!0,`${F}=${l}`):A}).filter(A=>A);return x||T.push(`${p}=${l}`),`#${T.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Ua(d,r){const l=d.getCenter(),p=Math.round(100*d.getZoom())/100,x=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,x),A=Math.round(l.lng*T)/T,F=Math.round(l.lat*T)/T,j=d.getBearing(),H=d.getPitch();let q=r?`/${A}/${F}/${p}`:`${p}/${F}/${A}`;return(j||H)&&(q+="/"+Math.round(10*j)/10),H&&(q+=`/${Math.round(H)}`),q}const Ec={linearity:.3,easing:o.dp(0,0,.3,1)},If=o.l({deceleration:2500,maxSpeed:1400},Ec),Cf=o.l({deceleration:20,maxSpeed:1400},Ec),gs=o.l({deceleration:1e3,maxSpeed:360},Ec),ol=o.l({deceleration:1e3,maxSpeed:90},Ec);class Ac{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=o.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)l.zoom+=T.zoomDelta||0,l.bearing+=T.bearingDelta||0,l.pitch+=T.pitchDelta||0,T.panDelta&&l.pan._add(T.panDelta),T.around&&(l.around=T.around),T.pinchAround&&(l.pinchAround=T.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(l.pan.mag()){const T=Mc(l.pan.mag(),p,o.l({},If,r||{}));x.offset=l.pan.mult(T.amount/l.pan.mag()),x.center=this._map.transform.center,Pc(x,T)}if(l.zoom){const T=Mc(l.zoom,p,Cf);x.zoom=this._map.transform.zoom+T.amount,Pc(x,T)}if(l.bearing){const T=Mc(l.bearing,p,gs);x.bearing=this._map.transform.bearing+o.ap(T.amount,-179,179),Pc(x,T)}if(l.pitch){const T=Mc(l.pitch,p,ol);x.pitch=this._map.transform.pitch+T.amount,Pc(x,T)}if(x.zoom||x.bearing){const T=l.pinchAround===void 0?l.around:l.pinchAround;x.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Pc(d,r){(!d.duration||d.duration<r.duration)&&(d.duration=r.duration,d.easing=r.easing)}function Mc(d,r,l){const{maxSpeed:p,linearity:x,deceleration:T}=l,A=o.ap(d*x/(r/1e3),-p,p),F=Math.abs(A)/(T*x);return{easing:l.easing,duration:1e3*F,amount:A*(F/2)}}class po extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,x={}){const T=lt(l.getCanvasContainer(),p),A=l.unproject(T);super(r,o.l({point:T,lngLat:A,originalEvent:p},x)),this._defaultPrevented=!1,this.target=l}}class gh extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const x=r==="touchend"?p.changedTouches:p.touches,T=xt(l.getCanvasContainer(),x),A=T.map(j=>l.unproject(j)),F=T.reduce((j,H,q,Y)=>j.add(H.div(Y.length)),new o.P(0,0));super(r,{points:T,point:F,lngLats:A,lngLat:l.unproject(F),originalEvent:p}),this._defaultPrevented=!1}}class gd extends o.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class _h{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new gd(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new po(r.type,this._map,r))}mouseup(r){this._map.fire(new po(r.type,this._map,r))}preclick(r){const l=o.l({},r);l.type="preclick",this._map.fire(new po(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new po(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new po(r.type,this._map,r))}mouseover(r){this._map.fire(new po(r.type,this._map,r))}mouseout(r){this._map.fire(new po(r.type,this._map,r))}touchstart(r){return this._firePreventable(new gh(r.type,this._map,r))}touchmove(r){this._map.fire(new gh(r.type,this._map,r))}touchend(r){this._map.fire(new gh(r.type,this._map,r))}touchcancel(r){this._map.fire(new gh(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ic{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new po(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new po("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new po(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _d{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(De(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l,x=this._startPos,T=this._lastPos;if(!x||!T||T.equals(p)||!this._box&&p.dist(x)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=se("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const A=Math.min(x.x,p.x),F=Math.max(x.x,p.x),j=Math.min(x.y,p.y),H=Math.max(x.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${A}px,${j}px)`,this._box.style.width=F-A+"px",this._box.style.height=H-j+"px")})}mouseupWindow(r,l){if(!this._active)return;const p=this._startPos,x=l;if(p&&r.button===0){if(this.reset(),Fe(),p.x!==x.x||p.y!==x.y)return this._map.fire(new o.x("boxzoomend",{originalEvent:r})),{cameraAnimation:T=>T.fitScreenCoordinates(p,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ve(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new o.x(r,{originalEvent:l}))}}function Of(d,r){const l={};for(let p=0;p<d.length;p++)l[d[p].identifier]=r[p];return l}class op{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(x){const T=new o.P(0,0);for(const A of x)T._add(A);return T.div(x.length)}(l),this.touches=Of(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const x=Of(p,l);for(const T in this.touches){const A=x[T];(!A||A.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Ku{constructor(r){this.singleTap=new op(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const x=this.singleTap.touchend(r,l,p);if(x){const T=r.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(T&&A||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class yd{constructor(){this._zoomIn=new Ku({numTouches:1,numTaps:2}),this._zoomOut=new Ku({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const x=this._zoomIn.touchend(r,l,p),T=this._zoomOut.touchend(r,l,p);return x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(x)},{originalEvent:r})}):T?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(T)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Cc={0:1,2:2};class Oc{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=gt(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(x,T){const A=Cc[T];return x.buttons===void 0||(x.buttons&A)!==A}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&gt(r)===this._eventButton&&(this._moved&&Fe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kf extends Oc{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class Gh extends Oc{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){r.preventDefault()}}class Rf extends Oc{_correctButton(r,l){return l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){r.preventDefault()}}class ap{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),o.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!o.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const x=Of(p,l),T=new o.P(0,0),A=new o.P(0,0);let F=0;for(const H in x){const q=x[H],Y=this._touches[H];Y&&(T._add(q),A._add(q.sub(Y)),F++,x[H]=q)}if(this._touches=x,F<this._minTouches||!A.mag())return;const j=A.div(F);return this._sum._add(j),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(F),panDelta:j}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=se("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Lf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){const x=this._firstTwoTouches;if(!x)return;r.preventDefault();const[T,A]=x,F=Hh(p,l,T),j=Hh(p,l,A);if(!F||!j)return;const H=this._aroundCenter?null:F.add(j).div(2);return this._move([F,j],H,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[x,T]=this._firstTwoTouches,A=Hh(p,l,x),F=Hh(p,l,T);A&&F||(this._active&&Fe(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Hh(d,r,l){for(let p=0;p<d.length;p++)if(d[p].identifier===l)return r[p]}function Df(d,r){return Math.log(d/r)/Math.LN2}class sp extends Lf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Df(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Df(this._distance,p),pinchAround:l}}}function vd(d,r){return 180*d.angleWith(r)/Math.PI}class lp extends Lf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:vd(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const x=vd(r,p);return Math.abs(x)<l}}function xd(d){return Math.abs(d.y)>Math.abs(d.x)}class up extends Lf{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,xd(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const x=this._lastPoints;if(!x)return;const T=r[0].sub(x[0]),A=r[1].sub(x[1]);return this._map._cooperativeGestures&&!o.dq()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(T,A,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(T.y+A.y)/2*-.5})}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const x=r.mag()>=2,T=l.mag()>=2;if(!x&&!T)return;if(!x||!T)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const A=r.y>0==l.y>0;return xd(r)&&xd(l)&&A}}const cm={panStep:100,bearingStep:15,pitchStep:10};class hm{constructor(){const r=cm;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,x=0,T=0,A=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),T=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),T=1);break;case 38:r.shiftKey?x=1:(r.preventDefault(),A=-1);break;case 40:r.shiftKey?x=-1:(r.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(p=0,x=0),{cameraAnimation:F=>{const j=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:cp,zoom:l?Math.round(j)+l*(r.shiftKey?2:1):j,bearing:F.getBearing()+p*this._bearingStep,pitch:F.getPitch()+x*this._pitchStep,offset:[-T*this._panStep,-A*this._panStep],center:F.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cp(d){return d*(2-d)}const bd=4.000244140625,fm=1/450;class wd{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=fm,o.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||o.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=o.q.now(),x=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%bd==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(x*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=lt(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const H=this._type==="wheel"&&Math.abs(this._delta)>bd?this._wheelZoomRate:this._defaultZoomRate;let q=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&q!==0&&(q=1/q);const Y=l(),Q=Math.pow(2,Y),ae=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(ae*q))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),x=this._startZoom,T=this._easing;let A,F=!1;if(this._type==="wheel"&&x&&T){const H=Math.min((o.q.now()-this._lastWheelEventTime)/200,1),q=T(H);A=o.aa(x,p,q),H<1?this._frameId||(this._frameId=!0):F=!0}else A=p,F=!0;this._active=!0,F&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let j=A-l();return j*this._lastDelta<0&&(j=0),{noInertia:!0,needsRenderFrame:!F,zoomDelta:j,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=o.dr;if(this._prevEase){const p=this._prevEase,x=(o.q.now()-p.start)/p.duration,T=p.easing(x+.01)-p.easing(x),A=.27/Math.sqrt(T*T+1e-4)*.01,F=Math.sqrt(.0729-A*A);l=o.dp(A,F,.25,1)}return this._prevEase={start:o.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=se("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class $o{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class dm{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $g{constructor(){this._tap=new Ku({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const x=l[0],T=x.y-this._swipePoint.y;return this._swipePoint=x,r.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tu{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yh{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zf{constructor(r,l,p,x){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const vh=d=>d.zoom||d.drag||d.pitch||d.rotate;class Ff extends o.x{}class wu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=o.a6.vec3.sub([],l,r);this.radius=o.a6.vec3.length(p[2]<0?o.a6.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(r){o.a6.vec3.div(r,r,this.constants),o.a6.vec3.normalize(r,r),o.a6.vec3.mul(r,r,this.constants);const l=o.a6.vec3.scale([],r,this.radius);if(l[2]>0){const p=o.a6.vec3.scale([],[0,0,1],o.a6.vec3.dot(l,[0,0,1])),x=o.a6.vec3.scale([],o.a6.vec3.normalize([],[l[0],l[1],0]),this.radius),T=o.a6.vec3.add([],l,o.a6.vec3.scale([],o.a6.vec3.sub([],o.a6.vec3.add([],x,p),l),2));l[0]=T[0],l[1]=T[1]}return l}}function Yu(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class Uo{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ac(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new wu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),o.aJ(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,T,A]of this._listeners){const F=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(T,F,A)}}destroy(){for(const[r,l,p]of this._listeners){const x=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,x,p)}}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new _h(l,r));const x=l.boxZoom=new _d(l,r);this._add("boxZoom",x);const T=new yd,A=new dm;l.doubleClickZoom=new $o(A,T),this._add("tapZoom",T),this._add("clickZoom",A);const F=new $g;this._add("tapDragZoom",F);const j=l.touchPitch=new up(l);this._add("touchPitch",j);const H=new Gh(r),q=new Rf(r);l.dragRotate=new yh(r,H,q),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);const Y=new kf(r),Q=new ap(l,r);l.dragPan=new tu(p,Y,Q),this._add("mousePan",Y),this._add("touchPan",Q,["touchZoom","touchRotate"]);const ae=new lp,ge=new sp;l.touchZoomRotate=new zf(p,ge,ae,F),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ge,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ic(l));const _e=l.scrollZoom=new wd(l,this);this._add("scrollZoom",_e,["mousePan"]);const Te=l.keyboard=new hm;this._add("keyboard",Te);for(const we of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[we]&&l[we].enable(r[we])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,p){for(const x in r)if(x!==p&&(!l||l.indexOf(x)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",x=p?void 0:r,T={needsRenderFrame:!1},A={},F={},j=r.touches?this._getMapTouches(r.touches):void 0,H=j?xt(this._el,j):p?void 0:lt(this._el,r);for(const{handlerName:Q,handler:ae,allowed:ge}of this._handlers){if(!ae.isEnabled())continue;let _e;this._blockedByActive(F,ge,Q)?ae.reset():ae[l||r.type]&&(_e=ae[l||r.type](r,H,j),this.mergeHandlerResult(T,A,_e,Q,x),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||ae.isActive())&&(F[Q]=ae)}const q={};for(const Q in this._previousActiveHandlers)F[Q]||(q[Q]=x);this._previousActiveHandlers=F,(Object.keys(q).length||Yu(T))&&(this._changes.push([T,A,q]),this._triggerRenderFrame()),(Object.keys(F).length||Yu(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=T;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))}mergeHandlerResult(r,l,p,x,T){if(!p)return;o.l(r,p);const A={handlerName:x,originalEvent:p.originalEvent||T};p.zoomDelta!==void 0&&(l.zoom=A),p.panDelta!==void 0&&(l.drag=A),p.pitchDelta!==void 0&&(l.pitch=A),p.bearingDelta!==void 0&&(l.rotate=A)}_applyChanges(){const r={},l={},p={};for(const[x,T,A]of this._changes)x.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(x.panDelta)),x.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(r.around=x.around),x.aroundCoord!==void 0&&(r.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(r.pinchAround=x.pinchAround),x.noInertia&&(r.noInertia=x.noInertia),o.l(l,T),o.l(p,A);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const x=this._map,T=x.transform,A=ze=>[ze.x,ze.y,ze.z];if((ze=>{const Ue=this._eventsInProgress.drag;return Ue&&!this._handlersById[Ue.handlerName].isActive()})()&&!Yu(r)){const ze=T.zoom;T.cameraElevationReference="sea",this._originalZoom!=null&&T._orthographicProjectionAtLowPitch&&T.projection.name!=="globe"&&T.pitch===0?(T.cameraElevationReference="ground",T.zoom=this._originalZoom):(T.recenterOnTerrain(),T.cameraElevationReference="ground"),ze!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&x._stop(!0),!Yu(r))return void this._fireEvents(l,p,!0);let{panDelta:F,zoomDelta:j,bearingDelta:H,pitchDelta:q,around:Y,aroundCoord:Q,pinchAround:ae}=r;T._isCameraConstrained&&(j>0&&(j=0),T._isCameraConstrained=!1),ae!==void 0&&(Y=ae),(j||(ze=>l[ze]&&!this._eventsInProgress[ze])("drag"))&&Y&&(this._dragOrigin=A(T.pointCoordinate3D(Y)),this._originalZoom=T.zoom,this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",x._stop(!0),Y=Y||x.transform.centerPoint,H&&(T.bearing+=H),q&&(T.pitch+=q),T._updateCameraState();const ge=[0,0,0];if(F)if(T.projection.name==="mercator"){const ze=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(Y).dir),Ue=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(Y.sub(F)).dir);ge[0]=Ue[0]-ze[0],ge[1]=Ue[1]-ze[1]}else{const ze=T.pointCoordinate(Y);if(T.projection.name==="globe"){F=F.rotate(-T.angle);const Ue=T._pixelsPerMercatorPixel/T.worldSize;ge[0]=-F.x*o.ds(o.aN(ze.y))*Ue,ge[1]=-F.y*o.ds(T.center.lat)*Ue}else{const Ue=T.pointCoordinate(Y.sub(F));ze&&Ue&&(ge[0]=Ue.x-ze.x,ge[1]=Ue.y-ze.y)}}const _e=T.zoom,Te=[0,0,0];if(j){const ze=A(Q||T.pointCoordinate3D(Y)),Ue={dir:o.a6.vec3.normalize([],o.a6.vec3.sub([],ze,T._camera.position))};if(Ue.dir[2]<0){const ke=T.zoomDeltaToMovement(ze,j);o.a6.vec3.scale(Te,Ue.dir,ke)}}const we=o.a6.vec3.add(ge,ge,Te);T._translateCameraConstrained(we),j&&Math.abs(T.zoom-_e)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const x=vh(this._eventsInProgress),T=vh(r),A={};for(const q in r){const{originalEvent:Y}=r[q];this._eventsInProgress[q]||(A[`${q}start`]=Y),this._eventsInProgress[q]=r[q]}!x&&T&&this._fireEvent("movestart",T.originalEvent);for(const q in A)this._fireEvent(q,A[q]);T&&this._fireEvent("move",T.originalEvent);for(const q in r){const{originalEvent:Y}=r[q];this._fireEvent(q,Y)}const F={};let j;for(const q in this._eventsInProgress){const{handlerName:Y,originalEvent:Q}=this._eventsInProgress[q];this._handlersById[Y].isActive()||(delete this._eventsInProgress[q],j=l[Y]||Q,F[`${q}end`]=j)}for(const q in F)this._fireEvent(q,F[q]);const H=vh(this._eventsInProgress);if(p&&(x||T)&&!H){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;q?(Y(q.bearing||this._map.getBearing())&&(q.bearing=0),this._map.easeTo(q,{originalEvent:j})):(this._map.fire(new o.x("moveend",{originalEvent:j})),Y(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new o.x(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Ff("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ol="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Bf extends o.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,o.aJ(["_renderFrameCallback"],this)}getCenter(){return new o.bL(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.l({offset:r},l),p)}panTo(r,l,p){return this.easeTo(o.l({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(o.l({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(o.l({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,o.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(o.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=o.as.convert(r);const p=l&&l.bearing||0,x=l&&l.pitch||0,T=r.getNorthWest(),A=r.getSouthEast();return this._cameraForBounds(this.transform,T,A,p,x,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?o.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:o.l({},l,r)}_extendCameraOptions(r){return(r=o.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const p=l.max[0]-l.min[0],x=l.max[1]-l.min[1];return p/x>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):x/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,p,x,T,A){const F=r.clone(),j=this._extendCameraOptions(A);F.bearing=x,F.pitch=T;const H=o.bL.convert(l),q=o.bL.convert(p),Y=.5*(H.lat+q.lat),Q=.5*(H.lng+q.lng),ae=o.dt(Y,Q),ge=o.a6.vec3.normalize([],ae),_e=o.a6.vec3.normalize([],o.a6.vec3.cross([],ge,[0,1,0])),Te=o.a6.vec3.cross([],_e,ge),we=[_e[0],_e[1],_e[2],0,Te[0],Te[1],Te[2],0,ge[0],ge[1],ge[2],0,0,0,0,1],ze=[ae,o.dt(H.lat,H.lng),o.dt(q.lat,H.lng),o.dt(q.lat,q.lng),o.dt(H.lat,q.lng),o.dt(Y,H.lng),o.dt(Y,q.lng),o.dt(H.lat,Q),o.dt(q.lat,Q)];let Ue=o.ca.fromPoints(ze.map(jt=>[o.a6.vec3.dot(_e,jt),o.a6.vec3.dot(Te,jt),o.a6.vec3.dot(ge,jt)]));const ke=o.a6.vec3.transformMat4([],Ue.center,we);o.a6.vec3.squaredLength(ke)===0&&o.a6.vec3.set(ke,0,0,1),o.a6.vec3.normalize(ke,ke),o.a6.vec3.scale(ke,ke,o.aq),F.center=o.du(ke);const He=F.getWorldToCameraMatrix(),Ye=o.a6.mat4.invert(new Float64Array(16),He);Ue=o.ca.applyTransform(Ue,o.a6.mat4.multiply([],He,we));const Ze=this._extendAABB(Ue,F,j,x);if(!Ze)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ue=Ze,o.a6.vec3.transformMat4(ke,ke,He);const Qe=.5*(Ue.max[2]-Ue.min[2]),it=this._minimumAABBFrustumDistance(F,Ue),ft=o.a6.vec3.scale([],[0,0,1],Qe),st=o.a6.vec3.add(ft,ke,ft),at=it+(F.pitch===0?0:o.a6.vec3.distance(ke,st)),Rt=F.globeCenterInViewSpace,$t=o.a6.vec3.sub([],ke,[Rt[0],Rt[1],Rt[2]]);o.a6.vec3.normalize($t,$t),o.a6.vec3.scale($t,$t,at);const sn=o.a6.vec3.add([],ke,$t);o.a6.vec3.transformMat4(sn,sn,Ye);const _n=o.dw/o.aq,yn=o.a6.vec3.length(sn),yt=o.bE(Math.max(yn*_n-o.dw,Number.EPSILON),0),Qt=Math.min(F.zoomFromMercatorZAdjusted(yt),j.maxZoom);return Qt>.5*(o.c3+o.bV)?(F.setProjection({name:"mercator"}),F.zoom=Qt,this._cameraForBounds(F,l,p,x,T,A)):{center:F.center,zoom:Qt,bearing:x,pitch:T}}_extendAABB(r,l,p,x){const T=.5*((p.padding.left||0)+(p.padding.right||0)),A=.5*((p.padding.top||0)+(p.padding.bottom||0)),F=A,j=T,H=T,q=A,Y=l.width-(j+H),Q=l.height-(F+q),ae=o.a6.vec3.sub([],r.max,r.min),ge=Math.min(Y/ae[0],Q/ae[1]),_e=Math.min(l.scaleZoom(l.scale*ge),p.maxZoom);if(isNaN(_e))return null;const Te=l.scale/l.zoomScale(_e),we=new o.ca([r.min[0]-j*Te,r.min[1]-q*Te,r.min[2]],[r.max[0]+H*Te,r.max[1]+F*Te,r.max[2]]),ze=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new o.P(p.offset.x,p.offset.y):o.P.convert(p.offset)).rotate(-o.bC(x));return we.center[0]-=ze.x*Te,we.center[1]+=ze.y*Te,we}queryTerrainElevation(r,l){const p=this.transform.elevation;return p?(l=o.l({},{exaggerated:!0},l),p.getAtPoint(o.a5.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,p,x,T,A){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,p,x,T,A);const F=r.clone(),j=this._extendCameraOptions(A);F.bearing=x,F.pitch=T;const H=o.bL.convert(l),q=o.bL.convert(p),Y=new o.bL(H.lng,q.lat),Q=new o.bL(q.lng,H.lat),ae=F.project(H),ge=F.project(q),_e=this.queryTerrainElevation(H),Te=this.queryTerrainElevation(q),we=this.queryTerrainElevation(Y),ze=this.queryTerrainElevation(Q),Ue=[[ae.x,ae.y,Math.min(_e||0,Te||0,we||0,ze||0)],[ge.x,ge.y,Math.max(_e||0,Te||0,we||0,ze||0)]];let ke=o.ca.fromPoints(Ue);const He=F.getWorldToCameraMatrix(),Ye=o.a6.mat4.invert(new Float64Array(16),He);ke=o.ca.applyTransform(ke,He);const Ze=this._extendAABB(ke,F,j,x);if(!Ze)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ke=Ze;const Qe=.5*o.a6.vec3.sub([],ke.max,ke.min)[2],it=this._minimumAABBFrustumDistance(F,ke),ft=[0,0,1,0];o.a6.vec4.transformMat4(ft,ft,He),o.a6.vec4.normalize(ft,ft);const st=o.a6.vec3.scale([],ft,it+Qe),at=o.a6.vec3.add([],ke.center,st);o.a6.vec3.transformMat4(ke.center,ke.center,Ye),o.a6.vec3.transformMat4(at,at,Ye);const Rt=F.unproject(new o.P(ke.center[0],ke.center[1])),$t=o.dv(F.projection,Rt),sn=Math.pow(2,$t),_n=Math.min(F._zoomFromMercatorZ(at[2]*F.pixelsPerMeter*sn/F.worldSize),j.maxZoom);return F.mercatorFromTransition&&_n<.5*(o.c3+o.bV)?(F.setProjection({name:"globe"}),F.zoom=_n,this._cameraForBounds(F,l,p,x,T,A)):{center:Rt,zoom:_n,bearing:x,pitch:T}}fitBounds(r,l,p){const x=this.cameraForBounds(r,l);return this._fitInternal(x,l,p)}fitScreenCoordinates(r,l,p,x,T){const A=o.P.convert(r),F=o.P.convert(l),j=new o.P(Math.min(A.x,F.x),Math.min(A.y,F.y)),H=new o.P(Math.max(A.x,F.x),Math.max(A.y,F.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(A,F))return this;const q=this.transform.pointLocation3D(j),Y=this.transform.pointLocation3D(H),Q=this.transform.pointLocation3D(new o.P(j.x,H.y)),ae=this.transform.pointLocation3D(new o.P(H.x,j.y)),ge=[Math.min(q.lng,Y.lng,Q.lng,ae.lng),Math.min(q.lat,Y.lat,Q.lat,ae.lat)],_e=[Math.max(q.lng,Y.lng,Q.lng,ae.lng),Math.max(q.lat,Y.lat,Q.lat,ae.lat)],Te=x&&x.pitch?x.pitch:this.getPitch(),we=this._cameraForBounds(this.transform,ge,_e,p,Te,x);return this._fitInternal(we,x,T)}_fitInternal(r,l,p){return r?(l=o.l(r,l)).linear?this.easeTo(l,p):this.flyTo(l,p):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let x=!1,T=!1,A=!1;"zoom"in r&&p.zoom!==+r.zoom&&(x=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=o.bL.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(T=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(A=!0,p.pitch=+r.pitch);const F=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!p.isPaddingEqual(F))if(r.retainPadding===!1){const j=p.clone();j.padding=F,p.setLocationAtPoint(p.center,j.centerPoint)}else p.padding=F;return r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),x&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),T&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),A&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.w(Ol),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return o.w(Ol),this;this.stop();const x=p.zoom,T=p.pitch,A=p.bearing;p.setFreeCameraOptions(r);const F=x!==p.zoom,j=T!==p.pitch,H=A!==p.bearing;return this.fire(new o.x("movestart",l)).fire(new o.x("move",l)),F&&this.fire(new o.x("zoomstart",l)).fire(new o.x("zoom",l)).fire(new o.x("zoomend",l)),H&&this.fire(new o.x("rotatestart",l)).fire(new o.x("rotate",l)).fire(new o.x("rotateend",l)),j&&this.fire(new o.x("pitchstart",l)).fire(new o.x("pitch",l)).fire(new o.x("pitchend",l)),this.fire(new o.x("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=o.l({offset:[0,0],duration:500,easing:o.dr},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const p=this.transform,x=this.getZoom(),T=this.getBearing(),A=this.getPitch(),F=this.getPadding(),j="zoom"in r?+r.zoom:x,H="bearing"in r?this._normalizeBearing(r.bearing,T):T,q="pitch"in r?+r.pitch:A,Y=this._extendPadding(r.padding),Q=o.P.convert(r.offset);let ae,ge,_e;if(p.projection.name==="globe"){const ft=o.a5.fromLngLat(p.center),st=Q.rotate(-p.angle);ft.x+=st.x/p.worldSize,ft.y+=st.y/p.worldSize;const at=ft.toLngLat(),Rt=o.bL.convert(r.center||at);this._normalizeCenter(Rt),ae=p.centerPoint.add(st),ge=new o.P(ft.x,ft.y).mult(p.worldSize),_e=new o.P(o.am(Rt.lng),o.at(Rt.lat)).mult(p.worldSize).sub(ge)}else{ae=p.centerPoint.add(Q);const ft=p.pointLocation(ae),st=o.bL.convert(r.center||ft);this._normalizeCenter(st),ge=p.project(ft),_e=p.project(st).sub(ge)}const Te=p.zoomScale(j-x);let we,ze;r.around&&(we=o.bL.convert(r.around),ze=p.locationPoint(we));const Ue=this._zooming||j!==x,ke=this._rotating||T!==H,He=this._pitching||q!==A,Ye=!p.isPaddingEqual(Y),Ze=r.retainPadding===!1?p.clone():p,Qe=ft=>st=>{if(Ue&&(ft.zoom=o.aa(x,j,st)),ke&&(ft.bearing=o.aa(T,H,st)),He&&(ft.pitch=o.aa(A,q,st)),Ye&&(Ze.interpolatePadding(F,Y,st),ae=Ze.centerPoint.add(Q)),we)ft.setLocationAtPoint(we,ze);else{const at=ft.zoomScale(ft.zoom-x),Rt=j>x?Math.min(2,Te):Math.max(.5,Te),$t=Math.pow(Rt,1-st),sn=ft.unproject(ge.add(_e.mult(st*$t)).mult(at));ft.setLocationAtPoint(ft.renderWorldCopies?sn.wrap():sn,ae)}return r.preloadOnly||this._fireMoveEvents(l),ft};if(r.preloadOnly){const ft=this._emulate(Qe,r.duration,p);return this._preloadTiles(ft),this}const it={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ue,this._rotating=ke,this._pitching=He,this._padding=Ye,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,it),this._ease(Qe(p),ft=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(l,ft)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||p.moving||this.fire(new o.x("movestart",r)),this._zooming&&!p.zooming&&this.fire(new o.x("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new o.x("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new o.x("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.x("move",r)),this._zooming&&this.fire(new o.x("zoom",r)),this._rotating&&this.fire(new o.x("rotate",r)),this._pitching&&this.fire(new o.x("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,x=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.x("zoomend",r)),x&&this.fire(new o.x("rotateend",r)),T&&this.fire(new o.x("pitchend",r)),this.fire(new o.x("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const jt=o.ar(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(jt,l)}this.stop(),r=o.l({offset:[0,0],speed:1.2,curve:1.42,easing:o.dr},r);const p=this.transform,x=this.getZoom(),T=this.getBearing(),A=this.getPitch(),F=this.getPadding(),j="zoom"in r?o.ap(+r.zoom,p.minZoom,p.maxZoom):x,H="bearing"in r?this._normalizeBearing(r.bearing,T):T,q="pitch"in r?+r.pitch:A,Y=this._extendPadding(r.padding),Q=p.zoomScale(j-x),ae=o.P.convert(r.offset);let ge=p.centerPoint.add(ae);const _e=p.pointLocation(ge),Te=o.bL.convert(r.center||_e);this._normalizeCenter(Te);const we=p.project(_e),ze=p.project(Te).sub(we);let Ue=r.curve;const ke=Math.max(p.width,p.height),He=ke/Q,Ye=ze.mag();if("minZoom"in r){const jt=o.ap(Math.min(r.minZoom,x,j),p.minZoom,p.maxZoom),tn=ke/p.zoomScale(jt-x);Ue=Math.sqrt(tn/Ye*2)}const Ze=Ue*Ue;function Qe(jt){const tn=(He*He-ke*ke+(jt?-1:1)*Ze*Ze*Ye*Ye)/(2*(jt?He:ke)*Ze*Ye);return Math.log(Math.sqrt(tn*tn+1)-tn)}function it(jt){return(Math.exp(jt)-Math.exp(-jt))/2}function ft(jt){return(Math.exp(jt)+Math.exp(-jt))/2}const st=Qe(0);let at=function(jt){return ft(st)/ft(st+Ue*jt)},Rt=function(jt){return ke*((ft(st)*(it(tn=st+Ue*jt)/ft(tn))-it(st))/Ze)/Ye;var tn},$t=(Qe(1)-st)/Ue;if(Math.abs(Ye)<1e-6||!isFinite($t)){if(Math.abs(ke-He)<1e-6)return this.easeTo(r,l);const jt=He<ke?-1:1;$t=Math.abs(Math.log(He/ke))/Ue,Rt=function(){return 0},at=function(tn){return Math.exp(jt*Ue*tn)}}r.duration="duration"in r?+r.duration:1e3*$t/("screenSpeed"in r?+r.screenSpeed/Ue:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const sn=T!==H,_n=q!==A,yn=!p.isPaddingEqual(Y),yt=r.retainPadding===!1?p.clone():p,Qt=jt=>tn=>{const rn=tn*$t,en=1/at(rn);jt.zoom=tn===1?j:x+jt.scaleZoom(en),sn&&(jt.bearing=o.aa(T,H,tn)),_n&&(jt.pitch=o.aa(A,q,tn)),yn&&(yt.interpolatePadding(F,Y,tn),ge=yt.centerPoint.add(ae));const bn=tn===1?Te:jt.unproject(we.add(ze.mult(Rt(rn))).mult(en));return jt.setLocationAtPoint(jt.renderWorldCopies?bn.wrap():bn,ge),jt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),jt};if(r.preloadOnly){const jt=this._emulate(Qt,r.duration,p);return this._preloadTiles(jt),this}return this._zooming=!0,this._rotating=sn,this._pitching=_n,this._padding=yn,this._prepareEase(l,!1),this._ease(Qt(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=o.q.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=o.bB(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&o.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,p){const x=Math.ceil(15*l/1e3),T=[],A=r(p.clone());for(let F=0;F<=x;F++){const j=A(F/x);T.push(j.clone())}return T}_preloadTiles(r,l){}}class Sd{constructor(r={}){this.options=r,o.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,p=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=se("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const x=se("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",p),this._innerContainer=se("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.e.ACCESS_TOKEN}];if(r){const p=l.reduce((x,T,A)=>(T.value&&(x+=`${T.key}=${T.value}${A<l.length-1?"&":""}`),x),"?");r.href=`${o.e.FEEDBACK_URL}/${p}#${Ua(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const l=this._map.style._mergedSourceCaches;for(const x in l){const T=l[x];if(T.used){const A=T.getSource();A.attribution&&r.indexOf(A.attribution)<0&&r.push(A.attribution)}}r.sort((x,T)=>x.length-T.length),r=r.filter((x,T)=>{for(let A=T+1;A<r.length;A++)if(r[A].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Td{constructor(){o.aJ(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=se("div","mapboxgl-ctrl");const l=se("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class hp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const x of p)if(x.id===r)return void(x.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Wh{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=o.cw((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const pm={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},fp=["mouseenter","mouseover","mouseleave","mouseout"];class Ed extends o.x{constructor(r,l,p,x){const{point:T,lngLat:A,originalEvent:F,target:j}=r;super(r.type,{point:T,lngLat:A,originalEvent:F,target:j}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=p,this.feature=x}}class As{constructor(r){this.map=r,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const{type:p,filter:x}=l;if(x){const A=o.M(x,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(A.result==="error")throw new Error(A.value.map(F=>`${F.key}: ${F.message}`).join(", "));this.filters.set(r,A.value)}const T=this.interactionsByType.get(p)||new Map;T.size===0&&(fp.includes(p)?this.map.on(p,l.featureset,this.handleType):this.map.on(p,this.handleType),this.interactionsByType.set(p,T)),T.set(r,l),this.typeById.set(r,p)}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const p=this.interactionsByType.get(l);p&&(p.delete(r),p.size===0&&this.map.off(l,this.handleType))}handleType(r){const l=this.interactionsByType.get(r.type),p=Array.from(l).reverse(),x=[];for(const[,F]of p)F.featureset&&x.push({featureset:F.featureset,filter:F.filter,radius:F.radius});let T=this.map.style.queryRenderedFeaturesForInteractions(r.point,x,this.map.transform);!T.length&&fp.includes(r.type)&&(T=[null]);let A=!1;for(const F of T){for(const[j,H]of p){const{handler:q,featureset:Y}=H;if(Y&&(F==null||o.bi(F.featureset,Y))&&q(new Ed(r,j,H,F))!==!1){A=!0;break}}if(A)break}if(!A)for(const[F,j]of p){const{handler:H,featureset:q}=j;if(!q&&H(new Ed(r,F,j,null))!==!1)break}}}function Ka(d,r){if(Array.isArray(d)&&Array.isArray(r)){const l=new Set(d),p=new Set(r);return l.size===p.size&&d.every(x=>p.has(x))}return o.bi(d,r)}const xh={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1},Su={showCompass:!0,showZoom:!0,visualizePitch:!1};class kl{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new Gh({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new Rf({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),De()}move(r,l){const p=this.map,x=this.mouseRotate.mousemoveWindow(r,l),T=x&&x.bearingDelta;if(T&&p.setBearing(p.getBearing()+T),this.mousePitch){const A=this.mousePitch.mousemoveWindow(r,l),F=A&&A.pitchDelta;F&&p.setPitch(p.getPitch()+F)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ve(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(o.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),lt(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,lt(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=xt(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=xt(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Tu(d,r,l){if(d=new o.bL(d.lng,d.lat),r){const p=new o.bL(d.lng-360,d.lat),x=new o.bL(d.lng+360,d.lat),T=360*Math.ceil(Math.abs(d.lng-l.center.lng)/360),A=l.locationPoint(d).distSqr(r),F=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint(p).distSqr(r)<A&&(F||Math.abs(p.lng-l.center.lng)<T)?d=p:l.locationPoint(x).distSqr(r)<A&&(F||Math.abs(x.lng-l.center.lng)<T)&&(d=x)}for(;Math.abs(d.lng-l.center.lng)>180;){const p=l.locationPoint(d);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;d.lng>l.center.lng?d.lng-=360:d.lng+=360}return d}const Eu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Rl extends o.E{constructor(r,l){if(super(),(r instanceof HTMLElement||l)&&(r=o.l({element:r},l)),o.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=se("div");const T=41,A=27,F=ue("svg",{display:"block",height:T*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${T}`},this._element),j=ue("radialGradient",{id:"shadowGradient"},ue("defs",{},F));ue("stop",{offset:"10%","stop-opacity":.4},j),ue("stop",{offset:"100%","stop-opacity":.05},j),ue("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},F),ue("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},F),ue("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},F),ue("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},F),this._offset=o.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",T=>{T.preventDefault()}),this._element.addEventListener("mousedown",T=>{T.preventDefault()});const p=this._element.classList;for(const T in Eu)p.remove(`mapboxgl-marker-anchor-${T}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const x=r&&r.className?r.className.trim().split(/\s+/):[];p.add(...x),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.bL.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const p=r.unproject(l),x=r.getFreeCameraOptions();if(!x.position)return!1;const T=x.position.toLngLat();return T.distanceTo(p)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(l);let x;r._showingGlobe()&&o.dz(r.transform,this._lngLat)?x=0:(x=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${Eu[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!r||p!=="map")return"";if(!l._showingGlobe()){const j=l.getPitch();return j?`rotateX(${j}deg)`:""}const x=o.c1(o.dA(l.transform,this._lngLat)),T=r.sub(o.dB(l.transform)),A=Math.abs(T.x)+Math.abs(T.y);if(A===0)return"";const F=x/A;return`rotateX(${-T.y*F}deg) rotateY(${T.x*F}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let p=0;const x=this.getRotationAlignment();if(x==="map")if(l._showingGlobe()){const T=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat+.001)),A=l.project(new o.bL(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);p=o.c1(Math.atan2(A.y,A.x))-90}else p=-l.getBearing();else if(x==="horizon"){const T=o.a7(4,6,l.getZoom()),A=o.dB(l.transform);A.y+=T*l.transform.height;const F=r.sub(A),j=o.c1(Math.atan2(F.y,F.x));p=(j>90?j-270:j+90)*(1-T)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=Tu(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const p=this._pointerdownPos,x=this._positionDelta;if(p&&x){if(!this._isDragging){const T=this._clickTolerance||l._clickTolerance;if(r.point.dist(p)<T)return;this._isDragging=!0}this._pos=r.point.sub(x),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.x("dragstart"))),this.fire(new o.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.x("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,p=this._pos;l&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const mm={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},dp={maxWidth:100,unit:"metric"},gm={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},_m={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ad=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ya(d=new o.P(0,0),r="bottom"){if(typeof d=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(r){case"top":return new o.P(0,d);case"top-left":return new o.P(l,l);case"top-right":return new o.P(-l,l);case"bottom":return new o.P(0,-d);case"bottom-left":return new o.P(l,-l);case"bottom-right":return new o.P(-l,-l);case"left":return new o.P(d,0);case"right":return new o.P(-d,0)}return new o.P(0,0)}return d instanceof o.P||Array.isArray(d)?o.P.convert(d):o.P.convert(d[r]||[0,0])}return{version:I,supported:le.supported,setRTLTextPlugin:o.dC,getRTLTextPluginStatus:o.dD,Map:class extends Bf{constructor(d){$.mark(B.create);const r=d;if((d=o.l({},xh,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&o.dx(window)&&(d.antialias=!1,o.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Xa(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._repaint=!!d.repaint,this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._collectResourceTiming=d.collectResourceTiming,this._language=this._parseLanguage(d.language),this._worldview=d.worldview,this._renderTaskQueue=new hp,this._domRenderTaskQueue=new hp,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.aQ(),this._locale=o.l({},pm,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._performanceMetricsCollection=d.performanceMetricsCollection,this._tessellationStep=d.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=d.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Wh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=d.scaleFactor,this._requestManager=new Ht(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,this._contextCreateOptions=d.contextCreateOptions?{...d.contextCreateOptions}:{},typeof d.container=="string"){const l=document.getElementById(d.container);if(!l)throw new Error(`Container '${d.container.toString()}' not found.`);this._container=l}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&o.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),o.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new ka),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Uo(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,(d.style||!d.testMode)&&this.setStyle(d.style||o.e.DEFAULT_STYLE,{config:d.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),d.hash&&(this._hash=new md(typeof d.hash=="string"&&d.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch});const l=d.bounds;l&&(this.resize(),this.fitBounds(l,o.l({},d.fitBoundsOptions,{duration:0})))}this.resize(),d.attributionControl&&this.addControl(new Sd({customAttribution:d.customAttribution})),this._logoControl=new Td,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new o.x(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new o.x(`${l.dataType}dataloading`,l))}),this._interactions=new As(this)}_getMapId(){return this._mapId}addControl(d,r){if(r===void 0&&(r=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new o.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=d.onAdd(this);this._controls.push(d);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new o.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(d);return r>-1&&this._controls.splice(r,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new o.x("movestart",d)).fire(new o.x("move",d)),this.fire(new o.x("resize",d)),r&&this.fire(new o.x("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(o.as.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new o.x("zoomstart")).fire(new o.x("zoom")).fire(new o.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new o.x("pitchstart")).fire(new o.x("pitch")).fire(new o.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(d){return this._scaleFactor=d,this.painter.scaleFactor=d,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(d){return d==="auto"?navigator.language:Array.isArray(d)?d.length===0?void 0:d.map(r=>r==="auto"?navigator.language:r):d}setLanguage(d){const r=this._parseLanguage(d);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){return this.style&&d!==this._worldview?(this._worldview=d,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(d){return this._lazyInitEmptyStyle(),d?typeof d=="string"&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const d=this.transform,r=d.projection.name;let l;r==="globe"&&d.zoom>=o.bV?(d.setMercatorFromTransition(),l=!0):r==="mercator"&&d.zoom<o.bV&&(d.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,r){return this._updateProjection(d||r||{name:"mercator"})}_updateProjection(d){let r;return r=d.name==="globe"&&this.transform.zoom>=o.bV?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(d){return this.transform.locationPoint3D(o.bL.convert(d))}unproject(d){return this.transform.pointLocation3D(o.P.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(d,r,l){const p=x=>{let T=[];if(Array.isArray(r)){const A=r.filter(F=>this.getLayer(F));T=A.length?this.queryRenderedFeatures(x,{layers:A}):[]}else T=this.queryRenderedFeatures(x,{featureset:r});return T};if(d==="mouseenter"||d==="mouseover"){let x=!1;return{listener:l,targets:r,delegates:{mousemove:A=>{const F=p(A.point);F.length?x||(x=!0,l.call(this,new po(d,this,A.originalEvent,{features:F}))):x=!1},mouseout:()=>{x=!1}}}}if(d==="mouseleave"||d==="mouseout"){let x=!1;return{listener:l,targets:r,delegates:{mousemove:F=>{p(F.point).length?x=!0:x&&(x=!1,l.call(this,new po(d,this,F.originalEvent)))},mouseout:F=>{x&&(x=!1,l.call(this,new po(d,this,F.originalEvent)))}}}}{const x=T=>{const A=p(T.point);A.length&&(T.features=A,l.call(this,T),delete T.features)};return{listener:l,targets:r,delegates:{[d]:x}}}}on(d,r,l){if(typeof r=="function"||l===void 0)return super.on(d,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(d,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(p);for(const x in p.delegates)this.on(x,p.delegates[x]);return this}once(d,r,l){if(typeof r=="function"||l===void 0)return super.once(d,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(d,r,l);for(const x in p.delegates)this.once(x,p.delegates[x]);return this}off(d,r,l){if(typeof r=="function"||l===void 0)return super.off(d,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._delegatedListeners?this._delegatedListeners[d]:void 0;return p&&(x=>{for(let T=0;T<x.length;T++){const A=x[T];if(A.listener===l&&Ka(A.targets,r)){for(const F in A.delegates)this.off(F,A.delegates[F]);return x.splice(T,1),this}}})(p),this}queryRenderedFeatures(d,r){if(!this.style)return[];if(r!==void 0||d===void 0||d instanceof o.P||Array.isArray(d)||(r=d,d=void 0),d=d||[[0,0],[this.transform.width,this.transform.height]],"featureset"in(r=r||{}))return this._isFeaturesetDescriptorValid(r.featureset)?this.style.queryRenderedFeaturesForInteractions(d,[r],this.transform):[];if(r.layers&&Array.isArray(r.layers)){for(const l of r.layers)if(!this._isValidId(l))return[]}return this.style.queryRenderedFeatures(d,r,this.transform)}querySourceFeatures(d,r){return!d||typeof d=="string"&&!this._isValidId(d)?[]:this.style.querySourceFeatures(d,r)}isPointOnSurface(d){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&o.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.P.convert(d))}addInteraction(d,r){return this._interactions.add(d,r),this}removeInteraction(d){return this._interactions.remove(d),this}setStyle(d,r){return r=o.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&d&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(d,(l,p)=>{l?(o.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(d,r)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(d,r))}_getUIString(d){const r=this._locale[d];if(r==null)throw new Error(`Missing UI string '${d}'`);return r}_updateStyle(d,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d){const l=o.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new ns(this,l).load(d),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ns(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.w("There is no style added to the map."),!1)}_isValidId(d){return d==null?(this.fire(new o.t(new Error("IDs can't be empty."))),!1):!o.aK(d)||(this.fire(new o.t(new Error(`IDs can't contain special symbols: "${d}".`))),!1)}_isFeaturesetDescriptorValid(d){return"featuresetId"in d?this._isValidId(d.featuresetId):"layerId"in d&&this._isValidId(d.layerId)}_areTargetsValid(d){if(Array.isArray(d)){for(const r of d)if(!this._isValidId(r))return!1;return!0}return this._isFeaturesetDescriptorValid(d)}addSource(d,r){return this._isValidId(d)?(this._lazyInitEmptyStyle(),this.style.addSource(d,r),this._update(!0)):this}isSourceLoaded(d){return!!this._isValidId(d)&&!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(d,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(d,r,l)}removeSource(d){return this._isValidId(d)?(this.style.removeSource(d),this._updateTerrain(),this._update(!0)):this}getSource(d){return this._isValidId(d)?this.style.getOwnSource(d):null}addImage(d,r,{pixelRatio:l=1,sdf:p=!1,stretchX:x,stretchY:T,content:A}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:F,height:j,data:H}=o.q.getImageData(r);this.style.addImage(d,{data:new o.r({width:F,height:j},H),pixelRatio:l,stretchX:x,stretchY:T,content:A,sdf:p,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new o.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:F,height:j}=r,H=r;this.style.addImage(d,{data:new o.r({width:F,height:j},new Uint8Array(H.data)),pixelRatio:l,stretchX:x,stretchY:T,content:A,sdf:p,version:0,userImage:H}),H.onAdd&&H.onAdd(this,d)}}updateImage(d,r){this._lazyInitEmptyStyle();const l=this.style.getImage(d);if(!l)return void this.fire(new o.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?o.q.getImageData(r):r,{width:x,height:T,data:A}=p;if(x===void 0||T===void 0)return void this.fire(new o.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==l.data.width||T!==l.data.height)return void this.fire(new o.t(new Error(`The width and height of the updated image (${x}, ${T})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const F=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);l.data.replace(A,F),this.style.updateImage(d,l)}hasImage(d){return d?!!this.style&&!!this.style.getImage(d):(this.fire(new o.t(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,r){o.o(this._requestManager.transformRequest(d,o.R.Image),(l,p)=>{r(l,p instanceof HTMLImageElement?o.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(d,r){this._lazyInitEmptyStyle(),this.style.addModel(d,r)}hasModel(d){return d?this.style.hasModel(d):(this.fire(new o.t(new Error("Missing required model id"))),!1)}removeModel(d){this.style.removeModel(d)}listModels(){return this.style.listModels()}addLayer(d,r){return this._isValidId(d.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(d,r),this._update(!0)):this}getSlot(d){const r=this.getLayer(d);return r&&r.slot||null}setSlot(d,r){return this.style.setSlot(d,r),this.style.mergeLayers(),this._update(!0)}addImport(d,r){return this.style.addImport(d,r),this}updateImport(d,r){return typeof r!="string"&&r.id!==d?(this.removeImport(d),this.addImport(r)):(this.style.updateImport(d,r),this._update(!0))}removeImport(d){return this.style.removeImport(d),this}moveImport(d,r){return this.style.moveImport(d,r),this._update(!0)}moveLayer(d,r){return this._isValidId(d)?(this.style.moveLayer(d,r),this._update(!0)):this}removeLayer(d){return this._isValidId(d)?(this.style.removeLayer(d),this._update(!0)):this}getLayer(d){if(!this._isValidId(d))return null;const r=this.style.getOwnLayer(d);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(d,r,l){return this._isValidId(d)?(this.style.setLayerZoomRange(d,r,l),this._update(!0)):this}setFilter(d,r,l={}){return this._isValidId(d)?(this.style.setFilter(d,r,l),this._update(!0)):this}getFilter(d){return this._isValidId(d)?this.style.getFilter(d):null}setPaintProperty(d,r,l,p={}){return this._isValidId(d)?(this.style.setPaintProperty(d,r,l,p),this._update(!0)):this}getPaintProperty(d,r){return this._isValidId(d)?this.style.getPaintProperty(d,r):null}setLayoutProperty(d,r,l,p={}){return this._isValidId(d)?(this.style.setLayoutProperty(d,r,l,p),this._update(!0)):this}getLayoutProperty(d,r){return this._isValidId(d)?this.style.getLayoutProperty(d,r):null}getSchema(d){return this.style.getSchema(d)}setSchema(d,r){return this.style.setSchema(d,r),this._update(!0)}getConfig(d){return this.style.getConfig(d)}setConfig(d,r){return this.style.setConfig(d,r),this._update(!0)}getConfigProperty(d,r){return this.style.getConfigProperty(d,r)}setConfigProperty(d,r,l){return this.style.setConfigProperty(d,r,l),this._update(!0)}getFeaturesetDescriptors(d){return this.style.getFeaturesetDescriptors(d)}setLights(d){if(this._lazyInitEmptyStyle(),d&&d.length===1&&d[0].type==="flat"){const r=d[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(d),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const d=this.style.getLights()||[];return d.length===0&&d.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),d}setLight(d,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:d}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(d){return this._lazyInitEmptyStyle(),this.style.setColorTheme(d),this._update(!0)}setCamera(d){return this.style.setCamera(d),this._triggerCameraUpdate(d)}_triggerCameraUpdate(d){return this._update(this.transform.setOrthographicProjectionAtLowPitch(d["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.bL.convert(d),this.transform):0}setFeatureState(d,r){return d.source&&!this._isValidId(d.source)?this:(this.style.setFeatureState(d,r),this._update())}removeFeatureState(d,r){return d.source&&!this._isValidId(d.source)?this:(this.style.removeFeatureState(d,r),this._update())}getFeatureState(d){return d.source&&!this._isValidId(d.source)?null:this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p,x,T=this._container;for(;T&&(!p||!x);){const A=window.getComputedStyle(T).transform;A&&A!=="none"&&(l=A.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(p=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(x=l[3])),T=T.parentElement}this._containerWidth=p?Math.abs(d/p):d,this._containerHeight=x?Math.abs(r/x):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=se("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=se("div","mapboxgl-canvas-container",d);this._canvas=se("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=se("div","mapboxgl-control-container",d),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{p[x]=se("div",`mapboxgl-ctrl-${x}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,r){const l=o.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(d),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${r}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const r=this._markers.indexOf(d);r!==-1&&this._markers.splice(r,1)}_addPopup(d){this._popups.push(d)}_removePopup(d){const r=this._popups.indexOf(d);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const d=o.l({},le.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",d);r?(Sn(r,!0),this.painter=new Cl(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.m.testSupport(r)):this.fire(new o.t(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.x("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new o.x("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let r;this.fire(new o.x("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,p=o.q.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=x.createQuery(),x.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const H=this.transform.zoom,q=this.transform.pitch,Y=o.q.now(),Q=new o.a3(H,{now:Y,fadeDuration:T,pitch:q,transition:this.style.transition});this.style.update(Q)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(p);const F=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),F&&(this._placementDirty=F.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,$.mark(B.load),this.fire(new o.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const H=o.q.now()-p;x.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const q=x.getQueryParameter(r,x.QUERY_RESULT)/1e6;x.deleteQuery(r),this.fire(new o.x("gpu-timing-frame",{cpuTime:H,gpuTime:q}))},50)}if(this.listens("gpu-timing-layer")){const H=this.painter.collectGpuTimers();setTimeout(()=>{const q=this.painter.queryGpuTimers(H);this.fire(new o.x("gpu-timing-layer",{layerTimes:q}))},50)}if(this.listens("gpu-timing-deferred-render")){const H=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const q=this.painter.queryGpuTimeDeferredRender(H);this.fire(new o.x("gpu-timing-deferred-render",{gpuTime:q}))},50)}const j=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(j||this._repaint)this.triggerRepaint();else{const H=this.idle();if(H&&(A=this._updateAverageElevation(p,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),H&&(this.fire(new o.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const q=this._calculateSpeedIndex();this.fire(new o.x("speedindexcompleted",{speedIndex:q})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,$.mark(B.fullLoad),this._performanceMetricsCollection&&_r(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(d){for(const r of this._markers)d&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!d||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(d,r=!1){const l=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(r||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const x=this.transform.averageElevation;let T=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=d;const A=Math.abs(x-T);if(A>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(T),l(T);this._averageElevation.easeTo(T,d,300)}else if(A>1e-4)return this._averageElevation.jumpTo(T),l(T)}return!!this._averageElevation.isEasing(d)&&l(this._averageElevation.getValue(d))}_authenticate(){Ke(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===Nt||d.status===401)){const r=this.painter.context.gl;Sn(r,!1),this._logoControl instanceof Td&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Un(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Bn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const d=this._isDragging();this.painter.updateTerrain(this.style,d)}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function x(T){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,T,0);const A=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,A),A}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(x(d),r.canvasCopies.map(x),r.timeStamps)}_canvasPixelComparison(d,r,l){let p=l[1]-l[0];const x=d.length/4;for(let T=0;T<r.length;T++){const A=r[T];let F=0;for(let j=0;j<A.length;j+=4)A[j]===d[j]&&A[j+1]===d[j+1]&&A[j+2]===d[j+2]&&A[j+3]===d[j+3]&&(F+=1);p+=(l[T+2]-l[T+1])*(1-F/x)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),mr.delete(this.painter.context.gl),Pn.remove(),Jt.remove(),this._removed=!0,this.fire(new o.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=o.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(d){const r=this.style?this.style.getSourceCaches():[];return o.bg(r,(l,p)=>l._preloadTiles(d,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(d){this._showParseStatus!==d&&(this._showParseStatus=d,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(d){this._showLayers2DWireframe!==d&&(this._showLayers2DWireframe=d,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(d){this._showLayers3DWireframe!==d&&(this._showLayers3DWireframe=d,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,this._tp.refreshUI(),d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(d){this._showTileAABBs!==d&&(this._showTileAABBs=d,this._tp.refreshUI(),d&&this._update())}_setCacheLimits(d,r){o.dy(d,r)}get version(){return I}},NavigationControl:class{constructor(d={}){this.options=o.l({},Su,d),this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),se("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),se("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=se("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const r=d.getZoom(),l=r===d.getMaxZoom(),p=r===d.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new kl(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,r){const l=se("button",d,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(d,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);d.setAttribute("aria-label",l),d.firstElementChild&&d.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends o.E{constructor(d={}){super();const r=navigator.geolocation;this.options=o.l({geolocation:r},mm,d),o.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ml(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,d(l)};this._supportsGeolocation!==void 0?d(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(d){const r=this._map.getMaxBounds(),l=d.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new o.x("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("geolocate",d)),this._finish()}}_updateCamera(d){const r=new o.bL(d.coords.longitude,d.coords.latitude),l=d.coords.accuracy,p=this._map.getBearing(),x=o.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),x,{geolocateSource:!0})}_updateMarker(d){if(d){const r=new o.bL(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,r=o.bE(1,d._center.lat)*d.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new o.x("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=se("button","mapboxgl-ctrl-geolocate",this._container),se("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=se("div","mapboxgl-user-location"),this._dotElement.appendChild(se("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(se("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Rl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=se("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.x("trackuserlocationend")))})}}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Sd,ScaleControl:class{constructor(d={}){this.options=o.l({},dp,d),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),o.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,p=r._containerWidth/2-d/2,x=r.unproject([p,l]),T=r.unproject([p+d,l]),A=x.distanceTo(T);if(this.options.unit==="imperial"){const F=3.2808*A;F>5280?this._setScale(d,F/5280,"mile"):this._setScale(d,F,"foot")}else this.options.unit==="nautical"?this._setScale(d,A/1852,"nautical-mile"):A>=1e3?this._setScale(d,A/1e3,"kilometer"):this._setScale(d,A,"meter")}_setScale(d,r,l){this._map._requestDomTask(()=>{const p=function(T){const A=Math.pow(10,`${Math.floor(T)}`.length-1);let F=T/A;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(j){const H=Math.pow(10,Math.ceil(-Math.log(j)/Math.LN10));return Math.round(j*H)/H}(F),A*F}(r),x=p/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(p):`${p}&nbsp;${gm[l]}`,this._container.style.width=d*x+"px"})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=se("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d={}){this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:o.w("Full screen control 'container' must be a DOM element.")),o.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=se("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=se("button","mapboxgl-ctrl-fullscreen",this._controlContainer);se("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.E{constructor(d){super(),this.options=o.l(Object.create(_m),d),o.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),d._addPopup(this),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new o.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),d._canvasContainer&&d._canvasContainer.classList.remove("mapboxgl-track-pointer"),d._removePopup(this),this._map=void 0),this.fire(new o.x("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=o.bL.convert(d),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const r=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=d;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=se("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(d),this.options.closeButton){const l=this._closeButton=se("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let r;return this._classList.delete(d)?r=!1:(this._classList.add(d),r=!0),this._updateClassList(),r}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,p=this._pos;if(!r||!l||!p)return"bottom";const x=l.offsetWidth,T=l.offsetHeight,A=p.x<x/2,F=p.x>r.transform.width-x/2;if(p.y+d<T)return A?"top-left":F?"top-right":"top";if(p.y>r.transform.height-T){if(A)return"bottom-left";if(F)return"bottom-right"}return A?"left":F?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),d.className=r.join(" ")}_update(d){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=se("div","mapboxgl-popup",r.getContainer()),this._tip=se("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tu(this._lngLat,this._pos,r.transform)),!this._trackPointer||d){const x=this._pos=this._trackPointer&&d instanceof o.P?d:r.project(this._lngLat),T=Ya(this.options.offset),A=this._anchor=this._getAnchor(T.y),F=Ya(this.options.offset,A),j=x.add(F).round();r._requestDomTask(()=>{this._container&&A&&(this._container.style.transform=`${Eu[A]} translate(${j.x}px,${j.y}px)`)})}if(!this._marker&&r._showingGlobe()){const x=o.dz(r.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Ad);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:Rl,Style:ns,LngLat:o.bL,LngLatBounds:o.as,Point:o.P,MercatorCoordinate:o.a5,FreeCameraOptions:vr,Evented:o.E,config:o.e,prewarm:o.dE,clearPrewarmedResources:o.dF,get accessToken(){return o.e.ACCESS_TOKEN},set accessToken(d){o.e.ACCESS_TOKEN=d},get baseApiUrl(){return o.e.API_URL},set baseApiUrl(d){o.e.API_URL=d},get workerCount(){return o.dG.workerCount},set workerCount(d){o.dG.workerCount=d},get maxParallelImageRequests(){return o.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){o.e.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){o.dH(d)},get workerUrl(){return o.dI.workerUrl},set workerUrl(d){o.dI.workerUrl=d},get workerClass(){return o.dI.workerClass},set workerClass(d){o.dI.workerClass=d},get workerParams(){return o.dI.workerParams},set workerParams(d){o.dI.workerParams=d},get dracoUrl(){return o.dJ()},set dracoUrl(d){o.dK(d)},get meshoptUrl(){return o.dL()},set meshoptUrl(d){o.dM(d)},setNow:o.q.setNow,restoreNow:o.q.restoreNow}});var S=h;return S})}(s0)),s0.exports}var nq=tq();const Dp=zo(nq),Um=({id:e,checked:t,onCheckedChange:i})=>Dt.jsx("div",{className:"inline-flex",children:Dt.jsxs("label",{className:"relative inline-block w-11 h-6 cursor-pointer",htmlFor:e,children:[Dt.jsx("input",{type:"checkbox",id:e,className:"sr-only peer",checked:t,onChange:a=>i(a.target.checked)}),Dt.jsx("div",{className:`
          absolute inset-0 rounded-full transition
          peer-checked:bg-blue-600 bg-gray-200
          peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300
        `,children:Dt.jsx("div",{className:`
            absolute left-[2px] top-[2px] h-5 w-5
            rounded-full bg-white transition-transform duration-200
            peer-checked:translate-x-5
          `})})]})}),Vm=({htmlFor:e,children:t})=>Dt.jsx("label",{htmlFor:e,className:"text-sm font-medium text-gray-700 ml-2 cursor-pointer",children:t});var F_={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var rq=F_.exports,Rk;function Y5(){return Rk||(Rk=1,function(e,t){(function(i,a){a(t)})(rq,function(i){var a="1.9.4";function h(y){var M,V,ie,Ee;for(V=1,ie=arguments.length;V<ie;V++){Ee=arguments[V];for(M in Ee)y[M]=Ee[M]}return y}var v=Object.create||function(){function y(){}return function(M){return y.prototype=M,new y}}();function S(y,M){var V=Array.prototype.slice;if(y.bind)return y.bind.apply(y,V.call(arguments,1));var ie=V.call(arguments,2);return function(){return y.apply(M,ie.length?ie.concat(V.call(arguments)):arguments)}}var o=0;function I(y){return"_leaflet_id"in y||(y._leaflet_id=++o),y._leaflet_id}function B(y,M,V){var ie,Ee,Ge,Pt;return Pt=function(){ie=!1,Ee&&(Ge.apply(V,Ee),Ee=!1)},Ge=function(){ie?Ee=arguments:(y.apply(V,arguments),setTimeout(Pt,M),ie=!0)},Ge}function $(y,M,V){var ie=M[1],Ee=M[0],Ge=ie-Ee;return y===ie&&V?y:((y-Ee)%Ge+Ge)%Ge+Ee}function U(){return!1}function K(y,M){if(M===!1)return y;var V=Math.pow(10,M===void 0?6:M);return Math.round(y*V)/V}function te(y){return y.trim?y.trim():y.replace(/^\s+|\s+$/g,"")}function le(y){return te(y).split(/\s+/)}function se(y,M){Object.prototype.hasOwnProperty.call(y,"options")||(y.options=y.options?v(y.options):{});for(var V in M)y.options[V]=M[V];return y.options}function ue(y,M,V){var ie=[];for(var Ee in y)ie.push(encodeURIComponent(V?Ee.toUpperCase():Ee)+"="+encodeURIComponent(y[Ee]));return(!M||M.indexOf("?")===-1?"?":"&")+ie.join("&")}var be=/\{ *([\w_ -]+) *\}/g;function Ce(y,M){return y.replace(be,function(V,ie){var Ee=M[ie];if(Ee===void 0)throw new Error("No value provided for variable "+V);return typeof Ee=="function"&&(Ee=Ee(M)),Ee})}var Re=Array.isArray||function(y){return Object.prototype.toString.call(y)==="[object Array]"};function De(y,M){for(var V=0;V<y.length;V++)if(y[V]===M)return V;return-1}var ve="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Le(y){return window["webkit"+y]||window["moz"+y]||window["ms"+y]}var Fe=0;function lt(y){var M=+new Date,V=Math.max(0,16-(M-Fe));return Fe=M+V,window.setTimeout(y,V)}var xt=window.requestAnimationFrame||Le("RequestAnimationFrame")||lt,gt=window.cancelAnimationFrame||Le("CancelAnimationFrame")||Le("CancelRequestAnimationFrame")||function(y){window.clearTimeout(y)};function Je(y,M,V){if(V&&xt===lt)y.call(M);else return xt.call(window,S(y,M))}function St(y){y&&gt.call(window,y)}var Nt={__proto__:null,extend:h,create:v,bind:S,get lastId(){return o},stamp:I,throttle:B,wrapNum:$,falseFn:U,formatNum:K,trim:te,splitWords:le,setOptions:se,getParamString:ue,template:Ce,isArray:Re,indexOf:De,emptyImageUrl:ve,requestFn:xt,cancelFn:gt,requestAnimFrame:Je,cancelAnimFrame:St};function Ht(){}Ht.extend=function(y){var M=function(){se(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},V=M.__super__=this.prototype,ie=v(V);ie.constructor=M,M.prototype=ie;for(var Ee in this)Object.prototype.hasOwnProperty.call(this,Ee)&&Ee!=="prototype"&&Ee!=="__super__"&&(M[Ee]=this[Ee]);return y.statics&&h(M,y.statics),y.includes&&(Ct(y.includes),h.apply(null,[ie].concat(y.includes))),h(ie,y),delete ie.statics,delete ie.includes,ie.options&&(ie.options=V.options?v(V.options):{},h(ie.options,y.options)),ie._initHooks=[],ie.callInitHooks=function(){if(!this._initHooksCalled){V.callInitHooks&&V.callInitHooks.call(this),this._initHooksCalled=!0;for(var Ge=0,Pt=ie._initHooks.length;Ge<Pt;Ge++)ie._initHooks[Ge].call(this)}},M},Ht.include=function(y){var M=this.prototype.options;return h(this.prototype,y),y.options&&(this.prototype.options=M,this.mergeOptions(y.options)),this},Ht.mergeOptions=function(y){return h(this.prototype.options,y),this},Ht.addInitHook=function(y){var M=Array.prototype.slice.call(arguments,1),V=typeof y=="function"?y:function(){this[y].apply(this,M)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(V),this};function Ct(y){if(!(typeof L>"u"||!L||!L.Mixin)){y=Re(y)?y:[y];for(var M=0;M<y.length;M++)y[M]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Kt={on:function(y,M,V){if(typeof y=="object")for(var ie in y)this._on(ie,y[ie],M);else{y=le(y);for(var Ee=0,Ge=y.length;Ee<Ge;Ee++)this._on(y[Ee],M,V)}return this},off:function(y,M,V){if(!arguments.length)delete this._events;else if(typeof y=="object")for(var ie in y)this._off(ie,y[ie],M);else{y=le(y);for(var Ee=arguments.length===1,Ge=0,Pt=y.length;Ge<Pt;Ge++)Ee?this._off(y[Ge]):this._off(y[Ge],M,V)}return this},_on:function(y,M,V,ie){if(typeof M!="function"){console.warn("wrong listener type: "+typeof M);return}if(this._listens(y,M,V)===!1){V===this&&(V=void 0);var Ee={fn:M,ctx:V};ie&&(Ee.once=!0),this._events=this._events||{},this._events[y]=this._events[y]||[],this._events[y].push(Ee)}},_off:function(y,M,V){var ie,Ee,Ge;if(this._events&&(ie=this._events[y],!!ie)){if(arguments.length===1){if(this._firingCount)for(Ee=0,Ge=ie.length;Ee<Ge;Ee++)ie[Ee].fn=U;delete this._events[y];return}if(typeof M!="function"){console.warn("wrong listener type: "+typeof M);return}var Pt=this._listens(y,M,V);if(Pt!==!1){var on=ie[Pt];this._firingCount&&(on.fn=U,this._events[y]=ie=ie.slice()),ie.splice(Pt,1)}}},fire:function(y,M,V){if(!this.listens(y,V))return this;var ie=h({},M,{type:y,target:this,sourceTarget:M&&M.sourceTarget||this});if(this._events){var Ee=this._events[y];if(Ee){this._firingCount=this._firingCount+1||1;for(var Ge=0,Pt=Ee.length;Ge<Pt;Ge++){var on=Ee[Ge],dn=on.fn;on.once&&this.off(y,dn,on.ctx),dn.call(on.ctx||this,ie)}this._firingCount--}}return V&&this._propagateEvent(ie),this},listens:function(y,M,V,ie){typeof y!="string"&&console.warn('"string" type argument expected');var Ee=M;typeof M!="function"&&(ie=!!M,Ee=void 0,V=void 0);var Ge=this._events&&this._events[y];if(Ge&&Ge.length&&this._listens(y,Ee,V)!==!1)return!0;if(ie){for(var Pt in this._eventParents)if(this._eventParents[Pt].listens(y,M,V,ie))return!0}return!1},_listens:function(y,M,V){if(!this._events)return!1;var ie=this._events[y]||[];if(!M)return!!ie.length;V===this&&(V=void 0);for(var Ee=0,Ge=ie.length;Ee<Ge;Ee++)if(ie[Ee].fn===M&&ie[Ee].ctx===V)return Ee;return!1},once:function(y,M,V){if(typeof y=="object")for(var ie in y)this._on(ie,y[ie],M,!0);else{y=le(y);for(var Ee=0,Ge=y.length;Ee<Ge;Ee++)this._on(y[Ee],M,V,!0)}return this},addEventParent:function(y){return this._eventParents=this._eventParents||{},this._eventParents[I(y)]=y,this},removeEventParent:function(y){return this._eventParents&&delete this._eventParents[I(y)],this},_propagateEvent:function(y){for(var M in this._eventParents)this._eventParents[M].fire(y.type,h({layer:y.target,propagatedFrom:y.target},y),!0)}};Kt.addEventListener=Kt.on,Kt.removeEventListener=Kt.clearAllEventListeners=Kt.off,Kt.addOneTimeEventListener=Kt.once,Kt.fireEvent=Kt.fire,Kt.hasEventListeners=Kt.listens;var Lt=Ht.extend(Kt);function et(y,M,V){this.x=V?Math.round(y):y,this.y=V?Math.round(M):M}var vt=Math.trunc||function(y){return y>0?Math.floor(y):Math.ceil(y)};et.prototype={clone:function(){return new et(this.x,this.y)},add:function(y){return this.clone()._add(Ot(y))},_add:function(y){return this.x+=y.x,this.y+=y.y,this},subtract:function(y){return this.clone()._subtract(Ot(y))},_subtract:function(y){return this.x-=y.x,this.y-=y.y,this},divideBy:function(y){return this.clone()._divideBy(y)},_divideBy:function(y){return this.x/=y,this.y/=y,this},multiplyBy:function(y){return this.clone()._multiplyBy(y)},_multiplyBy:function(y){return this.x*=y,this.y*=y,this},scaleBy:function(y){return new et(this.x*y.x,this.y*y.y)},unscaleBy:function(y){return new et(this.x/y.x,this.y/y.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=vt(this.x),this.y=vt(this.y),this},distanceTo:function(y){y=Ot(y);var M=y.x-this.x,V=y.y-this.y;return Math.sqrt(M*M+V*V)},equals:function(y){return y=Ot(y),y.x===this.x&&y.y===this.y},contains:function(y){return y=Ot(y),Math.abs(y.x)<=Math.abs(this.x)&&Math.abs(y.y)<=Math.abs(this.y)},toString:function(){return"Point("+K(this.x)+", "+K(this.y)+")"}};function Ot(y,M,V){return y instanceof et?y:Re(y)?new et(y[0],y[1]):y==null?y:typeof y=="object"&&"x"in y&&"y"in y?new et(y.x,y.y):new et(y,M,V)}function mt(y,M){if(y)for(var V=M?[y,M]:y,ie=0,Ee=V.length;ie<Ee;ie++)this.extend(V[ie])}mt.prototype={extend:function(y){var M,V;if(!y)return this;if(y instanceof et||typeof y[0]=="number"||"x"in y)M=V=Ot(y);else if(y=zt(y),M=y.min,V=y.max,!M||!V)return this;return!this.min&&!this.max?(this.min=M.clone(),this.max=V.clone()):(this.min.x=Math.min(M.x,this.min.x),this.max.x=Math.max(V.x,this.max.x),this.min.y=Math.min(M.y,this.min.y),this.max.y=Math.max(V.y,this.max.y)),this},getCenter:function(y){return Ot((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,y)},getBottomLeft:function(){return Ot(this.min.x,this.max.y)},getTopRight:function(){return Ot(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(y){var M,V;return typeof y[0]=="number"||y instanceof et?y=Ot(y):y=zt(y),y instanceof mt?(M=y.min,V=y.max):M=V=y,M.x>=this.min.x&&V.x<=this.max.x&&M.y>=this.min.y&&V.y<=this.max.y},intersects:function(y){y=zt(y);var M=this.min,V=this.max,ie=y.min,Ee=y.max,Ge=Ee.x>=M.x&&ie.x<=V.x,Pt=Ee.y>=M.y&&ie.y<=V.y;return Ge&&Pt},overlaps:function(y){y=zt(y);var M=this.min,V=this.max,ie=y.min,Ee=y.max,Ge=Ee.x>M.x&&ie.x<V.x,Pt=Ee.y>M.y&&ie.y<V.y;return Ge&&Pt},isValid:function(){return!!(this.min&&this.max)},pad:function(y){var M=this.min,V=this.max,ie=Math.abs(M.x-V.x)*y,Ee=Math.abs(M.y-V.y)*y;return zt(Ot(M.x-ie,M.y-Ee),Ot(V.x+ie,V.y+Ee))},equals:function(y){return y?(y=zt(y),this.min.equals(y.getTopLeft())&&this.max.equals(y.getBottomRight())):!1}};function zt(y,M){return!y||y instanceof mt?y:new mt(y,M)}function Jt(y,M){if(y)for(var V=M?[y,M]:y,ie=0,Ee=V.length;ie<Ee;ie++)this.extend(V[ie])}Jt.prototype={extend:function(y){var M=this._southWest,V=this._northEast,ie,Ee;if(y instanceof $n)ie=y,Ee=y;else if(y instanceof Jt){if(ie=y._southWest,Ee=y._northEast,!ie||!Ee)return this}else return y?this.extend(Bn(y)||Un(y)):this;return!M&&!V?(this._southWest=new $n(ie.lat,ie.lng),this._northEast=new $n(Ee.lat,Ee.lng)):(M.lat=Math.min(ie.lat,M.lat),M.lng=Math.min(ie.lng,M.lng),V.lat=Math.max(Ee.lat,V.lat),V.lng=Math.max(Ee.lng,V.lng)),this},pad:function(y){var M=this._southWest,V=this._northEast,ie=Math.abs(M.lat-V.lat)*y,Ee=Math.abs(M.lng-V.lng)*y;return new Jt(new $n(M.lat-ie,M.lng-Ee),new $n(V.lat+ie,V.lng+Ee))},getCenter:function(){return new $n((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new $n(this.getNorth(),this.getWest())},getSouthEast:function(){return new $n(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(y){typeof y[0]=="number"||y instanceof $n||"lat"in y?y=Bn(y):y=Un(y);var M=this._southWest,V=this._northEast,ie,Ee;return y instanceof Jt?(ie=y.getSouthWest(),Ee=y.getNorthEast()):ie=Ee=y,ie.lat>=M.lat&&Ee.lat<=V.lat&&ie.lng>=M.lng&&Ee.lng<=V.lng},intersects:function(y){y=Un(y);var M=this._southWest,V=this._northEast,ie=y.getSouthWest(),Ee=y.getNorthEast(),Ge=Ee.lat>=M.lat&&ie.lat<=V.lat,Pt=Ee.lng>=M.lng&&ie.lng<=V.lng;return Ge&&Pt},overlaps:function(y){y=Un(y);var M=this._southWest,V=this._northEast,ie=y.getSouthWest(),Ee=y.getNorthEast(),Ge=Ee.lat>M.lat&&ie.lat<V.lat,Pt=Ee.lng>M.lng&&ie.lng<V.lng;return Ge&&Pt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(y,M){return y?(y=Un(y),this._southWest.equals(y.getSouthWest(),M)&&this._northEast.equals(y.getNorthEast(),M)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Un(y,M){return y instanceof Jt?y:new Jt(y,M)}function $n(y,M,V){if(isNaN(y)||isNaN(M))throw new Error("Invalid LatLng object: ("+y+", "+M+")");this.lat=+y,this.lng=+M,V!==void 0&&(this.alt=+V)}$n.prototype={equals:function(y,M){if(!y)return!1;y=Bn(y);var V=Math.max(Math.abs(this.lat-y.lat),Math.abs(this.lng-y.lng));return V<=(M===void 0?1e-9:M)},toString:function(y){return"LatLng("+K(this.lat,y)+", "+K(this.lng,y)+")"},distanceTo:function(y){return _r.distance(this,Bn(y))},wrap:function(){return _r.wrapLatLng(this)},toBounds:function(y){var M=180*y/40075017,V=M/Math.cos(Math.PI/180*this.lat);return Un([this.lat-M,this.lng-V],[this.lat+M,this.lng+V])},clone:function(){return new $n(this.lat,this.lng,this.alt)}};function Bn(y,M,V){return y instanceof $n?y:Re(y)&&typeof y[0]!="object"?y.length===3?new $n(y[0],y[1],y[2]):y.length===2?new $n(y[0],y[1]):null:y==null?y:typeof y=="object"&&"lat"in y?new $n(y.lat,"lng"in y?y.lng:y.lon,y.alt):M===void 0?null:new $n(y,M,V)}var $r={latLngToPoint:function(y,M){var V=this.projection.project(y),ie=this.scale(M);return this.transformation._transform(V,ie)},pointToLatLng:function(y,M){var V=this.scale(M),ie=this.transformation.untransform(y,V);return this.projection.unproject(ie)},project:function(y){return this.projection.project(y)},unproject:function(y){return this.projection.unproject(y)},scale:function(y){return 256*Math.pow(2,y)},zoom:function(y){return Math.log(y/256)/Math.LN2},getProjectedBounds:function(y){if(this.infinite)return null;var M=this.projection.bounds,V=this.scale(y),ie=this.transformation.transform(M.min,V),Ee=this.transformation.transform(M.max,V);return new mt(ie,Ee)},infinite:!1,wrapLatLng:function(y){var M=this.wrapLng?$(y.lng,this.wrapLng,!0):y.lng,V=this.wrapLat?$(y.lat,this.wrapLat,!0):y.lat,ie=y.alt;return new $n(V,M,ie)},wrapLatLngBounds:function(y){var M=y.getCenter(),V=this.wrapLatLng(M),ie=M.lat-V.lat,Ee=M.lng-V.lng;if(ie===0&&Ee===0)return y;var Ge=y.getSouthWest(),Pt=y.getNorthEast(),on=new $n(Ge.lat-ie,Ge.lng-Ee),dn=new $n(Pt.lat-ie,Pt.lng-Ee);return new Jt(on,dn)}},_r=h({},$r,{wrapLng:[-180,180],R:6371e3,distance:function(y,M){var V=Math.PI/180,ie=y.lat*V,Ee=M.lat*V,Ge=Math.sin((M.lat-y.lat)*V/2),Pt=Math.sin((M.lng-y.lng)*V/2),on=Ge*Ge+Math.cos(ie)*Math.cos(Ee)*Pt*Pt,dn=2*Math.atan2(Math.sqrt(on),Math.sqrt(1-on));return this.R*dn}}),Pn=6378137,Ke={R:Pn,MAX_LATITUDE:85.0511287798,project:function(y){var M=Math.PI/180,V=this.MAX_LATITUDE,ie=Math.max(Math.min(V,y.lat),-V),Ee=Math.sin(ie*M);return new et(this.R*y.lng*M,this.R*Math.log((1+Ee)/(1-Ee))/2)},unproject:function(y){var M=180/Math.PI;return new $n((2*Math.atan(Math.exp(y.y/this.R))-Math.PI/2)*M,y.x*M/this.R)},bounds:function(){var y=Pn*Math.PI;return new mt([-y,-y],[y,y])}()};function mr(y,M,V,ie){if(Re(y)){this._a=y[0],this._b=y[1],this._c=y[2],this._d=y[3];return}this._a=y,this._b=M,this._c=V,this._d=ie}mr.prototype={transform:function(y,M){return this._transform(y.clone(),M)},_transform:function(y,M){return M=M||1,y.x=M*(this._a*y.x+this._b),y.y=M*(this._c*y.y+this._d),y},untransform:function(y,M){return M=M||1,new et((y.x/M-this._b)/this._a,(y.y/M-this._d)/this._c)}};function Sn(y,M,V,ie){return new mr(y,M,V,ie)}var Dr=h({},_r,{code:"EPSG:3857",projection:Ke,transformation:function(){var y=.5/(Math.PI*Ke.R);return Sn(y,.5,-y,.5)}()}),Yt=h({},Dr,{code:"EPSG:900913"});function Mr(y){return document.createElementNS("http://www.w3.org/2000/svg",y)}function Qn(y,M){var V="",ie,Ee,Ge,Pt,on,dn;for(ie=0,Ge=y.length;ie<Ge;ie++){for(on=y[ie],Ee=0,Pt=on.length;Ee<Pt;Ee++)dn=on[Ee],V+=(Ee?"L":"M")+dn.x+" "+dn.y;V+=M?Ae.svg?"z":"x":""}return V||"M0 0"}var Ar=document.documentElement.style,sr="ActiveXObject"in window,_i=sr&&!document.addEventListener,Wi="msLaunchUri"in navigator&&!("documentMode"in document),ii=Ie("webkit"),Pi=Ie("android"),yi=Ie("android 2")||Ie("android 3"),lr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),qo=Pi&&Ie("Google")&&lr<537&&!("AudioNode"in window),ea=!!window.opera,la=!Wi&&Ie("chrome"),Fi=Ie("gecko")&&!ii&&!ea&&!sr,Mo=!la&&Ie("safari"),ta=Ie("phantom"),va="OTransition"in Ar,za=navigator.platform.indexOf("Win")===0,so=sr&&"transition"in Ar,Lo="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!yi,es="MozPerspective"in Ar,Go=!window.L_DISABLE_3D&&(so||Lo||es)&&!va&&!ta,Fa=typeof orientation<"u"||Ie("mobile"),Er=Fa&&ii,go=Fa&&Lo,Ia=!window.PointerEvent&&window.MSPointerEvent,Di=!!(window.PointerEvent||Ia),vi="ontouchstart"in window||!!window.TouchEvent,bi=!window.L_NO_TOUCH&&(vi||Di),Mi=Fa&&ea,Fo=Fa&&Fi,na=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,kt=function(){var y=!1;try{var M=Object.defineProperty({},"passive",{get:function(){y=!0}});window.addEventListener("testPassiveEventSupport",U,M),window.removeEventListener("testPassiveEventSupport",U,M)}catch{}return y}(),Se=function(){return!!document.createElement("canvas").getContext}(),Z=!!(document.createElementNS&&Mr("svg").createSVGRect),re=!!Z&&function(){var y=document.createElement("div");return y.innerHTML="<svg/>",(y.firstChild&&y.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ce=!Z&&function(){try{var y=document.createElement("div");y.innerHTML='<v:shape adj="1"/>';var M=y.firstChild;return M.style.behavior="url(#default#VML)",M&&typeof M.adj=="object"}catch{return!1}}(),de=navigator.platform.indexOf("Mac")===0,xe=navigator.platform.indexOf("Linux")===0;function Ie(y){return navigator.userAgent.toLowerCase().indexOf(y)>=0}var Ae={ie:sr,ielt9:_i,edge:Wi,webkit:ii,android:Pi,android23:yi,androidStock:qo,opera:ea,chrome:la,gecko:Fi,safari:Mo,phantom:ta,opera12:va,win:za,ie3d:so,webkit3d:Lo,gecko3d:es,any3d:Go,mobile:Fa,mobileWebkit:Er,mobileWebkit3d:go,msPointer:Ia,pointer:Di,touch:bi,touchNative:vi,mobileOpera:Mi,mobileGecko:Fo,retina:na,passiveEvents:kt,canvas:Se,svg:Z,vml:ce,inlineSvg:re,mac:de,linux:xe},Be=Ae.msPointer?"MSPointerDown":"pointerdown",tt=Ae.msPointer?"MSPointerMove":"pointermove",ut=Ae.msPointer?"MSPointerUp":"pointerup",Tt=Ae.msPointer?"MSPointerCancel":"pointercancel",Wt={touchstart:Be,touchmove:tt,touchend:ut,touchcancel:Tt},Vt={touchstart:nr,touchmove:ri,touchend:ri,touchcancel:ri},Gt={},gn=!1;function Tn(y,M,V){return M==="touchstart"&&Zr(),Vt[M]?(V=Vt[M].bind(this,V),y.addEventListener(Wt[M],V,!1),V):(console.warn("wrong event specified:",M),U)}function In(y,M,V){if(!Wt[M]){console.warn("wrong event specified:",M);return}y.removeEventListener(Wt[M],V,!1)}function Ln(y){Gt[y.pointerId]=y}function dr(y){Gt[y.pointerId]&&(Gt[y.pointerId]=y)}function Zn(y){delete Gt[y.pointerId]}function Zr(){gn||(document.addEventListener(Be,Ln,!0),document.addEventListener(tt,dr,!0),document.addEventListener(ut,Zn,!0),document.addEventListener(Tt,Zn,!0),gn=!0)}function ri(y,M){if(M.pointerType!==(M.MSPOINTER_TYPE_MOUSE||"mouse")){M.touches=[];for(var V in Gt)M.touches.push(Gt[V]);M.changedTouches=[M],y(M)}}function nr(y,M){M.MSPOINTER_TYPE_TOUCH&&M.pointerType===M.MSPOINTER_TYPE_TOUCH&&co(M),ri(y,M)}function hn(y){var M={},V,ie;for(ie in y)V=y[ie],M[ie]=V&&V.bind?V.bind(y):V;return y=M,M.type="dblclick",M.detail=2,M.isTrusted=!1,M._simulated=!0,M}var Kn=200;function br(y,M){y.addEventListener("dblclick",M);var V=0,ie;function Ee(Ge){if(Ge.detail!==1){ie=Ge.detail;return}if(!(Ge.pointerType==="mouse"||Ge.sourceCapabilities&&!Ge.sourceCapabilities.firesTouchEvents)){var Pt=Na(Ge);if(!(Pt.some(function(dn){return dn instanceof HTMLLabelElement&&dn.attributes.for})&&!Pt.some(function(dn){return dn instanceof HTMLInputElement||dn instanceof HTMLSelectElement}))){var on=Date.now();on-V<=Kn?(ie++,ie===2&&M(hn(Ge))):ie=1,V=on}}}return y.addEventListener("click",Ee),{dblclick:M,simDblclick:Ee}}function oi(y,M){y.removeEventListener("dblclick",M.dblclick),y.removeEventListener("click",M.simDblclick)}var Ir=nn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Kr=nn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),qr=Kr==="webkitTransition"||Kr==="OTransition"?Kr+"End":"transitionend";function ci(y){return typeof y=="string"?document.getElementById(y):y}function Zi(y,M){var V=y.style[M]||y.currentStyle&&y.currentStyle[M];if((!V||V==="auto")&&document.defaultView){var ie=document.defaultView.getComputedStyle(y,null);V=ie?ie[M]:null}return V==="auto"?null:V}function Xn(y,M,V){var ie=document.createElement(y);return ie.className=M||"",V&&V.appendChild(ie),ie}function Gr(y){var M=y.parentNode;M&&M.removeChild(y)}function xa(y){for(;y.firstChild;)y.removeChild(y.firstChild)}function lo(y){var M=y.parentNode;M&&M.lastChild!==y&&M.appendChild(y)}function uo(y){var M=y.parentNode;M&&M.firstChild!==y&&M.insertBefore(y,M.firstChild)}function wo(y,M){if(y.classList!==void 0)return y.classList.contains(M);var V=Oe(y);return V.length>0&&new RegExp("(^|\\s)"+M+"(\\s|$)").test(V)}function yr(y,M){if(y.classList!==void 0)for(var V=le(M),ie=0,Ee=V.length;ie<Ee;ie++)y.classList.add(V[ie]);else if(!wo(y,M)){var Ge=Oe(y);fe(y,(Ge?Ge+" ":"")+M)}}function wi(y,M){y.classList!==void 0?y.classList.remove(M):fe(y,te((" "+Oe(y)+" ").replace(" "+M+" "," ")))}function fe(y,M){y.className.baseVal===void 0?y.className=M:y.className.baseVal=M}function Oe(y){return y.correspondingElement&&(y=y.correspondingElement),y.className.baseVal===void 0?y.className:y.className.baseVal}function We(y,M){"opacity"in y.style?y.style.opacity=M:"filter"in y.style&&dt(y,M)}function dt(y,M){var V=!1,ie="DXImageTransform.Microsoft.Alpha";try{V=y.filters.item(ie)}catch{if(M===1)return}M=Math.round(M*100),V?(V.Enabled=M!==100,V.Opacity=M):y.style.filter+=" progid:"+ie+"(opacity="+M+")"}function nn(y){for(var M=document.documentElement.style,V=0;V<y.length;V++)if(y[V]in M)return y[V];return!1}function Zt(y,M,V){var ie=M||new et(0,0);y.style[Ir]=(Ae.ie3d?"translate("+ie.x+"px,"+ie.y+"px)":"translate3d("+ie.x+"px,"+ie.y+"px,0)")+(V?" scale("+V+")":"")}function fn(y,M){y._leaflet_pos=M,Ae.any3d?Zt(y,M):(y.style.left=M.x+"px",y.style.top=M.y+"px")}function Cn(y){return y._leaflet_pos||new et(0,0)}var Gn,Cr,Ur;if("onselectstart"in document)Gn=function(){Hr(window,"selectstart",co)},Cr=function(){no(window,"selectstart",co)};else{var Ri=nn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Gn=function(){if(Ri){var y=document.documentElement.style;Ur=y[Ri],y[Ri]="none"}},Cr=function(){Ri&&(document.documentElement.style[Ri]=Ur,Ur=void 0)}}function So(){Hr(window,"dragstart",co)}function To(){no(window,"dragstart",co)}var wr,Ba;function Pr(y){for(;y.tabIndex===-1;)y=y.parentNode;y.style&&(Ho(),wr=y,Ba=y.style.outlineStyle,y.style.outlineStyle="none",Hr(window,"keydown",Ho))}function Ho(){wr&&(wr.style.outlineStyle=Ba,wr=void 0,Ba=void 0,no(window,"keydown",Ho))}function Yn(y){do y=y.parentNode;while((!y.offsetWidth||!y.offsetHeight)&&y!==document.body);return y}function Wo(y){var M=y.getBoundingClientRect();return{x:M.width/y.offsetWidth||1,y:M.height/y.offsetHeight||1,boundingClientRect:M}}var ba={__proto__:null,TRANSFORM:Ir,TRANSITION:Kr,TRANSITION_END:qr,get:ci,getStyle:Zi,create:Xn,remove:Gr,empty:xa,toFront:lo,toBack:uo,hasClass:wo,addClass:yr,removeClass:wi,setClass:fe,getClass:Oe,setOpacity:We,testProp:nn,setTransform:Zt,setPosition:fn,getPosition:Cn,get disableTextSelection(){return Gn},get enableTextSelection(){return Cr},disableImageDrag:So,enableImageDrag:To,preventOutline:Pr,restoreOutline:Ho,getSizedParentNode:Yn,getScale:Wo};function Hr(y,M,V,ie){if(M&&typeof M=="object")for(var Ee in M)ai(y,Ee,M[Ee],V);else{M=le(M);for(var Ge=0,Pt=M.length;Ge<Pt;Ge++)ai(y,M[Ge],V,ie)}return this}var fo="_leaflet_events";function no(y,M,V,ie){if(arguments.length===1)ss(y),delete y[fo];else if(M&&typeof M=="object")for(var Ee in M)Br(y,Ee,M[Ee],V);else if(M=le(M),arguments.length===2)ss(y,function(on){return De(M,on)!==-1});else for(var Ge=0,Pt=M.length;Ge<Pt;Ge++)Br(y,M[Ge],V,ie);return this}function ss(y,M){for(var V in y[fo]){var ie=V.split(/\d/)[0];(!M||M(ie))&&Br(y,ie,null,null,V)}}var Dn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ai(y,M,V,ie){var Ee=M+I(V)+(ie?"_"+I(ie):"");if(y[fo]&&y[fo][Ee])return this;var Ge=function(on){return V.call(ie||y,on||window.event)},Pt=Ge;!Ae.touchNative&&Ae.pointer&&M.indexOf("touch")===0?Ge=Tn(y,M,Ge):Ae.touch&&M==="dblclick"?Ge=br(y,Ge):"addEventListener"in y?M==="touchstart"||M==="touchmove"||M==="wheel"||M==="mousewheel"?y.addEventListener(Dn[M]||M,Ge,Ae.passiveEvents?{passive:!1}:!1):M==="mouseenter"||M==="mouseleave"?(Ge=function(on){on=on||window.event,ks(y,on)&&Pt(on)},y.addEventListener(Dn[M],Ge,!1)):y.addEventListener(M,Pt,!1):y.attachEvent("on"+M,Ge),y[fo]=y[fo]||{},y[fo][Ee]=Ge}function Br(y,M,V,ie,Ee){Ee=Ee||M+I(V)+(ie?"_"+I(ie):"");var Ge=y[fo]&&y[fo][Ee];if(!Ge)return this;!Ae.touchNative&&Ae.pointer&&M.indexOf("touch")===0?In(y,M,Ge):Ae.touch&&M==="dblclick"?oi(y,Ge):"removeEventListener"in y?y.removeEventListener(Dn[M]||M,Ge,!1):y.detachEvent("on"+M,Ge),y[fo][Ee]=null}function Eo(y){return y.stopPropagation?y.stopPropagation():y.originalEvent?y.originalEvent._stopped=!0:y.cancelBubble=!0,this}function Bo(y){return ai(y,"wheel",Eo),this}function cr(y){return Hr(y,"mousedown touchstart dblclick contextmenu",Eo),y._leaflet_disable_click=!0,this}function co(y){return y.preventDefault?y.preventDefault():y.returnValue=!1,this}function ua(y){return co(y),Eo(y),this}function Na(y){if(y.composedPath)return y.composedPath();for(var M=[],V=y.target;V;)M.push(V),V=V.parentNode;return M}function _o(y,M){if(!M)return new et(y.clientX,y.clientY);var V=Wo(M),ie=V.boundingClientRect;return new et((y.clientX-ie.left)/V.x-M.clientLeft,(y.clientY-ie.top)/V.y-M.clientTop)}var ho=Ae.linux&&Ae.chrome?window.devicePixelRatio:Ae.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function hl(y){return Ae.edge?y.wheelDeltaY/2:y.deltaY&&y.deltaMode===0?-y.deltaY/ho:y.deltaY&&y.deltaMode===1?-y.deltaY*20:y.deltaY&&y.deltaMode===2?-y.deltaY*60:y.deltaX||y.deltaZ?0:y.wheelDelta?(y.wheelDeltaY||y.wheelDelta)/2:y.detail&&Math.abs(y.detail)<32765?-y.detail*20:y.detail?y.detail/-32765*60:0}function ks(y,M){var V=M.relatedTarget;if(!V)return!0;try{for(;V&&V!==y;)V=V.parentNode}catch{return!1}return V!==y}var Rs={__proto__:null,on:Hr,off:no,stopPropagation:Eo,disableScrollPropagation:Bo,disableClickPropagation:cr,preventDefault:co,stop:ua,getPropagationPath:Na,getMousePosition:_o,getWheelDelta:hl,isExternalTarget:ks,addListener:Hr,removeListener:no},Za=Lt.extend({run:function(y,M,V,ie){this.stop(),this._el=y,this._inProgress=!0,this._duration=V||.25,this._easeOutPower=1/Math.max(ie||.5,.2),this._startPos=Cn(y),this._offset=M.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Je(this._animate,this),this._step()},_step:function(y){var M=+new Date-this._startTime,V=this._duration*1e3;M<V?this._runFrame(this._easeOut(M/V),y):(this._runFrame(1),this._complete())},_runFrame:function(y,M){var V=this._startPos.add(this._offset.multiplyBy(y));M&&V._round(),fn(this._el,V),this.fire("step")},_complete:function(){St(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(y){return 1-Math.pow(1-y,this._easeOutPower)}}),Oi=Lt.extend({options:{crs:Dr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(y,M){M=se(this,M),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(y),this._initLayout(),this._onResize=S(this._onResize,this),this._initEvents(),M.maxBounds&&this.setMaxBounds(M.maxBounds),M.zoom!==void 0&&(this._zoom=this._limitZoom(M.zoom)),M.center&&M.zoom!==void 0&&this.setView(Bn(M.center),M.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Kr&&Ae.any3d&&!Ae.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Hr(this._proxy,qr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(y,M,V){if(M=M===void 0?this._zoom:this._limitZoom(M),y=this._limitCenter(Bn(y),M,this.options.maxBounds),V=V||{},this._stop(),this._loaded&&!V.reset&&V!==!0){V.animate!==void 0&&(V.zoom=h({animate:V.animate},V.zoom),V.pan=h({animate:V.animate,duration:V.duration},V.pan));var ie=this._zoom!==M?this._tryAnimatedZoom&&this._tryAnimatedZoom(y,M,V.zoom):this._tryAnimatedPan(y,V.pan);if(ie)return clearTimeout(this._sizeTimer),this}return this._resetView(y,M,V.pan&&V.pan.noMoveStart),this},setZoom:function(y,M){return this._loaded?this.setView(this.getCenter(),y,{zoom:M}):(this._zoom=y,this)},zoomIn:function(y,M){return y=y||(Ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+y,M)},zoomOut:function(y,M){return y=y||(Ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-y,M)},setZoomAround:function(y,M,V){var ie=this.getZoomScale(M),Ee=this.getSize().divideBy(2),Ge=y instanceof et?y:this.latLngToContainerPoint(y),Pt=Ge.subtract(Ee).multiplyBy(1-1/ie),on=this.containerPointToLatLng(Ee.add(Pt));return this.setView(on,M,{zoom:V})},_getBoundsCenterZoom:function(y,M){M=M||{},y=y.getBounds?y.getBounds():Un(y);var V=Ot(M.paddingTopLeft||M.padding||[0,0]),ie=Ot(M.paddingBottomRight||M.padding||[0,0]),Ee=this.getBoundsZoom(y,!1,V.add(ie));if(Ee=typeof M.maxZoom=="number"?Math.min(M.maxZoom,Ee):Ee,Ee===1/0)return{center:y.getCenter(),zoom:Ee};var Ge=ie.subtract(V).divideBy(2),Pt=this.project(y.getSouthWest(),Ee),on=this.project(y.getNorthEast(),Ee),dn=this.unproject(Pt.add(on).divideBy(2).add(Ge),Ee);return{center:dn,zoom:Ee}},fitBounds:function(y,M){if(y=Un(y),!y.isValid())throw new Error("Bounds are not valid.");var V=this._getBoundsCenterZoom(y,M);return this.setView(V.center,V.zoom,M)},fitWorld:function(y){return this.fitBounds([[-90,-180],[90,180]],y)},panTo:function(y,M){return this.setView(y,this._zoom,{pan:M})},panBy:function(y,M){if(y=Ot(y).round(),M=M||{},!y.x&&!y.y)return this.fire("moveend");if(M.animate!==!0&&!this.getSize().contains(y))return this._resetView(this.unproject(this.project(this.getCenter()).add(y)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Za,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),M.noMoveStart||this.fire("movestart"),M.animate!==!1){yr(this._mapPane,"leaflet-pan-anim");var V=this._getMapPanePos().subtract(y).round();this._panAnim.run(this._mapPane,V,M.duration||.25,M.easeLinearity)}else this._rawPanBy(y),this.fire("move").fire("moveend");return this},flyTo:function(y,M,V){if(V=V||{},V.animate===!1||!Ae.any3d)return this.setView(y,M,V);this._stop();var ie=this.project(this.getCenter()),Ee=this.project(y),Ge=this.getSize(),Pt=this._zoom;y=Bn(y),M=M===void 0?Pt:M;var on=Math.max(Ge.x,Ge.y),dn=on*this.getZoomScale(Pt,M),Rn=Ee.distanceTo(ie)||1,hr=1.42,Jr=hr*hr;function Ii(Xi){var Gu=Xi?-1:1,yf=Xi?dn:on,vf=dn*dn-on*on+Gu*Jr*Jr*Rn*Rn,Xl=2*yf*Jr*Rn,Bs=vf/Xl,pu=Math.sqrt(Bs*Bs+1)-Bs,tl=pu<1e-9?-18:Math.log(pu);return tl}function ja(Xi){return(Math.exp(Xi)-Math.exp(-Xi))/2}function Ko(Xi){return(Math.exp(Xi)+Math.exp(-Xi))/2}function Fs(Xi){return ja(Xi)/Ko(Xi)}var fs=Ii(0);function qu(Xi){return on*(Ko(fs)/Ko(fs+hr*Xi))}function du(Xi){return on*(Ko(fs)*Fs(fs+hr*Xi)-ja(fs))/Jr}function Hl(Xi){return 1-Math.pow(1-Xi,1.5)}var _f=Date.now(),Wl=(Ii(1)-fs)/hr,Ts=V.duration?1e3*V.duration:1e3*Wl*.8;function Zl(){var Xi=(Date.now()-_f)/Ts,Gu=Hl(Xi)*Wl;Xi<=1?(this._flyToFrame=Je(Zl,this),this._move(this.unproject(ie.add(Ee.subtract(ie).multiplyBy(du(Gu)/Rn)),Pt),this.getScaleZoom(on/qu(Gu),Pt),{flyTo:!0})):this._move(y,M)._moveEnd(!0)}return this._moveStart(!0,V.noMoveStart),Zl.call(this),this},flyToBounds:function(y,M){var V=this._getBoundsCenterZoom(y,M);return this.flyTo(V.center,V.zoom,M)},setMaxBounds:function(y){return y=Un(y),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),y.isValid()?(this.options.maxBounds=y,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(y){var M=this.options.minZoom;return this.options.minZoom=y,this._loaded&&M!==y&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(y):this},setMaxZoom:function(y){var M=this.options.maxZoom;return this.options.maxZoom=y,this._loaded&&M!==y&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(y):this},panInsideBounds:function(y,M){this._enforcingBounds=!0;var V=this.getCenter(),ie=this._limitCenter(V,this._zoom,Un(y));return V.equals(ie)||this.panTo(ie,M),this._enforcingBounds=!1,this},panInside:function(y,M){M=M||{};var V=Ot(M.paddingTopLeft||M.padding||[0,0]),ie=Ot(M.paddingBottomRight||M.padding||[0,0]),Ee=this.project(this.getCenter()),Ge=this.project(y),Pt=this.getPixelBounds(),on=zt([Pt.min.add(V),Pt.max.subtract(ie)]),dn=on.getSize();if(!on.contains(Ge)){this._enforcingBounds=!0;var Rn=Ge.subtract(on.getCenter()),hr=on.extend(Ge).getSize().subtract(dn);Ee.x+=Rn.x<0?-hr.x:hr.x,Ee.y+=Rn.y<0?-hr.y:hr.y,this.panTo(this.unproject(Ee),M),this._enforcingBounds=!1}return this},invalidateSize:function(y){if(!this._loaded)return this;y=h({animate:!1,pan:!0},y===!0?{animate:!0}:y);var M=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var V=this.getSize(),ie=M.divideBy(2).round(),Ee=V.divideBy(2).round(),Ge=ie.subtract(Ee);return!Ge.x&&!Ge.y?this:(y.animate&&y.pan?this.panBy(Ge):(y.pan&&this._rawPanBy(Ge),this.fire("move"),y.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(S(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:M,newSize:V}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(y){if(y=this._locateOptions=h({timeout:1e4,watch:!1},y),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var M=S(this._handleGeolocationResponse,this),V=S(this._handleGeolocationError,this);return y.watch?this._locationWatchId=navigator.geolocation.watchPosition(M,V,y):navigator.geolocation.getCurrentPosition(M,V,y),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(y){if(this._container._leaflet_id){var M=y.code,V=y.message||(M===1?"permission denied":M===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:M,message:"Geolocation error: "+V+"."})}},_handleGeolocationResponse:function(y){if(this._container._leaflet_id){var M=y.coords.latitude,V=y.coords.longitude,ie=new $n(M,V),Ee=ie.toBounds(y.coords.accuracy*2),Ge=this._locateOptions;if(Ge.setView){var Pt=this.getBoundsZoom(Ee);this.setView(ie,Ge.maxZoom?Math.min(Pt,Ge.maxZoom):Pt)}var on={latlng:ie,bounds:Ee,timestamp:y.timestamp};for(var dn in y.coords)typeof y.coords[dn]=="number"&&(on[dn]=y.coords[dn]);this.fire("locationfound",on)}},addHandler:function(y,M){if(!M)return this;var V=this[y]=new M(this);return this._handlers.push(V),this.options[y]&&V.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Gr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(St(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var y;for(y in this._layers)this._layers[y].remove();for(y in this._panes)Gr(this._panes[y]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(y,M){var V="leaflet-pane"+(y?" leaflet-"+y.replace("Pane","")+"-pane":""),ie=Xn("div",V,M||this._mapPane);return y&&(this._panes[y]=ie),ie},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var y=this.getPixelBounds(),M=this.unproject(y.getBottomLeft()),V=this.unproject(y.getTopRight());return new Jt(M,V)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(y,M,V){y=Un(y),V=Ot(V||[0,0]);var ie=this.getZoom()||0,Ee=this.getMinZoom(),Ge=this.getMaxZoom(),Pt=y.getNorthWest(),on=y.getSouthEast(),dn=this.getSize().subtract(V),Rn=zt(this.project(on,ie),this.project(Pt,ie)).getSize(),hr=Ae.any3d?this.options.zoomSnap:1,Jr=dn.x/Rn.x,Ii=dn.y/Rn.y,ja=M?Math.max(Jr,Ii):Math.min(Jr,Ii);return ie=this.getScaleZoom(ja,ie),hr&&(ie=Math.round(ie/(hr/100))*(hr/100),ie=M?Math.ceil(ie/hr)*hr:Math.floor(ie/hr)*hr),Math.max(Ee,Math.min(Ge,ie))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new et(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(y,M){var V=this._getTopLeftPoint(y,M);return new mt(V,V.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(y){return this.options.crs.getProjectedBounds(y===void 0?this.getZoom():y)},getPane:function(y){return typeof y=="string"?this._panes[y]:y},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(y,M){var V=this.options.crs;return M=M===void 0?this._zoom:M,V.scale(y)/V.scale(M)},getScaleZoom:function(y,M){var V=this.options.crs;M=M===void 0?this._zoom:M;var ie=V.zoom(y*V.scale(M));return isNaN(ie)?1/0:ie},project:function(y,M){return M=M===void 0?this._zoom:M,this.options.crs.latLngToPoint(Bn(y),M)},unproject:function(y,M){return M=M===void 0?this._zoom:M,this.options.crs.pointToLatLng(Ot(y),M)},layerPointToLatLng:function(y){var M=Ot(y).add(this.getPixelOrigin());return this.unproject(M)},latLngToLayerPoint:function(y){var M=this.project(Bn(y))._round();return M._subtract(this.getPixelOrigin())},wrapLatLng:function(y){return this.options.crs.wrapLatLng(Bn(y))},wrapLatLngBounds:function(y){return this.options.crs.wrapLatLngBounds(Un(y))},distance:function(y,M){return this.options.crs.distance(Bn(y),Bn(M))},containerPointToLayerPoint:function(y){return Ot(y).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(y){return Ot(y).add(this._getMapPanePos())},containerPointToLatLng:function(y){var M=this.containerPointToLayerPoint(Ot(y));return this.layerPointToLatLng(M)},latLngToContainerPoint:function(y){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Bn(y)))},mouseEventToContainerPoint:function(y){return _o(y,this._container)},mouseEventToLayerPoint:function(y){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(y))},mouseEventToLatLng:function(y){return this.layerPointToLatLng(this.mouseEventToLayerPoint(y))},_initContainer:function(y){var M=this._container=ci(y);if(M){if(M._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Hr(M,"scroll",this._onScroll,this),this._containerId=I(M)},_initLayout:function(){var y=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ae.any3d,yr(y,"leaflet-container"+(Ae.touch?" leaflet-touch":"")+(Ae.retina?" leaflet-retina":"")+(Ae.ielt9?" leaflet-oldie":"")+(Ae.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var M=Zi(y,"position");M!=="absolute"&&M!=="relative"&&M!=="fixed"&&M!=="sticky"&&(y.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var y=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),fn(this._mapPane,new et(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yr(y.markerPane,"leaflet-zoom-hide"),yr(y.shadowPane,"leaflet-zoom-hide"))},_resetView:function(y,M,V){fn(this._mapPane,new et(0,0));var ie=!this._loaded;this._loaded=!0,M=this._limitZoom(M),this.fire("viewprereset");var Ee=this._zoom!==M;this._moveStart(Ee,V)._move(y,M)._moveEnd(Ee),this.fire("viewreset"),ie&&this.fire("load")},_moveStart:function(y,M){return y&&this.fire("zoomstart"),M||this.fire("movestart"),this},_move:function(y,M,V,ie){M===void 0&&(M=this._zoom);var Ee=this._zoom!==M;return this._zoom=M,this._lastCenter=y,this._pixelOrigin=this._getNewPixelOrigin(y),ie?V&&V.pinch&&this.fire("zoom",V):((Ee||V&&V.pinch)&&this.fire("zoom",V),this.fire("move",V)),this},_moveEnd:function(y){return y&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return St(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(y){fn(this._mapPane,this._getMapPanePos().subtract(y))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(y){this._targets={},this._targets[I(this._container)]=this;var M=y?no:Hr;M(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&M(window,"resize",this._onResize,this),Ae.any3d&&this.options.transform3DLimit&&(y?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){St(this._resizeRequest),this._resizeRequest=Je(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var y=this._getMapPanePos();Math.max(Math.abs(y.x),Math.abs(y.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(y,M){for(var V=[],ie,Ee=M==="mouseout"||M==="mouseover",Ge=y.target||y.srcElement,Pt=!1;Ge;){if(ie=this._targets[I(Ge)],ie&&(M==="click"||M==="preclick")&&this._draggableMoved(ie)){Pt=!0;break}if(ie&&ie.listens(M,!0)&&(Ee&&!ks(Ge,y)||(V.push(ie),Ee))||Ge===this._container)break;Ge=Ge.parentNode}return!V.length&&!Pt&&!Ee&&this.listens(M,!0)&&(V=[this]),V},_isClickDisabled:function(y){for(;y&&y!==this._container;){if(y._leaflet_disable_click)return!0;y=y.parentNode}},_handleDOMEvent:function(y){var M=y.target||y.srcElement;if(!(!this._loaded||M._leaflet_disable_events||y.type==="click"&&this._isClickDisabled(M))){var V=y.type;V==="mousedown"&&Pr(M),this._fireDOMEvent(y,V)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(y,M,V){if(y.type==="click"){var ie=h({},y);ie.type="preclick",this._fireDOMEvent(ie,ie.type,V)}var Ee=this._findEventTargets(y,M);if(V){for(var Ge=[],Pt=0;Pt<V.length;Pt++)V[Pt].listens(M,!0)&&Ge.push(V[Pt]);Ee=Ge.concat(Ee)}if(Ee.length){M==="contextmenu"&&co(y);var on=Ee[0],dn={originalEvent:y};if(y.type!=="keypress"&&y.type!=="keydown"&&y.type!=="keyup"){var Rn=on.getLatLng&&(!on._radius||on._radius<=10);dn.containerPoint=Rn?this.latLngToContainerPoint(on.getLatLng()):this.mouseEventToContainerPoint(y),dn.layerPoint=this.containerPointToLayerPoint(dn.containerPoint),dn.latlng=Rn?on.getLatLng():this.layerPointToLatLng(dn.layerPoint)}for(Pt=0;Pt<Ee.length;Pt++)if(Ee[Pt].fire(M,dn,!0),dn.originalEvent._stopped||Ee[Pt].options.bubblingMouseEvents===!1&&De(this._mouseEvents,M)!==-1)return}},_draggableMoved:function(y){return y=y.dragging&&y.dragging.enabled()?y:this,y.dragging&&y.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var y=0,M=this._handlers.length;y<M;y++)this._handlers[y].disable()},whenReady:function(y,M){return this._loaded?y.call(M||this,{target:this}):this.on("load",y,M),this},_getMapPanePos:function(){return Cn(this._mapPane)||new et(0,0)},_moved:function(){var y=this._getMapPanePos();return y&&!y.equals([0,0])},_getTopLeftPoint:function(y,M){var V=y&&M!==void 0?this._getNewPixelOrigin(y,M):this.getPixelOrigin();return V.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(y,M){var V=this.getSize()._divideBy(2);return this.project(y,M)._subtract(V)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(y,M,V){var ie=this._getNewPixelOrigin(V,M);return this.project(y,M)._subtract(ie)},_latLngBoundsToNewLayerBounds:function(y,M,V){var ie=this._getNewPixelOrigin(V,M);return zt([this.project(y.getSouthWest(),M)._subtract(ie),this.project(y.getNorthWest(),M)._subtract(ie),this.project(y.getSouthEast(),M)._subtract(ie),this.project(y.getNorthEast(),M)._subtract(ie)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(y){return this.latLngToLayerPoint(y).subtract(this._getCenterLayerPoint())},_limitCenter:function(y,M,V){if(!V)return y;var ie=this.project(y,M),Ee=this.getSize().divideBy(2),Ge=new mt(ie.subtract(Ee),ie.add(Ee)),Pt=this._getBoundsOffset(Ge,V,M);return Math.abs(Pt.x)<=1&&Math.abs(Pt.y)<=1?y:this.unproject(ie.add(Pt),M)},_limitOffset:function(y,M){if(!M)return y;var V=this.getPixelBounds(),ie=new mt(V.min.add(y),V.max.add(y));return y.add(this._getBoundsOffset(ie,M))},_getBoundsOffset:function(y,M,V){var ie=zt(this.project(M.getNorthEast(),V),this.project(M.getSouthWest(),V)),Ee=ie.min.subtract(y.min),Ge=ie.max.subtract(y.max),Pt=this._rebound(Ee.x,-Ge.x),on=this._rebound(Ee.y,-Ge.y);return new et(Pt,on)},_rebound:function(y,M){return y+M>0?Math.round(y-M)/2:Math.max(0,Math.ceil(y))-Math.max(0,Math.floor(M))},_limitZoom:function(y){var M=this.getMinZoom(),V=this.getMaxZoom(),ie=Ae.any3d?this.options.zoomSnap:1;return ie&&(y=Math.round(y/ie)*ie),Math.max(M,Math.min(V,y))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){wi(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(y,M){var V=this._getCenterOffset(y)._trunc();return(M&&M.animate)!==!0&&!this.getSize().contains(V)?!1:(this.panBy(V,M),!0)},_createAnimProxy:function(){var y=this._proxy=Xn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(y),this.on("zoomanim",function(M){var V=Ir,ie=this._proxy.style[V];Zt(this._proxy,this.project(M.center,M.zoom),this.getZoomScale(M.zoom,1)),ie===this._proxy.style[V]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Gr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var y=this.getCenter(),M=this.getZoom();Zt(this._proxy,this.project(y,M),this.getZoomScale(M,1))},_catchTransitionEnd:function(y){this._animatingZoom&&y.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(y,M,V){if(this._animatingZoom)return!0;if(V=V||{},!this._zoomAnimated||V.animate===!1||this._nothingToAnimate()||Math.abs(M-this._zoom)>this.options.zoomAnimationThreshold)return!1;var ie=this.getZoomScale(M),Ee=this._getCenterOffset(y)._divideBy(1-1/ie);return V.animate!==!0&&!this.getSize().contains(Ee)?!1:(Je(function(){this._moveStart(!0,V.noMoveStart||!1)._animateZoom(y,M,!0)},this),!0)},_animateZoom:function(y,M,V,ie){this._mapPane&&(V&&(this._animatingZoom=!0,this._animateToCenter=y,this._animateToZoom=M,yr(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:y,zoom:M,noUpdate:ie}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(S(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&wi(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Zo(y,M){return new Oi(y,M)}var ro=Ht.extend({options:{position:"topright"},initialize:function(y){se(this,y)},getPosition:function(){return this.options.position},setPosition:function(y){var M=this._map;return M&&M.removeControl(this),this.options.position=y,M&&M.addControl(this),this},getContainer:function(){return this._container},addTo:function(y){this.remove(),this._map=y;var M=this._container=this.onAdd(y),V=this.getPosition(),ie=y._controlCorners[V];return yr(M,"leaflet-control"),V.indexOf("bottom")!==-1?ie.insertBefore(M,ie.firstChild):ie.appendChild(M),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Gr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(y){this._map&&y&&y.screenX>0&&y.screenY>0&&this._map.getContainer().focus()}}),No=function(y){return new ro(y)};Oi.include({addControl:function(y){return y.addTo(this),this},removeControl:function(y){return y.remove(),this},_initControlPos:function(){var y=this._controlCorners={},M="leaflet-",V=this._controlContainer=Xn("div",M+"control-container",this._container);function ie(Ee,Ge){var Pt=M+Ee+" "+M+Ge;y[Ee+Ge]=Xn("div",Pt,V)}ie("top","left"),ie("top","right"),ie("bottom","left"),ie("bottom","right")},_clearControlPos:function(){for(var y in this._controlCorners)Gr(this._controlCorners[y]);Gr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ac=ro.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(y,M,V,ie){return V<ie?-1:ie<V?1:0}},initialize:function(y,M,V){se(this,V),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var ie in y)this._addLayer(y[ie],ie);for(ie in M)this._addLayer(M[ie],ie,!0)},onAdd:function(y){this._initLayout(),this._update(),this._map=y,y.on("zoomend",this._checkDisabledLayers,this);for(var M=0;M<this._layers.length;M++)this._layers[M].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(y){return ro.prototype.addTo.call(this,y),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(y,M){return this._addLayer(y,M),this._map?this._update():this},addOverlay:function(y,M){return this._addLayer(y,M,!0),this._map?this._update():this},removeLayer:function(y){y.off("add remove",this._onLayerChange,this);var M=this._getLayer(I(y));return M&&this._layers.splice(this._layers.indexOf(M),1),this._map?this._update():this},expand:function(){yr(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var y=this._map.getSize().y-(this._container.offsetTop+50);return y<this._section.clientHeight?(yr(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=y+"px"):wi(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return wi(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var y="leaflet-control-layers",M=this._container=Xn("div",y),V=this.options.collapsed;M.setAttribute("aria-haspopup",!0),cr(M),Bo(M);var ie=this._section=Xn("section",y+"-list");V&&(this._map.on("click",this.collapse,this),Hr(M,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Ee=this._layersLink=Xn("a",y+"-toggle",M);Ee.href="#",Ee.title="Layers",Ee.setAttribute("role","button"),Hr(Ee,{keydown:function(Ge){Ge.keyCode===13&&this._expandSafely()},click:function(Ge){co(Ge),this._expandSafely()}},this),V||this.expand(),this._baseLayersList=Xn("div",y+"-base",ie),this._separator=Xn("div",y+"-separator",ie),this._overlaysList=Xn("div",y+"-overlays",ie),M.appendChild(ie)},_getLayer:function(y){for(var M=0;M<this._layers.length;M++)if(this._layers[M]&&I(this._layers[M].layer)===y)return this._layers[M]},_addLayer:function(y,M,V){this._map&&y.on("add remove",this._onLayerChange,this),this._layers.push({layer:y,name:M,overlay:V}),this.options.sortLayers&&this._layers.sort(S(function(ie,Ee){return this.options.sortFunction(ie.layer,Ee.layer,ie.name,Ee.name)},this)),this.options.autoZIndex&&y.setZIndex&&(this._lastZIndex++,y.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;xa(this._baseLayersList),xa(this._overlaysList),this._layerControlInputs=[];var y,M,V,ie,Ee=0;for(V=0;V<this._layers.length;V++)ie=this._layers[V],this._addItem(ie),M=M||ie.overlay,y=y||!ie.overlay,Ee+=ie.overlay?0:1;return this.options.hideSingleBase&&(y=y&&Ee>1,this._baseLayersList.style.display=y?"":"none"),this._separator.style.display=M&&y?"":"none",this},_onLayerChange:function(y){this._handlingClick||this._update();var M=this._getLayer(I(y.target)),V=M.overlay?y.type==="add"?"overlayadd":"overlayremove":y.type==="add"?"baselayerchange":null;V&&this._map.fire(V,M)},_createRadioElement:function(y,M){var V='<input type="radio" class="leaflet-control-layers-selector" name="'+y+'"'+(M?' checked="checked"':"")+"/>",ie=document.createElement("div");return ie.innerHTML=V,ie.firstChild},_addItem:function(y){var M=document.createElement("label"),V=this._map.hasLayer(y.layer),ie;y.overlay?(ie=document.createElement("input"),ie.type="checkbox",ie.className="leaflet-control-layers-selector",ie.defaultChecked=V):ie=this._createRadioElement("leaflet-base-layers_"+I(this),V),this._layerControlInputs.push(ie),ie.layerId=I(y.layer),Hr(ie,"click",this._onInputClick,this);var Ee=document.createElement("span");Ee.innerHTML=" "+y.name;var Ge=document.createElement("span");M.appendChild(Ge),Ge.appendChild(ie),Ge.appendChild(Ee);var Pt=y.overlay?this._overlaysList:this._baseLayersList;return Pt.appendChild(M),this._checkDisabledLayers(),M},_onInputClick:function(){if(!this._preventClick){var y=this._layerControlInputs,M,V,ie=[],Ee=[];this._handlingClick=!0;for(var Ge=y.length-1;Ge>=0;Ge--)M=y[Ge],V=this._getLayer(M.layerId).layer,M.checked?ie.push(V):M.checked||Ee.push(V);for(Ge=0;Ge<Ee.length;Ge++)this._map.hasLayer(Ee[Ge])&&this._map.removeLayer(Ee[Ge]);for(Ge=0;Ge<ie.length;Ge++)this._map.hasLayer(ie[Ge])||this._map.addLayer(ie[Ge]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var y=this._layerControlInputs,M,V,ie=this._map.getZoom(),Ee=y.length-1;Ee>=0;Ee--)M=y[Ee],V=this._getLayer(M.layerId).layer,M.disabled=V.options.minZoom!==void 0&&ie<V.options.minZoom||V.options.maxZoom!==void 0&&ie>V.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var y=this._section;this._preventClick=!0,Hr(y,"click",co),this.expand();var M=this;setTimeout(function(){no(y,"click",co),M._preventClick=!1})}}),ts=function(y,M,V){return new ac(y,M,V)},io=ro.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(y){var M="leaflet-control-zoom",V=Xn("div",M+" leaflet-bar"),ie=this.options;return this._zoomInButton=this._createButton(ie.zoomInText,ie.zoomInTitle,M+"-in",V,this._zoomIn),this._zoomOutButton=this._createButton(ie.zoomOutText,ie.zoomOutTitle,M+"-out",V,this._zoomOut),this._updateDisabled(),y.on("zoomend zoomlevelschange",this._updateDisabled,this),V},onRemove:function(y){y.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(y){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(y.shiftKey?3:1))},_zoomOut:function(y){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(y.shiftKey?3:1))},_createButton:function(y,M,V,ie,Ee){var Ge=Xn("a",V,ie);return Ge.innerHTML=y,Ge.href="#",Ge.title=M,Ge.setAttribute("role","button"),Ge.setAttribute("aria-label",M),cr(Ge),Hr(Ge,"click",ua),Hr(Ge,"click",Ee,this),Hr(Ge,"click",this._refocusOnMap,this),Ge},_updateDisabled:function(){var y=this._map,M="leaflet-disabled";wi(this._zoomInButton,M),wi(this._zoomOutButton,M),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||y._zoom===y.getMinZoom())&&(yr(this._zoomOutButton,M),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||y._zoom===y.getMaxZoom())&&(yr(this._zoomInButton,M),this._zoomInButton.setAttribute("aria-disabled","true"))}});Oi.mergeOptions({zoomControl:!0}),Oi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new io,this.addControl(this.zoomControl))});var ca=function(y){return new io(y)},yo=ro.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(y){var M="leaflet-control-scale",V=Xn("div",M),ie=this.options;return this._addScales(ie,M+"-line",V),y.on(ie.updateWhenIdle?"moveend":"move",this._update,this),y.whenReady(this._update,this),V},onRemove:function(y){y.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(y,M,V){y.metric&&(this._mScale=Xn("div",M,V)),y.imperial&&(this._iScale=Xn("div",M,V))},_update:function(){var y=this._map,M=y.getSize().y/2,V=y.distance(y.containerPointToLatLng([0,M]),y.containerPointToLatLng([this.options.maxWidth,M]));this._updateScales(V)},_updateScales:function(y){this.options.metric&&y&&this._updateMetric(y),this.options.imperial&&y&&this._updateImperial(y)},_updateMetric:function(y){var M=this._getRoundNum(y),V=M<1e3?M+" m":M/1e3+" km";this._updateScale(this._mScale,V,M/y)},_updateImperial:function(y){var M=y*3.2808399,V,ie,Ee;M>5280?(V=M/5280,ie=this._getRoundNum(V),this._updateScale(this._iScale,ie+" mi",ie/V)):(Ee=this._getRoundNum(M),this._updateScale(this._iScale,Ee+" ft",Ee/M))},_updateScale:function(y,M,V){y.style.width=Math.round(this.options.maxWidth*V)+"px",y.innerHTML=M},_getRoundNum:function(y){var M=Math.pow(10,(Math.floor(y)+"").length-1),V=y/M;return V=V>=10?10:V>=5?5:V>=3?3:V>=2?2:1,M*V}}),Ao=function(y){return new yo(y)},fl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ca=ro.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ae.inlineSvg?fl+" ":"")+"Leaflet</a>"},initialize:function(y){se(this,y),this._attributions={}},onAdd:function(y){y.attributionControl=this,this._container=Xn("div","leaflet-control-attribution"),cr(this._container);for(var M in y._layers)y._layers[M].getAttribution&&this.addAttribution(y._layers[M].getAttribution());return this._update(),y.on("layeradd",this._addAttribution,this),this._container},onRemove:function(y){y.off("layeradd",this._addAttribution,this)},_addAttribution:function(y){y.layer.getAttribution&&(this.addAttribution(y.layer.getAttribution()),y.layer.once("remove",function(){this.removeAttribution(y.layer.getAttribution())},this))},setPrefix:function(y){return this.options.prefix=y,this._update(),this},addAttribution:function(y){return y?(this._attributions[y]||(this._attributions[y]=0),this._attributions[y]++,this._update(),this):this},removeAttribution:function(y){return y?(this._attributions[y]&&(this._attributions[y]--,this._update()),this):this},_update:function(){if(this._map){var y=[];for(var M in this._attributions)this._attributions[M]&&y.push(M);var V=[];this.options.prefix&&V.push(this.options.prefix),y.length&&V.push(y.join(", ")),this._container.innerHTML=V.join(' <span aria-hidden="true">|</span> ')}}});Oi.mergeOptions({attributionControl:!0}),Oi.addInitHook(function(){this.options.attributionControl&&new Ca().addTo(this)});var bl=function(y){return new Ca(y)};ro.Layers=ac,ro.Zoom=io,ro.Scale=yo,ro.Attribution=Ca,No.layers=ts,No.zoom=ca,No.scale=Ao,No.attribution=bl;var Xo=Ht.extend({initialize:function(y){this._map=y},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Xo.addTo=function(y,M){return y.addHandler(M,this),this};var ls={Events:Kt},bs=Ae.touch?"touchstart mousedown":"mousedown",ra=Lt.extend({options:{clickTolerance:3},initialize:function(y,M,V,ie){se(this,ie),this._element=y,this._dragStartTarget=M||y,this._preventOutline=V},enable:function(){this._enabled||(Hr(this._dragStartTarget,bs,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ra._dragging===this&&this.finishDrag(!0),no(this._dragStartTarget,bs,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(y){if(this._enabled&&(this._moved=!1,!wo(this._element,"leaflet-zoom-anim"))){if(y.touches&&y.touches.length!==1){ra._dragging===this&&this.finishDrag();return}if(!(ra._dragging||y.shiftKey||y.which!==1&&y.button!==1&&!y.touches)&&(ra._dragging=this,this._preventOutline&&Pr(this._element),So(),Gn(),!this._moving)){this.fire("down");var M=y.touches?y.touches[0]:y,V=Yn(this._element);this._startPoint=new et(M.clientX,M.clientY),this._startPos=Cn(this._element),this._parentScale=Wo(V);var ie=y.type==="mousedown";Hr(document,ie?"mousemove":"touchmove",this._onMove,this),Hr(document,ie?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(y){if(this._enabled){if(y.touches&&y.touches.length>1){this._moved=!0;return}var M=y.touches&&y.touches.length===1?y.touches[0]:y,V=new et(M.clientX,M.clientY)._subtract(this._startPoint);!V.x&&!V.y||Math.abs(V.x)+Math.abs(V.y)<this.options.clickTolerance||(V.x/=this._parentScale.x,V.y/=this._parentScale.y,co(y),this._moved||(this.fire("dragstart"),this._moved=!0,yr(document.body,"leaflet-dragging"),this._lastTarget=y.target||y.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yr(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(V),this._moving=!0,this._lastEvent=y,this._updatePosition())}},_updatePosition:function(){var y={originalEvent:this._lastEvent};this.fire("predrag",y),fn(this._element,this._newPos),this.fire("drag",y)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(y){wi(document.body,"leaflet-dragging"),this._lastTarget&&(wi(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),no(document,"mousemove touchmove",this._onMove,this),no(document,"mouseup touchend touchcancel",this._onUp,this),To(),Cr();var M=this._moved&&this._moving;this._moving=!1,ra._dragging=!1,M&&this.fire("dragend",{noInertia:y,distance:this._newPos.distanceTo(this._startPos)})}});function sc(y,M,V){var ie,Ee=[1,4,2,8],Ge,Pt,on,dn,Rn,hr,Jr,Ii;for(Ge=0,hr=y.length;Ge<hr;Ge++)y[Ge]._code=dl(y[Ge],M);for(on=0;on<4;on++){for(Jr=Ee[on],ie=[],Ge=0,hr=y.length,Pt=hr-1;Ge<hr;Pt=Ge++)dn=y[Ge],Rn=y[Pt],dn._code&Jr?Rn._code&Jr||(Ii=ws(Rn,dn,Jr,M,V),Ii._code=dl(Ii,M),ie.push(Ii)):(Rn._code&Jr&&(Ii=ws(Rn,dn,Jr,M,V),Ii._code=dl(Ii,M),ie.push(Ii)),ie.push(dn));y=ie}return y}function lc(y,M){var V,ie,Ee,Ge,Pt,on,dn,Rn,hr;if(!y||y.length===0)throw new Error("latlngs not passed");Sr(y)||(console.warn("latlngs are not flat! Only the first ring will be used"),y=y[0]);var Jr=Bn([0,0]),Ii=Un(y),ja=Ii.getNorthWest().distanceTo(Ii.getSouthWest())*Ii.getNorthEast().distanceTo(Ii.getNorthWest());ja<1700&&(Jr=wa(y));var Ko=y.length,Fs=[];for(V=0;V<Ko;V++){var fs=Bn(y[V]);Fs.push(M.project(Bn([fs.lat-Jr.lat,fs.lng-Jr.lng])))}for(on=dn=Rn=0,V=0,ie=Ko-1;V<Ko;ie=V++)Ee=Fs[V],Ge=Fs[ie],Pt=Ee.y*Ge.x-Ge.y*Ee.x,dn+=(Ee.x+Ge.x)*Pt,Rn+=(Ee.y+Ge.y)*Pt,on+=Pt*3;on===0?hr=Fs[0]:hr=[dn/on,Rn/on];var qu=M.unproject(Ot(hr));return Bn([qu.lat+Jr.lat,qu.lng+Jr.lng])}function wa(y){for(var M=0,V=0,ie=0,Ee=0;Ee<y.length;Ee++){var Ge=Bn(y[Ee]);M+=Ge.lat,V+=Ge.lng,ie++}return Bn([M/ie,V/ie])}var us={__proto__:null,clipPolygon:sc,polygonCenter:lc,centroid:wa};function wl(y,M){if(!M||!y.length)return y.slice();var V=M*M;return y=cu(y,V),y=$l(y,V),y}function Ru(y,M,V){return Math.sqrt(ia(y,M,V,!0))}function lu(y,M,V){return ia(y,M,V)}function $l(y,M){var V=y.length,ie=typeof Uint8Array<"u"?Uint8Array:Array,Ee=new ie(V);Ee[0]=Ee[V-1]=1,uu(y,Ee,M,0,V-1);var Ge,Pt=[];for(Ge=0;Ge<V;Ge++)Ee[Ge]&&Pt.push(y[Ge]);return Pt}function uu(y,M,V,ie,Ee){var Ge=0,Pt,on,dn;for(on=ie+1;on<=Ee-1;on++)dn=ia(y[on],y[ie],y[Ee],!0),dn>Ge&&(Pt=on,Ge=dn);Ge>V&&(M[Pt]=1,uu(y,M,V,ie,Pt),uu(y,M,V,Pt,Ee))}function cu(y,M){for(var V=[y[0]],ie=1,Ee=0,Ge=y.length;ie<Ge;ie++)Du(y[ie],y[Ee])>M&&(V.push(y[ie]),Ee=ie);return Ee<Ge-1&&V.push(y[Ge-1]),V}var Ks;function Lu(y,M,V,ie,Ee){var Ge=ie?Ks:dl(y,V),Pt=dl(M,V),on,dn,Rn;for(Ks=Pt;;){if(!(Ge|Pt))return[y,M];if(Ge&Pt)return!1;on=Ge||Pt,dn=ws(y,M,on,V,Ee),Rn=dl(dn,V),on===Ge?(y=dn,Ge=Rn):(M=dn,Pt=Rn)}}function ws(y,M,V,ie,Ee){var Ge=M.x-y.x,Pt=M.y-y.y,on=ie.min,dn=ie.max,Rn,hr;return V&8?(Rn=y.x+Ge*(dn.y-y.y)/Pt,hr=dn.y):V&4?(Rn=y.x+Ge*(on.y-y.y)/Pt,hr=on.y):V&2?(Rn=dn.x,hr=y.y+Pt*(dn.x-y.x)/Ge):V&1&&(Rn=on.x,hr=y.y+Pt*(on.x-y.x)/Ge),new et(Rn,hr,Ee)}function dl(y,M){var V=0;return y.x<M.min.x?V|=1:y.x>M.max.x&&(V|=2),y.y<M.min.y?V|=4:y.y>M.max.y&&(V|=8),V}function Du(y,M){var V=M.x-y.x,ie=M.y-y.y;return V*V+ie*ie}function ia(y,M,V,ie){var Ee=M.x,Ge=M.y,Pt=V.x-Ee,on=V.y-Ge,dn=Pt*Pt+on*on,Rn;return dn>0&&(Rn=((y.x-Ee)*Pt+(y.y-Ge)*on)/dn,Rn>1?(Ee=V.x,Ge=V.y):Rn>0&&(Ee+=Pt*Rn,Ge+=on*Rn)),Pt=y.x-Ee,on=y.y-Ge,ie?Pt*Pt+on*on:new et(Ee,Ge)}function Sr(y){return!Re(y[0])||typeof y[0][0]!="object"&&typeof y[0][0]<"u"}function ir(y){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Sr(y)}function pe(y,M){var V,ie,Ee,Ge,Pt,on,dn,Rn;if(!y||y.length===0)throw new Error("latlngs not passed");Sr(y)||(console.warn("latlngs are not flat! Only the first ring will be used"),y=y[0]);var hr=Bn([0,0]),Jr=Un(y),Ii=Jr.getNorthWest().distanceTo(Jr.getSouthWest())*Jr.getNorthEast().distanceTo(Jr.getNorthWest());Ii<1700&&(hr=wa(y));var ja=y.length,Ko=[];for(V=0;V<ja;V++){var Fs=Bn(y[V]);Ko.push(M.project(Bn([Fs.lat-hr.lat,Fs.lng-hr.lng])))}for(V=0,ie=0;V<ja-1;V++)ie+=Ko[V].distanceTo(Ko[V+1])/2;if(ie===0)Rn=Ko[0];else for(V=0,Ge=0;V<ja-1;V++)if(Pt=Ko[V],on=Ko[V+1],Ee=Pt.distanceTo(on),Ge+=Ee,Ge>ie){dn=(Ge-ie)/Ee,Rn=[on.x-dn*(on.x-Pt.x),on.y-dn*(on.y-Pt.y)];break}var fs=M.unproject(Ot(Rn));return Bn([fs.lat+hr.lat,fs.lng+hr.lng])}var Pe={__proto__:null,simplify:wl,pointToSegmentDistance:Ru,closestPointOnSegment:lu,clipSegment:Lu,_getEdgeIntersection:ws,_getBitCode:dl,_sqClosestPointOnSegment:ia,isFlat:Sr,_flat:ir,polylineCenter:pe},Xe={project:function(y){return new et(y.lng,y.lat)},unproject:function(y){return new $n(y.y,y.x)},bounds:new mt([-180,-90],[180,90])},pt={R:6378137,R_MINOR:6356752314245179e-9,bounds:new mt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(y){var M=Math.PI/180,V=this.R,ie=y.lat*M,Ee=this.R_MINOR/V,Ge=Math.sqrt(1-Ee*Ee),Pt=Ge*Math.sin(ie),on=Math.tan(Math.PI/4-ie/2)/Math.pow((1-Pt)/(1+Pt),Ge/2);return ie=-V*Math.log(Math.max(on,1e-10)),new et(y.lng*M*V,ie)},unproject:function(y){for(var M=180/Math.PI,V=this.R,ie=this.R_MINOR/V,Ee=Math.sqrt(1-ie*ie),Ge=Math.exp(-y.y/V),Pt=Math.PI/2-2*Math.atan(Ge),on=0,dn=.1,Rn;on<15&&Math.abs(dn)>1e-7;on++)Rn=Ee*Math.sin(Pt),Rn=Math.pow((1-Rn)/(1+Rn),Ee/2),dn=Math.PI/2-2*Math.atan(Ge*Rn)-Pt,Pt+=dn;return new $n(Pt*M,y.x*M/V)}},Mt={__proto__:null,LonLat:Xe,Mercator:pt,SphericalMercator:Ke},an=h({},_r,{code:"EPSG:3395",projection:pt,transformation:function(){var y=.5/(Math.PI*pt.R);return Sn(y,.5,-y,.5)}()}),wn=h({},_r,{code:"EPSG:4326",projection:Xe,transformation:Sn(1/180,1,-1/180,.5)}),Hn=h({},$r,{projection:Xe,transformation:Sn(1,0,-1,0),scale:function(y){return Math.pow(2,y)},zoom:function(y){return Math.log(y)/Math.LN2},distance:function(y,M){var V=M.lng-y.lng,ie=M.lat-y.lat;return Math.sqrt(V*V+ie*ie)},infinite:!0});$r.Earth=_r,$r.EPSG3395=an,$r.EPSG3857=Dr,$r.EPSG900913=Yt,$r.EPSG4326=wn,$r.Simple=Hn;var vr=Lt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(y){return y.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(y){return y&&y.removeLayer(this),this},getPane:function(y){return this._map.getPane(y?this.options[y]||y:this.options.pane)},addInteractiveTarget:function(y){return this._map._targets[I(y)]=this,this},removeInteractiveTarget:function(y){return delete this._map._targets[I(y)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(y){var M=y.target;if(M.hasLayer(this)){if(this._map=M,this._zoomAnimated=M._zoomAnimated,this.getEvents){var V=this.getEvents();M.on(V,this),this.once("remove",function(){M.off(V,this)},this)}this.onAdd(M),this.fire("add"),M.fire("layeradd",{layer:this})}}});Oi.include({addLayer:function(y){if(!y._layerAdd)throw new Error("The provided object is not a Layer.");var M=I(y);return this._layers[M]?this:(this._layers[M]=y,y._mapToAdd=this,y.beforeAdd&&y.beforeAdd(this),this.whenReady(y._layerAdd,y),this)},removeLayer:function(y){var M=I(y);return this._layers[M]?(this._loaded&&y.onRemove(this),delete this._layers[M],this._loaded&&(this.fire("layerremove",{layer:y}),y.fire("remove")),y._map=y._mapToAdd=null,this):this},hasLayer:function(y){return I(y)in this._layers},eachLayer:function(y,M){for(var V in this._layers)y.call(M,this._layers[V]);return this},_addLayers:function(y){y=y?Re(y)?y:[y]:[];for(var M=0,V=y.length;M<V;M++)this.addLayer(y[M])},_addZoomLimit:function(y){(!isNaN(y.options.maxZoom)||!isNaN(y.options.minZoom))&&(this._zoomBoundLayers[I(y)]=y,this._updateZoomLevels())},_removeZoomLimit:function(y){var M=I(y);this._zoomBoundLayers[M]&&(delete this._zoomBoundLayers[M],this._updateZoomLevels())},_updateZoomLevels:function(){var y=1/0,M=-1/0,V=this._getZoomSpan();for(var ie in this._zoomBoundLayers){var Ee=this._zoomBoundLayers[ie].options;y=Ee.minZoom===void 0?y:Math.min(y,Ee.minZoom),M=Ee.maxZoom===void 0?M:Math.max(M,Ee.maxZoom)}this._layersMaxZoom=M===-1/0?void 0:M,this._layersMinZoom=y===1/0?void 0:y,V!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yr=vr.extend({initialize:function(y,M){se(this,M),this._layers={};var V,ie;if(y)for(V=0,ie=y.length;V<ie;V++)this.addLayer(y[V])},addLayer:function(y){var M=this.getLayerId(y);return this._layers[M]=y,this._map&&this._map.addLayer(y),this},removeLayer:function(y){var M=y in this._layers?y:this.getLayerId(y);return this._map&&this._layers[M]&&this._map.removeLayer(this._layers[M]),delete this._layers[M],this},hasLayer:function(y){var M=typeof y=="number"?y:this.getLayerId(y);return M in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(y){var M=Array.prototype.slice.call(arguments,1),V,ie;for(V in this._layers)ie=this._layers[V],ie[y]&&ie[y].apply(ie,M);return this},onAdd:function(y){this.eachLayer(y.addLayer,y)},onRemove:function(y){this.eachLayer(y.removeLayer,y)},eachLayer:function(y,M){for(var V in this._layers)y.call(M,this._layers[V]);return this},getLayer:function(y){return this._layers[y]},getLayers:function(){var y=[];return this.eachLayer(y.push,y),y},setZIndex:function(y){return this.invoke("setZIndex",y)},getLayerId:function(y){return I(y)}}),Or=function(y,M){return new Yr(y,M)},zi=Yr.extend({addLayer:function(y){return this.hasLayer(y)?this:(y.addEventParent(this),Yr.prototype.addLayer.call(this,y),this.fire("layeradd",{layer:y}))},removeLayer:function(y){return this.hasLayer(y)?(y in this._layers&&(y=this._layers[y]),y.removeEventParent(this),Yr.prototype.removeLayer.call(this,y),this.fire("layerremove",{layer:y})):this},setStyle:function(y){return this.invoke("setStyle",y)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var y=new Jt;for(var M in this._layers){var V=this._layers[M];y.extend(V.getBounds?V.getBounds():V.getLatLng())}return y}}),ha=function(y,M){return new zi(y,M)},jo=Ht.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(y){se(this,y)},createIcon:function(y){return this._createIcon("icon",y)},createShadow:function(y){return this._createIcon("shadow",y)},_createIcon:function(y,M){var V=this._getIconUrl(y);if(!V){if(y==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var ie=this._createImg(V,M&&M.tagName==="IMG"?M:null);return this._setIconStyles(ie,y),(this.options.crossOrigin||this.options.crossOrigin==="")&&(ie.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),ie},_setIconStyles:function(y,M){var V=this.options,ie=V[M+"Size"];typeof ie=="number"&&(ie=[ie,ie]);var Ee=Ot(ie),Ge=Ot(M==="shadow"&&V.shadowAnchor||V.iconAnchor||Ee&&Ee.divideBy(2,!0));y.className="leaflet-marker-"+M+" "+(V.className||""),Ge&&(y.style.marginLeft=-Ge.x+"px",y.style.marginTop=-Ge.y+"px"),Ee&&(y.style.width=Ee.x+"px",y.style.height=Ee.y+"px")},_createImg:function(y,M){return M=M||document.createElement("img"),M.src=y,M},_getIconUrl:function(y){return Ae.retina&&this.options[y+"RetinaUrl"]||this.options[y+"Url"]}});function Xa(y){return new jo(y)}var Oa=jo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(y){return typeof Oa.imagePath!="string"&&(Oa.imagePath=this._detectIconPath()),(this.options.imagePath||Oa.imagePath)+jo.prototype._getIconUrl.call(this,y)},_stripUrl:function(y){var M=function(V,ie,Ee){var Ge=ie.exec(V);return Ge&&Ge[Ee]};return y=M(y,/^url\((['"])?(.+)\1\)$/,2),y&&M(y,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var y=Xn("div","leaflet-default-icon-path",document.body),M=Zi(y,"background-image")||Zi(y,"backgroundImage");if(document.body.removeChild(y),M=this._stripUrl(M),M)return M;var V=document.querySelector('link[href$="leaflet.css"]');return V?V.href.substring(0,V.href.length-11-1):""}}),Ji=Xo.extend({initialize:function(y){this._marker=y},addHooks:function(){var y=this._marker._icon;this._draggable||(this._draggable=new ra(y,y,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yr(y,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&wi(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(y){var M=this._marker,V=M._map,ie=this._marker.options.autoPanSpeed,Ee=this._marker.options.autoPanPadding,Ge=Cn(M._icon),Pt=V.getPixelBounds(),on=V.getPixelOrigin(),dn=zt(Pt.min._subtract(on).add(Ee),Pt.max._subtract(on).subtract(Ee));if(!dn.contains(Ge)){var Rn=Ot((Math.max(dn.max.x,Ge.x)-dn.max.x)/(Pt.max.x-dn.max.x)-(Math.min(dn.min.x,Ge.x)-dn.min.x)/(Pt.min.x-dn.min.x),(Math.max(dn.max.y,Ge.y)-dn.max.y)/(Pt.max.y-dn.max.y)-(Math.min(dn.min.y,Ge.y)-dn.min.y)/(Pt.min.y-dn.min.y)).multiplyBy(ie);V.panBy(Rn,{animate:!1}),this._draggable._newPos._add(Rn),this._draggable._startPos._add(Rn),fn(M._icon,this._draggable._newPos),this._onDrag(y),this._panRequest=Je(this._adjustPan.bind(this,y))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(y){this._marker.options.autoPan&&(St(this._panRequest),this._panRequest=Je(this._adjustPan.bind(this,y)))},_onDrag:function(y){var M=this._marker,V=M._shadow,ie=Cn(M._icon),Ee=M._map.layerPointToLatLng(ie);V&&fn(V,ie),M._latlng=Ee,y.latlng=Ee,y.oldLatLng=this._oldLatLng,M.fire("move",y).fire("drag",y)},_onDragEnd:function(y){St(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",y)}}),cs=vr.extend({options:{icon:new Oa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(y,M){se(this,M),this._latlng=Bn(y)},onAdd:function(y){this._zoomAnimated=this._zoomAnimated&&y.options.markerZoomAnimation,this._zoomAnimated&&y.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(y){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&y.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(y){var M=this._latlng;return this._latlng=Bn(y),this.update(),this.fire("move",{oldLatLng:M,latlng:this._latlng})},setZIndexOffset:function(y){return this.options.zIndexOffset=y,this.update()},getIcon:function(){return this.options.icon},setIcon:function(y){return this.options.icon=y,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var y=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(y)}return this},_initIcon:function(){var y=this.options,M="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),V=y.icon.createIcon(this._icon),ie=!1;V!==this._icon&&(this._icon&&this._removeIcon(),ie=!0,y.title&&(V.title=y.title),V.tagName==="IMG"&&(V.alt=y.alt||"")),yr(V,M),y.keyboard&&(V.tabIndex="0",V.setAttribute("role","button")),this._icon=V,y.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Hr(V,"focus",this._panOnFocus,this);var Ee=y.icon.createShadow(this._shadow),Ge=!1;Ee!==this._shadow&&(this._removeShadow(),Ge=!0),Ee&&(yr(Ee,M),Ee.alt=""),this._shadow=Ee,y.opacity<1&&this._updateOpacity(),ie&&this.getPane().appendChild(this._icon),this._initInteraction(),Ee&&Ge&&this.getPane(y.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&no(this._icon,"focus",this._panOnFocus,this),Gr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Gr(this._shadow),this._shadow=null},_setPos:function(y){this._icon&&fn(this._icon,y),this._shadow&&fn(this._shadow,y),this._zIndex=y.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(y){this._icon&&(this._icon.style.zIndex=this._zIndex+y)},_animateZoom:function(y){var M=this._map._latLngToNewLayerPoint(this._latlng,y.zoom,y.center).round();this._setPos(M)},_initInteraction:function(){if(this.options.interactive&&(yr(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ji)){var y=this.options.draggable;this.dragging&&(y=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ji(this),y&&this.dragging.enable()}},setOpacity:function(y){return this.options.opacity=y,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var y=this.options.opacity;this._icon&&We(this._icon,y),this._shadow&&We(this._shadow,y)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var y=this._map;if(y){var M=this.options.icon.options,V=M.iconSize?Ot(M.iconSize):Ot(0,0),ie=M.iconAnchor?Ot(M.iconAnchor):Ot(0,0);y.panInside(this._latlng,{paddingTopLeft:ie,paddingBottomRight:V.subtract(ie)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function En(y,M){return new cs(y,M)}var Ul=vr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(y){this._renderer=y.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(y){return se(this,y),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&y&&Object.prototype.hasOwnProperty.call(y,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Vl=Ul.extend({options:{fill:!0,radius:10},initialize:function(y,M){se(this,M),this._latlng=Bn(y),this._radius=this.options.radius},setLatLng:function(y){var M=this._latlng;return this._latlng=Bn(y),this.redraw(),this.fire("move",{oldLatLng:M,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(y){return this.options.radius=this._radius=y,this.redraw()},getRadius:function(){return this._radius},setStyle:function(y){var M=y&&y.radius||this._radius;return Ul.prototype.setStyle.call(this,y),this.setRadius(M),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var y=this._radius,M=this._radiusY||y,V=this._clickTolerance(),ie=[y+V,M+V];this._pxBounds=new mt(this._point.subtract(ie),this._point.add(ie))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(y){return y.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Qc(y,M){return new Vl(y,M)}var zu=Vl.extend({initialize:function(y,M,V){if(typeof M=="number"&&(M=h({},V,{radius:M})),se(this,M),this._latlng=Bn(y),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(y){return this._mRadius=y,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var y=[this._radius,this._radiusY||this._radius];return new Jt(this._map.layerPointToLatLng(this._point.subtract(y)),this._map.layerPointToLatLng(this._point.add(y)))},setStyle:Ul.prototype.setStyle,_project:function(){var y=this._latlng.lng,M=this._latlng.lat,V=this._map,ie=V.options.crs;if(ie.distance===_r.distance){var Ee=Math.PI/180,Ge=this._mRadius/_r.R/Ee,Pt=V.project([M+Ge,y]),on=V.project([M-Ge,y]),dn=Pt.add(on).divideBy(2),Rn=V.unproject(dn).lat,hr=Math.acos((Math.cos(Ge*Ee)-Math.sin(M*Ee)*Math.sin(Rn*Ee))/(Math.cos(M*Ee)*Math.cos(Rn*Ee)))/Ee;(isNaN(hr)||hr===0)&&(hr=Ge/Math.cos(Math.PI/180*M)),this._point=dn.subtract(V.getPixelOrigin()),this._radius=isNaN(hr)?0:dn.x-V.project([Rn,y-hr]).x,this._radiusY=dn.y-Pt.y}else{var Jr=ie.unproject(ie.project(this._latlng).subtract([this._mRadius,0]));this._point=V.latLngToLayerPoint(this._latlng),this._radius=this._point.x-V.latLngToLayerPoint(Jr).x}this._updateBounds()}});function hu(y,M,V){return new zu(y,M,V)}var fa=Ul.extend({options:{smoothFactor:1,noClip:!1},initialize:function(y,M){se(this,M),this._setLatLngs(y)},getLatLngs:function(){return this._latlngs},setLatLngs:function(y){return this._setLatLngs(y),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(y){for(var M=1/0,V=null,ie=ia,Ee,Ge,Pt=0,on=this._parts.length;Pt<on;Pt++)for(var dn=this._parts[Pt],Rn=1,hr=dn.length;Rn<hr;Rn++){Ee=dn[Rn-1],Ge=dn[Rn];var Jr=ie(y,Ee,Ge,!0);Jr<M&&(M=Jr,V=ie(y,Ee,Ge))}return V&&(V.distance=Math.sqrt(M)),V},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return pe(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(y,M){return M=M||this._defaultShape(),y=Bn(y),M.push(y),this._bounds.extend(y),this.redraw()},_setLatLngs:function(y){this._bounds=new Jt,this._latlngs=this._convertLatLngs(y)},_defaultShape:function(){return Sr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(y){for(var M=[],V=Sr(y),ie=0,Ee=y.length;ie<Ee;ie++)V?(M[ie]=Bn(y[ie]),this._bounds.extend(M[ie])):M[ie]=this._convertLatLngs(y[ie]);return M},_project:function(){var y=new mt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,y),this._bounds.isValid()&&y.isValid()&&(this._rawPxBounds=y,this._updateBounds())},_updateBounds:function(){var y=this._clickTolerance(),M=new et(y,y);this._rawPxBounds&&(this._pxBounds=new mt([this._rawPxBounds.min.subtract(M),this._rawPxBounds.max.add(M)]))},_projectLatlngs:function(y,M,V){var ie=y[0]instanceof $n,Ee=y.length,Ge,Pt;if(ie){for(Pt=[],Ge=0;Ge<Ee;Ge++)Pt[Ge]=this._map.latLngToLayerPoint(y[Ge]),V.extend(Pt[Ge]);M.push(Pt)}else for(Ge=0;Ge<Ee;Ge++)this._projectLatlngs(y[Ge],M,V)},_clipPoints:function(){var y=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(y))){if(this.options.noClip){this._parts=this._rings;return}var M=this._parts,V,ie,Ee,Ge,Pt,on,dn;for(V=0,Ee=0,Ge=this._rings.length;V<Ge;V++)for(dn=this._rings[V],ie=0,Pt=dn.length;ie<Pt-1;ie++)on=Lu(dn[ie],dn[ie+1],y,ie,!0),on&&(M[Ee]=M[Ee]||[],M[Ee].push(on[0]),(on[1]!==dn[ie+1]||ie===Pt-2)&&(M[Ee].push(on[1]),Ee++))}},_simplifyPoints:function(){for(var y=this._parts,M=this.options.smoothFactor,V=0,ie=y.length;V<ie;V++)y[V]=wl(y[V],M)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(y,M){var V,ie,Ee,Ge,Pt,on,dn=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(y))return!1;for(V=0,Ge=this._parts.length;V<Ge;V++)for(on=this._parts[V],ie=0,Pt=on.length,Ee=Pt-1;ie<Pt;Ee=ie++)if(!(!M&&ie===0)&&Ru(y,on[Ee],on[ie])<=dn)return!0;return!1}});function ff(y,M){return new fa(y,M)}fa._flat=ir;var da=fa.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lc(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(y){var M=fa.prototype._convertLatLngs.call(this,y),V=M.length;return V>=2&&M[0]instanceof $n&&M[0].equals(M[V-1])&&M.pop(),M},_setLatLngs:function(y){fa.prototype._setLatLngs.call(this,y),Sr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Sr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var y=this._renderer._bounds,M=this.options.weight,V=new et(M,M);if(y=new mt(y.min.subtract(V),y.max.add(V)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(y))){if(this.options.noClip){this._parts=this._rings;return}for(var ie=0,Ee=this._rings.length,Ge;ie<Ee;ie++)Ge=sc(this._rings[ie],y,!0),Ge.length&&this._parts.push(Ge)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(y){var M=!1,V,ie,Ee,Ge,Pt,on,dn,Rn;if(!this._pxBounds||!this._pxBounds.contains(y))return!1;for(Ge=0,dn=this._parts.length;Ge<dn;Ge++)for(V=this._parts[Ge],Pt=0,Rn=V.length,on=Rn-1;Pt<Rn;on=Pt++)ie=V[Pt],Ee=V[on],ie.y>y.y!=Ee.y>y.y&&y.x<(Ee.x-ie.x)*(y.y-ie.y)/(Ee.y-ie.y)+ie.x&&(M=!M);return M||fa.prototype._containsPoint.call(this,y,!0)}});function zh(y,M){return new da(y,M)}var hs=zi.extend({initialize:function(y,M){se(this,M),this._layers={},y&&this.addData(y)},addData:function(y){var M=Re(y)?y:y.features,V,ie,Ee;if(M){for(V=0,ie=M.length;V<ie;V++)Ee=M[V],(Ee.geometries||Ee.geometry||Ee.features||Ee.coordinates)&&this.addData(Ee);return this}var Ge=this.options;if(Ge.filter&&!Ge.filter(y))return this;var Pt=Fu(y,Ge);return Pt?(Pt.feature=th(y),Pt.defaultOptions=Pt.options,this.resetStyle(Pt),Ge.onEachFeature&&Ge.onEachFeature(y,Pt),this.addLayer(Pt)):this},resetStyle:function(y){return y===void 0?this.eachLayer(this.resetStyle,this):(y.options=h({},y.defaultOptions),this._setLayerStyle(y,this.options.style),this)},setStyle:function(y){return this.eachLayer(function(M){this._setLayerStyle(M,y)},this)},_setLayerStyle:function(y,M){y.setStyle&&(typeof M=="function"&&(M=M(y.feature)),y.setStyle(M))}});function Fu(y,M){var V=y.type==="Feature"?y.geometry:y,ie=V?V.coordinates:null,Ee=[],Ge=M&&M.pointToLayer,Pt=M&&M.coordsToLatLng||ns,on,dn,Rn,hr;if(!ie&&!V)return null;switch(V.type){case"Point":return on=Pt(ie),eh(Ge,y,on,M);case"MultiPoint":for(Rn=0,hr=ie.length;Rn<hr;Rn++)on=Pt(ie[Rn]),Ee.push(eh(Ge,y,on,M));return new zi(Ee);case"LineString":case"MultiLineString":return dn=uc(ie,V.type==="LineString"?0:1,Pt),new fa(dn,M);case"Polygon":case"MultiPolygon":return dn=uc(ie,V.type==="Polygon"?1:2,Pt),new da(dn,M);case"GeometryCollection":for(Rn=0,hr=V.geometries.length;Rn<hr;Rn++){var Jr=Fu({geometry:V.geometries[Rn],type:"Feature",properties:y.properties},M);Jr&&Ee.push(Jr)}return new zi(Ee);case"FeatureCollection":for(Rn=0,hr=V.features.length;Rn<hr;Rn++){var Ii=Fu(V.features[Rn],M);Ii&&Ee.push(Ii)}return new zi(Ee);default:throw new Error("Invalid GeoJSON object.")}}function eh(y,M,V,ie){return y?y(M,V):new cs(V,ie&&ie.markersInheritOptions&&ie)}function ns(y){return new $n(y[1],y[0],y[2])}function uc(y,M,V){for(var ie=[],Ee=0,Ge=y.length,Pt;Ee<Ge;Ee++)Pt=M?uc(y[Ee],M-1,V):(V||ns)(y[Ee]),ie.push(Pt);return ie}function cc(y,M){return y=Bn(y),y.alt!==void 0?[K(y.lng,M),K(y.lat,M),K(y.alt,M)]:[K(y.lng,M),K(y.lat,M)]}function hc(y,M,V,ie){for(var Ee=[],Ge=0,Pt=y.length;Ge<Pt;Ge++)Ee.push(M?hc(y[Ge],Sr(y[Ge])?0:M-1,V,ie):cc(y[Ge],ie));return!M&&V&&Ee.length>0&&Ee.push(Ee[0].slice()),Ee}function ql(y,M){return y.feature?h({},y.feature,{geometry:M}):th(M)}function th(y){return y.type==="Feature"||y.type==="FeatureCollection"?y:{type:"Feature",properties:{},geometry:y}}var Fh={toGeoJSON:function(y){return ql(this,{type:"Point",coordinates:cc(this.getLatLng(),y)})}};cs.include(Fh),zu.include(Fh),Vl.include(Fh),fa.include({toGeoJSON:function(y){var M=!Sr(this._latlngs),V=hc(this._latlngs,M?1:0,!1,y);return ql(this,{type:(M?"Multi":"")+"LineString",coordinates:V})}}),da.include({toGeoJSON:function(y){var M=!Sr(this._latlngs),V=M&&!Sr(this._latlngs[0]),ie=hc(this._latlngs,V?2:M?1:0,!0,y);return M||(ie=[ie]),ql(this,{type:(V?"Multi":"")+"Polygon",coordinates:ie})}}),Yr.include({toMultiPoint:function(y){var M=[];return this.eachLayer(function(V){M.push(V.toGeoJSON(y).geometry.coordinates)}),ql(this,{type:"MultiPoint",coordinates:M})},toGeoJSON:function(y){var M=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(M==="MultiPoint")return this.toMultiPoint(y);var V=M==="GeometryCollection",ie=[];return this.eachLayer(function(Ee){if(Ee.toGeoJSON){var Ge=Ee.toGeoJSON(y);if(V)ie.push(Ge.geometry);else{var Pt=th(Ge);Pt.type==="FeatureCollection"?ie.push.apply(ie,Pt.features):ie.push(Pt)}}}),V?ql(this,{geometries:ie,type:"GeometryCollection"}):{type:"FeatureCollection",features:ie}}});function df(y,M){return new hs(y,M)}var Ys=df,Sl=vr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(y,M,V){this._url=y,this._bounds=Un(M),se(this,V)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yr(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Gr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(y){return this.options.opacity=y,this._image&&this._updateOpacity(),this},setStyle:function(y){return y.opacity&&this.setOpacity(y.opacity),this},bringToFront:function(){return this._map&&lo(this._image),this},bringToBack:function(){return this._map&&uo(this._image),this},setUrl:function(y){return this._url=y,this._image&&(this._image.src=y),this},setBounds:function(y){return this._bounds=Un(y),this._map&&this._reset(),this},getEvents:function(){var y={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(y.zoomanim=this._animateZoom),y},setZIndex:function(y){return this.options.zIndex=y,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var y=this._url.tagName==="IMG",M=this._image=y?this._url:Xn("img");if(yr(M,"leaflet-image-layer"),this._zoomAnimated&&yr(M,"leaflet-zoom-animated"),this.options.className&&yr(M,this.options.className),M.onselectstart=U,M.onmousemove=U,M.onload=S(this.fire,this,"load"),M.onerror=S(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),y){this._url=M.src;return}M.src=this._url,M.alt=this.options.alt},_animateZoom:function(y){var M=this._map.getZoomScale(y.zoom),V=this._map._latLngBoundsToNewLayerBounds(this._bounds,y.zoom,y.center).min;Zt(this._image,V,M)},_reset:function(){var y=this._image,M=new mt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),V=M.getSize();fn(y,M.min),y.style.width=V.x+"px",y.style.height=V.y+"px"},_updateOpacity:function(){We(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var y=this.options.errorOverlayUrl;y&&this._url!==y&&(this._url=y,this._image.src=y)},getCenter:function(){return this._bounds.getCenter()}}),pf=function(y,M,V){return new Sl(y,M,V)},Bu=Sl.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var y=this._url.tagName==="VIDEO",M=this._image=y?this._url:Xn("video");if(yr(M,"leaflet-image-layer"),this._zoomAnimated&&yr(M,"leaflet-zoom-animated"),this.options.className&&yr(M,this.options.className),M.onselectstart=U,M.onmousemove=U,M.onloadeddata=S(this.fire,this,"load"),y){for(var V=M.getElementsByTagName("source"),ie=[],Ee=0;Ee<V.length;Ee++)ie.push(V[Ee].src);this._url=V.length>0?ie:[M.src];return}Re(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(M.style,"objectFit")&&(M.style.objectFit="fill"),M.autoplay=!!this.options.autoplay,M.loop=!!this.options.loop,M.muted=!!this.options.muted,M.playsInline=!!this.options.playsInline;for(var Ge=0;Ge<this._url.length;Ge++){var Pt=Xn("source");Pt.src=this._url[Ge],M.appendChild(Pt)}}});function nh(y,M,V){return new Bu(y,M,V)}var Nu=Sl.extend({_initImage:function(){var y=this._image=this._url;yr(y,"leaflet-image-layer"),this._zoomAnimated&&yr(y,"leaflet-zoom-animated"),this.options.className&&yr(y,this.options.className),y.onselectstart=U,y.onmousemove=U}});function fu(y,M,V){return new Nu(y,M,V)}var Ss=vr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(y,M){y&&(y instanceof $n||Re(y))?(this._latlng=Bn(y),se(this,M)):(se(this,y),this._source=M),this.options.content&&(this._content=this.options.content)},openOn:function(y){return y=arguments.length?y:this._source._map,y.hasLayer(this)||y.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(y){return this._map?this.close():(arguments.length?this._source=y:y=this._source,this._prepareOpen(),this.openOn(y._map)),this},onAdd:function(y){this._zoomAnimated=y._zoomAnimated,this._container||this._initLayout(),y._fadeAnimated&&We(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),y._fadeAnimated&&We(this._container,1),this.bringToFront(),this.options.interactive&&(yr(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(y){y._fadeAnimated?(We(this._container,0),this._removeTimeout=setTimeout(S(Gr,void 0,this._container),200)):Gr(this._container),this.options.interactive&&(wi(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(y){return this._latlng=Bn(y),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(y){return this._content=y,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var y={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(y.zoomanim=this._animateZoom),y},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&lo(this._container),this},bringToBack:function(){return this._map&&uo(this._container),this},_prepareOpen:function(y){var M=this._source;if(!M._map)return!1;if(M instanceof zi){M=null;var V=this._source._layers;for(var ie in V)if(V[ie]._map){M=V[ie];break}if(!M)return!1;this._source=M}if(!y)if(M.getCenter)y=M.getCenter();else if(M.getLatLng)y=M.getLatLng();else if(M.getBounds)y=M.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(y),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var y=this._contentNode,M=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof M=="string")y.innerHTML=M;else{for(;y.hasChildNodes();)y.removeChild(y.firstChild);y.appendChild(M)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var y=this._map.latLngToLayerPoint(this._latlng),M=Ot(this.options.offset),V=this._getAnchor();this._zoomAnimated?fn(this._container,y.add(V)):M=M.add(y).add(V);var ie=this._containerBottom=-M.y,Ee=this._containerLeft=-Math.round(this._containerWidth/2)+M.x;this._container.style.bottom=ie+"px",this._container.style.left=Ee+"px"}},_getAnchor:function(){return[0,0]}});Oi.include({_initOverlay:function(y,M,V,ie){var Ee=M;return Ee instanceof y||(Ee=new y(ie).setContent(M)),V&&Ee.setLatLng(V),Ee}}),vr.include({_initOverlay:function(y,M,V,ie){var Ee=V;return Ee instanceof y?(se(Ee,ie),Ee._source=this):(Ee=M&&!ie?M:new y(ie,this),Ee.setContent(V)),Ee}});var ju=Ss.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(y){return y=arguments.length?y:this._source._map,!y.hasLayer(this)&&y._popup&&y._popup.options.autoClose&&y.removeLayer(y._popup),y._popup=this,Ss.prototype.openOn.call(this,y)},onAdd:function(y){Ss.prototype.onAdd.call(this,y),y.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ul||this._source.on("preclick",Eo))},onRemove:function(y){Ss.prototype.onRemove.call(this,y),y.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ul||this._source.off("preclick",Eo))},getEvents:function(){var y=Ss.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(y.preclick=this.close),this.options.keepInView&&(y.moveend=this._adjustPan),y},_initLayout:function(){var y="leaflet-popup",M=this._container=Xn("div",y+" "+(this.options.className||"")+" leaflet-zoom-animated"),V=this._wrapper=Xn("div",y+"-content-wrapper",M);if(this._contentNode=Xn("div",y+"-content",V),cr(M),Bo(this._contentNode),Hr(M,"contextmenu",Eo),this._tipContainer=Xn("div",y+"-tip-container",M),this._tip=Xn("div",y+"-tip",this._tipContainer),this.options.closeButton){var ie=this._closeButton=Xn("a",y+"-close-button",M);ie.setAttribute("role","button"),ie.setAttribute("aria-label","Close popup"),ie.href="#close",ie.innerHTML='<span aria-hidden="true">&#215;</span>',Hr(ie,"click",function(Ee){co(Ee),this.close()},this)}},_updateLayout:function(){var y=this._contentNode,M=y.style;M.width="",M.whiteSpace="nowrap";var V=y.offsetWidth;V=Math.min(V,this.options.maxWidth),V=Math.max(V,this.options.minWidth),M.width=V+1+"px",M.whiteSpace="",M.height="";var ie=y.offsetHeight,Ee=this.options.maxHeight,Ge="leaflet-popup-scrolled";Ee&&ie>Ee?(M.height=Ee+"px",yr(y,Ge)):wi(y,Ge),this._containerWidth=this._container.offsetWidth},_animateZoom:function(y){var M=this._map._latLngToNewLayerPoint(this._latlng,y.zoom,y.center),V=this._getAnchor();fn(this._container,M.add(V))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var y=this._map,M=parseInt(Zi(this._container,"marginBottom"),10)||0,V=this._container.offsetHeight+M,ie=this._containerWidth,Ee=new et(this._containerLeft,-V-this._containerBottom);Ee._add(Cn(this._container));var Ge=y.layerPointToContainerPoint(Ee),Pt=Ot(this.options.autoPanPadding),on=Ot(this.options.autoPanPaddingTopLeft||Pt),dn=Ot(this.options.autoPanPaddingBottomRight||Pt),Rn=y.getSize(),hr=0,Jr=0;Ge.x+ie+dn.x>Rn.x&&(hr=Ge.x+ie-Rn.x+dn.x),Ge.x-hr-on.x<0&&(hr=Ge.x-on.x),Ge.y+V+dn.y>Rn.y&&(Jr=Ge.y+V-Rn.y+dn.y),Ge.y-Jr-on.y<0&&(Jr=Ge.y-on.y),(hr||Jr)&&(this.options.keepInView&&(this._autopanning=!0),y.fire("autopanstart").panBy([hr,Jr]))}},_getAnchor:function(){return Ot(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ls=function(y,M){return new ju(y,M)};Oi.mergeOptions({closePopupOnClick:!0}),Oi.include({openPopup:function(y,M,V){return this._initOverlay(ju,y,M,V).openOn(this),this},closePopup:function(y){return y=arguments.length?y:this._popup,y&&y.close(),this}}),vr.include({bindPopup:function(y,M){return this._popup=this._initOverlay(ju,this._popup,y,M),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(y){return this._popup&&(this instanceof zi||(this._popup._source=this),this._popup._prepareOpen(y||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(y){return this._popup&&this._popup.setContent(y),this},getPopup:function(){return this._popup},_openPopup:function(y){if(!(!this._popup||!this._map)){ua(y);var M=y.layer||y.target;if(this._popup._source===M&&!(M instanceof Ul)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(y.latlng);return}this._popup._source=M,this.openPopup(y.latlng)}},_movePopup:function(y){this._popup.setLatLng(y.latlng)},_onKeyPress:function(y){y.originalEvent.keyCode===13&&this._openPopup(y)}});var Ds=Ss.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(y){Ss.prototype.onAdd.call(this,y),this.setOpacity(this.options.opacity),y.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(y){Ss.prototype.onRemove.call(this,y),y.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var y=Ss.prototype.getEvents.call(this);return this.options.permanent||(y.preclick=this.close),y},_initLayout:function(){var y="leaflet-tooltip",M=y+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Xn("div",M),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+I(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(y){var M,V,ie=this._map,Ee=this._container,Ge=ie.latLngToContainerPoint(ie.getCenter()),Pt=ie.layerPointToContainerPoint(y),on=this.options.direction,dn=Ee.offsetWidth,Rn=Ee.offsetHeight,hr=Ot(this.options.offset),Jr=this._getAnchor();on==="top"?(M=dn/2,V=Rn):on==="bottom"?(M=dn/2,V=0):on==="center"?(M=dn/2,V=Rn/2):on==="right"?(M=0,V=Rn/2):on==="left"?(M=dn,V=Rn/2):Pt.x<Ge.x?(on="right",M=0,V=Rn/2):(on="left",M=dn+(hr.x+Jr.x)*2,V=Rn/2),y=y.subtract(Ot(M,V,!0)).add(hr).add(Jr),wi(Ee,"leaflet-tooltip-right"),wi(Ee,"leaflet-tooltip-left"),wi(Ee,"leaflet-tooltip-top"),wi(Ee,"leaflet-tooltip-bottom"),yr(Ee,"leaflet-tooltip-"+on),fn(Ee,y)},_updatePosition:function(){var y=this._map.latLngToLayerPoint(this._latlng);this._setPosition(y)},setOpacity:function(y){this.options.opacity=y,this._container&&We(this._container,y)},_animateZoom:function(y){var M=this._map._latLngToNewLayerPoint(this._latlng,y.zoom,y.center);this._setPosition(M)},_getAnchor:function(){return Ot(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),ti=function(y,M){return new Ds(y,M)};Oi.include({openTooltip:function(y,M,V){return this._initOverlay(Ds,y,M,V).openOn(this),this},closeTooltip:function(y){return y.close(),this}}),vr.include({bindTooltip:function(y,M){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ds,this._tooltip,y,M),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(y){if(!(!y&&this._tooltipHandlersAdded)){var M=y?"off":"on",V={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?V.add=this._openTooltip:(V.mouseover=this._openTooltip,V.mouseout=this.closeTooltip,V.click=this._openTooltip,this._map?this._addFocusListeners():V.add=this._addFocusListeners),this._tooltip.options.sticky&&(V.mousemove=this._moveTooltip),this[M](V),this._tooltipHandlersAdded=!y}},openTooltip:function(y){return this._tooltip&&(this instanceof zi||(this._tooltip._source=this),this._tooltip._prepareOpen(y)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(y){return this._tooltip&&this._tooltip.setContent(y),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(y){var M=typeof y.getElement=="function"&&y.getElement();M&&(Hr(M,"focus",function(){this._tooltip._source=y,this.openTooltip()},this),Hr(M,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(y){var M=typeof y.getElement=="function"&&y.getElement();M&&M.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(y){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var M=this;this._map.once("moveend",function(){M._openOnceFlag=!1,M._openTooltip(y)});return}this._tooltip._source=y.layer||y.target,this.openTooltip(this._tooltip.options.sticky?y.latlng:void 0)}},_moveTooltip:function(y){var M=y.latlng,V,ie;this._tooltip.options.sticky&&y.originalEvent&&(V=this._map.mouseEventToContainerPoint(y.originalEvent),ie=this._map.containerPointToLayerPoint(V),M=this._map.layerPointToLatLng(ie)),this._tooltip.setLatLng(M)}});var Gl=jo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(y){var M=y&&y.tagName==="DIV"?y:document.createElement("div"),V=this.options;if(V.html instanceof Element?(xa(M),M.appendChild(V.html)):M.innerHTML=V.html!==!1?V.html:"",V.bgPos){var ie=Ot(V.bgPos);M.style.backgroundPosition=-ie.x+"px "+-ie.y+"px"}return this._setIconStyles(M,"icon"),M},createShadow:function(){return null}});function fc(y){return new Gl(y)}jo.Default=Oa;var pl=vr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ae.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(y){se(this,y)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(y){y._addZoomLimit(this)},onRemove:function(y){this._removeAllTiles(),Gr(this._container),y._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(lo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(uo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(y){return this.options.opacity=y,this._updateOpacity(),this},setZIndex:function(y){return this.options.zIndex=y,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var y=this._clampZoom(this._map.getZoom());y!==this._tileZoom&&(this._tileZoom=y,this._updateLevels()),this._update()}return this},getEvents:function(){var y={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=B(this._onMoveEnd,this.options.updateInterval,this)),y.move=this._onMove),this._zoomAnimated&&(y.zoomanim=this._animateZoom),y},createTile:function(){return document.createElement("div")},getTileSize:function(){var y=this.options.tileSize;return y instanceof et?y:new et(y,y)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(y){for(var M=this.getPane().children,V=-y(-1/0,1/0),ie=0,Ee=M.length,Ge;ie<Ee;ie++)Ge=M[ie].style.zIndex,M[ie]!==this._container&&Ge&&(V=y(V,+Ge));isFinite(V)&&(this.options.zIndex=V+y(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ae.ielt9){We(this._container,this.options.opacity);var y=+new Date,M=!1,V=!1;for(var ie in this._tiles){var Ee=this._tiles[ie];if(!(!Ee.current||!Ee.loaded)){var Ge=Math.min(1,(y-Ee.loaded)/200);We(Ee.el,Ge),Ge<1?M=!0:(Ee.active?V=!0:this._onOpaqueTile(Ee),Ee.active=!0)}}V&&!this._noPrune&&this._pruneTiles(),M&&(St(this._fadeFrame),this._fadeFrame=Je(this._updateOpacity,this))}},_onOpaqueTile:U,_initContainer:function(){this._container||(this._container=Xn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var y=this._tileZoom,M=this.options.maxZoom;if(y!==void 0){for(var V in this._levels)V=Number(V),this._levels[V].el.children.length||V===y?(this._levels[V].el.style.zIndex=M-Math.abs(y-V),this._onUpdateLevel(V)):(Gr(this._levels[V].el),this._removeTilesAtZoom(V),this._onRemoveLevel(V),delete this._levels[V]);var ie=this._levels[y],Ee=this._map;return ie||(ie=this._levels[y]={},ie.el=Xn("div","leaflet-tile-container leaflet-zoom-animated",this._container),ie.el.style.zIndex=M,ie.origin=Ee.project(Ee.unproject(Ee.getPixelOrigin()),y).round(),ie.zoom=y,this._setZoomTransform(ie,Ee.getCenter(),Ee.getZoom()),U(ie.el.offsetWidth),this._onCreateLevel(ie)),this._level=ie,ie}},_onUpdateLevel:U,_onRemoveLevel:U,_onCreateLevel:U,_pruneTiles:function(){if(this._map){var y,M,V=this._map.getZoom();if(V>this.options.maxZoom||V<this.options.minZoom){this._removeAllTiles();return}for(y in this._tiles)M=this._tiles[y],M.retain=M.current;for(y in this._tiles)if(M=this._tiles[y],M.current&&!M.active){var ie=M.coords;this._retainParent(ie.x,ie.y,ie.z,ie.z-5)||this._retainChildren(ie.x,ie.y,ie.z,ie.z+2)}for(y in this._tiles)this._tiles[y].retain||this._removeTile(y)}},_removeTilesAtZoom:function(y){for(var M in this._tiles)this._tiles[M].coords.z===y&&this._removeTile(M)},_removeAllTiles:function(){for(var y in this._tiles)this._removeTile(y)},_invalidateAll:function(){for(var y in this._levels)Gr(this._levels[y].el),this._onRemoveLevel(Number(y)),delete this._levels[y];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(y,M,V,ie){var Ee=Math.floor(y/2),Ge=Math.floor(M/2),Pt=V-1,on=new et(+Ee,+Ge);on.z=+Pt;var dn=this._tileCoordsToKey(on),Rn=this._tiles[dn];return Rn&&Rn.active?(Rn.retain=!0,!0):(Rn&&Rn.loaded&&(Rn.retain=!0),Pt>ie?this._retainParent(Ee,Ge,Pt,ie):!1)},_retainChildren:function(y,M,V,ie){for(var Ee=2*y;Ee<2*y+2;Ee++)for(var Ge=2*M;Ge<2*M+2;Ge++){var Pt=new et(Ee,Ge);Pt.z=V+1;var on=this._tileCoordsToKey(Pt),dn=this._tiles[on];if(dn&&dn.active){dn.retain=!0;continue}else dn&&dn.loaded&&(dn.retain=!0);V+1<ie&&this._retainChildren(Ee,Ge,V+1,ie)}},_resetView:function(y){var M=y&&(y.pinch||y.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),M,M)},_animateZoom:function(y){this._setView(y.center,y.zoom,!0,y.noUpdate)},_clampZoom:function(y){var M=this.options;return M.minNativeZoom!==void 0&&y<M.minNativeZoom?M.minNativeZoom:M.maxNativeZoom!==void 0&&M.maxNativeZoom<y?M.maxNativeZoom:y},_setView:function(y,M,V,ie){var Ee=Math.round(M);this.options.maxZoom!==void 0&&Ee>this.options.maxZoom||this.options.minZoom!==void 0&&Ee<this.options.minZoom?Ee=void 0:Ee=this._clampZoom(Ee);var Ge=this.options.updateWhenZooming&&Ee!==this._tileZoom;(!ie||Ge)&&(this._tileZoom=Ee,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Ee!==void 0&&this._update(y),V||this._pruneTiles(),this._noPrune=!!V),this._setZoomTransforms(y,M)},_setZoomTransforms:function(y,M){for(var V in this._levels)this._setZoomTransform(this._levels[V],y,M)},_setZoomTransform:function(y,M,V){var ie=this._map.getZoomScale(V,y.zoom),Ee=y.origin.multiplyBy(ie).subtract(this._map._getNewPixelOrigin(M,V)).round();Ae.any3d?Zt(y.el,Ee,ie):fn(y.el,Ee)},_resetGrid:function(){var y=this._map,M=y.options.crs,V=this._tileSize=this.getTileSize(),ie=this._tileZoom,Ee=this._map.getPixelWorldBounds(this._tileZoom);Ee&&(this._globalTileRange=this._pxBoundsToTileRange(Ee)),this._wrapX=M.wrapLng&&!this.options.noWrap&&[Math.floor(y.project([0,M.wrapLng[0]],ie).x/V.x),Math.ceil(y.project([0,M.wrapLng[1]],ie).x/V.y)],this._wrapY=M.wrapLat&&!this.options.noWrap&&[Math.floor(y.project([M.wrapLat[0],0],ie).y/V.x),Math.ceil(y.project([M.wrapLat[1],0],ie).y/V.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(y){var M=this._map,V=M._animatingZoom?Math.max(M._animateToZoom,M.getZoom()):M.getZoom(),ie=M.getZoomScale(V,this._tileZoom),Ee=M.project(y,this._tileZoom).floor(),Ge=M.getSize().divideBy(ie*2);return new mt(Ee.subtract(Ge),Ee.add(Ge))},_update:function(y){var M=this._map;if(M){var V=this._clampZoom(M.getZoom());if(y===void 0&&(y=M.getCenter()),this._tileZoom!==void 0){var ie=this._getTiledPixelBounds(y),Ee=this._pxBoundsToTileRange(ie),Ge=Ee.getCenter(),Pt=[],on=this.options.keepBuffer,dn=new mt(Ee.getBottomLeft().subtract([on,-on]),Ee.getTopRight().add([on,-on]));if(!(isFinite(Ee.min.x)&&isFinite(Ee.min.y)&&isFinite(Ee.max.x)&&isFinite(Ee.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Rn in this._tiles){var hr=this._tiles[Rn].coords;(hr.z!==this._tileZoom||!dn.contains(new et(hr.x,hr.y)))&&(this._tiles[Rn].current=!1)}if(Math.abs(V-this._tileZoom)>1){this._setView(y,V);return}for(var Jr=Ee.min.y;Jr<=Ee.max.y;Jr++)for(var Ii=Ee.min.x;Ii<=Ee.max.x;Ii++){var ja=new et(Ii,Jr);if(ja.z=this._tileZoom,!!this._isValidTile(ja)){var Ko=this._tiles[this._tileCoordsToKey(ja)];Ko?Ko.current=!0:Pt.push(ja)}}if(Pt.sort(function(fs,qu){return fs.distanceTo(Ge)-qu.distanceTo(Ge)}),Pt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Fs=document.createDocumentFragment();for(Ii=0;Ii<Pt.length;Ii++)this._addTile(Pt[Ii],Fs);this._level.el.appendChild(Fs)}}}},_isValidTile:function(y){var M=this._map.options.crs;if(!M.infinite){var V=this._globalTileRange;if(!M.wrapLng&&(y.x<V.min.x||y.x>V.max.x)||!M.wrapLat&&(y.y<V.min.y||y.y>V.max.y))return!1}if(!this.options.bounds)return!0;var ie=this._tileCoordsToBounds(y);return Un(this.options.bounds).overlaps(ie)},_keyToBounds:function(y){return this._tileCoordsToBounds(this._keyToTileCoords(y))},_tileCoordsToNwSe:function(y){var M=this._map,V=this.getTileSize(),ie=y.scaleBy(V),Ee=ie.add(V),Ge=M.unproject(ie,y.z),Pt=M.unproject(Ee,y.z);return[Ge,Pt]},_tileCoordsToBounds:function(y){var M=this._tileCoordsToNwSe(y),V=new Jt(M[0],M[1]);return this.options.noWrap||(V=this._map.wrapLatLngBounds(V)),V},_tileCoordsToKey:function(y){return y.x+":"+y.y+":"+y.z},_keyToTileCoords:function(y){var M=y.split(":"),V=new et(+M[0],+M[1]);return V.z=+M[2],V},_removeTile:function(y){var M=this._tiles[y];M&&(Gr(M.el),delete this._tiles[y],this.fire("tileunload",{tile:M.el,coords:this._keyToTileCoords(y)}))},_initTile:function(y){yr(y,"leaflet-tile");var M=this.getTileSize();y.style.width=M.x+"px",y.style.height=M.y+"px",y.onselectstart=U,y.onmousemove=U,Ae.ielt9&&this.options.opacity<1&&We(y,this.options.opacity)},_addTile:function(y,M){var V=this._getTilePos(y),ie=this._tileCoordsToKey(y),Ee=this.createTile(this._wrapCoords(y),S(this._tileReady,this,y));this._initTile(Ee),this.createTile.length<2&&Je(S(this._tileReady,this,y,null,Ee)),fn(Ee,V),this._tiles[ie]={el:Ee,coords:y,current:!0},M.appendChild(Ee),this.fire("tileloadstart",{tile:Ee,coords:y})},_tileReady:function(y,M,V){M&&this.fire("tileerror",{error:M,tile:V,coords:y});var ie=this._tileCoordsToKey(y);V=this._tiles[ie],V&&(V.loaded=+new Date,this._map._fadeAnimated?(We(V.el,0),St(this._fadeFrame),this._fadeFrame=Je(this._updateOpacity,this)):(V.active=!0,this._pruneTiles()),M||(yr(V.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:V.el,coords:y})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ae.ielt9||!this._map._fadeAnimated?Je(this._pruneTiles,this):setTimeout(S(this._pruneTiles,this),250)))},_getTilePos:function(y){return y.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(y){var M=new et(this._wrapX?$(y.x,this._wrapX):y.x,this._wrapY?$(y.y,this._wrapY):y.y);return M.z=y.z,M},_pxBoundsToTileRange:function(y){var M=this.getTileSize();return new mt(y.min.unscaleBy(M).floor(),y.max.unscaleBy(M).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var y in this._tiles)if(!this._tiles[y].loaded)return!1;return!0}});function Tl(y){return new pl(y)}var zs=pl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(y,M){this._url=y,M=se(this,M),M.detectRetina&&Ae.retina&&M.maxZoom>0?(M.tileSize=Math.floor(M.tileSize/2),M.zoomReverse?(M.zoomOffset--,M.minZoom=Math.min(M.maxZoom,M.minZoom+1)):(M.zoomOffset++,M.maxZoom=Math.max(M.minZoom,M.maxZoom-1)),M.minZoom=Math.max(0,M.minZoom)):M.zoomReverse?M.minZoom=Math.min(M.maxZoom,M.minZoom):M.maxZoom=Math.max(M.minZoom,M.maxZoom),typeof M.subdomains=="string"&&(M.subdomains=M.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(y,M){return this._url===y&&M===void 0&&(M=!0),this._url=y,M||this.redraw(),this},createTile:function(y,M){var V=document.createElement("img");return Hr(V,"load",S(this._tileOnLoad,this,M,V)),Hr(V,"error",S(this._tileOnError,this,M,V)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(V.referrerPolicy=this.options.referrerPolicy),V.alt="",V.src=this.getTileUrl(y),V},getTileUrl:function(y){var M={r:Ae.retina?"@2x":"",s:this._getSubdomain(y),x:y.x,y:y.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var V=this._globalTileRange.max.y-y.y;this.options.tms&&(M.y=V),M["-y"]=V}return Ce(this._url,h(M,this.options))},_tileOnLoad:function(y,M){Ae.ielt9?setTimeout(S(y,this,null,M),0):y(null,M)},_tileOnError:function(y,M,V){var ie=this.options.errorTileUrl;ie&&M.getAttribute("src")!==ie&&(M.src=ie),y(V,M)},_onTileRemove:function(y){y.tile.onload=null},_getZoomForUrl:function(){var y=this._tileZoom,M=this.options.maxZoom,V=this.options.zoomReverse,ie=this.options.zoomOffset;return V&&(y=M-y),y+ie},_getSubdomain:function(y){var M=Math.abs(y.x+y.y)%this.options.subdomains.length;return this.options.subdomains[M]},_abortLoading:function(){var y,M;for(y in this._tiles)if(this._tiles[y].coords.z!==this._tileZoom&&(M=this._tiles[y].el,M.onload=U,M.onerror=U,!M.complete)){M.src=ve;var V=this._tiles[y].coords;Gr(M),delete this._tiles[y],this.fire("tileabort",{tile:M,coords:V})}},_removeTile:function(y){var M=this._tiles[y];if(M)return M.el.setAttribute("src",ve),pl.prototype._removeTile.call(this,y)},_tileReady:function(y,M,V){if(!(!this._map||V&&V.getAttribute("src")===ve))return pl.prototype._tileReady.call(this,y,M,V)}});function Bi(y,M){return new zs(y,M)}var $u=zs.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(y,M){this._url=y;var V=h({},this.defaultWmsParams);for(var ie in M)ie in this.options||(V[ie]=M[ie]);M=se(this,M);var Ee=M.detectRetina&&Ae.retina?2:1,Ge=this.getTileSize();V.width=Ge.x*Ee,V.height=Ge.y*Ee,this.wmsParams=V},onAdd:function(y){this._crs=this.options.crs||y.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var M=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[M]=this._crs.code,zs.prototype.onAdd.call(this,y)},getTileUrl:function(y){var M=this._tileCoordsToNwSe(y),V=this._crs,ie=zt(V.project(M[0]),V.project(M[1])),Ee=ie.min,Ge=ie.max,Pt=(this._wmsVersion>=1.3&&this._crs===wn?[Ee.y,Ee.x,Ge.y,Ge.x]:[Ee.x,Ee.y,Ge.x,Ge.y]).join(","),on=zs.prototype.getTileUrl.call(this,y);return on+ue(this.wmsParams,on,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Pt},setParams:function(y,M){return h(this.wmsParams,y),M||this.redraw(),this}});function mf(y,M){return new $u(y,M)}zs.WMS=$u,Bi.wms=mf;var Js=vr.extend({options:{padding:.1},initialize:function(y){se(this,y),I(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yr(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var y={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(y.zoomanim=this._onAnimZoom),y},_onAnimZoom:function(y){this._updateTransform(y.center,y.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(y,M){var V=this._map.getZoomScale(M,this._zoom),ie=this._map.getSize().multiplyBy(.5+this.options.padding),Ee=this._map.project(this._center,M),Ge=ie.multiplyBy(-V).add(Ee).subtract(this._map._getNewPixelOrigin(y,M));Ae.any3d?Zt(this._container,Ge,V):fn(this._container,Ge)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var y in this._layers)this._layers[y]._reset()},_onZoomEnd:function(){for(var y in this._layers)this._layers[y]._project()},_updatePaths:function(){for(var y in this._layers)this._layers[y]._update()},_update:function(){var y=this.options.padding,M=this._map.getSize(),V=this._map.containerPointToLayerPoint(M.multiplyBy(-y)).round();this._bounds=new mt(V,V.add(M.multiplyBy(1+y*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),dc=Js.extend({options:{tolerance:0},getEvents:function(){var y=Js.prototype.getEvents.call(this);return y.viewprereset=this._onViewPreReset,y},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Js.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var y=this._container=document.createElement("canvas");Hr(y,"mousemove",this._onMouseMove,this),Hr(y,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Hr(y,"mouseout",this._handleMouseOut,this),y._leaflet_disable_events=!0,this._ctx=y.getContext("2d")},_destroyContainer:function(){St(this._redrawRequest),delete this._ctx,Gr(this._container),no(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var y;this._redrawBounds=null;for(var M in this._layers)y=this._layers[M],y._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Js.prototype._update.call(this);var y=this._bounds,M=this._container,V=y.getSize(),ie=Ae.retina?2:1;fn(M,y.min),M.width=ie*V.x,M.height=ie*V.y,M.style.width=V.x+"px",M.style.height=V.y+"px",Ae.retina&&this._ctx.scale(2,2),this._ctx.translate(-y.min.x,-y.min.y),this.fire("update")}},_reset:function(){Js.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(y){this._updateDashArray(y),this._layers[I(y)]=y;var M=y._order={layer:y,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=M),this._drawLast=M,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(y){this._requestRedraw(y)},_removePath:function(y){var M=y._order,V=M.next,ie=M.prev;V?V.prev=ie:this._drawLast=ie,ie?ie.next=V:this._drawFirst=V,delete y._order,delete this._layers[I(y)],this._requestRedraw(y)},_updatePath:function(y){this._extendRedrawBounds(y),y._project(),y._update(),this._requestRedraw(y)},_updateStyle:function(y){this._updateDashArray(y),this._requestRedraw(y)},_updateDashArray:function(y){if(typeof y.options.dashArray=="string"){var M=y.options.dashArray.split(/[, ]+/),V=[],ie,Ee;for(Ee=0;Ee<M.length;Ee++){if(ie=Number(M[Ee]),isNaN(ie))return;V.push(ie)}y.options._dashArray=V}else y.options._dashArray=y.options.dashArray},_requestRedraw:function(y){this._map&&(this._extendRedrawBounds(y),this._redrawRequest=this._redrawRequest||Je(this._redraw,this))},_extendRedrawBounds:function(y){if(y._pxBounds){var M=(y.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new mt,this._redrawBounds.extend(y._pxBounds.min.subtract([M,M])),this._redrawBounds.extend(y._pxBounds.max.add([M,M]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var y=this._redrawBounds;if(y){var M=y.getSize();this._ctx.clearRect(y.min.x,y.min.y,M.x,M.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var y,M=this._redrawBounds;if(this._ctx.save(),M){var V=M.getSize();this._ctx.beginPath(),this._ctx.rect(M.min.x,M.min.y,V.x,V.y),this._ctx.clip()}this._drawing=!0;for(var ie=this._drawFirst;ie;ie=ie.next)y=ie.layer,(!M||y._pxBounds&&y._pxBounds.intersects(M))&&y._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(y,M){if(this._drawing){var V,ie,Ee,Ge,Pt=y._parts,on=Pt.length,dn=this._ctx;if(on){for(dn.beginPath(),V=0;V<on;V++){for(ie=0,Ee=Pt[V].length;ie<Ee;ie++)Ge=Pt[V][ie],dn[ie?"lineTo":"moveTo"](Ge.x,Ge.y);M&&dn.closePath()}this._fillStroke(dn,y)}}},_updateCircle:function(y){if(!(!this._drawing||y._empty())){var M=y._point,V=this._ctx,ie=Math.max(Math.round(y._radius),1),Ee=(Math.max(Math.round(y._radiusY),1)||ie)/ie;Ee!==1&&(V.save(),V.scale(1,Ee)),V.beginPath(),V.arc(M.x,M.y/Ee,ie,0,Math.PI*2,!1),Ee!==1&&V.restore(),this._fillStroke(V,y)}},_fillStroke:function(y,M){var V=M.options;V.fill&&(y.globalAlpha=V.fillOpacity,y.fillStyle=V.fillColor||V.color,y.fill(V.fillRule||"evenodd")),V.stroke&&V.weight!==0&&(y.setLineDash&&y.setLineDash(M.options&&M.options._dashArray||[]),y.globalAlpha=V.opacity,y.lineWidth=V.weight,y.strokeStyle=V.color,y.lineCap=V.lineCap,y.lineJoin=V.lineJoin,y.stroke())},_onClick:function(y){for(var M=this._map.mouseEventToLayerPoint(y),V,ie,Ee=this._drawFirst;Ee;Ee=Ee.next)V=Ee.layer,V.options.interactive&&V._containsPoint(M)&&(!(y.type==="click"||y.type==="preclick")||!this._map._draggableMoved(V))&&(ie=V);this._fireEvent(ie?[ie]:!1,y)},_onMouseMove:function(y){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var M=this._map.mouseEventToLayerPoint(y);this._handleMouseHover(y,M)}},_handleMouseOut:function(y){var M=this._hoveredLayer;M&&(wi(this._container,"leaflet-interactive"),this._fireEvent([M],y,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(y,M){if(!this._mouseHoverThrottled){for(var V,ie,Ee=this._drawFirst;Ee;Ee=Ee.next)V=Ee.layer,V.options.interactive&&V._containsPoint(M)&&(ie=V);ie!==this._hoveredLayer&&(this._handleMouseOut(y),ie&&(yr(this._container,"leaflet-interactive"),this._fireEvent([ie],y,"mouseover"),this._hoveredLayer=ie)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,y),this._mouseHoverThrottled=!0,setTimeout(S(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(y,M,V){this._map._fireDOMEvent(M,V||M.type,y)},_bringToFront:function(y){var M=y._order;if(M){var V=M.next,ie=M.prev;if(V)V.prev=ie;else return;ie?ie.next=V:V&&(this._drawFirst=V),M.prev=this._drawLast,this._drawLast.next=M,M.next=null,this._drawLast=M,this._requestRedraw(y)}},_bringToBack:function(y){var M=y._order;if(M){var V=M.next,ie=M.prev;if(ie)ie.next=V;else return;V?V.prev=ie:ie&&(this._drawLast=ie),M.prev=null,M.next=this._drawFirst,this._drawFirst.prev=M,this._drawFirst=M,this._requestRedraw(y)}}});function Uu(y){return Ae.canvas?new dc(y):null}var Vu=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(y){return document.createElement("<lvml:"+y+' class="lvml">')}}catch{}return function(y){return document.createElement("<"+y+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),gf={_initContainer:function(){this._container=Xn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Js.prototype._update.call(this),this.fire("update"))},_initPath:function(y){var M=y._container=Vu("shape");yr(M,"leaflet-vml-shape "+(this.options.className||"")),M.coordsize="1 1",y._path=Vu("path"),M.appendChild(y._path),this._updateStyle(y),this._layers[I(y)]=y},_addPath:function(y){var M=y._container;this._container.appendChild(M),y.options.interactive&&y.addInteractiveTarget(M)},_removePath:function(y){var M=y._container;Gr(M),y.removeInteractiveTarget(M),delete this._layers[I(y)]},_updateStyle:function(y){var M=y._stroke,V=y._fill,ie=y.options,Ee=y._container;Ee.stroked=!!ie.stroke,Ee.filled=!!ie.fill,ie.stroke?(M||(M=y._stroke=Vu("stroke")),Ee.appendChild(M),M.weight=ie.weight+"px",M.color=ie.color,M.opacity=ie.opacity,ie.dashArray?M.dashStyle=Re(ie.dashArray)?ie.dashArray.join(" "):ie.dashArray.replace(/( *, *)/g," "):M.dashStyle="",M.endcap=ie.lineCap.replace("butt","flat"),M.joinstyle=ie.lineJoin):M&&(Ee.removeChild(M),y._stroke=null),ie.fill?(V||(V=y._fill=Vu("fill")),Ee.appendChild(V),V.color=ie.fillColor||ie.color,V.opacity=ie.fillOpacity):V&&(Ee.removeChild(V),y._fill=null)},_updateCircle:function(y){var M=y._point.round(),V=Math.round(y._radius),ie=Math.round(y._radiusY||V);this._setPath(y,y._empty()?"M0 0":"AL "+M.x+","+M.y+" "+V+","+ie+" 0,"+65535*360)},_setPath:function(y,M){y._path.v=M},_bringToFront:function(y){lo(y._container)},_bringToBack:function(y){uo(y._container)}},Qs=Ae.vml?Vu:Mr,el=Js.extend({_initContainer:function(){this._container=Qs("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Qs("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Gr(this._container),no(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Js.prototype._update.call(this);var y=this._bounds,M=y.getSize(),V=this._container;(!this._svgSize||!this._svgSize.equals(M))&&(this._svgSize=M,V.setAttribute("width",M.x),V.setAttribute("height",M.y)),fn(V,y.min),V.setAttribute("viewBox",[y.min.x,y.min.y,M.x,M.y].join(" ")),this.fire("update")}},_initPath:function(y){var M=y._path=Qs("path");y.options.className&&yr(M,y.options.className),y.options.interactive&&yr(M,"leaflet-interactive"),this._updateStyle(y),this._layers[I(y)]=y},_addPath:function(y){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(y._path),y.addInteractiveTarget(y._path)},_removePath:function(y){Gr(y._path),y.removeInteractiveTarget(y._path),delete this._layers[I(y)]},_updatePath:function(y){y._project(),y._update()},_updateStyle:function(y){var M=y._path,V=y.options;M&&(V.stroke?(M.setAttribute("stroke",V.color),M.setAttribute("stroke-opacity",V.opacity),M.setAttribute("stroke-width",V.weight),M.setAttribute("stroke-linecap",V.lineCap),M.setAttribute("stroke-linejoin",V.lineJoin),V.dashArray?M.setAttribute("stroke-dasharray",V.dashArray):M.removeAttribute("stroke-dasharray"),V.dashOffset?M.setAttribute("stroke-dashoffset",V.dashOffset):M.removeAttribute("stroke-dashoffset")):M.setAttribute("stroke","none"),V.fill?(M.setAttribute("fill",V.fillColor||V.color),M.setAttribute("fill-opacity",V.fillOpacity),M.setAttribute("fill-rule",V.fillRule||"evenodd")):M.setAttribute("fill","none"))},_updatePoly:function(y,M){this._setPath(y,Qn(y._parts,M))},_updateCircle:function(y){var M=y._point,V=Math.max(Math.round(y._radius),1),ie=Math.max(Math.round(y._radiusY),1)||V,Ee="a"+V+","+ie+" 0 1,0 ",Ge=y._empty()?"M0 0":"M"+(M.x-V)+","+M.y+Ee+V*2+",0 "+Ee+-V*2+",0 ";this._setPath(y,Ge)},_setPath:function(y,M){y._path.setAttribute("d",M)},_bringToFront:function(y){lo(y._path)},_bringToBack:function(y){uo(y._path)}});Ae.vml&&el.include(gf);function rh(y){return Ae.svg||Ae.vml?new el(y):null}Oi.include({getRenderer:function(y){var M=y.options.renderer||this._getPaneRenderer(y.options.pane)||this.options.renderer||this._renderer;return M||(M=this._renderer=this._createRenderer()),this.hasLayer(M)||this.addLayer(M),M},_getPaneRenderer:function(y){if(y==="overlayPane"||y===void 0)return!1;var M=this._paneRenderers[y];return M===void 0&&(M=this._createRenderer({pane:y}),this._paneRenderers[y]=M),M},_createRenderer:function(y){return this.options.preferCanvas&&Uu(y)||rh(y)}});var ad=da.extend({initialize:function(y,M){da.prototype.initialize.call(this,this._boundsToLatLngs(y),M)},setBounds:function(y){return this.setLatLngs(this._boundsToLatLngs(y))},_boundsToLatLngs:function(y){return y=Un(y),[y.getSouthWest(),y.getNorthWest(),y.getNorthEast(),y.getSouthEast()]}});function tp(y,M){return new ad(y,M)}el.create=Qs,el.pointsToPath=Qn,hs.geometryToLayer=Fu,hs.coordsToLatLng=ns,hs.coordsToLatLngs=uc,hs.latLngToCoords=cc,hs.latLngsToCoords=hc,hs.getFeature=ql,hs.asFeature=th,Oi.mergeOptions({boxZoom:!0});var pc=Xo.extend({initialize:function(y){this._map=y,this._container=y._container,this._pane=y._panes.overlayPane,this._resetStateTimeout=0,y.on("unload",this._destroy,this)},addHooks:function(){Hr(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){no(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Gr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(y){if(!y.shiftKey||y.which!==1&&y.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Gn(),So(),this._startPoint=this._map.mouseEventToContainerPoint(y),Hr(document,{contextmenu:ua,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(y){this._moved||(this._moved=!0,this._box=Xn("div","leaflet-zoom-box",this._container),yr(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(y);var M=new mt(this._point,this._startPoint),V=M.getSize();fn(this._box,M.min),this._box.style.width=V.x+"px",this._box.style.height=V.y+"px"},_finish:function(){this._moved&&(Gr(this._box),wi(this._container,"leaflet-crosshair")),Cr(),To(),no(document,{contextmenu:ua,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(y){if(!(y.which!==1&&y.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(S(this._resetState,this),0);var M=new Jt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(M).fire("boxzoomend",{boxZoomBounds:M})}},_onKeyDown:function(y){y.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Oi.addInitHook("addHandler","boxZoom",pc),Oi.mergeOptions({doubleClickZoom:!0});var Bh=Xo.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(y){var M=this._map,V=M.getZoom(),ie=M.options.zoomDelta,Ee=y.originalEvent.shiftKey?V-ie:V+ie;M.options.doubleClickZoom==="center"?M.setZoom(Ee):M.setZoomAround(y.containerPoint,Ee)}});Oi.addInitHook("addHandler","doubleClickZoom",Bh),Oi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ih=Xo.extend({addHooks:function(){if(!this._draggable){var y=this._map;this._draggable=new ra(y._mapPane,y._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),y.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),y.on("zoomend",this._onZoomEnd,this),y.whenReady(this._onZoomEnd,this))}yr(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){wi(this._map._container,"leaflet-grab"),wi(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var y=this._map;if(y._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var M=Un(this._map.options.maxBounds);this._offsetLimit=zt(this._map.latLngToContainerPoint(M.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(M.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;y.fire("movestart").fire("dragstart"),y.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(y){if(this._map.options.inertia){var M=this._lastTime=+new Date,V=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(V),this._times.push(M),this._prunePositions(M)}this._map.fire("move",y).fire("drag",y)},_prunePositions:function(y){for(;this._positions.length>1&&y-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var y=this._map.getSize().divideBy(2),M=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=M.subtract(y).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(y,M){return y-(y-M)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var y=this._draggable._newPos.subtract(this._draggable._startPos),M=this._offsetLimit;y.x<M.min.x&&(y.x=this._viscousLimit(y.x,M.min.x)),y.y<M.min.y&&(y.y=this._viscousLimit(y.y,M.min.y)),y.x>M.max.x&&(y.x=this._viscousLimit(y.x,M.max.x)),y.y>M.max.y&&(y.y=this._viscousLimit(y.y,M.max.y)),this._draggable._newPos=this._draggable._startPos.add(y)}},_onPreDragWrap:function(){var y=this._worldWidth,M=Math.round(y/2),V=this._initialWorldOffset,ie=this._draggable._newPos.x,Ee=(ie-M+V)%y+M-V,Ge=(ie+M+V)%y-M-V,Pt=Math.abs(Ee+V)<Math.abs(Ge+V)?Ee:Ge;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Pt},_onDragEnd:function(y){var M=this._map,V=M.options,ie=!V.inertia||y.noInertia||this._times.length<2;if(M.fire("dragend",y),ie)M.fire("moveend");else{this._prunePositions(+new Date);var Ee=this._lastPos.subtract(this._positions[0]),Ge=(this._lastTime-this._times[0])/1e3,Pt=V.easeLinearity,on=Ee.multiplyBy(Pt/Ge),dn=on.distanceTo([0,0]),Rn=Math.min(V.inertiaMaxSpeed,dn),hr=on.multiplyBy(Rn/dn),Jr=Rn/(V.inertiaDeceleration*Pt),Ii=hr.multiplyBy(-Jr/2).round();!Ii.x&&!Ii.y?M.fire("moveend"):(Ii=M._limitOffset(Ii,M.options.maxBounds),Je(function(){M.panBy(Ii,{duration:Jr,easeLinearity:Pt,noMoveStart:!0,animate:!0})}))}}});Oi.addInitHook("addHandler","dragging",ih),Oi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oh=Xo.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(y){this._map=y,this._setPanDelta(y.options.keyboardPanDelta),this._setZoomDelta(y.options.zoomDelta)},addHooks:function(){var y=this._map._container;y.tabIndex<=0&&(y.tabIndex="0"),Hr(y,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),no(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var y=document.body,M=document.documentElement,V=y.scrollTop||M.scrollTop,ie=y.scrollLeft||M.scrollLeft;this._map._container.focus(),window.scrollTo(ie,V)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(y){var M=this._panKeys={},V=this.keyCodes,ie,Ee;for(ie=0,Ee=V.left.length;ie<Ee;ie++)M[V.left[ie]]=[-1*y,0];for(ie=0,Ee=V.right.length;ie<Ee;ie++)M[V.right[ie]]=[y,0];for(ie=0,Ee=V.down.length;ie<Ee;ie++)M[V.down[ie]]=[0,y];for(ie=0,Ee=V.up.length;ie<Ee;ie++)M[V.up[ie]]=[0,-1*y]},_setZoomDelta:function(y){var M=this._zoomKeys={},V=this.keyCodes,ie,Ee;for(ie=0,Ee=V.zoomIn.length;ie<Ee;ie++)M[V.zoomIn[ie]]=y;for(ie=0,Ee=V.zoomOut.length;ie<Ee;ie++)M[V.zoomOut[ie]]=-y},_addHooks:function(){Hr(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){no(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(y){if(!(y.altKey||y.ctrlKey||y.metaKey)){var M=y.keyCode,V=this._map,ie;if(M in this._panKeys){if(!V._panAnim||!V._panAnim._inProgress)if(ie=this._panKeys[M],y.shiftKey&&(ie=Ot(ie).multiplyBy(3)),V.options.maxBounds&&(ie=V._limitOffset(Ot(ie),V.options.maxBounds)),V.options.worldCopyJump){var Ee=V.wrapLatLng(V.unproject(V.project(V.getCenter()).add(ie)));V.panTo(Ee)}else V.panBy(ie)}else if(M in this._zoomKeys)V.setZoom(V.getZoom()+(y.shiftKey?3:1)*this._zoomKeys[M]);else if(M===27&&V._popup&&V._popup.options.closeOnEscapeKey)V.closePopup();else return;ua(y)}}});Oi.addInitHook("addHandler","keyboard",oh),Oi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vo=Xo.extend({addHooks:function(){Hr(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){no(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(y){var M=hl(y),V=this._map.options.wheelDebounceTime;this._delta+=M,this._lastMousePos=this._map.mouseEventToContainerPoint(y),this._startTime||(this._startTime=+new Date);var ie=Math.max(V-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(S(this._performZoom,this),ie),ua(y)},_performZoom:function(){var y=this._map,M=y.getZoom(),V=this._map.options.zoomSnap||0;y._stop();var ie=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Ee=4*Math.log(2/(1+Math.exp(-Math.abs(ie))))/Math.LN2,Ge=V?Math.ceil(Ee/V)*V:Ee,Pt=y._limitZoom(M+(this._delta>0?Ge:-Ge))-M;this._delta=0,this._startTime=null,Pt&&(y.options.scrollWheelZoom==="center"?y.setZoom(M+Pt):y.setZoomAround(this._lastMousePos,M+Pt))}});Oi.addInitHook("addHandler","scrollWheelZoom",vo);var Nh=600;Oi.mergeOptions({tapHold:Ae.touchNative&&Ae.safari&&Ae.mobile,tapTolerance:15});var mc=Xo.extend({addHooks:function(){Hr(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){no(this._map._container,"touchstart",this._onDown,this)},_onDown:function(y){if(clearTimeout(this._holdTimeout),y.touches.length===1){var M=y.touches[0];this._startPos=this._newPos=new et(M.clientX,M.clientY),this._holdTimeout=setTimeout(S(function(){this._cancel(),this._isTapValid()&&(Hr(document,"touchend",co),Hr(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",M))},this),Nh),Hr(document,"touchend touchcancel contextmenu",this._cancel,this),Hr(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function y(){no(document,"touchend",co),no(document,"touchend touchcancel",y)},_cancel:function(){clearTimeout(this._holdTimeout),no(document,"touchend touchcancel contextmenu",this._cancel,this),no(document,"touchmove",this._onMove,this)},_onMove:function(y){var M=y.touches[0];this._newPos=new et(M.clientX,M.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(y,M){var V=new MouseEvent(y,{bubbles:!0,cancelable:!0,view:window,screenX:M.screenX,screenY:M.screenY,clientX:M.clientX,clientY:M.clientY});V._simulated=!0,M.target.dispatchEvent(V)}});Oi.addInitHook("addHandler","tapHold",mc),Oi.mergeOptions({touchZoom:Ae.touch,bounceAtZoomLimits:!0});var gc=Xo.extend({addHooks:function(){yr(this._map._container,"leaflet-touch-zoom"),Hr(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){wi(this._map._container,"leaflet-touch-zoom"),no(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(y){var M=this._map;if(!(!y.touches||y.touches.length!==2||M._animatingZoom||this._zooming)){var V=M.mouseEventToContainerPoint(y.touches[0]),ie=M.mouseEventToContainerPoint(y.touches[1]);this._centerPoint=M.getSize()._divideBy(2),this._startLatLng=M.containerPointToLatLng(this._centerPoint),M.options.touchZoom!=="center"&&(this._pinchStartLatLng=M.containerPointToLatLng(V.add(ie)._divideBy(2))),this._startDist=V.distanceTo(ie),this._startZoom=M.getZoom(),this._moved=!1,this._zooming=!0,M._stop(),Hr(document,"touchmove",this._onTouchMove,this),Hr(document,"touchend touchcancel",this._onTouchEnd,this),co(y)}},_onTouchMove:function(y){if(!(!y.touches||y.touches.length!==2||!this._zooming)){var M=this._map,V=M.mouseEventToContainerPoint(y.touches[0]),ie=M.mouseEventToContainerPoint(y.touches[1]),Ee=V.distanceTo(ie)/this._startDist;if(this._zoom=M.getScaleZoom(Ee,this._startZoom),!M.options.bounceAtZoomLimits&&(this._zoom<M.getMinZoom()&&Ee<1||this._zoom>M.getMaxZoom()&&Ee>1)&&(this._zoom=M._limitZoom(this._zoom)),M.options.touchZoom==="center"){if(this._center=this._startLatLng,Ee===1)return}else{var Ge=V._add(ie)._divideBy(2)._subtract(this._centerPoint);if(Ee===1&&Ge.x===0&&Ge.y===0)return;this._center=M.unproject(M.project(this._pinchStartLatLng,this._zoom).subtract(Ge),this._zoom)}this._moved||(M._moveStart(!0,!1),this._moved=!0),St(this._animRequest);var Pt=S(M._move,M,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Je(Pt,this,!0),co(y)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,St(this._animRequest),no(document,"touchmove",this._onTouchMove,this),no(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Oi.addInitHook("addHandler","touchZoom",gc),Oi.BoxZoom=pc,Oi.DoubleClickZoom=Bh,Oi.Drag=ih,Oi.Keyboard=oh,Oi.ScrollWheelZoom=vo,Oi.TapHold=mc,Oi.TouchZoom=gc,i.Bounds=mt,i.Browser=Ae,i.CRS=$r,i.Canvas=dc,i.Circle=zu,i.CircleMarker=Vl,i.Class=Ht,i.Control=ro,i.DivIcon=Gl,i.DivOverlay=Ss,i.DomEvent=Rs,i.DomUtil=ba,i.Draggable=ra,i.Evented=Lt,i.FeatureGroup=zi,i.GeoJSON=hs,i.GridLayer=pl,i.Handler=Xo,i.Icon=jo,i.ImageOverlay=Sl,i.LatLng=$n,i.LatLngBounds=Jt,i.Layer=vr,i.LayerGroup=Yr,i.LineUtil=Pe,i.Map=Oi,i.Marker=cs,i.Mixin=ls,i.Path=Ul,i.Point=et,i.PolyUtil=us,i.Polygon=da,i.Polyline=fa,i.Popup=ju,i.PosAnimation=Za,i.Projection=Mt,i.Rectangle=ad,i.Renderer=Js,i.SVG=el,i.SVGOverlay=Nu,i.TileLayer=zs,i.Tooltip=Ds,i.Transformation=mr,i.Util=Nt,i.VideoOverlay=Bu,i.bind=S,i.bounds=zt,i.canvas=Uu,i.circle=hu,i.circleMarker=Qc,i.control=No,i.divIcon=fc,i.extend=h,i.featureGroup=ha,i.geoJSON=df,i.geoJson=Ys,i.gridLayer=Tl,i.icon=Xa,i.imageOverlay=pf,i.latLng=Bn,i.latLngBounds=Un,i.layerGroup=Or,i.map=Zo,i.marker=En,i.point=Ot,i.polygon=zh,i.polyline=ff,i.popup=Ls,i.rectangle=tp,i.setOptions=se,i.stamp=I,i.svg=rh,i.svgOverlay=fu,i.tileLayer=Bi,i.tooltip=ti,i.transformation=Sn,i.version=a,i.videoOverlay=nh;var _c=window.L;i.noConflict=function(){return window.L=_c,this},window.L=i})}(F_,F_.exports)),F_.exports}var iq=Y5();const Dl=zo(iq),J5=typeof document<"u"?Bt.useLayoutEffect:()=>{};function oq(e){const t=rt.useRef(null);return J5(()=>{t.current=e},[e]),rt.useCallback((...i)=>{const a=t.current;return a==null?void 0:a(...i)},[])}const zy=e=>{var t;return(t=e==null?void 0:e.ownerDocument)!==null&&t!==void 0?t:document},zp=e=>e&&"window"in e&&e.window===e?e:zy(e).defaultView||window;function Q5(e){var t,i,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(i=Q5(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}function to(){for(var e,t,i=0,a="",h=arguments.length;i<h;i++)(e=arguments[i])&&(t=Q5(e))&&(a&&(a+=" "),a+=t);return a}function aq(e){var t;return typeof window>"u"||window.navigator==null?!1:((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.brands.some(i=>e.test(i.brand)))||e.test(window.navigator.userAgent)}function sq(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function eN(e){let t=null;return()=>(t==null&&(t=e()),t)}const lq=eN(function(){return sq(/^Mac/i)}),uq=eN(function(){return aq(/Android/i)});function cq(e){return e.mozInputSource===0&&e.isTrusted?!0:uq()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}class hq{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(t,i){this.nativeEvent=i,this.target=i.target,this.currentTarget=i.currentTarget,this.relatedTarget=i.relatedTarget,this.bubbles=i.bubbles,this.cancelable=i.cancelable,this.defaultPrevented=i.defaultPrevented,this.eventPhase=i.eventPhase,this.isTrusted=i.isTrusted,this.timeStamp=i.timeStamp,this.type=t}}function tN(e){let t=rt.useRef({isFocused:!1,observer:null});J5(()=>{const a=t.current;return()=>{a.observer&&(a.observer.disconnect(),a.observer=null)}},[]);let i=oq(a=>{e==null||e(a)});return rt.useCallback(a=>{if(a.target instanceof HTMLButtonElement||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement||a.target instanceof HTMLSelectElement){t.current.isFocused=!0;let h=a.target,v=S=>{t.current.isFocused=!1,h.disabled&&i(new hq("blur",S)),t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};h.addEventListener("focusout",v,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&h.disabled){var S;(S=t.current.observer)===null||S===void 0||S.disconnect();let o=h===document.activeElement?null:document.activeElement;h.dispatchEvent(new FocusEvent("blur",{relatedTarget:o})),h.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:o}))}}),t.current.observer.observe(h,{attributes:!0,attributeFilter:["disabled"]})}},[i])}function fq(e){let{isDisabled:t,onFocus:i,onBlur:a,onFocusChange:h}=e;const v=rt.useCallback(I=>{if(I.target===I.currentTarget)return a&&a(I),h&&h(!1),!0},[a,h]),S=tN(v),o=rt.useCallback(I=>{const B=zy(I.target);I.target===I.currentTarget&&B.activeElement===I.target&&(i&&i(I),h&&h(!0),S(I))},[h,i,S]);return{focusProps:{onFocus:!t&&(i||h||a)?o:void 0,onBlur:!t&&(a||h)?v:void 0}}}let Fy=null,IA=new Set,V_=new Map,Wp=!1,CA=!1;const dq={Tab:!0,Escape:!0};function lM(e,t){for(let i of IA)i(e,t)}function pq(e){return!(e.metaKey||!lq()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function h0(e){Wp=!0,pq(e)&&(Fy="keyboard",lM("keyboard",e))}function Uc(e){Fy="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(Wp=!0,lM("pointer",e))}function nN(e){cq(e)&&(Wp=!0,Fy="virtual")}function rN(e){e.target===window||e.target===document||(!Wp&&!CA&&(Fy="virtual",lM("virtual",e)),Wp=!1,CA=!1)}function iN(){Wp=!1,CA=!0}function OA(e){if(typeof window>"u"||V_.get(zp(e)))return;const t=zp(e),i=zy(e);let a=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){Wp=!0,a.apply(this,arguments)},i.addEventListener("keydown",h0,!0),i.addEventListener("keyup",h0,!0),i.addEventListener("click",nN,!0),t.addEventListener("focus",rN,!0),t.addEventListener("blur",iN,!1),typeof PointerEvent<"u"?(i.addEventListener("pointerdown",Uc,!0),i.addEventListener("pointermove",Uc,!0),i.addEventListener("pointerup",Uc,!0)):(i.addEventListener("mousedown",Uc,!0),i.addEventListener("mousemove",Uc,!0),i.addEventListener("mouseup",Uc,!0)),t.addEventListener("beforeunload",()=>{oN(e)},{once:!0}),V_.set(t,{focus:a})}const oN=(e,t)=>{const i=zp(e),a=zy(e);t&&a.removeEventListener("DOMContentLoaded",t),V_.has(i)&&(i.HTMLElement.prototype.focus=V_.get(i).focus,a.removeEventListener("keydown",h0,!0),a.removeEventListener("keyup",h0,!0),a.removeEventListener("click",nN,!0),i.removeEventListener("focus",rN,!0),i.removeEventListener("blur",iN,!1),typeof PointerEvent<"u"?(a.removeEventListener("pointerdown",Uc,!0),a.removeEventListener("pointermove",Uc,!0),a.removeEventListener("pointerup",Uc,!0)):(a.removeEventListener("mousedown",Uc,!0),a.removeEventListener("mousemove",Uc,!0),a.removeEventListener("mouseup",Uc,!0)),V_.delete(i))};function mq(e){const t=zy(e);let i;return t.readyState!=="loading"?OA(e):(i=()=>{OA(e)},t.addEventListener("DOMContentLoaded",i)),()=>oN(e,i)}typeof document<"u"&&mq();function aN(){return Fy!=="pointer"}const gq=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function _q(e,t,i){var a;const h=typeof window<"u"?zp(i==null?void 0:i.target).HTMLInputElement:HTMLInputElement,v=typeof window<"u"?zp(i==null?void 0:i.target).HTMLTextAreaElement:HTMLTextAreaElement,S=typeof window<"u"?zp(i==null?void 0:i.target).HTMLElement:HTMLElement,o=typeof window<"u"?zp(i==null?void 0:i.target).KeyboardEvent:KeyboardEvent;return e=e||(i==null?void 0:i.target)instanceof h&&!gq.has(i==null||(a=i.target)===null||a===void 0?void 0:a.type)||(i==null?void 0:i.target)instanceof v||(i==null?void 0:i.target)instanceof S&&(i==null?void 0:i.target.isContentEditable),!(e&&t==="keyboard"&&i instanceof o&&!dq[i.key])}function yq(e,t,i){OA(),rt.useEffect(()=>{let a=(h,v)=>{_q(!!(i!=null&&i.isTextInput),h,v)&&e(aN())};return IA.add(a),()=>{IA.delete(a)}},t)}function vq(e){let{isDisabled:t,onBlurWithin:i,onFocusWithin:a,onFocusWithinChange:h}=e,v=rt.useRef({isFocusWithin:!1}),S=rt.useCallback(B=>{v.current.isFocusWithin&&!B.currentTarget.contains(B.relatedTarget)&&(v.current.isFocusWithin=!1,i&&i(B),h&&h(!1))},[i,h,v]),o=tN(S),I=rt.useCallback(B=>{!v.current.isFocusWithin&&document.activeElement===B.target&&(a&&a(B),h&&h(!0),v.current.isFocusWithin=!0,o(B))},[a,h,o]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:I,onBlur:S}}}let f0=!1,bb=0;function kA(){f0=!0,setTimeout(()=>{f0=!1},50)}function Lk(e){e.pointerType==="touch"&&kA()}function xq(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",Lk):document.addEventListener("touchend",kA),bb++,()=>{bb--,!(bb>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",Lk):document.removeEventListener("touchend",kA))}}function bq(e){let{onHoverStart:t,onHoverChange:i,onHoverEnd:a,isDisabled:h}=e,[v,S]=rt.useState(!1),o=rt.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;rt.useEffect(xq,[]);let{hoverProps:I,triggerHoverEnd:B}=rt.useMemo(()=>{let $=(te,le)=>{if(o.pointerType=le,h||le==="touch"||o.isHovered||!te.currentTarget.contains(te.target))return;o.isHovered=!0;let se=te.currentTarget;o.target=se,t&&t({type:"hoverstart",target:se,pointerType:le}),i&&i(!0),S(!0)},U=(te,le)=>{if(o.pointerType="",o.target=null,le==="touch"||!o.isHovered)return;o.isHovered=!1;let se=te.currentTarget;a&&a({type:"hoverend",target:se,pointerType:le}),i&&i(!1),S(!1)},K={};return typeof PointerEvent<"u"?(K.onPointerEnter=te=>{f0&&te.pointerType==="mouse"||$(te,te.pointerType)},K.onPointerLeave=te=>{!h&&te.currentTarget.contains(te.target)&&U(te,te.pointerType)}):(K.onTouchStart=()=>{o.ignoreEmulatedMouseEvents=!0},K.onMouseEnter=te=>{!o.ignoreEmulatedMouseEvents&&!f0&&$(te,"mouse"),o.ignoreEmulatedMouseEvents=!1},K.onMouseLeave=te=>{!h&&te.currentTarget.contains(te.target)&&U(te,"mouse")}),{hoverProps:K,triggerHoverEnd:U}},[t,i,a,h,o]);return rt.useEffect(()=>{h&&B({currentTarget:o.target},o.pointerType)},[h]),{hoverProps:I,isHovered:v}}function wq(e={}){let{autoFocus:t=!1,isTextInput:i,within:a}=e,h=rt.useRef({isFocused:!1,isFocusVisible:t||aN()}),[v,S]=rt.useState(!1),[o,I]=rt.useState(()=>h.current.isFocused&&h.current.isFocusVisible),B=rt.useCallback(()=>I(h.current.isFocused&&h.current.isFocusVisible),[]),$=rt.useCallback(te=>{h.current.isFocused=te,S(te),B()},[B]);yq(te=>{h.current.isFocusVisible=te,B()},[],{isTextInput:i});let{focusProps:U}=fq({isDisabled:a,onFocusChange:$}),{focusWithinProps:K}=vq({isDisabled:!a,onFocusWithinChange:$});return{isFocused:v,isFocusVisible:o,focusProps:a?K:U}}var Sq=Object.defineProperty,Tq=(e,t,i)=>t in e?Sq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,wb=(e,t,i)=>(Tq(e,typeof t!="symbol"?t+"":t,i),i);let Eq=class{constructor(){wb(this,"current",this.detect()),wb(this,"handoffState","pending"),wb(this,"currentId",0)}set(t){this.current!==t&&(this.handoffState="pending",this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Up=new Eq;function Eg(e){return Up.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}function sN(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function uf(){let e=[],t={addEventListener(i,a,h,v){return i.addEventListener(a,h,v),t.add(()=>i.removeEventListener(a,h,v))},requestAnimationFrame(...i){let a=requestAnimationFrame(...i);return t.add(()=>cancelAnimationFrame(a))},nextFrame(...i){return t.requestAnimationFrame(()=>t.requestAnimationFrame(...i))},setTimeout(...i){let a=setTimeout(...i);return t.add(()=>clearTimeout(a))},microTask(...i){let a={current:!0};return sN(()=>{a.current&&i[0]()}),t.add(()=>{a.current=!1})},style(i,a,h){let v=i.style.getPropertyValue(a);return Object.assign(i.style,{[a]:h}),this.add(()=>{Object.assign(i.style,{[a]:v})})},group(i){let a=uf();return i(a),this.add(()=>a.dispose())},add(i){return e.includes(i)||e.push(i),()=>{let a=e.indexOf(i);if(a>=0)for(let h of e.splice(a,1))h()}},dispose(){for(let i of e.splice(0))i()}};return t}function hx(){let[e]=rt.useState(uf);return rt.useEffect(()=>()=>e.dispose(),[e]),e}let Cs=(e,t)=>{Up.isServer?rt.useEffect(e,t):rt.useLayoutEffect(e,t)};function By(e){let t=rt.useRef(e);return Cs(()=>{t.current=e},[e]),t}let Ha=function(e){let t=By(e);return Bt.useCallback((...i)=>t.current(...i),[t])};function Aq(e){let t=e.width/2,i=e.height/2;return{top:e.clientY-i,right:e.clientX+t,bottom:e.clientY+i,left:e.clientX-t}}function Pq(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}function Mq({disabled:e=!1}={}){let t=rt.useRef(null),[i,a]=rt.useState(!1),h=hx(),v=Ha(()=>{t.current=null,a(!1),h.dispose()}),S=Ha(o=>{if(h.dispose(),t.current===null){t.current=o.currentTarget,a(!0);{let I=Eg(o.currentTarget);h.addEventListener(I,"pointerup",v,!1),h.addEventListener(I,"pointermove",B=>{if(t.current){let $=Aq(B);a(Pq($,t.current.getBoundingClientRect()))}},!1),h.addEventListener(I,"pointercancel",v,!1)}}});return{pressed:i,pressProps:e?{}:{onPointerDown:S,onPointerUp:v,onClick:v}}}let Iq=rt.createContext(void 0);function lN(){return rt.useContext(Iq)}function Dk(...e){return Array.from(new Set(e.flatMap(t=>typeof t=="string"?t.split(" "):[]))).filter(Boolean).join(" ")}function Ny(e,t,...i){if(e in t){let h=t[e];return typeof h=="function"?h(...i):h}let a=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(h=>`"${h}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,Ny),a}var RA=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(RA||{}),Cq=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(Cq||{});function Xc(){let e=kq();return rt.useCallback(t=>Oq({mergeRefs:e,...t}),[e])}function Oq({ourProps:e,theirProps:t,slot:i,defaultTag:a,features:h,visible:v=!0,name:S,mergeRefs:o}){o=o??Rq;let I=uN(t,e);if(v)return Gv(I,i,a,S,o);let B=h??0;if(B&2){let{static:$=!1,...U}=I;if($)return Gv(U,i,a,S,o)}if(B&1){let{unmount:$=!0,...U}=I;return Ny($?0:1,{0(){return null},1(){return Gv({...U,hidden:!0,style:{display:"none"}},i,a,S,o)}})}return Gv(I,i,a,S,o)}function Gv(e,t={},i,a,h){let{as:v=i,children:S,refName:o="ref",...I}=Sb(e,["unmount","static"]),B=e.ref!==void 0?{[o]:e.ref}:{},$=typeof S=="function"?S(t):S;"className"in I&&I.className&&typeof I.className=="function"&&(I.className=I.className(t)),I["aria-labelledby"]&&I["aria-labelledby"]===I.id&&(I["aria-labelledby"]=void 0);let U={};if(t){let K=!1,te=[];for(let[le,se]of Object.entries(t))typeof se=="boolean"&&(K=!0),se===!0&&te.push(le.replace(/([A-Z])/g,ue=>`-${ue.toLowerCase()}`));if(K){U["data-headlessui-state"]=te.join(" ");for(let le of te)U[`data-${le}`]=""}}if(v===rt.Fragment&&(Object.keys(Bm(I)).length>0||Object.keys(Bm(U)).length>0))if(!rt.isValidElement($)||Array.isArray($)&&$.length>1){if(Object.keys(Bm(I)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${a} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Bm(I)).concat(Object.keys(Bm(U))).map(K=>`  - ${K}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(K=>`  - ${K}`).join(`
`)].join(`
`))}else{let K=$.props,te=K==null?void 0:K.className,le=typeof te=="function"?(...be)=>Dk(te(...be),I.className):Dk(te,I.className),se=le?{className:le}:{},ue=uN($.props,Bm(Sb(I,["ref"])));for(let be in U)be in ue&&delete U[be];return rt.cloneElement($,Object.assign({},ue,U,B,{ref:h(Lq($),B.ref)},se))}return rt.createElement(v,Object.assign({},Sb(I,["ref"]),v!==rt.Fragment&&B,v!==rt.Fragment&&U),$)}function kq(){let e=rt.useRef([]),t=rt.useCallback(i=>{for(let a of e.current)a!=null&&(typeof a=="function"?a(i):a.current=i)},[]);return(...i)=>{if(!i.every(a=>a==null))return e.current=i,t}}function Rq(...e){return e.every(t=>t==null)?void 0:t=>{for(let i of e)i!=null&&(typeof i=="function"?i(t):i.current=t)}}function uN(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},i={};for(let a of e)for(let h in a)h.startsWith("on")&&typeof a[h]=="function"?(i[h]!=null||(i[h]=[]),i[h].push(a[h])):t[h]=a[h];if(t.disabled||t["aria-disabled"])for(let a in i)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(a)&&(i[a]=[h=>{var v;return(v=h==null?void 0:h.preventDefault)==null?void 0:v.call(h)}]);for(let a in i)Object.assign(t,{[a](h,...v){let S=i[a];for(let o of S){if((h instanceof Event||(h==null?void 0:h.nativeEvent)instanceof Event)&&h.defaultPrevented)return;o(h,...v)}}});return t}function cN(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},i={};for(let a of e)for(let h in a)h.startsWith("on")&&typeof a[h]=="function"?(i[h]!=null||(i[h]=[]),i[h].push(a[h])):t[h]=a[h];for(let a in i)Object.assign(t,{[a](...h){let v=i[a];for(let S of v)S==null||S(...h)}});return t}function Kc(e){var t;return Object.assign(rt.forwardRef(e),{displayName:(t=e.displayName)!=null?t:e.name})}function Bm(e){let t=Object.assign({},e);for(let i in t)t[i]===void 0&&delete t[i];return t}function Sb(e,t=[]){let i=Object.assign({},e);for(let a of t)a in i&&delete i[a];return i}function Lq(e){return Bt.version.split(".")[0]>="19"?e.props.ref:e.ref}var nf=X5();let Dq=rt.createContext(void 0);function zq(){return rt.useContext(Dq)}function Fq(e){let t=e.parentElement,i=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(i=t),t=t.parentElement;let a=(t==null?void 0:t.getAttribute("disabled"))==="";return a&&Bq(i)?!1:a}function Bq(e){if(!e)return!1;let t=e.previousElementSibling;for(;t!==null;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}let hN=Symbol();function Nq(e,t=!0){return Object.assign(e,{[hN]:t})}function nd(...e){let t=rt.useRef(e);rt.useEffect(()=>{t.current=e},[e]);let i=Ha(a=>{for(let h of t.current)h!=null&&(typeof h=="function"?h(a):h.current=a)});return e.every(a=>a==null||(a==null?void 0:a[hN]))?void 0:i}let uM=rt.createContext(null);uM.displayName="DescriptionContext";function fN(){let e=rt.useContext(uM);if(e===null){let t=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,fN),t}return e}function jq(){let[e,t]=rt.useState([]);return[e.length>0?e.join(" "):void 0,rt.useMemo(()=>function(i){let a=Ha(v=>(t(S=>[...S,v]),()=>t(S=>{let o=S.slice(),I=o.indexOf(v);return I!==-1&&o.splice(I,1),o}))),h=rt.useMemo(()=>({register:a,slot:i.slot,name:i.name,props:i.props,value:i.value}),[a,i.slot,i.name,i.props,i.value]);return Bt.createElement(uM.Provider,{value:h},i.children)},[t])]}let $q="p";function Uq(e,t){let i=rt.useId(),a=lN(),{id:h=`headlessui-description-${i}`,...v}=e,S=fN(),o=nd(t);Cs(()=>S.register(h),[h,S.register]);let I=a||!1,B=rt.useMemo(()=>({...S.slot,disabled:I}),[S.slot,I]),$={ref:o,...S.props,id:h};return Xc()({ourProps:$,theirProps:v,slot:B,defaultTag:$q,name:S.name||"Description"})}let Vq=Kc(Uq);Object.assign(Vq,{});var yl=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(yl||{});let fx=rt.createContext(null);fx.displayName="LabelContext";function cM(){let e=rt.useContext(fx);if(e===null){let t=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(t,cM),t}return e}function qq(e){var t,i,a;let h=(i=(t=rt.useContext(fx))==null?void 0:t.value)!=null?i:void 0;return((a=void 0)!=null?a:0)>0?[h,...e].filter(Boolean).join(" "):h}function dN({inherit:e=!1}={}){let t=qq(),[i,a]=rt.useState([]),h=e?[t,...i].filter(Boolean):i;return[h.length>0?h.join(" "):void 0,rt.useMemo(()=>function(v){let S=Ha(I=>(a(B=>[...B,I]),()=>a(B=>{let $=B.slice(),U=$.indexOf(I);return U!==-1&&$.splice(U,1),$}))),o=rt.useMemo(()=>({register:S,slot:v.slot,name:v.name,props:v.props,value:v.value}),[S,v.slot,v.name,v.props,v.value]);return Bt.createElement(fx.Provider,{value:o},v.children)},[a])]}let Gq="label";function Hq(e,t){var i;let a=rt.useId(),h=cM(),v=zq(),S=lN(),{id:o=`headlessui-label-${a}`,htmlFor:I=v??((i=h.props)==null?void 0:i.htmlFor),passive:B=!1,...$}=e,U=nd(t);Cs(()=>h.register(o),[o,h.register]);let K=Ha(ue=>{let be=ue.currentTarget;if(be instanceof HTMLLabelElement&&ue.preventDefault(),h.props&&"onClick"in h.props&&typeof h.props.onClick=="function"&&h.props.onClick(ue),be instanceof HTMLLabelElement){let Ce=document.getElementById(be.htmlFor);if(Ce){let Re=Ce.getAttribute("disabled");if(Re==="true"||Re==="")return;let De=Ce.getAttribute("aria-disabled");if(De==="true"||De==="")return;(Ce instanceof HTMLInputElement&&(Ce.type==="radio"||Ce.type==="checkbox")||Ce.role==="radio"||Ce.role==="checkbox"||Ce.role==="switch")&&Ce.click(),Ce.focus({preventScroll:!0})}}}),te=S||!1,le=rt.useMemo(()=>({...h.slot,disabled:te}),[h.slot,te]),se={ref:U,...h.props,id:o,htmlFor:I,onClick:K};return B&&("onClick"in se&&(delete se.htmlFor,delete se.onClick),"onClick"in $&&delete $.onClick),Xc()({ourProps:se,theirProps:$,slot:le,defaultTag:I?Gq:"div",name:h.name||"Label"})}let Wq=Kc(Hq);Object.assign(Wq,{});function Zq(e){if(e===null)return{width:0,height:0};let{width:t,height:i}=e.getBoundingClientRect();return{width:t,height:i}}function Xq(e,t=!1){let[i,a]=rt.useReducer(()=>({}),{}),h=rt.useMemo(()=>Zq(e),[e,i]);return Cs(()=>{if(!e)return;let v=new ResizeObserver(a);return v.observe(e),()=>{v.disconnect()}},[e]),t?{width:`${h.width}px`,height:`${h.height}px`}:h}let Kq=class extends Map{constructor(t){super(),this.factory=t}get(t){let i=super.get(t);return i===void 0&&(i=this.factory(t),this.set(t,i)),i}};function pN(e,t){let i=e(),a=new Set;return{getSnapshot(){return i},subscribe(h){return a.add(h),()=>a.delete(h)},dispatch(h,...v){let S=t[h].call(i,...v);S&&(i=S,a.forEach(o=>o()))}}}function mN(e){return rt.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}let Yq=new Kq(()=>pN(()=>[],{ADD(e){return this.includes(e)?this:[...this,e]},REMOVE(e){let t=this.indexOf(e);if(t===-1)return this;let i=this.slice();return i.splice(t,1),i}}));function hM(e,t){let i=Yq.get(t),a=rt.useId(),h=mN(i);if(Cs(()=>{if(e)return i.dispatch("ADD",a),()=>i.dispatch("REMOVE",a)},[i,e]),!e)return!1;let v=h.indexOf(a),S=h.length;return v===-1&&(v=S,S+=1),v===S-1}let LA=new Map,q_=new Map;function zk(e){var t;let i=(t=q_.get(e))!=null?t:0;return q_.set(e,i+1),i!==0?()=>Fk(e):(LA.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0,()=>Fk(e))}function Fk(e){var t;let i=(t=q_.get(e))!=null?t:1;if(i===1?q_.delete(e):q_.set(e,i-1),i!==1)return;let a=LA.get(e);a&&(a["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",a["aria-hidden"]),e.inert=a.inert,LA.delete(e))}function Jq(e,{allowed:t,disallowed:i}={}){let a=hM(e,"inert-others");Cs(()=>{var h,v;if(!a)return;let S=uf();for(let I of(h=i==null?void 0:i())!=null?h:[])I&&S.add(zk(I));let o=(v=t==null?void 0:t())!=null?v:[];for(let I of o){if(!I)continue;let B=Eg(I);if(!B)continue;let $=I.parentElement;for(;$&&$!==B.body;){for(let U of $.children)o.some(K=>U.contains(K))||S.add(zk(U));$=$.parentElement}}return S.dispose},[a,t,i])}function Qq(e,t,i){let a=By(h=>{let v=h.getBoundingClientRect();v.x===0&&v.y===0&&v.width===0&&v.height===0&&i()});rt.useEffect(()=>{if(!e)return;let h=t===null?null:t instanceof HTMLElement?t:t.current;if(!h)return;let v=uf();if(typeof ResizeObserver<"u"){let S=new ResizeObserver(()=>a.current(h));S.observe(h),v.add(()=>S.disconnect())}if(typeof IntersectionObserver<"u"){let S=new IntersectionObserver(()=>a.current(h));S.observe(h),v.add(()=>S.disconnect())}return()=>v.dispose()},[t,a,e])}let DA=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),eG=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var zA=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(zA||{}),tG=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(tG||{}),nG=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(nG||{});function gN(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(DA)).sort((t,i)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(i.tabIndex||Number.MAX_SAFE_INTEGER)))}function rG(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(eG)).sort((t,i)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(i.tabIndex||Number.MAX_SAFE_INTEGER)))}var fM=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(fM||{});function dM(e,t=0){var i;return e===((i=Eg(e))==null?void 0:i.body)?!1:Ny(t,{0(){return e.matches(DA)},1(){let a=e;for(;a!==null;){if(a.matches(DA))return!0;a=a.parentElement}return!1}})}function _N(e){let t=Eg(e);uf().nextFrame(()=>{t&&!dM(t.activeElement,0)&&oG(e)})}var iG=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(iG||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function oG(e){e==null||e.focus({preventScroll:!0})}let aG=["textarea","input"].join(",");function sG(e){var t,i;return(i=(t=e==null?void 0:e.matches)==null?void 0:t.call(e,aG))!=null?i:!1}function yN(e,t=i=>i){return e.slice().sort((i,a)=>{let h=t(i),v=t(a);if(h===null||v===null)return 0;let S=h.compareDocumentPosition(v);return S&Node.DOCUMENT_POSITION_FOLLOWING?-1:S&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function lG(e,t){return uG(gN(),t,{relativeTo:e})}function uG(e,t,{sorted:i=!0,relativeTo:a=null,skipElements:h=[]}={}){let v=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,S=Array.isArray(e)?i?yN(e):e:t&64?rG(e):gN(e);h.length>0&&S.length>1&&(S=S.filter(te=>!h.some(le=>le!=null&&"current"in le?(le==null?void 0:le.current)===te:le===te))),a=a??v.activeElement;let o=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),I=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,S.indexOf(a))-1;if(t&4)return Math.max(0,S.indexOf(a))+1;if(t&8)return S.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),B=t&32?{preventScroll:!0}:{},$=0,U=S.length,K;do{if($>=U||$+U<=0)return 0;let te=I+$;if(t&16)te=(te+U)%U;else{if(te<0)return 3;if(te>=U)return 1}K=S[te],K==null||K.focus(B),$+=o}while(K!==v.activeElement);return t&6&&sG(K)&&K.select(),2}function vN(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function cG(){return/Android/gi.test(window.navigator.userAgent)}function hG(){return vN()||cG()}function P_(e,t,i,a){let h=By(i);rt.useEffect(()=>{if(!e)return;function v(S){h.current(S)}return document.addEventListener(t,v,a),()=>document.removeEventListener(t,v,a)},[e,t,a])}function fG(e,t,i,a){let h=By(i);rt.useEffect(()=>{if(!e)return;function v(S){h.current(S)}return window.addEventListener(t,v,a),()=>window.removeEventListener(t,v,a)},[e,t,a])}const Bk=30;function dG(e,t,i){let a=hM(e,"outside-click"),h=By(i),v=rt.useCallback(function(I,B){if(I.defaultPrevented)return;let $=B(I);if($===null||!$.getRootNode().contains($)||!$.isConnected)return;let U=function K(te){return typeof te=="function"?K(te()):Array.isArray(te)||te instanceof Set?te:[te]}(t);for(let K of U)if(K!==null&&(K.contains($)||I.composed&&I.composedPath().includes(K)))return;return!dM($,fM.Loose)&&$.tabIndex!==-1&&I.preventDefault(),h.current(I,$)},[h,t]),S=rt.useRef(null);P_(a,"pointerdown",I=>{var B,$;S.current=(($=(B=I.composedPath)==null?void 0:B.call(I))==null?void 0:$[0])||I.target},!0),P_(a,"mousedown",I=>{var B,$;S.current=(($=(B=I.composedPath)==null?void 0:B.call(I))==null?void 0:$[0])||I.target},!0),P_(a,"click",I=>{hG()||S.current&&(v(I,()=>S.current),S.current=null)},!0);let o=rt.useRef({x:0,y:0});P_(a,"touchstart",I=>{o.current.x=I.touches[0].clientX,o.current.y=I.touches[0].clientY},!0),P_(a,"touchend",I=>{let B={x:I.changedTouches[0].clientX,y:I.changedTouches[0].clientY};if(!(Math.abs(B.x-o.current.x)>=Bk||Math.abs(B.y-o.current.y)>=Bk))return v(I,()=>I.target instanceof HTMLElement?I.target:null)},!0),fG(a,"blur",I=>v(I,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function pM(...e){return rt.useMemo(()=>Eg(...e),[...e])}function pG(e,t){return rt.useMemo(()=>{var i;if(e.type)return e.type;let a=(i=e.as)!=null?i:"button";if(typeof a=="string"&&a.toLowerCase()==="button"||(t==null?void 0:t.tagName)==="BUTTON"&&!t.hasAttribute("type"))return"button"},[e.type,e.as,t])}function mG(){let e;return{before({doc:t}){var i;let a=t.documentElement,h=(i=t.defaultView)!=null?i:window;e=Math.max(0,h.innerWidth-a.clientWidth)},after({doc:t,d:i}){let a=t.documentElement,h=Math.max(0,a.clientWidth-a.offsetWidth),v=Math.max(0,e-h);i.style(a,"paddingRight",`${v}px`)}}}function gG(){return vN()?{before({doc:e,d:t,meta:i}){function a(h){return i.containers.flatMap(v=>v()).some(v=>v.contains(h))}t.microTask(()=>{var h;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let o=uf();o.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>o.dispose()))}let v=(h=window.scrollY)!=null?h:window.pageYOffset,S=null;t.addEventListener(e,"click",o=>{if(o.target instanceof HTMLElement)try{let I=o.target.closest("a");if(!I)return;let{hash:B}=new URL(I.href),$=e.querySelector(B);$&&!a($)&&(S=$)}catch{}},!0),t.addEventListener(e,"touchstart",o=>{if(o.target instanceof HTMLElement)if(a(o.target)){let I=o.target;for(;I.parentElement&&a(I.parentElement);)I=I.parentElement;t.style(I,"overscrollBehavior","contain")}else t.style(o.target,"touchAction","none")}),t.addEventListener(e,"touchmove",o=>{if(o.target instanceof HTMLElement){if(o.target.tagName==="INPUT")return;if(a(o.target)){let I=o.target;for(;I.parentElement&&I.dataset.headlessuiPortal!==""&&!(I.scrollHeight>I.clientHeight||I.scrollWidth>I.clientWidth);)I=I.parentElement;I.dataset.headlessuiPortal===""&&o.preventDefault()}else o.preventDefault()}},{passive:!1}),t.add(()=>{var o;let I=(o=window.scrollY)!=null?o:window.pageYOffset;v!==I&&window.scrollTo(0,v),S&&S.isConnected&&(S.scrollIntoView({block:"nearest"}),S=null)})})}}:{}}function _G(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function yG(e){let t={};for(let i of e)Object.assign(t,i(t));return t}let Fp=pN(()=>new Map,{PUSH(e,t){var i;let a=(i=this.get(e))!=null?i:{doc:e,count:0,d:uf(),meta:new Set};return a.count++,a.meta.add(t),this.set(e,a),this},POP(e,t){let i=this.get(e);return i&&(i.count--,i.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:i}){let a={doc:e,d:t,meta:yG(i)},h=[gG(),mG(),_G()];h.forEach(({before:v})=>v==null?void 0:v(a)),h.forEach(({after:v})=>v==null?void 0:v(a))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Fp.subscribe(()=>{let e=Fp.getSnapshot(),t=new Map;for(let[i]of e)t.set(i,i.documentElement.style.overflow);for(let i of e.values()){let a=t.get(i.doc)==="hidden",h=i.count!==0;(h&&!a||!h&&a)&&Fp.dispatch(i.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",i),i.count===0&&Fp.dispatch("TEARDOWN",i)}});function vG(e,t,i=()=>({containers:[]})){let a=mN(Fp),h=t?a.get(t):void 0,v=h?h.count>0:!1;return Cs(()=>{if(!(!t||!e))return Fp.dispatch("PUSH",t,i),()=>Fp.dispatch("POP",t,i)},[e,t]),v}function xG(e,t,i=()=>[document.body]){let a=hM(e,"scroll-lock");vG(a,t,h=>{var v;return{containers:[...(v=h.containers)!=null?v:[],i]}})}function Nk(e){return[e.screenX,e.screenY]}function bG(){let e=rt.useRef([-1,-1]);return{wasMoved(t){let i=Nk(t);return e.current[0]===i[0]&&e.current[1]===i[1]?!1:(e.current=i,!0)},update(t){e.current=Nk(t)}}}function wG(e=0){let[t,i]=rt.useState(e),a=rt.useCallback(I=>i(I),[t]),h=rt.useCallback(I=>i(B=>B|I),[t]),v=rt.useCallback(I=>(t&I)===I,[t]),S=rt.useCallback(I=>i(B=>B&~I),[i]),o=rt.useCallback(I=>i(B=>B^I),[i]);return{flags:t,setFlag:a,addFlag:h,hasFlag:v,removeFlag:S,toggleFlag:o}}var SG={},jk,$k;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((jk=process==null?void 0:SG)==null?void 0:jk.NODE_ENV)==="test"&&typeof(($k=Element==null?void 0:Element.prototype)==null?void 0:$k.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var TG=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(TG||{});function EG(e){let t={};for(let i in e)e[i]===!0&&(t[`data-${i}`]="");return t}function AG(e,t,i,a){let[h,v]=rt.useState(i),{hasFlag:S,addFlag:o,removeFlag:I}=wG(e&&h?3:0),B=rt.useRef(!1),$=rt.useRef(!1),U=hx();return Cs(()=>{var K;if(e){if(i&&v(!0),!t){i&&o(3);return}return(K=void 0)==null||K.call(a,i),PG(t,{inFlight:B,prepare(){$.current?$.current=!1:$.current=B.current,B.current=!0,!$.current&&(i?(o(3),I(4)):(o(4),I(2)))},run(){$.current?i?(I(3),o(4)):(I(4),o(3)):i?I(1):o(1)},done(){var te;$.current&&typeof t.getAnimations=="function"&&t.getAnimations().length>0||(B.current=!1,I(7),i||v(!1),(te=void 0)==null||te.call(a,i))}})}},[e,i,t,U]),e?[h,{closed:S(1),enter:S(2),leave:S(4),transition:S(2)||S(4)}]:[i,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function PG(e,{prepare:t,run:i,done:a,inFlight:h}){let v=uf();return IG(e,{prepare:t,inFlight:h}),v.nextFrame(()=>{i(),v.requestAnimationFrame(()=>{v.add(MG(e,a))})}),v.dispose}function MG(e,t){var i,a;let h=uf();if(!e)return h.dispose;let v=!1;h.add(()=>{v=!0});let S=(a=(i=e.getAnimations)==null?void 0:i.call(e).filter(o=>o instanceof CSSTransition))!=null?a:[];return S.length===0?(t(),h.dispose):(Promise.allSettled(S.map(o=>o.finished)).then(()=>{v||t()}),h.dispose)}function IG(e,{inFlight:t,prepare:i}){if(t!=null&&t.current){i();return}let a=e.style.transition;e.style.transition="none",i(),e.offsetHeight,e.style.transition=a}function CG(e,{container:t,accept:i,walk:a}){let h=rt.useRef(i),v=rt.useRef(a);rt.useEffect(()=>{h.current=i,v.current=a},[i,a]),Cs(()=>{if(!t||!e)return;let S=Eg(t);if(!S)return;let o=h.current,I=v.current,B=Object.assign(U=>o(U),{acceptNode:o}),$=S.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,B,!1);for(;$.nextNode();)I($.currentNode)},[t,e,h,v])}function dx(){return typeof window<"u"}function Ag(e){return xN(e)?(e.nodeName||"").toLowerCase():"#document"}function rc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function cf(e){var t;return(t=(xN(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function xN(e){return dx()?e instanceof Node||e instanceof rc(e).Node:!1}function iu(e){return dx()?e instanceof Element||e instanceof rc(e).Element:!1}function sf(e){return dx()?e instanceof HTMLElement||e instanceof rc(e).HTMLElement:!1}function Uk(e){return!dx()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof rc(e).ShadowRoot}function jy(e){const{overflow:t,overflowX:i,overflowY:a,display:h}=Rh(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+i)&&!["inline","contents"].includes(h)}function OG(e){return["table","td","th"].includes(Ag(e))}function px(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function mM(e){const t=gM(),i=iu(e)?Rh(e):e;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(a=>(i.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(i.contain||"").includes(a))}function kG(e){let t=Hd(e);for(;sf(t)&&!eg(t);){if(mM(t))return t;if(px(t))return null;t=Hd(t)}return null}function gM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function eg(e){return["html","body","#document"].includes(Ag(e))}function Rh(e){return rc(e).getComputedStyle(e)}function mx(e){return iu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Hd(e){if(Ag(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Uk(e)&&e.host||cf(e);return Uk(t)?t.host:t}function bN(e){const t=Hd(e);return eg(t)?e.ownerDocument?e.ownerDocument.body:e.body:sf(t)&&jy(t)?t:bN(t)}function Y_(e,t,i){var a;t===void 0&&(t=[]),i===void 0&&(i=!0);const h=bN(e),v=h===((a=e.ownerDocument)==null?void 0:a.body),S=rc(h);if(v){const o=FA(S);return t.concat(S,S.visualViewport||[],jy(h)?h:[],o&&i?Y_(o):[])}return t.concat(h,Y_(h,[],i))}function FA(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function RG(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(t=>{let{brand:i,version:a}=t;return i+"/"+a}).join(" "):navigator.userAgent}const Zp=Math.min,Fl=Math.max,J_=Math.round,Hv=Math.floor,rf=e=>({x:e,y:e}),LG={left:"right",right:"left",bottom:"top",top:"bottom"},DG={start:"end",end:"start"};function Vk(e,t,i){return Fl(e,Zp(t,i))}function Pg(e,t){return typeof e=="function"?e(t):e}function Wd(e){return e.split("-")[0]}function $y(e){return e.split("-")[1]}function wN(e){return e==="x"?"y":"x"}function SN(e){return e==="y"?"height":"width"}function Xp(e){return["top","bottom"].includes(Wd(e))?"y":"x"}function TN(e){return wN(Xp(e))}function zG(e,t,i){i===void 0&&(i=!1);const a=$y(e),h=TN(e),v=SN(h);let S=h==="x"?a===(i?"end":"start")?"right":"left":a==="start"?"bottom":"top";return t.reference[v]>t.floating[v]&&(S=d0(S)),[S,d0(S)]}function FG(e){const t=d0(e);return[BA(e),t,BA(t)]}function BA(e){return e.replace(/start|end/g,t=>DG[t])}function BG(e,t,i){const a=["left","right"],h=["right","left"],v=["top","bottom"],S=["bottom","top"];switch(e){case"top":case"bottom":return i?t?h:a:t?a:h;case"left":case"right":return t?v:S;default:return[]}}function NG(e,t,i,a){const h=$y(e);let v=BG(Wd(e),i==="start",a);return h&&(v=v.map(S=>S+"-"+h),t&&(v=v.concat(v.map(BA)))),v}function d0(e){return e.replace(/left|right|bottom|top/g,t=>LG[t])}function jG(e){return{top:0,right:0,bottom:0,left:0,...e}}function $G(e){return typeof e!="number"?jG(e):{top:e,right:e,bottom:e,left:e}}function p0(e){const{x:t,y:i,width:a,height:h}=e;return{width:a,height:h,top:i,left:t,right:t+a,bottom:i+h,x:t,y:i}}function qk(e,t,i){let{reference:a,floating:h}=e;const v=Xp(t),S=TN(t),o=SN(S),I=Wd(t),B=v==="y",$=a.x+a.width/2-h.width/2,U=a.y+a.height/2-h.height/2,K=a[o]/2-h[o]/2;let te;switch(I){case"top":te={x:$,y:a.y-h.height};break;case"bottom":te={x:$,y:a.y+a.height};break;case"right":te={x:a.x+a.width,y:U};break;case"left":te={x:a.x-h.width,y:U};break;default:te={x:a.x,y:a.y}}switch($y(t)){case"start":te[S]-=K*(i&&B?-1:1);break;case"end":te[S]+=K*(i&&B?-1:1);break}return te}const UG=async(e,t,i)=>{const{placement:a="bottom",strategy:h="absolute",middleware:v=[],platform:S}=i,o=v.filter(Boolean),I=await(S.isRTL==null?void 0:S.isRTL(t));let B=await S.getElementRects({reference:e,floating:t,strategy:h}),{x:$,y:U}=qk(B,a,I),K=a,te={},le=0;for(let se=0;se<o.length;se++){const{name:ue,fn:be}=o[se],{x:Ce,y:Re,data:De,reset:ve}=await be({x:$,y:U,initialPlacement:a,placement:K,strategy:h,middlewareData:te,rects:B,platform:S,elements:{reference:e,floating:t}});$=Ce??$,U=Re??U,te={...te,[ue]:{...te[ue],...De}},ve&&le<=50&&(le++,typeof ve=="object"&&(ve.placement&&(K=ve.placement),ve.rects&&(B=ve.rects===!0?await S.getElementRects({reference:e,floating:t,strategy:h}):ve.rects),{x:$,y:U}=qk(B,K,I)),se=-1)}return{x:$,y:U,placement:K,strategy:h,middlewareData:te}};async function gx(e,t){var i;t===void 0&&(t={});const{x:a,y:h,platform:v,rects:S,elements:o,strategy:I}=e,{boundary:B="clippingAncestors",rootBoundary:$="viewport",elementContext:U="floating",altBoundary:K=!1,padding:te=0}=Pg(t,e),le=$G(te),ue=o[K?U==="floating"?"reference":"floating":U],be=p0(await v.getClippingRect({element:(i=await(v.isElement==null?void 0:v.isElement(ue)))==null||i?ue:ue.contextElement||await(v.getDocumentElement==null?void 0:v.getDocumentElement(o.floating)),boundary:B,rootBoundary:$,strategy:I})),Ce=U==="floating"?{x:a,y:h,width:S.floating.width,height:S.floating.height}:S.reference,Re=await(v.getOffsetParent==null?void 0:v.getOffsetParent(o.floating)),De=await(v.isElement==null?void 0:v.isElement(Re))?await(v.getScale==null?void 0:v.getScale(Re))||{x:1,y:1}:{x:1,y:1},ve=p0(v.convertOffsetParentRelativeRectToViewportRelativeRect?await v.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:Ce,offsetParent:Re,strategy:I}):Ce);return{top:(be.top-ve.top+le.top)/De.y,bottom:(ve.bottom-be.bottom+le.bottom)/De.y,left:(be.left-ve.left+le.left)/De.x,right:(ve.right-be.right+le.right)/De.x}}const VG=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var i,a;const{placement:h,middlewareData:v,rects:S,initialPlacement:o,platform:I,elements:B}=t,{mainAxis:$=!0,crossAxis:U=!0,fallbackPlacements:K,fallbackStrategy:te="bestFit",fallbackAxisSideDirection:le="none",flipAlignment:se=!0,...ue}=Pg(e,t);if((i=v.arrow)!=null&&i.alignmentOffset)return{};const be=Wd(h),Ce=Xp(o),Re=Wd(o)===o,De=await(I.isRTL==null?void 0:I.isRTL(B.floating)),ve=K||(Re||!se?[d0(o)]:FG(o)),Le=le!=="none";!K&&Le&&ve.push(...NG(o,se,le,De));const Fe=[o,...ve],lt=await gx(t,ue),xt=[];let gt=((a=v.flip)==null?void 0:a.overflows)||[];if($&&xt.push(lt[be]),U){const Ht=zG(h,S,De);xt.push(lt[Ht[0]],lt[Ht[1]])}if(gt=[...gt,{placement:h,overflows:xt}],!xt.every(Ht=>Ht<=0)){var Je,St;const Ht=(((Je=v.flip)==null?void 0:Je.index)||0)+1,Ct=Fe[Ht];if(Ct)return{data:{index:Ht,overflows:gt},reset:{placement:Ct}};let Kt=(St=gt.filter(Lt=>Lt.overflows[0]<=0).sort((Lt,et)=>Lt.overflows[1]-et.overflows[1])[0])==null?void 0:St.placement;if(!Kt)switch(te){case"bestFit":{var Nt;const Lt=(Nt=gt.filter(et=>{if(Le){const vt=Xp(et.placement);return vt===Ce||vt==="y"}return!0}).map(et=>[et.placement,et.overflows.filter(vt=>vt>0).reduce((vt,Ot)=>vt+Ot,0)]).sort((et,vt)=>et[1]-vt[1])[0])==null?void 0:Nt[0];Lt&&(Kt=Lt);break}case"initialPlacement":Kt=o;break}if(h!==Kt)return{reset:{placement:Kt}}}return{}}}};async function qG(e,t){const{placement:i,platform:a,elements:h}=e,v=await(a.isRTL==null?void 0:a.isRTL(h.floating)),S=Wd(i),o=$y(i),I=Xp(i)==="y",B=["left","top"].includes(S)?-1:1,$=v&&I?-1:1,U=Pg(t,e);let{mainAxis:K,crossAxis:te,alignmentAxis:le}=typeof U=="number"?{mainAxis:U,crossAxis:0,alignmentAxis:null}:{mainAxis:U.mainAxis||0,crossAxis:U.crossAxis||0,alignmentAxis:U.alignmentAxis};return o&&typeof le=="number"&&(te=o==="end"?le*-1:le),I?{x:te*$,y:K*B}:{x:K*B,y:te*$}}const GG=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var i,a;const{x:h,y:v,placement:S,middlewareData:o}=t,I=await qG(t,e);return S===((i=o.offset)==null?void 0:i.placement)&&(a=o.arrow)!=null&&a.alignmentOffset?{}:{x:h+I.x,y:v+I.y,data:{...I,placement:S}}}}},HG=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:a,placement:h}=t,{mainAxis:v=!0,crossAxis:S=!1,limiter:o={fn:ue=>{let{x:be,y:Ce}=ue;return{x:be,y:Ce}}},...I}=Pg(e,t),B={x:i,y:a},$=await gx(t,I),U=Xp(Wd(h)),K=wN(U);let te=B[K],le=B[U];if(v){const ue=K==="y"?"top":"left",be=K==="y"?"bottom":"right",Ce=te+$[ue],Re=te-$[be];te=Vk(Ce,te,Re)}if(S){const ue=U==="y"?"top":"left",be=U==="y"?"bottom":"right",Ce=le+$[ue],Re=le-$[be];le=Vk(Ce,le,Re)}const se=o.fn({...t,[K]:te,[U]:le});return{...se,data:{x:se.x-i,y:se.y-a,enabled:{[K]:v,[U]:S}}}}}},WG=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var i,a;const{placement:h,rects:v,platform:S,elements:o}=t,{apply:I=()=>{},...B}=Pg(e,t),$=await gx(t,B),U=Wd(h),K=$y(h),te=Xp(h)==="y",{width:le,height:se}=v.floating;let ue,be;U==="top"||U==="bottom"?(ue=U,be=K===(await(S.isRTL==null?void 0:S.isRTL(o.floating))?"start":"end")?"left":"right"):(be=U,ue=K==="end"?"top":"bottom");const Ce=se-$.top-$.bottom,Re=le-$.left-$.right,De=Zp(se-$[ue],Ce),ve=Zp(le-$[be],Re),Le=!t.middlewareData.shift;let Fe=De,lt=ve;if((i=t.middlewareData.shift)!=null&&i.enabled.x&&(lt=Re),(a=t.middlewareData.shift)!=null&&a.enabled.y&&(Fe=Ce),Le&&!K){const gt=Fl($.left,0),Je=Fl($.right,0),St=Fl($.top,0),Nt=Fl($.bottom,0);te?lt=le-2*(gt!==0||Je!==0?gt+Je:Fl($.left,$.right)):Fe=se-2*(St!==0||Nt!==0?St+Nt:Fl($.top,$.bottom))}await I({...t,availableWidth:lt,availableHeight:Fe});const xt=await S.getDimensions(o.floating);return le!==xt.width||se!==xt.height?{reset:{rects:!0}}:{}}}};function EN(e){const t=Rh(e);let i=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const h=sf(e),v=h?e.offsetWidth:i,S=h?e.offsetHeight:a,o=J_(i)!==v||J_(a)!==S;return o&&(i=v,a=S),{width:i,height:a,$:o}}function _M(e){return iu(e)?e:e.contextElement}function Xm(e){const t=_M(e);if(!sf(t))return rf(1);const i=t.getBoundingClientRect(),{width:a,height:h,$:v}=EN(t);let S=(v?J_(i.width):i.width)/a,o=(v?J_(i.height):i.height)/h;return(!S||!Number.isFinite(S))&&(S=1),(!o||!Number.isFinite(o))&&(o=1),{x:S,y:o}}const ZG=rf(0);function AN(e){const t=rc(e);return!gM()||!t.visualViewport?ZG:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function XG(e,t,i){return t===void 0&&(t=!1),!i||t&&i!==rc(e)?!1:t}function Kp(e,t,i,a){t===void 0&&(t=!1),i===void 0&&(i=!1);const h=e.getBoundingClientRect(),v=_M(e);let S=rf(1);t&&(a?iu(a)&&(S=Xm(a)):S=Xm(e));const o=XG(v,i,a)?AN(v):rf(0);let I=(h.left+o.x)/S.x,B=(h.top+o.y)/S.y,$=h.width/S.x,U=h.height/S.y;if(v){const K=rc(v),te=a&&iu(a)?rc(a):a;let le=K,se=FA(le);for(;se&&a&&te!==le;){const ue=Xm(se),be=se.getBoundingClientRect(),Ce=Rh(se),Re=be.left+(se.clientLeft+parseFloat(Ce.paddingLeft))*ue.x,De=be.top+(se.clientTop+parseFloat(Ce.paddingTop))*ue.y;I*=ue.x,B*=ue.y,$*=ue.x,U*=ue.y,I+=Re,B+=De,le=rc(se),se=FA(le)}}return p0({width:$,height:U,x:I,y:B})}function yM(e,t){const i=mx(e).scrollLeft;return t?t.left+i:Kp(cf(e)).left+i}function PN(e,t,i){i===void 0&&(i=!1);const a=e.getBoundingClientRect(),h=a.left+t.scrollLeft-(i?0:yM(e,a)),v=a.top+t.scrollTop;return{x:h,y:v}}function KG(e){let{elements:t,rect:i,offsetParent:a,strategy:h}=e;const v=h==="fixed",S=cf(a),o=t?px(t.floating):!1;if(a===S||o&&v)return i;let I={scrollLeft:0,scrollTop:0},B=rf(1);const $=rf(0),U=sf(a);if((U||!U&&!v)&&((Ag(a)!=="body"||jy(S))&&(I=mx(a)),sf(a))){const te=Kp(a);B=Xm(a),$.x=te.x+a.clientLeft,$.y=te.y+a.clientTop}const K=S&&!U&&!v?PN(S,I,!0):rf(0);return{width:i.width*B.x,height:i.height*B.y,x:i.x*B.x-I.scrollLeft*B.x+$.x+K.x,y:i.y*B.y-I.scrollTop*B.y+$.y+K.y}}function YG(e){return Array.from(e.getClientRects())}function JG(e){const t=cf(e),i=mx(e),a=e.ownerDocument.body,h=Fl(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),v=Fl(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let S=-i.scrollLeft+yM(e);const o=-i.scrollTop;return Rh(a).direction==="rtl"&&(S+=Fl(t.clientWidth,a.clientWidth)-h),{width:h,height:v,x:S,y:o}}function QG(e,t){const i=rc(e),a=cf(e),h=i.visualViewport;let v=a.clientWidth,S=a.clientHeight,o=0,I=0;if(h){v=h.width,S=h.height;const B=gM();(!B||B&&t==="fixed")&&(o=h.offsetLeft,I=h.offsetTop)}return{width:v,height:S,x:o,y:I}}function e7(e,t){const i=Kp(e,!0,t==="fixed"),a=i.top+e.clientTop,h=i.left+e.clientLeft,v=sf(e)?Xm(e):rf(1),S=e.clientWidth*v.x,o=e.clientHeight*v.y,I=h*v.x,B=a*v.y;return{width:S,height:o,x:I,y:B}}function Gk(e,t,i){let a;if(t==="viewport")a=QG(e,i);else if(t==="document")a=JG(cf(e));else if(iu(t))a=e7(t,i);else{const h=AN(e);a={x:t.x-h.x,y:t.y-h.y,width:t.width,height:t.height}}return p0(a)}function MN(e,t){const i=Hd(e);return i===t||!iu(i)||eg(i)?!1:Rh(i).position==="fixed"||MN(i,t)}function t7(e,t){const i=t.get(e);if(i)return i;let a=Y_(e,[],!1).filter(o=>iu(o)&&Ag(o)!=="body"),h=null;const v=Rh(e).position==="fixed";let S=v?Hd(e):e;for(;iu(S)&&!eg(S);){const o=Rh(S),I=mM(S);!I&&o.position==="fixed"&&(h=null),(v?!I&&!h:!I&&o.position==="static"&&!!h&&["absolute","fixed"].includes(h.position)||jy(S)&&!I&&MN(e,S))?a=a.filter($=>$!==S):h=o,S=Hd(S)}return t.set(e,a),a}function n7(e){let{element:t,boundary:i,rootBoundary:a,strategy:h}=e;const S=[...i==="clippingAncestors"?px(t)?[]:t7(t,this._c):[].concat(i),a],o=S[0],I=S.reduce((B,$)=>{const U=Gk(t,$,h);return B.top=Fl(U.top,B.top),B.right=Zp(U.right,B.right),B.bottom=Zp(U.bottom,B.bottom),B.left=Fl(U.left,B.left),B},Gk(t,o,h));return{width:I.right-I.left,height:I.bottom-I.top,x:I.left,y:I.top}}function r7(e){const{width:t,height:i}=EN(e);return{width:t,height:i}}function i7(e,t,i){const a=sf(t),h=cf(t),v=i==="fixed",S=Kp(e,!0,v,t);let o={scrollLeft:0,scrollTop:0};const I=rf(0);if(a||!a&&!v)if((Ag(t)!=="body"||jy(h))&&(o=mx(t)),a){const K=Kp(t,!0,v,t);I.x=K.x+t.clientLeft,I.y=K.y+t.clientTop}else h&&(I.x=yM(h));const B=h&&!a&&!v?PN(h,o):rf(0),$=S.left+o.scrollLeft-I.x-B.x,U=S.top+o.scrollTop-I.y-B.y;return{x:$,y:U,width:S.width,height:S.height}}function Tb(e){return Rh(e).position==="static"}function Hk(e,t){if(!sf(e)||Rh(e).position==="fixed")return null;if(t)return t(e);let i=e.offsetParent;return cf(e)===i&&(i=i.ownerDocument.body),i}function IN(e,t){const i=rc(e);if(px(e))return i;if(!sf(e)){let h=Hd(e);for(;h&&!eg(h);){if(iu(h)&&!Tb(h))return h;h=Hd(h)}return i}let a=Hk(e,t);for(;a&&OG(a)&&Tb(a);)a=Hk(a,t);return a&&eg(a)&&Tb(a)&&!mM(a)?i:a||kG(e)||i}const o7=async function(e){const t=this.getOffsetParent||IN,i=this.getDimensions,a=await i(e.floating);return{reference:i7(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function a7(e){return Rh(e).direction==="rtl"}const s7={convertOffsetParentRelativeRectToViewportRelativeRect:KG,getDocumentElement:cf,getClippingRect:n7,getOffsetParent:IN,getElementRects:o7,getClientRects:YG,getDimensions:r7,getScale:Xm,isElement:iu,isRTL:a7};function l7(e,t){let i=null,a;const h=cf(e);function v(){var o;clearTimeout(a),(o=i)==null||o.disconnect(),i=null}function S(o,I){o===void 0&&(o=!1),I===void 0&&(I=1),v();const{left:B,top:$,width:U,height:K}=e.getBoundingClientRect();if(o||t(),!U||!K)return;const te=Hv($),le=Hv(h.clientWidth-(B+U)),se=Hv(h.clientHeight-($+K)),ue=Hv(B),Ce={rootMargin:-te+"px "+-le+"px "+-se+"px "+-ue+"px",threshold:Fl(0,Zp(1,I))||1};let Re=!0;function De(ve){const Le=ve[0].intersectionRatio;if(Le!==I){if(!Re)return S();Le?S(!1,Le):a=setTimeout(()=>{S(!1,1e-7)},1e3)}Re=!1}try{i=new IntersectionObserver(De,{...Ce,root:h.ownerDocument})}catch{i=new IntersectionObserver(De,Ce)}i.observe(e)}return S(!0),v}function u7(e,t,i,a){a===void 0&&(a={});const{ancestorScroll:h=!0,ancestorResize:v=!0,elementResize:S=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:I=!1}=a,B=_M(e),$=h||v?[...B?Y_(B):[],...Y_(t)]:[];$.forEach(be=>{h&&be.addEventListener("scroll",i,{passive:!0}),v&&be.addEventListener("resize",i)});const U=B&&o?l7(B,i):null;let K=-1,te=null;S&&(te=new ResizeObserver(be=>{let[Ce]=be;Ce&&Ce.target===B&&te&&(te.unobserve(t),cancelAnimationFrame(K),K=requestAnimationFrame(()=>{var Re;(Re=te)==null||Re.observe(t)})),i()}),B&&!I&&te.observe(B),te.observe(t));let le,se=I?Kp(e):null;I&&ue();function ue(){const be=Kp(e);se&&(be.x!==se.x||be.y!==se.y||be.width!==se.width||be.height!==se.height)&&i(),se=be,le=requestAnimationFrame(ue)}return i(),()=>{var be;$.forEach(Ce=>{h&&Ce.removeEventListener("scroll",i),v&&Ce.removeEventListener("resize",i)}),U==null||U(),(be=te)==null||be.disconnect(),te=null,I&&cancelAnimationFrame(le)}}const Eb=gx,c7=GG,h7=HG,f7=VG,d7=WG,p7=(e,t,i)=>{const a=new Map,h={platform:s7,...i},v={...h.platform,_c:a};return UG(e,t,{...h,platform:v})};var l0=typeof document<"u"?rt.useLayoutEffect:rt.useEffect;function m0(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let i,a,h;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(i=e.length,i!==t.length)return!1;for(a=i;a--!==0;)if(!m0(e[a],t[a]))return!1;return!0}if(h=Object.keys(e),i=h.length,i!==Object.keys(t).length)return!1;for(a=i;a--!==0;)if(!{}.hasOwnProperty.call(t,h[a]))return!1;for(a=i;a--!==0;){const v=h[a];if(!(v==="_owner"&&e.$$typeof)&&!m0(e[v],t[v]))return!1}return!0}return e!==e&&t!==t}function CN(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Wk(e,t){const i=CN(e);return Math.round(t*i)/i}function Ab(e){const t=rt.useRef(e);return l0(()=>{t.current=e}),t}function m7(e){e===void 0&&(e={});const{placement:t="bottom",strategy:i="absolute",middleware:a=[],platform:h,elements:{reference:v,floating:S}={},transform:o=!0,whileElementsMounted:I,open:B}=e,[$,U]=rt.useState({x:0,y:0,strategy:i,placement:t,middlewareData:{},isPositioned:!1}),[K,te]=rt.useState(a);m0(K,a)||te(a);const[le,se]=rt.useState(null),[ue,be]=rt.useState(null),Ce=rt.useCallback(et=>{et!==Le.current&&(Le.current=et,se(et))},[]),Re=rt.useCallback(et=>{et!==Fe.current&&(Fe.current=et,be(et))},[]),De=v||le,ve=S||ue,Le=rt.useRef(null),Fe=rt.useRef(null),lt=rt.useRef($),xt=I!=null,gt=Ab(I),Je=Ab(h),St=Ab(B),Nt=rt.useCallback(()=>{if(!Le.current||!Fe.current)return;const et={placement:t,strategy:i,middleware:K};Je.current&&(et.platform=Je.current),p7(Le.current,Fe.current,et).then(vt=>{const Ot={...vt,isPositioned:St.current!==!1};Ht.current&&!m0(lt.current,Ot)&&(lt.current=Ot,nf.flushSync(()=>{U(Ot)}))})},[K,t,i,Je,St]);l0(()=>{B===!1&&lt.current.isPositioned&&(lt.current.isPositioned=!1,U(et=>({...et,isPositioned:!1})))},[B]);const Ht=rt.useRef(!1);l0(()=>(Ht.current=!0,()=>{Ht.current=!1}),[]),l0(()=>{if(De&&(Le.current=De),ve&&(Fe.current=ve),De&&ve){if(gt.current)return gt.current(De,ve,Nt);Nt()}},[De,ve,Nt,gt,xt]);const Ct=rt.useMemo(()=>({reference:Le,floating:Fe,setReference:Ce,setFloating:Re}),[Ce,Re]),Kt=rt.useMemo(()=>({reference:De,floating:ve}),[De,ve]),Lt=rt.useMemo(()=>{const et={position:i,left:0,top:0};if(!Kt.floating)return et;const vt=Wk(Kt.floating,$.x),Ot=Wk(Kt.floating,$.y);return o?{...et,transform:"translate("+vt+"px, "+Ot+"px)",...CN(Kt.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:vt,top:Ot}},[i,o,Kt.floating,$.x,$.y]);return rt.useMemo(()=>({...$,update:Nt,refs:Ct,elements:Kt,floatingStyles:Lt}),[$,Nt,Ct,Kt,Lt])}const ON=(e,t)=>({...c7(e),options:[e,t]}),g7=(e,t)=>({...h7(e),options:[e,t]}),_7=(e,t)=>({...f7(e),options:[e,t]}),y7=(e,t)=>({...d7(e),options:[e,t]}),kN={...MA},v7=kN.useInsertionEffect,x7=v7||(e=>e());function RN(e){const t=rt.useRef(()=>{});return x7(()=>{t.current=e}),rt.useCallback(function(){for(var i=arguments.length,a=new Array(i),h=0;h<i;h++)a[h]=arguments[h];return t.current==null?void 0:t.current(...a)},[])}var NA=typeof document<"u"?rt.useLayoutEffect:rt.useEffect;let Zk=!1,b7=0;const Xk=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+b7++;function w7(){const[e,t]=rt.useState(()=>Zk?Xk():void 0);return NA(()=>{e==null&&t(Xk())},[]),rt.useEffect(()=>{Zk=!0},[]),e}const S7=kN.useId,T7=S7||w7;function E7(){const e=new Map;return{emit(t,i){var a;(a=e.get(t))==null||a.forEach(h=>h(i))},on(t,i){e.set(t,[...e.get(t)||[],i])},off(t,i){var a;e.set(t,((a=e.get(t))==null?void 0:a.filter(h=>h!==i))||[])}}}const A7=rt.createContext(null),P7=rt.createContext(null),M7=()=>{var e;return((e=rt.useContext(A7))==null?void 0:e.id)||null},I7=()=>rt.useContext(P7),C7="data-floating-ui-focusable";function O7(e){const{open:t=!1,onOpenChange:i,elements:a}=e,h=T7(),v=rt.useRef({}),[S]=rt.useState(()=>E7()),o=M7()!=null,[I,B]=rt.useState(a.reference),$=RN((te,le,se)=>{v.current.openEvent=te?le:void 0,S.emit("openchange",{open:te,event:le,reason:se,nested:o}),i==null||i(te,le,se)}),U=rt.useMemo(()=>({setPositionReference:B}),[]),K=rt.useMemo(()=>({reference:I||a.reference||null,floating:a.floating||null,domReference:a.reference}),[I,a.reference,a.floating]);return rt.useMemo(()=>({dataRef:v,open:t,onOpenChange:$,elements:K,events:S,floatingId:h,refs:U}),[t,$,K,S,h,U])}function k7(e){e===void 0&&(e={});const{nodeId:t}=e,i=O7({...e,elements:{reference:null,floating:null,...e.elements}}),a=e.rootContext||i,h=a.elements,[v,S]=rt.useState(null),[o,I]=rt.useState(null),$=(h==null?void 0:h.domReference)||v,U=rt.useRef(null),K=I7();NA(()=>{$&&(U.current=$)},[$]);const te=m7({...e,elements:{...h,...o&&{reference:o}}}),le=rt.useCallback(Re=>{const De=iu(Re)?{getBoundingClientRect:()=>Re.getBoundingClientRect(),contextElement:Re}:Re;I(De),te.refs.setReference(De)},[te.refs]),se=rt.useCallback(Re=>{(iu(Re)||Re===null)&&(U.current=Re,S(Re)),(iu(te.refs.reference.current)||te.refs.reference.current===null||Re!==null&&!iu(Re))&&te.refs.setReference(Re)},[te.refs]),ue=rt.useMemo(()=>({...te.refs,setReference:se,setPositionReference:le,domReference:U}),[te.refs,se,le]),be=rt.useMemo(()=>({...te.elements,domReference:$}),[te.elements,$]),Ce=rt.useMemo(()=>({...te,...a,refs:ue,elements:be,nodeId:t}),[te,ue,be,t,a]);return NA(()=>{a.dataRef.current.floatingContext=Ce;const Re=K==null?void 0:K.nodesRef.current.find(De=>De.id===t);Re&&(Re.context=Ce)}),rt.useMemo(()=>({...te,context:Ce,refs:ue,elements:be}),[te,ue,be,Ce])}const Kk="active",Yk="selected";function Pb(e,t,i){const a=new Map,h=i==="item";let v=e;if(h&&e){const{[Kk]:S,[Yk]:o,...I}=e;v=I}return{...i==="floating"&&{tabIndex:-1,[C7]:""},...v,...t.map(S=>{const o=S?S[i]:null;return typeof o=="function"?e?o(e):null:o}).concat(e).reduce((S,o)=>(o&&Object.entries(o).forEach(I=>{let[B,$]=I;if(!(h&&[Kk,Yk].includes(B)))if(B.indexOf("on")===0){if(a.has(B)||a.set(B,[]),typeof $=="function"){var U;(U=a.get(B))==null||U.push($),S[B]=function(){for(var K,te=arguments.length,le=new Array(te),se=0;se<te;se++)le[se]=arguments[se];return(K=a.get(B))==null?void 0:K.map(ue=>ue(...le)).find(ue=>ue!==void 0)}}}else S[B]=$}),S),{})}}function R7(e){e===void 0&&(e=[]);const t=e.map(o=>o==null?void 0:o.reference),i=e.map(o=>o==null?void 0:o.floating),a=e.map(o=>o==null?void 0:o.item),h=rt.useCallback(o=>Pb(o,e,"reference"),t),v=rt.useCallback(o=>Pb(o,e,"floating"),i),S=rt.useCallback(o=>Pb(o,e,"item"),a);return rt.useMemo(()=>({getReferenceProps:h,getFloatingProps:v,getItemProps:S}),[h,v,S])}function Jk(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const L7=e=>({name:"inner",options:e,async fn(t){const{listRef:i,overflowRef:a,onFallbackChange:h,offset:v=0,index:S=0,minItemsVisible:o=4,referenceOverflowThreshold:I=0,scrollRef:B,...$}=Pg(e,t),{rects:U,elements:{floating:K}}=t,te=i.current[S],le=(B==null?void 0:B.current)||K,se=K.clientTop||le.clientTop,ue=K.clientTop!==0,be=le.clientTop!==0,Ce=K===le;if(!te)return{};const Re={...t,...await ON(-te.offsetTop-K.clientTop-U.reference.height/2-te.offsetHeight/2-v).fn(t)},De=await Eb(Jk(Re,le.scrollHeight+se+K.clientTop),$),ve=await Eb(Re,{...$,elementContext:"reference"}),Le=Fl(0,De.top),Fe=Re.y+Le,gt=(le.scrollHeight>le.clientHeight?Je=>Je:J_)(Fl(0,le.scrollHeight+(ue&&Ce||be?se*2:0)-Le-Fl(0,De.bottom)));if(le.style.maxHeight=gt+"px",le.scrollTop=Le,h){const Je=le.offsetHeight<te.offsetHeight*Zp(o,i.current.length)-1||ve.top>=-I||ve.bottom>=-I;nf.flushSync(()=>h(Je))}return a&&(a.current=await Eb(Jk({...Re,y:Fe},le.offsetHeight+se+K.clientTop),$)),{y:Fe}}});function D7(e,t){const{open:i,elements:a}=e,{enabled:h=!0,overflowRef:v,scrollRef:S,onChange:o}=t,I=RN(o),B=rt.useRef(!1),$=rt.useRef(null),U=rt.useRef(null);rt.useEffect(()=>{if(!h)return;function te(se){if(se.ctrlKey||!le||v.current==null)return;const ue=se.deltaY,be=v.current.top>=-.5,Ce=v.current.bottom>=-.5,Re=le.scrollHeight-le.clientHeight,De=ue<0?-1:1,ve=ue<0?"max":"min";le.scrollHeight<=le.clientHeight||(!be&&ue>0||!Ce&&ue<0?(se.preventDefault(),nf.flushSync(()=>{I(Le=>Le+Math[ve](ue,Re*De))})):/firefox/i.test(RG())&&(le.scrollTop+=ue))}const le=(S==null?void 0:S.current)||a.floating;if(i&&le)return le.addEventListener("wheel",te),requestAnimationFrame(()=>{$.current=le.scrollTop,v.current!=null&&(U.current={...v.current})}),()=>{$.current=null,U.current=null,le.removeEventListener("wheel",te)}},[h,i,a.floating,v,S,I]);const K=rt.useMemo(()=>({onKeyDown(){B.current=!0},onWheel(){B.current=!1},onPointerMove(){B.current=!1},onScroll(){const te=(S==null?void 0:S.current)||a.floating;if(!(!v.current||!te||!B.current)){if($.current!==null){const le=te.scrollTop-$.current;(v.current.bottom<-.5&&le<-1||v.current.top<-.5&&le>1)&&nf.flushSync(()=>I(se=>se+le))}requestAnimationFrame(()=>{$.current=te.scrollTop})}}}),[a.floating,I,v,S]);return rt.useMemo(()=>h?{floating:K}:{},[h,K])}let Mg=rt.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});Mg.displayName="FloatingContext";let vM=rt.createContext(null);vM.displayName="PlacementContext";function z7(e){return rt.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function F7(){return rt.useContext(Mg).setReference}function B7(){return rt.useContext(Mg).getReferenceProps}function N7(){let{getFloatingProps:e,slot:t}=rt.useContext(Mg);return rt.useCallback((...i)=>Object.assign({},e(...i),{"data-anchor":t.anchor}),[e,t])}function j7(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let t=rt.useContext(vM),i=rt.useMemo(()=>e,[JSON.stringify(e,(h,v)=>{var S;return(S=v==null?void 0:v.outerHTML)!=null?S:v})]);Cs(()=>{t==null||t(i??null)},[t,i]);let a=rt.useContext(Mg);return rt.useMemo(()=>[a.setFloating,e?a.styles:{}],[a.setFloating,e,a.styles])}let Qk=4;function $7({children:e,enabled:t=!0}){let[i,a]=rt.useState(null),[h,v]=rt.useState(0),S=rt.useRef(null),[o,I]=rt.useState(null);U7(o);let B=t&&i!==null&&o!==null,{to:$="bottom",gap:U=0,offset:K=0,padding:te=0,inner:le}=V7(i,o),[se,ue="center"]=$.split(" ");Cs(()=>{B&&v(0)},[B]);let{refs:be,floatingStyles:Ce,context:Re}=k7({open:B,placement:se==="selection"?ue==="center"?"bottom":`bottom-${ue}`:ue==="center"?`${se}`:`${se}-${ue}`,strategy:"absolute",transform:!1,middleware:[ON({mainAxis:se==="selection"?0:U,crossAxis:K}),g7({padding:te}),se!=="selection"&&_7({padding:te}),se==="selection"&&le?L7({...le,padding:te,overflowRef:S,offset:h,minItemsVisible:Qk,referenceOverflowThreshold:te,onFallbackChange(Je){var St,Nt;if(!Je)return;let Ht=Re.elements.floating;if(!Ht)return;let Ct=parseFloat(getComputedStyle(Ht).scrollPaddingBottom)||0,Kt=Math.min(Qk,Ht.childElementCount),Lt=0,et=0;for(let vt of(Nt=(St=Re.elements.floating)==null?void 0:St.childNodes)!=null?Nt:[])if(vt instanceof HTMLElement){let Ot=vt.offsetTop,mt=Ot+vt.clientHeight+Ct,zt=Ht.scrollTop,Jt=zt+Ht.clientHeight;if(Ot>=zt&&mt<=Jt)Kt--;else{et=Math.max(0,Math.min(mt,Jt)-Math.max(Ot,zt)),Lt=vt.clientHeight;break}}Kt>=1&&v(vt=>{let Ot=Lt*Kt-et+Ct;return vt>=Ot?vt:Ot})}}):null,y7({padding:te,apply({availableWidth:Je,availableHeight:St,elements:Nt}){Object.assign(Nt.floating.style,{overflow:"auto",maxWidth:`${Je}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${St}px)`})}})].filter(Boolean),whileElementsMounted:u7}),[De=se,ve=ue]=Re.placement.split("-");se==="selection"&&(De="selection");let Le=rt.useMemo(()=>({anchor:[De,ve].filter(Boolean).join(" ")}),[De,ve]),Fe=D7(Re,{overflowRef:S,onChange:v}),{getReferenceProps:lt,getFloatingProps:xt}=R7([Fe]),gt=Ha(Je=>{I(Je),be.setFloating(Je)});return rt.createElement(vM.Provider,{value:a},rt.createElement(Mg.Provider,{value:{setFloating:gt,setReference:be.setReference,styles:Ce,getReferenceProps:lt,getFloatingProps:xt,slot:Le}},e))}function U7(e){Cs(()=>{if(!e)return;let t=new MutationObserver(()=>{let i=window.getComputedStyle(e).maxHeight,a=parseFloat(i);if(isNaN(a))return;let h=parseInt(i);isNaN(h)||a!==h&&(e.style.maxHeight=`${Math.ceil(a)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}function V7(e,t){var i,a,h;let v=Mb((i=e==null?void 0:e.gap)!=null?i:"var(--anchor-gap, 0)",t),S=Mb((a=e==null?void 0:e.offset)!=null?a:"var(--anchor-offset, 0)",t),o=Mb((h=e==null?void 0:e.padding)!=null?h:"var(--anchor-padding, 0)",t);return{...e,gap:v,offset:S,padding:o}}function Mb(e,t,i=void 0){let a=hx(),h=Ha((I,B)=>{if(I==null)return[i,null];if(typeof I=="number")return[I,null];if(typeof I=="string"){if(!B)return[i,null];let $=e3(I,B);return[$,U=>{let K=LN(I);{let te=K.map(le=>window.getComputedStyle(B).getPropertyValue(le));a.requestAnimationFrame(function le(){a.nextFrame(le);let se=!1;for(let[be,Ce]of K.entries()){let Re=window.getComputedStyle(B).getPropertyValue(Ce);if(te[be]!==Re){te[be]=Re,se=!0;break}}if(!se)return;let ue=e3(I,B);$!==ue&&(U(ue),$=ue)})}return a.dispose}]}return[i,null]}),v=rt.useMemo(()=>h(e,t)[0],[e,t]),[S=v,o]=rt.useState();return Cs(()=>{let[I,B]=h(e,t);if(o(I),!!B)return B(o)},[e,t]),S}function LN(e){let t=/var\((.*)\)/.exec(e);if(t){let i=t[1].indexOf(",");if(i===-1)return[t[1]];let a=t[1].slice(0,i).trim(),h=t[1].slice(i+1).trim();return h?[a,...LN(h)]:[a]}return[]}function e3(e,t){let i=document.createElement("div");t.appendChild(i),i.style.setProperty("margin-top","0px","important"),i.style.setProperty("margin-top",e,"important");let a=parseFloat(window.getComputedStyle(i).marginTop)||0;return t.removeChild(i),a}let xM=rt.createContext(null);xM.displayName="OpenClosedContext";var Q_=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Q_||{});function q7(){return rt.useContext(xM)}function G7({value:e,children:t}){return Bt.createElement(xM.Provider,{value:e},t)}function H7(e){throw new Error("Unexpected object: "+e)}var Bl=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(Bl||{});function Ib(e,t){let i=t.resolveItems();if(i.length<=0)return null;let a=t.resolveActiveIndex(),h=a??-1;switch(e.focus){case 0:{for(let v=0;v<i.length;++v)if(!t.resolveDisabled(i[v],v,i))return v;return a}case 1:{h===-1&&(h=i.length);for(let v=h-1;v>=0;--v)if(!t.resolveDisabled(i[v],v,i))return v;return a}case 2:{for(let v=h+1;v<i.length;++v)if(!t.resolveDisabled(i[v],v,i))return v;return a}case 3:{for(let v=i.length-1;v>=0;--v)if(!t.resolveDisabled(i[v],v,i))return v;return a}case 4:{for(let v=0;v<i.length;++v)if(t.resolveId(i[v],v,i)===e.id)return v;return a}case 5:return null;default:H7(e)}}function W7(e){let t=Ha(e),i=rt.useRef(!1);rt.useEffect(()=>(i.current=!1,()=>{i.current=!0,sN(()=>{i.current&&t()})}),[t])}function Z7(){let e=typeof document>"u";return"useSyncExternalStore"in MA?(t=>t.useSyncExternalStore)(MA)(()=>()=>{},()=>!1,()=>!e):!1}function X7(){let e=Z7(),[t,i]=rt.useState(Up.isHandoffComplete);return t&&Up.isHandoffComplete===!1&&i(!1),rt.useEffect(()=>{t!==!0&&i(!0)},[t]),rt.useEffect(()=>Up.handoff(),[]),e?!1:t}let K7=rt.createContext(!1);function Y7(){return rt.useContext(K7)}function J7(e){let t=Y7(),i=rt.useContext(zN),a=pM(e),[h,v]=rt.useState(()=>{var S;if(!t&&i!==null)return(S=i.current)!=null?S:null;if(Up.isServer)return null;let o=a==null?void 0:a.getElementById("headlessui-portal-root");if(o)return o;if(a===null)return null;let I=a.createElement("div");return I.setAttribute("id","headlessui-portal-root"),a.body.appendChild(I)});return rt.useEffect(()=>{h!==null&&(a!=null&&a.body.contains(h)||a==null||a.body.appendChild(h))},[h,a]),rt.useEffect(()=>{t||i!==null&&v(i.current)},[i,v,t]),h}let DN=rt.Fragment,Q7=Kc(function(e,t){let i=e,a=rt.useRef(null),h=nd(Nq(U=>{a.current=U}),t),v=pM(a),S=J7(a),[o]=rt.useState(()=>{var U;return Up.isServer?null:(U=v==null?void 0:v.createElement("div"))!=null?U:null}),I=rt.useContext(rH),B=X7();Cs(()=>{!S||!o||S.contains(o)||(o.setAttribute("data-headlessui-portal",""),S.appendChild(o))},[S,o]),Cs(()=>{if(o&&I)return I.register(o)},[I,o]),W7(()=>{var U;!S||!o||(o instanceof Node&&S.contains(o)&&S.removeChild(o),S.childNodes.length<=0&&((U=S.parentElement)==null||U.removeChild(S)))});let $=Xc();return B?!S||!o?null:nf.createPortal($({ourProps:{ref:h},theirProps:i,slot:{},defaultTag:DN,name:"Portal"}),o):null});function eH(e,t){let i=nd(t),{enabled:a=!0,...h}=e,v=Xc();return a?Bt.createElement(Q7,{...h,ref:i}):v({ourProps:{ref:i},theirProps:h,slot:{},defaultTag:DN,name:"Portal"})}let tH=rt.Fragment,zN=rt.createContext(null);function nH(e,t){let{target:i,...a}=e,h={ref:nd(t)},v=Xc();return Bt.createElement(zN.Provider,{value:i},v({ourProps:h,theirProps:a,defaultTag:tH,name:"Popover.Group"}))}let rH=rt.createContext(null),iH=Kc(eH),oH=Kc(nH),aH=Object.assign(iH,{Group:oH});function sH(e,t){let i=rt.useRef({left:0,top:0});if(Cs(()=>{if(!t)return;let h=t.getBoundingClientRect();h&&(i.current=h)},[e,t]),t==null||!e||t===document.activeElement)return!1;let a=t.getBoundingClientRect();return a.top!==i.current.top||a.left!==i.current.left}let t3=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function n3(e){var t,i;let a=(t=e.innerText)!=null?t:"",h=e.cloneNode(!0);if(!(h instanceof HTMLElement))return a;let v=!1;for(let o of h.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))o.remove(),v=!0;let S=v?(i=h.innerText)!=null?i:"":a;return t3.test(S)&&(S=S.replace(t3,"")),S}function lH(e){let t=e.getAttribute("aria-label");if(typeof t=="string")return t.trim();let i=e.getAttribute("aria-labelledby");if(i){let a=i.split(" ").map(h=>{let v=document.getElementById(h);if(v){let S=v.getAttribute("aria-label");return typeof S=="string"?S.trim():n3(v).trim()}return null}).filter(Boolean);if(a.length>0)return a.join(", ")}return n3(e).trim()}function uH(e){let t=rt.useRef(""),i=rt.useRef("");return Ha(()=>{let a=e.current;if(!a)return"";let h=a.innerText;if(t.current===h)return i.current;let v=lH(a).trim().toLowerCase();return t.current=h,i.current=v,v})}var cH=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(cH||{}),hH=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(hH||{}),fH=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e))(fH||{});function Cb(e,t=i=>i){let i=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,a=yN(t(e.items.slice()),v=>v.dataRef.current.domRef.current),h=i?a.indexOf(i):null;return h===-1&&(h=null),{items:a,activeItemIndex:h}}let dH={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,t)=>{var i,a,h,v,S;if(e.menuState===1)return e;let o={...e,searchQuery:"",activationTrigger:(i=t.trigger)!=null?i:1,__demoMode:!1};if(t.focus===Bl.Nothing)return{...o,activeItemIndex:null};if(t.focus===Bl.Specific)return{...o,activeItemIndex:e.items.findIndex($=>$.id===t.id)};if(t.focus===Bl.Previous){let $=e.activeItemIndex;if($!==null){let U=e.items[$].dataRef.current.domRef,K=Ib(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:te=>te.id,resolveDisabled:te=>te.dataRef.current.disabled});if(K!==null){let te=e.items[K].dataRef.current.domRef;if(((a=U.current)==null?void 0:a.previousElementSibling)===te.current||((h=te.current)==null?void 0:h.previousElementSibling)===null)return{...o,activeItemIndex:K}}}}else if(t.focus===Bl.Next){let $=e.activeItemIndex;if($!==null){let U=e.items[$].dataRef.current.domRef,K=Ib(t,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:te=>te.id,resolveDisabled:te=>te.dataRef.current.disabled});if(K!==null){let te=e.items[K].dataRef.current.domRef;if(((v=U.current)==null?void 0:v.nextElementSibling)===te.current||((S=te.current)==null?void 0:S.nextElementSibling)===null)return{...o,activeItemIndex:K}}}}let I=Cb(e),B=Ib(t,{resolveItems:()=>I.items,resolveActiveIndex:()=>I.activeItemIndex,resolveId:$=>$.id,resolveDisabled:$=>$.dataRef.current.disabled});return{...o,...I,activeItemIndex:B}},3:(e,t)=>{let i=e.searchQuery!==""?0:1,a=e.searchQuery+t.value.toLowerCase(),h=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+i).concat(e.items.slice(0,e.activeItemIndex+i)):e.items).find(S=>{var o;return((o=S.dataRef.current.textValue)==null?void 0:o.startsWith(a))&&!S.dataRef.current.disabled}),v=h?e.items.indexOf(h):-1;return v===-1||v===e.activeItemIndex?{...e,searchQuery:a}:{...e,searchQuery:a,activeItemIndex:v,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,t)=>{let i=Cb(e,a=>[...a,{id:t.id,dataRef:t.dataRef}]);return{...e,...i}},6:(e,t)=>{let i=Cb(e,a=>{let h=a.findIndex(v=>v.id===t.id);return h!==-1&&a.splice(h,1),a});return{...e,...i,activationTrigger:1}},7:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},8:(e,t)=>e.itemsElement===t.element?e:{...e,itemsElement:t.element}},bM=rt.createContext(null);bM.displayName="MenuContext";function _x(e){let t=rt.useContext(bM);if(t===null){let i=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,_x),i}return t}function pH(e,t){return Ny(t.type,dH,e,t)}let mH=rt.Fragment;function gH(e,t){let{__demoMode:i=!1,...a}=e,h=rt.useReducer(pH,{__demoMode:i,menuState:i?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:v,itemsElement:S,buttonElement:o},I]=h,B=nd(t);dG(v===0,[o,S],(le,se)=>{I({type:1}),dM(se,fM.Loose)||(le.preventDefault(),o==null||o.focus())});let $=Ha(()=>{I({type:1})}),U=rt.useMemo(()=>({open:v===0,close:$}),[v,$]),K={ref:B},te=Xc();return Bt.createElement($7,null,Bt.createElement(bM.Provider,{value:h},Bt.createElement(G7,{value:Ny(v,{0:Q_.Open,1:Q_.Closed})},te({ourProps:K,theirProps:a,slot:U,defaultTag:mH,name:"Menu"}))))}let _H="button";function yH(e,t){var i;let a=rt.useId(),{id:h=`headlessui-menu-button-${a}`,disabled:v=!1,autoFocus:S=!1,...o}=e,[I,B]=_x("Menu.Button"),$=B7(),U=nd(t,F7(),Ha(Fe=>B({type:7,element:Fe}))),K=Ha(Fe=>{switch(Fe.key){case yl.Space:case yl.Enter:case yl.ArrowDown:Fe.preventDefault(),Fe.stopPropagation(),nf.flushSync(()=>B({type:0})),B({type:2,focus:Bl.First});break;case yl.ArrowUp:Fe.preventDefault(),Fe.stopPropagation(),nf.flushSync(()=>B({type:0})),B({type:2,focus:Bl.Last});break}}),te=Ha(Fe=>{switch(Fe.key){case yl.Space:Fe.preventDefault();break}}),le=Ha(Fe=>{var lt;if(Fq(Fe.currentTarget))return Fe.preventDefault();v||(I.menuState===0?(nf.flushSync(()=>B({type:1})),(lt=I.buttonElement)==null||lt.focus({preventScroll:!0})):(Fe.preventDefault(),B({type:0})))}),{isFocusVisible:se,focusProps:ue}=wq({autoFocus:S}),{isHovered:be,hoverProps:Ce}=bq({isDisabled:v}),{pressed:Re,pressProps:De}=Mq({disabled:v}),ve=rt.useMemo(()=>({open:I.menuState===0,active:Re||I.menuState===0,disabled:v,hover:be,focus:se,autofocus:S}),[I,be,se,Re,v,S]),Le=cN($(),{ref:U,id:h,type:pG(e,I.buttonElement),"aria-haspopup":"menu","aria-controls":(i=I.itemsElement)==null?void 0:i.id,"aria-expanded":I.menuState===0,disabled:v||void 0,autoFocus:S,onKeyDown:K,onKeyUp:te,onClick:le},ue,Ce,De);return Xc()({ourProps:Le,theirProps:o,slot:ve,defaultTag:_H,name:"Menu.Button"})}let vH="div",xH=RA.RenderStrategy|RA.Static;function bH(e,t){var i,a;let h=rt.useId(),{id:v=`headlessui-menu-items-${h}`,anchor:S,portal:o=!1,modal:I=!0,transition:B=!1,...$}=e,U=z7(S),[K,te]=_x("Menu.Items"),[le,se]=j7(U),ue=N7(),[be,Ce]=rt.useState(null),Re=nd(t,U?le:null,Ha(et=>te({type:8,element:et})),Ce),De=pM(K.itemsElement);U&&(o=!0);let ve=q7(),[Le,Fe]=AG(B,be,ve!==null?(ve&Q_.Open)===Q_.Open:K.menuState===0);Qq(Le,K.buttonElement,()=>{te({type:1})});let lt=K.__demoMode?!1:I&&K.menuState===0;xG(lt,De);let xt=K.__demoMode?!1:I&&K.menuState===0;Jq(xt,{allowed:rt.useCallback(()=>[K.buttonElement,K.itemsElement],[K.buttonElement,K.itemsElement])});let gt=K.menuState!==0,Je=sH(gt,K.buttonElement)?!1:Le;rt.useEffect(()=>{let et=K.itemsElement;et&&K.menuState===0&&et!==(De==null?void 0:De.activeElement)&&et.focus({preventScroll:!0})},[K.menuState,K.itemsElement,De]),CG(K.menuState===0,{container:K.itemsElement,accept(et){return et.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:et.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(et){et.setAttribute("role","none")}});let St=hx(),Nt=Ha(et=>{var vt,Ot,mt;switch(St.dispose(),et.key){case yl.Space:if(K.searchQuery!=="")return et.preventDefault(),et.stopPropagation(),te({type:3,value:et.key});case yl.Enter:if(et.preventDefault(),et.stopPropagation(),te({type:1}),K.activeItemIndex!==null){let{dataRef:zt}=K.items[K.activeItemIndex];(Ot=(vt=zt.current)==null?void 0:vt.domRef.current)==null||Ot.click()}_N(K.buttonElement);break;case yl.ArrowDown:return et.preventDefault(),et.stopPropagation(),te({type:2,focus:Bl.Next});case yl.ArrowUp:return et.preventDefault(),et.stopPropagation(),te({type:2,focus:Bl.Previous});case yl.Home:case yl.PageUp:return et.preventDefault(),et.stopPropagation(),te({type:2,focus:Bl.First});case yl.End:case yl.PageDown:return et.preventDefault(),et.stopPropagation(),te({type:2,focus:Bl.Last});case yl.Escape:et.preventDefault(),et.stopPropagation(),nf.flushSync(()=>te({type:1})),(mt=K.buttonElement)==null||mt.focus({preventScroll:!0});break;case yl.Tab:et.preventDefault(),et.stopPropagation(),nf.flushSync(()=>te({type:1})),lG(K.buttonElement,et.shiftKey?zA.Previous:zA.Next);break;default:et.key.length===1&&(te({type:3,value:et.key}),St.setTimeout(()=>te({type:4}),350));break}}),Ht=Ha(et=>{switch(et.key){case yl.Space:et.preventDefault();break}}),Ct=rt.useMemo(()=>({open:K.menuState===0}),[K.menuState]),Kt=cN(U?ue():{},{"aria-activedescendant":K.activeItemIndex===null||(i=K.items[K.activeItemIndex])==null?void 0:i.id,"aria-labelledby":(a=K.buttonElement)==null?void 0:a.id,id:v,onKeyDown:Nt,onKeyUp:Ht,role:"menu",tabIndex:K.menuState===0?0:void 0,ref:Re,style:{...$.style,...se,"--button-width":Xq(K.buttonElement,!0).width},...EG(Fe)}),Lt=Xc();return Bt.createElement(aH,{enabled:o?e.static||Le:!1},Lt({ourProps:Kt,theirProps:$,slot:Ct,defaultTag:vH,features:xH,visible:Je,name:"Menu.Items"}))}let wH=rt.Fragment;function SH(e,t){let i=rt.useId(),{id:a=`headlessui-menu-item-${i}`,disabled:h=!1,...v}=e,[S,o]=_x("Menu.Item"),I=S.activeItemIndex!==null?S.items[S.activeItemIndex].id===a:!1,B=rt.useRef(null),$=nd(t,B);Cs(()=>{if(!S.__demoMode&&S.menuState===0&&I&&S.activationTrigger!==0)return uf().requestAnimationFrame(()=>{var Je,St;(St=(Je=B.current)==null?void 0:Je.scrollIntoView)==null||St.call(Je,{block:"nearest"})})},[S.__demoMode,B,I,S.menuState,S.activationTrigger,S.activeItemIndex]);let U=uH(B),K=rt.useRef({disabled:h,domRef:B,get textValue(){return U()}});Cs(()=>{K.current.disabled=h},[K,h]),Cs(()=>(o({type:5,id:a,dataRef:K}),()=>o({type:6,id:a})),[K,a]);let te=Ha(()=>{o({type:1})}),le=Ha(Je=>{if(h)return Je.preventDefault();o({type:1}),_N(S.buttonElement)}),se=Ha(()=>{if(h)return o({type:2,focus:Bl.Nothing});o({type:2,focus:Bl.Specific,id:a})}),ue=bG(),be=Ha(Je=>{ue.update(Je),!h&&(I||o({type:2,focus:Bl.Specific,id:a,trigger:0}))}),Ce=Ha(Je=>{ue.wasMoved(Je)&&(h||I||o({type:2,focus:Bl.Specific,id:a,trigger:0}))}),Re=Ha(Je=>{ue.wasMoved(Je)&&(h||I&&o({type:2,focus:Bl.Nothing}))}),[De,ve]=dN(),[Le,Fe]=jq(),lt=rt.useMemo(()=>({active:I,focus:I,disabled:h,close:te}),[I,h,te]),xt={id:a,ref:$,role:"menuitem",tabIndex:h===!0?void 0:-1,"aria-disabled":h===!0?!0:void 0,"aria-labelledby":De,"aria-describedby":Le,disabled:void 0,onClick:le,onFocus:se,onPointerEnter:be,onMouseEnter:be,onPointerMove:Ce,onMouseMove:Ce,onPointerLeave:Re,onMouseLeave:Re},gt=Xc();return Bt.createElement(ve,null,Bt.createElement(Fe,null,gt({ourProps:xt,theirProps:v,slot:lt,defaultTag:wH,name:"Menu.Item"})))}let TH="div";function EH(e,t){let[i,a]=dN(),h=e,v={ref:t,"aria-labelledby":i,role:"group"},S=Xc();return Bt.createElement(a,null,S({ourProps:v,theirProps:h,slot:{},defaultTag:TH,name:"Menu.Section"}))}let AH="header";function PH(e,t){let i=rt.useId(),{id:a=`headlessui-menu-heading-${i}`,...h}=e,v=cM();Cs(()=>v.register(a),[a,v.register]);let S={id:a,ref:t,role:"presentation",...v.props};return Xc()({ourProps:S,theirProps:h,slot:{},defaultTag:AH,name:"Menu.Heading"})}let MH="div";function IH(e,t){let i=e,a={ref:t,role:"separator"};return Xc()({ourProps:a,theirProps:i,slot:{},defaultTag:MH,name:"Menu.Separator"})}let CH=Kc(gH),OH=Kc(yH),kH=Kc(bH),RH=Kc(SH),LH=Kc(EH),DH=Kc(PH),zH=Kc(IH),$c=Object.assign(CH,{Button:OH,Items:kH,Item:RH,Section:LH,Heading:DH,Separator:zH});function FH({title:e,titleId:t,...i},a){return rt.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},i),e?rt.createElement("title",{id:t},e):null,rt.createElement("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const jA=rt.forwardRef(FH);var Ob,r3;function vl(){if(r3)return Ob;r3=1;var e=Array.isArray;return Ob=e,Ob}var kb,i3;function FN(){if(i3)return kb;i3=1;var e=typeof Uv=="object"&&Uv&&Uv.Object===Object&&Uv;return kb=e,kb}var Rb,o3;function Lh(){if(o3)return Rb;o3=1;var e=FN(),t=typeof self=="object"&&self&&self.Object===Object&&self,i=e||t||Function("return this")();return Rb=i,Rb}var Lb,a3;function Ig(){if(a3)return Lb;a3=1;var e=Lh(),t=e.Symbol;return Lb=t,Lb}var Db,s3;function BH(){if(s3)return Db;s3=1;var e=Ig(),t=Object.prototype,i=t.hasOwnProperty,a=t.toString,h=e?e.toStringTag:void 0;function v(S){var o=i.call(S,h),I=S[h];try{S[h]=void 0;var B=!0}catch{}var $=a.call(S);return B&&(o?S[h]=I:delete S[h]),$}return Db=v,Db}var zb,l3;function NH(){if(l3)return zb;l3=1;var e=Object.prototype,t=e.toString;function i(a){return t.call(a)}return zb=i,zb}var Fb,u3;function rd(){if(u3)return Fb;u3=1;var e=Ig(),t=BH(),i=NH(),a="[object Null]",h="[object Undefined]",v=e?e.toStringTag:void 0;function S(o){return o==null?o===void 0?h:a:v&&v in Object(o)?t(o):i(o)}return Fb=S,Fb}var Bb,c3;function Yc(){if(c3)return Bb;c3=1;function e(t){return t!=null&&typeof t=="object"}return Bb=e,Bb}var Nb,h3;function Cg(){if(h3)return Nb;h3=1;var e=rd(),t=Yc(),i="[object Symbol]";function a(h){return typeof h=="symbol"||t(h)&&e(h)==i}return Nb=a,Nb}var jb,f3;function wM(){if(f3)return jb;f3=1;var e=vl(),t=Cg(),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function h(v,S){if(e(v))return!1;var o=typeof v;return o=="number"||o=="symbol"||o=="boolean"||v==null||t(v)?!0:a.test(v)||!i.test(v)||S!=null&&v in Object(S)}return jb=h,jb}var $b,d3;function jl(){if(d3)return $b;d3=1;function e(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}return $b=e,$b}var Ub,p3;function tm(){if(p3)return Ub;p3=1;var e=rd(),t=jl(),i="[object AsyncFunction]",a="[object Function]",h="[object GeneratorFunction]",v="[object Proxy]";function S(o){if(!t(o))return!1;var I=e(o);return I==a||I==h||I==i||I==v}return Ub=S,Ub}var Vb,m3;function jH(){if(m3)return Vb;m3=1;var e=Lh(),t=e["__core-js_shared__"];return Vb=t,Vb}var qb,g3;function $H(){if(g3)return qb;g3=1;var e=jH(),t=function(){var a=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function i(a){return!!t&&t in a}return qb=i,qb}var Gb,_3;function BN(){if(_3)return Gb;_3=1;var e=Function.prototype,t=e.toString;function i(a){if(a!=null){try{return t.call(a)}catch{}try{return a+""}catch{}}return""}return Gb=i,Gb}var Hb,y3;function UH(){if(y3)return Hb;y3=1;var e=tm(),t=$H(),i=jl(),a=BN(),h=/[\\^$.*+?()[\]{}|]/g,v=/^\[object .+?Constructor\]$/,S=Function.prototype,o=Object.prototype,I=S.toString,B=o.hasOwnProperty,$=RegExp("^"+I.call(B).replace(h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function U(K){if(!i(K)||t(K))return!1;var te=e(K)?$:v;return te.test(a(K))}return Hb=U,Hb}var Wb,v3;function VH(){if(v3)return Wb;v3=1;function e(t,i){return t==null?void 0:t[i]}return Wb=e,Wb}var Zb,x3;function nm(){if(x3)return Zb;x3=1;var e=UH(),t=VH();function i(a,h){var v=t(a,h);return e(v)?v:void 0}return Zb=i,Zb}var Xb,b3;function yx(){if(b3)return Xb;b3=1;var e=nm(),t=e(Object,"create");return Xb=t,Xb}var Kb,w3;function qH(){if(w3)return Kb;w3=1;var e=yx();function t(){this.__data__=e?e(null):{},this.size=0}return Kb=t,Kb}var Yb,S3;function GH(){if(S3)return Yb;S3=1;function e(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}return Yb=e,Yb}var Jb,T3;function HH(){if(T3)return Jb;T3=1;var e=yx(),t="__lodash_hash_undefined__",i=Object.prototype,a=i.hasOwnProperty;function h(v){var S=this.__data__;if(e){var o=S[v];return o===t?void 0:o}return a.call(S,v)?S[v]:void 0}return Jb=h,Jb}var Qb,E3;function WH(){if(E3)return Qb;E3=1;var e=yx(),t=Object.prototype,i=t.hasOwnProperty;function a(h){var v=this.__data__;return e?v[h]!==void 0:i.call(v,h)}return Qb=a,Qb}var ew,A3;function ZH(){if(A3)return ew;A3=1;var e=yx(),t="__lodash_hash_undefined__";function i(a,h){var v=this.__data__;return this.size+=this.has(a)?0:1,v[a]=e&&h===void 0?t:h,this}return ew=i,ew}var tw,P3;function XH(){if(P3)return tw;P3=1;var e=qH(),t=GH(),i=HH(),a=WH(),h=ZH();function v(S){var o=-1,I=S==null?0:S.length;for(this.clear();++o<I;){var B=S[o];this.set(B[0],B[1])}}return v.prototype.clear=e,v.prototype.delete=t,v.prototype.get=i,v.prototype.has=a,v.prototype.set=h,tw=v,tw}var nw,M3;function KH(){if(M3)return nw;M3=1;function e(){this.__data__=[],this.size=0}return nw=e,nw}var rw,I3;function Og(){if(I3)return rw;I3=1;function e(t,i){return t===i||t!==t&&i!==i}return rw=e,rw}var iw,C3;function vx(){if(C3)return iw;C3=1;var e=Og();function t(i,a){for(var h=i.length;h--;)if(e(i[h][0],a))return h;return-1}return iw=t,iw}var ow,O3;function YH(){if(O3)return ow;O3=1;var e=vx(),t=Array.prototype,i=t.splice;function a(h){var v=this.__data__,S=e(v,h);if(S<0)return!1;var o=v.length-1;return S==o?v.pop():i.call(v,S,1),--this.size,!0}return ow=a,ow}var aw,k3;function JH(){if(k3)return aw;k3=1;var e=vx();function t(i){var a=this.__data__,h=e(a,i);return h<0?void 0:a[h][1]}return aw=t,aw}var sw,R3;function QH(){if(R3)return sw;R3=1;var e=vx();function t(i){return e(this.__data__,i)>-1}return sw=t,sw}var lw,L3;function e9(){if(L3)return lw;L3=1;var e=vx();function t(i,a){var h=this.__data__,v=e(h,i);return v<0?(++this.size,h.push([i,a])):h[v][1]=a,this}return lw=t,lw}var uw,D3;function xx(){if(D3)return uw;D3=1;var e=KH(),t=YH(),i=JH(),a=QH(),h=e9();function v(S){var o=-1,I=S==null?0:S.length;for(this.clear();++o<I;){var B=S[o];this.set(B[0],B[1])}}return v.prototype.clear=e,v.prototype.delete=t,v.prototype.get=i,v.prototype.has=a,v.prototype.set=h,uw=v,uw}var cw,z3;function SM(){if(z3)return cw;z3=1;var e=nm(),t=Lh(),i=e(t,"Map");return cw=i,cw}var hw,F3;function t9(){if(F3)return hw;F3=1;var e=XH(),t=xx(),i=SM();function a(){this.size=0,this.__data__={hash:new e,map:new(i||t),string:new e}}return hw=a,hw}var fw,B3;function n9(){if(B3)return fw;B3=1;function e(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}return fw=e,fw}var dw,N3;function bx(){if(N3)return dw;N3=1;var e=n9();function t(i,a){var h=i.__data__;return e(a)?h[typeof a=="string"?"string":"hash"]:h.map}return dw=t,dw}var pw,j3;function r9(){if(j3)return pw;j3=1;var e=bx();function t(i){var a=e(this,i).delete(i);return this.size-=a?1:0,a}return pw=t,pw}var mw,$3;function i9(){if($3)return mw;$3=1;var e=bx();function t(i){return e(this,i).get(i)}return mw=t,mw}var gw,U3;function o9(){if(U3)return gw;U3=1;var e=bx();function t(i){return e(this,i).has(i)}return gw=t,gw}var _w,V3;function a9(){if(V3)return _w;V3=1;var e=bx();function t(i,a){var h=e(this,i),v=h.size;return h.set(i,a),this.size+=h.size==v?0:1,this}return _w=t,_w}var yw,q3;function TM(){if(q3)return yw;q3=1;var e=t9(),t=r9(),i=i9(),a=o9(),h=a9();function v(S){var o=-1,I=S==null?0:S.length;for(this.clear();++o<I;){var B=S[o];this.set(B[0],B[1])}}return v.prototype.clear=e,v.prototype.delete=t,v.prototype.get=i,v.prototype.has=a,v.prototype.set=h,yw=v,yw}var vw,G3;function NN(){if(G3)return vw;G3=1;var e=TM(),t="Expected a function";function i(a,h){if(typeof a!="function"||h!=null&&typeof h!="function")throw new TypeError(t);var v=function(){var S=arguments,o=h?h.apply(this,S):S[0],I=v.cache;if(I.has(o))return I.get(o);var B=a.apply(this,S);return v.cache=I.set(o,B)||I,B};return v.cache=new(i.Cache||e),v}return i.Cache=e,vw=i,vw}var xw,H3;function s9(){if(H3)return xw;H3=1;var e=NN(),t=500;function i(a){var h=e(a,function(S){return v.size===t&&v.clear(),S}),v=h.cache;return h}return xw=i,xw}var bw,W3;function l9(){if(W3)return bw;W3=1;var e=s9(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=e(function(h){var v=[];return h.charCodeAt(0)===46&&v.push(""),h.replace(t,function(S,o,I,B){v.push(I?B.replace(i,"$1"):o||S)}),v});return bw=a,bw}var ww,Z3;function rm(){if(Z3)return ww;Z3=1;function e(t,i){for(var a=-1,h=t==null?0:t.length,v=Array(h);++a<h;)v[a]=i(t[a],a,t);return v}return ww=e,ww}var Sw,X3;function u9(){if(X3)return Sw;X3=1;var e=Ig(),t=rm(),i=vl(),a=Cg(),h=1/0,v=e?e.prototype:void 0,S=v?v.toString:void 0;function o(I){if(typeof I=="string")return I;if(i(I))return t(I,o)+"";if(a(I))return S?S.call(I):"";var B=I+"";return B=="0"&&1/I==-h?"-0":B}return Sw=o,Sw}var Tw,K3;function jN(){if(K3)return Tw;K3=1;var e=u9();function t(i){return i==null?"":e(i)}return Tw=t,Tw}var Ew,Y3;function Zd(){if(Y3)return Ew;Y3=1;var e=vl(),t=wM(),i=l9(),a=jN();function h(v,S){return e(v)?v:t(v,S)?[v]:i(a(v))}return Ew=h,Ew}var Aw,J3;function Xd(){if(J3)return Aw;J3=1;var e=Cg(),t=1/0;function i(a){if(typeof a=="string"||e(a))return a;var h=a+"";return h=="0"&&1/a==-t?"-0":h}return Aw=i,Aw}var Pw,Q3;function kg(){if(Q3)return Pw;Q3=1;var e=Zd(),t=Xd();function i(a,h){h=e(h,a);for(var v=0,S=h.length;a!=null&&v<S;)a=a[t(h[v++])];return v&&v==S?a:void 0}return Pw=i,Pw}var Mw,eR;function wx(){if(eR)return Mw;eR=1;var e=kg();function t(i,a,h){var v=i==null?void 0:e(i,a);return v===void 0?h:v}return Mw=t,Mw}var c9=wx();const ic=zo(c9);var Iw,tR;function h9(){if(tR)return Iw;tR=1;function e(t){return t==null}return Iw=e,Iw}var f9=h9();const ao=zo(f9);var Cw,nR;function d9(){if(nR)return Cw;nR=1;var e=rd(),t=vl(),i=Yc(),a="[object String]";function h(v){return typeof v=="string"||!t(v)&&i(v)&&e(v)==a}return Cw=h,Cw}var p9=d9();const Uy=zo(p9);var m9=tm();const Hi=zo(m9);var g9=jl();const Rg=zo(g9);var Ow={exports:{}},Vo={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rR;function _9(){if(rR)return Vo;rR=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),S=Symbol.for("react.context"),o=Symbol.for("react.server_context"),I=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),le;le=Symbol.for("react.module.reference");function se(ue){if(typeof ue=="object"&&ue!==null){var be=ue.$$typeof;switch(be){case e:switch(ue=ue.type,ue){case i:case h:case a:case B:case $:return ue;default:switch(ue=ue&&ue.$$typeof,ue){case o:case S:case I:case K:case U:case v:return ue;default:return be}}case t:return be}}}return Vo.ContextConsumer=S,Vo.ContextProvider=v,Vo.Element=e,Vo.ForwardRef=I,Vo.Fragment=i,Vo.Lazy=K,Vo.Memo=U,Vo.Portal=t,Vo.Profiler=h,Vo.StrictMode=a,Vo.Suspense=B,Vo.SuspenseList=$,Vo.isAsyncMode=function(){return!1},Vo.isConcurrentMode=function(){return!1},Vo.isContextConsumer=function(ue){return se(ue)===S},Vo.isContextProvider=function(ue){return se(ue)===v},Vo.isElement=function(ue){return typeof ue=="object"&&ue!==null&&ue.$$typeof===e},Vo.isForwardRef=function(ue){return se(ue)===I},Vo.isFragment=function(ue){return se(ue)===i},Vo.isLazy=function(ue){return se(ue)===K},Vo.isMemo=function(ue){return se(ue)===U},Vo.isPortal=function(ue){return se(ue)===t},Vo.isProfiler=function(ue){return se(ue)===h},Vo.isStrictMode=function(ue){return se(ue)===a},Vo.isSuspense=function(ue){return se(ue)===B},Vo.isSuspenseList=function(ue){return se(ue)===$},Vo.isValidElementType=function(ue){return typeof ue=="string"||typeof ue=="function"||ue===i||ue===h||ue===a||ue===B||ue===$||ue===te||typeof ue=="object"&&ue!==null&&(ue.$$typeof===K||ue.$$typeof===U||ue.$$typeof===v||ue.$$typeof===S||ue.$$typeof===I||ue.$$typeof===le||ue.getModuleId!==void 0)},Vo.typeOf=se,Vo}var iR;function y9(){return iR||(iR=1,Ow.exports=_9()),Ow.exports}var v9=y9(),kw,oR;function $N(){if(oR)return kw;oR=1;var e=rd(),t=Yc(),i="[object Number]";function a(h){return typeof h=="number"||t(h)&&e(h)==i}return kw=a,kw}var Rw,aR;function x9(){if(aR)return Rw;aR=1;var e=$N();function t(i){return e(i)&&i!=+i}return Rw=t,Rw}var b9=x9();const Vy=zo(b9);var w9=$N();const S9=zo(w9);var ou=function(t){return t===0?0:t>0?1:-1},Bp=function(t){return Uy(t)&&t.indexOf("%")===t.length-1},gr=function(t){return S9(t)&&!Vy(t)},Zs=function(t){return gr(t)||Uy(t)},T9=0,qy=function(t){var i=++T9;return"".concat(t||"").concat(i)},au=function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!gr(t)&&!Uy(t))return a;var v;if(Bp(t)){var S=t.indexOf("%");v=i*parseFloat(t.slice(0,S))/100}else v=+t;return Vy(v)&&(v=a),h&&v>i&&(v=i),v},$m=function(t){if(!t)return null;var i=Object.keys(t);return i&&i.length?t[i[0]]:null},E9=function(t){if(!Array.isArray(t))return!1;for(var i=t.length,a={},h=0;h<i;h++)if(!a[t[h]])a[t[h]]=!0;else return!0;return!1},$d=function(t,i){return gr(t)&&gr(i)?function(a){return t+a*(i-t)}:function(){return i}};function $A(e,t,i){return!e||!e.length?null:e.find(function(a){return a&&(typeof t=="function"?t(a):ic(a,t))===i})}function Km(e,t){for(var i in e)if({}.hasOwnProperty.call(e,i)&&(!{}.hasOwnProperty.call(t,i)||e[i]!==t[i]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function UA(e){"@babel/helpers - typeof";return UA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UA(e)}var A9=["viewBox","children"],P9=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],sR=["points","pathLength"],Lw={svg:A9,polygon:sR,polyline:sR},EM=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],g0=function(t,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(rt.isValidElement(t)&&(a=t.props),!Rg(a))return null;var h={};return Object.keys(a).forEach(function(v){EM.includes(v)&&(h[v]=i||function(S){return a[v](a,S)})}),h},M9=function(t,i,a){return function(h){return t(i,a,h),null}},Yp=function(t,i,a){if(!Rg(t)||UA(t)!=="object")return null;var h=null;return Object.keys(t).forEach(function(v){var S=t[v];EM.includes(v)&&typeof S=="function"&&(h||(h={}),h[v]=M9(S,i,a))}),h},I9=["children"],C9=["children"];function lR(e,t){if(e==null)return{};var i=O9(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function O9(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}var uR={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Zf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},cR=null,Dw=null,AM=function e(t){if(t===cR&&Array.isArray(Dw))return Dw;var i=[];return rt.Children.forEach(t,function(a){ao(a)||(v9.isFragment(a)?i=i.concat(e(a.props.children)):i.push(a))}),Dw=i,cR=t,i};function Hc(e,t){var i=[],a=[];return Array.isArray(t)?a=t.map(function(h){return Zf(h)}):a=[Zf(t)],AM(e).forEach(function(h){var v=ic(h,"type.displayName")||ic(h,"type.name");a.indexOf(v)!==-1&&i.push(h)}),i}function tc(e,t){var i=Hc(e,t);return i&&i[0]}var hR=function(t){if(!t||!t.props)return!1;var i=t.props,a=i.width,h=i.height;return!(!gr(a)||a<=0||!gr(h)||h<=0)},k9=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],R9=function(t){return t&&t.type&&Uy(t.type)&&k9.indexOf(t.type)>=0},L9=function(t,i,a,h){var v,S=(v=Lw==null?void 0:Lw[h])!==null&&v!==void 0?v:[];return!Hi(t)&&(h&&S.includes(i)||P9.includes(i))||a&&EM.includes(i)},ki=function(t,i,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var h=t;if(rt.isValidElement(t)&&(h=t.props),!Rg(h))return null;var v={};return Object.keys(h).forEach(function(S){var o;L9((o=h)===null||o===void 0?void 0:o[S],S,i,a)&&(v[S]=h[S])}),v},VA=function e(t,i){if(t===i)return!0;var a=rt.Children.count(t);if(a!==rt.Children.count(i))return!1;if(a===0)return!0;if(a===1)return fR(Array.isArray(t)?t[0]:t,Array.isArray(i)?i[0]:i);for(var h=0;h<a;h++){var v=t[h],S=i[h];if(Array.isArray(v)||Array.isArray(S)){if(!e(v,S))return!1}else if(!fR(v,S))return!1}return!0},fR=function(t,i){if(ao(t)&&ao(i))return!0;if(!ao(t)&&!ao(i)){var a=t.props||{},h=a.children,v=lR(a,I9),S=i.props||{},o=S.children,I=lR(S,C9);return h&&o?Km(v,I)&&VA(h,o):!h&&!o?Km(v,I):!1}return!1},dR=function(t,i){var a=[],h={};return AM(t).forEach(function(v,S){if(R9(v))a.push(v);else if(v){var o=Zf(v.type),I=i[o]||{},B=I.handler,$=I.once;if(B&&(!$||!h[o])){var U=B(v,o,S);a.push(U),h[o]=!0}}}),a},D9=function(t){var i=t&&t.type;return i&&uR[i]?uR[i]:null},z9=function(t,i){return AM(i).indexOf(t)},F9=["children","width","height","viewBox","className","style","title","desc"];function qA(){return qA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},qA.apply(this,arguments)}function B9(e,t){if(e==null)return{};var i=N9(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function N9(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function GA(e){var t=e.children,i=e.width,a=e.height,h=e.viewBox,v=e.className,S=e.style,o=e.title,I=e.desc,B=B9(e,F9),$=h||{width:i,height:a,x:0,y:0},U=to("recharts-surface",v);return Bt.createElement("svg",qA({},ki(B,!0,"svg"),{className:U,width:i,height:a,style:S,viewBox:"".concat($.x," ").concat($.y," ").concat($.width," ").concat($.height)}),Bt.createElement("title",null,o),Bt.createElement("desc",null,I),t)}var j9=["children","className"];function HA(){return HA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},HA.apply(this,arguments)}function $9(e,t){if(e==null)return{};var i=U9(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function U9(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}var Qo=Bt.forwardRef(function(e,t){var i=e.children,a=e.className,h=$9(e,j9),v=to("recharts-layer",a);return Bt.createElement("g",HA({className:v},ki(h,!0),{ref:t}),i)}),Xf=function(t,i){for(var a=arguments.length,h=new Array(a>2?a-2:0),v=2;v<a;v++)h[v-2]=arguments[v]},zw,pR;function UN(){if(pR)return zw;pR=1;function e(t,i,a){var h=-1,v=t.length;i<0&&(i=-i>v?0:v+i),a=a>v?v:a,a<0&&(a+=v),v=i>a?0:a-i>>>0,i>>>=0;for(var S=Array(v);++h<v;)S[h]=t[h+i];return S}return zw=e,zw}var Fw,mR;function V9(){if(mR)return Fw;mR=1;var e=UN();function t(i,a,h){var v=i.length;return h=h===void 0?v:h,!a&&h>=v?i:e(i,a,h)}return Fw=t,Fw}var Bw,gR;function VN(){if(gR)return Bw;gR=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",h=t+i+a,v="\\ufe0e\\ufe0f",S="\\u200d",o=RegExp("["+S+e+h+v+"]");function I(B){return o.test(B)}return Bw=I,Bw}var Nw,_R;function q9(){if(_R)return Nw;_R=1;function e(t){return t.split("")}return Nw=e,Nw}var jw,yR;function G9(){if(yR)return jw;yR=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",h=t+i+a,v="\\ufe0e\\ufe0f",S="["+e+"]",o="["+h+"]",I="\\ud83c[\\udffb-\\udfff]",B="(?:"+o+"|"+I+")",$="[^"+e+"]",U="(?:\\ud83c[\\udde6-\\uddff]){2}",K="[\\ud800-\\udbff][\\udc00-\\udfff]",te="\\u200d",le=B+"?",se="["+v+"]?",ue="(?:"+te+"(?:"+[$,U,K].join("|")+")"+se+le+")*",be=se+le+ue,Ce="(?:"+[$+o+"?",o,U,K,S].join("|")+")",Re=RegExp(I+"(?="+I+")|"+Ce+be,"g");function De(ve){return ve.match(Re)||[]}return jw=De,jw}var $w,vR;function H9(){if(vR)return $w;vR=1;var e=q9(),t=VN(),i=G9();function a(h){return t(h)?i(h):e(h)}return $w=a,$w}var Uw,xR;function W9(){if(xR)return Uw;xR=1;var e=V9(),t=VN(),i=H9(),a=jN();function h(v){return function(S){S=a(S);var o=t(S)?i(S):void 0,I=o?o[0]:S.charAt(0),B=o?e(o,1).join(""):S.slice(1);return I[v]()+B}}return Uw=h,Uw}var Vw,bR;function Z9(){if(bR)return Vw;bR=1;var e=W9(),t=e("toUpperCase");return Vw=t,Vw}var X9=Z9();const Sx=zo(X9);function Pa(e){return function(){return e}}const qN=Math.cos,_0=Math.sin,Dh=Math.sqrt,y0=Math.PI,Tx=2*y0,WA=Math.PI,ZA=2*WA,kp=1e-6,K9=ZA-kp;function GN(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function Y9(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return GN;const i=10**t;return function(a){this._+=a[0];for(let h=1,v=a.length;h<v;++h)this._+=Math.round(arguments[h]*i)/i+a[h]}}class J9{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?GN:Y9(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,a,h){this._append`Q${+t},${+i},${this._x1=+a},${this._y1=+h}`}bezierCurveTo(t,i,a,h,v,S){this._append`C${+t},${+i},${+a},${+h},${this._x1=+v},${this._y1=+S}`}arcTo(t,i,a,h,v){if(t=+t,i=+i,a=+a,h=+h,v=+v,v<0)throw new Error(`negative radius: ${v}`);let S=this._x1,o=this._y1,I=a-t,B=h-i,$=S-t,U=o-i,K=$*$+U*U;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(K>kp)if(!(Math.abs(U*I-B*$)>kp)||!v)this._append`L${this._x1=t},${this._y1=i}`;else{let te=a-S,le=h-o,se=I*I+B*B,ue=te*te+le*le,be=Math.sqrt(se),Ce=Math.sqrt(K),Re=v*Math.tan((WA-Math.acos((se+K-ue)/(2*be*Ce)))/2),De=Re/Ce,ve=Re/be;Math.abs(De-1)>kp&&this._append`L${t+De*$},${i+De*U}`,this._append`A${v},${v},0,0,${+(U*te>$*le)},${this._x1=t+ve*I},${this._y1=i+ve*B}`}}arc(t,i,a,h,v,S){if(t=+t,i=+i,a=+a,S=!!S,a<0)throw new Error(`negative radius: ${a}`);let o=a*Math.cos(h),I=a*Math.sin(h),B=t+o,$=i+I,U=1^S,K=S?h-v:v-h;this._x1===null?this._append`M${B},${$}`:(Math.abs(this._x1-B)>kp||Math.abs(this._y1-$)>kp)&&this._append`L${B},${$}`,a&&(K<0&&(K=K%ZA+ZA),K>K9?this._append`A${a},${a},0,1,${U},${t-o},${i-I}A${a},${a},0,1,${U},${this._x1=B},${this._y1=$}`:K>kp&&this._append`A${a},${a},0,${+(K>=WA)},${U},${this._x1=t+a*Math.cos(v)},${this._y1=i+a*Math.sin(v)}`)}rect(t,i,a,h){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${a=+a}v${+h}h${-a}Z`}toString(){return this._}}function PM(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const a=Math.floor(i);if(!(a>=0))throw new RangeError(`invalid digits: ${i}`);t=a}return e},()=>new J9(t)}function MM(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function HN(e){this._context=e}HN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ex(e){return new HN(e)}function WN(e){return e[0]}function ZN(e){return e[1]}function XN(e,t){var i=Pa(!0),a=null,h=Ex,v=null,S=PM(o);e=typeof e=="function"?e:e===void 0?WN:Pa(e),t=typeof t=="function"?t:t===void 0?ZN:Pa(t);function o(I){var B,$=(I=MM(I)).length,U,K=!1,te;for(a==null&&(v=h(te=S())),B=0;B<=$;++B)!(B<$&&i(U=I[B],B,I))===K&&((K=!K)?v.lineStart():v.lineEnd()),K&&v.point(+e(U,B,I),+t(U,B,I));if(te)return v=null,te+""||null}return o.x=function(I){return arguments.length?(e=typeof I=="function"?I:Pa(+I),o):e},o.y=function(I){return arguments.length?(t=typeof I=="function"?I:Pa(+I),o):t},o.defined=function(I){return arguments.length?(i=typeof I=="function"?I:Pa(!!I),o):i},o.curve=function(I){return arguments.length?(h=I,a!=null&&(v=h(a)),o):h},o.context=function(I){return arguments.length?(I==null?a=v=null:v=h(a=I),o):a},o}function Wv(e,t,i){var a=null,h=Pa(!0),v=null,S=Ex,o=null,I=PM(B);e=typeof e=="function"?e:e===void 0?WN:Pa(+e),t=typeof t=="function"?t:Pa(t===void 0?0:+t),i=typeof i=="function"?i:i===void 0?ZN:Pa(+i);function B(U){var K,te,le,se=(U=MM(U)).length,ue,be=!1,Ce,Re=new Array(se),De=new Array(se);for(v==null&&(o=S(Ce=I())),K=0;K<=se;++K){if(!(K<se&&h(ue=U[K],K,U))===be)if(be=!be)te=K,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),le=K-1;le>=te;--le)o.point(Re[le],De[le]);o.lineEnd(),o.areaEnd()}be&&(Re[K]=+e(ue,K,U),De[K]=+t(ue,K,U),o.point(a?+a(ue,K,U):Re[K],i?+i(ue,K,U):De[K]))}if(Ce)return o=null,Ce+""||null}function $(){return XN().defined(h).curve(S).context(v)}return B.x=function(U){return arguments.length?(e=typeof U=="function"?U:Pa(+U),a=null,B):e},B.x0=function(U){return arguments.length?(e=typeof U=="function"?U:Pa(+U),B):e},B.x1=function(U){return arguments.length?(a=U==null?null:typeof U=="function"?U:Pa(+U),B):a},B.y=function(U){return arguments.length?(t=typeof U=="function"?U:Pa(+U),i=null,B):t},B.y0=function(U){return arguments.length?(t=typeof U=="function"?U:Pa(+U),B):t},B.y1=function(U){return arguments.length?(i=U==null?null:typeof U=="function"?U:Pa(+U),B):i},B.lineX0=B.lineY0=function(){return $().x(e).y(t)},B.lineY1=function(){return $().x(e).y(i)},B.lineX1=function(){return $().x(a).y(t)},B.defined=function(U){return arguments.length?(h=typeof U=="function"?U:Pa(!!U),B):h},B.curve=function(U){return arguments.length?(S=U,v!=null&&(o=S(v)),B):S},B.context=function(U){return arguments.length?(U==null?v=o=null:o=S(v=U),B):v},B}class KN{constructor(t,i){this._context=t,this._x=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,i){switch(t=+t,i=+i,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,i,t,i):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+i)/2,t,this._y0,t,i);break}}this._x0=t,this._y0=i}}function Q9(e){return new KN(e,!0)}function eW(e){return new KN(e,!1)}const IM={draw(e,t){const i=Dh(t/y0);e.moveTo(i,0),e.arc(0,0,i,0,Tx)}},tW={draw(e,t){const i=Dh(t/5)/2;e.moveTo(-3*i,-i),e.lineTo(-i,-i),e.lineTo(-i,-3*i),e.lineTo(i,-3*i),e.lineTo(i,-i),e.lineTo(3*i,-i),e.lineTo(3*i,i),e.lineTo(i,i),e.lineTo(i,3*i),e.lineTo(-i,3*i),e.lineTo(-i,i),e.lineTo(-3*i,i),e.closePath()}},YN=Dh(1/3),nW=YN*2,rW={draw(e,t){const i=Dh(t/nW),a=i*YN;e.moveTo(0,-i),e.lineTo(a,0),e.lineTo(0,i),e.lineTo(-a,0),e.closePath()}},iW={draw(e,t){const i=Dh(t),a=-i/2;e.rect(a,a,i,i)}},oW=.8908130915292852,JN=_0(y0/10)/_0(7*y0/10),aW=_0(Tx/10)*JN,sW=-qN(Tx/10)*JN,lW={draw(e,t){const i=Dh(t*oW),a=aW*i,h=sW*i;e.moveTo(0,-i),e.lineTo(a,h);for(let v=1;v<5;++v){const S=Tx*v/5,o=qN(S),I=_0(S);e.lineTo(I*i,-o*i),e.lineTo(o*a-I*h,I*a+o*h)}e.closePath()}},qw=Dh(3),uW={draw(e,t){const i=-Dh(t/(qw*3));e.moveTo(0,i*2),e.lineTo(-qw*i,-i),e.lineTo(qw*i,-i),e.closePath()}},Bc=-.5,Nc=Dh(3)/2,XA=1/Dh(12),cW=(XA/2+1)*3,hW={draw(e,t){const i=Dh(t/cW),a=i/2,h=i*XA,v=a,S=i*XA+i,o=-v,I=S;e.moveTo(a,h),e.lineTo(v,S),e.lineTo(o,I),e.lineTo(Bc*a-Nc*h,Nc*a+Bc*h),e.lineTo(Bc*v-Nc*S,Nc*v+Bc*S),e.lineTo(Bc*o-Nc*I,Nc*o+Bc*I),e.lineTo(Bc*a+Nc*h,Bc*h-Nc*a),e.lineTo(Bc*v+Nc*S,Bc*S-Nc*v),e.lineTo(Bc*o+Nc*I,Bc*I-Nc*o),e.closePath()}};function fW(e,t){let i=null,a=PM(h);e=typeof e=="function"?e:Pa(e||IM),t=typeof t=="function"?t:Pa(t===void 0?64:+t);function h(){let v;if(i||(i=v=a()),e.apply(this,arguments).draw(i,+t.apply(this,arguments)),v)return i=null,v+""||null}return h.type=function(v){return arguments.length?(e=typeof v=="function"?v:Pa(v),h):e},h.size=function(v){return arguments.length?(t=typeof v=="function"?v:Pa(+v),h):t},h.context=function(v){return arguments.length?(i=v??null,h):i},h}function v0(){}function x0(e,t,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+i)/6)}function QN(e){this._context=e}QN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:x0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:x0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function dW(e){return new QN(e)}function ej(e){this._context=e}ej.prototype={areaStart:v0,areaEnd:v0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:x0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pW(e){return new ej(e)}function tj(e){this._context=e}tj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(i,a):this._context.moveTo(i,a);break;case 3:this._point=4;default:x0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mW(e){return new tj(e)}function nj(e){this._context=e}nj.prototype={areaStart:v0,areaEnd:v0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gW(e){return new nj(e)}function wR(e){return e<0?-1:1}function SR(e,t,i){var a=e._x1-e._x0,h=t-e._x1,v=(e._y1-e._y0)/(a||h<0&&-0),S=(i-e._y1)/(h||a<0&&-0),o=(v*h+S*a)/(a+h);return(wR(v)+wR(S))*Math.min(Math.abs(v),Math.abs(S),.5*Math.abs(o))||0}function TR(e,t){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function Gw(e,t,i){var a=e._x0,h=e._y0,v=e._x1,S=e._y1,o=(v-a)/3;e._context.bezierCurveTo(a+o,h+o*t,v-o,S-o*i,v,S)}function b0(e){this._context=e}b0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Gw(this,this._t0,TR(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var i=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Gw(this,TR(this,i=SR(this,e,t)),i);break;default:Gw(this,this._t0,i=SR(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}};function rj(e){this._context=new ij(e)}(rj.prototype=Object.create(b0.prototype)).point=function(e,t){b0.prototype.point.call(this,t,e)};function ij(e){this._context=e}ij.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,i,a,h,v){this._context.bezierCurveTo(t,e,a,i,v,h)}};function _W(e){return new b0(e)}function yW(e){return new rj(e)}function oj(e){this._context=e}oj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,i=e.length;if(i)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),i===2)this._context.lineTo(e[1],t[1]);else for(var a=ER(e),h=ER(t),v=0,S=1;S<i;++v,++S)this._context.bezierCurveTo(a[0][v],h[0][v],a[1][v],h[1][v],e[S],t[S]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ER(e){var t,i=e.length-1,a,h=new Array(i),v=new Array(i),S=new Array(i);for(h[0]=0,v[0]=2,S[0]=e[0]+2*e[1],t=1;t<i-1;++t)h[t]=1,v[t]=4,S[t]=4*e[t]+2*e[t+1];for(h[i-1]=2,v[i-1]=7,S[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)a=h[t]/v[t-1],v[t]-=a,S[t]-=a*S[t-1];for(h[i-1]=S[i-1]/v[i-1],t=i-2;t>=0;--t)h[t]=(S[t]-h[t+1])/v[t];for(v[i-1]=(e[i]+h[i-1])/2,t=0;t<i-1;++t)v[t]=2*e[t+1]-h[t+1];return[h,v]}function vW(e){return new oj(e)}function Ax(e,t){this._context=e,this._t=t}Ax.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,t)}break}}this._x=e,this._y=t}};function xW(e){return new Ax(e,.5)}function bW(e){return new Ax(e,0)}function wW(e){return new Ax(e,1)}function tg(e,t){if((S=e.length)>1)for(var i=1,a,h,v=e[t[0]],S,o=v.length;i<S;++i)for(h=v,v=e[t[i]],a=0;a<o;++a)v[a][1]+=v[a][0]=isNaN(h[a][1])?h[a][0]:h[a][1]}function KA(e){for(var t=e.length,i=new Array(t);--t>=0;)i[t]=t;return i}function SW(e,t){return e[t]}function TW(e){const t=[];return t.key=e,t}function EW(){var e=Pa([]),t=KA,i=tg,a=SW;function h(v){var S=Array.from(e.apply(this,arguments),TW),o,I=S.length,B=-1,$;for(const U of v)for(o=0,++B;o<I;++o)(S[o][B]=[0,+a(U,S[o].key,B,v)]).data=U;for(o=0,$=MM(t(S));o<I;++o)S[$[o]].index=o;return i(S,$),S}return h.keys=function(v){return arguments.length?(e=typeof v=="function"?v:Pa(Array.from(v)),h):e},h.value=function(v){return arguments.length?(a=typeof v=="function"?v:Pa(+v),h):a},h.order=function(v){return arguments.length?(t=v==null?KA:typeof v=="function"?v:Pa(Array.from(v)),h):t},h.offset=function(v){return arguments.length?(i=v??tg,h):i},h}function AW(e,t){if((a=e.length)>0){for(var i,a,h=0,v=e[0].length,S;h<v;++h){for(S=i=0;i<a;++i)S+=e[i][h][1]||0;if(S)for(i=0;i<a;++i)e[i][h][1]/=S}tg(e,t)}}function PW(e,t){if((h=e.length)>0){for(var i=0,a=e[t[0]],h,v=a.length;i<v;++i){for(var S=0,o=0;S<h;++S)o+=e[S][i][1]||0;a[i][1]+=a[i][0]=-o/2}tg(e,t)}}function MW(e,t){if(!(!((S=e.length)>0)||!((v=(h=e[t[0]]).length)>0))){for(var i=0,a=1,h,v,S;a<v;++a){for(var o=0,I=0,B=0;o<S;++o){for(var $=e[t[o]],U=$[a][1]||0,K=$[a-1][1]||0,te=(U-K)/2,le=0;le<o;++le){var se=e[t[le]],ue=se[a][1]||0,be=se[a-1][1]||0;te+=ue-be}I+=U,B+=te*U}h[a-1][1]+=h[a-1][0]=i,I&&(i-=B/I)}h[a-1][1]+=h[a-1][0]=i,tg(e,t)}}function ey(e){"@babel/helpers - typeof";return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ey(e)}var IW=["type","size","sizeType"];function YA(){return YA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},YA.apply(this,arguments)}function AR(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function PR(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?AR(Object(i),!0).forEach(function(a){CW(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):AR(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function CW(e,t,i){return t=OW(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function OW(e){var t=kW(e,"string");return ey(t)=="symbol"?t:t+""}function kW(e,t){if(ey(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ey(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RW(e,t){if(e==null)return{};var i=LW(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function LW(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}var aj={symbolCircle:IM,symbolCross:tW,symbolDiamond:rW,symbolSquare:iW,symbolStar:lW,symbolTriangle:uW,symbolWye:hW},DW=Math.PI/180,zW=function(t){var i="symbol".concat(Sx(t));return aj[i]||IM},FW=function(t,i,a){if(i==="area")return t;switch(a){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var h=18*DW;return 1.25*t*t*(Math.tan(h)-Math.tan(h*2)*Math.pow(Math.tan(h),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},BW=function(t,i){aj["symbol".concat(Sx(t))]=i},CM=function(t){var i=t.type,a=i===void 0?"circle":i,h=t.size,v=h===void 0?64:h,S=t.sizeType,o=S===void 0?"area":S,I=RW(t,IW),B=PR(PR({},I),{},{type:a,size:v,sizeType:o}),$=function(){var ue=zW(a),be=fW().type(ue).size(FW(v,o,a));return be()},U=B.className,K=B.cx,te=B.cy,le=ki(B,!0);return K===+K&&te===+te&&v===+v?Bt.createElement("path",YA({},le,{className:to("recharts-symbols",U),transform:"translate(".concat(K,", ").concat(te,")"),d:$()})):null};CM.registerSymbol=BW;function ng(e){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(e)}function JA(){return JA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},JA.apply(this,arguments)}function MR(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function NW(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?MR(Object(i),!0).forEach(function(a){ty(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):MR(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function jW(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $W(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,lj(a.key),a)}}function UW(e,t,i){return t&&$W(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function VW(e,t,i){return t=w0(t),qW(e,sj()?Reflect.construct(t,i||[],w0(e).constructor):t.apply(e,i))}function qW(e,t){if(t&&(ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GW(e)}function GW(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sj=function(){return!!e})()}function w0(e){return w0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},w0(e)}function HW(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QA(e,t)}function QA(e,t){return QA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},QA(e,t)}function ty(e,t,i){return t=lj(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function lj(e){var t=WW(e,"string");return ng(t)=="symbol"?t:t+""}function WW(e,t){if(ng(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ng(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jc=32,OM=function(e){function t(){return jW(this,t),VW(this,t,arguments)}return HW(t,e),UW(t,[{key:"renderIcon",value:function(a){var h=this.props.inactiveColor,v=jc/2,S=jc/6,o=jc/3,I=a.inactive?h:a.color;if(a.type==="plainline")return Bt.createElement("line",{strokeWidth:4,fill:"none",stroke:I,strokeDasharray:a.payload.strokeDasharray,x1:0,y1:v,x2:jc,y2:v,className:"recharts-legend-icon"});if(a.type==="line")return Bt.createElement("path",{strokeWidth:4,fill:"none",stroke:I,d:"M0,".concat(v,"h").concat(o,`
            A`).concat(S,",").concat(S,",0,1,1,").concat(2*o,",").concat(v,`
            H`).concat(jc,"M").concat(2*o,",").concat(v,`
            A`).concat(S,",").concat(S,",0,1,1,").concat(o,",").concat(v),className:"recharts-legend-icon"});if(a.type==="rect")return Bt.createElement("path",{stroke:"none",fill:I,d:"M0,".concat(jc/8,"h").concat(jc,"v").concat(jc*3/4,"h").concat(-jc,"z"),className:"recharts-legend-icon"});if(Bt.isValidElement(a.legendIcon)){var B=NW({},a);return delete B.legendIcon,Bt.cloneElement(a.legendIcon,B)}return Bt.createElement(CM,{fill:I,cx:v,cy:v,size:jc,sizeType:"diameter",type:a.type})}},{key:"renderItems",value:function(){var a=this,h=this.props,v=h.payload,S=h.iconSize,o=h.layout,I=h.formatter,B=h.inactiveColor,$={x:0,y:0,width:jc,height:jc},U={display:o==="horizontal"?"inline-block":"block",marginRight:10},K={display:"inline-block",verticalAlign:"middle",marginRight:4};return v.map(function(te,le){var se=te.formatter||I,ue=to(ty(ty({"recharts-legend-item":!0},"legend-item-".concat(le),!0),"inactive",te.inactive));if(te.type==="none")return null;var be=Hi(te.value)?null:te.value;Xf(!Hi(te.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var Ce=te.inactive?B:te.color;return Bt.createElement("li",JA({className:ue,style:U,key:"legend-item-".concat(le)},Yp(a.props,te,le)),Bt.createElement(GA,{width:S,height:S,viewBox:$,style:K},a.renderIcon(te)),Bt.createElement("span",{className:"recharts-legend-item-text",style:{color:Ce}},se?se(be,te,le):be))})}},{key:"render",value:function(){var a=this.props,h=a.payload,v=a.layout,S=a.align;if(!h||!h.length)return null;var o={padding:0,margin:0,textAlign:v==="horizontal"?S:"left"};return Bt.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(rt.PureComponent);ty(OM,"displayName","Legend");ty(OM,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Hw,IR;function ZW(){if(IR)return Hw;IR=1;var e=xx();function t(){this.__data__=new e,this.size=0}return Hw=t,Hw}var Ww,CR;function XW(){if(CR)return Ww;CR=1;function e(t){var i=this.__data__,a=i.delete(t);return this.size=i.size,a}return Ww=e,Ww}var Zw,OR;function KW(){if(OR)return Zw;OR=1;function e(t){return this.__data__.get(t)}return Zw=e,Zw}var Xw,kR;function YW(){if(kR)return Xw;kR=1;function e(t){return this.__data__.has(t)}return Xw=e,Xw}var Kw,RR;function JW(){if(RR)return Kw;RR=1;var e=xx(),t=SM(),i=TM(),a=200;function h(v,S){var o=this.__data__;if(o instanceof e){var I=o.__data__;if(!t||I.length<a-1)return I.push([v,S]),this.size=++o.size,this;o=this.__data__=new i(I)}return o.set(v,S),this.size=o.size,this}return Kw=h,Kw}var Yw,LR;function Px(){if(LR)return Yw;LR=1;var e=xx(),t=ZW(),i=XW(),a=KW(),h=YW(),v=JW();function S(o){var I=this.__data__=new e(o);this.size=I.size}return S.prototype.clear=t,S.prototype.delete=i,S.prototype.get=a,S.prototype.has=h,S.prototype.set=v,Yw=S,Yw}var Jw,DR;function QW(){if(DR)return Jw;DR=1;var e="__lodash_hash_undefined__";function t(i){return this.__data__.set(i,e),this}return Jw=t,Jw}var Qw,zR;function eZ(){if(zR)return Qw;zR=1;function e(t){return this.__data__.has(t)}return Qw=e,Qw}var eS,FR;function uj(){if(FR)return eS;FR=1;var e=TM(),t=QW(),i=eZ();function a(h){var v=-1,S=h==null?0:h.length;for(this.__data__=new e;++v<S;)this.add(h[v])}return a.prototype.add=a.prototype.push=t,a.prototype.has=i,eS=a,eS}var tS,BR;function cj(){if(BR)return tS;BR=1;function e(t,i){for(var a=-1,h=t==null?0:t.length;++a<h;)if(i(t[a],a,t))return!0;return!1}return tS=e,tS}var nS,NR;function hj(){if(NR)return nS;NR=1;function e(t,i){return t.has(i)}return nS=e,nS}var rS,jR;function fj(){if(jR)return rS;jR=1;var e=uj(),t=cj(),i=hj(),a=1,h=2;function v(S,o,I,B,$,U){var K=I&a,te=S.length,le=o.length;if(te!=le&&!(K&&le>te))return!1;var se=U.get(S),ue=U.get(o);if(se&&ue)return se==o&&ue==S;var be=-1,Ce=!0,Re=I&h?new e:void 0;for(U.set(S,o),U.set(o,S);++be<te;){var De=S[be],ve=o[be];if(B)var Le=K?B(ve,De,be,o,S,U):B(De,ve,be,S,o,U);if(Le!==void 0){if(Le)continue;Ce=!1;break}if(Re){if(!t(o,function(Fe,lt){if(!i(Re,lt)&&(De===Fe||$(De,Fe,I,B,U)))return Re.push(lt)})){Ce=!1;break}}else if(!(De===ve||$(De,ve,I,B,U))){Ce=!1;break}}return U.delete(S),U.delete(o),Ce}return rS=v,rS}var iS,$R;function dj(){if($R)return iS;$R=1;var e=Lh(),t=e.Uint8Array;return iS=t,iS}var oS,UR;function pj(){if(UR)return oS;UR=1;function e(t){var i=-1,a=Array(t.size);return t.forEach(function(h,v){a[++i]=[v,h]}),a}return oS=e,oS}var aS,VR;function kM(){if(VR)return aS;VR=1;function e(t){var i=-1,a=Array(t.size);return t.forEach(function(h){a[++i]=h}),a}return aS=e,aS}var sS,qR;function tZ(){if(qR)return sS;qR=1;var e=Ig(),t=dj(),i=Og(),a=fj(),h=pj(),v=kM(),S=1,o=2,I="[object Boolean]",B="[object Date]",$="[object Error]",U="[object Map]",K="[object Number]",te="[object RegExp]",le="[object Set]",se="[object String]",ue="[object Symbol]",be="[object ArrayBuffer]",Ce="[object DataView]",Re=e?e.prototype:void 0,De=Re?Re.valueOf:void 0;function ve(Le,Fe,lt,xt,gt,Je,St){switch(lt){case Ce:if(Le.byteLength!=Fe.byteLength||Le.byteOffset!=Fe.byteOffset)return!1;Le=Le.buffer,Fe=Fe.buffer;case be:return!(Le.byteLength!=Fe.byteLength||!Je(new t(Le),new t(Fe)));case I:case B:case K:return i(+Le,+Fe);case $:return Le.name==Fe.name&&Le.message==Fe.message;case te:case se:return Le==Fe+"";case U:var Nt=h;case le:var Ht=xt&S;if(Nt||(Nt=v),Le.size!=Fe.size&&!Ht)return!1;var Ct=St.get(Le);if(Ct)return Ct==Fe;xt|=o,St.set(Le,Fe);var Kt=a(Nt(Le),Nt(Fe),xt,gt,Je,St);return St.delete(Le),Kt;case ue:if(De)return De.call(Le)==De.call(Fe)}return!1}return sS=ve,sS}var lS,GR;function RM(){if(GR)return lS;GR=1;function e(t,i){for(var a=-1,h=i.length,v=t.length;++a<h;)t[v+a]=i[a];return t}return lS=e,lS}var uS,HR;function mj(){if(HR)return uS;HR=1;var e=RM(),t=vl();function i(a,h,v){var S=h(a);return t(a)?S:e(S,v(a))}return uS=i,uS}var cS,WR;function gj(){if(WR)return cS;WR=1;function e(t,i){for(var a=-1,h=t==null?0:t.length,v=0,S=[];++a<h;){var o=t[a];i(o,a,t)&&(S[v++]=o)}return S}return cS=e,cS}var hS,ZR;function _j(){if(ZR)return hS;ZR=1;function e(){return[]}return hS=e,hS}var fS,XR;function LM(){if(XR)return fS;XR=1;var e=gj(),t=_j(),i=Object.prototype,a=i.propertyIsEnumerable,h=Object.getOwnPropertySymbols,v=h?function(S){return S==null?[]:(S=Object(S),e(h(S),function(o){return a.call(S,o)}))}:t;return fS=v,fS}var dS,KR;function nZ(){if(KR)return dS;KR=1;function e(t,i){for(var a=-1,h=Array(t);++a<t;)h[a]=i(a);return h}return dS=e,dS}var pS,YR;function rZ(){if(YR)return pS;YR=1;var e=rd(),t=Yc(),i="[object Arguments]";function a(h){return t(h)&&e(h)==i}return pS=a,pS}var mS,JR;function Mx(){if(JR)return mS;JR=1;var e=rZ(),t=Yc(),i=Object.prototype,a=i.hasOwnProperty,h=i.propertyIsEnumerable,v=e(function(){return arguments}())?e:function(S){return t(S)&&a.call(S,"callee")&&!h.call(S,"callee")};return mS=v,mS}var B_={exports:{}},gS,QR;function iZ(){if(QR)return gS;QR=1;function e(){return!1}return gS=e,gS}B_.exports;var eL;function Gy(){return eL||(eL=1,function(e,t){var i=Lh(),a=iZ(),h=t&&!t.nodeType&&t,v=h&&!0&&e&&!e.nodeType&&e,S=v&&v.exports===h,o=S?i.Buffer:void 0,I=o?o.isBuffer:void 0,B=I||a;e.exports=B}(B_,B_.exports)),B_.exports}var _S,tL;function Ix(){if(tL)return _S;tL=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function i(a,h){var v=typeof a;return h=h??e,!!h&&(v=="number"||v!="symbol"&&t.test(a))&&a>-1&&a%1==0&&a<h}return _S=i,_S}var yS,nL;function DM(){if(nL)return yS;nL=1;var e=9007199254740991;function t(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=e}return yS=t,yS}var vS,rL;function oZ(){if(rL)return vS;rL=1;var e=rd(),t=DM(),i=Yc(),a="[object Arguments]",h="[object Array]",v="[object Boolean]",S="[object Date]",o="[object Error]",I="[object Function]",B="[object Map]",$="[object Number]",U="[object Object]",K="[object RegExp]",te="[object Set]",le="[object String]",se="[object WeakMap]",ue="[object ArrayBuffer]",be="[object DataView]",Ce="[object Float32Array]",Re="[object Float64Array]",De="[object Int8Array]",ve="[object Int16Array]",Le="[object Int32Array]",Fe="[object Uint8Array]",lt="[object Uint8ClampedArray]",xt="[object Uint16Array]",gt="[object Uint32Array]",Je={};Je[Ce]=Je[Re]=Je[De]=Je[ve]=Je[Le]=Je[Fe]=Je[lt]=Je[xt]=Je[gt]=!0,Je[a]=Je[h]=Je[ue]=Je[v]=Je[be]=Je[S]=Je[o]=Je[I]=Je[B]=Je[$]=Je[U]=Je[K]=Je[te]=Je[le]=Je[se]=!1;function St(Nt){return i(Nt)&&t(Nt.length)&&!!Je[e(Nt)]}return vS=St,vS}var xS,iL;function Cx(){if(iL)return xS;iL=1;function e(t){return function(i){return t(i)}}return xS=e,xS}var N_={exports:{}};N_.exports;var oL;function zM(){return oL||(oL=1,function(e,t){var i=FN(),a=t&&!t.nodeType&&t,h=a&&!0&&e&&!e.nodeType&&e,v=h&&h.exports===a,S=v&&i.process,o=function(){try{var I=h&&h.require&&h.require("util").types;return I||S&&S.binding&&S.binding("util")}catch{}}();e.exports=o}(N_,N_.exports)),N_.exports}var bS,aL;function Ox(){if(aL)return bS;aL=1;var e=oZ(),t=Cx(),i=zM(),a=i&&i.isTypedArray,h=a?t(a):e;return bS=h,bS}var wS,sL;function yj(){if(sL)return wS;sL=1;var e=nZ(),t=Mx(),i=vl(),a=Gy(),h=Ix(),v=Ox(),S=Object.prototype,o=S.hasOwnProperty;function I(B,$){var U=i(B),K=!U&&t(B),te=!U&&!K&&a(B),le=!U&&!K&&!te&&v(B),se=U||K||te||le,ue=se?e(B.length,String):[],be=ue.length;for(var Ce in B)($||o.call(B,Ce))&&!(se&&(Ce=="length"||te&&(Ce=="offset"||Ce=="parent")||le&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||h(Ce,be)))&&ue.push(Ce);return ue}return wS=I,wS}var SS,lL;function kx(){if(lL)return SS;lL=1;var e=Object.prototype;function t(i){var a=i&&i.constructor,h=typeof a=="function"&&a.prototype||e;return i===h}return SS=t,SS}var TS,uL;function vj(){if(uL)return TS;uL=1;function e(t,i){return function(a){return t(i(a))}}return TS=e,TS}var ES,cL;function aZ(){if(cL)return ES;cL=1;var e=vj(),t=e(Object.keys,Object);return ES=t,ES}var AS,hL;function sZ(){if(hL)return AS;hL=1;var e=kx(),t=aZ(),i=Object.prototype,a=i.hasOwnProperty;function h(v){if(!e(v))return t(v);var S=[];for(var o in Object(v))a.call(v,o)&&o!="constructor"&&S.push(o);return S}return AS=h,AS}var PS,fL;function Kd(){if(fL)return PS;fL=1;var e=tm(),t=DM();function i(a){return a!=null&&t(a.length)&&!e(a)}return PS=i,PS}var MS,dL;function oc(){if(dL)return MS;dL=1;var e=yj(),t=sZ(),i=Kd();function a(h){return i(h)?e(h):t(h)}return MS=a,MS}var IS,pL;function xj(){if(pL)return IS;pL=1;var e=mj(),t=LM(),i=oc();function a(h){return e(h,i,t)}return IS=a,IS}var CS,mL;function lZ(){if(mL)return CS;mL=1;var e=xj(),t=1,i=Object.prototype,a=i.hasOwnProperty;function h(v,S,o,I,B,$){var U=o&t,K=e(v),te=K.length,le=e(S),se=le.length;if(te!=se&&!U)return!1;for(var ue=te;ue--;){var be=K[ue];if(!(U?be in S:a.call(S,be)))return!1}var Ce=$.get(v),Re=$.get(S);if(Ce&&Re)return Ce==S&&Re==v;var De=!0;$.set(v,S),$.set(S,v);for(var ve=U;++ue<te;){be=K[ue];var Le=v[be],Fe=S[be];if(I)var lt=U?I(Fe,Le,be,S,v,$):I(Le,Fe,be,v,S,$);if(!(lt===void 0?Le===Fe||B(Le,Fe,o,I,$):lt)){De=!1;break}ve||(ve=be=="constructor")}if(De&&!ve){var xt=v.constructor,gt=S.constructor;xt!=gt&&"constructor"in v&&"constructor"in S&&!(typeof xt=="function"&&xt instanceof xt&&typeof gt=="function"&&gt instanceof gt)&&(De=!1)}return $.delete(v),$.delete(S),De}return CS=h,CS}var OS,gL;function uZ(){if(gL)return OS;gL=1;var e=nm(),t=Lh(),i=e(t,"DataView");return OS=i,OS}var kS,_L;function cZ(){if(_L)return kS;_L=1;var e=nm(),t=Lh(),i=e(t,"Promise");return kS=i,kS}var RS,yL;function bj(){if(yL)return RS;yL=1;var e=nm(),t=Lh(),i=e(t,"Set");return RS=i,RS}var LS,vL;function hZ(){if(vL)return LS;vL=1;var e=nm(),t=Lh(),i=e(t,"WeakMap");return LS=i,LS}var DS,xL;function Hy(){if(xL)return DS;xL=1;var e=uZ(),t=SM(),i=cZ(),a=bj(),h=hZ(),v=rd(),S=BN(),o="[object Map]",I="[object Object]",B="[object Promise]",$="[object Set]",U="[object WeakMap]",K="[object DataView]",te=S(e),le=S(t),se=S(i),ue=S(a),be=S(h),Ce=v;return(e&&Ce(new e(new ArrayBuffer(1)))!=K||t&&Ce(new t)!=o||i&&Ce(i.resolve())!=B||a&&Ce(new a)!=$||h&&Ce(new h)!=U)&&(Ce=function(Re){var De=v(Re),ve=De==I?Re.constructor:void 0,Le=ve?S(ve):"";if(Le)switch(Le){case te:return K;case le:return o;case se:return B;case ue:return $;case be:return U}return De}),DS=Ce,DS}var zS,bL;function fZ(){if(bL)return zS;bL=1;var e=Px(),t=fj(),i=tZ(),a=lZ(),h=Hy(),v=vl(),S=Gy(),o=Ox(),I=1,B="[object Arguments]",$="[object Array]",U="[object Object]",K=Object.prototype,te=K.hasOwnProperty;function le(se,ue,be,Ce,Re,De){var ve=v(se),Le=v(ue),Fe=ve?$:h(se),lt=Le?$:h(ue);Fe=Fe==B?U:Fe,lt=lt==B?U:lt;var xt=Fe==U,gt=lt==U,Je=Fe==lt;if(Je&&S(se)){if(!S(ue))return!1;ve=!0,xt=!1}if(Je&&!xt)return De||(De=new e),ve||o(se)?t(se,ue,be,Ce,Re,De):i(se,ue,Fe,be,Ce,Re,De);if(!(be&I)){var St=xt&&te.call(se,"__wrapped__"),Nt=gt&&te.call(ue,"__wrapped__");if(St||Nt){var Ht=St?se.value():se,Ct=Nt?ue.value():ue;return De||(De=new e),Re(Ht,Ct,be,Ce,De)}}return Je?(De||(De=new e),a(se,ue,be,Ce,Re,De)):!1}return zS=le,zS}var FS,wL;function FM(){if(wL)return FS;wL=1;var e=fZ(),t=Yc();function i(a,h,v,S,o){return a===h?!0:a==null||h==null||!t(a)&&!t(h)?a!==a&&h!==h:e(a,h,v,S,i,o)}return FS=i,FS}var BS,SL;function dZ(){if(SL)return BS;SL=1;var e=Px(),t=FM(),i=1,a=2;function h(v,S,o,I){var B=o.length,$=B,U=!I;if(v==null)return!$;for(v=Object(v);B--;){var K=o[B];if(U&&K[2]?K[1]!==v[K[0]]:!(K[0]in v))return!1}for(;++B<$;){K=o[B];var te=K[0],le=v[te],se=K[1];if(U&&K[2]){if(le===void 0&&!(te in v))return!1}else{var ue=new e;if(I)var be=I(le,se,te,v,S,ue);if(!(be===void 0?t(se,le,i|a,I,ue):be))return!1}}return!0}return BS=h,BS}var NS,TL;function wj(){if(TL)return NS;TL=1;var e=jl();function t(i){return i===i&&!e(i)}return NS=t,NS}var jS,EL;function pZ(){if(EL)return jS;EL=1;var e=wj(),t=oc();function i(a){for(var h=t(a),v=h.length;v--;){var S=h[v],o=a[S];h[v]=[S,o,e(o)]}return h}return jS=i,jS}var $S,AL;function Sj(){if(AL)return $S;AL=1;function e(t,i){return function(a){return a==null?!1:a[t]===i&&(i!==void 0||t in Object(a))}}return $S=e,$S}var US,PL;function mZ(){if(PL)return US;PL=1;var e=dZ(),t=pZ(),i=Sj();function a(h){var v=t(h);return v.length==1&&v[0][2]?i(v[0][0],v[0][1]):function(S){return S===h||e(S,h,v)}}return US=a,US}var VS,ML;function gZ(){if(ML)return VS;ML=1;function e(t,i){return t!=null&&i in Object(t)}return VS=e,VS}var qS,IL;function Tj(){if(IL)return qS;IL=1;var e=Zd(),t=Mx(),i=vl(),a=Ix(),h=DM(),v=Xd();function S(o,I,B){I=e(I,o);for(var $=-1,U=I.length,K=!1;++$<U;){var te=v(I[$]);if(!(K=o!=null&&B(o,te)))break;o=o[te]}return K||++$!=U?K:(U=o==null?0:o.length,!!U&&h(U)&&a(te,U)&&(i(o)||t(o)))}return qS=S,qS}var GS,CL;function BM(){if(CL)return GS;CL=1;var e=gZ(),t=Tj();function i(a,h){return a!=null&&t(a,h,e)}return GS=i,GS}var HS,OL;function _Z(){if(OL)return HS;OL=1;var e=FM(),t=wx(),i=BM(),a=wM(),h=wj(),v=Sj(),S=Xd(),o=1,I=2;function B($,U){return a($)&&h(U)?v(S($),U):function(K){var te=t(K,$);return te===void 0&&te===U?i(K,$):e(U,te,o|I)}}return HS=B,HS}var WS,kL;function Yd(){if(kL)return WS;kL=1;function e(t){return t}return WS=e,WS}var ZS,RL;function yZ(){if(RL)return ZS;RL=1;function e(t){return function(i){return i==null?void 0:i[t]}}return ZS=e,ZS}var XS,LL;function vZ(){if(LL)return XS;LL=1;var e=kg();function t(i){return function(a){return e(a,i)}}return XS=t,XS}var KS,DL;function xZ(){if(DL)return KS;DL=1;var e=yZ(),t=vZ(),i=wM(),a=Xd();function h(v){return i(v)?e(a(v)):t(v)}return KS=h,KS}var YS,zL;function xl(){if(zL)return YS;zL=1;var e=mZ(),t=_Z(),i=Yd(),a=vl(),h=xZ();function v(S){return typeof S=="function"?S:S==null?i:typeof S=="object"?a(S)?t(S[0],S[1]):e(S):h(S)}return YS=v,YS}var JS,FL;function Ej(){if(FL)return JS;FL=1;function e(t,i,a,h){for(var v=t.length,S=a+(h?1:-1);h?S--:++S<v;)if(i(t[S],S,t))return S;return-1}return JS=e,JS}var QS,BL;function bZ(){if(BL)return QS;BL=1;function e(t){return t!==t}return QS=e,QS}var e2,NL;function wZ(){if(NL)return e2;NL=1;function e(t,i,a){for(var h=a-1,v=t.length;++h<v;)if(t[h]===i)return h;return-1}return e2=e,e2}var t2,jL;function SZ(){if(jL)return t2;jL=1;var e=Ej(),t=bZ(),i=wZ();function a(h,v,S){return v===v?i(h,v,S):e(h,t,S)}return t2=a,t2}var n2,$L;function TZ(){if($L)return n2;$L=1;var e=SZ();function t(i,a){var h=i==null?0:i.length;return!!h&&e(i,a,0)>-1}return n2=t,n2}var r2,UL;function EZ(){if(UL)return r2;UL=1;function e(t,i,a){for(var h=-1,v=t==null?0:t.length;++h<v;)if(a(i,t[h]))return!0;return!1}return r2=e,r2}var i2,VL;function AZ(){if(VL)return i2;VL=1;function e(){}return i2=e,i2}var o2,qL;function PZ(){if(qL)return o2;qL=1;var e=bj(),t=AZ(),i=kM(),a=1/0,h=e&&1/i(new e([,-0]))[1]==a?function(v){return new e(v)}:t;return o2=h,o2}var a2,GL;function MZ(){if(GL)return a2;GL=1;var e=uj(),t=TZ(),i=EZ(),a=hj(),h=PZ(),v=kM(),S=200;function o(I,B,$){var U=-1,K=t,te=I.length,le=!0,se=[],ue=se;if($)le=!1,K=i;else if(te>=S){var be=B?null:h(I);if(be)return v(be);le=!1,K=a,ue=new e}else ue=B?[]:se;e:for(;++U<te;){var Ce=I[U],Re=B?B(Ce):Ce;if(Ce=$||Ce!==0?Ce:0,le&&Re===Re){for(var De=ue.length;De--;)if(ue[De]===Re)continue e;B&&ue.push(Re),se.push(Ce)}else K(ue,Re,$)||(ue!==se&&ue.push(Re),se.push(Ce))}return se}return a2=o,a2}var s2,HL;function IZ(){if(HL)return s2;HL=1;var e=xl(),t=MZ();function i(a,h){return a&&a.length?t(a,e(h,2)):[]}return s2=i,s2}var CZ=IZ();const WL=zo(CZ);function Aj(e,t,i){return t===!0?WL(e,i):Hi(t)?WL(e,t):e}function rg(e){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}var OZ=["ref"];function ZL(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Vf(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ZL(Object(i),!0).forEach(function(a){Rx(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ZL(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function kZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XL(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Mj(a.key),a)}}function RZ(e,t,i){return t&&XL(e.prototype,t),i&&XL(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function LZ(e,t,i){return t=S0(t),DZ(e,Pj()?Reflect.construct(t,i||[],S0(e).constructor):t.apply(e,i))}function DZ(e,t){if(t&&(rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zZ(e)}function zZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pj=function(){return!!e})()}function S0(e){return S0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},S0(e)}function FZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eP(e,t)}function eP(e,t){return eP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},eP(e,t)}function Rx(e,t,i){return t=Mj(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Mj(e){var t=BZ(e,"string");return rg(t)=="symbol"?t:t+""}function BZ(e,t){if(rg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(rg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NZ(e,t){if(e==null)return{};var i=jZ(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function jZ(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function $Z(e){return e.value}function UZ(e,t){if(Bt.isValidElement(e))return Bt.cloneElement(e,t);if(typeof e=="function")return Bt.createElement(e,t);t.ref;var i=NZ(t,OZ);return Bt.createElement(OM,i)}var KL=1,Wc=function(e){function t(){var i;kZ(this,t);for(var a=arguments.length,h=new Array(a),v=0;v<a;v++)h[v]=arguments[v];return i=LZ(this,t,[].concat(h)),Rx(i,"lastBoundingBox",{width:-1,height:-1}),i}return FZ(t,e),RZ(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();return a.height=this.wrapperNode.offsetHeight,a.width=this.wrapperNode.offsetWidth,a}return null}},{key:"updateBBox",value:function(){var a=this.props.onBBoxUpdate,h=this.getBBox();h?(Math.abs(h.width-this.lastBoundingBox.width)>KL||Math.abs(h.height-this.lastBoundingBox.height)>KL)&&(this.lastBoundingBox.width=h.width,this.lastBoundingBox.height=h.height,a&&a(h)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,a&&a(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Vf({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(a){var h=this.props,v=h.layout,S=h.align,o=h.verticalAlign,I=h.margin,B=h.chartWidth,$=h.chartHeight,U,K;if(!a||(a.left===void 0||a.left===null)&&(a.right===void 0||a.right===null))if(S==="center"&&v==="vertical"){var te=this.getBBoxSnapshot();U={left:((B||0)-te.width)/2}}else U=S==="right"?{right:I&&I.right||0}:{left:I&&I.left||0};if(!a||(a.top===void 0||a.top===null)&&(a.bottom===void 0||a.bottom===null))if(o==="middle"){var le=this.getBBoxSnapshot();K={top:(($||0)-le.height)/2}}else K=o==="bottom"?{bottom:I&&I.bottom||0}:{top:I&&I.top||0};return Vf(Vf({},U),K)}},{key:"render",value:function(){var a=this,h=this.props,v=h.content,S=h.width,o=h.height,I=h.wrapperStyle,B=h.payloadUniqBy,$=h.payload,U=Vf(Vf({position:"absolute",width:S||"auto",height:o||"auto"},this.getDefaultPosition(I)),I);return Bt.createElement("div",{className:"recharts-legend-wrapper",style:U,ref:function(te){a.wrapperNode=te}},UZ(v,Vf(Vf({},this.props),{},{payload:Aj($,B,$Z)})))}}],[{key:"getWithHeight",value:function(a,h){var v=Vf(Vf({},this.defaultProps),a.props),S=v.layout;return S==="vertical"&&gr(a.props.height)?{height:a.props.height}:S==="horizontal"?{width:a.props.width||h}:null}}])}(rt.PureComponent);Rx(Wc,"displayName","Legend");Rx(Wc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var l2,YL;function VZ(){if(YL)return l2;YL=1;var e=Ig(),t=Mx(),i=vl(),a=e?e.isConcatSpreadable:void 0;function h(v){return i(v)||t(v)||!!(a&&v&&v[a])}return l2=h,l2}var u2,JL;function NM(){if(JL)return u2;JL=1;var e=RM(),t=VZ();function i(a,h,v,S,o){var I=-1,B=a.length;for(v||(v=t),o||(o=[]);++I<B;){var $=a[I];h>0&&v($)?h>1?i($,h-1,v,S,o):e(o,$):S||(o[o.length]=$)}return o}return u2=i,u2}var c2,QL;function Ij(){if(QL)return c2;QL=1;function e(t){return function(i,a,h){for(var v=-1,S=Object(i),o=h(i),I=o.length;I--;){var B=o[t?I:++v];if(a(S[B],B,S)===!1)break}return i}}return c2=e,c2}var h2,eD;function jM(){if(eD)return h2;eD=1;var e=Ij(),t=e();return h2=t,h2}var f2,tD;function im(){if(tD)return f2;tD=1;var e=jM(),t=oc();function i(a,h){return a&&e(a,h,t)}return f2=i,f2}var d2,nD;function qZ(){if(nD)return d2;nD=1;var e=Kd();function t(i,a){return function(h,v){if(h==null)return h;if(!e(h))return i(h,v);for(var S=h.length,o=a?S:-1,I=Object(h);(a?o--:++o<S)&&v(I[o],o,I)!==!1;);return h}}return d2=t,d2}var p2,rD;function $M(){if(rD)return p2;rD=1;var e=im(),t=qZ(),i=t(e);return p2=i,p2}var m2,iD;function Cj(){if(iD)return m2;iD=1;var e=$M(),t=Kd();function i(a,h){var v=-1,S=t(a)?Array(a.length):[];return e(a,function(o,I,B){S[++v]=h(o,I,B)}),S}return m2=i,m2}var g2,oD;function GZ(){if(oD)return g2;oD=1;function e(t,i){var a=t.length;for(t.sort(i);a--;)t[a]=t[a].value;return t}return g2=e,g2}var _2,aD;function HZ(){if(aD)return _2;aD=1;var e=Cg();function t(i,a){if(i!==a){var h=i!==void 0,v=i===null,S=i===i,o=e(i),I=a!==void 0,B=a===null,$=a===a,U=e(a);if(!B&&!U&&!o&&i>a||o&&I&&$&&!B&&!U||v&&I&&$||!h&&$||!S)return 1;if(!v&&!o&&!U&&i<a||U&&h&&S&&!v&&!o||B&&h&&S||!I&&S||!$)return-1}return 0}return _2=t,_2}var y2,sD;function WZ(){if(sD)return y2;sD=1;var e=HZ();function t(i,a,h){for(var v=-1,S=i.criteria,o=a.criteria,I=S.length,B=h.length;++v<I;){var $=e(S[v],o[v]);if($){if(v>=B)return $;var U=h[v];return $*(U=="desc"?-1:1)}}return i.index-a.index}return y2=t,y2}var v2,lD;function ZZ(){if(lD)return v2;lD=1;var e=rm(),t=kg(),i=xl(),a=Cj(),h=GZ(),v=Cx(),S=WZ(),o=Yd(),I=vl();function B($,U,K){U.length?U=e(U,function(se){return I(se)?function(ue){return t(ue,se.length===1?se[0]:se)}:se}):U=[o];var te=-1;U=e(U,v(i));var le=a($,function(se,ue,be){var Ce=e(U,function(Re){return Re(se)});return{criteria:Ce,index:++te,value:se}});return h(le,function(se,ue){return S(se,ue,K)})}return v2=B,v2}var x2,uD;function UM(){if(uD)return x2;uD=1;function e(t,i,a){switch(a.length){case 0:return t.call(i);case 1:return t.call(i,a[0]);case 2:return t.call(i,a[0],a[1]);case 3:return t.call(i,a[0],a[1],a[2])}return t.apply(i,a)}return x2=e,x2}var b2,cD;function Oj(){if(cD)return b2;cD=1;var e=UM(),t=Math.max;function i(a,h,v){return h=t(h===void 0?a.length-1:h,0),function(){for(var S=arguments,o=-1,I=t(S.length-h,0),B=Array(I);++o<I;)B[o]=S[h+o];o=-1;for(var $=Array(h+1);++o<h;)$[o]=S[o];return $[h]=v(B),e(a,this,$)}}return b2=i,b2}var w2,hD;function kj(){if(hD)return w2;hD=1;function e(t){return function(){return t}}return w2=e,w2}var S2,fD;function Rj(){if(fD)return S2;fD=1;var e=nm(),t=function(){try{var i=e(Object,"defineProperty");return i({},"",{}),i}catch{}}();return S2=t,S2}var T2,dD;function XZ(){if(dD)return T2;dD=1;var e=kj(),t=Rj(),i=Yd(),a=t?function(h,v){return t(h,"toString",{configurable:!0,enumerable:!1,value:e(v),writable:!0})}:i;return T2=a,T2}var E2,pD;function KZ(){if(pD)return E2;pD=1;var e=800,t=16,i=Date.now;function a(h){var v=0,S=0;return function(){var o=i(),I=t-(o-S);if(S=o,I>0){if(++v>=e)return arguments[0]}else v=0;return h.apply(void 0,arguments)}}return E2=a,E2}var A2,mD;function Lj(){if(mD)return A2;mD=1;var e=XZ(),t=KZ(),i=t(e);return A2=i,A2}var P2,gD;function Wy(){if(gD)return P2;gD=1;var e=Yd(),t=Oj(),i=Lj();function a(h,v){return i(t(h,v,e),h+"")}return P2=a,P2}var M2,_D;function Lg(){if(_D)return M2;_D=1;var e=Og(),t=Kd(),i=Ix(),a=jl();function h(v,S,o){if(!a(o))return!1;var I=typeof S;return(I=="number"?t(o)&&i(S,o.length):I=="string"&&S in o)?e(o[S],v):!1}return M2=h,M2}var I2,yD;function YZ(){if(yD)return I2;yD=1;var e=NM(),t=ZZ(),i=Wy(),a=Lg(),h=i(function(v,S){if(v==null)return[];var o=S.length;return o>1&&a(v,S[0],S[1])?S=[]:o>2&&a(S[0],S[1],S[2])&&(S=[S[0]]),t(v,e(S,1),[])});return I2=h,I2}var JZ=YZ();const VM=zo(JZ);function ny(e){"@babel/helpers - typeof";return ny=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(e)}function tP(){return tP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},tP.apply(this,arguments)}function QZ(e,t){return rX(e)||nX(e,t)||tX(e,t)||eX()}function eX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tX(e,t){if(e){if(typeof e=="string")return vD(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return vD(e,t)}}function vD(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function nX(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function rX(e){if(Array.isArray(e))return e}function xD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function C2(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?xD(Object(i),!0).forEach(function(a){iX(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xD(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function iX(e,t,i){return t=oX(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oX(e){var t=aX(e,"string");return ny(t)=="symbol"?t:t+""}function aX(e,t){if(ny(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ny(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sX(e){return Array.isArray(e)&&Zs(e[0])&&Zs(e[1])?e.join(" ~ "):e}var lX=function(t){var i=t.separator,a=i===void 0?" : ":i,h=t.contentStyle,v=h===void 0?{}:h,S=t.itemStyle,o=S===void 0?{}:S,I=t.labelStyle,B=I===void 0?{}:I,$=t.payload,U=t.formatter,K=t.itemSorter,te=t.wrapperClassName,le=t.labelClassName,se=t.label,ue=t.labelFormatter,be=t.accessibilityLayer,Ce=be===void 0?!1:be,Re=function(){if($&&$.length){var St={padding:0,margin:0},Nt=(K?VM($,K):$).map(function(Ht,Ct){if(Ht.type==="none")return null;var Kt=C2({display:"block",paddingTop:4,paddingBottom:4,color:Ht.color||"#000"},o),Lt=Ht.formatter||U||sX,et=Ht.value,vt=Ht.name,Ot=et,mt=vt;if(Lt&&Ot!=null&&mt!=null){var zt=Lt(et,vt,Ht,Ct,$);if(Array.isArray(zt)){var Jt=QZ(zt,2);Ot=Jt[0],mt=Jt[1]}else Ot=zt}return Bt.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Ct),style:Kt},Zs(mt)?Bt.createElement("span",{className:"recharts-tooltip-item-name"},mt):null,Zs(mt)?Bt.createElement("span",{className:"recharts-tooltip-item-separator"},a):null,Bt.createElement("span",{className:"recharts-tooltip-item-value"},Ot),Bt.createElement("span",{className:"recharts-tooltip-item-unit"},Ht.unit||""))});return Bt.createElement("ul",{className:"recharts-tooltip-item-list",style:St},Nt)}return null},De=C2({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},v),ve=C2({margin:0},B),Le=!ao(se),Fe=Le?se:"",lt=to("recharts-default-tooltip",te),xt=to("recharts-tooltip-label",le);Le&&ue&&$!==void 0&&$!==null&&(Fe=ue(se,$));var gt=Ce?{role:"status","aria-live":"assertive"}:{};return Bt.createElement("div",tP({className:lt,style:De},gt),Bt.createElement("p",{className:xt,style:ve},Bt.isValidElement(Fe)?Fe:"".concat(Fe)),Re())};function ry(e){"@babel/helpers - typeof";return ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ry(e)}function Zv(e,t,i){return t=uX(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function uX(e){var t=cX(e,"string");return ry(t)=="symbol"?t:t+""}function cX(e,t){if(ry(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ry(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M_="recharts-tooltip-wrapper",hX={visibility:"hidden"};function fX(e){var t=e.coordinate,i=e.translateX,a=e.translateY;return to(M_,Zv(Zv(Zv(Zv({},"".concat(M_,"-right"),gr(i)&&t&&gr(t.x)&&i>=t.x),"".concat(M_,"-left"),gr(i)&&t&&gr(t.x)&&i<t.x),"".concat(M_,"-bottom"),gr(a)&&t&&gr(t.y)&&a>=t.y),"".concat(M_,"-top"),gr(a)&&t&&gr(t.y)&&a<t.y))}function bD(e){var t=e.allowEscapeViewBox,i=e.coordinate,a=e.key,h=e.offsetTopLeft,v=e.position,S=e.reverseDirection,o=e.tooltipDimension,I=e.viewBox,B=e.viewBoxDimension;if(v&&gr(v[a]))return v[a];var $=i[a]-o-h,U=i[a]+h;if(t[a])return S[a]?$:U;if(S[a]){var K=$,te=I[a];return K<te?Math.max(U,I[a]):Math.max($,I[a])}var le=U+o,se=I[a]+B;return le>se?Math.max($,I[a]):Math.max(U,I[a])}function dX(e){var t=e.translateX,i=e.translateY,a=e.useTranslate3d;return{transform:a?"translate3d(".concat(t,"px, ").concat(i,"px, 0)"):"translate(".concat(t,"px, ").concat(i,"px)")}}function pX(e){var t=e.allowEscapeViewBox,i=e.coordinate,a=e.offsetTopLeft,h=e.position,v=e.reverseDirection,S=e.tooltipBox,o=e.useTranslate3d,I=e.viewBox,B,$,U;return S.height>0&&S.width>0&&i?($=bD({allowEscapeViewBox:t,coordinate:i,key:"x",offsetTopLeft:a,position:h,reverseDirection:v,tooltipDimension:S.width,viewBox:I,viewBoxDimension:I.width}),U=bD({allowEscapeViewBox:t,coordinate:i,key:"y",offsetTopLeft:a,position:h,reverseDirection:v,tooltipDimension:S.height,viewBox:I,viewBoxDimension:I.height}),B=dX({translateX:$,translateY:U,useTranslate3d:o})):B=hX,{cssProperties:B,cssClasses:fX({translateX:$,translateY:U,coordinate:i})}}function ig(e){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(e)}function wD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function SD(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?wD(Object(i),!0).forEach(function(a){rP(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wD(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function mX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gX(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,zj(a.key),a)}}function _X(e,t,i){return t&&gX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yX(e,t,i){return t=T0(t),vX(e,Dj()?Reflect.construct(t,i||[],T0(e).constructor):t.apply(e,i))}function vX(e,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xX(e)}function xX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dj=function(){return!!e})()}function T0(e){return T0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},T0(e)}function bX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nP(e,t)}function nP(e,t){return nP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},nP(e,t)}function rP(e,t,i){return t=zj(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function zj(e){var t=wX(e,"string");return ig(t)=="symbol"?t:t+""}function wX(e,t){if(ig(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ig(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TD=1,SX=function(e){function t(){var i;mX(this,t);for(var a=arguments.length,h=new Array(a),v=0;v<a;v++)h[v]=arguments[v];return i=yX(this,t,[].concat(h)),rP(i,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),rP(i,"handleKeyDown",function(S){if(S.key==="Escape"){var o,I,B,$;i.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(I=i.props.coordinate)===null||I===void 0?void 0:I.x)!==null&&o!==void 0?o:0,y:(B=($=i.props.coordinate)===null||$===void 0?void 0:$.y)!==null&&B!==void 0?B:0}})}}),i}return bX(t,e),_X(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var a=this.wrapperNode.getBoundingClientRect();(Math.abs(a.width-this.state.lastBoundingBox.width)>TD||Math.abs(a.height-this.state.lastBoundingBox.height)>TD)&&this.setState({lastBoundingBox:{width:a.width,height:a.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var a,h;this.props.active&&this.updateBBox(),this.state.dismissed&&(((a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==this.state.dismissedAtCoordinate.x||((h=this.props.coordinate)===null||h===void 0?void 0:h.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var a=this,h=this.props,v=h.active,S=h.allowEscapeViewBox,o=h.animationDuration,I=h.animationEasing,B=h.children,$=h.coordinate,U=h.hasPayload,K=h.isAnimationActive,te=h.offset,le=h.position,se=h.reverseDirection,ue=h.useTranslate3d,be=h.viewBox,Ce=h.wrapperStyle,Re=pX({allowEscapeViewBox:S,coordinate:$,offsetTopLeft:te,position:le,reverseDirection:se,tooltipBox:this.state.lastBoundingBox,useTranslate3d:ue,viewBox:be}),De=Re.cssClasses,ve=Re.cssProperties,Le=SD(SD({transition:K&&v?"transform ".concat(o,"ms ").concat(I):void 0},ve),{},{pointerEvents:"none",visibility:!this.state.dismissed&&v&&U?"visible":"hidden",position:"absolute",top:0,left:0},Ce);return Bt.createElement("div",{tabIndex:-1,className:De,style:Le,ref:function(lt){a.wrapperNode=lt}},B)}}])}(rt.PureComponent),TX=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Kf={isSsr:TX(),get:function(t){return Kf[t]},set:function(t,i){if(typeof t=="string")Kf[t]=i;else{var a=Object.keys(t);a&&a.length&&a.forEach(function(h){Kf[h]=t[h]})}}};function og(e){"@babel/helpers - typeof";return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(e)}function ED(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function AD(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ED(Object(i),!0).forEach(function(a){qM(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ED(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function EX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AX(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Bj(a.key),a)}}function PX(e,t,i){return t&&AX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function MX(e,t,i){return t=E0(t),IX(e,Fj()?Reflect.construct(t,i||[],E0(e).constructor):t.apply(e,i))}function IX(e,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CX(e)}function CX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fj=function(){return!!e})()}function E0(e){return E0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},E0(e)}function OX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iP(e,t)}function iP(e,t){return iP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},iP(e,t)}function qM(e,t,i){return t=Bj(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bj(e){var t=kX(e,"string");return og(t)=="symbol"?t:t+""}function kX(e,t){if(og(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(og(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RX(e){return e.dataKey}function LX(e,t){return Bt.isValidElement(e)?Bt.cloneElement(e,t):typeof e=="function"?Bt.createElement(e,t):Bt.createElement(lX,t)}var Cu=function(e){function t(){return EX(this,t),MX(this,t,arguments)}return OX(t,e),PX(t,[{key:"render",value:function(){var a=this,h=this.props,v=h.active,S=h.allowEscapeViewBox,o=h.animationDuration,I=h.animationEasing,B=h.content,$=h.coordinate,U=h.filterNull,K=h.isAnimationActive,te=h.offset,le=h.payload,se=h.payloadUniqBy,ue=h.position,be=h.reverseDirection,Ce=h.useTranslate3d,Re=h.viewBox,De=h.wrapperStyle,ve=le??[];U&&ve.length&&(ve=Aj(le.filter(function(Fe){return Fe.value!=null&&(Fe.hide!==!0||a.props.includeHidden)}),se,RX));var Le=ve.length>0;return Bt.createElement(SX,{allowEscapeViewBox:S,animationDuration:o,animationEasing:I,isAnimationActive:K,active:v,coordinate:$,hasPayload:Le,offset:te,position:ue,reverseDirection:be,useTranslate3d:Ce,viewBox:Re,wrapperStyle:De},LX(B,AD(AD({},this.props),{},{payload:ve})))}}])}(rt.PureComponent);qM(Cu,"displayName","Tooltip");qM(Cu,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Kf.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var O2,PD;function DX(){if(PD)return O2;PD=1;var e=Lh(),t=function(){return e.Date.now()};return O2=t,O2}var k2,MD;function zX(){if(MD)return k2;MD=1;var e=/\s/;function t(i){for(var a=i.length;a--&&e.test(i.charAt(a)););return a}return k2=t,k2}var R2,ID;function FX(){if(ID)return R2;ID=1;var e=zX(),t=/^\s+/;function i(a){return a&&a.slice(0,e(a)+1).replace(t,"")}return R2=i,R2}var L2,CD;function Nj(){if(CD)return L2;CD=1;var e=FX(),t=jl(),i=Cg(),a=NaN,h=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,S=/^0o[0-7]+$/i,o=parseInt;function I(B){if(typeof B=="number")return B;if(i(B))return a;if(t(B)){var $=typeof B.valueOf=="function"?B.valueOf():B;B=t($)?$+"":$}if(typeof B!="string")return B===0?B:+B;B=e(B);var U=v.test(B);return U||S.test(B)?o(B.slice(2),U?2:8):h.test(B)?a:+B}return L2=I,L2}var D2,OD;function BX(){if(OD)return D2;OD=1;var e=jl(),t=DX(),i=Nj(),a="Expected a function",h=Math.max,v=Math.min;function S(o,I,B){var $,U,K,te,le,se,ue=0,be=!1,Ce=!1,Re=!0;if(typeof o!="function")throw new TypeError(a);I=i(I)||0,e(B)&&(be=!!B.leading,Ce="maxWait"in B,K=Ce?h(i(B.maxWait)||0,I):K,Re="trailing"in B?!!B.trailing:Re);function De(Nt){var Ht=$,Ct=U;return $=U=void 0,ue=Nt,te=o.apply(Ct,Ht),te}function ve(Nt){return ue=Nt,le=setTimeout(lt,I),be?De(Nt):te}function Le(Nt){var Ht=Nt-se,Ct=Nt-ue,Kt=I-Ht;return Ce?v(Kt,K-Ct):Kt}function Fe(Nt){var Ht=Nt-se,Ct=Nt-ue;return se===void 0||Ht>=I||Ht<0||Ce&&Ct>=K}function lt(){var Nt=t();if(Fe(Nt))return xt(Nt);le=setTimeout(lt,Le(Nt))}function xt(Nt){return le=void 0,Re&&$?De(Nt):($=U=void 0,te)}function gt(){le!==void 0&&clearTimeout(le),ue=0,$=se=U=le=void 0}function Je(){return le===void 0?te:xt(t())}function St(){var Nt=t(),Ht=Fe(Nt);if($=arguments,U=this,se=Nt,Ht){if(le===void 0)return ve(se);if(Ce)return clearTimeout(le),le=setTimeout(lt,I),De(se)}return le===void 0&&(le=setTimeout(lt,I)),te}return St.cancel=gt,St.flush=Je,St}return D2=S,D2}var z2,kD;function NX(){if(kD)return z2;kD=1;var e=BX(),t=jl(),i="Expected a function";function a(h,v,S){var o=!0,I=!0;if(typeof h!="function")throw new TypeError(i);return t(S)&&(o="leading"in S?!!S.leading:o,I="trailing"in S?!!S.trailing:I),e(h,v,{leading:o,maxWait:v,trailing:I})}return z2=a,z2}var jX=NX();const jj=zo(jX);function iy(e){"@babel/helpers - typeof";return iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iy(e)}function RD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Xv(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?RD(Object(i),!0).forEach(function(a){$X(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):RD(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function $X(e,t,i){return t=UX(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function UX(e){var t=VX(e,"string");return iy(t)=="symbol"?t:t+""}function VX(e,t){if(iy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(iy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qX(e,t){return ZX(e)||WX(e,t)||HX(e,t)||GX()}function GX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HX(e,t){if(e){if(typeof e=="string")return LD(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return LD(e,t)}}function LD(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function WX(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function ZX(e){if(Array.isArray(e))return e}var oP=rt.forwardRef(function(e,t){var i=e.aspect,a=e.initialDimension,h=a===void 0?{width:-1,height:-1}:a,v=e.width,S=v===void 0?"100%":v,o=e.height,I=o===void 0?"100%":o,B=e.minWidth,$=B===void 0?0:B,U=e.minHeight,K=e.maxHeight,te=e.children,le=e.debounce,se=le===void 0?0:le,ue=e.id,be=e.className,Ce=e.onResize,Re=e.style,De=Re===void 0?{}:Re,ve=rt.useRef(null),Le=rt.useRef();Le.current=Ce,rt.useImperativeHandle(t,function(){return Object.defineProperty(ve.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ve.current},configurable:!0})});var Fe=rt.useState({containerWidth:h.width,containerHeight:h.height}),lt=qX(Fe,2),xt=lt[0],gt=lt[1],Je=rt.useCallback(function(Nt,Ht){gt(function(Ct){var Kt=Math.round(Nt),Lt=Math.round(Ht);return Ct.containerWidth===Kt&&Ct.containerHeight===Lt?Ct:{containerWidth:Kt,containerHeight:Lt}})},[]);rt.useEffect(function(){var Nt=function(vt){var Ot,mt=vt[0].contentRect,zt=mt.width,Jt=mt.height;Je(zt,Jt),(Ot=Le.current)===null||Ot===void 0||Ot.call(Le,zt,Jt)};se>0&&(Nt=jj(Nt,se,{trailing:!0,leading:!1}));var Ht=new ResizeObserver(Nt),Ct=ve.current.getBoundingClientRect(),Kt=Ct.width,Lt=Ct.height;return Je(Kt,Lt),Ht.observe(ve.current),function(){Ht.disconnect()}},[Je,se]);var St=rt.useMemo(function(){var Nt=xt.containerWidth,Ht=xt.containerHeight;if(Nt<0||Ht<0)return null;Xf(Bp(S)||Bp(I),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,S,I),Xf(!i||i>0,"The aspect(%s) must be greater than zero.",i);var Ct=Bp(S)?Nt:S,Kt=Bp(I)?Ht:I;i&&i>0&&(Ct?Kt=Ct/i:Kt&&(Ct=Kt*i),K&&Kt>K&&(Kt=K)),Xf(Ct>0||Kt>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ct,Kt,S,I,$,U,i);var Lt=!Array.isArray(te)&&Zf(te.type).endsWith("Chart");return Bt.Children.map(te,function(et){return Bt.isValidElement(et)?rt.cloneElement(et,Xv({width:Ct,height:Kt},Lt?{style:Xv({height:"100%",width:"100%",maxHeight:Kt,maxWidth:Ct},et.props.style)}:{})):et})},[i,te,I,K,U,$,xt,S]);return Bt.createElement("div",{id:ue?"".concat(ue):void 0,className:to("recharts-responsive-container",be),style:Xv(Xv({},De),{},{width:S,height:I,minWidth:$,minHeight:U,maxHeight:K}),ref:ve},St)}),Lx=function(t){return null};Lx.displayName="Cell";function oy(e){"@babel/helpers - typeof";return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oy(e)}function DD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function aP(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?DD(Object(i),!0).forEach(function(a){XX(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DD(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function XX(e,t,i){return t=KX(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function KX(e){var t=YX(e,"string");return oy(t)=="symbol"?t:t+""}function YX(e,t){if(oy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(oy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nm={widthCache:{},cacheCount:0},JX=2e3,QX={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},zD="recharts_measurement_span";function eK(e){var t=aP({},e);return Object.keys(t).forEach(function(i){t[i]||delete t[i]}),t}var G_=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Kf.isSsr)return{width:0,height:0};var a=eK(i),h=JSON.stringify({text:t,copyStyle:a});if(Nm.widthCache[h])return Nm.widthCache[h];try{var v=document.getElementById(zD);v||(v=document.createElement("span"),v.setAttribute("id",zD),v.setAttribute("aria-hidden","true"),document.body.appendChild(v));var S=aP(aP({},QX),a);Object.assign(v.style,S),v.textContent="".concat(t);var o=v.getBoundingClientRect(),I={width:o.width,height:o.height};return Nm.widthCache[h]=I,++Nm.cacheCount>JX&&(Nm.cacheCount=0,Nm.widthCache={}),I}catch{return{width:0,height:0}}},tK=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function ay(e){"@babel/helpers - typeof";return ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(e)}function A0(e,t){return oK(e)||iK(e,t)||rK(e,t)||nK()}function nK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rK(e,t){if(e){if(typeof e=="string")return FD(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return FD(e,t)}}function FD(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function iK(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t===0){if(Object(i)!==i)return;I=!1}else for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function oK(e){if(Array.isArray(e))return e}function aK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BD(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,lK(a.key),a)}}function sK(e,t,i){return t&&BD(e.prototype,t),i&&BD(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function lK(e){var t=uK(e,"string");return ay(t)=="symbol"?t:t+""}function uK(e,t){if(ay(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t);if(ay(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ND=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,jD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cK=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,hK=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,$j={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},fK=Object.keys($j),qm="NaN";function dK(e,t){return e*$j[t]}var Kv=function(){function e(t,i){aK(this,e),this.num=t,this.unit=i,this.num=t,this.unit=i,Number.isNaN(t)&&(this.unit=""),i!==""&&!cK.test(i)&&(this.num=NaN,this.unit=""),fK.includes(i)&&(this.num=dK(t,i),this.unit="px")}return sK(e,[{key:"add",value:function(i){return this.unit!==i.unit?new e(NaN,""):new e(this.num+i.num,this.unit)}},{key:"subtract",value:function(i){return this.unit!==i.unit?new e(NaN,""):new e(this.num-i.num,this.unit)}},{key:"multiply",value:function(i){return this.unit!==""&&i.unit!==""&&this.unit!==i.unit?new e(NaN,""):new e(this.num*i.num,this.unit||i.unit)}},{key:"divide",value:function(i){return this.unit!==""&&i.unit!==""&&this.unit!==i.unit?new e(NaN,""):new e(this.num/i.num,this.unit||i.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(i){var a,h=(a=hK.exec(i))!==null&&a!==void 0?a:[],v=A0(h,3),S=v[1],o=v[2];return new e(parseFloat(S),o??"")}}])}();function Uj(e){if(e.includes(qm))return qm;for(var t=e;t.includes("*")||t.includes("/");){var i,a=(i=ND.exec(t))!==null&&i!==void 0?i:[],h=A0(a,4),v=h[1],S=h[2],o=h[3],I=Kv.parse(v??""),B=Kv.parse(o??""),$=S==="*"?I.multiply(B):I.divide(B);if($.isNaN())return qm;t=t.replace(ND,$.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var U,K=(U=jD.exec(t))!==null&&U!==void 0?U:[],te=A0(K,4),le=te[1],se=te[2],ue=te[3],be=Kv.parse(le??""),Ce=Kv.parse(ue??""),Re=se==="+"?be.add(Ce):be.subtract(Ce);if(Re.isNaN())return qm;t=t.replace(jD,Re.toString())}return t}var $D=/\(([^()]*)\)/;function pK(e){for(var t=e;t.includes("(");){var i=$D.exec(t),a=A0(i,2),h=a[1];t=t.replace($D,Uj(h))}return t}function mK(e){var t=e.replace(/\s+/g,"");return t=pK(t),t=Uj(t),t}function gK(e){try{return mK(e)}catch{return qm}}function F2(e){var t=gK(e.slice(5,-1));return t===qm?"":t}var _K=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],yK=["dx","dy","angle","className","breakAll"];function sP(){return sP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},sP.apply(this,arguments)}function UD(e,t){if(e==null)return{};var i=vK(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function vK(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function VD(e,t){return SK(e)||wK(e,t)||bK(e,t)||xK()}function xK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bK(e,t){if(e){if(typeof e=="string")return qD(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qD(e,t)}}function qD(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function wK(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t===0){if(Object(i)!==i)return;I=!1}else for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function SK(e){if(Array.isArray(e))return e}var Vj=/[ \f\n\r\t\v\u2028\u2029]+/,qj=function(t){var i=t.children,a=t.breakAll,h=t.style;try{var v=[];ao(i)||(a?v=i.toString().split(""):v=i.toString().split(Vj));var S=v.map(function(I){return{word:I,width:G_(I,h).width}}),o=a?0:G_(" ",h).width;return{wordsWithComputedWidth:S,spaceWidth:o}}catch{return null}},TK=function(t,i,a,h,v){var S=t.maxLines,o=t.children,I=t.style,B=t.breakAll,$=gr(S),U=o,K=function(){var Ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ct.reduce(function(Kt,Lt){var et=Lt.word,vt=Lt.width,Ot=Kt[Kt.length-1];if(Ot&&(h==null||v||Ot.width+vt+a<Number(h)))Ot.words.push(et),Ot.width+=vt+a;else{var mt={words:[et],width:vt};Kt.push(mt)}return Kt},[])},te=K(i),le=function(Ct){return Ct.reduce(function(Kt,Lt){return Kt.width>Lt.width?Kt:Lt})};if(!$)return te;for(var se="…",ue=function(Ct){var Kt=U.slice(0,Ct),Lt=qj({breakAll:B,style:I,children:Kt+se}).wordsWithComputedWidth,et=K(Lt),vt=et.length>S||le(et).width>Number(h);return[vt,et]},be=0,Ce=U.length-1,Re=0,De;be<=Ce&&Re<=U.length-1;){var ve=Math.floor((be+Ce)/2),Le=ve-1,Fe=ue(Le),lt=VD(Fe,2),xt=lt[0],gt=lt[1],Je=ue(ve),St=VD(Je,1),Nt=St[0];if(!xt&&!Nt&&(be=ve+1),xt&&Nt&&(Ce=ve-1),!xt&&Nt){De=gt;break}Re++}return De||te},GD=function(t){var i=ao(t)?[]:t.toString().split(Vj);return[{words:i}]},EK=function(t){var i=t.width,a=t.scaleToFit,h=t.children,v=t.style,S=t.breakAll,o=t.maxLines;if((i||a)&&!Kf.isSsr){var I,B,$=qj({breakAll:S,children:h,style:v});if($){var U=$.wordsWithComputedWidth,K=$.spaceWidth;I=U,B=K}else return GD(h);return TK({breakAll:S,children:h,maxLines:o,style:v},I,B,i,a)}return GD(h)},HD="#808080",Jp=function(t){var i=t.x,a=i===void 0?0:i,h=t.y,v=h===void 0?0:h,S=t.lineHeight,o=S===void 0?"1em":S,I=t.capHeight,B=I===void 0?"0.71em":I,$=t.scaleToFit,U=$===void 0?!1:$,K=t.textAnchor,te=K===void 0?"start":K,le=t.verticalAnchor,se=le===void 0?"end":le,ue=t.fill,be=ue===void 0?HD:ue,Ce=UD(t,_K),Re=rt.useMemo(function(){return EK({breakAll:Ce.breakAll,children:Ce.children,maxLines:Ce.maxLines,scaleToFit:U,style:Ce.style,width:Ce.width})},[Ce.breakAll,Ce.children,Ce.maxLines,U,Ce.style,Ce.width]),De=Ce.dx,ve=Ce.dy,Le=Ce.angle,Fe=Ce.className,lt=Ce.breakAll,xt=UD(Ce,yK);if(!Zs(a)||!Zs(v))return null;var gt=a+(gr(De)?De:0),Je=v+(gr(ve)?ve:0),St;switch(se){case"start":St=F2("calc(".concat(B,")"));break;case"middle":St=F2("calc(".concat((Re.length-1)/2," * -").concat(o," + (").concat(B," / 2))"));break;default:St=F2("calc(".concat(Re.length-1," * -").concat(o,")"));break}var Nt=[];if(U){var Ht=Re[0].width,Ct=Ce.width;Nt.push("scale(".concat((gr(Ct)?Ct/Ht:1)/Ht,")"))}return Le&&Nt.push("rotate(".concat(Le,", ").concat(gt,", ").concat(Je,")")),Nt.length&&(xt.transform=Nt.join(" ")),Bt.createElement("text",sP({},ki(xt,!0),{x:gt,y:Je,className:to("recharts-text",Fe),textAnchor:te,fill:be.includes("url")?HD:be}),Re.map(function(Kt,Lt){var et=Kt.words.join(lt?"":" ");return Bt.createElement("tspan",{x:gt,dy:Lt===0?St:o,key:"".concat(et,"-").concat(Lt)},et)}))};function qd(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function AK(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function GM(e){let t,i,a;e.length!==2?(t=qd,i=(o,I)=>qd(e(o),I),a=(o,I)=>e(o)-I):(t=e===qd||e===AK?e:PK,i=e,a=e);function h(o,I,B=0,$=o.length){if(B<$){if(t(I,I)!==0)return $;do{const U=B+$>>>1;i(o[U],I)<0?B=U+1:$=U}while(B<$)}return B}function v(o,I,B=0,$=o.length){if(B<$){if(t(I,I)!==0)return $;do{const U=B+$>>>1;i(o[U],I)<=0?B=U+1:$=U}while(B<$)}return B}function S(o,I,B=0,$=o.length){const U=h(o,I,B,$-1);return U>B&&a(o[U-1],I)>-a(o[U],I)?U-1:U}return{left:h,center:S,right:v}}function PK(){return 0}function Gj(e){return e===null?NaN:+e}function*MK(e,t){for(let i of e)i!=null&&(i=+i)>=i&&(yield i)}const IK=GM(qd),Zy=IK.right;GM(Gj).center;class WD extends Map{constructor(t,i=kK){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),t!=null)for(const[a,h]of t)this.set(a,h)}get(t){return super.get(ZD(this,t))}has(t){return super.has(ZD(this,t))}set(t,i){return super.set(CK(this,t),i)}delete(t){return super.delete(OK(this,t))}}function ZD({_intern:e,_key:t},i){const a=t(i);return e.has(a)?e.get(a):i}function CK({_intern:e,_key:t},i){const a=t(i);return e.has(a)?e.get(a):(e.set(a,i),i)}function OK({_intern:e,_key:t},i){const a=t(i);return e.has(a)&&(i=e.get(a),e.delete(a)),i}function kK(e){return e!==null&&typeof e=="object"?e.valueOf():e}function RK(e=qd){if(e===qd)return Hj;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,i)=>{const a=e(t,i);return a||a===0?a:(e(i,i)===0)-(e(t,t)===0)}}function Hj(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const LK=Math.sqrt(50),DK=Math.sqrt(10),zK=Math.sqrt(2);function P0(e,t,i){const a=(t-e)/Math.max(0,i),h=Math.floor(Math.log10(a)),v=a/Math.pow(10,h),S=v>=LK?10:v>=DK?5:v>=zK?2:1;let o,I,B;return h<0?(B=Math.pow(10,-h)/S,o=Math.round(e*B),I=Math.round(t*B),o/B<e&&++o,I/B>t&&--I,B=-B):(B=Math.pow(10,h)*S,o=Math.round(e/B),I=Math.round(t/B),o*B<e&&++o,I*B>t&&--I),I<o&&.5<=i&&i<2?P0(e,t,i*2):[o,I,B]}function lP(e,t,i){if(t=+t,e=+e,i=+i,!(i>0))return[];if(e===t)return[e];const a=t<e,[h,v,S]=a?P0(t,e,i):P0(e,t,i);if(!(v>=h))return[];const o=v-h+1,I=new Array(o);if(a)if(S<0)for(let B=0;B<o;++B)I[B]=(v-B)/-S;else for(let B=0;B<o;++B)I[B]=(v-B)*S;else if(S<0)for(let B=0;B<o;++B)I[B]=(h+B)/-S;else for(let B=0;B<o;++B)I[B]=(h+B)*S;return I}function uP(e,t,i){return t=+t,e=+e,i=+i,P0(e,t,i)[2]}function cP(e,t,i){t=+t,e=+e,i=+i;const a=t<e,h=a?uP(t,e,i):uP(e,t,i);return(a?-1:1)*(h<0?1/-h:h)}function XD(e,t){let i;for(const a of e)a!=null&&(i<a||i===void 0&&a>=a)&&(i=a);return i}function KD(e,t){let i;for(const a of e)a!=null&&(i>a||i===void 0&&a>=a)&&(i=a);return i}function Wj(e,t,i=0,a=1/0,h){if(t=Math.floor(t),i=Math.floor(Math.max(0,i)),a=Math.floor(Math.min(e.length-1,a)),!(i<=t&&t<=a))return e;for(h=h===void 0?Hj:RK(h);a>i;){if(a-i>600){const I=a-i+1,B=t-i+1,$=Math.log(I),U=.5*Math.exp(2*$/3),K=.5*Math.sqrt($*U*(I-U)/I)*(B-I/2<0?-1:1),te=Math.max(i,Math.floor(t-B*U/I+K)),le=Math.min(a,Math.floor(t+(I-B)*U/I+K));Wj(e,t,te,le,h)}const v=e[t];let S=i,o=a;for(I_(e,i,t),h(e[a],v)>0&&I_(e,i,a);S<o;){for(I_(e,S,o),++S,--o;h(e[S],v)<0;)++S;for(;h(e[o],v)>0;)--o}h(e[i],v)===0?I_(e,i,o):(++o,I_(e,o,a)),o<=t&&(i=o+1),t<=o&&(a=o-1)}return e}function I_(e,t,i){const a=e[t];e[t]=e[i],e[i]=a}function FK(e,t,i){if(e=Float64Array.from(MK(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return KD(e);if(t>=1)return XD(e);var a,h=(a-1)*t,v=Math.floor(h),S=XD(Wj(e,v).subarray(0,v+1)),o=KD(e.subarray(v+1));return S+(o-S)*(h-v)}}function BK(e,t,i=Gj){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+i(e[0],0,e);if(t>=1)return+i(e[a-1],a-1,e);var a,h=(a-1)*t,v=Math.floor(h),S=+i(e[v],v,e),o=+i(e[v+1],v+1,e);return S+(o-S)*(h-v)}}function NK(e,t,i){e=+e,t=+t,i=(h=arguments.length)<2?(t=e,e=0,1):h<3?1:+i;for(var a=-1,h=Math.max(0,Math.ceil((t-e)/i))|0,v=new Array(h);++a<h;)v[a]=e+a*i;return v}function Jc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function id(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const hP=Symbol("implicit");function HM(){var e=new WD,t=[],i=[],a=hP;function h(v){let S=e.get(v);if(S===void 0){if(a!==hP)return a;e.set(v,S=t.push(v)-1)}return i[S%i.length]}return h.domain=function(v){if(!arguments.length)return t.slice();t=[],e=new WD;for(const S of v)e.has(S)||e.set(S,t.push(S)-1);return h},h.range=function(v){return arguments.length?(i=Array.from(v),h):i.slice()},h.unknown=function(v){return arguments.length?(a=v,h):a},h.copy=function(){return HM(t,i).unknown(a)},Jc.apply(h,arguments),h}function sy(){var e=HM().unknown(void 0),t=e.domain,i=e.range,a=0,h=1,v,S,o=!1,I=0,B=0,$=.5;delete e.unknown;function U(){var K=t().length,te=h<a,le=te?h:a,se=te?a:h;v=(se-le)/Math.max(1,K-I+B*2),o&&(v=Math.floor(v)),le+=(se-le-v*(K-I))*$,S=v*(1-I),o&&(le=Math.round(le),S=Math.round(S));var ue=NK(K).map(function(be){return le+v*be});return i(te?ue.reverse():ue)}return e.domain=function(K){return arguments.length?(t(K),U()):t()},e.range=function(K){return arguments.length?([a,h]=K,a=+a,h=+h,U()):[a,h]},e.rangeRound=function(K){return[a,h]=K,a=+a,h=+h,o=!0,U()},e.bandwidth=function(){return S},e.step=function(){return v},e.round=function(K){return arguments.length?(o=!!K,U()):o},e.padding=function(K){return arguments.length?(I=Math.min(1,B=+K),U()):I},e.paddingInner=function(K){return arguments.length?(I=Math.min(1,K),U()):I},e.paddingOuter=function(K){return arguments.length?(B=+K,U()):B},e.align=function(K){return arguments.length?($=Math.max(0,Math.min(1,K)),U()):$},e.copy=function(){return sy(t(),[a,h]).round(o).paddingInner(I).paddingOuter(B).align($)},Jc.apply(U(),arguments)}function Zj(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Zj(t())},e}function H_(){return Zj(sy.apply(null,arguments).paddingInner(1))}function WM(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function Xj(e,t){var i=Object.create(e.prototype);for(var a in t)i[a]=t[a];return i}function Xy(){}var ly=.7,M0=1/ly,Ym="\\s*([+-]?\\d+)\\s*",uy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",of="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jK=/^#([0-9a-f]{3,8})$/,$K=new RegExp(`^rgb\\(${Ym},${Ym},${Ym}\\)$`),UK=new RegExp(`^rgb\\(${of},${of},${of}\\)$`),VK=new RegExp(`^rgba\\(${Ym},${Ym},${Ym},${uy}\\)$`),qK=new RegExp(`^rgba\\(${of},${of},${of},${uy}\\)$`),GK=new RegExp(`^hsl\\(${uy},${of},${of}\\)$`),HK=new RegExp(`^hsla\\(${uy},${of},${of},${uy}\\)$`),YD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};WM(Xy,cy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:JD,formatHex:JD,formatHex8:WK,formatHsl:ZK,formatRgb:QD,toString:QD});function JD(){return this.rgb().formatHex()}function WK(){return this.rgb().formatHex8()}function ZK(){return Kj(this).formatHsl()}function QD(){return this.rgb().formatRgb()}function cy(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=jK.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?ez(t):i===3?new Ou(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?Yv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?Yv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=$K.exec(e))?new Ou(t[1],t[2],t[3],1):(t=UK.exec(e))?new Ou(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=VK.exec(e))?Yv(t[1],t[2],t[3],t[4]):(t=qK.exec(e))?Yv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=GK.exec(e))?rz(t[1],t[2]/100,t[3]/100,1):(t=HK.exec(e))?rz(t[1],t[2]/100,t[3]/100,t[4]):YD.hasOwnProperty(e)?ez(YD[e]):e==="transparent"?new Ou(NaN,NaN,NaN,0):null}function ez(e){return new Ou(e>>16&255,e>>8&255,e&255,1)}function Yv(e,t,i,a){return a<=0&&(e=t=i=NaN),new Ou(e,t,i,a)}function XK(e){return e instanceof Xy||(e=cy(e)),e?(e=e.rgb(),new Ou(e.r,e.g,e.b,e.opacity)):new Ou}function fP(e,t,i,a){return arguments.length===1?XK(e):new Ou(e,t,i,a??1)}function Ou(e,t,i,a){this.r=+e,this.g=+t,this.b=+i,this.opacity=+a}WM(Ou,fP,Xj(Xy,{brighter(e){return e=e==null?M0:Math.pow(M0,e),new Ou(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ly:Math.pow(ly,e),new Ou(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ou(Vp(this.r),Vp(this.g),Vp(this.b),I0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:tz,formatHex:tz,formatHex8:KK,formatRgb:nz,toString:nz}));function tz(){return`#${Np(this.r)}${Np(this.g)}${Np(this.b)}`}function KK(){return`#${Np(this.r)}${Np(this.g)}${Np(this.b)}${Np((isNaN(this.opacity)?1:this.opacity)*255)}`}function nz(){const e=I0(this.opacity);return`${e===1?"rgb(":"rgba("}${Vp(this.r)}, ${Vp(this.g)}, ${Vp(this.b)}${e===1?")":`, ${e})`}`}function I0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Np(e){return e=Vp(e),(e<16?"0":"")+e.toString(16)}function rz(e,t,i,a){return a<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new kh(e,t,i,a)}function Kj(e){if(e instanceof kh)return new kh(e.h,e.s,e.l,e.opacity);if(e instanceof Xy||(e=cy(e)),!e)return new kh;if(e instanceof kh)return e;e=e.rgb();var t=e.r/255,i=e.g/255,a=e.b/255,h=Math.min(t,i,a),v=Math.max(t,i,a),S=NaN,o=v-h,I=(v+h)/2;return o?(t===v?S=(i-a)/o+(i<a)*6:i===v?S=(a-t)/o+2:S=(t-i)/o+4,o/=I<.5?v+h:2-v-h,S*=60):o=I>0&&I<1?0:S,new kh(S,o,I,e.opacity)}function YK(e,t,i,a){return arguments.length===1?Kj(e):new kh(e,t,i,a??1)}function kh(e,t,i,a){this.h=+e,this.s=+t,this.l=+i,this.opacity=+a}WM(kh,YK,Xj(Xy,{brighter(e){return e=e==null?M0:Math.pow(M0,e),new kh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ly:Math.pow(ly,e),new kh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,a=i+(i<.5?i:1-i)*t,h=2*i-a;return new Ou(B2(e>=240?e-240:e+120,h,a),B2(e,h,a),B2(e<120?e+240:e-120,h,a),this.opacity)},clamp(){return new kh(iz(this.h),Jv(this.s),Jv(this.l),I0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=I0(this.opacity);return`${e===1?"hsl(":"hsla("}${iz(this.h)}, ${Jv(this.s)*100}%, ${Jv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function iz(e){return e=(e||0)%360,e<0?e+360:e}function Jv(e){return Math.max(0,Math.min(1,e||0))}function B2(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}const ZM=e=>()=>e;function JK(e,t){return function(i){return e+i*t}}function QK(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(a){return Math.pow(e+a*t,i)}}function eY(e){return(e=+e)==1?Yj:function(t,i){return i-t?QK(t,i,e):ZM(isNaN(t)?i:t)}}function Yj(e,t){var i=t-e;return i?JK(e,i):ZM(isNaN(e)?t:e)}const oz=function e(t){var i=eY(t);function a(h,v){var S=i((h=fP(h)).r,(v=fP(v)).r),o=i(h.g,v.g),I=i(h.b,v.b),B=Yj(h.opacity,v.opacity);return function($){return h.r=S($),h.g=o($),h.b=I($),h.opacity=B($),h+""}}return a.gamma=e,a}(1);function tY(e,t){t||(t=[]);var i=e?Math.min(t.length,e.length):0,a=t.slice(),h;return function(v){for(h=0;h<i;++h)a[h]=e[h]*(1-v)+t[h]*v;return a}}function nY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function rY(e,t){var i=t?t.length:0,a=e?Math.min(i,e.length):0,h=new Array(a),v=new Array(i),S;for(S=0;S<a;++S)h[S]=Dg(e[S],t[S]);for(;S<i;++S)v[S]=t[S];return function(o){for(S=0;S<a;++S)v[S]=h[S](o);return v}}function iY(e,t){var i=new Date;return e=+e,t=+t,function(a){return i.setTime(e*(1-a)+t*a),i}}function C0(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function oY(e,t){var i={},a={},h;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(h in t)h in e?i[h]=Dg(e[h],t[h]):a[h]=t[h];return function(v){for(h in i)a[h]=i[h](v);return a}}var dP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,N2=new RegExp(dP.source,"g");function aY(e){return function(){return e}}function sY(e){return function(t){return e(t)+""}}function lY(e,t){var i=dP.lastIndex=N2.lastIndex=0,a,h,v,S=-1,o=[],I=[];for(e=e+"",t=t+"";(a=dP.exec(e))&&(h=N2.exec(t));)(v=h.index)>i&&(v=t.slice(i,v),o[S]?o[S]+=v:o[++S]=v),(a=a[0])===(h=h[0])?o[S]?o[S]+=h:o[++S]=h:(o[++S]=null,I.push({i:S,x:C0(a,h)})),i=N2.lastIndex;return i<t.length&&(v=t.slice(i),o[S]?o[S]+=v:o[++S]=v),o.length<2?I[0]?sY(I[0].x):aY(t):(t=I.length,function(B){for(var $=0,U;$<t;++$)o[(U=I[$]).i]=U.x(B);return o.join("")})}function Dg(e,t){var i=typeof t,a;return t==null||i==="boolean"?ZM(t):(i==="number"?C0:i==="string"?(a=cy(t))?(t=a,oz):lY:t instanceof cy?oz:t instanceof Date?iY:nY(t)?tY:Array.isArray(t)?rY:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?oY:C0)(e,t)}function XM(e,t){return e=+e,t=+t,function(i){return Math.round(e*(1-i)+t*i)}}function uY(e,t){t===void 0&&(t=e,e=Dg);for(var i=0,a=t.length-1,h=t[0],v=new Array(a<0?0:a);i<a;)v[i]=e(h,h=t[++i]);return function(S){var o=Math.max(0,Math.min(a-1,Math.floor(S*=a)));return v[o](S-o)}}function cY(e){return function(){return e}}function O0(e){return+e}var az=[0,1];function su(e){return e}function pP(e,t){return(t-=e=+e)?function(i){return(i-e)/t}:cY(isNaN(t)?NaN:.5)}function hY(e,t){var i;return e>t&&(i=e,e=t,t=i),function(a){return Math.max(e,Math.min(t,a))}}function fY(e,t,i){var a=e[0],h=e[1],v=t[0],S=t[1];return h<a?(a=pP(h,a),v=i(S,v)):(a=pP(a,h),v=i(v,S)),function(o){return v(a(o))}}function dY(e,t,i){var a=Math.min(e.length,t.length)-1,h=new Array(a),v=new Array(a),S=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++S<a;)h[S]=pP(e[S],e[S+1]),v[S]=i(t[S],t[S+1]);return function(o){var I=Zy(e,o,1,a)-1;return v[I](h[I](o))}}function Ky(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Dx(){var e=az,t=az,i=Dg,a,h,v,S=su,o,I,B;function $(){var K=Math.min(e.length,t.length);return S!==su&&(S=hY(e[0],e[K-1])),o=K>2?dY:fY,I=B=null,U}function U(K){return K==null||isNaN(K=+K)?v:(I||(I=o(e.map(a),t,i)))(a(S(K)))}return U.invert=function(K){return S(h((B||(B=o(t,e.map(a),C0)))(K)))},U.domain=function(K){return arguments.length?(e=Array.from(K,O0),$()):e.slice()},U.range=function(K){return arguments.length?(t=Array.from(K),$()):t.slice()},U.rangeRound=function(K){return t=Array.from(K),i=XM,$()},U.clamp=function(K){return arguments.length?(S=K?!0:su,$()):S!==su},U.interpolate=function(K){return arguments.length?(i=K,$()):i},U.unknown=function(K){return arguments.length?(v=K,U):v},function(K,te){return a=K,h=te,$()}}function KM(){return Dx()(su,su)}function pY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function k0(e,t){if((i=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var i,a=e.slice(0,i);return[a.length>1?a[0]+a.slice(2):a,+e.slice(i+1)]}function ag(e){return e=k0(Math.abs(e)),e?e[1]:NaN}function mY(e,t){return function(i,a){for(var h=i.length,v=[],S=0,o=e[0],I=0;h>0&&o>0&&(I+o+1>a&&(o=Math.max(1,a-I)),v.push(i.substring(h-=o,h+o)),!((I+=o+1)>a));)o=e[S=(S+1)%e.length];return v.reverse().join(t)}}function gY(e){return function(t){return t.replace(/[0-9]/g,function(i){return e[+i]})}}var _Y=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hy(e){if(!(t=_Y.exec(e)))throw new Error("invalid format: "+e);var t;return new YM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}hy.prototype=YM.prototype;function YM(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}YM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function yY(e){e:for(var t=e.length,i=1,a=-1,h;i<t;++i)switch(e[i]){case".":a=h=i;break;case"0":a===0&&(a=i),h=i;break;default:if(!+e[i])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(h+1):e}var Jj;function vY(e,t){var i=k0(e,t);if(!i)return e+"";var a=i[0],h=i[1],v=h-(Jj=Math.max(-8,Math.min(8,Math.floor(h/3)))*3)+1,S=a.length;return v===S?a:v>S?a+new Array(v-S+1).join("0"):v>0?a.slice(0,v)+"."+a.slice(v):"0."+new Array(1-v).join("0")+k0(e,Math.max(0,t+v-1))[0]}function sz(e,t){var i=k0(e,t);if(!i)return e+"";var a=i[0],h=i[1];return h<0?"0."+new Array(-h).join("0")+a:a.length>h+1?a.slice(0,h+1)+"."+a.slice(h+1):a+new Array(h-a.length+2).join("0")}const lz={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:pY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>sz(e*100,t),r:sz,s:vY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uz(e){return e}var cz=Array.prototype.map,hz=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function xY(e){var t=e.grouping===void 0||e.thousands===void 0?uz:mY(cz.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",h=e.decimal===void 0?".":e.decimal+"",v=e.numerals===void 0?uz:gY(cz.call(e.numerals,String)),S=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",I=e.nan===void 0?"NaN":e.nan+"";function B(U){U=hy(U);var K=U.fill,te=U.align,le=U.sign,se=U.symbol,ue=U.zero,be=U.width,Ce=U.comma,Re=U.precision,De=U.trim,ve=U.type;ve==="n"?(Ce=!0,ve="g"):lz[ve]||(Re===void 0&&(Re=12),De=!0,ve="g"),(ue||K==="0"&&te==="=")&&(ue=!0,K="0",te="=");var Le=se==="$"?i:se==="#"&&/[boxX]/.test(ve)?"0"+ve.toLowerCase():"",Fe=se==="$"?a:/[%p]/.test(ve)?S:"",lt=lz[ve],xt=/[defgprs%]/.test(ve);Re=Re===void 0?6:/[gprs]/.test(ve)?Math.max(1,Math.min(21,Re)):Math.max(0,Math.min(20,Re));function gt(Je){var St=Le,Nt=Fe,Ht,Ct,Kt;if(ve==="c")Nt=lt(Je)+Nt,Je="";else{Je=+Je;var Lt=Je<0||1/Je<0;if(Je=isNaN(Je)?I:lt(Math.abs(Je),Re),De&&(Je=yY(Je)),Lt&&+Je==0&&le!=="+"&&(Lt=!1),St=(Lt?le==="("?le:o:le==="-"||le==="("?"":le)+St,Nt=(ve==="s"?hz[8+Jj/3]:"")+Nt+(Lt&&le==="("?")":""),xt){for(Ht=-1,Ct=Je.length;++Ht<Ct;)if(Kt=Je.charCodeAt(Ht),48>Kt||Kt>57){Nt=(Kt===46?h+Je.slice(Ht+1):Je.slice(Ht))+Nt,Je=Je.slice(0,Ht);break}}}Ce&&!ue&&(Je=t(Je,1/0));var et=St.length+Je.length+Nt.length,vt=et<be?new Array(be-et+1).join(K):"";switch(Ce&&ue&&(Je=t(vt+Je,vt.length?be-Nt.length:1/0),vt=""),te){case"<":Je=St+Je+Nt+vt;break;case"=":Je=St+vt+Je+Nt;break;case"^":Je=vt.slice(0,et=vt.length>>1)+St+Je+Nt+vt.slice(et);break;default:Je=vt+St+Je+Nt;break}return v(Je)}return gt.toString=function(){return U+""},gt}function $(U,K){var te=B((U=hy(U),U.type="f",U)),le=Math.max(-8,Math.min(8,Math.floor(ag(K)/3)))*3,se=Math.pow(10,-le),ue=hz[8+le/3];return function(be){return te(se*be)+ue}}return{format:B,formatPrefix:$}}var Qv,JM,Qj;bY({thousands:",",grouping:[3],currency:["$",""]});function bY(e){return Qv=xY(e),JM=Qv.format,Qj=Qv.formatPrefix,Qv}function wY(e){return Math.max(0,-ag(Math.abs(e)))}function SY(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ag(t)/3)))*3-ag(Math.abs(e)))}function TY(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ag(t)-ag(e))+1}function e6(e,t,i,a){var h=cP(e,t,i),v;switch(a=hy(a??",f"),a.type){case"s":{var S=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(v=SY(h,S))&&(a.precision=v),Qj(a,S)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(v=TY(h,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=v-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(v=wY(h))&&(a.precision=v-(a.type==="%")*2);break}}return JM(a)}function Jd(e){var t=e.domain;return e.ticks=function(i){var a=t();return lP(a[0],a[a.length-1],i??10)},e.tickFormat=function(i,a){var h=t();return e6(h[0],h[h.length-1],i??10,a)},e.nice=function(i){i==null&&(i=10);var a=t(),h=0,v=a.length-1,S=a[h],o=a[v],I,B,$=10;for(o<S&&(B=S,S=o,o=B,B=h,h=v,v=B);$-- >0;){if(B=uP(S,o,i),B===I)return a[h]=S,a[v]=o,t(a);if(B>0)S=Math.floor(S/B)*B,o=Math.ceil(o/B)*B;else if(B<0)S=Math.ceil(S*B)/B,o=Math.floor(o*B)/B;else break;I=B}return e},e}function R0(){var e=KM();return e.copy=function(){return Ky(e,R0())},Jc.apply(e,arguments),Jd(e)}function t6(e){var t;function i(a){return a==null||isNaN(a=+a)?t:a}return i.invert=i,i.domain=i.range=function(a){return arguments.length?(e=Array.from(a,O0),i):e.slice()},i.unknown=function(a){return arguments.length?(t=a,i):t},i.copy=function(){return t6(e).unknown(t)},e=arguments.length?Array.from(e,O0):[0,1],Jd(i)}function n6(e,t){e=e.slice();var i=0,a=e.length-1,h=e[i],v=e[a],S;return v<h&&(S=i,i=a,a=S,S=h,h=v,v=S),e[i]=t.floor(h),e[a]=t.ceil(v),e}function fz(e){return Math.log(e)}function dz(e){return Math.exp(e)}function EY(e){return-Math.log(-e)}function AY(e){return-Math.exp(-e)}function PY(e){return isFinite(e)?+("1e"+e):e<0?0:e}function MY(e){return e===10?PY:e===Math.E?Math.exp:t=>Math.pow(e,t)}function IY(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function pz(e){return(t,i)=>-e(-t,i)}function QM(e){const t=e(fz,dz),i=t.domain;let a=10,h,v;function S(){return h=IY(a),v=MY(a),i()[0]<0?(h=pz(h),v=pz(v),e(EY,AY)):e(fz,dz),t}return t.base=function(o){return arguments.length?(a=+o,S()):a},t.domain=function(o){return arguments.length?(i(o),S()):i()},t.ticks=o=>{const I=i();let B=I[0],$=I[I.length-1];const U=$<B;U&&([B,$]=[$,B]);let K=h(B),te=h($),le,se;const ue=o==null?10:+o;let be=[];if(!(a%1)&&te-K<ue){if(K=Math.floor(K),te=Math.ceil(te),B>0){for(;K<=te;++K)for(le=1;le<a;++le)if(se=K<0?le/v(-K):le*v(K),!(se<B)){if(se>$)break;be.push(se)}}else for(;K<=te;++K)for(le=a-1;le>=1;--le)if(se=K>0?le/v(-K):le*v(K),!(se<B)){if(se>$)break;be.push(se)}be.length*2<ue&&(be=lP(B,$,ue))}else be=lP(K,te,Math.min(te-K,ue)).map(v);return U?be.reverse():be},t.tickFormat=(o,I)=>{if(o==null&&(o=10),I==null&&(I=a===10?"s":","),typeof I!="function"&&(!(a%1)&&(I=hy(I)).precision==null&&(I.trim=!0),I=JM(I)),o===1/0)return I;const B=Math.max(1,a*o/t.ticks().length);return $=>{let U=$/v(Math.round(h($)));return U*a<a-.5&&(U*=a),U<=B?I($):""}},t.nice=()=>i(n6(i(),{floor:o=>v(Math.floor(h(o))),ceil:o=>v(Math.ceil(h(o)))})),t}function r6(){const e=QM(Dx()).domain([1,10]);return e.copy=()=>Ky(e,r6()).base(e.base()),Jc.apply(e,arguments),e}function mz(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function gz(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function eI(e){var t=1,i=e(mz(t),gz(t));return i.constant=function(a){return arguments.length?e(mz(t=+a),gz(t)):t},Jd(i)}function i6(){var e=eI(Dx());return e.copy=function(){return Ky(e,i6()).constant(e.constant())},Jc.apply(e,arguments)}function _z(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function CY(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function OY(e){return e<0?-e*e:e*e}function tI(e){var t=e(su,su),i=1;function a(){return i===1?e(su,su):i===.5?e(CY,OY):e(_z(i),_z(1/i))}return t.exponent=function(h){return arguments.length?(i=+h,a()):i},Jd(t)}function nI(){var e=tI(Dx());return e.copy=function(){return Ky(e,nI()).exponent(e.exponent())},Jc.apply(e,arguments),e}function kY(){return nI.apply(null,arguments).exponent(.5)}function yz(e){return Math.sign(e)*e*e}function RY(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function o6(){var e=KM(),t=[0,1],i=!1,a;function h(v){var S=RY(e(v));return isNaN(S)?a:i?Math.round(S):S}return h.invert=function(v){return e.invert(yz(v))},h.domain=function(v){return arguments.length?(e.domain(v),h):e.domain()},h.range=function(v){return arguments.length?(e.range((t=Array.from(v,O0)).map(yz)),h):t.slice()},h.rangeRound=function(v){return h.range(v).round(!0)},h.round=function(v){return arguments.length?(i=!!v,h):i},h.clamp=function(v){return arguments.length?(e.clamp(v),h):e.clamp()},h.unknown=function(v){return arguments.length?(a=v,h):a},h.copy=function(){return o6(e.domain(),t).round(i).clamp(e.clamp()).unknown(a)},Jc.apply(h,arguments),Jd(h)}function a6(){var e=[],t=[],i=[],a;function h(){var S=0,o=Math.max(1,t.length);for(i=new Array(o-1);++S<o;)i[S-1]=BK(e,S/o);return v}function v(S){return S==null||isNaN(S=+S)?a:t[Zy(i,S)]}return v.invertExtent=function(S){var o=t.indexOf(S);return o<0?[NaN,NaN]:[o>0?i[o-1]:e[0],o<i.length?i[o]:e[e.length-1]]},v.domain=function(S){if(!arguments.length)return e.slice();e=[];for(let o of S)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(qd),h()},v.range=function(S){return arguments.length?(t=Array.from(S),h()):t.slice()},v.unknown=function(S){return arguments.length?(a=S,v):a},v.quantiles=function(){return i.slice()},v.copy=function(){return a6().domain(e).range(t).unknown(a)},Jc.apply(v,arguments)}function s6(){var e=0,t=1,i=1,a=[.5],h=[0,1],v;function S(I){return I!=null&&I<=I?h[Zy(a,I,0,i)]:v}function o(){var I=-1;for(a=new Array(i);++I<i;)a[I]=((I+1)*t-(I-i)*e)/(i+1);return S}return S.domain=function(I){return arguments.length?([e,t]=I,e=+e,t=+t,o()):[e,t]},S.range=function(I){return arguments.length?(i=(h=Array.from(I)).length-1,o()):h.slice()},S.invertExtent=function(I){var B=h.indexOf(I);return B<0?[NaN,NaN]:B<1?[e,a[0]]:B>=i?[a[i-1],t]:[a[B-1],a[B]]},S.unknown=function(I){return arguments.length&&(v=I),S},S.thresholds=function(){return a.slice()},S.copy=function(){return s6().domain([e,t]).range(h).unknown(v)},Jc.apply(Jd(S),arguments)}function l6(){var e=[.5],t=[0,1],i,a=1;function h(v){return v!=null&&v<=v?t[Zy(e,v,0,a)]:i}return h.domain=function(v){return arguments.length?(e=Array.from(v),a=Math.min(e.length,t.length-1),h):e.slice()},h.range=function(v){return arguments.length?(t=Array.from(v),a=Math.min(e.length,t.length-1),h):t.slice()},h.invertExtent=function(v){var S=t.indexOf(v);return[e[S-1],e[S]]},h.unknown=function(v){return arguments.length?(i=v,h):i},h.copy=function(){return l6().domain(e).range(t).unknown(i)},Jc.apply(h,arguments)}const j2=new Date,$2=new Date;function Xs(e,t,i,a){function h(v){return e(v=arguments.length===0?new Date:new Date(+v)),v}return h.floor=v=>(e(v=new Date(+v)),v),h.ceil=v=>(e(v=new Date(v-1)),t(v,1),e(v),v),h.round=v=>{const S=h(v),o=h.ceil(v);return v-S<o-v?S:o},h.offset=(v,S)=>(t(v=new Date(+v),S==null?1:Math.floor(S)),v),h.range=(v,S,o)=>{const I=[];if(v=h.ceil(v),o=o==null?1:Math.floor(o),!(v<S)||!(o>0))return I;let B;do I.push(B=new Date(+v)),t(v,o),e(v);while(B<v&&v<S);return I},h.filter=v=>Xs(S=>{if(S>=S)for(;e(S),!v(S);)S.setTime(S-1)},(S,o)=>{if(S>=S)if(o<0)for(;++o<=0;)for(;t(S,-1),!v(S););else for(;--o>=0;)for(;t(S,1),!v(S););}),i&&(h.count=(v,S)=>(j2.setTime(+v),$2.setTime(+S),e(j2),e($2),Math.floor(i(j2,$2))),h.every=v=>(v=Math.floor(v),!isFinite(v)||!(v>0)?null:v>1?h.filter(a?S=>a(S)%v===0:S=>h.count(0,S)%v===0):h)),h}const L0=Xs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);L0.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Xs(t=>{t.setTime(Math.floor(t/e)*e)},(t,i)=>{t.setTime(+t+i*e)},(t,i)=>(i-t)/e):L0);L0.range;const Hf=1e3,Gc=Hf*60,Wf=Gc*60,Jf=Wf*24,rI=Jf*7,vz=Jf*30,U2=Jf*365,jp=Xs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Hf)},(e,t)=>(t-e)/Hf,e=>e.getUTCSeconds());jp.range;const iI=Xs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hf)},(e,t)=>{e.setTime(+e+t*Gc)},(e,t)=>(t-e)/Gc,e=>e.getMinutes());iI.range;const oI=Xs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Gc)},(e,t)=>(t-e)/Gc,e=>e.getUTCMinutes());oI.range;const aI=Xs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hf-e.getMinutes()*Gc)},(e,t)=>{e.setTime(+e+t*Wf)},(e,t)=>(t-e)/Wf,e=>e.getHours());aI.range;const sI=Xs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Wf)},(e,t)=>(t-e)/Wf,e=>e.getUTCHours());sI.range;const Yy=Xs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Gc)/Jf,e=>e.getDate()-1);Yy.range;const zx=Xs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Jf,e=>e.getUTCDate()-1);zx.range;const u6=Xs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Jf,e=>Math.floor(e/Jf));u6.range;function om(e){return Xs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,i)=>{t.setDate(t.getDate()+i*7)},(t,i)=>(i-t-(i.getTimezoneOffset()-t.getTimezoneOffset())*Gc)/rI)}const Fx=om(0),D0=om(1),LY=om(2),DY=om(3),sg=om(4),zY=om(5),FY=om(6);Fx.range;D0.range;LY.range;DY.range;sg.range;zY.range;FY.range;function am(e){return Xs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCDate(t.getUTCDate()+i*7)},(t,i)=>(i-t)/rI)}const Bx=am(0),z0=am(1),BY=am(2),NY=am(3),lg=am(4),jY=am(5),$Y=am(6);Bx.range;z0.range;BY.range;NY.range;lg.range;jY.range;$Y.range;const lI=Xs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());lI.range;const uI=Xs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());uI.range;const Qf=Xs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Qf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Xs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,i)=>{t.setFullYear(t.getFullYear()+i*e)});Qf.range;const ed=Xs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ed.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Xs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCFullYear(t.getUTCFullYear()+i*e)});ed.range;function c6(e,t,i,a,h,v){const S=[[jp,1,Hf],[jp,5,5*Hf],[jp,15,15*Hf],[jp,30,30*Hf],[v,1,Gc],[v,5,5*Gc],[v,15,15*Gc],[v,30,30*Gc],[h,1,Wf],[h,3,3*Wf],[h,6,6*Wf],[h,12,12*Wf],[a,1,Jf],[a,2,2*Jf],[i,1,rI],[t,1,vz],[t,3,3*vz],[e,1,U2]];function o(B,$,U){const K=$<B;K&&([B,$]=[$,B]);const te=U&&typeof U.range=="function"?U:I(B,$,U),le=te?te.range(B,+$+1):[];return K?le.reverse():le}function I(B,$,U){const K=Math.abs($-B)/U,te=GM(([,,ue])=>ue).right(S,K);if(te===S.length)return e.every(cP(B/U2,$/U2,U));if(te===0)return L0.every(Math.max(cP(B,$,U),1));const[le,se]=S[K/S[te-1][2]<S[te][2]/K?te-1:te];return le.every(se)}return[o,I]}const[UY,VY]=c6(ed,uI,Bx,u6,sI,oI),[qY,GY]=c6(Qf,lI,Fx,Yy,aI,iI);function V2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function q2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function C_(e,t,i){return{y:e,m:t,d:i,H:0,M:0,S:0,L:0}}function HY(e){var t=e.dateTime,i=e.date,a=e.time,h=e.periods,v=e.days,S=e.shortDays,o=e.months,I=e.shortMonths,B=O_(h),$=k_(h),U=O_(v),K=k_(v),te=O_(S),le=k_(S),se=O_(o),ue=k_(o),be=O_(I),Ce=k_(I),Re={a:Lt,A:et,b:vt,B:Ot,c:null,d:Ez,e:Ez,f:mJ,g:EJ,G:PJ,H:fJ,I:dJ,j:pJ,L:h6,m:gJ,M:_J,p:mt,q:zt,Q:Mz,s:Iz,S:yJ,u:vJ,U:xJ,V:bJ,w:wJ,W:SJ,x:null,X:null,y:TJ,Y:AJ,Z:MJ,"%":Pz},De={a:Jt,A:Un,b:$n,B:Bn,c:null,d:Az,e:Az,f:kJ,g:UJ,G:qJ,H:IJ,I:CJ,j:OJ,L:d6,m:RJ,M:LJ,p:$r,q:_r,Q:Mz,s:Iz,S:DJ,u:zJ,U:FJ,V:BJ,w:NJ,W:jJ,x:null,X:null,y:$J,Y:VJ,Z:GJ,"%":Pz},ve={a:gt,A:Je,b:St,B:Nt,c:Ht,d:Sz,e:Sz,f:lJ,g:wz,G:bz,H:Tz,I:Tz,j:iJ,L:sJ,m:rJ,M:oJ,p:xt,q:nJ,Q:cJ,s:hJ,S:aJ,u:YY,U:JY,V:QY,w:KY,W:eJ,x:Ct,X:Kt,y:wz,Y:bz,Z:tJ,"%":uJ};Re.x=Le(i,Re),Re.X=Le(a,Re),Re.c=Le(t,Re),De.x=Le(i,De),De.X=Le(a,De),De.c=Le(t,De);function Le(Pn,Ke){return function(mr){var Sn=[],Dr=-1,Yt=0,Mr=Pn.length,Qn,Ar,sr;for(mr instanceof Date||(mr=new Date(+mr));++Dr<Mr;)Pn.charCodeAt(Dr)===37&&(Sn.push(Pn.slice(Yt,Dr)),(Ar=xz[Qn=Pn.charAt(++Dr)])!=null?Qn=Pn.charAt(++Dr):Ar=Qn==="e"?" ":"0",(sr=Ke[Qn])&&(Qn=sr(mr,Ar)),Sn.push(Qn),Yt=Dr+1);return Sn.push(Pn.slice(Yt,Dr)),Sn.join("")}}function Fe(Pn,Ke){return function(mr){var Sn=C_(1900,void 0,1),Dr=lt(Sn,Pn,mr+="",0),Yt,Mr;if(Dr!=mr.length)return null;if("Q"in Sn)return new Date(Sn.Q);if("s"in Sn)return new Date(Sn.s*1e3+("L"in Sn?Sn.L:0));if(Ke&&!("Z"in Sn)&&(Sn.Z=0),"p"in Sn&&(Sn.H=Sn.H%12+Sn.p*12),Sn.m===void 0&&(Sn.m="q"in Sn?Sn.q:0),"V"in Sn){if(Sn.V<1||Sn.V>53)return null;"w"in Sn||(Sn.w=1),"Z"in Sn?(Yt=q2(C_(Sn.y,0,1)),Mr=Yt.getUTCDay(),Yt=Mr>4||Mr===0?z0.ceil(Yt):z0(Yt),Yt=zx.offset(Yt,(Sn.V-1)*7),Sn.y=Yt.getUTCFullYear(),Sn.m=Yt.getUTCMonth(),Sn.d=Yt.getUTCDate()+(Sn.w+6)%7):(Yt=V2(C_(Sn.y,0,1)),Mr=Yt.getDay(),Yt=Mr>4||Mr===0?D0.ceil(Yt):D0(Yt),Yt=Yy.offset(Yt,(Sn.V-1)*7),Sn.y=Yt.getFullYear(),Sn.m=Yt.getMonth(),Sn.d=Yt.getDate()+(Sn.w+6)%7)}else("W"in Sn||"U"in Sn)&&("w"in Sn||(Sn.w="u"in Sn?Sn.u%7:"W"in Sn?1:0),Mr="Z"in Sn?q2(C_(Sn.y,0,1)).getUTCDay():V2(C_(Sn.y,0,1)).getDay(),Sn.m=0,Sn.d="W"in Sn?(Sn.w+6)%7+Sn.W*7-(Mr+5)%7:Sn.w+Sn.U*7-(Mr+6)%7);return"Z"in Sn?(Sn.H+=Sn.Z/100|0,Sn.M+=Sn.Z%100,q2(Sn)):V2(Sn)}}function lt(Pn,Ke,mr,Sn){for(var Dr=0,Yt=Ke.length,Mr=mr.length,Qn,Ar;Dr<Yt;){if(Sn>=Mr)return-1;if(Qn=Ke.charCodeAt(Dr++),Qn===37){if(Qn=Ke.charAt(Dr++),Ar=ve[Qn in xz?Ke.charAt(Dr++):Qn],!Ar||(Sn=Ar(Pn,mr,Sn))<0)return-1}else if(Qn!=mr.charCodeAt(Sn++))return-1}return Sn}function xt(Pn,Ke,mr){var Sn=B.exec(Ke.slice(mr));return Sn?(Pn.p=$.get(Sn[0].toLowerCase()),mr+Sn[0].length):-1}function gt(Pn,Ke,mr){var Sn=te.exec(Ke.slice(mr));return Sn?(Pn.w=le.get(Sn[0].toLowerCase()),mr+Sn[0].length):-1}function Je(Pn,Ke,mr){var Sn=U.exec(Ke.slice(mr));return Sn?(Pn.w=K.get(Sn[0].toLowerCase()),mr+Sn[0].length):-1}function St(Pn,Ke,mr){var Sn=be.exec(Ke.slice(mr));return Sn?(Pn.m=Ce.get(Sn[0].toLowerCase()),mr+Sn[0].length):-1}function Nt(Pn,Ke,mr){var Sn=se.exec(Ke.slice(mr));return Sn?(Pn.m=ue.get(Sn[0].toLowerCase()),mr+Sn[0].length):-1}function Ht(Pn,Ke,mr){return lt(Pn,t,Ke,mr)}function Ct(Pn,Ke,mr){return lt(Pn,i,Ke,mr)}function Kt(Pn,Ke,mr){return lt(Pn,a,Ke,mr)}function Lt(Pn){return S[Pn.getDay()]}function et(Pn){return v[Pn.getDay()]}function vt(Pn){return I[Pn.getMonth()]}function Ot(Pn){return o[Pn.getMonth()]}function mt(Pn){return h[+(Pn.getHours()>=12)]}function zt(Pn){return 1+~~(Pn.getMonth()/3)}function Jt(Pn){return S[Pn.getUTCDay()]}function Un(Pn){return v[Pn.getUTCDay()]}function $n(Pn){return I[Pn.getUTCMonth()]}function Bn(Pn){return o[Pn.getUTCMonth()]}function $r(Pn){return h[+(Pn.getUTCHours()>=12)]}function _r(Pn){return 1+~~(Pn.getUTCMonth()/3)}return{format:function(Pn){var Ke=Le(Pn+="",Re);return Ke.toString=function(){return Pn},Ke},parse:function(Pn){var Ke=Fe(Pn+="",!1);return Ke.toString=function(){return Pn},Ke},utcFormat:function(Pn){var Ke=Le(Pn+="",De);return Ke.toString=function(){return Pn},Ke},utcParse:function(Pn){var Ke=Fe(Pn+="",!0);return Ke.toString=function(){return Pn},Ke}}}var xz={"-":"",_:" ",0:"0"},cl=/^\s*\d+/,WY=/^%/,ZY=/[\\^$*+?|[\]().{}]/g;function Ro(e,t,i){var a=e<0?"-":"",h=(a?-e:e)+"",v=h.length;return a+(v<i?new Array(i-v+1).join(t)+h:h)}function XY(e){return e.replace(ZY,"\\$&")}function O_(e){return new RegExp("^(?:"+e.map(XY).join("|")+")","i")}function k_(e){return new Map(e.map((t,i)=>[t.toLowerCase(),i]))}function KY(e,t,i){var a=cl.exec(t.slice(i,i+1));return a?(e.w=+a[0],i+a[0].length):-1}function YY(e,t,i){var a=cl.exec(t.slice(i,i+1));return a?(e.u=+a[0],i+a[0].length):-1}function JY(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.U=+a[0],i+a[0].length):-1}function QY(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.V=+a[0],i+a[0].length):-1}function eJ(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.W=+a[0],i+a[0].length):-1}function bz(e,t,i){var a=cl.exec(t.slice(i,i+4));return a?(e.y=+a[0],i+a[0].length):-1}function wz(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),i+a[0].length):-1}function tJ(e,t,i){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(i,i+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),i+a[0].length):-1}function nJ(e,t,i){var a=cl.exec(t.slice(i,i+1));return a?(e.q=a[0]*3-3,i+a[0].length):-1}function rJ(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.m=a[0]-1,i+a[0].length):-1}function Sz(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.d=+a[0],i+a[0].length):-1}function iJ(e,t,i){var a=cl.exec(t.slice(i,i+3));return a?(e.m=0,e.d=+a[0],i+a[0].length):-1}function Tz(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.H=+a[0],i+a[0].length):-1}function oJ(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.M=+a[0],i+a[0].length):-1}function aJ(e,t,i){var a=cl.exec(t.slice(i,i+2));return a?(e.S=+a[0],i+a[0].length):-1}function sJ(e,t,i){var a=cl.exec(t.slice(i,i+3));return a?(e.L=+a[0],i+a[0].length):-1}function lJ(e,t,i){var a=cl.exec(t.slice(i,i+6));return a?(e.L=Math.floor(a[0]/1e3),i+a[0].length):-1}function uJ(e,t,i){var a=WY.exec(t.slice(i,i+1));return a?i+a[0].length:-1}function cJ(e,t,i){var a=cl.exec(t.slice(i));return a?(e.Q=+a[0],i+a[0].length):-1}function hJ(e,t,i){var a=cl.exec(t.slice(i));return a?(e.s=+a[0],i+a[0].length):-1}function Ez(e,t){return Ro(e.getDate(),t,2)}function fJ(e,t){return Ro(e.getHours(),t,2)}function dJ(e,t){return Ro(e.getHours()%12||12,t,2)}function pJ(e,t){return Ro(1+Yy.count(Qf(e),e),t,3)}function h6(e,t){return Ro(e.getMilliseconds(),t,3)}function mJ(e,t){return h6(e,t)+"000"}function gJ(e,t){return Ro(e.getMonth()+1,t,2)}function _J(e,t){return Ro(e.getMinutes(),t,2)}function yJ(e,t){return Ro(e.getSeconds(),t,2)}function vJ(e){var t=e.getDay();return t===0?7:t}function xJ(e,t){return Ro(Fx.count(Qf(e)-1,e),t,2)}function f6(e){var t=e.getDay();return t>=4||t===0?sg(e):sg.ceil(e)}function bJ(e,t){return e=f6(e),Ro(sg.count(Qf(e),e)+(Qf(e).getDay()===4),t,2)}function wJ(e){return e.getDay()}function SJ(e,t){return Ro(D0.count(Qf(e)-1,e),t,2)}function TJ(e,t){return Ro(e.getFullYear()%100,t,2)}function EJ(e,t){return e=f6(e),Ro(e.getFullYear()%100,t,2)}function AJ(e,t){return Ro(e.getFullYear()%1e4,t,4)}function PJ(e,t){var i=e.getDay();return e=i>=4||i===0?sg(e):sg.ceil(e),Ro(e.getFullYear()%1e4,t,4)}function MJ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ro(t/60|0,"0",2)+Ro(t%60,"0",2)}function Az(e,t){return Ro(e.getUTCDate(),t,2)}function IJ(e,t){return Ro(e.getUTCHours(),t,2)}function CJ(e,t){return Ro(e.getUTCHours()%12||12,t,2)}function OJ(e,t){return Ro(1+zx.count(ed(e),e),t,3)}function d6(e,t){return Ro(e.getUTCMilliseconds(),t,3)}function kJ(e,t){return d6(e,t)+"000"}function RJ(e,t){return Ro(e.getUTCMonth()+1,t,2)}function LJ(e,t){return Ro(e.getUTCMinutes(),t,2)}function DJ(e,t){return Ro(e.getUTCSeconds(),t,2)}function zJ(e){var t=e.getUTCDay();return t===0?7:t}function FJ(e,t){return Ro(Bx.count(ed(e)-1,e),t,2)}function p6(e){var t=e.getUTCDay();return t>=4||t===0?lg(e):lg.ceil(e)}function BJ(e,t){return e=p6(e),Ro(lg.count(ed(e),e)+(ed(e).getUTCDay()===4),t,2)}function NJ(e){return e.getUTCDay()}function jJ(e,t){return Ro(z0.count(ed(e)-1,e),t,2)}function $J(e,t){return Ro(e.getUTCFullYear()%100,t,2)}function UJ(e,t){return e=p6(e),Ro(e.getUTCFullYear()%100,t,2)}function VJ(e,t){return Ro(e.getUTCFullYear()%1e4,t,4)}function qJ(e,t){var i=e.getUTCDay();return e=i>=4||i===0?lg(e):lg.ceil(e),Ro(e.getUTCFullYear()%1e4,t,4)}function GJ(){return"+0000"}function Pz(){return"%"}function Mz(e){return+e}function Iz(e){return Math.floor(+e/1e3)}var jm,m6,g6;HJ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function HJ(e){return jm=HY(e),m6=jm.format,jm.parse,g6=jm.utcFormat,jm.utcParse,jm}function WJ(e){return new Date(e)}function ZJ(e){return e instanceof Date?+e:+new Date(+e)}function cI(e,t,i,a,h,v,S,o,I,B){var $=KM(),U=$.invert,K=$.domain,te=B(".%L"),le=B(":%S"),se=B("%I:%M"),ue=B("%I %p"),be=B("%a %d"),Ce=B("%b %d"),Re=B("%B"),De=B("%Y");function ve(Le){return(I(Le)<Le?te:o(Le)<Le?le:S(Le)<Le?se:v(Le)<Le?ue:a(Le)<Le?h(Le)<Le?be:Ce:i(Le)<Le?Re:De)(Le)}return $.invert=function(Le){return new Date(U(Le))},$.domain=function(Le){return arguments.length?K(Array.from(Le,ZJ)):K().map(WJ)},$.ticks=function(Le){var Fe=K();return e(Fe[0],Fe[Fe.length-1],Le??10)},$.tickFormat=function(Le,Fe){return Fe==null?ve:B(Fe)},$.nice=function(Le){var Fe=K();return(!Le||typeof Le.range!="function")&&(Le=t(Fe[0],Fe[Fe.length-1],Le??10)),Le?K(n6(Fe,Le)):$},$.copy=function(){return Ky($,cI(e,t,i,a,h,v,S,o,I,B))},$}function XJ(){return Jc.apply(cI(qY,GY,Qf,lI,Fx,Yy,aI,iI,jp,m6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function KJ(){return Jc.apply(cI(UY,VY,ed,uI,Bx,zx,sI,oI,jp,g6).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Nx(){var e=0,t=1,i,a,h,v,S=su,o=!1,I;function B(U){return U==null||isNaN(U=+U)?I:S(h===0?.5:(U=(v(U)-i)*h,o?Math.max(0,Math.min(1,U)):U))}B.domain=function(U){return arguments.length?([e,t]=U,i=v(e=+e),a=v(t=+t),h=i===a?0:1/(a-i),B):[e,t]},B.clamp=function(U){return arguments.length?(o=!!U,B):o},B.interpolator=function(U){return arguments.length?(S=U,B):S};function $(U){return function(K){var te,le;return arguments.length?([te,le]=K,S=U(te,le),B):[S(0),S(1)]}}return B.range=$(Dg),B.rangeRound=$(XM),B.unknown=function(U){return arguments.length?(I=U,B):I},function(U){return v=U,i=U(e),a=U(t),h=i===a?0:1/(a-i),B}}function Qd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function _6(){var e=Jd(Nx()(su));return e.copy=function(){return Qd(e,_6())},id.apply(e,arguments)}function y6(){var e=QM(Nx()).domain([1,10]);return e.copy=function(){return Qd(e,y6()).base(e.base())},id.apply(e,arguments)}function v6(){var e=eI(Nx());return e.copy=function(){return Qd(e,v6()).constant(e.constant())},id.apply(e,arguments)}function hI(){var e=tI(Nx());return e.copy=function(){return Qd(e,hI()).exponent(e.exponent())},id.apply(e,arguments)}function YJ(){return hI.apply(null,arguments).exponent(.5)}function x6(){var e=[],t=su;function i(a){if(a!=null&&!isNaN(a=+a))return t((Zy(e,a,1)-1)/(e.length-1))}return i.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let h of a)h!=null&&!isNaN(h=+h)&&e.push(h);return e.sort(qd),i},i.interpolator=function(a){return arguments.length?(t=a,i):t},i.range=function(){return e.map((a,h)=>t(h/(e.length-1)))},i.quantiles=function(a){return Array.from({length:a+1},(h,v)=>FK(e,v/a))},i.copy=function(){return x6(t).domain(e)},id.apply(i,arguments)}function jx(){var e=0,t=.5,i=1,a=1,h,v,S,o,I,B=su,$,U=!1,K;function te(se){return isNaN(se=+se)?K:(se=.5+((se=+$(se))-v)*(a*se<a*v?o:I),B(U?Math.max(0,Math.min(1,se)):se))}te.domain=function(se){return arguments.length?([e,t,i]=se,h=$(e=+e),v=$(t=+t),S=$(i=+i),o=h===v?0:.5/(v-h),I=v===S?0:.5/(S-v),a=v<h?-1:1,te):[e,t,i]},te.clamp=function(se){return arguments.length?(U=!!se,te):U},te.interpolator=function(se){return arguments.length?(B=se,te):B};function le(se){return function(ue){var be,Ce,Re;return arguments.length?([be,Ce,Re]=ue,B=uY(se,[be,Ce,Re]),te):[B(0),B(.5),B(1)]}}return te.range=le(Dg),te.rangeRound=le(XM),te.unknown=function(se){return arguments.length?(K=se,te):K},function(se){return $=se,h=se(e),v=se(t),S=se(i),o=h===v?0:.5/(v-h),I=v===S?0:.5/(S-v),a=v<h?-1:1,te}}function b6(){var e=Jd(jx()(su));return e.copy=function(){return Qd(e,b6())},id.apply(e,arguments)}function w6(){var e=QM(jx()).domain([.1,1,10]);return e.copy=function(){return Qd(e,w6()).base(e.base())},id.apply(e,arguments)}function S6(){var e=eI(jx());return e.copy=function(){return Qd(e,S6()).constant(e.constant())},id.apply(e,arguments)}function fI(){var e=tI(jx());return e.copy=function(){return Qd(e,fI()).exponent(e.exponent())},id.apply(e,arguments)}function JJ(){return fI.apply(null,arguments).exponent(.5)}const Cz=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:sy,scaleDiverging:b6,scaleDivergingLog:w6,scaleDivergingPow:fI,scaleDivergingSqrt:JJ,scaleDivergingSymlog:S6,scaleIdentity:t6,scaleImplicit:hP,scaleLinear:R0,scaleLog:r6,scaleOrdinal:HM,scalePoint:H_,scalePow:nI,scaleQuantile:a6,scaleQuantize:s6,scaleRadial:o6,scaleSequential:_6,scaleSequentialLog:y6,scaleSequentialPow:hI,scaleSequentialQuantile:x6,scaleSequentialSqrt:YJ,scaleSequentialSymlog:v6,scaleSqrt:kY,scaleSymlog:i6,scaleThreshold:l6,scaleTime:XJ,scaleUtc:KJ,tickFormat:e6},Symbol.toStringTag,{value:"Module"}));var G2,Oz;function $x(){if(Oz)return G2;Oz=1;var e=Cg();function t(i,a,h){for(var v=-1,S=i.length;++v<S;){var o=i[v],I=a(o);if(I!=null&&(B===void 0?I===I&&!e(I):h(I,B)))var B=I,$=o}return $}return G2=t,G2}var H2,kz;function T6(){if(kz)return H2;kz=1;function e(t,i){return t>i}return H2=e,H2}var W2,Rz;function QJ(){if(Rz)return W2;Rz=1;var e=$x(),t=T6(),i=Yd();function a(h){return h&&h.length?e(h,i,t):void 0}return W2=a,W2}var eQ=QJ();const Ux=zo(eQ);var Z2,Lz;function E6(){if(Lz)return Z2;Lz=1;function e(t,i){return t<i}return Z2=e,Z2}var X2,Dz;function tQ(){if(Dz)return X2;Dz=1;var e=$x(),t=E6(),i=Yd();function a(h){return h&&h.length?e(h,i,t):void 0}return X2=a,X2}var nQ=tQ();const Vx=zo(nQ);var K2,zz;function rQ(){if(zz)return K2;zz=1;var e=rm(),t=xl(),i=Cj(),a=vl();function h(v,S){var o=a(v)?e:i;return o(v,t(S,3))}return K2=h,K2}var Y2,Fz;function iQ(){if(Fz)return Y2;Fz=1;var e=NM(),t=rQ();function i(a,h){return e(t(a,h),1)}return Y2=i,Y2}var oQ=iQ();const aQ=zo(oQ);var J2,Bz;function sQ(){if(Bz)return J2;Bz=1;var e=FM();function t(i,a){return e(i,a)}return J2=t,J2}var lQ=sQ();const qx=zo(lQ);var zg=1e9,uQ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},pI,Wa=!0,Zc="[DecimalError] ",qp=Zc+"Invalid argument: ",dI=Zc+"Exponent out of range: ",Fg=Math.floor,Rp=Math.pow,cQ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,nc,ll=1e7,Da=7,A6=9007199254740991,F0=Fg(A6/Da),Fr={};Fr.absoluteValue=Fr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Fr.comparedTo=Fr.cmp=function(e){var t,i,a,h,v=this;if(e=new v.constructor(e),v.s!==e.s)return v.s||-e.s;if(v.e!==e.e)return v.e>e.e^v.s<0?1:-1;for(a=v.d.length,h=e.d.length,t=0,i=a<h?a:h;t<i;++t)if(v.d[t]!==e.d[t])return v.d[t]>e.d[t]^v.s<0?1:-1;return a===h?0:a>h^v.s<0?1:-1};Fr.decimalPlaces=Fr.dp=function(){var e=this,t=e.d.length-1,i=(t-e.e)*Da;if(t=e.d[t],t)for(;t%10==0;t/=10)i--;return i<0?0:i};Fr.dividedBy=Fr.div=function(e){return Yf(this,new this.constructor(e))};Fr.dividedToIntegerBy=Fr.idiv=function(e){var t=this,i=t.constructor;return ya(Yf(t,new i(e),0,1),i.precision)};Fr.equals=Fr.eq=function(e){return!this.cmp(e)};Fr.exponent=function(){return Os(this)};Fr.greaterThan=Fr.gt=function(e){return this.cmp(e)>0};Fr.greaterThanOrEqualTo=Fr.gte=function(e){return this.cmp(e)>=0};Fr.isInteger=Fr.isint=function(){return this.e>this.d.length-2};Fr.isNegative=Fr.isneg=function(){return this.s<0};Fr.isPositive=Fr.ispos=function(){return this.s>0};Fr.isZero=function(){return this.s===0};Fr.lessThan=Fr.lt=function(e){return this.cmp(e)<0};Fr.lessThanOrEqualTo=Fr.lte=function(e){return this.cmp(e)<1};Fr.logarithm=Fr.log=function(e){var t,i=this,a=i.constructor,h=a.precision,v=h+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(nc))throw Error(Zc+"NaN");if(i.s<1)throw Error(Zc+(i.s?"NaN":"-Infinity"));return i.eq(nc)?new a(0):(Wa=!1,t=Yf(fy(i,v),fy(e,v),v),Wa=!0,ya(t,h))};Fr.minus=Fr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?I6(t,e):P6(t,(e.s=-e.s,e))};Fr.modulo=Fr.mod=function(e){var t,i=this,a=i.constructor,h=a.precision;if(e=new a(e),!e.s)throw Error(Zc+"NaN");return i.s?(Wa=!1,t=Yf(i,e,0,1).times(e),Wa=!0,i.minus(t)):ya(new a(i),h)};Fr.naturalExponential=Fr.exp=function(){return M6(this)};Fr.naturalLogarithm=Fr.ln=function(){return fy(this)};Fr.negated=Fr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Fr.plus=Fr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?P6(t,e):I6(t,(e.s=-e.s,e))};Fr.precision=Fr.sd=function(e){var t,i,a,h=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(qp+e);if(t=Os(h)+1,a=h.d.length-1,i=a*Da+1,a=h.d[a],a){for(;a%10==0;a/=10)i--;for(a=h.d[0];a>=10;a/=10)i++}return e&&t>i?t:i};Fr.squareRoot=Fr.sqrt=function(){var e,t,i,a,h,v,S,o=this,I=o.constructor;if(o.s<1){if(!o.s)return new I(0);throw Error(Zc+"NaN")}for(e=Os(o),Wa=!1,h=Math.sqrt(+o),h==0||h==1/0?(t=tf(o.d),(t.length+e)%2==0&&(t+="0"),h=Math.sqrt(t),e=Fg((e+1)/2)-(e<0||e%2),h==1/0?t="5e"+e:(t=h.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new I(t)):a=new I(h.toString()),i=I.precision,h=S=i+3;;)if(v=a,a=v.plus(Yf(o,v,S+2)).times(.5),tf(v.d).slice(0,S)===(t=tf(a.d)).slice(0,S)){if(t=t.slice(S-3,S+1),h==S&&t=="4999"){if(ya(v,i+1,0),v.times(v).eq(o)){a=v;break}}else if(t!="9999")break;S+=4}return Wa=!0,ya(a,i)};Fr.times=Fr.mul=function(e){var t,i,a,h,v,S,o,I,B,$=this,U=$.constructor,K=$.d,te=(e=new U(e)).d;if(!$.s||!e.s)return new U(0);for(e.s*=$.s,i=$.e+e.e,I=K.length,B=te.length,I<B&&(v=K,K=te,te=v,S=I,I=B,B=S),v=[],S=I+B,a=S;a--;)v.push(0);for(a=B;--a>=0;){for(t=0,h=I+a;h>a;)o=v[h]+te[a]*K[h-a-1]+t,v[h--]=o%ll|0,t=o/ll|0;v[h]=(v[h]+t)%ll|0}for(;!v[--S];)v.pop();return t?++i:v.shift(),e.d=v,e.e=i,Wa?ya(e,U.precision):e};Fr.toDecimalPlaces=Fr.todp=function(e,t){var i=this,a=i.constructor;return i=new a(i),e===void 0?i:(lf(e,0,zg),t===void 0?t=a.rounding:lf(t,0,8),ya(i,e+Os(i)+1,t))};Fr.toExponential=function(e,t){var i,a=this,h=a.constructor;return e===void 0?i=Qp(a,!0):(lf(e,0,zg),t===void 0?t=h.rounding:lf(t,0,8),a=ya(new h(a),e+1,t),i=Qp(a,!0,e+1)),i};Fr.toFixed=function(e,t){var i,a,h=this,v=h.constructor;return e===void 0?Qp(h):(lf(e,0,zg),t===void 0?t=v.rounding:lf(t,0,8),a=ya(new v(h),e+Os(h)+1,t),i=Qp(a.abs(),!1,e+Os(a)+1),h.isneg()&&!h.isZero()?"-"+i:i)};Fr.toInteger=Fr.toint=function(){var e=this,t=e.constructor;return ya(new t(e),Os(e)+1,t.rounding)};Fr.toNumber=function(){return+this};Fr.toPower=Fr.pow=function(e){var t,i,a,h,v,S,o=this,I=o.constructor,B=12,$=+(e=new I(e));if(!e.s)return new I(nc);if(o=new I(o),!o.s){if(e.s<1)throw Error(Zc+"Infinity");return o}if(o.eq(nc))return o;if(a=I.precision,e.eq(nc))return ya(o,a);if(t=e.e,i=e.d.length-1,S=t>=i,v=o.s,S){if((i=$<0?-$:$)<=A6){for(h=new I(nc),t=Math.ceil(a/Da+4),Wa=!1;i%2&&(h=h.times(o),jz(h.d,t)),i=Fg(i/2),i!==0;)o=o.times(o),jz(o.d,t);return Wa=!0,e.s<0?new I(nc).div(h):ya(h,a)}}else if(v<0)throw Error(Zc+"NaN");return v=v<0&&e.d[Math.max(t,i)]&1?-1:1,o.s=1,Wa=!1,h=e.times(fy(o,a+B)),Wa=!0,h=M6(h),h.s=v,h};Fr.toPrecision=function(e,t){var i,a,h=this,v=h.constructor;return e===void 0?(i=Os(h),a=Qp(h,i<=v.toExpNeg||i>=v.toExpPos)):(lf(e,1,zg),t===void 0?t=v.rounding:lf(t,0,8),h=ya(new v(h),e,t),i=Os(h),a=Qp(h,e<=i||i<=v.toExpNeg,e)),a};Fr.toSignificantDigits=Fr.tosd=function(e,t){var i=this,a=i.constructor;return e===void 0?(e=a.precision,t=a.rounding):(lf(e,1,zg),t===void 0?t=a.rounding:lf(t,0,8)),ya(new a(i),e,t)};Fr.toString=Fr.valueOf=Fr.val=Fr.toJSON=Fr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Os(e),i=e.constructor;return Qp(e,t<=i.toExpNeg||t>=i.toExpPos)};function P6(e,t){var i,a,h,v,S,o,I,B,$=e.constructor,U=$.precision;if(!e.s||!t.s)return t.s||(t=new $(e)),Wa?ya(t,U):t;if(I=e.d,B=t.d,S=e.e,h=t.e,I=I.slice(),v=S-h,v){for(v<0?(a=I,v=-v,o=B.length):(a=B,h=S,o=I.length),S=Math.ceil(U/Da),o=S>o?S+1:o+1,v>o&&(v=o,a.length=1),a.reverse();v--;)a.push(0);a.reverse()}for(o=I.length,v=B.length,o-v<0&&(v=o,a=B,B=I,I=a),i=0;v;)i=(I[--v]=I[v]+B[v]+i)/ll|0,I[v]%=ll;for(i&&(I.unshift(i),++h),o=I.length;I[--o]==0;)I.pop();return t.d=I,t.e=h,Wa?ya(t,U):t}function lf(e,t,i){if(e!==~~e||e<t||e>i)throw Error(qp+e)}function tf(e){var t,i,a,h=e.length-1,v="",S=e[0];if(h>0){for(v+=S,t=1;t<h;t++)a=e[t]+"",i=Da-a.length,i&&(v+=Ud(i)),v+=a;S=e[t],a=S+"",i=Da-a.length,i&&(v+=Ud(i))}else if(S===0)return"0";for(;S%10===0;)S/=10;return v+S}var Yf=function(){function e(a,h){var v,S=0,o=a.length;for(a=a.slice();o--;)v=a[o]*h+S,a[o]=v%ll|0,S=v/ll|0;return S&&a.unshift(S),a}function t(a,h,v,S){var o,I;if(v!=S)I=v>S?1:-1;else for(o=I=0;o<v;o++)if(a[o]!=h[o]){I=a[o]>h[o]?1:-1;break}return I}function i(a,h,v){for(var S=0;v--;)a[v]-=S,S=a[v]<h[v]?1:0,a[v]=S*ll+a[v]-h[v];for(;!a[0]&&a.length>1;)a.shift()}return function(a,h,v,S){var o,I,B,$,U,K,te,le,se,ue,be,Ce,Re,De,ve,Le,Fe,lt,xt=a.constructor,gt=a.s==h.s?1:-1,Je=a.d,St=h.d;if(!a.s)return new xt(a);if(!h.s)throw Error(Zc+"Division by zero");for(I=a.e-h.e,Fe=St.length,ve=Je.length,te=new xt(gt),le=te.d=[],B=0;St[B]==(Je[B]||0);)++B;if(St[B]>(Je[B]||0)&&--I,v==null?Ce=v=xt.precision:S?Ce=v+(Os(a)-Os(h))+1:Ce=v,Ce<0)return new xt(0);if(Ce=Ce/Da+2|0,B=0,Fe==1)for($=0,St=St[0],Ce++;(B<ve||$)&&Ce--;B++)Re=$*ll+(Je[B]||0),le[B]=Re/St|0,$=Re%St|0;else{for($=ll/(St[0]+1)|0,$>1&&(St=e(St,$),Je=e(Je,$),Fe=St.length,ve=Je.length),De=Fe,se=Je.slice(0,Fe),ue=se.length;ue<Fe;)se[ue++]=0;lt=St.slice(),lt.unshift(0),Le=St[0],St[1]>=ll/2&&++Le;do $=0,o=t(St,se,Fe,ue),o<0?(be=se[0],Fe!=ue&&(be=be*ll+(se[1]||0)),$=be/Le|0,$>1?($>=ll&&($=ll-1),U=e(St,$),K=U.length,ue=se.length,o=t(U,se,K,ue),o==1&&($--,i(U,Fe<K?lt:St,K))):($==0&&(o=$=1),U=St.slice()),K=U.length,K<ue&&U.unshift(0),i(se,U,ue),o==-1&&(ue=se.length,o=t(St,se,Fe,ue),o<1&&($++,i(se,Fe<ue?lt:St,ue))),ue=se.length):o===0&&($++,se=[0]),le[B++]=$,o&&se[0]?se[ue++]=Je[De]||0:(se=[Je[De]],ue=1);while((De++<ve||se[0]!==void 0)&&Ce--)}return le[0]||le.shift(),te.e=I,ya(te,S?v+Os(te)+1:v)}}();function M6(e,t){var i,a,h,v,S,o,I=0,B=0,$=e.constructor,U=$.precision;if(Os(e)>16)throw Error(dI+Os(e));if(!e.s)return new $(nc);for(t==null?(Wa=!1,o=U):o=t,S=new $(.03125);e.abs().gte(.1);)e=e.times(S),B+=5;for(a=Math.log(Rp(2,B))/Math.LN10*2+5|0,o+=a,i=h=v=new $(nc),$.precision=o;;){if(h=ya(h.times(e),o),i=i.times(++I),S=v.plus(Yf(h,i,o)),tf(S.d).slice(0,o)===tf(v.d).slice(0,o)){for(;B--;)v=ya(v.times(v),o);return $.precision=U,t==null?(Wa=!0,ya(v,U)):v}v=S}}function Os(e){for(var t=e.e*Da,i=e.d[0];i>=10;i/=10)t++;return t}function Q2(e,t,i){if(t>e.LN10.sd())throw Wa=!0,i&&(e.precision=i),Error(Zc+"LN10 precision limit exceeded");return ya(new e(e.LN10),t)}function Ud(e){for(var t="";e--;)t+="0";return t}function fy(e,t){var i,a,h,v,S,o,I,B,$,U=1,K=10,te=e,le=te.d,se=te.constructor,ue=se.precision;if(te.s<1)throw Error(Zc+(te.s?"NaN":"-Infinity"));if(te.eq(nc))return new se(0);if(t==null?(Wa=!1,B=ue):B=t,te.eq(10))return t==null&&(Wa=!0),Q2(se,B);if(B+=K,se.precision=B,i=tf(le),a=i.charAt(0),v=Os(te),Math.abs(v)<15e14){for(;a<7&&a!=1||a==1&&i.charAt(1)>3;)te=te.times(e),i=tf(te.d),a=i.charAt(0),U++;v=Os(te),a>1?(te=new se("0."+i),v++):te=new se(a+"."+i.slice(1))}else return I=Q2(se,B+2,ue).times(v+""),te=fy(new se(a+"."+i.slice(1)),B-K).plus(I),se.precision=ue,t==null?(Wa=!0,ya(te,ue)):te;for(o=S=te=Yf(te.minus(nc),te.plus(nc),B),$=ya(te.times(te),B),h=3;;){if(S=ya(S.times($),B),I=o.plus(Yf(S,new se(h),B)),tf(I.d).slice(0,B)===tf(o.d).slice(0,B))return o=o.times(2),v!==0&&(o=o.plus(Q2(se,B+2,ue).times(v+""))),o=Yf(o,new se(U),B),se.precision=ue,t==null?(Wa=!0,ya(o,ue)):o;o=I,h+=2}}function Nz(e,t){var i,a,h;for((i=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(i<0&&(i=a),i+=+t.slice(a+1),t=t.substring(0,a)):i<0&&(i=t.length),a=0;t.charCodeAt(a)===48;)++a;for(h=t.length;t.charCodeAt(h-1)===48;)--h;if(t=t.slice(a,h),t){if(h-=a,i=i-a-1,e.e=Fg(i/Da),e.d=[],a=(i+1)%Da,i<0&&(a+=Da),a<h){for(a&&e.d.push(+t.slice(0,a)),h-=Da;a<h;)e.d.push(+t.slice(a,a+=Da));t=t.slice(a),a=Da-t.length}else a-=h;for(;a--;)t+="0";if(e.d.push(+t),Wa&&(e.e>F0||e.e<-F0))throw Error(dI+i)}else e.s=0,e.e=0,e.d=[0];return e}function ya(e,t,i){var a,h,v,S,o,I,B,$,U=e.d;for(S=1,v=U[0];v>=10;v/=10)S++;if(a=t-S,a<0)a+=Da,h=t,B=U[$=0];else{if($=Math.ceil((a+1)/Da),v=U.length,$>=v)return e;for(B=v=U[$],S=1;v>=10;v/=10)S++;a%=Da,h=a-Da+S}if(i!==void 0&&(v=Rp(10,S-h-1),o=B/v%10|0,I=t<0||U[$+1]!==void 0||B%v,I=i<4?(o||I)&&(i==0||i==(e.s<0?3:2)):o>5||o==5&&(i==4||I||i==6&&(a>0?h>0?B/Rp(10,S-h):0:U[$-1])%10&1||i==(e.s<0?8:7))),t<1||!U[0])return I?(v=Os(e),U.length=1,t=t-v-1,U[0]=Rp(10,(Da-t%Da)%Da),e.e=Fg(-t/Da)||0):(U.length=1,U[0]=e.e=e.s=0),e;if(a==0?(U.length=$,v=1,$--):(U.length=$+1,v=Rp(10,Da-a),U[$]=h>0?(B/Rp(10,S-h)%Rp(10,h)|0)*v:0),I)for(;;)if($==0){(U[0]+=v)==ll&&(U[0]=1,++e.e);break}else{if(U[$]+=v,U[$]!=ll)break;U[$--]=0,v=1}for(a=U.length;U[--a]===0;)U.pop();if(Wa&&(e.e>F0||e.e<-F0))throw Error(dI+Os(e));return e}function I6(e,t){var i,a,h,v,S,o,I,B,$,U,K=e.constructor,te=K.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new K(e),Wa?ya(t,te):t;if(I=e.d,U=t.d,a=t.e,B=e.e,I=I.slice(),S=B-a,S){for($=S<0,$?(i=I,S=-S,o=U.length):(i=U,a=B,o=I.length),h=Math.max(Math.ceil(te/Da),o)+2,S>h&&(S=h,i.length=1),i.reverse(),h=S;h--;)i.push(0);i.reverse()}else{for(h=I.length,o=U.length,$=h<o,$&&(o=h),h=0;h<o;h++)if(I[h]!=U[h]){$=I[h]<U[h];break}S=0}for($&&(i=I,I=U,U=i,t.s=-t.s),o=I.length,h=U.length-o;h>0;--h)I[o++]=0;for(h=U.length;h>S;){if(I[--h]<U[h]){for(v=h;v&&I[--v]===0;)I[v]=ll-1;--I[v],I[h]+=ll}I[h]-=U[h]}for(;I[--o]===0;)I.pop();for(;I[0]===0;I.shift())--a;return I[0]?(t.d=I,t.e=a,Wa?ya(t,te):t):new K(0)}function Qp(e,t,i){var a,h=Os(e),v=tf(e.d),S=v.length;return t?(i&&(a=i-S)>0?v=v.charAt(0)+"."+v.slice(1)+Ud(a):S>1&&(v=v.charAt(0)+"."+v.slice(1)),v=v+(h<0?"e":"e+")+h):h<0?(v="0."+Ud(-h-1)+v,i&&(a=i-S)>0&&(v+=Ud(a))):h>=S?(v+=Ud(h+1-S),i&&(a=i-h-1)>0&&(v=v+"."+Ud(a))):((a=h+1)<S&&(v=v.slice(0,a)+"."+v.slice(a)),i&&(a=i-S)>0&&(h+1===S&&(v+="."),v+=Ud(a))),e.s<0?"-"+v:v}function jz(e,t){if(e.length>t)return e.length=t,!0}function C6(e){var t,i,a;function h(v){var S=this;if(!(S instanceof h))return new h(v);if(S.constructor=h,v instanceof h){S.s=v.s,S.e=v.e,S.d=(v=v.d)?v.slice():v;return}if(typeof v=="number"){if(v*0!==0)throw Error(qp+v);if(v>0)S.s=1;else if(v<0)v=-v,S.s=-1;else{S.s=0,S.e=0,S.d=[0];return}if(v===~~v&&v<1e7){S.e=0,S.d=[v];return}return Nz(S,v.toString())}else if(typeof v!="string")throw Error(qp+v);if(v.charCodeAt(0)===45?(v=v.slice(1),S.s=-1):S.s=1,cQ.test(v))Nz(S,v);else throw Error(qp+v)}if(h.prototype=Fr,h.ROUND_UP=0,h.ROUND_DOWN=1,h.ROUND_CEIL=2,h.ROUND_FLOOR=3,h.ROUND_HALF_UP=4,h.ROUND_HALF_DOWN=5,h.ROUND_HALF_EVEN=6,h.ROUND_HALF_CEIL=7,h.ROUND_HALF_FLOOR=8,h.clone=C6,h.config=h.set=hQ,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(i=a[t++])||(e[i]=this[i]);return h.config(e),h}function hQ(e){if(!e||typeof e!="object")throw Error(Zc+"Object expected");var t,i,a,h=["precision",1,zg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<h.length;t+=3)if((a=e[i=h[t]])!==void 0)if(Fg(a)===a&&a>=h[t+1]&&a<=h[t+2])this[i]=a;else throw Error(qp+i+": "+a);if((a=e[i="LN10"])!==void 0)if(a==Math.LN10)this[i]=new this(a);else throw Error(qp+i+": "+a);return this}var pI=C6(uQ);nc=new pI(1);const sa=pI;function fQ(e){return gQ(e)||mQ(e)||pQ(e)||dQ()}function dQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pQ(e,t){if(e){if(typeof e=="string")return mP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return mP(e,t)}}function mQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function gQ(e){if(Array.isArray(e))return mP(e)}function mP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var _Q=function(t){return t},O6={"@@functional/placeholder":!0},k6=function(t){return t===O6},$z=function(t){return function i(){return arguments.length===0||arguments.length===1&&k6(arguments.length<=0?void 0:arguments[0])?i:t.apply(void 0,arguments)}},yQ=function e(t,i){return t===1?i:$z(function(){for(var a=arguments.length,h=new Array(a),v=0;v<a;v++)h[v]=arguments[v];var S=h.filter(function(o){return o!==O6}).length;return S>=t?i.apply(void 0,h):e(t-S,$z(function(){for(var o=arguments.length,I=new Array(o),B=0;B<o;B++)I[B]=arguments[B];var $=h.map(function(U){return k6(U)?I.shift():U});return i.apply(void 0,fQ($).concat(I))}))})},Gx=function(t){return yQ(t.length,t)},gP=function(t,i){for(var a=[],h=t;h<i;++h)a[h-t]=h;return a},vQ=Gx(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(i){return t[i]}).map(e)}),xQ=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];if(!i.length)return _Q;var h=i.reverse(),v=h[0],S=h.slice(1);return function(){return S.reduce(function(o,I){return I(o)},v.apply(void 0,arguments))}},_P=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},R6=function(t){var i=null,a=null;return function(){for(var h=arguments.length,v=new Array(h),S=0;S<h;S++)v[S]=arguments[S];return i&&v.every(function(o,I){return o===i[I]})||(i=v,a=t.apply(void 0,v)),a}};function bQ(e){var t;return e===0?t=1:t=Math.floor(new sa(e).abs().log(10).toNumber())+1,t}function wQ(e,t,i){for(var a=new sa(e),h=0,v=[];a.lt(t)&&h<1e5;)v.push(a.toNumber()),a=a.add(i),h++;return v}var SQ=Gx(function(e,t,i){var a=+e,h=+t;return a+i*(h-a)}),TQ=Gx(function(e,t,i){var a=t-+e;return a=a||1/0,(i-e)/a}),EQ=Gx(function(e,t,i){var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(i-e)/a))});const Hx={rangeStep:wQ,getDigitCount:bQ,interpolateNumber:SQ,uninterpolateNumber:TQ,uninterpolateTruncation:EQ};function yP(e){return MQ(e)||PQ(e)||L6(e)||AQ()}function AQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function MQ(e){if(Array.isArray(e))return vP(e)}function dy(e,t){return OQ(e)||CQ(e,t)||L6(e,t)||IQ()}function IQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L6(e,t){if(e){if(typeof e=="string")return vP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return vP(e,t)}}function vP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function CQ(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var i=[],a=!0,h=!1,v=void 0;try{for(var S=e[Symbol.iterator](),o;!(a=(o=S.next()).done)&&(i.push(o.value),!(t&&i.length===t));a=!0);}catch(I){h=!0,v=I}finally{try{!a&&S.return!=null&&S.return()}finally{if(h)throw v}}return i}}function OQ(e){if(Array.isArray(e))return e}function D6(e){var t=dy(e,2),i=t[0],a=t[1],h=i,v=a;return i>a&&(h=a,v=i),[h,v]}function z6(e,t,i){if(e.lte(0))return new sa(0);var a=Hx.getDigitCount(e.toNumber()),h=new sa(10).pow(a),v=e.div(h),S=a!==1?.05:.1,o=new sa(Math.ceil(v.div(S).toNumber())).add(i).mul(S),I=o.mul(h);return t?I:new sa(Math.ceil(I))}function kQ(e,t,i){var a=1,h=new sa(e);if(!h.isint()&&i){var v=Math.abs(e);v<1?(a=new sa(10).pow(Hx.getDigitCount(e)-1),h=new sa(Math.floor(h.div(a).toNumber())).mul(a)):v>1&&(h=new sa(Math.floor(e)))}else e===0?h=new sa(Math.floor((t-1)/2)):i||(h=new sa(Math.floor(e)));var S=Math.floor((t-1)/2),o=xQ(vQ(function(I){return h.add(new sa(I-S).mul(a)).toNumber()}),gP);return o(0,t)}function F6(e,t,i,a){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(i-1)))return{step:new sa(0),tickMin:new sa(0),tickMax:new sa(0)};var v=z6(new sa(t).sub(e).div(i-1),a,h),S;e<=0&&t>=0?S=new sa(0):(S=new sa(e).add(t).div(2),S=S.sub(new sa(S).mod(v)));var o=Math.ceil(S.sub(e).div(v).toNumber()),I=Math.ceil(new sa(t).sub(S).div(v).toNumber()),B=o+I+1;return B>i?F6(e,t,i,a,h+1):(B<i&&(I=t>0?I+(i-B):I,o=t>0?o:o+(i-B)),{step:v,tickMin:S.sub(new sa(o).mul(v)),tickMax:S.add(new sa(I).mul(v))})}function RQ(e){var t=dy(e,2),i=t[0],a=t[1],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,S=Math.max(h,2),o=D6([i,a]),I=dy(o,2),B=I[0],$=I[1];if(B===-1/0||$===1/0){var U=$===1/0?[B].concat(yP(gP(0,h-1).map(function(){return 1/0}))):[].concat(yP(gP(0,h-1).map(function(){return-1/0})),[$]);return i>a?_P(U):U}if(B===$)return kQ(B,h,v);var K=F6(B,$,S,v),te=K.step,le=K.tickMin,se=K.tickMax,ue=Hx.rangeStep(le,se.add(new sa(.1).mul(te)),te);return i>a?_P(ue):ue}function LQ(e,t){var i=dy(e,2),a=i[0],h=i[1],v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,S=D6([a,h]),o=dy(S,2),I=o[0],B=o[1];if(I===-1/0||B===1/0)return[a,h];if(I===B)return[I];var $=Math.max(t,2),U=z6(new sa(B).sub(I).div($-1),v,0),K=[].concat(yP(Hx.rangeStep(new sa(I),new sa(B).sub(new sa(.99).mul(U)),U)),[B]);return a>h?_P(K):K}var DQ=R6(RQ),zQ=R6(LQ),FQ="Invariant failed";function em(e,t){throw new Error(FQ)}var BQ=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},B0.apply(this,arguments)}function NQ(e,t){return VQ(e)||UQ(e,t)||$Q(e,t)||jQ()}function jQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Q(e,t){if(e){if(typeof e=="string")return Uz(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Uz(e,t)}}function Uz(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function UQ(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function VQ(e){if(Array.isArray(e))return e}function qQ(e,t){if(e==null)return{};var i=GQ(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function GQ(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function HQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WQ(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,j6(a.key),a)}}function ZQ(e,t,i){return t&&WQ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function XQ(e,t,i){return t=N0(t),KQ(e,B6()?Reflect.construct(t,i||[],N0(e).constructor):t.apply(e,i))}function KQ(e,t){if(t&&(ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YQ(e)}function YQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B6(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(B6=function(){return!!e})()}function N0(e){return N0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},N0(e)}function JQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xP(e,t)}function xP(e,t){return xP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},xP(e,t)}function N6(e,t,i){return t=j6(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function j6(e){var t=QQ(e,"string");return ug(t)=="symbol"?t:t+""}function QQ(e,t){if(ug(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ug(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wx=function(e){function t(){return HQ(this,t),XQ(this,t,arguments)}return JQ(t,e),ZQ(t,[{key:"render",value:function(){var a=this.props,h=a.offset,v=a.layout,S=a.width,o=a.dataKey,I=a.data,B=a.dataPointFormatter,$=a.xAxis,U=a.yAxis,K=qQ(a,BQ),te=ki(K,!1);this.props.direction==="x"&&$.type!=="number"&&em();var le=I.map(function(se){var ue=B(se,o),be=ue.x,Ce=ue.y,Re=ue.value,De=ue.errorVal;if(!De)return null;var ve=[],Le,Fe;if(Array.isArray(De)){var lt=NQ(De,2);Le=lt[0],Fe=lt[1]}else Le=Fe=De;if(v==="vertical"){var xt=$.scale,gt=Ce+h,Je=gt+S,St=gt-S,Nt=xt(Re-Le),Ht=xt(Re+Fe);ve.push({x1:Ht,y1:Je,x2:Ht,y2:St}),ve.push({x1:Nt,y1:gt,x2:Ht,y2:gt}),ve.push({x1:Nt,y1:Je,x2:Nt,y2:St})}else if(v==="horizontal"){var Ct=U.scale,Kt=be+h,Lt=Kt-S,et=Kt+S,vt=Ct(Re-Le),Ot=Ct(Re+Fe);ve.push({x1:Lt,y1:Ot,x2:et,y2:Ot}),ve.push({x1:Kt,y1:vt,x2:Kt,y2:Ot}),ve.push({x1:Lt,y1:vt,x2:et,y2:vt})}return Bt.createElement(Qo,B0({className:"recharts-errorBar",key:"bar-".concat(ve.map(function(mt){return"".concat(mt.x1,"-").concat(mt.x2,"-").concat(mt.y1,"-").concat(mt.y2)}))},te),ve.map(function(mt){return Bt.createElement("line",B0({},mt,{key:"line-".concat(mt.x1,"-").concat(mt.x2,"-").concat(mt.y1,"-").concat(mt.y2)}))}))});return Bt.createElement(Qo,{className:"recharts-errorBars"},le)}}])}(Bt.Component);N6(Wx,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});N6(Wx,"displayName","ErrorBar");function py(e){"@babel/helpers - typeof";return py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},py(e)}function Vz(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Ip(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Vz(Object(i),!0).forEach(function(a){eee(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Vz(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function eee(e,t,i){return t=tee(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function tee(e){var t=nee(e,"string");return py(t)=="symbol"?t:t+""}function nee(e,t){if(py(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(py(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $6=function(t){var i=t.children,a=t.formattedGraphicalItems,h=t.legendWidth,v=t.legendContent,S=tc(i,Wc);if(!S)return null;var o=Wc.defaultProps,I=o!==void 0?Ip(Ip({},o),S.props):{},B;return S.props&&S.props.payload?B=S.props&&S.props.payload:v==="children"?B=(a||[]).reduce(function($,U){var K=U.item,te=U.props,le=te.sectors||te.data||[];return $.concat(le.map(function(se){return{type:S.props.iconType||K.props.legendType,value:se.name,color:se.fill,payload:se}}))},[]):B=(a||[]).map(function($){var U=$.item,K=U.type.defaultProps,te=K!==void 0?Ip(Ip({},K),U.props):{},le=te.dataKey,se=te.name,ue=te.legendType,be=te.hide;return{inactive:be,dataKey:le,type:I.iconType||ue||"square",color:mI(U),value:se||le,payload:te}}),Ip(Ip(Ip({},I),Wc.getWithHeight(S,h)),{},{payload:B,item:S})};function my(e){"@babel/helpers - typeof";return my=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(e)}function qz(e){return aee(e)||oee(e)||iee(e)||ree()}function ree(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iee(e,t){if(e){if(typeof e=="string")return bP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return bP(e,t)}}function oee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aee(e){if(Array.isArray(e))return bP(e)}function bP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function Gz(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function as(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Gz(Object(i),!0).forEach(function(a){Jm(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Gz(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Jm(e,t,i){return t=see(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function see(e){var t=lee(e,"string");return my(t)=="symbol"?t:t+""}function lee(e,t){if(my(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(my(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nl(e,t,i){return ao(e)||ao(t)?i:Zs(t)?ic(e,t,i):Hi(t)?t(e):i}function W_(e,t,i,a){var h=aQ(e,function(o){return Nl(o,t)});if(i==="number"){var v=h.filter(function(o){return gr(o)||parseFloat(o)});return v.length?[Vx(v),Ux(v)]:[1/0,-1/0]}var S=a?h.filter(function(o){return!ao(o)}):h;return S.map(function(o){return Zs(o)||o instanceof Date?o:""})}var uee=function(t){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],h=arguments.length>2?arguments[2]:void 0,v=arguments.length>3?arguments[3]:void 0,S=-1,o=(i=a==null?void 0:a.length)!==null&&i!==void 0?i:0;if(o<=1)return 0;if(v&&v.axisType==="angleAxis"&&Math.abs(Math.abs(v.range[1]-v.range[0])-360)<=1e-6)for(var I=v.range,B=0;B<o;B++){var $=B>0?h[B-1].coordinate:h[o-1].coordinate,U=h[B].coordinate,K=B>=o-1?h[0].coordinate:h[B+1].coordinate,te=void 0;if(ou(U-$)!==ou(K-U)){var le=[];if(ou(K-U)===ou(I[1]-I[0])){te=K;var se=U+I[1]-I[0];le[0]=Math.min(se,(se+$)/2),le[1]=Math.max(se,(se+$)/2)}else{te=$;var ue=K+I[1]-I[0];le[0]=Math.min(U,(ue+U)/2),le[1]=Math.max(U,(ue+U)/2)}var be=[Math.min(U,(te+U)/2),Math.max(U,(te+U)/2)];if(t>be[0]&&t<=be[1]||t>=le[0]&&t<=le[1]){S=h[B].index;break}}else{var Ce=Math.min($,K),Re=Math.max($,K);if(t>(Ce+U)/2&&t<=(Re+U)/2){S=h[B].index;break}}}else for(var De=0;De<o;De++)if(De===0&&t<=(a[De].coordinate+a[De+1].coordinate)/2||De>0&&De<o-1&&t>(a[De].coordinate+a[De-1].coordinate)/2&&t<=(a[De].coordinate+a[De+1].coordinate)/2||De===o-1&&t>(a[De].coordinate+a[De-1].coordinate)/2){S=a[De].index;break}return S},mI=function(t){var i,a=t,h=a.type.displayName,v=(i=t.type)!==null&&i!==void 0&&i.defaultProps?as(as({},t.type.defaultProps),t.props):t.props,S=v.stroke,o=v.fill,I;switch(h){case"Line":I=S;break;case"Area":case"Radar":I=S&&S!=="none"?S:o;break;default:I=o;break}return I},cee=function(t){var i=t.barSize,a=t.totalSize,h=t.stackGroups,v=h===void 0?{}:h;if(!v)return{};for(var S={},o=Object.keys(v),I=0,B=o.length;I<B;I++)for(var $=v[o[I]].stackGroups,U=Object.keys($),K=0,te=U.length;K<te;K++){var le=$[U[K]],se=le.items,ue=le.cateAxisId,be=se.filter(function(Fe){return Zf(Fe.type).indexOf("Bar")>=0});if(be&&be.length){var Ce=be[0].type.defaultProps,Re=Ce!==void 0?as(as({},Ce),be[0].props):be[0].props,De=Re.barSize,ve=Re[ue];S[ve]||(S[ve]=[]);var Le=ao(De)?i:De;S[ve].push({item:be[0],stackList:be.slice(1),barSize:ao(Le)?void 0:au(Le,a,0)})}}return S},hee=function(t){var i=t.barGap,a=t.barCategoryGap,h=t.bandSize,v=t.sizeList,S=v===void 0?[]:v,o=t.maxBarSize,I=S.length;if(I<1)return null;var B=au(i,h,0,!0),$,U=[];if(S[0].barSize===+S[0].barSize){var K=!1,te=h/I,le=S.reduce(function(De,ve){return De+ve.barSize||0},0);le+=(I-1)*B,le>=h&&(le-=(I-1)*B,B=0),le>=h&&te>0&&(K=!0,te*=.9,le=I*te);var se=(h-le)/2>>0,ue={offset:se-B,size:0};$=S.reduce(function(De,ve){var Le={item:ve.item,position:{offset:ue.offset+ue.size+B,size:K?te:ve.barSize}},Fe=[].concat(qz(De),[Le]);return ue=Fe[Fe.length-1].position,ve.stackList&&ve.stackList.length&&ve.stackList.forEach(function(lt){Fe.push({item:lt,position:ue})}),Fe},U)}else{var be=au(a,h,0,!0);h-2*be-(I-1)*B<=0&&(B=0);var Ce=(h-2*be-(I-1)*B)/I;Ce>1&&(Ce>>=0);var Re=o===+o?Math.min(Ce,o):Ce;$=S.reduce(function(De,ve,Le){var Fe=[].concat(qz(De),[{item:ve.item,position:{offset:be+(Ce+B)*Le+(Ce-Re)/2,size:Re}}]);return ve.stackList&&ve.stackList.length&&ve.stackList.forEach(function(lt){Fe.push({item:lt,position:Fe[Fe.length-1].position})}),Fe},U)}return $},fee=function(t,i,a,h){var v=a.children,S=a.width,o=a.margin,I=S-(o.left||0)-(o.right||0),B=$6({children:v,legendWidth:I});if(B){var $=h||{},U=$.width,K=$.height,te=B.align,le=B.verticalAlign,se=B.layout;if((se==="vertical"||se==="horizontal"&&le==="middle")&&te!=="center"&&gr(t[te]))return as(as({},t),{},Jm({},te,t[te]+(U||0)));if((se==="horizontal"||se==="vertical"&&te==="center")&&le!=="middle"&&gr(t[le]))return as(as({},t),{},Jm({},le,t[le]+(K||0)))}return t},dee=function(t,i,a){return ao(i)?!0:t==="horizontal"?i==="yAxis":t==="vertical"||a==="x"?i==="xAxis":a==="y"?i==="yAxis":!0},U6=function(t,i,a,h,v){var S=i.props.children,o=Hc(S,Wx).filter(function(B){return dee(h,v,B.props.direction)});if(o&&o.length){var I=o.map(function(B){return B.props.dataKey});return t.reduce(function(B,$){var U=Nl($,a);if(ao(U))return B;var K=Array.isArray(U)?[Vx(U),Ux(U)]:[U,U],te=I.reduce(function(le,se){var ue=Nl($,se,0),be=K[0]-Math.abs(Array.isArray(ue)?ue[0]:ue),Ce=K[1]+Math.abs(Array.isArray(ue)?ue[1]:ue);return[Math.min(be,le[0]),Math.max(Ce,le[1])]},[1/0,-1/0]);return[Math.min(te[0],B[0]),Math.max(te[1],B[1])]},[1/0,-1/0])}return null},pee=function(t,i,a,h,v){var S=i.map(function(o){return U6(t,o,a,v,h)}).filter(function(o){return!ao(o)});return S&&S.length?S.reduce(function(o,I){return[Math.min(o[0],I[0]),Math.max(o[1],I[1])]},[1/0,-1/0]):null},V6=function(t,i,a,h,v){var S=i.map(function(I){var B=I.props.dataKey;return a==="number"&&B&&U6(t,I,B,h)||W_(t,B,a,v)});if(a==="number")return S.reduce(function(I,B){return[Math.min(I[0],B[0]),Math.max(I[1],B[1])]},[1/0,-1/0]);var o={};return S.reduce(function(I,B){for(var $=0,U=B.length;$<U;$++)o[B[$]]||(o[B[$]]=!0,I.push(B[$]));return I},[])},q6=function(t,i){return t==="horizontal"&&i==="xAxis"||t==="vertical"&&i==="yAxis"||t==="centric"&&i==="angleAxis"||t==="radial"&&i==="radiusAxis"},$p=function(t,i,a){if(!t)return null;var h=t.scale,v=t.duplicateDomain,S=t.type,o=t.range,I=t.realScaleType==="scaleBand"?h.bandwidth()/2:2,B=(i||a)&&S==="category"&&h.bandwidth?h.bandwidth()/I:0;if(B=t.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?ou(o[0]-o[1])*2*B:B,i&&(t.ticks||t.niceTicks)){var $=(t.ticks||t.niceTicks).map(function(U){var K=v?v.indexOf(U):U;return{coordinate:h(K)+B,value:U,offset:B}});return $.filter(function(U){return!Vy(U.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(U,K){return{coordinate:h(U)+B,value:U,index:K,offset:B}}):h.ticks&&!a?h.ticks(t.tickCount).map(function(U){return{coordinate:h(U)+B,value:U,offset:B}}):h.domain().map(function(U,K){return{coordinate:h(U)+B,value:v?v[U]:U,index:K,offset:B}})},eT=new WeakMap,e0=function(t,i){if(typeof i!="function")return t;eT.has(t)||eT.set(t,new WeakMap);var a=eT.get(t);if(a.has(i))return a.get(i);var h=function(){t.apply(void 0,arguments),i.apply(void 0,arguments)};return a.set(i,h),h},G6=function(t,i,a){var h=t.scale,v=t.type,S=t.layout,o=t.axisType;if(h==="auto")return S==="radial"&&o==="radiusAxis"?{scale:sy(),realScaleType:"band"}:S==="radial"&&o==="angleAxis"?{scale:R0(),realScaleType:"linear"}:v==="category"&&i&&(i.indexOf("LineChart")>=0||i.indexOf("AreaChart")>=0||i.indexOf("ComposedChart")>=0&&!a)?{scale:H_(),realScaleType:"point"}:v==="category"?{scale:sy(),realScaleType:"band"}:{scale:R0(),realScaleType:"linear"};if(Uy(h)){var I="scale".concat(Sx(h));return{scale:(Cz[I]||H_)(),realScaleType:Cz[I]?I:"point"}}return Hi(h)?{scale:h}:{scale:H_(),realScaleType:"point"}},Hz=1e-4,H6=function(t){var i=t.domain();if(!(!i||i.length<=2)){var a=i.length,h=t.range(),v=Math.min(h[0],h[1])-Hz,S=Math.max(h[0],h[1])+Hz,o=t(i[0]),I=t(i[a-1]);(o<v||o>S||I<v||I>S)&&t.domain([i[0],i[a-1]])}},mee=function(t,i){if(!t)return null;for(var a=0,h=t.length;a<h;a++)if(t[a].item===i)return t[a].position;return null},gee=function(t,i){if(!i||i.length!==2||!gr(i[0])||!gr(i[1]))return t;var a=Math.min(i[0],i[1]),h=Math.max(i[0],i[1]),v=[t[0],t[1]];return(!gr(t[0])||t[0]<a)&&(v[0]=a),(!gr(t[1])||t[1]>h)&&(v[1]=h),v[0]>h&&(v[0]=h),v[1]<a&&(v[1]=a),v},_ee=function(t){var i=t.length;if(!(i<=0))for(var a=0,h=t[0].length;a<h;++a)for(var v=0,S=0,o=0;o<i;++o){var I=Vy(t[o][a][1])?t[o][a][0]:t[o][a][1];I>=0?(t[o][a][0]=v,t[o][a][1]=v+I,v=t[o][a][1]):(t[o][a][0]=S,t[o][a][1]=S+I,S=t[o][a][1])}},yee=function(t){var i=t.length;if(!(i<=0))for(var a=0,h=t[0].length;a<h;++a)for(var v=0,S=0;S<i;++S){var o=Vy(t[S][a][1])?t[S][a][0]:t[S][a][1];o>=0?(t[S][a][0]=v,t[S][a][1]=v+o,v=t[S][a][1]):(t[S][a][0]=0,t[S][a][1]=0)}},vee={sign:_ee,expand:AW,none:tg,silhouette:PW,wiggle:MW,positive:yee},xee=function(t,i,a){var h=i.map(function(o){return o.props.dataKey}),v=vee[a],S=EW().keys(h).value(function(o,I){return+Nl(o,I,0)}).order(KA).offset(v);return S(t)},bee=function(t,i,a,h,v,S){if(!t)return null;var o=S?i.reverse():i,I={},B=o.reduce(function(U,K){var te,le=(te=K.type)!==null&&te!==void 0&&te.defaultProps?as(as({},K.type.defaultProps),K.props):K.props,se=le.stackId,ue=le.hide;if(ue)return U;var be=le[a],Ce=U[be]||{hasStack:!1,stackGroups:{}};if(Zs(se)){var Re=Ce.stackGroups[se]||{numericAxisId:a,cateAxisId:h,items:[]};Re.items.push(K),Ce.hasStack=!0,Ce.stackGroups[se]=Re}else Ce.stackGroups[qy("_stackId_")]={numericAxisId:a,cateAxisId:h,items:[K]};return as(as({},U),{},Jm({},be,Ce))},I),$={};return Object.keys(B).reduce(function(U,K){var te=B[K];if(te.hasStack){var le={};te.stackGroups=Object.keys(te.stackGroups).reduce(function(se,ue){var be=te.stackGroups[ue];return as(as({},se),{},Jm({},ue,{numericAxisId:a,cateAxisId:h,items:be.items,stackedData:xee(t,be.items,v)}))},le)}return as(as({},U),{},Jm({},K,te))},$)},W6=function(t,i){var a=i.realScaleType,h=i.type,v=i.tickCount,S=i.originalDomain,o=i.allowDecimals,I=a||i.scale;if(I!=="auto"&&I!=="linear")return null;if(v&&h==="number"&&S&&(S[0]==="auto"||S[1]==="auto")){var B=t.domain();if(!B.length)return null;var $=DQ(B,v,o);return t.domain([Vx($),Ux($)]),{niceTicks:$}}if(v&&h==="number"){var U=t.domain(),K=zQ(U,v,o);return{niceTicks:K}}return null},Wz=function(t){var i=t.axis,a=t.ticks,h=t.offset,v=t.bandSize,S=t.entry,o=t.index;if(i.type==="category")return a[o]?a[o].coordinate+h:null;var I=Nl(S,i.dataKey,i.domain[o]);return ao(I)?null:i.scale(I)-v/2+h},wee=function(t){var i=t.numericAxis,a=i.scale.domain();if(i.type==="number"){var h=Math.min(a[0],a[1]),v=Math.max(a[0],a[1]);return h<=0&&v>=0?0:v<0?v:h}return a[0]},See=function(t,i){var a,h=(a=t.type)!==null&&a!==void 0&&a.defaultProps?as(as({},t.type.defaultProps),t.props):t.props,v=h.stackId;if(Zs(v)){var S=i[v];if(S){var o=S.items.indexOf(t);return o>=0?S.stackedData[o]:null}}return null},Tee=function(t){return t.reduce(function(i,a){return[Vx(a.concat([i[0]]).filter(gr)),Ux(a.concat([i[1]]).filter(gr))]},[1/0,-1/0])},Z6=function(t,i,a){return Object.keys(t).reduce(function(h,v){var S=t[v],o=S.stackedData,I=o.reduce(function(B,$){var U=Tee($.slice(i,a+1));return[Math.min(B[0],U[0]),Math.max(B[1],U[1])]},[1/0,-1/0]);return[Math.min(I[0],h[0]),Math.max(I[1],h[1])]},[1/0,-1/0]).map(function(h){return h===1/0||h===-1/0?0:h})},Zz=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Xz=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,wP=function(t,i,a){if(Hi(t))return t(i,a);if(!Array.isArray(t))return i;var h=[];if(gr(t[0]))h[0]=a?t[0]:Math.min(t[0],i[0]);else if(Zz.test(t[0])){var v=+Zz.exec(t[0])[1];h[0]=i[0]-v}else Hi(t[0])?h[0]=t[0](i[0]):h[0]=i[0];if(gr(t[1]))h[1]=a?t[1]:Math.max(t[1],i[1]);else if(Xz.test(t[1])){var S=+Xz.exec(t[1])[1];h[1]=i[1]+S}else Hi(t[1])?h[1]=t[1](i[1]):h[1]=i[1];return h},j0=function(t,i,a){if(t&&t.scale&&t.scale.bandwidth){var h=t.scale.bandwidth();if(!a||h>0)return h}if(t&&i&&i.length>=2){for(var v=VM(i,function(U){return U.coordinate}),S=1/0,o=1,I=v.length;o<I;o++){var B=v[o],$=v[o-1];S=Math.min((B.coordinate||0)-($.coordinate||0),S)}return S===1/0?0:S}return a?void 0:0},Kz=function(t,i,a){return!t||!t.length||qx(t,ic(a,"type.defaultProps.domain"))?i:t},X6=function(t,i){var a=t.type.defaultProps?as(as({},t.type.defaultProps),t.props):t.props,h=a.dataKey,v=a.name,S=a.unit,o=a.formatter,I=a.tooltipType,B=a.chartType,$=a.hide;return as(as({},ki(t,!1)),{},{dataKey:h,unit:S,formatter:o,name:v||h,color:mI(t),value:Nl(i,h),type:I,payload:i,chartType:B,hide:$})};function gy(e){"@babel/helpers - typeof";return gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gy(e)}function Yz(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function qf(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Yz(Object(i),!0).forEach(function(a){K6(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yz(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function K6(e,t,i){return t=Eee(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Eee(e){var t=Aee(e,"string");return gy(t)=="symbol"?t:t+""}function Aee(e,t){if(gy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(gy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pee(e,t){return Oee(e)||Cee(e,t)||Iee(e,t)||Mee()}function Mee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iee(e,t){if(e){if(typeof e=="string")return Jz(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Jz(e,t)}}function Jz(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function Cee(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function Oee(e){if(Array.isArray(e))return e}var $0=Math.PI/180,kee=function(t){return t*180/Math.PI},Ma=function(t,i,a,h){return{x:t+Math.cos(-$0*h)*a,y:i+Math.sin(-$0*h)*a}},Y6=function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(i-(a.top||0)-(a.bottom||0)))/2},Ree=function(t,i,a,h,v){var S=t.width,o=t.height,I=t.startAngle,B=t.endAngle,$=au(t.cx,S,S/2),U=au(t.cy,o,o/2),K=Y6(S,o,a),te=au(t.innerRadius,K,0),le=au(t.outerRadius,K,K*.8),se=Object.keys(i);return se.reduce(function(ue,be){var Ce=i[be],Re=Ce.domain,De=Ce.reversed,ve;if(ao(Ce.range))h==="angleAxis"?ve=[I,B]:h==="radiusAxis"&&(ve=[te,le]),De&&(ve=[ve[1],ve[0]]);else{ve=Ce.range;var Le=ve,Fe=Pee(Le,2);I=Fe[0],B=Fe[1]}var lt=G6(Ce,v),xt=lt.realScaleType,gt=lt.scale;gt.domain(Re).range(ve),H6(gt);var Je=W6(gt,qf(qf({},Ce),{},{realScaleType:xt})),St=qf(qf(qf({},Ce),Je),{},{range:ve,radius:le,realScaleType:xt,scale:gt,cx:$,cy:U,innerRadius:te,outerRadius:le,startAngle:I,endAngle:B});return qf(qf({},ue),{},K6({},be,St))},{})},Lee=function(t,i){var a=t.x,h=t.y,v=i.x,S=i.y;return Math.sqrt(Math.pow(a-v,2)+Math.pow(h-S,2))},Dee=function(t,i){var a=t.x,h=t.y,v=i.cx,S=i.cy,o=Lee({x:a,y:h},{x:v,y:S});if(o<=0)return{radius:o};var I=(a-v)/o,B=Math.acos(I);return h>S&&(B=2*Math.PI-B),{radius:o,angle:kee(B),angleInRadian:B}},zee=function(t){var i=t.startAngle,a=t.endAngle,h=Math.floor(i/360),v=Math.floor(a/360),S=Math.min(h,v);return{startAngle:i-S*360,endAngle:a-S*360}},Fee=function(t,i){var a=i.startAngle,h=i.endAngle,v=Math.floor(a/360),S=Math.floor(h/360),o=Math.min(v,S);return t+o*360},Qz=function(t,i){var a=t.x,h=t.y,v=Dee({x:a,y:h},i),S=v.radius,o=v.angle,I=i.innerRadius,B=i.outerRadius;if(S<I||S>B)return!1;if(S===0)return!0;var $=zee(i),U=$.startAngle,K=$.endAngle,te=o,le;if(U<=K){for(;te>K;)te-=360;for(;te<U;)te+=360;le=te>=U&&te<=K}else{for(;te>U;)te-=360;for(;te<K;)te+=360;le=te>=K&&te<=U}return le?qf(qf({},i),{},{radius:S,angle:Fee(te,i)}):null},J6=function(t){return!rt.isValidElement(t)&&!Hi(t)&&typeof t!="boolean"?t.className:""};function _y(e){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_y(e)}var Bee=["offset"];function Nee(e){return Vee(e)||Uee(e)||$ee(e)||jee()}function jee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ee(e,t){if(e){if(typeof e=="string")return SP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return SP(e,t)}}function Uee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vee(e){if(Array.isArray(e))return SP(e)}function SP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function qee(e,t){if(e==null)return{};var i=Gee(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Gee(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function eF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Ws(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(i),!0).forEach(function(a){Hee(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):eF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Hee(e,t,i){return t=Wee(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Wee(e){var t=Zee(e,"string");return _y(t)=="symbol"?t:t+""}function Zee(e,t){if(_y(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(_y(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yy(){return yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},yy.apply(this,arguments)}var Xee=function(t){var i=t.value,a=t.formatter,h=ao(t.children)?i:t.children;return Hi(a)?a(h):h},Kee=function(t,i){var a=ou(i-t),h=Math.min(Math.abs(i-t),360);return a*h},Yee=function(t,i,a){var h=t.position,v=t.viewBox,S=t.offset,o=t.className,I=v,B=I.cx,$=I.cy,U=I.innerRadius,K=I.outerRadius,te=I.startAngle,le=I.endAngle,se=I.clockWise,ue=(U+K)/2,be=Kee(te,le),Ce=be>=0?1:-1,Re,De;h==="insideStart"?(Re=te+Ce*S,De=se):h==="insideEnd"?(Re=le-Ce*S,De=!se):h==="end"&&(Re=le+Ce*S,De=se),De=be<=0?De:!De;var ve=Ma(B,$,ue,Re),Le=Ma(B,$,ue,Re+(De?1:-1)*359),Fe="M".concat(ve.x,",").concat(ve.y,`
    A`).concat(ue,",").concat(ue,",0,1,").concat(De?0:1,`,
    `).concat(Le.x,",").concat(Le.y),lt=ao(t.id)?qy("recharts-radial-line-"):t.id;return Bt.createElement("text",yy({},a,{dominantBaseline:"central",className:to("recharts-radial-bar-label",o)}),Bt.createElement("defs",null,Bt.createElement("path",{id:lt,d:Fe})),Bt.createElement("textPath",{xlinkHref:"#".concat(lt)},i))},Jee=function(t){var i=t.viewBox,a=t.offset,h=t.position,v=i,S=v.cx,o=v.cy,I=v.innerRadius,B=v.outerRadius,$=v.startAngle,U=v.endAngle,K=($+U)/2;if(h==="outside"){var te=Ma(S,o,B+a,K),le=te.x,se=te.y;return{x:le,y:se,textAnchor:le>=S?"start":"end",verticalAnchor:"middle"}}if(h==="center")return{x:S,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(h==="centerTop")return{x:S,y:o,textAnchor:"middle",verticalAnchor:"start"};if(h==="centerBottom")return{x:S,y:o,textAnchor:"middle",verticalAnchor:"end"};var ue=(I+B)/2,be=Ma(S,o,ue,K),Ce=be.x,Re=be.y;return{x:Ce,y:Re,textAnchor:"middle",verticalAnchor:"middle"}},Qee=function(t){var i=t.viewBox,a=t.parentViewBox,h=t.offset,v=t.position,S=i,o=S.x,I=S.y,B=S.width,$=S.height,U=$>=0?1:-1,K=U*h,te=U>0?"end":"start",le=U>0?"start":"end",se=B>=0?1:-1,ue=se*h,be=se>0?"end":"start",Ce=se>0?"start":"end";if(v==="top"){var Re={x:o+B/2,y:I-U*h,textAnchor:"middle",verticalAnchor:te};return Ws(Ws({},Re),a?{height:Math.max(I-a.y,0),width:B}:{})}if(v==="bottom"){var De={x:o+B/2,y:I+$+K,textAnchor:"middle",verticalAnchor:le};return Ws(Ws({},De),a?{height:Math.max(a.y+a.height-(I+$),0),width:B}:{})}if(v==="left"){var ve={x:o-ue,y:I+$/2,textAnchor:be,verticalAnchor:"middle"};return Ws(Ws({},ve),a?{width:Math.max(ve.x-a.x,0),height:$}:{})}if(v==="right"){var Le={x:o+B+ue,y:I+$/2,textAnchor:Ce,verticalAnchor:"middle"};return Ws(Ws({},Le),a?{width:Math.max(a.x+a.width-Le.x,0),height:$}:{})}var Fe=a?{width:B,height:$}:{};return v==="insideLeft"?Ws({x:o+ue,y:I+$/2,textAnchor:Ce,verticalAnchor:"middle"},Fe):v==="insideRight"?Ws({x:o+B-ue,y:I+$/2,textAnchor:be,verticalAnchor:"middle"},Fe):v==="insideTop"?Ws({x:o+B/2,y:I+K,textAnchor:"middle",verticalAnchor:le},Fe):v==="insideBottom"?Ws({x:o+B/2,y:I+$-K,textAnchor:"middle",verticalAnchor:te},Fe):v==="insideTopLeft"?Ws({x:o+ue,y:I+K,textAnchor:Ce,verticalAnchor:le},Fe):v==="insideTopRight"?Ws({x:o+B-ue,y:I+K,textAnchor:be,verticalAnchor:le},Fe):v==="insideBottomLeft"?Ws({x:o+ue,y:I+$-K,textAnchor:Ce,verticalAnchor:te},Fe):v==="insideBottomRight"?Ws({x:o+B-ue,y:I+$-K,textAnchor:be,verticalAnchor:te},Fe):Rg(v)&&(gr(v.x)||Bp(v.x))&&(gr(v.y)||Bp(v.y))?Ws({x:o+au(v.x,B),y:I+au(v.y,$),textAnchor:"end",verticalAnchor:"end"},Fe):Ws({x:o+B/2,y:I+$/2,textAnchor:"middle",verticalAnchor:"middle"},Fe)},ete=function(t){return"cx"in t&&gr(t.cx)};function ul(e){var t=e.offset,i=t===void 0?5:t,a=qee(e,Bee),h=Ws({offset:i},a),v=h.viewBox,S=h.position,o=h.value,I=h.children,B=h.content,$=h.className,U=$===void 0?"":$,K=h.textBreakAll;if(!v||ao(o)&&ao(I)&&!rt.isValidElement(B)&&!Hi(B))return null;if(rt.isValidElement(B))return rt.cloneElement(B,h);var te;if(Hi(B)){if(te=rt.createElement(B,h),rt.isValidElement(te))return te}else te=Xee(h);var le=ete(v),se=ki(h,!0);if(le&&(S==="insideStart"||S==="insideEnd"||S==="end"))return Yee(h,te,se);var ue=le?Jee(h):Qee(h);return Bt.createElement(Jp,yy({className:to("recharts-label",U)},se,ue,{breakAll:K}),te)}ul.displayName="Label";var Q6=function(t){var i=t.cx,a=t.cy,h=t.angle,v=t.startAngle,S=t.endAngle,o=t.r,I=t.radius,B=t.innerRadius,$=t.outerRadius,U=t.x,K=t.y,te=t.top,le=t.left,se=t.width,ue=t.height,be=t.clockWise,Ce=t.labelViewBox;if(Ce)return Ce;if(gr(se)&&gr(ue)){if(gr(U)&&gr(K))return{x:U,y:K,width:se,height:ue};if(gr(te)&&gr(le))return{x:te,y:le,width:se,height:ue}}return gr(U)&&gr(K)?{x:U,y:K,width:0,height:0}:gr(i)&&gr(a)?{cx:i,cy:a,startAngle:v||h||0,endAngle:S||h||0,innerRadius:B||0,outerRadius:$||I||o||0,clockWise:be}:t.viewBox?t.viewBox:{}},tte=function(t,i){return t?t===!0?Bt.createElement(ul,{key:"label-implicit",viewBox:i}):Zs(t)?Bt.createElement(ul,{key:"label-implicit",viewBox:i,value:t}):rt.isValidElement(t)?t.type===ul?rt.cloneElement(t,{key:"label-implicit",viewBox:i}):Bt.createElement(ul,{key:"label-implicit",content:t,viewBox:i}):Hi(t)?Bt.createElement(ul,{key:"label-implicit",content:t,viewBox:i}):Rg(t)?Bt.createElement(ul,yy({viewBox:i},t,{key:"label-implicit"})):null:null},nte=function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&a&&!t.label)return null;var h=t.children,v=Q6(t),S=Hc(h,ul).map(function(I,B){return rt.cloneElement(I,{viewBox:i||v,key:"label-".concat(B)})});if(!a)return S;var o=tte(t.label,i||v);return[o].concat(Nee(S))};ul.parseViewBox=Q6;ul.renderCallByParent=nte;var tT,tF;function gI(){if(tF)return tT;tF=1;function e(t){var i=t==null?0:t.length;return i?t[i-1]:void 0}return tT=e,tT}var rte=gI();const ite=zo(rte);function vy(e){"@babel/helpers - typeof";return vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vy(e)}var ote=["valueAccessor"],ate=["data","dataKey","clockWise","id","textBreakAll"];function ste(e){return hte(e)||cte(e)||ute(e)||lte()}function lte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ute(e,t){if(e){if(typeof e=="string")return TP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return TP(e,t)}}function cte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hte(e){if(Array.isArray(e))return TP(e)}function TP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},U0.apply(this,arguments)}function nF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function rF(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?nF(Object(i),!0).forEach(function(a){fte(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function fte(e,t,i){return t=dte(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function dte(e){var t=pte(e,"string");return vy(t)=="symbol"?t:t+""}function pte(e,t){if(vy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(vy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iF(e,t){if(e==null)return{};var i=mte(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function mte(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}var gte=function(t){return Array.isArray(t.value)?ite(t.value):t.value};function Gd(e){var t=e.valueAccessor,i=t===void 0?gte:t,a=iF(e,ote),h=a.data,v=a.dataKey,S=a.clockWise,o=a.id,I=a.textBreakAll,B=iF(a,ate);return!h||!h.length?null:Bt.createElement(Qo,{className:"recharts-label-list"},h.map(function($,U){var K=ao(v)?i($,U):Nl($&&$.payload,v),te=ao(o)?{}:{id:"".concat(o,"-").concat(U)};return Bt.createElement(ul,U0({},ki($,!0),B,te,{parentViewBox:$.parentViewBox,value:K,textBreakAll:I,viewBox:ul.parseViewBox(ao(S)?$:rF(rF({},$),{},{clockWise:S})),key:"label-".concat(U),index:U}))}))}Gd.displayName="LabelList";function _te(e,t){return e?e===!0?Bt.createElement(Gd,{key:"labelList-implicit",data:t}):Bt.isValidElement(e)||Hi(e)?Bt.createElement(Gd,{key:"labelList-implicit",data:t,content:e}):Rg(e)?Bt.createElement(Gd,U0({data:t},e,{key:"labelList-implicit"})):null:null}function yte(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&i&&!e.label)return null;var a=e.children,h=Hc(a,Gd).map(function(S,o){return rt.cloneElement(S,{data:t,key:"labelList-".concat(o)})});if(!i)return h;var v=_te(e.label,t);return[v].concat(ste(h))}Gd.renderCallByParent=yte;function xy(e){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xy(e)}function EP(){return EP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},EP.apply(this,arguments)}function oF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function aF(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?oF(Object(i),!0).forEach(function(a){vte(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function vte(e,t,i){return t=xte(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function xte(e){var t=bte(e,"string");return xy(t)=="symbol"?t:t+""}function bte(e,t){if(xy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(xy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wte=function(t,i){var a=ou(i-t),h=Math.min(Math.abs(i-t),359.999);return a*h},t0=function(t){var i=t.cx,a=t.cy,h=t.radius,v=t.angle,S=t.sign,o=t.isExternal,I=t.cornerRadius,B=t.cornerIsExternal,$=I*(o?1:-1)+h,U=Math.asin(I/$)/$0,K=B?v:v+S*U,te=Ma(i,a,$,K),le=Ma(i,a,h,K),se=B?v-S*U:v,ue=Ma(i,a,$*Math.cos(U*$0),se);return{center:te,circleTangency:le,lineTangency:ue,theta:U}},e$=function(t){var i=t.cx,a=t.cy,h=t.innerRadius,v=t.outerRadius,S=t.startAngle,o=t.endAngle,I=wte(S,o),B=S+I,$=Ma(i,a,v,S),U=Ma(i,a,v,B),K="M ".concat($.x,",").concat($.y,`
    A `).concat(v,",").concat(v,`,0,
    `).concat(+(Math.abs(I)>180),",").concat(+(S>B),`,
    `).concat(U.x,",").concat(U.y,`
  `);if(h>0){var te=Ma(i,a,h,S),le=Ma(i,a,h,B);K+="L ".concat(le.x,",").concat(le.y,`
            A `).concat(h,",").concat(h,`,0,
            `).concat(+(Math.abs(I)>180),",").concat(+(S<=B),`,
            `).concat(te.x,",").concat(te.y," Z")}else K+="L ".concat(i,",").concat(a," Z");return K},Ste=function(t){var i=t.cx,a=t.cy,h=t.innerRadius,v=t.outerRadius,S=t.cornerRadius,o=t.forceCornerRadius,I=t.cornerIsExternal,B=t.startAngle,$=t.endAngle,U=ou($-B),K=t0({cx:i,cy:a,radius:v,angle:B,sign:U,cornerRadius:S,cornerIsExternal:I}),te=K.circleTangency,le=K.lineTangency,se=K.theta,ue=t0({cx:i,cy:a,radius:v,angle:$,sign:-U,cornerRadius:S,cornerIsExternal:I}),be=ue.circleTangency,Ce=ue.lineTangency,Re=ue.theta,De=I?Math.abs(B-$):Math.abs(B-$)-se-Re;if(De<0)return o?"M ".concat(le.x,",").concat(le.y,`
        a`).concat(S,",").concat(S,",0,0,1,").concat(S*2,`,0
        a`).concat(S,",").concat(S,",0,0,1,").concat(-S*2,`,0
      `):e$({cx:i,cy:a,innerRadius:h,outerRadius:v,startAngle:B,endAngle:$});var ve="M ".concat(le.x,",").concat(le.y,`
    A`).concat(S,",").concat(S,",0,0,").concat(+(U<0),",").concat(te.x,",").concat(te.y,`
    A`).concat(v,",").concat(v,",0,").concat(+(De>180),",").concat(+(U<0),",").concat(be.x,",").concat(be.y,`
    A`).concat(S,",").concat(S,",0,0,").concat(+(U<0),",").concat(Ce.x,",").concat(Ce.y,`
  `);if(h>0){var Le=t0({cx:i,cy:a,radius:h,angle:B,sign:U,isExternal:!0,cornerRadius:S,cornerIsExternal:I}),Fe=Le.circleTangency,lt=Le.lineTangency,xt=Le.theta,gt=t0({cx:i,cy:a,radius:h,angle:$,sign:-U,isExternal:!0,cornerRadius:S,cornerIsExternal:I}),Je=gt.circleTangency,St=gt.lineTangency,Nt=gt.theta,Ht=I?Math.abs(B-$):Math.abs(B-$)-xt-Nt;if(Ht<0&&S===0)return"".concat(ve,"L").concat(i,",").concat(a,"Z");ve+="L".concat(St.x,",").concat(St.y,`
      A`).concat(S,",").concat(S,",0,0,").concat(+(U<0),",").concat(Je.x,",").concat(Je.y,`
      A`).concat(h,",").concat(h,",0,").concat(+(Ht>180),",").concat(+(U>0),",").concat(Fe.x,",").concat(Fe.y,`
      A`).concat(S,",").concat(S,",0,0,").concat(+(U<0),",").concat(lt.x,",").concat(lt.y,"Z")}else ve+="L".concat(i,",").concat(a,"Z");return ve},Tte={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},t$=function(t){var i=aF(aF({},Tte),t),a=i.cx,h=i.cy,v=i.innerRadius,S=i.outerRadius,o=i.cornerRadius,I=i.forceCornerRadius,B=i.cornerIsExternal,$=i.startAngle,U=i.endAngle,K=i.className;if(S<v||$===U)return null;var te=to("recharts-sector",K),le=S-v,se=au(o,le,0,!0),ue;return se>0&&Math.abs($-U)<360?ue=Ste({cx:a,cy:h,innerRadius:v,outerRadius:S,cornerRadius:Math.min(se,le/2),forceCornerRadius:I,cornerIsExternal:B,startAngle:$,endAngle:U}):ue=e$({cx:a,cy:h,innerRadius:v,outerRadius:S,startAngle:$,endAngle:U}),Bt.createElement("path",EP({},ki(i,!0),{className:te,d:ue,role:"img"}))};function by(e){"@babel/helpers - typeof";return by=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},by(e)}function AP(){return AP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},AP.apply(this,arguments)}function sF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function lF(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?sF(Object(i),!0).forEach(function(a){Ete(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):sF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Ete(e,t,i){return t=Ate(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ate(e){var t=Pte(e,"string");return by(t)=="symbol"?t:t+""}function Pte(e,t){if(by(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(by(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uF={curveBasisClosed:pW,curveBasisOpen:mW,curveBasis:dW,curveBumpX:Q9,curveBumpY:eW,curveLinearClosed:gW,curveLinear:Ex,curveMonotoneX:_W,curveMonotoneY:yW,curveNatural:vW,curveStep:xW,curveStepAfter:wW,curveStepBefore:bW},n0=function(t){return t.x===+t.x&&t.y===+t.y},R_=function(t){return t.x},L_=function(t){return t.y},Mte=function(t,i){if(Hi(t))return t;var a="curve".concat(Sx(t));return(a==="curveMonotone"||a==="curveBump")&&i?uF["".concat(a).concat(i==="vertical"?"Y":"X")]:uF[a]||Ex},Ite=function(t){var i=t.type,a=i===void 0?"linear":i,h=t.points,v=h===void 0?[]:h,S=t.baseLine,o=t.layout,I=t.connectNulls,B=I===void 0?!1:I,$=Mte(a,o),U=B?v.filter(function(se){return n0(se)}):v,K;if(Array.isArray(S)){var te=B?S.filter(function(se){return n0(se)}):S,le=U.map(function(se,ue){return lF(lF({},se),{},{base:te[ue]})});return o==="vertical"?K=Wv().y(L_).x1(R_).x0(function(se){return se.base.x}):K=Wv().x(R_).y1(L_).y0(function(se){return se.base.y}),K.defined(n0).curve($),K(le)}return o==="vertical"&&gr(S)?K=Wv().y(L_).x1(R_).x0(S):gr(S)?K=Wv().x(R_).y1(L_).y0(S):K=XN().x(R_).y(L_),K.defined(n0).curve($),K(U)},PP=function(t){var i=t.className,a=t.points,h=t.path,v=t.pathRef;if((!a||!a.length)&&!h)return null;var S=a&&a.length?Ite(t):h;return Bt.createElement("path",AP({},ki(t,!1),g0(t),{className:to("recharts-curve",i),d:S,ref:v}))},nT={exports:{}},rT,cF;function Cte(){if(cF)return rT;cF=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return rT=e,rT}var iT,hF;function Ote(){if(hF)return iT;hF=1;var e=Cte();function t(){}function i(){}return i.resetWarningCache=t,iT=function(){function a(S,o,I,B,$,U){if(U!==e){var K=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw K.name="Invariant Violation",K}}a.isRequired=a;function h(){return a}var v={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:h,element:a,elementType:a,instanceOf:h,node:a,objectOf:h,oneOf:h,oneOfType:h,shape:h,exact:h,checkPropTypes:i,resetWarningCache:t};return v.PropTypes=v,v},iT}var fF;function kte(){return fF||(fF=1,nT.exports=Ote()()),nT.exports}var Rte=kte();const Gi=zo(Rte);var Lte=Object.getOwnPropertyNames,Dte=Object.getOwnPropertySymbols,zte=Object.prototype.hasOwnProperty;function dF(e,t){return function(a,h,v){return e(a,h,v)&&t(a,h,v)}}function r0(e){return function(i,a,h){if(!i||!a||typeof i!="object"||typeof a!="object")return e(i,a,h);var v=h.cache,S=v.get(i),o=v.get(a);if(S&&o)return S===a&&o===i;v.set(i,a),v.set(a,i);var I=e(i,a,h);return v.delete(i),v.delete(a),I}}function pF(e){return Lte(e).concat(Dte(e))}var n$=Object.hasOwn||function(e,t){return zte.call(e,t)};function Bg(e,t){return e||t?e===t:e===t||e!==e&&t!==t}var r$="_owner",mF=Object.getOwnPropertyDescriptor,gF=Object.keys;function Fte(e,t,i){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!i.equals(e[a],t[a],a,a,e,t,i))return!1;return!0}function Bte(e,t){return Bg(e.getTime(),t.getTime())}function _F(e,t,i){if(e.size!==t.size)return!1;for(var a={},h=e.entries(),v=0,S,o;(S=h.next())&&!S.done;){for(var I=t.entries(),B=!1,$=0;(o=I.next())&&!o.done;){var U=S.value,K=U[0],te=U[1],le=o.value,se=le[0],ue=le[1];!B&&!a[$]&&(B=i.equals(K,se,v,$,e,t,i)&&i.equals(te,ue,K,se,e,t,i))&&(a[$]=!0),$++}if(!B)return!1;v++}return!0}function Nte(e,t,i){var a=gF(e),h=a.length;if(gF(t).length!==h)return!1;for(var v;h-- >0;)if(v=a[h],v===r$&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!n$(t,v)||!i.equals(e[v],t[v],v,v,e,t,i))return!1;return!0}function D_(e,t,i){var a=pF(e),h=a.length;if(pF(t).length!==h)return!1;for(var v,S,o;h-- >0;)if(v=a[h],v===r$&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!n$(t,v)||!i.equals(e[v],t[v],v,v,e,t,i)||(S=mF(e,v),o=mF(t,v),(S||o)&&(!S||!o||S.configurable!==o.configurable||S.enumerable!==o.enumerable||S.writable!==o.writable)))return!1;return!0}function jte(e,t){return Bg(e.valueOf(),t.valueOf())}function $te(e,t){return e.source===t.source&&e.flags===t.flags}function yF(e,t,i){if(e.size!==t.size)return!1;for(var a={},h=e.values(),v,S;(v=h.next())&&!v.done;){for(var o=t.values(),I=!1,B=0;(S=o.next())&&!S.done;)!I&&!a[B]&&(I=i.equals(v.value,S.value,v.value,S.value,e,t,i))&&(a[B]=!0),B++;if(!I)return!1}return!0}function Ute(e,t){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(e[i]!==t[i])return!1;return!0}var Vte="[object Arguments]",qte="[object Boolean]",Gte="[object Date]",Hte="[object Map]",Wte="[object Number]",Zte="[object Object]",Xte="[object RegExp]",Kte="[object Set]",Yte="[object String]",Jte=Array.isArray,vF=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,xF=Object.assign,Qte=Object.prototype.toString.call.bind(Object.prototype.toString);function ene(e){var t=e.areArraysEqual,i=e.areDatesEqual,a=e.areMapsEqual,h=e.areObjectsEqual,v=e.arePrimitiveWrappersEqual,S=e.areRegExpsEqual,o=e.areSetsEqual,I=e.areTypedArraysEqual;return function($,U,K){if($===U)return!0;if($==null||U==null||typeof $!="object"||typeof U!="object")return $!==$&&U!==U;var te=$.constructor;if(te!==U.constructor)return!1;if(te===Object)return h($,U,K);if(Jte($))return t($,U,K);if(vF!=null&&vF($))return I($,U,K);if(te===Date)return i($,U,K);if(te===RegExp)return S($,U,K);if(te===Map)return a($,U,K);if(te===Set)return o($,U,K);var le=Qte($);return le===Gte?i($,U,K):le===Xte?S($,U,K):le===Hte?a($,U,K):le===Kte?o($,U,K):le===Zte?typeof $.then!="function"&&typeof U.then!="function"&&h($,U,K):le===Vte?h($,U,K):le===qte||le===Wte||le===Yte?v($,U,K):!1}}function tne(e){var t=e.circular,i=e.createCustomConfig,a=e.strict,h={areArraysEqual:a?D_:Fte,areDatesEqual:Bte,areMapsEqual:a?dF(_F,D_):_F,areObjectsEqual:a?D_:Nte,arePrimitiveWrappersEqual:jte,areRegExpsEqual:$te,areSetsEqual:a?dF(yF,D_):yF,areTypedArraysEqual:a?D_:Ute};if(i&&(h=xF({},h,i(h))),t){var v=r0(h.areArraysEqual),S=r0(h.areMapsEqual),o=r0(h.areObjectsEqual),I=r0(h.areSetsEqual);h=xF({},h,{areArraysEqual:v,areMapsEqual:S,areObjectsEqual:o,areSetsEqual:I})}return h}function nne(e){return function(t,i,a,h,v,S,o){return e(t,i,o)}}function rne(e){var t=e.circular,i=e.comparator,a=e.createState,h=e.equals,v=e.strict;if(a)return function(I,B){var $=a(),U=$.cache,K=U===void 0?t?new WeakMap:void 0:U,te=$.meta;return i(I,B,{cache:K,equals:h,meta:te,strict:v})};if(t)return function(I,B){return i(I,B,{cache:new WeakMap,equals:h,meta:void 0,strict:v})};var S={cache:void 0,equals:h,meta:void 0,strict:v};return function(I,B){return i(I,B,S)}}var ine=ep();ep({strict:!0});ep({circular:!0});ep({circular:!0,strict:!0});ep({createInternalComparator:function(){return Bg}});ep({strict:!0,createInternalComparator:function(){return Bg}});ep({circular:!0,createInternalComparator:function(){return Bg}});ep({circular:!0,createInternalComparator:function(){return Bg},strict:!0});function ep(e){e===void 0&&(e={});var t=e.circular,i=t===void 0?!1:t,a=e.createInternalComparator,h=e.createState,v=e.strict,S=v===void 0?!1:v,o=tne(e),I=ene(o),B=a?a(I):nne(I);return rne({circular:i,comparator:I,createState:h,equals:B,strict:S})}function one(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function bF(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=-1,a=function h(v){i<0&&(i=v),v-i>t?(e(v),i=-1):one(h)};requestAnimationFrame(a)}function MP(e){"@babel/helpers - typeof";return MP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MP(e)}function ane(e){return cne(e)||une(e)||lne(e)||sne()}function sne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lne(e,t){if(e){if(typeof e=="string")return wF(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return wF(e,t)}}function wF(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function une(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cne(e){if(Array.isArray(e))return e}function hne(){var e={},t=function(){return null},i=!1,a=function h(v){if(!i){if(Array.isArray(v)){if(!v.length)return;var S=v,o=ane(S),I=o[0],B=o.slice(1);if(typeof I=="number"){bF(h.bind(null,B),I);return}h(I),bF(h.bind(null,B));return}MP(v)==="object"&&(e=v,t(e)),typeof v=="function"&&v()}};return{stop:function(){i=!0},start:function(v){i=!1,a(v)},subscribe:function(v){return t=v,function(){t=function(){return null}}}}}function wy(e){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wy(e)}function SF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function TF(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?SF(Object(i),!0).forEach(function(a){i$(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):SF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function i$(e,t,i){return t=fne(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function fne(e){var t=dne(e,"string");return wy(t)==="symbol"?t:String(t)}function dne(e,t){if(wy(e)!=="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(wy(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pne=function(t,i){return[Object.keys(t),Object.keys(i)].reduce(function(a,h){return a.filter(function(v){return h.includes(v)})})},mne=function(t){return t},gne=function(t){return t.replace(/([A-Z])/g,function(i){return"-".concat(i.toLowerCase())})},Z_=function(t,i){return Object.keys(i).reduce(function(a,h){return TF(TF({},a),{},i$({},h,t(h,i[h])))},{})},EF=function(t,i,a){return t.map(function(h){return"".concat(gne(h)," ").concat(i,"ms ").concat(a)}).join(",")};function _ne(e,t){return xne(e)||vne(e,t)||o$(e,t)||yne()}function yne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vne(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function xne(e){if(Array.isArray(e))return e}function bne(e){return Tne(e)||Sne(e)||o$(e)||wne()}function wne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o$(e,t){if(e){if(typeof e=="string")return IP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return IP(e,t)}}function Sne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tne(e){if(Array.isArray(e))return IP(e)}function IP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var V0=1e-4,a$=function(t,i){return[0,3*t,3*i-6*t,3*t-3*i+1]},s$=function(t,i){return t.map(function(a,h){return a*Math.pow(i,h)}).reduce(function(a,h){return a+h})},AF=function(t,i){return function(a){var h=a$(t,i);return s$(h,a)}},Ene=function(t,i){return function(a){var h=a$(t,i),v=[].concat(bne(h.map(function(S,o){return S*o}).slice(1)),[0]);return s$(v,a)}},PF=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var h=i[0],v=i[1],S=i[2],o=i[3];if(i.length===1)switch(i[0]){case"linear":h=0,v=0,S=1,o=1;break;case"ease":h=.25,v=.1,S=.25,o=1;break;case"ease-in":h=.42,v=0,S=1,o=1;break;case"ease-out":h=.42,v=0,S=.58,o=1;break;case"ease-in-out":h=0,v=0,S=.58,o=1;break;default:{var I=i[0].split("(");if(I[0]==="cubic-bezier"&&I[1].split(")")[0].split(",").length===4){var B=I[1].split(")")[0].split(",").map(function(ue){return parseFloat(ue)}),$=_ne(B,4);h=$[0],v=$[1],S=$[2],o=$[3]}}}var U=AF(h,S),K=AF(v,o),te=Ene(h,S),le=function(be){return be>1?1:be<0?0:be},se=function(be){for(var Ce=be>1?1:be,Re=Ce,De=0;De<8;++De){var ve=U(Re)-Ce,Le=te(Re);if(Math.abs(ve-Ce)<V0||Le<V0)return K(Re);Re=le(Re-ve/Le)}return K(Re)};return se.isStepper=!1,se},Ane=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=t.stiff,a=i===void 0?100:i,h=t.damping,v=h===void 0?8:h,S=t.dt,o=S===void 0?17:S,I=function($,U,K){var te=-($-U)*a,le=K*v,se=K+(te-le)*o/1e3,ue=K*o/1e3+$;return Math.abs(ue-U)<V0&&Math.abs(se)<V0?[U,0]:[ue,se]};return I.isStepper=!0,I.dt=o,I},Pne=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var h=i[0];if(typeof h=="string")switch(h){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return PF(h);case"spring":return Ane();default:if(h.split("(")[0]==="cubic-bezier")return PF(h)}return typeof h=="function"?h:null};function Sy(e){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(e)}function MF(e){return Cne(e)||Ine(e)||l$(e)||Mne()}function Mne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ine(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cne(e){if(Array.isArray(e))return OP(e)}function IF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function _l(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?IF(Object(i),!0).forEach(function(a){CP(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):IF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function CP(e,t,i){return t=One(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function One(e){var t=kne(e,"string");return Sy(t)==="symbol"?t:String(t)}function kne(e,t){if(Sy(e)!=="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Sy(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rne(e,t){return zne(e)||Dne(e,t)||l$(e,t)||Lne()}function Lne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l$(e,t){if(e){if(typeof e=="string")return OP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return OP(e,t)}}function OP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function Dne(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function zne(e){if(Array.isArray(e))return e}var q0=function(t,i,a){return t+(i-t)*a},kP=function(t){var i=t.from,a=t.to;return i!==a},Fne=function e(t,i,a){var h=Z_(function(v,S){if(kP(S)){var o=t(S.from,S.to,S.velocity),I=Rne(o,2),B=I[0],$=I[1];return _l(_l({},S),{},{from:B,velocity:$})}return S},i);return a<1?Z_(function(v,S){return kP(S)?_l(_l({},S),{},{velocity:q0(S.velocity,h[v].velocity,a),from:q0(S.from,h[v].from,a)}):S},i):e(t,h,a-1)};const Bne=function(e,t,i,a,h){var v=pne(e,t),S=v.reduce(function(ue,be){return _l(_l({},ue),{},CP({},be,[e[be],t[be]]))},{}),o=v.reduce(function(ue,be){return _l(_l({},ue),{},CP({},be,{from:e[be],velocity:0,to:t[be]}))},{}),I=-1,B,$,U=function(){return null},K=function(){return Z_(function(be,Ce){return Ce.from},o)},te=function(){return!Object.values(o).filter(kP).length},le=function(be){B||(B=be);var Ce=be-B,Re=Ce/i.dt;o=Fne(i,o,Re),h(_l(_l(_l({},e),t),K())),B=be,te()||(I=requestAnimationFrame(U))},se=function(be){$||($=be);var Ce=(be-$)/a,Re=Z_(function(ve,Le){return q0.apply(void 0,MF(Le).concat([i(Ce)]))},S);if(h(_l(_l(_l({},e),t),Re)),Ce<1)I=requestAnimationFrame(U);else{var De=Z_(function(ve,Le){return q0.apply(void 0,MF(Le).concat([i(1)]))},S);h(_l(_l(_l({},e),t),De))}};return U=i.isStepper?le:se,function(){return requestAnimationFrame(U),function(){cancelAnimationFrame(I)}}};function cg(e){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(e)}var Nne=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function jne(e,t){if(e==null)return{};var i=$ne(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function $ne(e,t){if(e==null)return{};var i={},a=Object.keys(e),h,v;for(v=0;v<a.length;v++)h=a[v],!(t.indexOf(h)>=0)&&(i[h]=e[h]);return i}function oT(e){return Gne(e)||qne(e)||Vne(e)||Une()}function Une(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vne(e,t){if(e){if(typeof e=="string")return RP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return RP(e,t)}}function qne(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Gne(e){if(Array.isArray(e))return RP(e)}function RP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function CF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Ch(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?CF(Object(i),!0).forEach(function(a){j_(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):CF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function j_(e,t,i){return t=u$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Hne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wne(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,u$(a.key),a)}}function Zne(e,t,i){return t&&Wne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function u$(e){var t=Xne(e,"string");return cg(t)==="symbol"?t:String(t)}function Xne(e,t){if(cg(e)!=="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(cg(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LP(e,t)}function LP(e,t){return LP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},LP(e,t)}function Yne(e){var t=Jne();return function(){var a=G0(e),h;if(t){var v=G0(this).constructor;h=Reflect.construct(a,arguments,v)}else h=a.apply(this,arguments);return DP(this,h)}}function DP(e,t){if(t&&(cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zP(e)}function zP(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function G0(e){return G0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},G0(e)}var td=function(e){Kne(i,e);var t=Yne(i);function i(a,h){var v;Hne(this,i),v=t.call(this,a,h);var S=v.props,o=S.isActive,I=S.attributeName,B=S.from,$=S.to,U=S.steps,K=S.children,te=S.duration;if(v.handleStyleChange=v.handleStyleChange.bind(zP(v)),v.changeStyle=v.changeStyle.bind(zP(v)),!o||te<=0)return v.state={style:{}},typeof K=="function"&&(v.state={style:$}),DP(v);if(U&&U.length)v.state={style:U[0].style};else if(B){if(typeof K=="function")return v.state={style:B},DP(v);v.state={style:I?j_({},I,B):B}}else v.state={style:{}};return v}return Zne(i,[{key:"componentDidMount",value:function(){var h=this.props,v=h.isActive,S=h.canBegin;this.mounted=!0,!(!v||!S)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(h){var v=this.props,S=v.isActive,o=v.canBegin,I=v.attributeName,B=v.shouldReAnimate,$=v.to,U=v.from,K=this.state.style;if(o){if(!S){var te={style:I?j_({},I,$):$};this.state&&K&&(I&&K[I]!==$||!I&&K!==$)&&this.setState(te);return}if(!(ine(h.to,$)&&h.canBegin&&h.isActive)){var le=!h.canBegin||!h.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var se=le||B?U:h.to;if(this.state&&K){var ue={style:I?j_({},I,se):se};(I&&K[I]!==se||!I&&K!==se)&&this.setState(ue)}this.runAnimation(Ch(Ch({},this.props),{},{from:se,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var h=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),h&&h()}},{key:"handleStyleChange",value:function(h){this.changeStyle(h)}},{key:"changeStyle",value:function(h){this.mounted&&this.setState({style:h})}},{key:"runJSAnimation",value:function(h){var v=this,S=h.from,o=h.to,I=h.duration,B=h.easing,$=h.begin,U=h.onAnimationEnd,K=h.onAnimationStart,te=Bne(S,o,Pne(B),I,this.changeStyle),le=function(){v.stopJSAnimation=te()};this.manager.start([K,$,le,I,U])}},{key:"runStepAnimation",value:function(h){var v=this,S=h.steps,o=h.begin,I=h.onAnimationStart,B=S[0],$=B.style,U=B.duration,K=U===void 0?0:U,te=function(se,ue,be){if(be===0)return se;var Ce=ue.duration,Re=ue.easing,De=Re===void 0?"ease":Re,ve=ue.style,Le=ue.properties,Fe=ue.onAnimationEnd,lt=be>0?S[be-1]:ue,xt=Le||Object.keys(ve);if(typeof De=="function"||De==="spring")return[].concat(oT(se),[v.runJSAnimation.bind(v,{from:lt.style,to:ve,duration:Ce,easing:De}),Ce]);var gt=EF(xt,Ce,De),Je=Ch(Ch(Ch({},lt.style),ve),{},{transition:gt});return[].concat(oT(se),[Je,Ce,Fe]).filter(mne)};return this.manager.start([I].concat(oT(S.reduce(te,[$,Math.max(K,o)])),[h.onAnimationEnd]))}},{key:"runAnimation",value:function(h){this.manager||(this.manager=hne());var v=h.begin,S=h.duration,o=h.attributeName,I=h.to,B=h.easing,$=h.onAnimationStart,U=h.onAnimationEnd,K=h.steps,te=h.children,le=this.manager;if(this.unSubscribe=le.subscribe(this.handleStyleChange),typeof B=="function"||typeof te=="function"||B==="spring"){this.runJSAnimation(h);return}if(K.length>1){this.runStepAnimation(h);return}var se=o?j_({},o,I):I,ue=EF(Object.keys(se),S,B);le.start([$,v,Ch(Ch({},se),{},{transition:ue}),S,U])}},{key:"render",value:function(){var h=this.props,v=h.children;h.begin;var S=h.duration;h.attributeName,h.easing;var o=h.isActive;h.steps,h.from,h.to,h.canBegin,h.onAnimationEnd,h.shouldReAnimate,h.onAnimationReStart;var I=jne(h,Nne),B=rt.Children.count(v),$=this.state.style;if(typeof v=="function")return v($);if(!o||B===0||S<=0)return v;var U=function(te){var le=te.props,se=le.style,ue=se===void 0?{}:se,be=le.className,Ce=rt.cloneElement(te,Ch(Ch({},I),{},{style:Ch(Ch({},ue),$),className:be}));return Ce};return B===1?U(rt.Children.only(v)):Bt.createElement("div",null,rt.Children.map(v,function(K){return U(K)}))}}]),i}(rt.PureComponent);td.displayName="Animate";td.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};td.propTypes={from:Gi.oneOfType([Gi.object,Gi.string]),to:Gi.oneOfType([Gi.object,Gi.string]),attributeName:Gi.string,duration:Gi.number,begin:Gi.number,easing:Gi.oneOfType([Gi.string,Gi.func]),steps:Gi.arrayOf(Gi.shape({duration:Gi.number.isRequired,style:Gi.object.isRequired,easing:Gi.oneOfType([Gi.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Gi.func]),properties:Gi.arrayOf("string"),onAnimationEnd:Gi.func})),children:Gi.oneOfType([Gi.node,Gi.func]),isActive:Gi.bool,canBegin:Gi.bool,onAnimationEnd:Gi.func,shouldReAnimate:Gi.bool,onAnimationStart:Gi.func,onAnimationReStart:Gi.func};Gi.object,Gi.object,Gi.object,Gi.element;Gi.object,Gi.object,Gi.object,Gi.oneOfType([Gi.array,Gi.element]),Gi.any;function Ty(e){"@babel/helpers - typeof";return Ty=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ty(e)}function H0(){return H0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},H0.apply(this,arguments)}function Qne(e,t){return rre(e)||nre(e,t)||tre(e,t)||ere()}function ere(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tre(e,t){if(e){if(typeof e=="string")return OF(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return OF(e,t)}}function OF(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function nre(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function rre(e){if(Array.isArray(e))return e}function kF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function RF(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?kF(Object(i),!0).forEach(function(a){ire(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):kF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function ire(e,t,i){return t=ore(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ore(e){var t=are(e,"string");return Ty(t)=="symbol"?t:t+""}function are(e,t){if(Ty(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Ty(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LF=function(t,i,a,h,v){var S=Math.min(Math.abs(a)/2,Math.abs(h)/2),o=h>=0?1:-1,I=a>=0?1:-1,B=h>=0&&a>=0||h<0&&a<0?1:0,$;if(S>0&&v instanceof Array){for(var U=[0,0,0,0],K=0,te=4;K<te;K++)U[K]=v[K]>S?S:v[K];$="M".concat(t,",").concat(i+o*U[0]),U[0]>0&&($+="A ".concat(U[0],",").concat(U[0],",0,0,").concat(B,",").concat(t+I*U[0],",").concat(i)),$+="L ".concat(t+a-I*U[1],",").concat(i),U[1]>0&&($+="A ".concat(U[1],",").concat(U[1],",0,0,").concat(B,`,
        `).concat(t+a,",").concat(i+o*U[1])),$+="L ".concat(t+a,",").concat(i+h-o*U[2]),U[2]>0&&($+="A ".concat(U[2],",").concat(U[2],",0,0,").concat(B,`,
        `).concat(t+a-I*U[2],",").concat(i+h)),$+="L ".concat(t+I*U[3],",").concat(i+h),U[3]>0&&($+="A ".concat(U[3],",").concat(U[3],",0,0,").concat(B,`,
        `).concat(t,",").concat(i+h-o*U[3])),$+="Z"}else if(S>0&&v===+v&&v>0){var le=Math.min(S,v);$="M ".concat(t,",").concat(i+o*le,`
            A `).concat(le,",").concat(le,",0,0,").concat(B,",").concat(t+I*le,",").concat(i,`
            L `).concat(t+a-I*le,",").concat(i,`
            A `).concat(le,",").concat(le,",0,0,").concat(B,",").concat(t+a,",").concat(i+o*le,`
            L `).concat(t+a,",").concat(i+h-o*le,`
            A `).concat(le,",").concat(le,",0,0,").concat(B,",").concat(t+a-I*le,",").concat(i+h,`
            L `).concat(t+I*le,",").concat(i+h,`
            A `).concat(le,",").concat(le,",0,0,").concat(B,",").concat(t,",").concat(i+h-o*le," Z")}else $="M ".concat(t,",").concat(i," h ").concat(a," v ").concat(h," h ").concat(-a," Z");return $},sre=function(t,i){if(!t||!i)return!1;var a=t.x,h=t.y,v=i.x,S=i.y,o=i.width,I=i.height;if(Math.abs(o)>0&&Math.abs(I)>0){var B=Math.min(v,v+o),$=Math.max(v,v+o),U=Math.min(S,S+I),K=Math.max(S,S+I);return a>=B&&a<=$&&h>=U&&h<=K}return!1},lre={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_I=function(t){var i=RF(RF({},lre),t),a=rt.useRef(),h=rt.useState(-1),v=Qne(h,2),S=v[0],o=v[1];rt.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var De=a.current.getTotalLength();De&&o(De)}catch{}},[]);var I=i.x,B=i.y,$=i.width,U=i.height,K=i.radius,te=i.className,le=i.animationEasing,se=i.animationDuration,ue=i.animationBegin,be=i.isAnimationActive,Ce=i.isUpdateAnimationActive;if(I!==+I||B!==+B||$!==+$||U!==+U||$===0||U===0)return null;var Re=to("recharts-rectangle",te);return Ce?Bt.createElement(td,{canBegin:S>0,from:{width:$,height:U,x:I,y:B},to:{width:$,height:U,x:I,y:B},duration:se,animationEasing:le,isActive:Ce},function(De){var ve=De.width,Le=De.height,Fe=De.x,lt=De.y;return Bt.createElement(td,{canBegin:S>0,from:"0px ".concat(S===-1?1:S,"px"),to:"".concat(S,"px 0px"),attributeName:"strokeDasharray",begin:ue,duration:se,isActive:be,easing:le},Bt.createElement("path",H0({},ki(i,!0),{className:Re,d:LF(Fe,lt,ve,Le,K),ref:a})))}):Bt.createElement("path",H0({},ki(i,!0),{className:Re,d:LF(I,B,$,U,K)}))},ure=["points","className","baseLinePoints","connectNulls"];function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Gm.apply(this,arguments)}function cre(e,t){if(e==null)return{};var i=hre(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function hre(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function DF(e){return mre(e)||pre(e)||dre(e)||fre()}function fre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dre(e,t){if(e){if(typeof e=="string")return FP(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return FP(e,t)}}function pre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mre(e){if(Array.isArray(e))return FP(e)}function FP(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var zF=function(t){return t&&t.x===+t.x&&t.y===+t.y},gre=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=[[]];return t.forEach(function(a){zF(a)?i[i.length-1].push(a):i[i.length-1].length>0&&i.push([])}),zF(t[0])&&i[i.length-1].push(t[0]),i[i.length-1].length<=0&&(i=i.slice(0,-1)),i},X_=function(t,i){var a=gre(t);i&&(a=[a.reduce(function(v,S){return[].concat(DF(v),DF(S))},[])]);var h=a.map(function(v){return v.reduce(function(S,o,I){return"".concat(S).concat(I===0?"M":"L").concat(o.x,",").concat(o.y)},"")}).join("");return a.length===1?"".concat(h,"Z"):h},_re=function(t,i,a){var h=X_(t,a);return"".concat(h.slice(-1)==="Z"?h.slice(0,-1):h,"L").concat(X_(i.reverse(),a).slice(1))},yre=function(t){var i=t.points,a=t.className,h=t.baseLinePoints,v=t.connectNulls,S=cre(t,ure);if(!i||!i.length)return null;var o=to("recharts-polygon",a);if(h&&h.length){var I=S.stroke&&S.stroke!=="none",B=_re(i,h,v);return Bt.createElement("g",{className:o},Bt.createElement("path",Gm({},ki(S,!0),{fill:B.slice(-1)==="Z"?S.fill:"none",stroke:"none",d:B})),I?Bt.createElement("path",Gm({},ki(S,!0),{fill:"none",d:X_(i,v)})):null,I?Bt.createElement("path",Gm({},ki(S,!0),{fill:"none",d:X_(h,v)})):null)}var $=X_(i,v);return Bt.createElement("path",Gm({},ki(S,!0),{fill:$.slice(-1)==="Z"?S.fill:"none",className:o,d:$}))};function BP(){return BP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},BP.apply(this,arguments)}var yI=function(t){var i=t.cx,a=t.cy,h=t.r,v=t.className,S=to("recharts-dot",v);return i===+i&&a===+a&&h===+h?Bt.createElement("circle",BP({},ki(t,!1),g0(t),{className:S,cx:i,cy:a,r:h})):null};function Ey(e){"@babel/helpers - typeof";return Ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(e)}var vre=["x","y","top","left","width","height","className"];function NP(){return NP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},NP.apply(this,arguments)}function FF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function xre(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?FF(Object(i),!0).forEach(function(a){bre(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):FF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function bre(e,t,i){return t=wre(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function wre(e){var t=Sre(e,"string");return Ey(t)=="symbol"?t:t+""}function Sre(e,t){if(Ey(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Ey(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tre(e,t){if(e==null)return{};var i=Ere(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Ere(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}var Are=function(t,i,a,h,v,S){return"M".concat(t,",").concat(v,"v").concat(h,"M").concat(S,",").concat(i,"h").concat(a)},Pre=function(t){var i=t.x,a=i===void 0?0:i,h=t.y,v=h===void 0?0:h,S=t.top,o=S===void 0?0:S,I=t.left,B=I===void 0?0:I,$=t.width,U=$===void 0?0:$,K=t.height,te=K===void 0?0:K,le=t.className,se=Tre(t,vre),ue=xre({x:a,y:v,top:o,left:B,width:U,height:te},se);return!gr(a)||!gr(v)||!gr(U)||!gr(te)||!gr(o)||!gr(B)?null:Bt.createElement("path",NP({},ki(ue,!0),{className:to("recharts-cross",le),d:Are(a,v,U,te,o,B)}))},aT,BF;function Mre(){if(BF)return aT;BF=1;var e=$x(),t=T6(),i=xl();function a(h,v){return h&&h.length?e(h,i(v,2),t):void 0}return aT=a,aT}var Ire=Mre();const Cre=zo(Ire);var sT,NF;function Ore(){if(NF)return sT;NF=1;var e=$x(),t=xl(),i=E6();function a(h,v){return h&&h.length?e(h,t(v,2),i):void 0}return sT=a,sT}var kre=Ore();const Rre=zo(kre);var Lre=["cx","cy","angle","ticks","axisLine"],Dre=["ticks","tick","angle","tickFormatter","stroke"];function hg(e){"@babel/helpers - typeof";return hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hg(e)}function K_(){return K_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},K_.apply(this,arguments)}function jF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Cp(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?jF(Object(i),!0).forEach(function(a){Zx(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):jF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function $F(e,t){if(e==null)return{};var i=zre(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function zre(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function Fre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UF(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,h$(a.key),a)}}function Bre(e,t,i){return t&&UF(e.prototype,t),i&&UF(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nre(e,t,i){return t=W0(t),jre(e,c$()?Reflect.construct(t,i||[],W0(e).constructor):t.apply(e,i))}function jre(e,t){if(t&&(hg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $re(e)}function $re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(c$=function(){return!!e})()}function W0(e){return W0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},W0(e)}function Ure(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jP(e,t)}function jP(e,t){return jP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},jP(e,t)}function Zx(e,t,i){return t=h$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h$(e){var t=Vre(e,"string");return hg(t)=="symbol"?t:t+""}function Vre(e,t){if(hg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(hg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xx=function(e){function t(){return Fre(this,t),Nre(this,t,arguments)}return Ure(t,e),Bre(t,[{key:"getTickValueCoord",value:function(a){var h=a.coordinate,v=this.props,S=v.angle,o=v.cx,I=v.cy;return Ma(o,I,h,S)}},{key:"getTickTextAnchor",value:function(){var a=this.props.orientation,h;switch(a){case"left":h="end";break;case"right":h="start";break;default:h="middle";break}return h}},{key:"getViewBox",value:function(){var a=this.props,h=a.cx,v=a.cy,S=a.angle,o=a.ticks,I=Cre(o,function($){return $.coordinate||0}),B=Rre(o,function($){return $.coordinate||0});return{cx:h,cy:v,startAngle:S,endAngle:S,innerRadius:B.coordinate||0,outerRadius:I.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,h=a.cx,v=a.cy,S=a.angle,o=a.ticks,I=a.axisLine,B=$F(a,Lre),$=o.reduce(function(le,se){return[Math.min(le[0],se.coordinate),Math.max(le[1],se.coordinate)]},[1/0,-1/0]),U=Ma(h,v,$[0],S),K=Ma(h,v,$[1],S),te=Cp(Cp(Cp({},ki(B,!1)),{},{fill:"none"},ki(I,!1)),{},{x1:U.x,y1:U.y,x2:K.x,y2:K.y});return Bt.createElement("line",K_({className:"recharts-polar-radius-axis-line"},te))}},{key:"renderTicks",value:function(){var a=this,h=this.props,v=h.ticks,S=h.tick,o=h.angle,I=h.tickFormatter,B=h.stroke,$=$F(h,Dre),U=this.getTickTextAnchor(),K=ki($,!1),te=ki(S,!1),le=v.map(function(se,ue){var be=a.getTickValueCoord(se),Ce=Cp(Cp(Cp(Cp({textAnchor:U,transform:"rotate(".concat(90-o,", ").concat(be.x,", ").concat(be.y,")")},K),{},{stroke:"none",fill:B},te),{},{index:ue},be),{},{payload:se});return Bt.createElement(Qo,K_({className:to("recharts-polar-radius-axis-tick",J6(S)),key:"tick-".concat(se.coordinate)},Yp(a.props,se,ue)),t.renderTickItem(S,Ce,I?I(se.value,ue):se.value))});return Bt.createElement(Qo,{className:"recharts-polar-radius-axis-ticks"},le)}},{key:"render",value:function(){var a=this.props,h=a.ticks,v=a.axisLine,S=a.tick;return!h||!h.length?null:Bt.createElement(Qo,{className:to("recharts-polar-radius-axis",this.props.className)},v&&this.renderAxisLine(),S&&this.renderTicks(),ul.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(a,h,v){var S;return Bt.isValidElement(a)?S=Bt.cloneElement(a,h):Hi(a)?S=a(h):S=Bt.createElement(Jp,K_({},h,{className:"recharts-polar-radius-axis-tick-value"}),v),S}}])}(rt.PureComponent);Zx(Xx,"displayName","PolarRadiusAxis");Zx(Xx,"axisType","radiusAxis");Zx(Xx,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function fg(e){"@babel/helpers - typeof";return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fg(e)}function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Lp.apply(this,arguments)}function VF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Op(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?VF(Object(i),!0).forEach(function(a){Kx(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):VF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function qre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qF(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,d$(a.key),a)}}function Gre(e,t,i){return t&&qF(e.prototype,t),i&&qF(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hre(e,t,i){return t=Z0(t),Wre(e,f$()?Reflect.construct(t,i||[],Z0(e).constructor):t.apply(e,i))}function Wre(e,t){if(t&&(fg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zre(e)}function Zre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f$=function(){return!!e})()}function Z0(e){return Z0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Z0(e)}function Xre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$P(e,t)}function $P(e,t){return $P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},$P(e,t)}function Kx(e,t,i){return t=d$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d$(e){var t=Kre(e,"string");return fg(t)=="symbol"?t:t+""}function Kre(e,t){if(fg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(fg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yre=Math.PI/180,GF=1e-5,Yx=function(e){function t(){return qre(this,t),Hre(this,t,arguments)}return Xre(t,e),Gre(t,[{key:"getTickLineCoord",value:function(a){var h=this.props,v=h.cx,S=h.cy,o=h.radius,I=h.orientation,B=h.tickSize,$=B||8,U=Ma(v,S,o,a.coordinate),K=Ma(v,S,o+(I==="inner"?-1:1)*$,a.coordinate);return{x1:U.x,y1:U.y,x2:K.x,y2:K.y}}},{key:"getTickTextAnchor",value:function(a){var h=this.props.orientation,v=Math.cos(-a.coordinate*Yre),S;return v>GF?S=h==="outer"?"start":"end":v<-GF?S=h==="outer"?"end":"start":S="middle",S}},{key:"renderAxisLine",value:function(){var a=this.props,h=a.cx,v=a.cy,S=a.radius,o=a.axisLine,I=a.axisLineType,B=Op(Op({},ki(this.props,!1)),{},{fill:"none"},ki(o,!1));if(I==="circle")return Bt.createElement(yI,Lp({className:"recharts-polar-angle-axis-line"},B,{cx:h,cy:v,r:S}));var $=this.props.ticks,U=$.map(function(K){return Ma(h,v,S,K.coordinate)});return Bt.createElement(yre,Lp({className:"recharts-polar-angle-axis-line"},B,{points:U}))}},{key:"renderTicks",value:function(){var a=this,h=this.props,v=h.ticks,S=h.tick,o=h.tickLine,I=h.tickFormatter,B=h.stroke,$=ki(this.props,!1),U=ki(S,!1),K=Op(Op({},$),{},{fill:"none"},ki(o,!1)),te=v.map(function(le,se){var ue=a.getTickLineCoord(le),be=a.getTickTextAnchor(le),Ce=Op(Op(Op({textAnchor:be},$),{},{stroke:"none",fill:B},U),{},{index:se,payload:le,x:ue.x2,y:ue.y2});return Bt.createElement(Qo,Lp({className:to("recharts-polar-angle-axis-tick",J6(S)),key:"tick-".concat(le.coordinate)},Yp(a.props,le,se)),o&&Bt.createElement("line",Lp({className:"recharts-polar-angle-axis-tick-line"},K,ue)),S&&t.renderTickItem(S,Ce,I?I(le.value,se):le.value))});return Bt.createElement(Qo,{className:"recharts-polar-angle-axis-ticks"},te)}},{key:"render",value:function(){var a=this.props,h=a.ticks,v=a.radius,S=a.axisLine;return v<=0||!h||!h.length?null:Bt.createElement(Qo,{className:to("recharts-polar-angle-axis",this.props.className)},S&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(a,h,v){var S;return Bt.isValidElement(a)?S=Bt.cloneElement(a,h):Hi(a)?S=a(h):S=Bt.createElement(Jp,Lp({},h,{className:"recharts-polar-angle-axis-tick-value"}),v),S}}])}(rt.PureComponent);Kx(Yx,"displayName","PolarAngleAxis");Kx(Yx,"axisType","angleAxis");Kx(Yx,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var lT,HF;function Jx(){if(HF)return lT;HF=1;var e=vj(),t=e(Object.getPrototypeOf,Object);return lT=t,lT}var uT,WF;function vI(){if(WF)return uT;WF=1;var e=rd(),t=Jx(),i=Yc(),a="[object Object]",h=Function.prototype,v=Object.prototype,S=h.toString,o=v.hasOwnProperty,I=S.call(Object);function B($){if(!i($)||e($)!=a)return!1;var U=t($);if(U===null)return!0;var K=o.call(U,"constructor")&&U.constructor;return typeof K=="function"&&K instanceof K&&S.call(K)==I}return uT=B,uT}var Jre=vI();const Qre=zo(Jre);var cT,ZF;function eie(){if(ZF)return cT;ZF=1;var e=rd(),t=Yc(),i="[object Boolean]";function a(h){return h===!0||h===!1||t(h)&&e(h)==i}return cT=a,cT}var tie=eie();const nie=zo(tie);function Ay(e){"@babel/helpers - typeof";return Ay=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(e)}function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},X0.apply(this,arguments)}function rie(e,t){return sie(e)||aie(e,t)||oie(e,t)||iie()}function iie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oie(e,t){if(e){if(typeof e=="string")return XF(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return XF(e,t)}}function XF(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function aie(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function sie(e){if(Array.isArray(e))return e}function KF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function YF(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?KF(Object(i),!0).forEach(function(a){lie(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):KF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function lie(e,t,i){return t=uie(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function uie(e){var t=cie(e,"string");return Ay(t)=="symbol"?t:t+""}function cie(e,t){if(Ay(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Ay(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JF=function(t,i,a,h,v){var S=a-h,o;return o="M ".concat(t,",").concat(i),o+="L ".concat(t+a,",").concat(i),o+="L ".concat(t+a-S/2,",").concat(i+v),o+="L ".concat(t+a-S/2-h,",").concat(i+v),o+="L ".concat(t,",").concat(i," Z"),o},hie={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},fie=function(t){var i=YF(YF({},hie),t),a=rt.useRef(),h=rt.useState(-1),v=rie(h,2),S=v[0],o=v[1];rt.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var Re=a.current.getTotalLength();Re&&o(Re)}catch{}},[]);var I=i.x,B=i.y,$=i.upperWidth,U=i.lowerWidth,K=i.height,te=i.className,le=i.animationEasing,se=i.animationDuration,ue=i.animationBegin,be=i.isUpdateAnimationActive;if(I!==+I||B!==+B||$!==+$||U!==+U||K!==+K||$===0&&U===0||K===0)return null;var Ce=to("recharts-trapezoid",te);return be?Bt.createElement(td,{canBegin:S>0,from:{upperWidth:0,lowerWidth:0,height:K,x:I,y:B},to:{upperWidth:$,lowerWidth:U,height:K,x:I,y:B},duration:se,animationEasing:le,isActive:be},function(Re){var De=Re.upperWidth,ve=Re.lowerWidth,Le=Re.height,Fe=Re.x,lt=Re.y;return Bt.createElement(td,{canBegin:S>0,from:"0px ".concat(S===-1?1:S,"px"),to:"".concat(S,"px 0px"),attributeName:"strokeDasharray",begin:ue,duration:se,easing:le},Bt.createElement("path",X0({},ki(i,!0),{className:Ce,d:JF(Fe,lt,De,ve,Le),ref:a})))}):Bt.createElement("g",null,Bt.createElement("path",X0({},ki(i,!0),{className:Ce,d:JF(I,B,$,U,K)})))},die=["option","shapeType","propTransformer","activeClassName","isActive"];function Py(e){"@babel/helpers - typeof";return Py=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Py(e)}function pie(e,t){if(e==null)return{};var i=mie(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function mie(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function QF(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function K0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?QF(Object(i),!0).forEach(function(a){gie(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):QF(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function gie(e,t,i){return t=_ie(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _ie(e){var t=yie(e,"string");return Py(t)=="symbol"?t:t+""}function yie(e,t){if(Py(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Py(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vie(e,t){return K0(K0({},t),e)}function xie(e,t){return e==="symbols"}function eB(e){var t=e.shapeType,i=e.elementProps;switch(t){case"rectangle":return Bt.createElement(_I,i);case"trapezoid":return Bt.createElement(fie,i);case"sector":return Bt.createElement(t$,i);case"symbols":if(xie(t))return Bt.createElement(CM,i);break;default:return null}}function bie(e){return rt.isValidElement(e)?e.props:e}function p$(e){var t=e.option,i=e.shapeType,a=e.propTransformer,h=a===void 0?vie:a,v=e.activeClassName,S=v===void 0?"recharts-active-shape":v,o=e.isActive,I=pie(e,die),B;if(rt.isValidElement(t))B=rt.cloneElement(t,K0(K0({},I),bie(t)));else if(Hi(t))B=t(I);else if(Qre(t)&&!nie(t)){var $=h(t,I);B=Bt.createElement(eB,{shapeType:i,elementProps:$})}else{var U=I;B=Bt.createElement(eB,{shapeType:i,elementProps:U})}return o?Bt.createElement(Qo,{className:S},B):B}function Qx(e,t){return t!=null&&"trapezoids"in e.props}function e1(e,t){return t!=null&&"sectors"in e.props}function My(e,t){return t!=null&&"points"in e.props}function wie(e,t){var i,a,h=e.x===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.x)||e.x===t.x,v=e.y===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.y)||e.y===t.y;return h&&v}function Sie(e,t){var i=e.endAngle===t.endAngle,a=e.startAngle===t.startAngle;return i&&a}function Tie(e,t){var i=e.x===t.x,a=e.y===t.y,h=e.z===t.z;return i&&a&&h}function Eie(e,t){var i;return Qx(e,t)?i=wie:e1(e,t)?i=Sie:My(e,t)&&(i=Tie),i}function Aie(e,t){var i;return Qx(e,t)?i="trapezoids":e1(e,t)?i="sectors":My(e,t)&&(i="points"),i}function Pie(e,t){if(Qx(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}if(e1(e,t)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}return My(e,t)?t.payload:{}}function Mie(e){var t=e.activeTooltipItem,i=e.graphicalItem,a=e.itemData,h=Aie(i,t),v=Pie(i,t),S=a.filter(function(I,B){var $=qx(v,I),U=i.props[h].filter(function(le){var se=Eie(i,t);return se(le,t)}),K=i.props[h].indexOf(U[U.length-1]),te=B===K;return $&&te}),o=a.indexOf(S[S.length-1]);return o}var u0;function dg(e){"@babel/helpers - typeof";return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dg(e)}function Hm(){return Hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Hm.apply(this,arguments)}function tB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Aa(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?tB(Object(i),!0).forEach(function(a){Vc(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Iie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nB(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,g$(a.key),a)}}function Cie(e,t,i){return t&&nB(e.prototype,t),i&&nB(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oie(e,t,i){return t=Y0(t),kie(e,m$()?Reflect.construct(t,i||[],Y0(e).constructor):t.apply(e,i))}function kie(e,t){if(t&&(dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rie(e)}function Rie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m$=function(){return!!e})()}function Y0(e){return Y0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Y0(e)}function Lie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UP(e,t)}function UP(e,t){return UP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},UP(e,t)}function Vc(e,t,i){return t=g$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g$(e){var t=Die(e,"string");return dg(t)=="symbol"?t:t+""}function Die(e,t){if(dg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(dg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var od=function(e){function t(i){var a;return Iie(this,t),a=Oie(this,t,[i]),Vc(a,"pieRef",null),Vc(a,"sectorRefs",[]),Vc(a,"id",qy("recharts-pie-")),Vc(a,"handleAnimationEnd",function(){var h=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),Hi(h)&&h()}),Vc(a,"handleAnimationStart",function(){var h=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),Hi(h)&&h()}),a.state={isAnimationFinished:!i.isAnimationActive,prevIsAnimationActive:i.isAnimationActive,prevAnimationId:i.animationId,sectorToFocus:0},a}return Lie(t,e),Cie(t,[{key:"isActiveIndex",value:function(a){var h=this.props.activeIndex;return Array.isArray(h)?h.indexOf(a)!==-1:a===h}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?a.length!==0:a||a===0}},{key:"renderLabels",value:function(a){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var v=this.props,S=v.label,o=v.labelLine,I=v.dataKey,B=v.valueKey,$=ki(this.props,!1),U=ki(S,!1),K=ki(o,!1),te=S&&S.offsetRadius||20,le=a.map(function(se,ue){var be=(se.startAngle+se.endAngle)/2,Ce=Ma(se.cx,se.cy,se.outerRadius+te,be),Re=Aa(Aa(Aa(Aa({},$),se),{},{stroke:"none"},U),{},{index:ue,textAnchor:t.getTextAnchor(Ce.x,se.cx)},Ce),De=Aa(Aa(Aa(Aa({},$),se),{},{fill:"none",stroke:se.fill},K),{},{index:ue,points:[Ma(se.cx,se.cy,se.outerRadius,be),Ce]}),ve=I;return ao(I)&&ao(B)?ve="value":ao(I)&&(ve=B),Bt.createElement(Qo,{key:"label-".concat(se.startAngle,"-").concat(se.endAngle,"-").concat(se.midAngle,"-").concat(ue)},o&&t.renderLabelLineItem(o,De,"line"),t.renderLabelItem(S,Re,Nl(se,ve)))});return Bt.createElement(Qo,{className:"recharts-pie-labels"},le)}},{key:"renderSectorsStatically",value:function(a){var h=this,v=this.props,S=v.activeShape,o=v.blendStroke,I=v.inactiveShape;return a.map(function(B,$){if((B==null?void 0:B.startAngle)===0&&(B==null?void 0:B.endAngle)===0&&a.length!==1)return null;var U=h.isActiveIndex($),K=I&&h.hasActiveIndex()?I:null,te=U?S:K,le=Aa(Aa({},B),{},{stroke:o?B.fill:B.stroke,tabIndex:-1});return Bt.createElement(Qo,Hm({ref:function(ue){ue&&!h.sectorRefs.includes(ue)&&h.sectorRefs.push(ue)},tabIndex:-1,className:"recharts-pie-sector"},Yp(h.props,B,$),{key:"sector-".concat(B==null?void 0:B.startAngle,"-").concat(B==null?void 0:B.endAngle,"-").concat(B.midAngle,"-").concat($)}),Bt.createElement(p$,Hm({option:te,isActive:U,shapeType:"sector"},le)))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,h=this.props,v=h.sectors,S=h.isAnimationActive,o=h.animationBegin,I=h.animationDuration,B=h.animationEasing,$=h.animationId,U=this.state,K=U.prevSectors,te=U.prevIsAnimationActive;return Bt.createElement(td,{begin:o,duration:I,isActive:S,easing:B,from:{t:0},to:{t:1},key:"pie-".concat($,"-").concat(te),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(le){var se=le.t,ue=[],be=v&&v[0],Ce=be.startAngle;return v.forEach(function(Re,De){var ve=K&&K[De],Le=De>0?ic(Re,"paddingAngle",0):0;if(ve){var Fe=$d(ve.endAngle-ve.startAngle,Re.endAngle-Re.startAngle),lt=Aa(Aa({},Re),{},{startAngle:Ce+Le,endAngle:Ce+Fe(se)+Le});ue.push(lt),Ce=lt.endAngle}else{var xt=Re.endAngle,gt=Re.startAngle,Je=$d(0,xt-gt),St=Je(se),Nt=Aa(Aa({},Re),{},{startAngle:Ce+Le,endAngle:Ce+St+Le});ue.push(Nt),Ce=Nt.endAngle}}),Bt.createElement(Qo,null,a.renderSectorsStatically(ue))})}},{key:"attachKeyboardHandlers",value:function(a){var h=this;a.onkeydown=function(v){if(!v.altKey)switch(v.key){case"ArrowLeft":{var S=++h.state.sectorToFocus%h.sectorRefs.length;h.sectorRefs[S].focus(),h.setState({sectorToFocus:S});break}case"ArrowRight":{var o=--h.state.sectorToFocus<0?h.sectorRefs.length-1:h.state.sectorToFocus%h.sectorRefs.length;h.sectorRefs[o].focus(),h.setState({sectorToFocus:o});break}case"Escape":{h.sectorRefs[h.state.sectorToFocus].blur(),h.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var a=this.props,h=a.sectors,v=a.isAnimationActive,S=this.state.prevSectors;return v&&h&&h.length&&(!S||!qx(S,h))?this.renderSectorsWithAnimation():this.renderSectorsStatically(h)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,h=this.props,v=h.hide,S=h.sectors,o=h.className,I=h.label,B=h.cx,$=h.cy,U=h.innerRadius,K=h.outerRadius,te=h.isAnimationActive,le=this.state.isAnimationFinished;if(v||!S||!S.length||!gr(B)||!gr($)||!gr(U)||!gr(K))return null;var se=to("recharts-pie",o);return Bt.createElement(Qo,{tabIndex:this.props.rootTabIndex,className:se,ref:function(be){a.pieRef=be}},this.renderSectors(),I&&this.renderLabels(S),ul.renderCallByParent(this.props,null,!1),(!te||le)&&Gd.renderCallByParent(this.props,S,!1))}}],[{key:"getDerivedStateFromProps",value:function(a,h){return h.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==h.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:h.curSectors,isAnimationFinished:!0}:a.sectors!==h.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,h){return a>h?"start":a<h?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,h,v){if(Bt.isValidElement(a))return Bt.cloneElement(a,h);if(Hi(a))return a(h);var S=to("recharts-pie-label-line",typeof a!="boolean"?a.className:"");return Bt.createElement(PP,Hm({},h,{key:v,type:"linear",className:S}))}},{key:"renderLabelItem",value:function(a,h,v){if(Bt.isValidElement(a))return Bt.cloneElement(a,h);var S=v;if(Hi(a)&&(S=a(h),Bt.isValidElement(S)))return S;var o=to("recharts-pie-label-text",typeof a!="boolean"&&!Hi(a)?a.className:"");return Bt.createElement(Jp,Hm({},h,{alignmentBaseline:"middle",className:o}),S)}}])}(rt.PureComponent);u0=od;Vc(od,"displayName","Pie");Vc(od,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Kf.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Vc(od,"parseDeltaAngle",function(e,t){var i=ou(t-e),a=Math.min(Math.abs(t-e),360);return i*a});Vc(od,"getRealPieData",function(e){var t=e.data,i=e.children,a=ki(e,!1),h=Hc(i,Lx);return t&&t.length?t.map(function(v,S){return Aa(Aa(Aa({payload:v},a),v),h&&h[S]&&h[S].props)}):h&&h.length?h.map(function(v){return Aa(Aa({},a),v.props)}):[]});Vc(od,"parseCoordinateOfPie",function(e,t){var i=t.top,a=t.left,h=t.width,v=t.height,S=Y6(h,v),o=a+au(e.cx,h,h/2),I=i+au(e.cy,v,v/2),B=au(e.innerRadius,S,0),$=au(e.outerRadius,S,S*.8),U=e.maxRadius||Math.sqrt(h*h+v*v)/2;return{cx:o,cy:I,innerRadius:B,outerRadius:$,maxRadius:U}});Vc(od,"getComposedData",function(e){var t=e.item,i=e.offset,a=t.type.defaultProps!==void 0?Aa(Aa({},t.type.defaultProps),t.props):t.props,h=u0.getRealPieData(a);if(!h||!h.length)return null;var v=a.cornerRadius,S=a.startAngle,o=a.endAngle,I=a.paddingAngle,B=a.dataKey,$=a.nameKey,U=a.valueKey,K=a.tooltipType,te=Math.abs(a.minAngle),le=u0.parseCoordinateOfPie(a,i),se=u0.parseDeltaAngle(S,o),ue=Math.abs(se),be=B;ao(B)&&ao(U)?(Xf(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),be="value"):ao(B)&&(Xf(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),be=U);var Ce=h.filter(function(lt){return Nl(lt,be,0)!==0}).length,Re=(ue>=360?Ce:Ce-1)*I,De=ue-Ce*te-Re,ve=h.reduce(function(lt,xt){var gt=Nl(xt,be,0);return lt+(gr(gt)?gt:0)},0),Le;if(ve>0){var Fe;Le=h.map(function(lt,xt){var gt=Nl(lt,be,0),Je=Nl(lt,$,xt),St=(gr(gt)?gt:0)/ve,Nt;xt?Nt=Fe.endAngle+ou(se)*I*(gt!==0?1:0):Nt=S;var Ht=Nt+ou(se)*((gt!==0?te:0)+St*De),Ct=(Nt+Ht)/2,Kt=(le.innerRadius+le.outerRadius)/2,Lt=[{name:Je,value:gt,payload:lt,dataKey:be,type:K}],et=Ma(le.cx,le.cy,Kt,Ct);return Fe=Aa(Aa(Aa({percent:St,cornerRadius:v,name:Je,tooltipPayload:Lt,midAngle:Ct,middleRadius:Kt,tooltipPosition:et},lt),le),{},{value:Nl(lt,be),startAngle:Nt,endAngle:Ht,payload:lt,paddingAngle:ou(se)*I}),Fe})}return Aa(Aa({},le),{},{sectors:Le,data:h})});var hT,rB;function zie(){if(rB)return hT;rB=1;var e=Math.ceil,t=Math.max;function i(a,h,v,S){for(var o=-1,I=t(e((h-a)/(v||1)),0),B=Array(I);I--;)B[S?I:++o]=a,a+=v;return B}return hT=i,hT}var fT,iB;function _$(){if(iB)return fT;iB=1;var e=Nj(),t=1/0,i=17976931348623157e292;function a(h){if(!h)return h===0?h:0;if(h=e(h),h===t||h===-t){var v=h<0?-1:1;return v*i}return h===h?h:0}return fT=a,fT}var dT,oB;function Fie(){if(oB)return dT;oB=1;var e=zie(),t=Lg(),i=_$();function a(h){return function(v,S,o){return o&&typeof o!="number"&&t(v,S,o)&&(S=o=void 0),v=i(v),S===void 0?(S=v,v=0):S=i(S),o=o===void 0?v<S?1:-1:i(o),e(v,S,o,h)}}return dT=a,dT}var pT,aB;function Bie(){if(aB)return pT;aB=1;var e=Fie(),t=e();return pT=t,pT}var Nie=Bie();const J0=zo(Nie);function Iy(e){"@babel/helpers - typeof";return Iy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iy(e)}function sB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function lB(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?sB(Object(i),!0).forEach(function(a){y$(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):sB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function y$(e,t,i){return t=jie(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function jie(e){var t=$ie(e,"string");return Iy(t)=="symbol"?t:t+""}function $ie(e,t){if(Iy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Iy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uie=["Webkit","Moz","O","ms"],Vie=function(t,i){var a=t.replace(/(\w)/,function(v){return v.toUpperCase()}),h=Uie.reduce(function(v,S){return lB(lB({},v),{},y$({},S+a,i))},{});return h[t]=i,h};function pg(e){"@babel/helpers - typeof";return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(e)}function Q0(){return Q0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Q0.apply(this,arguments)}function uB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function mT(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?uB(Object(i),!0).forEach(function(a){ec(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):uB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function qie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cB(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,x$(a.key),a)}}function Gie(e,t,i){return t&&cB(e.prototype,t),i&&cB(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hie(e,t,i){return t=ex(t),Wie(e,v$()?Reflect.construct(t,i||[],ex(e).constructor):t.apply(e,i))}function Wie(e,t){if(t&&(pg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zie(e)}function Zie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v$=function(){return!!e})()}function ex(e){return ex=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ex(e)}function Xie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VP(e,t)}function VP(e,t){return VP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},VP(e,t)}function ec(e,t,i){return t=x$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function x$(e){var t=Kie(e,"string");return pg(t)=="symbol"?t:t+""}function Kie(e,t){if(pg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(pg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yie=function(t){var i=t.data,a=t.startIndex,h=t.endIndex,v=t.x,S=t.width,o=t.travellerWidth;if(!i||!i.length)return{};var I=i.length,B=H_().domain(J0(0,I)).range([v,v+S-o]),$=B.domain().map(function(U){return B(U)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:B(a),endX:B(h),scale:B,scaleValues:$}},hB=function(t){return t.changedTouches&&!!t.changedTouches.length},mg=function(e){function t(i){var a;return qie(this,t),a=Hie(this,t,[i]),ec(a,"handleDrag",function(h){a.leaveTimer&&(clearTimeout(a.leaveTimer),a.leaveTimer=null),a.state.isTravellerMoving?a.handleTravellerMove(h):a.state.isSlideMoving&&a.handleSlideDrag(h)}),ec(a,"handleTouchMove",function(h){h.changedTouches!=null&&h.changedTouches.length>0&&a.handleDrag(h.changedTouches[0])}),ec(a,"handleDragEnd",function(){a.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var h=a.props,v=h.endIndex,S=h.onDragEnd,o=h.startIndex;S==null||S({endIndex:v,startIndex:o})}),a.detachDragEndListener()}),ec(a,"handleLeaveWrapper",function(){(a.state.isTravellerMoving||a.state.isSlideMoving)&&(a.leaveTimer=window.setTimeout(a.handleDragEnd,a.props.leaveTimeOut))}),ec(a,"handleEnterSlideOrTraveller",function(){a.setState({isTextActive:!0})}),ec(a,"handleLeaveSlideOrTraveller",function(){a.setState({isTextActive:!1})}),ec(a,"handleSlideDragStart",function(h){var v=hB(h)?h.changedTouches[0]:h;a.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:v.pageX}),a.attachDragEndListener()}),a.travellerDragStartHandlers={startX:a.handleTravellerDragStart.bind(a,"startX"),endX:a.handleTravellerDragStart.bind(a,"endX")},a.state={},a}return Xie(t,e),Gie(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(a){var h=a.startX,v=a.endX,S=this.state.scaleValues,o=this.props,I=o.gap,B=o.data,$=B.length-1,U=Math.min(h,v),K=Math.max(h,v),te=t.getIndexInRange(S,U),le=t.getIndexInRange(S,K);return{startIndex:te-te%I,endIndex:le===$?$:le-le%I}}},{key:"getTextOfTick",value:function(a){var h=this.props,v=h.data,S=h.tickFormatter,o=h.dataKey,I=Nl(v[a],o,a);return Hi(S)?S(I,a):I}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(a){var h=this.state,v=h.slideMoveStartX,S=h.startX,o=h.endX,I=this.props,B=I.x,$=I.width,U=I.travellerWidth,K=I.startIndex,te=I.endIndex,le=I.onChange,se=a.pageX-v;se>0?se=Math.min(se,B+$-U-o,B+$-U-S):se<0&&(se=Math.max(se,B-S,B-o));var ue=this.getIndex({startX:S+se,endX:o+se});(ue.startIndex!==K||ue.endIndex!==te)&&le&&le(ue),this.setState({startX:S+se,endX:o+se,slideMoveStartX:a.pageX})}},{key:"handleTravellerDragStart",value:function(a,h){var v=hB(h)?h.changedTouches[0]:h;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:a,brushMoveStartX:v.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(a){var h=this.state,v=h.brushMoveStartX,S=h.movingTravellerId,o=h.endX,I=h.startX,B=this.state[S],$=this.props,U=$.x,K=$.width,te=$.travellerWidth,le=$.onChange,se=$.gap,ue=$.data,be={startX:this.state.startX,endX:this.state.endX},Ce=a.pageX-v;Ce>0?Ce=Math.min(Ce,U+K-te-B):Ce<0&&(Ce=Math.max(Ce,U-B)),be[S]=B+Ce;var Re=this.getIndex(be),De=Re.startIndex,ve=Re.endIndex,Le=function(){var lt=ue.length-1;return S==="startX"&&(o>I?De%se===0:ve%se===0)||o<I&&ve===lt||S==="endX"&&(o>I?ve%se===0:De%se===0)||o>I&&ve===lt};this.setState(ec(ec({},S,B+Ce),"brushMoveStartX",a.pageX),function(){le&&Le()&&le(Re)})}},{key:"handleTravellerMoveKeyboard",value:function(a,h){var v=this,S=this.state,o=S.scaleValues,I=S.startX,B=S.endX,$=this.state[h],U=o.indexOf($);if(U!==-1){var K=U+a;if(!(K===-1||K>=o.length)){var te=o[K];h==="startX"&&te>=B||h==="endX"&&te<=I||this.setState(ec({},h,te),function(){v.props.onChange(v.getIndex({startX:v.state.startX,endX:v.state.endX}))})}}}},{key:"renderBackground",value:function(){var a=this.props,h=a.x,v=a.y,S=a.width,o=a.height,I=a.fill,B=a.stroke;return Bt.createElement("rect",{stroke:B,fill:I,x:h,y:v,width:S,height:o})}},{key:"renderPanorama",value:function(){var a=this.props,h=a.x,v=a.y,S=a.width,o=a.height,I=a.data,B=a.children,$=a.padding,U=rt.Children.only(B);return U?Bt.cloneElement(U,{x:h,y:v,width:S,height:o,margin:$,compact:!0,data:I}):null}},{key:"renderTravellerLayer",value:function(a,h){var v,S,o=this,I=this.props,B=I.y,$=I.travellerWidth,U=I.height,K=I.traveller,te=I.ariaLabel,le=I.data,se=I.startIndex,ue=I.endIndex,be=Math.max(a,this.props.x),Ce=mT(mT({},ki(this.props,!1)),{},{x:be,y:B,width:$,height:U}),Re=te||"Min value: ".concat((v=le[se])===null||v===void 0?void 0:v.name,", Max value: ").concat((S=le[ue])===null||S===void 0?void 0:S.name);return Bt.createElement(Qo,{tabIndex:0,role:"slider","aria-label":Re,"aria-valuenow":a,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[h],onTouchStart:this.travellerDragStartHandlers[h],onKeyDown:function(ve){["ArrowLeft","ArrowRight"].includes(ve.key)&&(ve.preventDefault(),ve.stopPropagation(),o.handleTravellerMoveKeyboard(ve.key==="ArrowRight"?1:-1,h))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(K,Ce))}},{key:"renderSlide",value:function(a,h){var v=this.props,S=v.y,o=v.height,I=v.stroke,B=v.travellerWidth,$=Math.min(a,h)+B,U=Math.max(Math.abs(h-a)-B,0);return Bt.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:I,fillOpacity:.2,x:$,y:S,width:U,height:o})}},{key:"renderText",value:function(){var a=this.props,h=a.startIndex,v=a.endIndex,S=a.y,o=a.height,I=a.travellerWidth,B=a.stroke,$=this.state,U=$.startX,K=$.endX,te=5,le={pointerEvents:"none",fill:B};return Bt.createElement(Qo,{className:"recharts-brush-texts"},Bt.createElement(Jp,Q0({textAnchor:"end",verticalAnchor:"middle",x:Math.min(U,K)-te,y:S+o/2},le),this.getTextOfTick(h)),Bt.createElement(Jp,Q0({textAnchor:"start",verticalAnchor:"middle",x:Math.max(U,K)+I+te,y:S+o/2},le),this.getTextOfTick(v)))}},{key:"render",value:function(){var a=this.props,h=a.data,v=a.className,S=a.children,o=a.x,I=a.y,B=a.width,$=a.height,U=a.alwaysShowText,K=this.state,te=K.startX,le=K.endX,se=K.isTextActive,ue=K.isSlideMoving,be=K.isTravellerMoving,Ce=K.isTravellerFocused;if(!h||!h.length||!gr(o)||!gr(I)||!gr(B)||!gr($)||B<=0||$<=0)return null;var Re=to("recharts-brush",v),De=Bt.Children.count(S)===1,ve=Vie("userSelect","none");return Bt.createElement(Qo,{className:Re,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ve},this.renderBackground(),De&&this.renderPanorama(),this.renderSlide(te,le),this.renderTravellerLayer(te,"startX"),this.renderTravellerLayer(le,"endX"),(se||ue||be||Ce||U)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(a){var h=a.x,v=a.y,S=a.width,o=a.height,I=a.stroke,B=Math.floor(v+o/2)-1;return Bt.createElement(Bt.Fragment,null,Bt.createElement("rect",{x:h,y:v,width:S,height:o,fill:I,stroke:"none"}),Bt.createElement("line",{x1:h+1,y1:B,x2:h+S-1,y2:B,fill:"none",stroke:"#fff"}),Bt.createElement("line",{x1:h+1,y1:B+2,x2:h+S-1,y2:B+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(a,h){var v;return Bt.isValidElement(a)?v=Bt.cloneElement(a,h):Hi(a)?v=a(h):v=t.renderDefaultTraveller(h),v}},{key:"getDerivedStateFromProps",value:function(a,h){var v=a.data,S=a.width,o=a.x,I=a.travellerWidth,B=a.updateId,$=a.startIndex,U=a.endIndex;if(v!==h.prevData||B!==h.prevUpdateId)return mT({prevData:v,prevTravellerWidth:I,prevUpdateId:B,prevX:o,prevWidth:S},v&&v.length?Yie({data:v,width:S,x:o,travellerWidth:I,startIndex:$,endIndex:U}):{scale:null,scaleValues:null});if(h.scale&&(S!==h.prevWidth||o!==h.prevX||I!==h.prevTravellerWidth)){h.scale.range([o,o+S-I]);var K=h.scale.domain().map(function(te){return h.scale(te)});return{prevData:v,prevTravellerWidth:I,prevUpdateId:B,prevX:o,prevWidth:S,startX:h.scale(a.startIndex),endX:h.scale(a.endIndex),scaleValues:K}}return null}},{key:"getIndexInRange",value:function(a,h){for(var v=a.length,S=0,o=v-1;o-S>1;){var I=Math.floor((S+o)/2);a[I]>h?o=I:S=I}return h>=a[o]?o:S}}])}(rt.PureComponent);ec(mg,"displayName","Brush");ec(mg,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var gT,fB;function Jie(){if(fB)return gT;fB=1;var e=$M();function t(i,a){var h;return e(i,function(v,S,o){return h=a(v,S,o),!h}),!!h}return gT=t,gT}var _T,dB;function Qie(){if(dB)return _T;dB=1;var e=cj(),t=xl(),i=Jie(),a=vl(),h=Lg();function v(S,o,I){var B=a(S)?e:i;return I&&h(S,o,I)&&(o=void 0),B(S,t(o,3))}return _T=v,_T}var eoe=Qie();const toe=zo(eoe);var af=function(t,i){var a=t.alwaysShow,h=t.ifOverflow;return a&&(h="extendDomain"),h===i},yT,pB;function Jy(){if(pB)return yT;pB=1;var e=Rj();function t(i,a,h){a=="__proto__"&&e?e(i,a,{configurable:!0,enumerable:!0,value:h,writable:!0}):i[a]=h}return yT=t,yT}var vT,mB;function b$(){if(mB)return vT;mB=1;var e=Jy(),t=im(),i=xl();function a(h,v){var S={};return v=i(v,3),t(h,function(o,I,B){e(S,I,v(o,I,B))}),S}return vT=a,vT}var noe=b$();const roe=zo(noe);var xT,gB;function ioe(){if(gB)return xT;gB=1;function e(t,i){for(var a=-1,h=t==null?0:t.length;++a<h;)if(!i(t[a],a,t))return!1;return!0}return xT=e,xT}var bT,_B;function ooe(){if(_B)return bT;_B=1;var e=$M();function t(i,a){var h=!0;return e(i,function(v,S,o){return h=!!a(v,S,o),h}),h}return bT=t,bT}var wT,yB;function aoe(){if(yB)return wT;yB=1;var e=ioe(),t=ooe(),i=xl(),a=vl(),h=Lg();function v(S,o,I){var B=a(S)?e:t;return I&&h(S,o,I)&&(o=void 0),B(S,i(o,3))}return wT=v,wT}var soe=aoe();const loe=zo(soe);var uoe=["x","y"];function Cy(e){"@babel/helpers - typeof";return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cy(e)}function qP(){return qP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},qP.apply(this,arguments)}function vB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function z_(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?vB(Object(i),!0).forEach(function(a){coe(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function coe(e,t,i){return t=hoe(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function hoe(e){var t=foe(e,"string");return Cy(t)=="symbol"?t:t+""}function foe(e,t){if(Cy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Cy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function doe(e,t){if(e==null)return{};var i=poe(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function poe(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function moe(e,t){var i=e.x,a=e.y,h=doe(e,uoe),v="".concat(i),S=parseInt(v,10),o="".concat(a),I=parseInt(o,10),B="".concat(t.height||h.height),$=parseInt(B,10),U="".concat(t.width||h.width),K=parseInt(U,10);return z_(z_(z_(z_(z_({},t),h),S?{x:S}:{}),I?{y:I}:{}),{},{height:$,width:K,name:t.name,radius:t.radius})}function xB(e){return Bt.createElement(p$,qP({shapeType:"rectangle",propTransformer:moe,activeClassName:"recharts-active-bar"},e))}var goe=function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(a,h){if(typeof t=="number")return t;var v=typeof a=="number";return v?t(a,h):(v||em(),i)}},_oe=["value","background"],w$;function gg(e){"@babel/helpers - typeof";return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gg(e)}function yoe(e,t){if(e==null)return{};var i=voe(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function voe(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function tx(){return tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},tx.apply(this,arguments)}function bB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Is(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?bB(Object(i),!0).forEach(function(a){Vd(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):bB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function xoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wB(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,T$(a.key),a)}}function boe(e,t,i){return t&&wB(e.prototype,t),i&&wB(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function woe(e,t,i){return t=nx(t),Soe(e,S$()?Reflect.construct(t,i||[],nx(e).constructor):t.apply(e,i))}function Soe(e,t){if(t&&(gg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Toe(e)}function Toe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(S$=function(){return!!e})()}function nx(e){return nx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},nx(e)}function Eoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GP(e,t)}function GP(e,t){return GP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},GP(e,t)}function Vd(e,t,i){return t=T$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function T$(e){var t=Aoe(e,"string");return gg(t)=="symbol"?t:t+""}function Aoe(e,t){if(gg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(gg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qc=function(e){function t(){var i;xoe(this,t);for(var a=arguments.length,h=new Array(a),v=0;v<a;v++)h[v]=arguments[v];return i=woe(this,t,[].concat(h)),Vd(i,"state",{isAnimationFinished:!1}),Vd(i,"id",qy("recharts-bar-")),Vd(i,"handleAnimationEnd",function(){var S=i.props.onAnimationEnd;i.setState({isAnimationFinished:!0}),S&&S()}),Vd(i,"handleAnimationStart",function(){var S=i.props.onAnimationStart;i.setState({isAnimationFinished:!1}),S&&S()}),i}return Eoe(t,e),boe(t,[{key:"renderRectanglesStatically",value:function(a){var h=this,v=this.props,S=v.shape,o=v.dataKey,I=v.activeIndex,B=v.activeBar,$=ki(this.props,!1);return a&&a.map(function(U,K){var te=K===I,le=te?B:S,se=Is(Is(Is({},$),U),{},{isActive:te,option:le,index:K,dataKey:o,onAnimationStart:h.handleAnimationStart,onAnimationEnd:h.handleAnimationEnd});return Bt.createElement(Qo,tx({className:"recharts-bar-rectangle"},Yp(h.props,U,K),{key:"rectangle-".concat(U==null?void 0:U.x,"-").concat(U==null?void 0:U.y,"-").concat(U==null?void 0:U.value)}),Bt.createElement(xB,se))})}},{key:"renderRectanglesWithAnimation",value:function(){var a=this,h=this.props,v=h.data,S=h.layout,o=h.isAnimationActive,I=h.animationBegin,B=h.animationDuration,$=h.animationEasing,U=h.animationId,K=this.state.prevData;return Bt.createElement(td,{begin:I,duration:B,isActive:o,easing:$,from:{t:0},to:{t:1},key:"bar-".concat(U),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(te){var le=te.t,se=v.map(function(ue,be){var Ce=K&&K[be];if(Ce){var Re=$d(Ce.x,ue.x),De=$d(Ce.y,ue.y),ve=$d(Ce.width,ue.width),Le=$d(Ce.height,ue.height);return Is(Is({},ue),{},{x:Re(le),y:De(le),width:ve(le),height:Le(le)})}if(S==="horizontal"){var Fe=$d(0,ue.height),lt=Fe(le);return Is(Is({},ue),{},{y:ue.y+ue.height-lt,height:lt})}var xt=$d(0,ue.width),gt=xt(le);return Is(Is({},ue),{},{width:gt})});return Bt.createElement(Qo,null,a.renderRectanglesStatically(se))})}},{key:"renderRectangles",value:function(){var a=this.props,h=a.data,v=a.isAnimationActive,S=this.state.prevData;return v&&h&&h.length&&(!S||!qx(S,h))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(h)}},{key:"renderBackground",value:function(){var a=this,h=this.props,v=h.data,S=h.dataKey,o=h.activeIndex,I=ki(this.props.background,!1);return v.map(function(B,$){B.value;var U=B.background,K=yoe(B,_oe);if(!U)return null;var te=Is(Is(Is(Is(Is({},K),{},{fill:"#eee"},U),I),Yp(a.props,B,$)),{},{onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd,dataKey:S,index:$,className:"recharts-bar-background-rectangle"});return Bt.createElement(xB,tx({key:"background-bar-".concat($),option:a.props.background,isActive:$===o},te))})}},{key:"renderErrorBar",value:function(a,h){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var v=this.props,S=v.data,o=v.xAxis,I=v.yAxis,B=v.layout,$=v.children,U=Hc($,Wx);if(!U)return null;var K=B==="vertical"?S[0].height/2:S[0].width/2,te=function(ue,be){var Ce=Array.isArray(ue.value)?ue.value[1]:ue.value;return{x:ue.x,y:ue.y,value:Ce,errorVal:Nl(ue,be)}},le={clipPath:a?"url(#clipPath-".concat(h,")"):null};return Bt.createElement(Qo,le,U.map(function(se){return Bt.cloneElement(se,{key:"error-bar-".concat(h,"-").concat(se.props.dataKey),data:S,xAxis:o,yAxis:I,layout:B,offset:K,dataPointFormatter:te})}))}},{key:"render",value:function(){var a=this.props,h=a.hide,v=a.data,S=a.className,o=a.xAxis,I=a.yAxis,B=a.left,$=a.top,U=a.width,K=a.height,te=a.isAnimationActive,le=a.background,se=a.id;if(h||!v||!v.length)return null;var ue=this.state.isAnimationFinished,be=to("recharts-bar",S),Ce=o&&o.allowDataOverflow,Re=I&&I.allowDataOverflow,De=Ce||Re,ve=ao(se)?this.id:se;return Bt.createElement(Qo,{className:be},Ce||Re?Bt.createElement("defs",null,Bt.createElement("clipPath",{id:"clipPath-".concat(ve)},Bt.createElement("rect",{x:Ce?B:B-U/2,y:Re?$:$-K/2,width:Ce?U:U*2,height:Re?K:K*2}))):null,Bt.createElement(Qo,{className:"recharts-bar-rectangles",clipPath:De?"url(#clipPath-".concat(ve,")"):null},le?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(De,ve),(!te||ue)&&Gd.renderCallByParent(this.props,v))}}],[{key:"getDerivedStateFromProps",value:function(a,h){return a.animationId!==h.prevAnimationId?{prevAnimationId:a.animationId,curData:a.data,prevData:h.curData}:a.data!==h.curData?{curData:a.data}:null}}])}(rt.PureComponent);w$=qc;Vd(qc,"displayName","Bar");Vd(qc,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Kf.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Vd(qc,"getComposedData",function(e){var t=e.props,i=e.item,a=e.barPosition,h=e.bandSize,v=e.xAxis,S=e.yAxis,o=e.xAxisTicks,I=e.yAxisTicks,B=e.stackedData,$=e.dataStartIndex,U=e.displayedData,K=e.offset,te=mee(a,i);if(!te)return null;var le=t.layout,se=i.type.defaultProps,ue=se!==void 0?Is(Is({},se),i.props):i.props,be=ue.dataKey,Ce=ue.children,Re=ue.minPointSize,De=le==="horizontal"?S:v,ve=B?De.scale.domain():null,Le=wee({numericAxis:De}),Fe=Hc(Ce,Lx),lt=U.map(function(xt,gt){var Je,St,Nt,Ht,Ct,Kt;B?Je=gee(B[$+gt],ve):(Je=Nl(xt,be),Array.isArray(Je)||(Je=[Le,Je]));var Lt=goe(Re,w$.defaultProps.minPointSize)(Je[1],gt);if(le==="horizontal"){var et,vt=[S.scale(Je[0]),S.scale(Je[1])],Ot=vt[0],mt=vt[1];St=Wz({axis:v,ticks:o,bandSize:h,offset:te.offset,entry:xt,index:gt}),Nt=(et=mt??Ot)!==null&&et!==void 0?et:void 0,Ht=te.size;var zt=Ot-mt;if(Ct=Number.isNaN(zt)?0:zt,Kt={x:St,y:S.y,width:Ht,height:S.height},Math.abs(Lt)>0&&Math.abs(Ct)<Math.abs(Lt)){var Jt=ou(Ct||Lt)*(Math.abs(Lt)-Math.abs(Ct));Nt-=Jt,Ct+=Jt}}else{var Un=[v.scale(Je[0]),v.scale(Je[1])],$n=Un[0],Bn=Un[1];if(St=$n,Nt=Wz({axis:S,ticks:I,bandSize:h,offset:te.offset,entry:xt,index:gt}),Ht=Bn-$n,Ct=te.size,Kt={x:v.x,y:Nt,width:v.width,height:Ct},Math.abs(Lt)>0&&Math.abs(Ht)<Math.abs(Lt)){var $r=ou(Ht||Lt)*(Math.abs(Lt)-Math.abs(Ht));Ht+=$r}}return Is(Is(Is({},xt),{},{x:St,y:Nt,width:Ht,height:Ct,value:B?Je:Je[1],payload:xt,background:Kt},Fe&&Fe[gt]&&Fe[gt].props),{},{tooltipPayload:[X6(i,xt)],tooltipPosition:{x:St+Ht/2,y:Nt+Ct/2}})});return Is({data:lt,layout:le},K)});function Oy(e){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(e)}function Poe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SB(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,E$(a.key),a)}}function Moe(e,t,i){return t&&SB(e.prototype,t),i&&SB(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function TB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Oh(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?TB(Object(i),!0).forEach(function(a){t1(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):TB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function t1(e,t,i){return t=E$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function E$(e){var t=Ioe(e,"string");return Oy(t)=="symbol"?t:t+""}function Ioe(e,t){if(Oy(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Oy(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Coe=function(t,i,a,h,v){var S=t.width,o=t.height,I=t.layout,B=t.children,$=Object.keys(i),U={left:a.left,leftMirror:a.left,right:S-a.right,rightMirror:S-a.right,top:a.top,topMirror:a.top,bottom:o-a.bottom,bottomMirror:o-a.bottom},K=!!tc(B,qc);return $.reduce(function(te,le){var se=i[le],ue=se.orientation,be=se.domain,Ce=se.padding,Re=Ce===void 0?{}:Ce,De=se.mirror,ve=se.reversed,Le="".concat(ue).concat(De?"Mirror":""),Fe,lt,xt,gt,Je;if(se.type==="number"&&(se.padding==="gap"||se.padding==="no-gap")){var St=be[1]-be[0],Nt=1/0,Ht=se.categoricalDomain.sort();if(Ht.forEach(function(Un,$n){$n>0&&(Nt=Math.min((Un||0)-(Ht[$n-1]||0),Nt))}),Number.isFinite(Nt)){var Ct=Nt/St,Kt=se.layout==="vertical"?a.height:a.width;if(se.padding==="gap"&&(Fe=Ct*Kt/2),se.padding==="no-gap"){var Lt=au(t.barCategoryGap,Ct*Kt),et=Ct*Kt/2;Fe=et-Lt-(et-Lt)/Kt*Lt}}}h==="xAxis"?lt=[a.left+(Re.left||0)+(Fe||0),a.left+a.width-(Re.right||0)-(Fe||0)]:h==="yAxis"?lt=I==="horizontal"?[a.top+a.height-(Re.bottom||0),a.top+(Re.top||0)]:[a.top+(Re.top||0)+(Fe||0),a.top+a.height-(Re.bottom||0)-(Fe||0)]:lt=se.range,ve&&(lt=[lt[1],lt[0]]);var vt=G6(se,v,K),Ot=vt.scale,mt=vt.realScaleType;Ot.domain(be).range(lt),H6(Ot);var zt=W6(Ot,Oh(Oh({},se),{},{realScaleType:mt}));h==="xAxis"?(Je=ue==="top"&&!De||ue==="bottom"&&De,xt=a.left,gt=U[Le]-Je*se.height):h==="yAxis"&&(Je=ue==="left"&&!De||ue==="right"&&De,xt=U[Le]-Je*se.width,gt=a.top);var Jt=Oh(Oh(Oh({},se),zt),{},{realScaleType:mt,x:xt,y:gt,scale:Ot,width:h==="xAxis"?a.width:se.width,height:h==="yAxis"?a.height:se.height});return Jt.bandSize=j0(Jt,zt),!se.hide&&h==="xAxis"?U[Le]+=(Je?-1:1)*Jt.height:se.hide||(U[Le]+=(Je?-1:1)*Jt.width),Oh(Oh({},te),{},t1({},le,Jt))},{})},A$=function(t,i){var a=t.x,h=t.y,v=i.x,S=i.y;return{x:Math.min(a,v),y:Math.min(h,S),width:Math.abs(v-a),height:Math.abs(S-h)}},Ooe=function(t){var i=t.x1,a=t.y1,h=t.x2,v=t.y2;return A$({x:i,y:a},{x:h,y:v})},P$=function(){function e(t){Poe(this,e),this.scale=t}return Moe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=a.bandAware,v=a.position;if(i!==void 0){if(v)switch(v){case"start":return this.scale(i);case"middle":{var S=this.bandwidth?this.bandwidth()/2:0;return this.scale(i)+S}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(i)+o}default:return this.scale(i)}if(h){var I=this.bandwidth?this.bandwidth()/2:0;return this.scale(i)+I}return this.scale(i)}}},{key:"isInRange",value:function(i){var a=this.range(),h=a[0],v=a[a.length-1];return h<=v?i>=h&&i<=v:i>=v&&i<=h}}],[{key:"create",value:function(i){return new e(i)}}])}();t1(P$,"EPS",1e-4);var xI=function(t){var i=Object.keys(t).reduce(function(a,h){return Oh(Oh({},a),{},t1({},h,P$.create(t[h])))},{});return Oh(Oh({},i),{},{apply:function(h){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},S=v.bandAware,o=v.position;return roe(h,function(I,B){return i[B].apply(I,{bandAware:S,position:o})})},isInRange:function(h){return loe(h,function(v,S){return i[S].isInRange(v)})}})};function koe(e){return(e%180+180)%180}var Roe=function(t){var i=t.width,a=t.height,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=koe(h),S=v*Math.PI/180,o=Math.atan(a/i),I=S>o&&S<Math.PI-o?a/Math.sin(S):i/Math.cos(S);return Math.abs(I)},ST,EB;function Loe(){if(EB)return ST;EB=1;var e=xl(),t=Kd(),i=oc();function a(h){return function(v,S,o){var I=Object(v);if(!t(v)){var B=e(S,3);v=i(v),S=function(U){return B(I[U],U,I)}}var $=h(v,S,o);return $>-1?I[B?v[$]:$]:void 0}}return ST=a,ST}var TT,AB;function Doe(){if(AB)return TT;AB=1;var e=_$();function t(i){var a=e(i),h=a%1;return a===a?h?a-h:a:0}return TT=t,TT}var ET,PB;function zoe(){if(PB)return ET;PB=1;var e=Ej(),t=xl(),i=Doe(),a=Math.max;function h(v,S,o){var I=v==null?0:v.length;if(!I)return-1;var B=o==null?0:i(o);return B<0&&(B=a(I+B,0)),e(v,t(S,3),B)}return ET=h,ET}var AT,MB;function Foe(){if(MB)return AT;MB=1;var e=Loe(),t=zoe(),i=e(t);return AT=i,AT}Foe();var Boe=NN();const Noe=zo(Boe);var joe=Noe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),M$=rt.createContext(void 0),I$=rt.createContext(void 0),C$=rt.createContext(void 0),$oe=rt.createContext({}),O$=rt.createContext(void 0),k$=rt.createContext(0),R$=rt.createContext(0),IB=function(t){var i=t.state,a=i.xAxisMap,h=i.yAxisMap,v=i.offset,S=t.clipPathId,o=t.children,I=t.width,B=t.height,$=joe(v);return Bt.createElement(M$.Provider,{value:a},Bt.createElement(I$.Provider,{value:h},Bt.createElement($oe.Provider,{value:v},Bt.createElement(C$.Provider,{value:$},Bt.createElement(O$.Provider,{value:S},Bt.createElement(k$.Provider,{value:B},Bt.createElement(R$.Provider,{value:I},o)))))))},Uoe=function(){return rt.useContext(O$)},L$=function(t){var i=rt.useContext(M$);i==null&&em();var a=i[t];return a==null&&em(),a},D$=function(t){var i=rt.useContext(I$);i==null&&em();var a=i[t];return a==null&&em(),a},Voe=function(){var t=rt.useContext(C$);return t},z$=function(){return rt.useContext(R$)},F$=function(){return rt.useContext(k$)};function _g(e){"@babel/helpers - typeof";return _g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_g(e)}function qoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Goe(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,N$(a.key),a)}}function Hoe(e,t,i){return t&&Goe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Woe(e,t,i){return t=rx(t),Zoe(e,B$()?Reflect.construct(t,i||[],rx(e).constructor):t.apply(e,i))}function Zoe(e,t){if(t&&(_g(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xoe(e)}function Xoe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(B$=function(){return!!e})()}function rx(e){return rx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},rx(e)}function Koe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HP(e,t)}function HP(e,t){return HP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},HP(e,t)}function CB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function OB(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?CB(Object(i),!0).forEach(function(a){bI(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):CB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function bI(e,t,i){return t=N$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function N$(e){var t=Yoe(e,"string");return _g(t)=="symbol"?t:t+""}function Yoe(e,t){if(_g(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(_g(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Joe(e,t){return nae(e)||tae(e,t)||eae(e,t)||Qoe()}function Qoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eae(e,t){if(e){if(typeof e=="string")return kB(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return kB(e,t)}}function kB(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function tae(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function nae(e){if(Array.isArray(e))return e}function WP(){return WP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},WP.apply(this,arguments)}var rae=function(t,i){var a;return Bt.isValidElement(t)?a=Bt.cloneElement(t,i):Hi(t)?a=t(i):a=Bt.createElement("line",WP({},i,{className:"recharts-reference-line-line"})),a},iae=function(t,i,a,h,v,S,o,I,B){var $=v.x,U=v.y,K=v.width,te=v.height;if(a){var le=B.y,se=t.y.apply(le,{position:S});if(af(B,"discard")&&!t.y.isInRange(se))return null;var ue=[{x:$+K,y:se},{x:$,y:se}];return I==="left"?ue.reverse():ue}if(i){var be=B.x,Ce=t.x.apply(be,{position:S});if(af(B,"discard")&&!t.x.isInRange(Ce))return null;var Re=[{x:Ce,y:U+te},{x:Ce,y:U}];return o==="top"?Re.reverse():Re}if(h){var De=B.segment,ve=De.map(function(Le){return t.apply(Le,{position:S})});return af(B,"discard")&&toe(ve,function(Le){return!t.isInRange(Le)})?null:ve}return null};function oae(e){var t=e.x,i=e.y,a=e.segment,h=e.xAxisId,v=e.yAxisId,S=e.shape,o=e.className,I=e.alwaysShow,B=Uoe(),$=L$(h),U=D$(v),K=Voe();if(!B||!K)return null;Xf(I===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var te=xI({x:$.scale,y:U.scale}),le=Zs(t),se=Zs(i),ue=a&&a.length===2,be=iae(te,le,se,ue,K,e.position,$.orientation,U.orientation,e);if(!be)return null;var Ce=Joe(be,2),Re=Ce[0],De=Re.x,ve=Re.y,Le=Ce[1],Fe=Le.x,lt=Le.y,xt=af(e,"hidden")?"url(#".concat(B,")"):void 0,gt=OB(OB({clipPath:xt},ki(e,!0)),{},{x1:De,y1:ve,x2:Fe,y2:lt});return Bt.createElement(Qo,{className:to("recharts-reference-line",o)},rae(S,gt),ul.renderCallByParent(e,Ooe({x1:De,y1:ve,x2:Fe,y2:lt})))}var Qm=function(e){function t(){return qoe(this,t),Woe(this,t,arguments)}return Koe(t,e),Hoe(t,[{key:"render",value:function(){return Bt.createElement(oae,this.props)}}])}(Bt.Component);bI(Qm,"displayName","ReferenceLine");bI(Qm,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function ZP(){return ZP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},ZP.apply(this,arguments)}function yg(e){"@babel/helpers - typeof";return yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yg(e)}function RB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function LB(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?RB(Object(i),!0).forEach(function(a){n1(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):RB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function aae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sae(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,$$(a.key),a)}}function lae(e,t,i){return t&&sae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uae(e,t,i){return t=ix(t),cae(e,j$()?Reflect.construct(t,i||[],ix(e).constructor):t.apply(e,i))}function cae(e,t){if(t&&(yg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hae(e)}function hae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j$=function(){return!!e})()}function ix(e){return ix=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ix(e)}function fae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XP(e,t)}function XP(e,t){return XP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},XP(e,t)}function n1(e,t,i){return t=$$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $$(e){var t=dae(e,"string");return yg(t)=="symbol"?t:t+""}function dae(e,t){if(yg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(yg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pae=function(t){var i=t.x,a=t.y,h=t.xAxis,v=t.yAxis,S=xI({x:h.scale,y:v.scale}),o=S.apply({x:i,y:a},{bandAware:!0});return af(t,"discard")&&!S.isInRange(o)?null:o},r1=function(e){function t(){return aae(this,t),uae(this,t,arguments)}return fae(t,e),lae(t,[{key:"render",value:function(){var a=this.props,h=a.x,v=a.y,S=a.r,o=a.alwaysShow,I=a.clipPathId,B=Zs(h),$=Zs(v);if(Xf(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!B||!$)return null;var U=pae(this.props);if(!U)return null;var K=U.x,te=U.y,le=this.props,se=le.shape,ue=le.className,be=af(this.props,"hidden")?"url(#".concat(I,")"):void 0,Ce=LB(LB({clipPath:be},ki(this.props,!0)),{},{cx:K,cy:te});return Bt.createElement(Qo,{className:to("recharts-reference-dot",ue)},t.renderDot(se,Ce),ul.renderCallByParent(this.props,{x:K-S,y:te-S,width:2*S,height:2*S}))}}])}(Bt.Component);n1(r1,"displayName","ReferenceDot");n1(r1,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});n1(r1,"renderDot",function(e,t){var i;return Bt.isValidElement(e)?i=Bt.cloneElement(e,t):Hi(e)?i=e(t):i=Bt.createElement(yI,ZP({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),i});function KP(){return KP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},KP.apply(this,arguments)}function vg(e){"@babel/helpers - typeof";return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vg(e)}function DB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function zB(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?DB(Object(i),!0).forEach(function(a){i1(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function mae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gae(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,V$(a.key),a)}}function _ae(e,t,i){return t&&gae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yae(e,t,i){return t=ox(t),vae(e,U$()?Reflect.construct(t,i||[],ox(e).constructor):t.apply(e,i))}function vae(e,t){if(t&&(vg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xae(e)}function xae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U$=function(){return!!e})()}function ox(e){return ox=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ox(e)}function bae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YP(e,t)}function YP(e,t){return YP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},YP(e,t)}function i1(e,t,i){return t=V$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function V$(e){var t=wae(e,"string");return vg(t)=="symbol"?t:t+""}function wae(e,t){if(vg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(vg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sae=function(t,i,a,h,v){var S=v.x1,o=v.x2,I=v.y1,B=v.y2,$=v.xAxis,U=v.yAxis;if(!$||!U)return null;var K=xI({x:$.scale,y:U.scale}),te={x:t?K.x.apply(S,{position:"start"}):K.x.rangeMin,y:a?K.y.apply(I,{position:"start"}):K.y.rangeMin},le={x:i?K.x.apply(o,{position:"end"}):K.x.rangeMax,y:h?K.y.apply(B,{position:"end"}):K.y.rangeMax};return af(v,"discard")&&(!K.isInRange(te)||!K.isInRange(le))?null:A$(te,le)},o1=function(e){function t(){return mae(this,t),yae(this,t,arguments)}return bae(t,e),_ae(t,[{key:"render",value:function(){var a=this.props,h=a.x1,v=a.x2,S=a.y1,o=a.y2,I=a.className,B=a.alwaysShow,$=a.clipPathId;Xf(B===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var U=Zs(h),K=Zs(v),te=Zs(S),le=Zs(o),se=this.props.shape;if(!U&&!K&&!te&&!le&&!se)return null;var ue=Sae(U,K,te,le,this.props);if(!ue&&!se)return null;var be=af(this.props,"hidden")?"url(#".concat($,")"):void 0;return Bt.createElement(Qo,{className:to("recharts-reference-area",I)},t.renderRect(se,zB(zB({clipPath:be},ki(this.props,!0)),ue)),ul.renderCallByParent(this.props,ue))}}])}(Bt.Component);i1(o1,"displayName","ReferenceArea");i1(o1,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});i1(o1,"renderRect",function(e,t){var i;return Bt.isValidElement(e)?i=Bt.cloneElement(e,t):Hi(e)?i=e(t):i=Bt.createElement(_I,KP({},t,{className:"recharts-reference-area-rect"})),i});function q$(e,t,i){if(t<1)return[];if(t===1&&i===void 0)return e;for(var a=[],h=0;h<e.length;h+=t)a.push(e[h]);return a}function Tae(e,t,i){var a={width:e.width+t.width,height:e.height+t.height};return Roe(a,i)}function Eae(e,t,i){var a=i==="width",h=e.x,v=e.y,S=e.width,o=e.height;return t===1?{start:a?h:v,end:a?h+S:v+o}:{start:a?h+S:v+o,end:a?h:v}}function ax(e,t,i,a,h){if(e*t<e*a||e*t>e*h)return!1;var v=i();return e*(t-e*v/2-a)>=0&&e*(t+e*v/2-h)<=0}function Aae(e,t){return q$(e,t+1)}function Pae(e,t,i,a,h){for(var v=(a||[]).slice(),S=t.start,o=t.end,I=0,B=1,$=S,U=function(){var le=a==null?void 0:a[I];if(le===void 0)return{v:q$(a,B)};var se=I,ue,be=function(){return ue===void 0&&(ue=i(le,se)),ue},Ce=le.coordinate,Re=I===0||ax(e,Ce,be,$,o);Re||(I=0,$=S,B+=1),Re&&($=Ce+e*(be()/2+h),I+=B)},K;B<=v.length;)if(K=U(),K)return K.v;return[]}function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function FB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function zl(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?FB(Object(i),!0).forEach(function(a){Mae(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):FB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Mae(e,t,i){return t=Iae(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Iae(e){var t=Cae(e,"string");return ky(t)=="symbol"?t:t+""}function Cae(e,t){if(ky(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(ky(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oae(e,t,i,a,h){for(var v=(a||[]).slice(),S=v.length,o=t.start,I=t.end,B=function(K){var te=v[K],le,se=function(){return le===void 0&&(le=i(te,K)),le};if(K===S-1){var ue=e*(te.coordinate+e*se()/2-I);v[K]=te=zl(zl({},te),{},{tickCoord:ue>0?te.coordinate-ue*e:te.coordinate})}else v[K]=te=zl(zl({},te),{},{tickCoord:te.coordinate});var be=ax(e,te.tickCoord,se,o,I);be&&(I=te.tickCoord-e*(se()/2+h),v[K]=zl(zl({},te),{},{isShow:!0}))},$=S-1;$>=0;$--)B($);return v}function kae(e,t,i,a,h,v){var S=(a||[]).slice(),o=S.length,I=t.start,B=t.end;if(v){var $=a[o-1],U=i($,o-1),K=e*($.coordinate+e*U/2-B);S[o-1]=$=zl(zl({},$),{},{tickCoord:K>0?$.coordinate-K*e:$.coordinate});var te=ax(e,$.tickCoord,function(){return U},I,B);te&&(B=$.tickCoord-e*(U/2+h),S[o-1]=zl(zl({},$),{},{isShow:!0}))}for(var le=v?o-1:o,se=function(Ce){var Re=S[Ce],De,ve=function(){return De===void 0&&(De=i(Re,Ce)),De};if(Ce===0){var Le=e*(Re.coordinate-e*ve()/2-I);S[Ce]=Re=zl(zl({},Re),{},{tickCoord:Le<0?Re.coordinate-Le*e:Re.coordinate})}else S[Ce]=Re=zl(zl({},Re),{},{tickCoord:Re.coordinate});var Fe=ax(e,Re.tickCoord,ve,I,B);Fe&&(I=Re.tickCoord+e*(ve()/2+h),S[Ce]=zl(zl({},Re),{},{isShow:!0}))},ue=0;ue<le;ue++)se(ue);return S}function Rae(e,t,i){var a=e.tick,h=e.ticks,v=e.viewBox,S=e.minTickGap,o=e.orientation,I=e.interval,B=e.tickFormatter,$=e.unit,U=e.angle;if(!h||!h.length||!a)return[];if(gr(I)||Kf.isSsr)return Aae(h,typeof I=="number"&&gr(I)?I:0);var K=[],te=o==="top"||o==="bottom"?"width":"height",le=$&&te==="width"?G_($,{fontSize:t,letterSpacing:i}):{width:0,height:0},se=function(Re,De){var ve=Hi(B)?B(Re.value,De):Re.value;return te==="width"?Tae(G_(ve,{fontSize:t,letterSpacing:i}),le,U):G_(ve,{fontSize:t,letterSpacing:i})[te]},ue=h.length>=2?ou(h[1].coordinate-h[0].coordinate):1,be=Eae(v,ue,te);return I==="equidistantPreserveStart"?Pae(ue,be,se,h,S):(I==="preserveStart"||I==="preserveStartEnd"?K=kae(ue,be,se,h,S,I==="preserveStartEnd"):K=Oae(ue,be,se,h,S),K.filter(function(Ce){return Ce.isShow}))}var Lae=["viewBox"],Dae=["viewBox"],zae=["ticks"];function xg(e){"@babel/helpers - typeof";return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xg(e)}function Wm(){return Wm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Wm.apply(this,arguments)}function BB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function ru(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?BB(Object(i),!0).forEach(function(a){wI(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):BB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function PT(e,t){if(e==null)return{};var i=Fae(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Fae(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function Bae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NB(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,H$(a.key),a)}}function Nae(e,t,i){return t&&NB(e.prototype,t),i&&NB(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function jae(e,t,i){return t=sx(t),$ae(e,G$()?Reflect.construct(t,i||[],sx(e).constructor):t.apply(e,i))}function $ae(e,t){if(t&&(xg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uae(e)}function Uae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(G$=function(){return!!e})()}function sx(e){return sx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},sx(e)}function Vae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&JP(e,t)}function JP(e,t){return JP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},JP(e,t)}function wI(e,t,i){return t=H$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function H$(e){var t=qae(e,"string");return xg(t)=="symbol"?t:t+""}function qae(e,t){if(xg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(xg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a1=function(e){function t(i){var a;return Bae(this,t),a=jae(this,t,[i]),a.state={fontSize:"",letterSpacing:""},a}return Vae(t,e),Nae(t,[{key:"shouldComponentUpdate",value:function(a,h){var v=a.viewBox,S=PT(a,Lae),o=this.props,I=o.viewBox,B=PT(o,Dae);return!Km(v,I)||!Km(S,B)||!Km(h,this.state)}},{key:"componentDidMount",value:function(){var a=this.layerReference;if(a){var h=a.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];h&&this.setState({fontSize:window.getComputedStyle(h).fontSize,letterSpacing:window.getComputedStyle(h).letterSpacing})}}},{key:"getTickLineCoord",value:function(a){var h=this.props,v=h.x,S=h.y,o=h.width,I=h.height,B=h.orientation,$=h.tickSize,U=h.mirror,K=h.tickMargin,te,le,se,ue,be,Ce,Re=U?-1:1,De=a.tickSize||$,ve=gr(a.tickCoord)?a.tickCoord:a.coordinate;switch(B){case"top":te=le=a.coordinate,ue=S+ +!U*I,se=ue-Re*De,Ce=se-Re*K,be=ve;break;case"left":se=ue=a.coordinate,le=v+ +!U*o,te=le-Re*De,be=te-Re*K,Ce=ve;break;case"right":se=ue=a.coordinate,le=v+ +U*o,te=le+Re*De,be=te+Re*K,Ce=ve;break;default:te=le=a.coordinate,ue=S+ +U*I,se=ue+Re*De,Ce=se+Re*K,be=ve;break}return{line:{x1:te,y1:se,x2:le,y2:ue},tick:{x:be,y:Ce}}}},{key:"getTickTextAnchor",value:function(){var a=this.props,h=a.orientation,v=a.mirror,S;switch(h){case"left":S=v?"start":"end";break;case"right":S=v?"end":"start";break;default:S="middle";break}return S}},{key:"getTickVerticalAnchor",value:function(){var a=this.props,h=a.orientation,v=a.mirror,S="end";switch(h){case"left":case"right":S="middle";break;case"top":S=v?"start":"end";break;default:S=v?"end":"start";break}return S}},{key:"renderAxisLine",value:function(){var a=this.props,h=a.x,v=a.y,S=a.width,o=a.height,I=a.orientation,B=a.mirror,$=a.axisLine,U=ru(ru(ru({},ki(this.props,!1)),ki($,!1)),{},{fill:"none"});if(I==="top"||I==="bottom"){var K=+(I==="top"&&!B||I==="bottom"&&B);U=ru(ru({},U),{},{x1:h,y1:v+K*o,x2:h+S,y2:v+K*o})}else{var te=+(I==="left"&&!B||I==="right"&&B);U=ru(ru({},U),{},{x1:h+te*S,y1:v,x2:h+te*S,y2:v+o})}return Bt.createElement("line",Wm({},U,{className:to("recharts-cartesian-axis-line",ic($,"className"))}))}},{key:"renderTicks",value:function(a,h,v){var S=this,o=this.props,I=o.tickLine,B=o.stroke,$=o.tick,U=o.tickFormatter,K=o.unit,te=Rae(ru(ru({},this.props),{},{ticks:a}),h,v),le=this.getTickTextAnchor(),se=this.getTickVerticalAnchor(),ue=ki(this.props,!1),be=ki($,!1),Ce=ru(ru({},ue),{},{fill:"none"},ki(I,!1)),Re=te.map(function(De,ve){var Le=S.getTickLineCoord(De),Fe=Le.line,lt=Le.tick,xt=ru(ru(ru(ru({textAnchor:le,verticalAnchor:se},ue),{},{stroke:"none",fill:B},be),lt),{},{index:ve,payload:De,visibleTicksCount:te.length,tickFormatter:U});return Bt.createElement(Qo,Wm({className:"recharts-cartesian-axis-tick",key:"tick-".concat(De.value,"-").concat(De.coordinate,"-").concat(De.tickCoord)},Yp(S.props,De,ve)),I&&Bt.createElement("line",Wm({},Ce,Fe,{className:to("recharts-cartesian-axis-tick-line",ic(I,"className"))})),$&&t.renderTickItem($,xt,"".concat(Hi(U)?U(De.value,ve):De.value).concat(K||"")))});return Bt.createElement("g",{className:"recharts-cartesian-axis-ticks"},Re)}},{key:"render",value:function(){var a=this,h=this.props,v=h.axisLine,S=h.width,o=h.height,I=h.ticksGenerator,B=h.className,$=h.hide;if($)return null;var U=this.props,K=U.ticks,te=PT(U,zae),le=K;return Hi(I)&&(le=K&&K.length>0?I(this.props):I(te)),S<=0||o<=0||!le||!le.length?null:Bt.createElement(Qo,{className:to("recharts-cartesian-axis",B),ref:function(ue){a.layerReference=ue}},v&&this.renderAxisLine(),this.renderTicks(le,this.state.fontSize,this.state.letterSpacing),ul.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(a,h,v){var S;return Bt.isValidElement(a)?S=Bt.cloneElement(a,h):Hi(a)?S=a(h):S=Bt.createElement(Jp,Wm({},h,{className:"recharts-cartesian-axis-tick-value"}),v),S}}])}(rt.Component);wI(a1,"displayName","CartesianAxis");wI(a1,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});function bg(e){"@babel/helpers - typeof";return bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bg(e)}function Gae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hae(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,X$(a.key),a)}}function Wae(e,t,i){return t&&Hae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zae(e,t,i){return t=lx(t),Xae(e,W$()?Reflect.construct(t,i||[],lx(e).constructor):t.apply(e,i))}function Xae(e,t){if(t&&(bg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kae(e)}function Kae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W$=function(){return!!e})()}function lx(e){return lx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},lx(e)}function Yae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QP(e,t)}function QP(e,t){return QP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},QP(e,t)}function Z$(e,t,i){return t=X$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function X$(e){var t=Jae(e,"string");return bg(t)=="symbol"?t:t+""}function Jae(e,t){if(bg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(bg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eM(){return eM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},eM.apply(this,arguments)}function Qae(e){var t=e.xAxisId,i=z$(),a=F$(),h=L$(t);return h==null?null:Bt.createElement(a1,eM({},h,{className:to("recharts-".concat(h.axisType," ").concat(h.axisType),h.className),viewBox:{x:0,y:0,width:i,height:a},ticksGenerator:function(S){return $p(S,!0)}}))}var Gp=function(e){function t(){return Gae(this,t),Zae(this,t,arguments)}return Yae(t,e),Wae(t,[{key:"render",value:function(){return Bt.createElement(Qae,this.props)}}])}(Bt.Component);Z$(Gp,"displayName","XAxis");Z$(Gp,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function wg(e){"@babel/helpers - typeof";return wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wg(e)}function ese(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tse(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,J$(a.key),a)}}function nse(e,t,i){return t&&tse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rse(e,t,i){return t=ux(t),ise(e,K$()?Reflect.construct(t,i||[],ux(e).constructor):t.apply(e,i))}function ise(e,t){if(t&&(wg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ose(e)}function ose(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(K$=function(){return!!e})()}function ux(e){return ux=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ux(e)}function ase(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tM(e,t)}function tM(e,t){return tM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},tM(e,t)}function Y$(e,t,i){return t=J$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function J$(e){var t=sse(e,"string");return wg(t)=="symbol"?t:t+""}function sse(e,t){if(wg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(wg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nM(){return nM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},nM.apply(this,arguments)}var lse=function(t){var i=t.yAxisId,a=z$(),h=F$(),v=D$(i);return v==null?null:Bt.createElement(a1,nM({},v,{className:to("recharts-".concat(v.axisType," ").concat(v.axisType),v.className),viewBox:{x:0,y:0,width:a,height:h},ticksGenerator:function(o){return $p(o,!0)}}))},Hp=function(e){function t(){return ese(this,t),rse(this,t,arguments)}return ase(t,e),nse(t,[{key:"render",value:function(){return Bt.createElement(lse,this.props)}}])}(Bt.Component);Y$(Hp,"displayName","YAxis");Y$(Hp,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function jB(e){return fse(e)||hse(e)||cse(e)||use()}function use(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cse(e,t){if(e){if(typeof e=="string")return rM(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return rM(e,t)}}function hse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fse(e){if(Array.isArray(e))return rM(e)}function rM(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var iM=function(t,i,a,h,v){var S=Hc(t,Qm),o=Hc(t,r1),I=[].concat(jB(S),jB(o)),B=Hc(t,o1),$="".concat(h,"Id"),U=h[0],K=i;if(I.length&&(K=I.reduce(function(se,ue){if(ue.props[$]===a&&af(ue.props,"extendDomain")&&gr(ue.props[U])){var be=ue.props[U];return[Math.min(se[0],be),Math.max(se[1],be)]}return se},K)),B.length){var te="".concat(U,"1"),le="".concat(U,"2");K=B.reduce(function(se,ue){if(ue.props[$]===a&&af(ue.props,"extendDomain")&&gr(ue.props[te])&&gr(ue.props[le])){var be=ue.props[te],Ce=ue.props[le];return[Math.min(se[0],be,Ce),Math.max(se[1],be,Ce)]}return se},K)}return v&&v.length&&(K=v.reduce(function(se,ue){return gr(ue)?[Math.min(se[0],ue),Math.max(se[1],ue)]:se},K)),K},MT={exports:{}},$B;function dse(){return $B||($B=1,function(e){var t=Object.prototype.hasOwnProperty,i="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(i=!1));function h(I,B,$){this.fn=I,this.context=B,this.once=$||!1}function v(I,B,$,U,K){if(typeof $!="function")throw new TypeError("The listener must be a function");var te=new h($,U||I,K),le=i?i+B:B;return I._events[le]?I._events[le].fn?I._events[le]=[I._events[le],te]:I._events[le].push(te):(I._events[le]=te,I._eventsCount++),I}function S(I,B){--I._eventsCount===0?I._events=new a:delete I._events[B]}function o(){this._events=new a,this._eventsCount=0}o.prototype.eventNames=function(){var B=[],$,U;if(this._eventsCount===0)return B;for(U in $=this._events)t.call($,U)&&B.push(i?U.slice(1):U);return Object.getOwnPropertySymbols?B.concat(Object.getOwnPropertySymbols($)):B},o.prototype.listeners=function(B){var $=i?i+B:B,U=this._events[$];if(!U)return[];if(U.fn)return[U.fn];for(var K=0,te=U.length,le=new Array(te);K<te;K++)le[K]=U[K].fn;return le},o.prototype.listenerCount=function(B){var $=i?i+B:B,U=this._events[$];return U?U.fn?1:U.length:0},o.prototype.emit=function(B,$,U,K,te,le){var se=i?i+B:B;if(!this._events[se])return!1;var ue=this._events[se],be=arguments.length,Ce,Re;if(ue.fn){switch(ue.once&&this.removeListener(B,ue.fn,void 0,!0),be){case 1:return ue.fn.call(ue.context),!0;case 2:return ue.fn.call(ue.context,$),!0;case 3:return ue.fn.call(ue.context,$,U),!0;case 4:return ue.fn.call(ue.context,$,U,K),!0;case 5:return ue.fn.call(ue.context,$,U,K,te),!0;case 6:return ue.fn.call(ue.context,$,U,K,te,le),!0}for(Re=1,Ce=new Array(be-1);Re<be;Re++)Ce[Re-1]=arguments[Re];ue.fn.apply(ue.context,Ce)}else{var De=ue.length,ve;for(Re=0;Re<De;Re++)switch(ue[Re].once&&this.removeListener(B,ue[Re].fn,void 0,!0),be){case 1:ue[Re].fn.call(ue[Re].context);break;case 2:ue[Re].fn.call(ue[Re].context,$);break;case 3:ue[Re].fn.call(ue[Re].context,$,U);break;case 4:ue[Re].fn.call(ue[Re].context,$,U,K);break;default:if(!Ce)for(ve=1,Ce=new Array(be-1);ve<be;ve++)Ce[ve-1]=arguments[ve];ue[Re].fn.apply(ue[Re].context,Ce)}}return!0},o.prototype.on=function(B,$,U){return v(this,B,$,U,!1)},o.prototype.once=function(B,$,U){return v(this,B,$,U,!0)},o.prototype.removeListener=function(B,$,U,K){var te=i?i+B:B;if(!this._events[te])return this;if(!$)return S(this,te),this;var le=this._events[te];if(le.fn)le.fn===$&&(!K||le.once)&&(!U||le.context===U)&&S(this,te);else{for(var se=0,ue=[],be=le.length;se<be;se++)(le[se].fn!==$||K&&!le[se].once||U&&le[se].context!==U)&&ue.push(le[se]);ue.length?this._events[te]=ue.length===1?ue[0]:ue:S(this,te)}return this},o.prototype.removeAllListeners=function(B){var $;return B?($=i?i+B:B,this._events[$]&&S(this,$)):(this._events=new a,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o}(MT)),MT.exports}var pse=dse();const mse=zo(pse);var IT=new mse,CT="recharts.syncMouseEvents";function Ry(e){"@babel/helpers - typeof";return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(e)}function gse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _se(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Q$(a.key),a)}}function yse(e,t,i){return t&&_se(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function OT(e,t,i){return t=Q$(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Q$(e){var t=vse(e,"string");return Ry(t)=="symbol"?t:t+""}function vse(e,t){if(Ry(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t);if(Ry(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xse=function(){function e(){gse(this,e),OT(this,"activeIndex",0),OT(this,"coordinateList",[]),OT(this,"layout","horizontal")}return yse(e,[{key:"setDetails",value:function(i){var a,h=i.coordinateList,v=h===void 0?null:h,S=i.container,o=S===void 0?null:S,I=i.layout,B=I===void 0?null:I,$=i.offset,U=$===void 0?null:$,K=i.mouseHandlerCallback,te=K===void 0?null:K;this.coordinateList=(a=v??this.coordinateList)!==null&&a!==void 0?a:[],this.container=o??this.container,this.layout=B??this.layout,this.offset=U??this.offset,this.mouseHandlerCallback=te??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(i){if(this.coordinateList.length!==0)switch(i.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(i){this.activeIndex=i}},{key:"spoofMouse",value:function(){var i,a;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var h=this.container.getBoundingClientRect(),v=h.x,S=h.y,o=h.height,I=this.coordinateList[this.activeIndex].coordinate,B=((i=window)===null||i===void 0?void 0:i.scrollX)||0,$=((a=window)===null||a===void 0?void 0:a.scrollY)||0,U=v+I+B,K=S+this.offset.top+o/2+$;this.mouseHandlerCallback({pageX:U,pageY:K})}}}])}();function bse(e,t,i){if(i==="number"&&t===!0&&Array.isArray(e)){var a=e==null?void 0:e[0],h=e==null?void 0:e[1];if(a&&h&&gr(a)&&gr(h))return!0}return!1}function wse(e,t,i,a){var h=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-h:i.left+.5,y:e==="horizontal"?i.top+.5:t.y-h,width:e==="horizontal"?a:i.width-1,height:e==="horizontal"?i.height-1:a}}function eU(e){var t=e.cx,i=e.cy,a=e.radius,h=e.startAngle,v=e.endAngle,S=Ma(t,i,a,h),o=Ma(t,i,a,v);return{points:[S,o],cx:t,cy:i,radius:a,startAngle:h,endAngle:v}}function Sse(e,t,i){var a,h,v,S;if(e==="horizontal")a=t.x,v=a,h=i.top,S=i.top+i.height;else if(e==="vertical")h=t.y,S=h,a=i.left,v=i.left+i.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var o=t.cx,I=t.cy,B=t.innerRadius,$=t.outerRadius,U=t.angle,K=Ma(o,I,B,U),te=Ma(o,I,$,U);a=K.x,h=K.y,v=te.x,S=te.y}else return eU(t);return[{x:a,y:h},{x:v,y:S}]}function Ly(e){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ly(e)}function UB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function i0(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?UB(Object(i),!0).forEach(function(a){Tse(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):UB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Tse(e,t,i){return t=Ese(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ese(e){var t=Ase(e,"string");return Ly(t)=="symbol"?t:t+""}function Ase(e,t){if(Ly(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Ly(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pse(e){var t,i,a=e.element,h=e.tooltipEventType,v=e.isActive,S=e.activeCoordinate,o=e.activePayload,I=e.offset,B=e.activeTooltipIndex,$=e.tooltipAxisBandSize,U=e.layout,K=e.chartName,te=(t=a.props.cursor)!==null&&t!==void 0?t:(i=a.type.defaultProps)===null||i===void 0?void 0:i.cursor;if(!a||!te||!v||!S||K!=="ScatterChart"&&h!=="axis")return null;var le,se=PP;if(K==="ScatterChart")le=S,se=Pre;else if(K==="BarChart")le=wse(U,S,I,$),se=_I;else if(U==="radial"){var ue=eU(S),be=ue.cx,Ce=ue.cy,Re=ue.radius,De=ue.startAngle,ve=ue.endAngle;le={cx:be,cy:Ce,startAngle:De,endAngle:ve,innerRadius:Re,outerRadius:Re},se=t$}else le={points:Sse(U,S,I)},se=PP;var Le=i0(i0(i0(i0({stroke:"#ccc",pointerEvents:"none"},I),le),ki(te,!1)),{},{payload:o,payloadIndex:B,className:to("recharts-tooltip-cursor",te.className)});return rt.isValidElement(te)?rt.cloneElement(te,Le):rt.createElement(se,Le)}var Mse=["item"],Ise=["children","className","width","height","style","compact","title","desc"];function Sg(e){"@babel/helpers - typeof";return Sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sg(e)}function Zm(){return Zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Zm.apply(this,arguments)}function VB(e,t){return kse(e)||Ose(e,t)||nU(e,t)||Cse()}function Cse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ose(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var a,h,v,S,o=[],I=!0,B=!1;try{if(v=(i=i.call(e)).next,t!==0)for(;!(I=(a=v.call(i)).done)&&(o.push(a.value),o.length!==t);I=!0);}catch($){B=!0,h=$}finally{try{if(!I&&i.return!=null&&(S=i.return(),Object(S)!==S))return}finally{if(B)throw h}}return o}}function kse(e){if(Array.isArray(e))return e}function qB(e,t){if(e==null)return{};var i=Rse(e,t),a,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(e);for(h=0;h<v.length;h++)a=v[h],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Rse(e,t){if(e==null)return{};var i={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;i[a]=e[a]}return i}function Lse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dse(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,rU(a.key),a)}}function zse(e,t,i){return t&&Dse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fse(e,t,i){return t=cx(t),Bse(e,tU()?Reflect.construct(t,i||[],cx(e).constructor):t.apply(e,i))}function Bse(e,t){if(t&&(Sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nse(e)}function Nse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tU=function(){return!!e})()}function cx(e){return cx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},cx(e)}function jse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oM(e,t)}function oM(e,t){return oM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},oM(e,t)}function Tg(e){return Vse(e)||Use(e)||nU(e)||$se()}function $se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nU(e,t){if(e){if(typeof e=="string")return aM(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return aM(e,t)}}function Use(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vse(e){if(Array.isArray(e))return aM(e)}function aM(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function GB(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),i.push.apply(i,a)}return i}function Mn(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?GB(Object(i),!0).forEach(function(a){Ci(e,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):GB(Object(i)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a))})}return e}function Ci(e,t,i){return t=rU(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function rU(e){var t=qse(e,"string");return Sg(t)=="symbol"?t:t+""}function qse(e,t){if(Sg(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var a=i.call(e,t||"default");if(Sg(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gse={xAxis:["bottom","top"],yAxis:["left","right"]},Hse={width:"100%",height:"100%"},iU={x:0,y:0};function o0(e){return e}var Wse=function(t,i){return i==="horizontal"?t.x:i==="vertical"?t.y:i==="centric"?t.angle:t.radius},Zse=function(t,i,a,h){var v=i.find(function($){return $&&$.index===a});if(v){if(t==="horizontal")return{x:v.coordinate,y:h.y};if(t==="vertical")return{x:h.x,y:v.coordinate};if(t==="centric"){var S=v.coordinate,o=h.radius;return Mn(Mn(Mn({},h),Ma(h.cx,h.cy,o,S)),{},{angle:S,radius:o})}var I=v.coordinate,B=h.angle;return Mn(Mn(Mn({},h),Ma(h.cx,h.cy,I,B)),{},{angle:B,radius:I})}return iU},s1=function(t,i){var a=i.graphicalItems,h=i.dataStartIndex,v=i.dataEndIndex,S=(a??[]).reduce(function(o,I){var B=I.props.data;return B&&B.length?[].concat(Tg(o),Tg(B)):o},[]);return S.length>0?S:t&&t.length&&gr(h)&&gr(v)?t.slice(h,v+1):[]};function oU(e){return e==="number"?[0,"auto"]:void 0}var sM=function(t,i,a,h){var v=t.graphicalItems,S=t.tooltipAxis,o=s1(i,t);return a<0||!v||!v.length||a>=o.length?null:v.reduce(function(I,B){var $,U=($=B.props.data)!==null&&$!==void 0?$:i;U&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=a&&(U=U.slice(t.dataStartIndex,t.dataEndIndex+1));var K;if(S.dataKey&&!S.allowDuplicatedCategory){var te=U===void 0?o:U;K=$A(te,S.dataKey,h)}else K=U&&U[a]||o[a];return K?[].concat(Tg(I),[X6(B,K)]):I},[])},HB=function(t,i,a,h){var v=h||{x:t.chartX,y:t.chartY},S=Wse(v,a),o=t.orderedTooltipTicks,I=t.tooltipAxis,B=t.tooltipTicks,$=uee(S,o,B,I);if($>=0&&B){var U=B[$]&&B[$].value,K=sM(t,i,$,U),te=Zse(a,o,$,v);return{activeTooltipIndex:$,activeLabel:U,activePayload:K,activeCoordinate:te}}return null},Xse=function(t,i){var a=i.axes,h=i.graphicalItems,v=i.axisType,S=i.axisIdKey,o=i.stackGroups,I=i.dataStartIndex,B=i.dataEndIndex,$=t.layout,U=t.children,K=t.stackOffset,te=q6($,v);return a.reduce(function(le,se){var ue,be=se.type.defaultProps!==void 0?Mn(Mn({},se.type.defaultProps),se.props):se.props,Ce=be.type,Re=be.dataKey,De=be.allowDataOverflow,ve=be.allowDuplicatedCategory,Le=be.scale,Fe=be.ticks,lt=be.includeHidden,xt=be[S];if(le[xt])return le;var gt=s1(t.data,{graphicalItems:h.filter(function(zt){var Jt,Un=S in zt.props?zt.props[S]:(Jt=zt.type.defaultProps)===null||Jt===void 0?void 0:Jt[S];return Un===xt}),dataStartIndex:I,dataEndIndex:B}),Je=gt.length,St,Nt,Ht;bse(be.domain,De,Ce)&&(St=wP(be.domain,null,De),te&&(Ce==="number"||Le!=="auto")&&(Ht=W_(gt,Re,"category")));var Ct=oU(Ce);if(!St||St.length===0){var Kt,Lt=(Kt=be.domain)!==null&&Kt!==void 0?Kt:Ct;if(Re){if(St=W_(gt,Re,Ce),Ce==="category"&&te){var et=E9(St);ve&&et?(Nt=St,St=J0(0,Je)):ve||(St=Kz(Lt,St,se).reduce(function(zt,Jt){return zt.indexOf(Jt)>=0?zt:[].concat(Tg(zt),[Jt])},[]))}else if(Ce==="category")ve?St=St.filter(function(zt){return zt!==""&&!ao(zt)}):St=Kz(Lt,St,se).reduce(function(zt,Jt){return zt.indexOf(Jt)>=0||Jt===""||ao(Jt)?zt:[].concat(Tg(zt),[Jt])},[]);else if(Ce==="number"){var vt=pee(gt,h.filter(function(zt){var Jt,Un,$n=S in zt.props?zt.props[S]:(Jt=zt.type.defaultProps)===null||Jt===void 0?void 0:Jt[S],Bn="hide"in zt.props?zt.props.hide:(Un=zt.type.defaultProps)===null||Un===void 0?void 0:Un.hide;return $n===xt&&(lt||!Bn)}),Re,v,$);vt&&(St=vt)}te&&(Ce==="number"||Le!=="auto")&&(Ht=W_(gt,Re,"category"))}else te?St=J0(0,Je):o&&o[xt]&&o[xt].hasStack&&Ce==="number"?St=K==="expand"?[0,1]:Z6(o[xt].stackGroups,I,B):St=V6(gt,h.filter(function(zt){var Jt=S in zt.props?zt.props[S]:zt.type.defaultProps[S],Un="hide"in zt.props?zt.props.hide:zt.type.defaultProps.hide;return Jt===xt&&(lt||!Un)}),Ce,$,!0);if(Ce==="number")St=iM(U,St,xt,v,Fe),Lt&&(St=wP(Lt,St,De));else if(Ce==="category"&&Lt){var Ot=Lt,mt=St.every(function(zt){return Ot.indexOf(zt)>=0});mt&&(St=Ot)}}return Mn(Mn({},le),{},Ci({},xt,Mn(Mn({},be),{},{axisType:v,domain:St,categoricalDomain:Ht,duplicateDomain:Nt,originalDomain:(ue=be.domain)!==null&&ue!==void 0?ue:Ct,isCategorical:te,layout:$})))},{})},Kse=function(t,i){var a=i.graphicalItems,h=i.Axis,v=i.axisType,S=i.axisIdKey,o=i.stackGroups,I=i.dataStartIndex,B=i.dataEndIndex,$=t.layout,U=t.children,K=s1(t.data,{graphicalItems:a,dataStartIndex:I,dataEndIndex:B}),te=K.length,le=q6($,v),se=-1;return a.reduce(function(ue,be){var Ce=be.type.defaultProps!==void 0?Mn(Mn({},be.type.defaultProps),be.props):be.props,Re=Ce[S],De=oU("number");if(!ue[Re]){se++;var ve;return le?ve=J0(0,te):o&&o[Re]&&o[Re].hasStack?(ve=Z6(o[Re].stackGroups,I,B),ve=iM(U,ve,Re,v)):(ve=wP(De,V6(K,a.filter(function(Le){var Fe,lt,xt=S in Le.props?Le.props[S]:(Fe=Le.type.defaultProps)===null||Fe===void 0?void 0:Fe[S],gt="hide"in Le.props?Le.props.hide:(lt=Le.type.defaultProps)===null||lt===void 0?void 0:lt.hide;return xt===Re&&!gt}),"number",$),h.defaultProps.allowDataOverflow),ve=iM(U,ve,Re,v)),Mn(Mn({},ue),{},Ci({},Re,Mn(Mn({axisType:v},h.defaultProps),{},{hide:!0,orientation:ic(Gse,"".concat(v,".").concat(se%2),null),domain:ve,originalDomain:De,isCategorical:le,layout:$})))}return ue},{})},Yse=function(t,i){var a=i.axisType,h=a===void 0?"xAxis":a,v=i.AxisComp,S=i.graphicalItems,o=i.stackGroups,I=i.dataStartIndex,B=i.dataEndIndex,$=t.children,U="".concat(h,"Id"),K=Hc($,v),te={};return K&&K.length?te=Xse(t,{axes:K,graphicalItems:S,axisType:h,axisIdKey:U,stackGroups:o,dataStartIndex:I,dataEndIndex:B}):S&&S.length&&(te=Kse(t,{Axis:v,graphicalItems:S,axisType:h,axisIdKey:U,stackGroups:o,dataStartIndex:I,dataEndIndex:B})),te},Jse=function(t){var i=$m(t),a=$p(i,!1,!0);return{tooltipTicks:a,orderedTooltipTicks:VM(a,function(h){return h.coordinate}),tooltipAxis:i,tooltipAxisBandSize:j0(i,a)}},WB=function(t){var i=t.children,a=t.defaultShowTooltip,h=tc(i,mg),v=0,S=0;return t.data&&t.data.length!==0&&(S=t.data.length-1),h&&h.props&&(h.props.startIndex>=0&&(v=h.props.startIndex),h.props.endIndex>=0&&(S=h.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:v,dataEndIndex:S,activeTooltipIndex:-1,isTooltipActive:!!a}},Qse=function(t){return!t||!t.length?!1:t.some(function(i){var a=Zf(i&&i.type);return a&&a.indexOf("Bar")>=0})},ZB=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},ele=function(t,i){var a=t.props,h=t.graphicalItems,v=t.xAxisMap,S=v===void 0?{}:v,o=t.yAxisMap,I=o===void 0?{}:o,B=a.width,$=a.height,U=a.children,K=a.margin||{},te=tc(U,mg),le=tc(U,Wc),se=Object.keys(I).reduce(function(ve,Le){var Fe=I[Le],lt=Fe.orientation;return!Fe.mirror&&!Fe.hide?Mn(Mn({},ve),{},Ci({},lt,ve[lt]+Fe.width)):ve},{left:K.left||0,right:K.right||0}),ue=Object.keys(S).reduce(function(ve,Le){var Fe=S[Le],lt=Fe.orientation;return!Fe.mirror&&!Fe.hide?Mn(Mn({},ve),{},Ci({},lt,ic(ve,"".concat(lt))+Fe.height)):ve},{top:K.top||0,bottom:K.bottom||0}),be=Mn(Mn({},ue),se),Ce=be.bottom;te&&(be.bottom+=te.props.height||mg.defaultProps.height),le&&i&&(be=fee(be,h,a,i));var Re=B-be.left-be.right,De=$-be.top-be.bottom;return Mn(Mn({brushBottom:Ce},be),{},{width:Math.max(Re,0),height:Math.max(De,0)})},tle=function(t,i){if(i==="xAxis")return t[i].width;if(i==="yAxis")return t[i].height},aU=function(t){var i=t.chartName,a=t.GraphicalChild,h=t.defaultTooltipEventType,v=h===void 0?"axis":h,S=t.validateTooltipEventTypes,o=S===void 0?["axis"]:S,I=t.axisComponents,B=t.legendContent,$=t.formatAxisMap,U=t.defaultProps,K=function(be,Ce){var Re=Ce.graphicalItems,De=Ce.stackGroups,ve=Ce.offset,Le=Ce.updateId,Fe=Ce.dataStartIndex,lt=Ce.dataEndIndex,xt=be.barSize,gt=be.layout,Je=be.barGap,St=be.barCategoryGap,Nt=be.maxBarSize,Ht=ZB(gt),Ct=Ht.numericAxisName,Kt=Ht.cateAxisName,Lt=Qse(Re),et=[];return Re.forEach(function(vt,Ot){var mt=s1(be.data,{graphicalItems:[vt],dataStartIndex:Fe,dataEndIndex:lt}),zt=vt.type.defaultProps!==void 0?Mn(Mn({},vt.type.defaultProps),vt.props):vt.props,Jt=zt.dataKey,Un=zt.maxBarSize,$n=zt["".concat(Ct,"Id")],Bn=zt["".concat(Kt,"Id")],$r={},_r=I.reduce(function(ii,Pi){var yi=Ce["".concat(Pi.axisType,"Map")],lr=zt["".concat(Pi.axisType,"Id")];yi&&yi[lr]||Pi.axisType==="zAxis"||em();var qo=yi[lr];return Mn(Mn({},ii),{},Ci(Ci({},Pi.axisType,qo),"".concat(Pi.axisType,"Ticks"),$p(qo)))},$r),Pn=_r[Kt],Ke=_r["".concat(Kt,"Ticks")],mr=De&&De[$n]&&De[$n].hasStack&&See(vt,De[$n].stackGroups),Sn=Zf(vt.type).indexOf("Bar")>=0,Dr=j0(Pn,Ke),Yt=[],Mr=Lt&&cee({barSize:xt,stackGroups:De,totalSize:tle(_r,Kt)});if(Sn){var Qn,Ar,sr=ao(Un)?Nt:Un,_i=(Qn=(Ar=j0(Pn,Ke,!0))!==null&&Ar!==void 0?Ar:sr)!==null&&Qn!==void 0?Qn:0;Yt=hee({barGap:Je,barCategoryGap:St,bandSize:_i!==Dr?_i:Dr,sizeList:Mr[Bn],maxBarSize:sr}),_i!==Dr&&(Yt=Yt.map(function(ii){return Mn(Mn({},ii),{},{position:Mn(Mn({},ii.position),{},{offset:ii.position.offset-_i/2})})}))}var Wi=vt&&vt.type&&vt.type.getComposedData;Wi&&et.push({props:Mn(Mn({},Wi(Mn(Mn({},_r),{},{displayedData:mt,props:be,dataKey:Jt,item:vt,bandSize:Dr,barPosition:Yt,offset:ve,stackedData:mr,layout:gt,dataStartIndex:Fe,dataEndIndex:lt}))),{},Ci(Ci(Ci({key:vt.key||"item-".concat(Ot)},Ct,_r[Ct]),Kt,_r[Kt]),"animationId",Le)),childIndex:z9(vt,be.children),item:vt})}),et},te=function(be,Ce){var Re=be.props,De=be.dataStartIndex,ve=be.dataEndIndex,Le=be.updateId;if(!hR({props:Re}))return null;var Fe=Re.children,lt=Re.layout,xt=Re.stackOffset,gt=Re.data,Je=Re.reverseStackOrder,St=ZB(lt),Nt=St.numericAxisName,Ht=St.cateAxisName,Ct=Hc(Fe,a),Kt=bee(gt,Ct,"".concat(Nt,"Id"),"".concat(Ht,"Id"),xt,Je),Lt=I.reduce(function(zt,Jt){var Un="".concat(Jt.axisType,"Map");return Mn(Mn({},zt),{},Ci({},Un,Yse(Re,Mn(Mn({},Jt),{},{graphicalItems:Ct,stackGroups:Jt.axisType===Nt&&Kt,dataStartIndex:De,dataEndIndex:ve}))))},{}),et=ele(Mn(Mn({},Lt),{},{props:Re,graphicalItems:Ct}),Ce==null?void 0:Ce.legendBBox);Object.keys(Lt).forEach(function(zt){Lt[zt]=$(Re,Lt[zt],et,zt.replace("Map",""),i)});var vt=Lt["".concat(Ht,"Map")],Ot=Jse(vt),mt=K(Re,Mn(Mn({},Lt),{},{dataStartIndex:De,dataEndIndex:ve,updateId:Le,graphicalItems:Ct,stackGroups:Kt,offset:et}));return Mn(Mn({formattedGraphicalItems:mt,graphicalItems:Ct,offset:et,stackGroups:Kt},Ot),Lt)},le=function(ue){function be(Ce){var Re,De,ve;return Lse(this,be),ve=Fse(this,be,[Ce]),Ci(ve,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ci(ve,"accessibilityManager",new xse),Ci(ve,"handleLegendBBoxUpdate",function(Le){if(Le){var Fe=ve.state,lt=Fe.dataStartIndex,xt=Fe.dataEndIndex,gt=Fe.updateId;ve.setState(Mn({legendBBox:Le},te({props:ve.props,dataStartIndex:lt,dataEndIndex:xt,updateId:gt},Mn(Mn({},ve.state),{},{legendBBox:Le}))))}}),Ci(ve,"handleReceiveSyncEvent",function(Le,Fe,lt){if(ve.props.syncId===Le){if(lt===ve.eventEmitterSymbol&&typeof ve.props.syncMethod!="function")return;ve.applySyncEvent(Fe)}}),Ci(ve,"handleBrushChange",function(Le){var Fe=Le.startIndex,lt=Le.endIndex;if(Fe!==ve.state.dataStartIndex||lt!==ve.state.dataEndIndex){var xt=ve.state.updateId;ve.setState(function(){return Mn({dataStartIndex:Fe,dataEndIndex:lt},te({props:ve.props,dataStartIndex:Fe,dataEndIndex:lt,updateId:xt},ve.state))}),ve.triggerSyncEvent({dataStartIndex:Fe,dataEndIndex:lt})}}),Ci(ve,"handleMouseEnter",function(Le){var Fe=ve.getMouseInfo(Le);if(Fe){var lt=Mn(Mn({},Fe),{},{isTooltipActive:!0});ve.setState(lt),ve.triggerSyncEvent(lt);var xt=ve.props.onMouseEnter;Hi(xt)&&xt(lt,Le)}}),Ci(ve,"triggeredAfterMouseMove",function(Le){var Fe=ve.getMouseInfo(Le),lt=Fe?Mn(Mn({},Fe),{},{isTooltipActive:!0}):{isTooltipActive:!1};ve.setState(lt),ve.triggerSyncEvent(lt);var xt=ve.props.onMouseMove;Hi(xt)&&xt(lt,Le)}),Ci(ve,"handleItemMouseEnter",function(Le){ve.setState(function(){return{isTooltipActive:!0,activeItem:Le,activePayload:Le.tooltipPayload,activeCoordinate:Le.tooltipPosition||{x:Le.cx,y:Le.cy}}})}),Ci(ve,"handleItemMouseLeave",function(){ve.setState(function(){return{isTooltipActive:!1}})}),Ci(ve,"handleMouseMove",function(Le){Le.persist(),ve.throttleTriggeredAfterMouseMove(Le)}),Ci(ve,"handleMouseLeave",function(Le){ve.throttleTriggeredAfterMouseMove.cancel();var Fe={isTooltipActive:!1};ve.setState(Fe),ve.triggerSyncEvent(Fe);var lt=ve.props.onMouseLeave;Hi(lt)&&lt(Fe,Le)}),Ci(ve,"handleOuterEvent",function(Le){var Fe=D9(Le),lt=ic(ve.props,"".concat(Fe));if(Fe&&Hi(lt)){var xt,gt;/.*touch.*/i.test(Fe)?gt=ve.getMouseInfo(Le.changedTouches[0]):gt=ve.getMouseInfo(Le),lt((xt=gt)!==null&&xt!==void 0?xt:{},Le)}}),Ci(ve,"handleClick",function(Le){var Fe=ve.getMouseInfo(Le);if(Fe){var lt=Mn(Mn({},Fe),{},{isTooltipActive:!0});ve.setState(lt),ve.triggerSyncEvent(lt);var xt=ve.props.onClick;Hi(xt)&&xt(lt,Le)}}),Ci(ve,"handleMouseDown",function(Le){var Fe=ve.props.onMouseDown;if(Hi(Fe)){var lt=ve.getMouseInfo(Le);Fe(lt,Le)}}),Ci(ve,"handleMouseUp",function(Le){var Fe=ve.props.onMouseUp;if(Hi(Fe)){var lt=ve.getMouseInfo(Le);Fe(lt,Le)}}),Ci(ve,"handleTouchMove",function(Le){Le.changedTouches!=null&&Le.changedTouches.length>0&&ve.throttleTriggeredAfterMouseMove(Le.changedTouches[0])}),Ci(ve,"handleTouchStart",function(Le){Le.changedTouches!=null&&Le.changedTouches.length>0&&ve.handleMouseDown(Le.changedTouches[0])}),Ci(ve,"handleTouchEnd",function(Le){Le.changedTouches!=null&&Le.changedTouches.length>0&&ve.handleMouseUp(Le.changedTouches[0])}),Ci(ve,"triggerSyncEvent",function(Le){ve.props.syncId!==void 0&&IT.emit(CT,ve.props.syncId,Le,ve.eventEmitterSymbol)}),Ci(ve,"applySyncEvent",function(Le){var Fe=ve.props,lt=Fe.layout,xt=Fe.syncMethod,gt=ve.state.updateId,Je=Le.dataStartIndex,St=Le.dataEndIndex;if(Le.dataStartIndex!==void 0||Le.dataEndIndex!==void 0)ve.setState(Mn({dataStartIndex:Je,dataEndIndex:St},te({props:ve.props,dataStartIndex:Je,dataEndIndex:St,updateId:gt},ve.state)));else if(Le.activeTooltipIndex!==void 0){var Nt=Le.chartX,Ht=Le.chartY,Ct=Le.activeTooltipIndex,Kt=ve.state,Lt=Kt.offset,et=Kt.tooltipTicks;if(!Lt)return;if(typeof xt=="function")Ct=xt(et,Le);else if(xt==="value"){Ct=-1;for(var vt=0;vt<et.length;vt++)if(et[vt].value===Le.activeLabel){Ct=vt;break}}var Ot=Mn(Mn({},Lt),{},{x:Lt.left,y:Lt.top}),mt=Math.min(Nt,Ot.x+Ot.width),zt=Math.min(Ht,Ot.y+Ot.height),Jt=et[Ct]&&et[Ct].value,Un=sM(ve.state,ve.props.data,Ct),$n=et[Ct]?{x:lt==="horizontal"?et[Ct].coordinate:mt,y:lt==="horizontal"?zt:et[Ct].coordinate}:iU;ve.setState(Mn(Mn({},Le),{},{activeLabel:Jt,activeCoordinate:$n,activePayload:Un,activeTooltipIndex:Ct}))}else ve.setState(Le)}),Ci(ve,"renderCursor",function(Le){var Fe,lt=ve.state,xt=lt.isTooltipActive,gt=lt.activeCoordinate,Je=lt.activePayload,St=lt.offset,Nt=lt.activeTooltipIndex,Ht=lt.tooltipAxisBandSize,Ct=ve.getTooltipEventType(),Kt=(Fe=Le.props.active)!==null&&Fe!==void 0?Fe:xt,Lt=ve.props.layout,et=Le.key||"_recharts-cursor";return Bt.createElement(Pse,{key:et,activeCoordinate:gt,activePayload:Je,activeTooltipIndex:Nt,chartName:i,element:Le,isActive:Kt,layout:Lt,offset:St,tooltipAxisBandSize:Ht,tooltipEventType:Ct})}),Ci(ve,"renderPolarAxis",function(Le,Fe,lt){var xt=ic(Le,"type.axisType"),gt=ic(ve.state,"".concat(xt,"Map")),Je=Le.type.defaultProps,St=Je!==void 0?Mn(Mn({},Je),Le.props):Le.props,Nt=gt&&gt[St["".concat(xt,"Id")]];return rt.cloneElement(Le,Mn(Mn({},Nt),{},{className:to(xt,Nt.className),key:Le.key||"".concat(Fe,"-").concat(lt),ticks:$p(Nt,!0)}))}),Ci(ve,"renderPolarGrid",function(Le){var Fe=Le.props,lt=Fe.radialLines,xt=Fe.polarAngles,gt=Fe.polarRadius,Je=ve.state,St=Je.radiusAxisMap,Nt=Je.angleAxisMap,Ht=$m(St),Ct=$m(Nt),Kt=Ct.cx,Lt=Ct.cy,et=Ct.innerRadius,vt=Ct.outerRadius;return rt.cloneElement(Le,{polarAngles:Array.isArray(xt)?xt:$p(Ct,!0).map(function(Ot){return Ot.coordinate}),polarRadius:Array.isArray(gt)?gt:$p(Ht,!0).map(function(Ot){return Ot.coordinate}),cx:Kt,cy:Lt,innerRadius:et,outerRadius:vt,key:Le.key||"polar-grid",radialLines:lt})}),Ci(ve,"renderLegend",function(){var Le=ve.state.formattedGraphicalItems,Fe=ve.props,lt=Fe.children,xt=Fe.width,gt=Fe.height,Je=ve.props.margin||{},St=xt-(Je.left||0)-(Je.right||0),Nt=$6({children:lt,formattedGraphicalItems:Le,legendWidth:St,legendContent:B});if(!Nt)return null;var Ht=Nt.item,Ct=qB(Nt,Mse);return rt.cloneElement(Ht,Mn(Mn({},Ct),{},{chartWidth:xt,chartHeight:gt,margin:Je,onBBoxUpdate:ve.handleLegendBBoxUpdate}))}),Ci(ve,"renderTooltip",function(){var Le,Fe=ve.props,lt=Fe.children,xt=Fe.accessibilityLayer,gt=tc(lt,Cu);if(!gt)return null;var Je=ve.state,St=Je.isTooltipActive,Nt=Je.activeCoordinate,Ht=Je.activePayload,Ct=Je.activeLabel,Kt=Je.offset,Lt=(Le=gt.props.active)!==null&&Le!==void 0?Le:St;return rt.cloneElement(gt,{viewBox:Mn(Mn({},Kt),{},{x:Kt.left,y:Kt.top}),active:Lt,label:Ct,payload:Lt?Ht:[],coordinate:Nt,accessibilityLayer:xt})}),Ci(ve,"renderBrush",function(Le){var Fe=ve.props,lt=Fe.margin,xt=Fe.data,gt=ve.state,Je=gt.offset,St=gt.dataStartIndex,Nt=gt.dataEndIndex,Ht=gt.updateId;return rt.cloneElement(Le,{key:Le.key||"_recharts-brush",onChange:e0(ve.handleBrushChange,Le.props.onChange),data:xt,x:gr(Le.props.x)?Le.props.x:Je.left,y:gr(Le.props.y)?Le.props.y:Je.top+Je.height+Je.brushBottom-(lt.bottom||0),width:gr(Le.props.width)?Le.props.width:Je.width,startIndex:St,endIndex:Nt,updateId:"brush-".concat(Ht)})}),Ci(ve,"renderReferenceElement",function(Le,Fe,lt){if(!Le)return null;var xt=ve,gt=xt.clipPathId,Je=ve.state,St=Je.xAxisMap,Nt=Je.yAxisMap,Ht=Je.offset,Ct=Le.type.defaultProps||{},Kt=Le.props,Lt=Kt.xAxisId,et=Lt===void 0?Ct.xAxisId:Lt,vt=Kt.yAxisId,Ot=vt===void 0?Ct.yAxisId:vt;return rt.cloneElement(Le,{key:Le.key||"".concat(Fe,"-").concat(lt),xAxis:St[et],yAxis:Nt[Ot],viewBox:{x:Ht.left,y:Ht.top,width:Ht.width,height:Ht.height},clipPathId:gt})}),Ci(ve,"renderActivePoints",function(Le){var Fe=Le.item,lt=Le.activePoint,xt=Le.basePoint,gt=Le.childIndex,Je=Le.isRange,St=[],Nt=Fe.props.key,Ht=Fe.item.type.defaultProps!==void 0?Mn(Mn({},Fe.item.type.defaultProps),Fe.item.props):Fe.item.props,Ct=Ht.activeDot,Kt=Ht.dataKey,Lt=Mn(Mn({index:gt,dataKey:Kt,cx:lt.x,cy:lt.y,r:4,fill:mI(Fe.item),strokeWidth:2,stroke:"#fff",payload:lt.payload,value:lt.value},ki(Ct,!1)),g0(Ct));return St.push(be.renderActiveDot(Ct,Lt,"".concat(Nt,"-activePoint-").concat(gt))),xt?St.push(be.renderActiveDot(Ct,Mn(Mn({},Lt),{},{cx:xt.x,cy:xt.y}),"".concat(Nt,"-basePoint-").concat(gt))):Je&&St.push(null),St}),Ci(ve,"renderGraphicChild",function(Le,Fe,lt){var xt=ve.filterFormatItem(Le,Fe,lt);if(!xt)return null;var gt=ve.getTooltipEventType(),Je=ve.state,St=Je.isTooltipActive,Nt=Je.tooltipAxis,Ht=Je.activeTooltipIndex,Ct=Je.activeLabel,Kt=ve.props.children,Lt=tc(Kt,Cu),et=xt.props,vt=et.points,Ot=et.isRange,mt=et.baseLine,zt=xt.item.type.defaultProps!==void 0?Mn(Mn({},xt.item.type.defaultProps),xt.item.props):xt.item.props,Jt=zt.activeDot,Un=zt.hide,$n=zt.activeBar,Bn=zt.activeShape,$r=!!(!Un&&St&&Lt&&(Jt||$n||Bn)),_r={};gt!=="axis"&&Lt&&Lt.props.trigger==="click"?_r={onClick:e0(ve.handleItemMouseEnter,Le.props.onClick)}:gt!=="axis"&&(_r={onMouseLeave:e0(ve.handleItemMouseLeave,Le.props.onMouseLeave),onMouseEnter:e0(ve.handleItemMouseEnter,Le.props.onMouseEnter)});var Pn=rt.cloneElement(Le,Mn(Mn({},xt.props),_r));function Ke(Pi){return typeof Nt.dataKey=="function"?Nt.dataKey(Pi.payload):null}if($r)if(Ht>=0){var mr,Sn;if(Nt.dataKey&&!Nt.allowDuplicatedCategory){var Dr=typeof Nt.dataKey=="function"?Ke:"payload.".concat(Nt.dataKey.toString());mr=$A(vt,Dr,Ct),Sn=Ot&&mt&&$A(mt,Dr,Ct)}else mr=vt==null?void 0:vt[Ht],Sn=Ot&&mt&&mt[Ht];if(Bn||$n){var Yt=Le.props.activeIndex!==void 0?Le.props.activeIndex:Ht;return[rt.cloneElement(Le,Mn(Mn(Mn({},xt.props),_r),{},{activeIndex:Yt})),null,null]}if(!ao(mr))return[Pn].concat(Tg(ve.renderActivePoints({item:xt,activePoint:mr,basePoint:Sn,childIndex:Ht,isRange:Ot})))}else{var Mr,Qn=(Mr=ve.getItemByXY(ve.state.activeCoordinate))!==null&&Mr!==void 0?Mr:{graphicalItem:Pn},Ar=Qn.graphicalItem,sr=Ar.item,_i=sr===void 0?Le:sr,Wi=Ar.childIndex,ii=Mn(Mn(Mn({},xt.props),_r),{},{activeIndex:Wi});return[rt.cloneElement(_i,ii),null,null]}return Ot?[Pn,null,null]:[Pn,null]}),Ci(ve,"renderCustomized",function(Le,Fe,lt){return rt.cloneElement(Le,Mn(Mn({key:"recharts-customized-".concat(lt)},ve.props),ve.state))}),Ci(ve,"renderMap",{CartesianGrid:{handler:o0,once:!0},ReferenceArea:{handler:ve.renderReferenceElement},ReferenceLine:{handler:o0},ReferenceDot:{handler:ve.renderReferenceElement},XAxis:{handler:o0},YAxis:{handler:o0},Brush:{handler:ve.renderBrush,once:!0},Bar:{handler:ve.renderGraphicChild},Line:{handler:ve.renderGraphicChild},Area:{handler:ve.renderGraphicChild},Radar:{handler:ve.renderGraphicChild},RadialBar:{handler:ve.renderGraphicChild},Scatter:{handler:ve.renderGraphicChild},Pie:{handler:ve.renderGraphicChild},Funnel:{handler:ve.renderGraphicChild},Tooltip:{handler:ve.renderCursor,once:!0},PolarGrid:{handler:ve.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ve.renderPolarAxis},PolarRadiusAxis:{handler:ve.renderPolarAxis},Customized:{handler:ve.renderCustomized}}),ve.clipPathId="".concat((Re=Ce.id)!==null&&Re!==void 0?Re:qy("recharts"),"-clip"),ve.throttleTriggeredAfterMouseMove=jj(ve.triggeredAfterMouseMove,(De=Ce.throttleDelay)!==null&&De!==void 0?De:1e3/60),ve.state={},ve}return jse(be,ue),zse(be,[{key:"componentDidMount",value:function(){var Re,De;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(Re=this.props.margin.left)!==null&&Re!==void 0?Re:0,top:(De=this.props.margin.top)!==null&&De!==void 0?De:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var Re=this.props,De=Re.children,ve=Re.data,Le=Re.height,Fe=Re.layout,lt=tc(De,Cu);if(lt){var xt=lt.props.defaultIndex;if(!(typeof xt!="number"||xt<0||xt>this.state.tooltipTicks.length-1)){var gt=this.state.tooltipTicks[xt]&&this.state.tooltipTicks[xt].value,Je=sM(this.state,ve,xt,gt),St=this.state.tooltipTicks[xt].coordinate,Nt=(this.state.offset.top+Le)/2,Ht=Fe==="horizontal",Ct=Ht?{x:St,y:Nt}:{y:St,x:Nt},Kt=this.state.formattedGraphicalItems.find(function(et){var vt=et.item;return vt.type.name==="Scatter"});Kt&&(Ct=Mn(Mn({},Ct),Kt.props.points[xt].tooltipPosition),Je=Kt.props.points[xt].tooltipPayload);var Lt={activeTooltipIndex:xt,isTooltipActive:!0,activeLabel:gt,activePayload:Je,activeCoordinate:Ct};this.setState(Lt),this.renderCursor(lt),this.accessibilityManager.setIndex(xt)}}}},{key:"getSnapshotBeforeUpdate",value:function(Re,De){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==De.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==Re.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==Re.margin){var ve,Le;this.accessibilityManager.setDetails({offset:{left:(ve=this.props.margin.left)!==null&&ve!==void 0?ve:0,top:(Le=this.props.margin.top)!==null&&Le!==void 0?Le:0}})}return null}},{key:"componentDidUpdate",value:function(Re){VA([tc(Re.children,Cu)],[tc(this.props.children,Cu)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var Re=tc(this.props.children,Cu);if(Re&&typeof Re.props.shared=="boolean"){var De=Re.props.shared?"axis":"item";return o.indexOf(De)>=0?De:v}return v}},{key:"getMouseInfo",value:function(Re){if(!this.container)return null;var De=this.container,ve=De.getBoundingClientRect(),Le=tK(ve),Fe={chartX:Math.round(Re.pageX-Le.left),chartY:Math.round(Re.pageY-Le.top)},lt=ve.width/De.offsetWidth||1,xt=this.inRange(Fe.chartX,Fe.chartY,lt);if(!xt)return null;var gt=this.state,Je=gt.xAxisMap,St=gt.yAxisMap,Nt=this.getTooltipEventType();if(Nt!=="axis"&&Je&&St){var Ht=$m(Je).scale,Ct=$m(St).scale,Kt=Ht&&Ht.invert?Ht.invert(Fe.chartX):null,Lt=Ct&&Ct.invert?Ct.invert(Fe.chartY):null;return Mn(Mn({},Fe),{},{xValue:Kt,yValue:Lt})}var et=HB(this.state,this.props.data,this.props.layout,xt);return et?Mn(Mn({},Fe),et):null}},{key:"inRange",value:function(Re,De){var ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Le=this.props.layout,Fe=Re/ve,lt=De/ve;if(Le==="horizontal"||Le==="vertical"){var xt=this.state.offset,gt=Fe>=xt.left&&Fe<=xt.left+xt.width&&lt>=xt.top&&lt<=xt.top+xt.height;return gt?{x:Fe,y:lt}:null}var Je=this.state,St=Je.angleAxisMap,Nt=Je.radiusAxisMap;if(St&&Nt){var Ht=$m(St);return Qz({x:Fe,y:lt},Ht)}return null}},{key:"parseEventsOfWrapper",value:function(){var Re=this.props.children,De=this.getTooltipEventType(),ve=tc(Re,Cu),Le={};ve&&De==="axis"&&(ve.props.trigger==="click"?Le={onClick:this.handleClick}:Le={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var Fe=g0(this.props,this.handleOuterEvent);return Mn(Mn({},Fe),Le)}},{key:"addListener",value:function(){IT.on(CT,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){IT.removeListener(CT,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(Re,De,ve){for(var Le=this.state.formattedGraphicalItems,Fe=0,lt=Le.length;Fe<lt;Fe++){var xt=Le[Fe];if(xt.item===Re||xt.props.key===Re.key||De===Zf(xt.item.type)&&ve===xt.childIndex)return xt}return null}},{key:"renderClipPath",value:function(){var Re=this.clipPathId,De=this.state.offset,ve=De.left,Le=De.top,Fe=De.height,lt=De.width;return Bt.createElement("defs",null,Bt.createElement("clipPath",{id:Re},Bt.createElement("rect",{x:ve,y:Le,height:Fe,width:lt})))}},{key:"getXScales",value:function(){var Re=this.state.xAxisMap;return Re?Object.entries(Re).reduce(function(De,ve){var Le=VB(ve,2),Fe=Le[0],lt=Le[1];return Mn(Mn({},De),{},Ci({},Fe,lt.scale))},{}):null}},{key:"getYScales",value:function(){var Re=this.state.yAxisMap;return Re?Object.entries(Re).reduce(function(De,ve){var Le=VB(ve,2),Fe=Le[0],lt=Le[1];return Mn(Mn({},De),{},Ci({},Fe,lt.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(Re){var De;return(De=this.state.xAxisMap)===null||De===void 0||(De=De[Re])===null||De===void 0?void 0:De.scale}},{key:"getYScaleByAxisId",value:function(Re){var De;return(De=this.state.yAxisMap)===null||De===void 0||(De=De[Re])===null||De===void 0?void 0:De.scale}},{key:"getItemByXY",value:function(Re){var De=this.state,ve=De.formattedGraphicalItems,Le=De.activeItem;if(ve&&ve.length)for(var Fe=0,lt=ve.length;Fe<lt;Fe++){var xt=ve[Fe],gt=xt.props,Je=xt.item,St=Je.type.defaultProps!==void 0?Mn(Mn({},Je.type.defaultProps),Je.props):Je.props,Nt=Zf(Je.type);if(Nt==="Bar"){var Ht=(gt.data||[]).find(function(et){return sre(Re,et)});if(Ht)return{graphicalItem:xt,payload:Ht}}else if(Nt==="RadialBar"){var Ct=(gt.data||[]).find(function(et){return Qz(Re,et)});if(Ct)return{graphicalItem:xt,payload:Ct}}else if(Qx(xt,Le)||e1(xt,Le)||My(xt,Le)){var Kt=Mie({graphicalItem:xt,activeTooltipItem:Le,itemData:St.data}),Lt=St.activeIndex===void 0?Kt:St.activeIndex;return{graphicalItem:Mn(Mn({},xt),{},{childIndex:Lt}),payload:My(xt,Le)?St.data[Kt]:xt.props.data[Kt]}}}return null}},{key:"render",value:function(){var Re=this;if(!hR(this))return null;var De=this.props,ve=De.children,Le=De.className,Fe=De.width,lt=De.height,xt=De.style,gt=De.compact,Je=De.title,St=De.desc,Nt=qB(De,Ise),Ht=ki(Nt,!1);if(gt)return Bt.createElement(IB,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Bt.createElement(GA,Zm({},Ht,{width:Fe,height:lt,title:Je,desc:St}),this.renderClipPath(),dR(ve,this.renderMap)));if(this.props.accessibilityLayer){var Ct,Kt;Ht.tabIndex=(Ct=this.props.tabIndex)!==null&&Ct!==void 0?Ct:0,Ht.role=(Kt=this.props.role)!==null&&Kt!==void 0?Kt:"application",Ht.onKeyDown=function(et){Re.accessibilityManager.keyboardEvent(et)},Ht.onFocus=function(){Re.accessibilityManager.focus()}}var Lt=this.parseEventsOfWrapper();return Bt.createElement(IB,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Bt.createElement("div",Zm({className:to("recharts-wrapper",Le),style:Mn({position:"relative",cursor:"default",width:Fe,height:lt},xt)},Lt,{ref:function(vt){Re.container=vt}}),Bt.createElement(GA,Zm({},Ht,{width:Fe,height:lt,title:Je,desc:St,style:Hse}),this.renderClipPath(),dR(ve,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(rt.Component);Ci(le,"displayName",i),Ci(le,"defaultProps",Mn({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},U)),Ci(le,"getDerivedStateFromProps",function(ue,be){var Ce=ue.dataKey,Re=ue.data,De=ue.children,ve=ue.width,Le=ue.height,Fe=ue.layout,lt=ue.stackOffset,xt=ue.margin,gt=be.dataStartIndex,Je=be.dataEndIndex;if(be.updateId===void 0){var St=WB(ue);return Mn(Mn(Mn({},St),{},{updateId:0},te(Mn(Mn({props:ue},St),{},{updateId:0}),be)),{},{prevDataKey:Ce,prevData:Re,prevWidth:ve,prevHeight:Le,prevLayout:Fe,prevStackOffset:lt,prevMargin:xt,prevChildren:De})}if(Ce!==be.prevDataKey||Re!==be.prevData||ve!==be.prevWidth||Le!==be.prevHeight||Fe!==be.prevLayout||lt!==be.prevStackOffset||!Km(xt,be.prevMargin)){var Nt=WB(ue),Ht={chartX:be.chartX,chartY:be.chartY,isTooltipActive:be.isTooltipActive},Ct=Mn(Mn({},HB(be,Re,Fe)),{},{updateId:be.updateId+1}),Kt=Mn(Mn(Mn({},Nt),Ht),Ct);return Mn(Mn(Mn({},Kt),te(Mn({props:ue},Kt),be)),{},{prevDataKey:Ce,prevData:Re,prevWidth:ve,prevHeight:Le,prevLayout:Fe,prevStackOffset:lt,prevMargin:xt,prevChildren:De})}if(!VA(De,be.prevChildren)){var Lt,et,vt,Ot,mt=tc(De,mg),zt=mt&&(Lt=(et=mt.props)===null||et===void 0?void 0:et.startIndex)!==null&&Lt!==void 0?Lt:gt,Jt=mt&&(vt=(Ot=mt.props)===null||Ot===void 0?void 0:Ot.endIndex)!==null&&vt!==void 0?vt:Je,Un=zt!==gt||Jt!==Je,$n=!ao(Re),Bn=$n&&!Un?be.updateId:be.updateId+1;return Mn(Mn({updateId:Bn},te(Mn(Mn({props:ue},be),{},{updateId:Bn,dataStartIndex:zt,dataEndIndex:Jt}),be)),{},{prevChildren:De,dataStartIndex:zt,dataEndIndex:Jt})}return null}),Ci(le,"renderActiveDot",function(ue,be,Ce){var Re;return rt.isValidElement(ue)?Re=rt.cloneElement(ue,be):Hi(ue)?Re=ue(be):Re=Bt.createElement(yI,be),Bt.createElement(Qo,{className:"recharts-active-dot",key:Ce},Re)});var se=rt.forwardRef(function(be,Ce){return Bt.createElement(le,Zm({},be,{ref:Ce}))});return se.displayName=le.displayName,se},c0=aU({chartName:"BarChart",GraphicalChild:qc,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Gp},{axisType:"yAxis",AxisComp:Hp}],formatAxisMap:Coe}),nle=aU({chartName:"PieChart",GraphicalChild:od,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Yx},{axisType:"radiusAxis",AxisComp:Xx}],formatAxisMap:Ree,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),kT,XB;function sU(){if(XB)return kT;XB=1;function e(t,i){for(var a=-1,h=t==null?0:t.length;++a<h&&i(t[a],a,t)!==!1;);return t}return kT=e,kT}var RT,KB;function l1(){if(KB)return RT;KB=1;var e=Jy(),t=Og(),i=Object.prototype,a=i.hasOwnProperty;function h(v,S,o){var I=v[S];(!(a.call(v,S)&&t(I,o))||o===void 0&&!(S in v))&&e(v,S,o)}return RT=h,RT}var LT,YB;function hf(){if(YB)return LT;YB=1;var e=l1(),t=Jy();function i(a,h,v,S){var o=!v;v||(v={});for(var I=-1,B=h.length;++I<B;){var $=h[I],U=S?S(v[$],a[$],$,v,a):void 0;U===void 0&&(U=a[$]),o?t(v,$,U):e(v,$,U)}return v}return LT=i,LT}var DT,JB;function lU(){if(JB)return DT;JB=1;var e=hf(),t=oc();function i(a,h){return a&&e(h,t(h),a)}return DT=i,DT}var zT,QB;function rle(){if(QB)return zT;QB=1;function e(t){var i=[];if(t!=null)for(var a in Object(t))i.push(a);return i}return zT=e,zT}var FT,e4;function ile(){if(e4)return FT;e4=1;var e=jl(),t=kx(),i=rle(),a=Object.prototype,h=a.hasOwnProperty;function v(S){if(!e(S))return i(S);var o=t(S),I=[];for(var B in S)B=="constructor"&&(o||!h.call(S,B))||I.push(B);return I}return FT=v,FT}var BT,t4;function ku(){if(t4)return BT;t4=1;var e=yj(),t=ile(),i=Kd();function a(h){return i(h)?e(h,!0):t(h)}return BT=a,BT}var NT,n4;function ole(){if(n4)return NT;n4=1;var e=hf(),t=ku();function i(a,h){return a&&e(h,t(h),a)}return NT=i,NT}var $_={exports:{}};$_.exports;var r4;function uU(){return r4||(r4=1,function(e,t){var i=Lh(),a=t&&!t.nodeType&&t,h=a&&!0&&e&&!e.nodeType&&e,v=h&&h.exports===a,S=v?i.Buffer:void 0,o=S?S.allocUnsafe:void 0;function I(B,$){if($)return B.slice();var U=B.length,K=o?o(U):new B.constructor(U);return B.copy(K),K}e.exports=I}($_,$_.exports)),$_.exports}var jT,i4;function cU(){if(i4)return jT;i4=1;function e(t,i){var a=-1,h=t.length;for(i||(i=Array(h));++a<h;)i[a]=t[a];return i}return jT=e,jT}var $T,o4;function ale(){if(o4)return $T;o4=1;var e=hf(),t=LM();function i(a,h){return e(a,t(a),h)}return $T=i,$T}var UT,a4;function hU(){if(a4)return UT;a4=1;var e=RM(),t=Jx(),i=LM(),a=_j(),h=Object.getOwnPropertySymbols,v=h?function(S){for(var o=[];S;)e(o,i(S)),S=t(S);return o}:a;return UT=v,UT}var VT,s4;function sle(){if(s4)return VT;s4=1;var e=hf(),t=hU();function i(a,h){return e(a,t(a),h)}return VT=i,VT}var qT,l4;function SI(){if(l4)return qT;l4=1;var e=mj(),t=hU(),i=ku();function a(h){return e(h,i,t)}return qT=a,qT}var GT,u4;function lle(){if(u4)return GT;u4=1;var e=Object.prototype,t=e.hasOwnProperty;function i(a){var h=a.length,v=new a.constructor(h);return h&&typeof a[0]=="string"&&t.call(a,"index")&&(v.index=a.index,v.input=a.input),v}return GT=i,GT}var HT,c4;function TI(){if(c4)return HT;c4=1;var e=dj();function t(i){var a=new i.constructor(i.byteLength);return new e(a).set(new e(i)),a}return HT=t,HT}var WT,h4;function ule(){if(h4)return WT;h4=1;var e=TI();function t(i,a){var h=a?e(i.buffer):i.buffer;return new i.constructor(h,i.byteOffset,i.byteLength)}return WT=t,WT}var ZT,f4;function cle(){if(f4)return ZT;f4=1;var e=/\w*$/;function t(i){var a=new i.constructor(i.source,e.exec(i));return a.lastIndex=i.lastIndex,a}return ZT=t,ZT}var XT,d4;function hle(){if(d4)return XT;d4=1;var e=Ig(),t=e?e.prototype:void 0,i=t?t.valueOf:void 0;function a(h){return i?Object(i.call(h)):{}}return XT=a,XT}var KT,p4;function fU(){if(p4)return KT;p4=1;var e=TI();function t(i,a){var h=a?e(i.buffer):i.buffer;return new i.constructor(h,i.byteOffset,i.length)}return KT=t,KT}var YT,m4;function fle(){if(m4)return YT;m4=1;var e=TI(),t=ule(),i=cle(),a=hle(),h=fU(),v="[object Boolean]",S="[object Date]",o="[object Map]",I="[object Number]",B="[object RegExp]",$="[object Set]",U="[object String]",K="[object Symbol]",te="[object ArrayBuffer]",le="[object DataView]",se="[object Float32Array]",ue="[object Float64Array]",be="[object Int8Array]",Ce="[object Int16Array]",Re="[object Int32Array]",De="[object Uint8Array]",ve="[object Uint8ClampedArray]",Le="[object Uint16Array]",Fe="[object Uint32Array]";function lt(xt,gt,Je){var St=xt.constructor;switch(gt){case te:return e(xt);case v:case S:return new St(+xt);case le:return t(xt,Je);case se:case ue:case be:case Ce:case Re:case De:case ve:case Le:case Fe:return h(xt,Je);case o:return new St;case I:case U:return new St(xt);case B:return i(xt);case $:return new St;case K:return a(xt)}}return YT=lt,YT}var JT,g4;function EI(){if(g4)return JT;g4=1;var e=jl(),t=Object.create,i=function(){function a(){}return function(h){if(!e(h))return{};if(t)return t(h);a.prototype=h;var v=new a;return a.prototype=void 0,v}}();return JT=i,JT}var QT,_4;function dU(){if(_4)return QT;_4=1;var e=EI(),t=Jx(),i=kx();function a(h){return typeof h.constructor=="function"&&!i(h)?e(t(h)):{}}return QT=a,QT}var eE,y4;function dle(){if(y4)return eE;y4=1;var e=Hy(),t=Yc(),i="[object Map]";function a(h){return t(h)&&e(h)==i}return eE=a,eE}var tE,v4;function ple(){if(v4)return tE;v4=1;var e=dle(),t=Cx(),i=zM(),a=i&&i.isMap,h=a?t(a):e;return tE=h,tE}var nE,x4;function mle(){if(x4)return nE;x4=1;var e=Hy(),t=Yc(),i="[object Set]";function a(h){return t(h)&&e(h)==i}return nE=a,nE}var rE,b4;function gle(){if(b4)return rE;b4=1;var e=mle(),t=Cx(),i=zM(),a=i&&i.isSet,h=a?t(a):e;return rE=h,rE}var iE,w4;function _le(){if(w4)return iE;w4=1;var e=Px(),t=sU(),i=l1(),a=lU(),h=ole(),v=uU(),S=cU(),o=ale(),I=sle(),B=xj(),$=SI(),U=Hy(),K=lle(),te=fle(),le=dU(),se=vl(),ue=Gy(),be=ple(),Ce=jl(),Re=gle(),De=oc(),ve=ku(),Le=1,Fe=2,lt=4,xt="[object Arguments]",gt="[object Array]",Je="[object Boolean]",St="[object Date]",Nt="[object Error]",Ht="[object Function]",Ct="[object GeneratorFunction]",Kt="[object Map]",Lt="[object Number]",et="[object Object]",vt="[object RegExp]",Ot="[object Set]",mt="[object String]",zt="[object Symbol]",Jt="[object WeakMap]",Un="[object ArrayBuffer]",$n="[object DataView]",Bn="[object Float32Array]",$r="[object Float64Array]",_r="[object Int8Array]",Pn="[object Int16Array]",Ke="[object Int32Array]",mr="[object Uint8Array]",Sn="[object Uint8ClampedArray]",Dr="[object Uint16Array]",Yt="[object Uint32Array]",Mr={};Mr[xt]=Mr[gt]=Mr[Un]=Mr[$n]=Mr[Je]=Mr[St]=Mr[Bn]=Mr[$r]=Mr[_r]=Mr[Pn]=Mr[Ke]=Mr[Kt]=Mr[Lt]=Mr[et]=Mr[vt]=Mr[Ot]=Mr[mt]=Mr[zt]=Mr[mr]=Mr[Sn]=Mr[Dr]=Mr[Yt]=!0,Mr[Nt]=Mr[Ht]=Mr[Jt]=!1;function Qn(Ar,sr,_i,Wi,ii,Pi){var yi,lr=sr&Le,qo=sr&Fe,ea=sr&lt;if(_i&&(yi=ii?_i(Ar,Wi,ii,Pi):_i(Ar)),yi!==void 0)return yi;if(!Ce(Ar))return Ar;var la=se(Ar);if(la){if(yi=K(Ar),!lr)return S(Ar,yi)}else{var Fi=U(Ar),Mo=Fi==Ht||Fi==Ct;if(ue(Ar))return v(Ar,lr);if(Fi==et||Fi==xt||Mo&&!ii){if(yi=qo||Mo?{}:le(Ar),!lr)return qo?I(Ar,h(yi,Ar)):o(Ar,a(yi,Ar))}else{if(!Mr[Fi])return ii?Ar:{};yi=te(Ar,Fi,lr)}}Pi||(Pi=new e);var ta=Pi.get(Ar);if(ta)return ta;Pi.set(Ar,yi),Re(Ar)?Ar.forEach(function(so){yi.add(Qn(so,sr,_i,so,Ar,Pi))}):be(Ar)&&Ar.forEach(function(so,Lo){yi.set(Lo,Qn(so,sr,_i,Lo,Ar,Pi))});var va=ea?qo?$:B:qo?ve:De,za=la?void 0:va(Ar);return t(za||Ar,function(so,Lo){za&&(Lo=so,so=Ar[Lo]),i(yi,Lo,Qn(so,sr,_i,Lo,Ar,Pi))}),yi}return iE=Qn,iE}var oE,S4;function pU(){if(S4)return oE;S4=1;var e=kg(),t=UN();function i(a,h){return h.length<2?a:e(a,t(h,0,-1))}return oE=i,oE}var aE,T4;function mU(){if(T4)return aE;T4=1;var e=Zd(),t=gI(),i=pU(),a=Xd();function h(v,S){return S=e(S,v),v=i(v,S),v==null||delete v[a(t(S))]}return aE=h,aE}var sE,E4;function yle(){if(E4)return sE;E4=1;var e=vI();function t(i){return e(i)?void 0:i}return sE=t,sE}var lE,A4;function vle(){if(A4)return lE;A4=1;var e=NM();function t(i){var a=i==null?0:i.length;return a?e(i,1):[]}return lE=t,lE}var uE,P4;function AI(){if(P4)return uE;P4=1;var e=vle(),t=Oj(),i=Lj();function a(h){return i(t(h,void 0,e),h+"")}return uE=a,uE}var cE,M4;function xle(){if(M4)return cE;M4=1;var e=rm(),t=_le(),i=mU(),a=Zd(),h=hf(),v=yle(),S=AI(),o=SI(),I=1,B=2,$=4,U=S(function(K,te){var le={};if(K==null)return le;var se=!1;te=e(te,function(be){return be=a(be,K),se||(se=be.length>1),be}),h(K,o(K),le),se&&(le=t(le,I|B|$,v));for(var ue=te.length;ue--;)i(le,te[ue]);return le});return cE=U,cE}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ble=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gU=(...e)=>e.filter((t,i,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===i).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var wle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sle=rt.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:h="",children:v,iconNode:S,...o},I)=>rt.createElement("svg",{ref:I,...wle,width:t,height:t,stroke:e,strokeWidth:a?Number(i)*24/Number(t):i,className:gU("lucide",h),...o},[...S.map(([B,$])=>rt.createElement(B,$)),...Array.isArray(v)?v:[v]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=(e,t)=>{const i=rt.forwardRef(({className:a,...h},v)=>rt.createElement(Sle,{ref:v,iconNode:t,className:gU(`lucide-${ble(e)}`,a),...h}));return i.displayName=`${e}`,i};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tle=u1("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ele=u1("BrickWall",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 9v6",key:"199k2o"}],["path",{d:"M16 15v6",key:"8rj2es"}],["path",{d:"M16 3v6",key:"1j6rpj"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M8 15v6",key:"1stoo3"}],["path",{d:"M8 3v6",key:"vlvjmk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ale=u1("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ple=u1("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var hE={exports:{}},U_={exports:{}},Mle=U_.exports,I4;function Ile(){return I4||(I4=1,function(e,t){/**
 * @license
 *
 * chroma.js - JavaScript library for color conversions
 * 
 * Copyright (c) 2011-2017, Gregor Aisch
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 *    derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */(function(){var i,a,h,v,S,o,I,B,$,U,K,te,le,se,ue,be,Ce,Re,De,ve,Le,Fe,lt,xt,gt,Je,St,Nt,Ht,Ct,Kt,Lt,et,vt,Ot,mt,zt,Jt,Un,$n,Bn,$r,_r,Pn,Ke,mr,Sn,Dr,Yt,Mr,Qn,Ar,sr,_i,Wi,ii,Pi,yi,lr,qo,ea,la,Fi,Mo,ta,va,za,so,Lo,es,Go,Fa,Er,go,Ia,Di,vi,bi,Mi,Fo,na,kt,Se=[].slice;bi=function(){var Z,re,ce,de,xe;for(Z={},xe="Boolean Number String Function Array Date RegExp Undefined Null".split(" "),de=0,re=xe.length;de<re;de++)ce=xe[de],Z["[object "+ce+"]"]=ce.toLowerCase();return function(Ie){var Ae;return Ae=Object.prototype.toString.call(Ie),Z[Ae]||"object"}}(),Sn=function(Z,re,ce){return re==null&&(re=0),ce==null&&(ce=1),Z<re&&(Z=re),Z>ce&&(Z=ce),Z},Mi=function(Z){return Z.length>=3?Array.prototype.slice.call(Z):Z[0]},Le=function(Z){var re,ce;for(Z._clipped=!1,Z._unclipped=Z.slice(0),re=ce=0;ce<3;re=++ce)re<3?((Z[re]<0||Z[re]>255)&&(Z._clipped=!0),Z[re]<0&&(Z[re]=0),Z[re]>255&&(Z[re]=255)):re===3&&(Z[re]<0&&(Z[re]=0),Z[re]>1&&(Z[re]=1));return Z._clipped||delete Z._unclipped,Z},v=Math.PI,Er=Math.round,lt=Math.cos,Nt=Math.floor,ii=Math.pow,Dr=Math.log,Ia=Math.sin,Di=Math.sqrt,se=Math.atan2,Qn=Math.max,le=Math.abs,I=v*2,S=v/3,a=v/180,o=180/v,ve=function(){return arguments[0]instanceof i?arguments[0]:function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,arguments,function(){})},ve.default=ve,te=[],e!==null&&e.exports!=null&&(e.exports=ve),Fa=t!==null?t:this,Fa.chroma=ve,ve.version="1.4.1",K={},$=[],U=!1,i=function(){function Z(){var re,ce,de,xe,Ie,Ae,Be,tt,ut;for(Ae=this,ce=[],tt=0,xe=arguments.length;tt<xe;tt++)re=arguments[tt],re!=null&&ce.push(re);if(ce.length>1&&(Be=ce[ce.length-1]),K[Be]!=null)Ae._rgb=Le(K[Be](Mi(ce.slice(0,-1))));else{for(U||($=$.sort(function(Tt,Wt){return Wt.p-Tt.p}),U=!0),ut=0,Ie=$.length;ut<Ie&&(de=$[ut],Be=de.test.apply(de,ce),!Be);ut++);Be&&(Ae._rgb=Le(K[Be].apply(K,ce)))}Ae._rgb==null&&console.warn("unknown format: "+ce),Ae._rgb==null&&(Ae._rgb=[0,0,0]),Ae._rgb.length===3&&Ae._rgb.push(1)}return Z.prototype.toString=function(){return this.hex()},Z}(),ve._input=K;/**
	ColorBrewer colors for chroma.js

	Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and The 
	Pennsylvania State University.

	Licensed under the Apache License, Version 2.0 (the "License"); 
	you may not use this file except in compliance with the License.
	You may obtain a copy of the License at	
	http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed
	under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
	CONDITIONS OF ANY KIND, either express or implied. See the License for the
	specific language governing permissions and limitations under the License.

    @preserve
 */ve.brewer=Re={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},function(){var Z,re;re=[];for(Z in Re)re.push(Re[Z.toLowerCase()]=Re[Z]);return re}(),Fo={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ve.colors=Fo,$r=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt;return re=Mi(arguments),xe=re[0],Z=re[1],ce=re[2],Be=(xe+16)/116,Ae=isNaN(Z)?Be:Be+Z/500,tt=isNaN(ce)?Be:Be-ce/200,Be=h.Yn*_r(Be),Ae=h.Xn*_r(Ae),tt=h.Zn*_r(tt),Ie=kt(3.2404542*Ae-1.5371385*Be-.4985314*tt),de=kt(-.969266*Ae+1.8760108*Be+.041556*tt),ce=kt(.0556434*Ae-.2040259*Be+1.0572252*tt),[Ie,de,ce,re.length>3?re[3]:1]},kt=function(Z){return 255*(Z<=.00304?12.92*Z:1.055*ii(Z,1/2.4)-.055)},_r=function(Z){return Z>h.t1?Z*Z*Z:h.t2*(Z-h.t0)},h={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Mo=function(){var Z,re,ce,de,xe,Ie,Ae,Be;return de=Mi(arguments),ce=de[0],re=de[1],Z=de[2],xe=Lo(ce,re,Z),Ie=xe[0],Ae=xe[1],Be=xe[2],[116*Ae-16,500*(Ie-Ae),200*(Ae-Be)]},es=function(Z){return(Z/=255)<=.04045?Z/12.92:ii((Z+.055)/1.055,2.4)},na=function(Z){return Z>h.t3?ii(Z,1/3):Z/h.t2+h.t0},Lo=function(){var Z,re,ce,de,xe,Ie,Ae;return de=Mi(arguments),ce=de[0],re=de[1],Z=de[2],ce=es(ce),re=es(re),Z=es(Z),xe=na((.4124564*ce+.3575761*re+.1804375*Z)/h.Xn),Ie=na((.2126729*ce+.7151522*re+.072175*Z)/h.Yn),Ae=na((.0193339*ce+.119192*re+.9503041*Z)/h.Zn),[xe,Ie,Ae]},ve.lab=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["lab"]),function(){})},K.lab=$r,i.prototype.lab=function(){return Mo(this._rgb)},ue=function(Z){var re,ce,de,xe,Ie,Ae,Be,tt,ut,Tt,Wt;return Z=function(){var Vt,Gt,gn;for(gn=[],Gt=0,Vt=Z.length;Gt<Vt;Gt++)xe=Z[Gt],gn.push(ve(xe));return gn}(),Z.length===2?(ut=function(){var Vt,Gt,gn;for(gn=[],Gt=0,Vt=Z.length;Gt<Vt;Gt++)xe=Z[Gt],gn.push(xe.lab());return gn}(),Ie=ut[0],Ae=ut[1],re=function(Vt){var Gt,gn;return gn=function(){var Tn,In;for(In=[],Gt=Tn=0;Tn<=2;Gt=++Tn)In.push(Ie[Gt]+Vt*(Ae[Gt]-Ie[Gt]));return In}(),ve.lab.apply(ve,gn)}):Z.length===3?(Tt=function(){var Vt,Gt,gn;for(gn=[],Gt=0,Vt=Z.length;Gt<Vt;Gt++)xe=Z[Gt],gn.push(xe.lab());return gn}(),Ie=Tt[0],Ae=Tt[1],Be=Tt[2],re=function(Vt){var Gt,gn;return gn=function(){var Tn,In;for(In=[],Gt=Tn=0;Tn<=2;Gt=++Tn)In.push((1-Vt)*(1-Vt)*Ie[Gt]+2*(1-Vt)*Vt*Ae[Gt]+Vt*Vt*Be[Gt]);return In}(),ve.lab.apply(ve,gn)}):Z.length===4?(Wt=function(){var Vt,Gt,gn;for(gn=[],Gt=0,Vt=Z.length;Gt<Vt;Gt++)xe=Z[Gt],gn.push(xe.lab());return gn}(),Ie=Wt[0],Ae=Wt[1],Be=Wt[2],tt=Wt[3],re=function(Vt){var Gt,gn;return gn=function(){var Tn,In;for(In=[],Gt=Tn=0;Tn<=2;Gt=++Tn)In.push((1-Vt)*(1-Vt)*(1-Vt)*Ie[Gt]+3*(1-Vt)*(1-Vt)*Vt*Ae[Gt]+3*(1-Vt)*Vt*Vt*Be[Gt]+Vt*Vt*Vt*tt[Gt]);return In}(),ve.lab.apply(ve,gn)}):Z.length===5&&(ce=ue(Z.slice(0,3)),de=ue(Z.slice(2,5)),re=function(Vt){return Vt<.5?ce(Vt*2):de((Vt-.5)*2)}),re},ve.bezier=function(Z){var re;return re=ue(Z),re.scale=function(){return ve.scale(re)},re},ve.cubehelix=function(Z,re,ce,de,xe){var Ie,Ae,Be;return Z==null&&(Z=300),re==null&&(re=-1.5),ce==null&&(ce=1),de==null&&(de=1),xe==null&&(xe=[0,1]),Ie=0,bi(xe)==="array"?Ae=xe[1]-xe[0]:(Ae=0,xe=[xe,xe]),Be=function(tt){var ut,Tt,Wt,Vt,Gt,gn,Tn,In,Ln;return ut=I*((Z+120)/360+re*tt),Tn=ii(xe[0]+Ae*tt,de),gn=Ie!==0?ce[0]+tt*Ie:ce,Tt=gn*Tn*(1-Tn)/2,Vt=lt(ut),Ln=Ia(ut),In=Tn+Tt*(-.14861*Vt+1.78277*Ln),Gt=Tn+Tt*(-.29227*Vt-.90649*Ln),Wt=Tn+Tt*(1.97294*Vt),ve(Le([In*255,Gt*255,Wt*255,1]))},Be.start=function(tt){return tt==null?Z:(Z=tt,Be)},Be.rotations=function(tt){return tt==null?re:(re=tt,Be)},Be.gamma=function(tt){return tt==null?de:(de=tt,Be)},Be.hue=function(tt){return tt==null?ce:(ce=tt,bi(ce)==="array"?(Ie=ce[1]-ce[0],Ie===0&&(ce=ce[1])):Ie=0,Be)},Be.lightness=function(tt){return tt==null?xe:(bi(tt)==="array"?(xe=tt,Ae=tt[1]-tt[0]):(xe=[tt,tt],Ae=0),Be)},Be.scale=function(){return ve.scale(Be)},Be.hue(ce),Be},ve.random=function(){var Z,re,ce;for(re="0123456789abcdef",Z="#",ce=0;ce<6;++ce)Z+=re.charAt(Nt(Math.random()*16));return new i(Z)},te=[],Ot=function(Z,re,ce,de){var xe,Ie,Ae,Be;for(ce==null&&(ce=.5),de==null&&(de="rgb"),bi(Z)!=="object"&&(Z=ve(Z)),bi(re)!=="object"&&(re=ve(re)),Ae=0,Ie=te.length;Ae<Ie;Ae++)if(xe=te[Ae],de===xe[0]){Be=xe[1](Z,re,ce,de);break}if(Be==null)throw"color mode "+de+" is not supported";return Be.alpha(Z.alpha()+ce*(re.alpha()-Z.alpha()))},ve.interpolate=Ot,i.prototype.interpolate=function(Z,re,ce){return Ot(this,Z,re,ce)},ve.mix=Ot,i.prototype.mix=i.prototype.interpolate,K.rgb=function(){var Z,re,ce,de;re=Mi(arguments),ce=[];for(Z in re)de=re[Z],ce.push(de);return ce},ve.rgb=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["rgb"]),function(){})},i.prototype.rgb=function(Z){return Z==null&&(Z=!0),Z?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)},i.prototype.rgba=function(Z){return Z==null&&(Z=!0),Z?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)},$.push({p:3,test:function(Z){var re;if(re=Mi(arguments),bi(re)==="array"&&re.length===3||re.length===4&&bi(re[3])==="number"&&re[3]>=0&&re[3]<=1)return"rgb"}}),K.lrgb=K.rgb,Jt=function(Z,re,ce,de){var xe,Ie;return xe=Z._rgb,Ie=re._rgb,new i(Di(ii(xe[0],2)*(1-ce)+ii(Ie[0],2)*ce),Di(ii(xe[1],2)*(1-ce)+ii(Ie[1],2)*ce),Di(ii(xe[2],2)*(1-ce)+ii(Ie[2],2)*ce),de)},B=function(Z){var re,ce,de,xe,Ie,Ae;for(ce=1/Z.length,Ae=[0,0,0,0],xe=0,de=Z.length;xe<de;xe++)re=Z[xe],Ie=re._rgb,Ae[0]+=ii(Ie[0],2)*ce,Ae[1]+=ii(Ie[1],2)*ce,Ae[2]+=ii(Ie[2],2)*ce,Ae[3]+=Ie[3]*ce;return Ae[0]=Di(Ae[0]),Ae[1]=Di(Ae[1]),Ae[2]=Di(Ae[2]),Ae[3]>1&&(Ae[3]=1),new i(Le(Ae))},te.push(["lrgb",Jt]),ve.average=function(Z,re){var ce,de,xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn;if(re==null&&(re="rgb"),Tt=Z.length,Z=Z.map(function(Tn){return ve(Tn)}),tt=Z.splice(0,1)[0],re==="lrgb")return B(Z);Gt=tt.get(re),Ie=[],Ae=0,Be=0;for(ut in Gt)Gt[ut]=Gt[ut]||0,Ie.push(isNaN(Gt[ut])?0:1),re.charAt(ut)==="h"&&!isNaN(Gt[ut])&&(ce=Gt[ut]/180*v,Ae+=lt(ce),Be+=Ia(ce));for(de=tt.alpha(),Vt=0,Wt=Z.length;Vt<Wt;Vt++){xe=Z[Vt],gn=xe.get(re),de+=xe.alpha();for(ut in Gt)isNaN(gn[ut])||(Ie[ut]+=1,re.charAt(ut)==="h"?(ce=gn[ut]/180*v,Ae+=lt(ce),Be+=Ia(ce)):Gt[ut]+=gn[ut])}for(ut in Gt)if(re.charAt(ut)==="h"){for(ce=se(Be/Ie[ut],Ae/Ie[ut])/v*180;ce<0;)ce+=360;for(;ce>=360;)ce-=360;Gt[ut]=ce}else Gt[ut]=Gt[ut]/Ie[ut];return ve(Gt,re).alpha(de/Tt)},Ct=function(Z){var re,ce,de,xe,Ie,Ae;if(Z.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return(Z.length===4||Z.length===7)&&(Z=Z.substr(1)),Z.length===3&&(Z=Z.split(""),Z=Z[0]+Z[0]+Z[1]+Z[1]+Z[2]+Z[2]),Ae=parseInt(Z,16),xe=Ae>>16,de=Ae>>8&255,ce=Ae&255,[xe,de,ce,1];if(Z.match(/^#?([A-Fa-f0-9]{8})$/))return Z.length===9&&(Z=Z.substr(1)),Ae=parseInt(Z,16),xe=Ae>>24&255,de=Ae>>16&255,ce=Ae>>8&255,re=Er((Ae&255)/255*100)/100,[xe,de,ce,re];if(K.css!=null&&(Ie=K.css(Z)))return Ie;throw"unknown color: "+Z},qo=function(Z,re){var ce,de,xe,Ie,Ae,Be,tt;return re==null&&(re="auto"),Ae=Z[0],xe=Z[1],de=Z[2],ce=Z[3],re==="auto"&&(re=ce<1?"rgba":"rgb"),Ae=Math.round(Ae),xe=Math.round(xe),de=Math.round(de),tt=Ae<<16|xe<<8|de,Be="000000"+tt.toString(16),Be=Be.substr(Be.length-6),Ie="0"+Er(ce*255).toString(16),Ie=Ie.substr(Ie.length-2),"#"+function(){switch(re.toLowerCase()){case"rgba":return Be+Ie;case"argb":return Ie+Be;default:return Be}}()},K.hex=function(Z){return Ct(Z)},ve.hex=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["hex"]),function(){})},i.prototype.hex=function(Z){return Z==null&&(Z="auto"),qo(this._rgb,Z)},$.push({p:4,test:function(Z){if(arguments.length===1&&bi(Z)==="string")return"hex"}}),et=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt;if(Z=Mi(arguments),xe=Z[0],Tt=Z[1],Ae=Z[2],Tt===0)tt=de=re=Ae*255;else{for(Gt=[0,0,0],ce=[0,0,0],Vt=Ae<.5?Ae*(1+Tt):Ae+Tt-Ae*Tt,Wt=2*Ae-Vt,xe/=360,Gt[0]=xe+1/3,Gt[1]=xe,Gt[2]=xe-1/3,Ie=Be=0;Be<=2;Ie=++Be)Gt[Ie]<0&&(Gt[Ie]+=1),Gt[Ie]>1&&(Gt[Ie]-=1),6*Gt[Ie]<1?ce[Ie]=Wt+(Vt-Wt)*6*Gt[Ie]:2*Gt[Ie]<1?ce[Ie]=Vt:3*Gt[Ie]<2?ce[Ie]=Wt+(Vt-Wt)*(2/3-Gt[Ie])*6:ce[Ie]=Wt;ut=[Er(ce[0]*255),Er(ce[1]*255),Er(ce[2]*255)],tt=ut[0],de=ut[1],re=ut[2]}return Z.length>3?[tt,de,re,Z[3]]:[tt,de,re]},la=function(Z,re,ce){var de,xe,Ie,Ae,Be;return Z!==void 0&&Z.length>=3&&(Ae=Z,Z=Ae[0],re=Ae[1],ce=Ae[2]),Z/=255,re/=255,ce/=255,Ie=Math.min(Z,re,ce),Qn=Math.max(Z,re,ce),xe=(Qn+Ie)/2,Qn===Ie?(Be=0,de=Number.NaN):Be=xe<.5?(Qn-Ie)/(Qn+Ie):(Qn-Ie)/(2-Qn-Ie),Z===Qn?de=(re-ce)/(Qn-Ie):re===Qn?de=2+(ce-Z)/(Qn-Ie):ce===Qn&&(de=4+(Z-re)/(Qn-Ie)),de*=60,de<0&&(de+=360),[de,Be,xe]},ve.hsl=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["hsl"]),function(){})},K.hsl=et,i.prototype.hsl=function(){return la(this._rgb)},vt=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn,Tn,In,Ln;if(Z=Mi(arguments),xe=Z[0],Tn=Z[1],Ln=Z[2],Ln*=255,Tn===0)tt=de=re=Ln;else switch(xe===360&&(xe=0),xe>360&&(xe-=360),xe<0&&(xe+=360),xe/=60,Ie=Nt(xe),ce=xe-Ie,Ae=Ln*(1-Tn),Be=Ln*(1-Tn*ce),In=Ln*(1-Tn*(1-ce)),Ie){case 0:ut=[Ln,In,Ae],tt=ut[0],de=ut[1],re=ut[2];break;case 1:Tt=[Be,Ln,Ae],tt=Tt[0],de=Tt[1],re=Tt[2];break;case 2:Wt=[Ae,Ln,In],tt=Wt[0],de=Wt[1],re=Wt[2];break;case 3:Vt=[Ae,Be,Ln],tt=Vt[0],de=Vt[1],re=Vt[2];break;case 4:Gt=[In,Ae,Ln],tt=Gt[0],de=Gt[1],re=Gt[2];break;case 5:gn=[Ln,Ae,Be],tt=gn[0],de=gn[1],re=gn[2]}return[tt,de,re,Z.length>3?Z[3]:1]},Fi=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt;return Ae=Mi(arguments),Ie=Ae[0],ce=Ae[1],Z=Ae[2],xe=Math.min(Ie,ce,Z),Qn=Math.max(Ie,ce,Z),re=Qn-xe,tt=Qn/255,Qn===0?(de=Number.NaN,Be=0):(Be=re/Qn,Ie===Qn&&(de=(ce-Z)/re),ce===Qn&&(de=2+(Z-Ie)/re),Z===Qn&&(de=4+(Ie-ce)/re),de*=60,de<0&&(de+=360)),[de,Be,tt]},ve.hsv=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["hsv"]),function(){})},K.hsv=vt,i.prototype.hsv=function(){return Fi(this._rgb)},_i=function(Z){var re,ce,de;return bi(Z)==="number"&&Z>=0&&Z<=16777215?(de=Z>>16,ce=Z>>8&255,re=Z&255,[de,ce,re,1]):(console.warn("unknown num color: "+Z),[0,0,0,1])},za=function(){var Z,re,ce,de;return de=Mi(arguments),ce=de[0],re=de[1],Z=de[2],(ce<<16)+(re<<8)+Z},ve.num=function(Z){return new i(Z,"num")},i.prototype.num=function(Z){return Z==null&&(Z="rgb"),za(this._rgb,Z)},K.num=_i,$.push({p:1,test:function(Z){if(arguments.length===1&&bi(Z)==="number"&&Z>=0&&Z<=16777215)return"num"}}),Ht=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn,Tn,In,Ln,dr,Zn;if(ce=Mi(arguments),Be=ce[0],xe=ce[1],re=ce[2],xe=xe/100,Ae=Ae/100*255,Z=xe*255,xe===0)Wt=Ae=de=re;else switch(Be===360&&(Be=0),Be>360&&(Be-=360),Be<0&&(Be+=360),Be/=60,tt=Nt(Be),Ie=Be-tt,ut=re*(1-xe),Tt=ut+Z*(1-Ie),dr=ut+Z*Ie,Zn=ut+Z,tt){case 0:Vt=[Zn,dr,ut],Wt=Vt[0],Ae=Vt[1],de=Vt[2];break;case 1:Gt=[Tt,Zn,ut],Wt=Gt[0],Ae=Gt[1],de=Gt[2];break;case 2:gn=[ut,Zn,dr],Wt=gn[0],Ae=gn[1],de=gn[2];break;case 3:Tn=[ut,Tt,Zn],Wt=Tn[0],Ae=Tn[1],de=Tn[2];break;case 4:In=[dr,ut,Zn],Wt=In[0],Ae=In[1],de=In[2];break;case 5:Ln=[Zn,ut,Tt],Wt=Ln[0],Ae=Ln[1],de=Ln[2]}return[Wt,Ae,de,ce.length>3?ce[3]:1]},lr=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt;return tt=Mi(arguments),Be=tt[0],xe=tt[1],re=tt[2],Ae=Math.min(Be,xe,re),Qn=Math.max(Be,xe,re),de=Qn-Ae,ce=de*100/255,Z=Ae/(255-de)*100,de===0?Ie=Number.NaN:(Be===Qn&&(Ie=(xe-re)/de),xe===Qn&&(Ie=2+(re-Be)/de),re===Qn&&(Ie=4+(Be-xe)/de),Ie*=60,Ie<0&&(Ie+=360)),[Ie,ce,Z]},ve.hcg=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["hcg"]),function(){})},K.hcg=Ht,i.prototype.hcg=function(){return lr(this._rgb)},xt=function(Z){var re,ce,de,xe,Ie,Ae,Be,tt;if(Z=Z.toLowerCase(),ve.colors!=null&&ve.colors[Z])return Ct(ve.colors[Z]);if(Ie=Z.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(Be=Ie.slice(1,4),xe=Ae=0;Ae<=2;xe=++Ae)Be[xe]=+Be[xe];Be[3]=1}else if(Ie=Z.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(Be=Ie.slice(1,5),xe=tt=0;tt<=3;xe=++tt)Be[xe]=+Be[xe];else if(Ie=Z.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(Be=Ie.slice(1,4),xe=re=0;re<=2;xe=++re)Be[xe]=Er(Be[xe]*2.55);Be[3]=1}else if(Ie=Z.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(Be=Ie.slice(1,5),xe=ce=0;ce<=2;xe=++ce)Be[xe]=Er(Be[xe]*2.55);Be[3]=+Be[3]}else(Ie=Z.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?(de=Ie.slice(1,4),de[1]*=.01,de[2]*=.01,Be=et(de),Be[3]=1):(Ie=Z.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&(de=Ie.slice(1,4),de[1]*=.01,de[2]*=.01,Be=et(de),Be[3]=+Ie[4]);return Be},yi=function(Z){var re;if(re=Z[3]<1?"rgba":"rgb",re==="rgb")return re+"("+Z.slice(0,3).map(Er).join(",")+")";if(re==="rgba")return re+"("+Z.slice(0,3).map(Er).join(",")+","+Z[3]+")"},Go=function(Z){return Er(Z*100)/100},Lt=function(Z,re){var ce;return ce=re<1?"hsla":"hsl",Z[0]=Go(Z[0]||0),Z[1]=Go(Z[1]*100)+"%",Z[2]=Go(Z[2]*100)+"%",ce==="hsla"&&(Z[3]=re),ce+"("+Z.join(",")+")"},K.css=function(Z){return xt(Z)},ve.css=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["css"]),function(){})},i.prototype.css=function(Z){if(Z==null&&(Z="rgb"),Z.slice(0,3)==="rgb")return yi(this._rgb);if(Z.slice(0,3)==="hsl")return Lt(this.hsl(),this.alpha())},K.named=function(Z){return Ct(Fo[Z])},$.push({p:5,test:function(Z){if(arguments.length===1&&Fo[Z]!=null)return"named"}}),i.prototype.name=function(Z){var re,ce;arguments.length&&(Fo[Z]&&(this._rgb=Ct(Fo[Z])),this._rgb[3]=1),re=this.hex("rgb");for(ce in Fo)if(re===Fo[ce])return ce;return re},Pn=function(){var Z,re,ce,de;return de=Mi(arguments),ce=de[0],Z=de[1],re=de[2],re=re*a,[ce,lt(re)*Z,Ia(re)*Z]},Ke=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt,ut,Tt;return ce=Mi(arguments),Be=ce[0],xe=ce[1],Ae=ce[2],ut=Pn(Be,xe,Ae),Z=ut[0],re=ut[1],de=ut[2],Tt=$r(Z,re,de),tt=Tt[0],Ie=Tt[1],de=Tt[2],[tt,Ie,de,ce.length>3?ce[3]:1]},Bn=function(){var Z,re,ce,de,xe,Ie;return Ie=Mi(arguments),xe=Ie[0],Z=Ie[1],re=Ie[2],ce=Di(Z*Z+re*re),de=(se(re,Z)*o+360)%360,Er(ce*1e4)===0&&(de=Number.NaN),[xe,ce,de]},ta=function(){var Z,re,ce,de,xe,Ie,Ae;return Ie=Mi(arguments),xe=Ie[0],ce=Ie[1],re=Ie[2],Ae=Mo(xe,ce,re),de=Ae[0],Z=Ae[1],re=Ae[2],Bn(de,Z,re)},ve.lch=function(){var Z;return Z=Mi(arguments),new i(Z,"lch")},ve.hcl=function(){var Z;return Z=Mi(arguments),new i(Z,"hcl")},K.lch=Ke,K.hcl=function(){var Z,re,ce,de;return de=Mi(arguments),re=de[0],Z=de[1],ce=de[2],Ke([ce,Z,re])},i.prototype.lch=function(){return ta(this._rgb)},i.prototype.hcl=function(){return ta(this._rgb).reverse()},Pi=function(Z){var re,ce,de,xe,Ie,Ae,Be,tt,ut;return Z==null&&(Z="rgb"),tt=Mi(arguments),Be=tt[0],xe=tt[1],re=tt[2],Be=Be/255,xe=xe/255,re=re/255,Ie=1-Math.max(Be,Math.max(xe,re)),de=Ie<1?1/(1-Ie):0,ce=(1-Be-Ie)*de,Ae=(1-xe-Ie)*de,ut=(1-re-Ie)*de,[ce,Ae,ut,Ie]},Fe=function(){var Z,re,ce,de,xe,Ie,Ae,Be,tt;return re=Mi(arguments),de=re[0],Ae=re[1],tt=re[2],Ie=re[3],Z=re.length>4?re[4]:1,Ie===1?[0,0,0,Z]:(Be=de>=1?0:255*(1-de)*(1-Ie),xe=Ae>=1?0:255*(1-Ae)*(1-Ie),ce=tt>=1?0:255*(1-tt)*(1-Ie),[Be,xe,ce,Z])},K.cmyk=function(){return Fe(Mi(arguments))},ve.cmyk=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["cmyk"]),function(){})},i.prototype.cmyk=function(){return Pi(this._rgb)},K.gl=function(){var Z,re,ce,de,xe;for(de=(function(){var Ie,Ae;Ie=Mi(arguments),Ae=[];for(re in Ie)xe=Ie[re],Ae.push(xe);return Ae}).apply(this,arguments),Z=ce=0;ce<=2;Z=++ce)de[Z]*=255;return de},ve.gl=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["gl"]),function(){})},i.prototype.gl=function(){var Z;return Z=this._rgb,[Z[0]/255,Z[1]/255,Z[2]/255,Z[3]]},va=function(Z,re,ce){var de;return de=Mi(arguments),Z=de[0],re=de[1],ce=de[2],Z=Yt(Z),re=Yt(re),ce=Yt(ce),.2126*Z+.7152*re+.0722*ce},Yt=function(Z){return Z/=255,Z<=.03928?Z/12.92:ii((Z+.055)/1.055,2.4)},$n=function(Z,re,ce,de){var xe,Ie;return xe=Z._rgb,Ie=re._rgb,new i(xe[0]+ce*(Ie[0]-xe[0]),xe[1]+ce*(Ie[1]-xe[1]),xe[2]+ce*(Ie[2]-xe[2]),de)},te.push(["rgb",$n]),i.prototype.luminance=function(Z,re){var ce,de,xe,Ie,Ae;return re==null&&(re="rgb"),arguments.length?(Ie=this._rgb,Z===0?Ie=[0,0,0,this._rgb[3]]:Z===1?Ie=[255,255,255,this[3]]:(ce=va(this._rgb),de=1e-7,xe=20,Ae=function(Be,tt){var ut,Tt;return Tt=Be.interpolate(tt,.5,re),ut=Tt.luminance(),Math.abs(Z-ut)<de||!xe--?Tt:ut>Z?Ae(Be,Tt):Ae(Tt,tt)},ce>Z?Ie=Ae(ve("black"),this).rgba():Ie=Ae(this,ve("white")).rgba()),ve(Ie).alpha(this.alpha())):va(this._rgb)},vi=function(Z){var re,ce,de,xe;return xe=Z/100,xe<66?(de=255,ce=-155.25485562709179-.44596950469579133*(ce=xe-2)+104.49216199393888*Dr(ce),re=xe<20?0:-254.76935184120902+.8274096064007395*(re=xe-10)+115.67994401066147*Dr(re)):(de=351.97690566805693+.114206453784165*(de=xe-55)-40.25366309332127*Dr(de),ce=325.4494125711974+.07943456536662342*(ce=xe-50)-28.0852963507957*Dr(ce),re=255),[de,ce,re]},so=function(){var Z,re,ce,de,xe,Ie,Ae,Be;for(Ie=Mi(arguments),xe=Ie[0],Ie[1],Z=Ie[2],de=1e3,ce=4e4,re=.4;ce-de>re;)Be=(ce+de)*.5,Ae=vi(Be),Ae[2]/Ae[0]>=Z/xe?ce=Be:de=Be;return Er(Be)},ve.temperature=ve.kelvin=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["temperature"]),function(){})},K.temperature=K.kelvin=K.K=vi,i.prototype.temperature=function(){return so(this._rgb)},i.prototype.kelvin=i.prototype.temperature,ve.contrast=function(Z,re){var ce,de,xe,Ie;return((xe=bi(Z))==="string"||xe==="number")&&(Z=new i(Z)),((Ie=bi(re))==="string"||Ie==="number")&&(re=new i(re)),ce=Z.luminance(),de=re.luminance(),ce>de?(ce+.05)/(de+.05):(de+.05)/(ce+.05)},ve.distance=function(Z,re,ce){var de,xe,Ie,Ae,Be,tt,ut;ce==null&&(ce="lab"),((Be=bi(Z))==="string"||Be==="number")&&(Z=new i(Z)),((tt=bi(re))==="string"||tt==="number")&&(re=new i(re)),Ie=Z.get(ce),Ae=re.get(ce),ut=0;for(xe in Ie)de=(Ie[xe]||0)-(Ae[xe]||0),ut+=de*de;return Math.sqrt(ut)},ve.deltaE=function(Z,re,ce,de){var xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn,Tn,In,Ln,dr,Zn,Zr,ri,nr,hn,Kn,br,oi,Ir,Kr,qr,ci;for(ce==null&&(ce=1),de==null&&(de=1),((Zr=bi(Z))==="string"||Zr==="number")&&(Z=new i(Z)),((ri=bi(re))==="string"||ri==="number")&&(re=new i(re)),nr=Z.lab(),xe=nr[0],Ae=nr[1],tt=nr[2],hn=re.lab(),Ie=hn[0],Be=hn[1],ut=hn[2],Tt=Di(Ae*Ae+tt*tt),Wt=Di(Be*Be+ut*ut),oi=xe<16?.511:.040975*xe/(1+.01765*xe),Kn=.0638*Tt/(1+.0131*Tt)+.638,Zn=Tt<1e-6?0:se(tt,Ae)*180/v;Zn<0;)Zn+=360;for(;Zn>=360;)Zn-=360;return Ir=Zn>=164&&Zn<=345?.56+le(.2*lt(v*(Zn+168)/180)):.36+le(.4*lt(v*(Zn+35)/180)),Vt=Tt*Tt*Tt*Tt,dr=Di(Vt/(Vt+1900)),br=Kn*(dr*Ir+1-dr),Ln=xe-Ie,In=Tt-Wt,gn=Ae-Be,Tn=tt-ut,Gt=gn*gn+Tn*Tn-In*In,Kr=Ln/(ce*oi),qr=In/(de*Kn),ci=br,Di(Kr*Kr+qr*qr+Gt/(ci*ci))},i.prototype.get=function(Z){var re,ce,de,xe,Ie,Ae;return de=this,Ie=Z.split("."),xe=Ie[0],re=Ie[1],Ae=de[xe](),re?(ce=xe.indexOf(re),ce>-1?Ae[ce]:console.warn("unknown channel "+re+" in mode "+xe)):Ae},i.prototype.set=function(Z,re){var ce,de,xe,Ie,Ae,Be;if(xe=this,Ae=Z.split("."),Ie=Ae[0],ce=Ae[1],ce)if(Be=xe[Ie](),de=Ie.indexOf(ce),de>-1)if(bi(re)==="string")switch(re.charAt(0)){case"+":Be[de]+=+re;break;case"-":Be[de]+=+re;break;case"*":Be[de]*=+re.substr(1);break;case"/":Be[de]/=+re.substr(1);break;default:Be[de]=+re}else Be[de]=re;else console.warn("unknown channel "+ce+" in mode "+Ie);else Be=re;return ve(Be,Ie).alpha(xe.alpha())},i.prototype.clipped=function(){return this._rgb._clipped||!1},i.prototype.alpha=function(Z){return arguments.length?ve.rgb([this._rgb[0],this._rgb[1],this._rgb[2],Z]):this._rgb[3]},i.prototype.darken=function(Z){var re,ce;return Z==null&&(Z=1),ce=this,re=ce.lab(),re[0]-=h.Kn*Z,ve.lab(re).alpha(ce.alpha())},i.prototype.brighten=function(Z){return Z==null&&(Z=1),this.darken(-Z)},i.prototype.darker=i.prototype.darken,i.prototype.brighter=i.prototype.brighten,i.prototype.saturate=function(Z){var re,ce;return Z==null&&(Z=1),ce=this,re=ce.lch(),re[1]+=Z*h.Kn,re[1]<0&&(re[1]=0),ve.lch(re).alpha(ce.alpha())},i.prototype.desaturate=function(Z){return Z==null&&(Z=1),this.saturate(-Z)},i.prototype.premultiply=function(){var Z,re;return re=this.rgb(),Z=this.alpha(),ve(re[0]*Z,re[1]*Z,re[2]*Z,Z)},be=function(Z,re,ce){if(!be[ce])throw"unknown blend mode "+ce;return be[ce](Z,re)},Ce=function(Z){return function(re,ce){var de,xe;return de=ve(ce).rgb(),xe=ve(re).rgb(),ve(Z(de,xe),"rgb")}},St=function(Z){return function(re,ce){var de,xe,Ie;for(Ie=[],de=xe=0;xe<=3;de=++xe)Ie[de]=Z(re[de],ce[de]);return Ie}},sr=function(Z,re){return Z},Ar=function(Z,re){return Z*re/255},gt=function(Z,re){return Z>re?re:Z},mr=function(Z,re){return Z>re?Z:re},go=function(Z,re){return 255*(1-(1-Z/255)*(1-re/255))},Wi=function(Z,re){return re<128?2*Z*re/255:255*(1-2*(1-Z/255)*(1-re/255))},De=function(Z,re){return 255*(1-(1-re/255)/(Z/255))},Je=function(Z,re){return Z===255||(Z=255*(re/255)/(1-Z/255),Z>255)?255:Z},be.normal=Ce(St(sr)),be.multiply=Ce(St(Ar)),be.screen=Ce(St(go)),be.overlay=Ce(St(Wi)),be.darken=Ce(St(gt)),be.lighten=Ce(St(mr)),be.dodge=Ce(St(Je)),be.burn=Ce(St(De)),ve.blend=be,ve.analyze=function(Z){var re,ce,de,xe;for(de={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0},ce=0,re=Z.length;ce<re;ce++)xe=Z[ce],xe!=null&&!isNaN(xe)&&(de.values.push(xe),de.sum+=xe,xe<de.min&&(de.min=xe),xe>de.max&&(de.max=xe),de.count+=1);return de.domain=[de.min,de.max],de.limits=function(Ie,Ae){return ve.limits(de,Ie,Ae)},de},ve.scale=function(Z,re){var ce,de,xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn,Tn,In,Ln,dr,Zn,Zr,ri,nr;return Tt="rgb",Wt=ve("#ccc"),Tn=0,Ae=[0,1],gn=[],Gt=[0,0],ce=!1,xe=[],Vt=!1,ut=0,tt=1,Ie=!1,de={},In=!0,Be=1,ri=function(hn){var Kn,br,oi,Ir,Kr,qr;if(hn==null&&(hn=["#fff","#000"]),hn!=null&&bi(hn)==="string"&&ve.brewer!=null&&(hn=ve.brewer[hn]||ve.brewer[hn.toLowerCase()]||hn),bi(hn)==="array"){for(hn.length===1&&(hn=[hn[0],hn[0]]),hn=hn.slice(0),Kn=oi=0,Ir=hn.length-1;0<=Ir?oi<=Ir:oi>=Ir;Kn=0<=Ir?++oi:--oi)br=hn[Kn],bi(br)==="string"&&(hn[Kn]=ve(br));for(gn.length=0,Kn=qr=0,Kr=hn.length-1;0<=Kr?qr<=Kr:qr>=Kr;Kn=0<=Kr?++qr:--qr)gn.push(Kn/(hn.length-1))}return Zr(),xe=hn},dr=function(hn){var Kn,br;if(ce!=null){for(br=ce.length-1,Kn=0;Kn<br&&hn>=ce[Kn];)Kn++;return Kn-1}return 0},nr=function(hn){return hn},Zn=function(hn,Kn){var br,oi,Ir,Kr,qr,ci,Zi,Xn;if(Kn==null&&(Kn=!1),isNaN(hn)||hn===null)return Wt;if(Kn?Xn=hn:ce&&ce.length>2?(br=dr(hn),Xn=br/(ce.length-2)):tt!==ut?Xn=(hn-ut)/(tt-ut):Xn=1,Kn||(Xn=nr(Xn)),Be!==1&&(Xn=ii(Xn,Be)),Xn=Gt[0]+Xn*(1-Gt[0]-Gt[1]),Xn=Math.min(1,Math.max(0,Xn)),Kr=Math.floor(Xn*1e4),In&&de[Kr])oi=de[Kr];else{if(bi(xe)==="array")for(Ir=qr=0,Zi=gn.length-1;0<=Zi?qr<=Zi:qr>=Zi;Ir=0<=Zi?++qr:--qr){if(ci=gn[Ir],Xn<=ci){oi=xe[Ir];break}if(Xn>=ci&&Ir===gn.length-1){oi=xe[Ir];break}if(Xn>ci&&Xn<gn[Ir+1]){Xn=(Xn-ci)/(gn[Ir+1]-ci),oi=ve.interpolate(xe[Ir],xe[Ir+1],Xn,Tt);break}}else bi(xe)==="function"&&(oi=xe(Xn));In&&(de[Kr]=oi)}return oi},Zr=function(){return de={}},ri(Z),Ln=function(hn){var Kn;return Kn=ve(Zn(hn)),Vt&&Kn[Vt]?Kn[Vt]():Kn},Ln.classes=function(hn){var Kn;return hn!=null?(bi(hn)==="array"?(ce=hn,Ae=[hn[0],hn[hn.length-1]]):(Kn=ve.analyze(Ae),hn===0?ce=[Kn.min,Kn.max]:ce=ve.limits(Kn,"e",hn)),Ln):ce},Ln.domain=function(hn){var Kn,br,oi,Ir,Kr,qr,ci;if(!arguments.length)return Ae;if(ut=hn[0],tt=hn[hn.length-1],gn=[],oi=xe.length,hn.length===oi&&ut!==tt)for(Kr=0,Ir=hn.length;Kr<Ir;Kr++)br=hn[Kr],gn.push((br-ut)/(tt-ut));else for(Kn=ci=0,qr=oi-1;0<=qr?ci<=qr:ci>=qr;Kn=0<=qr?++ci:--ci)gn.push(Kn/(oi-1));return Ae=[ut,tt],Ln},Ln.mode=function(hn){return arguments.length?(Tt=hn,Zr(),Ln):Tt},Ln.range=function(hn,Kn){return ri(hn,Kn),Ln},Ln.out=function(hn){return Vt=hn,Ln},Ln.spread=function(hn){return arguments.length?(Tn=hn,Ln):Tn},Ln.correctLightness=function(hn){return hn==null&&(hn=!0),Ie=hn,Zr(),Ie?nr=function(Kn){var br,oi,Ir,Kr,qr,ci,Zi,Xn,Gr;for(br=Zn(0,!0).lab()[0],oi=Zn(1,!0).lab()[0],Zi=br>oi,Ir=Zn(Kn,!0).lab()[0],qr=br+(oi-br)*Kn,Kr=Ir-qr,Xn=0,Gr=1,ci=20;Math.abs(Kr)>.01&&ci-- >0;)(function(){return Zi&&(Kr*=-1),Kr<0?(Xn=Kn,Kn+=(Gr-Kn)*.5):(Gr=Kn,Kn+=(Xn-Kn)*.5),Ir=Zn(Kn,!0).lab()[0],Kr=Ir-qr})();return Kn}:nr=function(Kn){return Kn},Ln},Ln.padding=function(hn){return hn!=null?(bi(hn)==="number"&&(hn=[hn,hn]),Gt=hn,Ln):Gt},Ln.colors=function(hn,Kn){var br,oi,Ir,Kr,qr,ci,Zi,Xn;if(arguments.length<2&&(Kn="hex"),qr=[],arguments.length===0)qr=xe.slice(0);else if(hn===1)qr=[Ln(.5)];else if(hn>1)oi=Ae[0],br=Ae[1]-oi,qr=(function(){ci=[];for(var Gr=0;0<=hn?Gr<hn:Gr>hn;0<=hn?Gr++:Gr--)ci.push(Gr);return ci}).apply(this).map(function(Gr){return Ln(oi+Gr/(hn-1)*br)});else{if(Z=[],Zi=[],ce&&ce.length>2)for(Ir=Xn=1,Kr=ce.length;1<=Kr?Xn<Kr:Xn>Kr;Ir=1<=Kr?++Xn:--Xn)Zi.push((ce[Ir-1]+ce[Ir])*.5);else Zi=Ae;qr=Zi.map(function(Gr){return Ln(Gr)})}return ve[Kn]&&(qr=qr.map(function(Gr){return Gr[Kn]()})),qr},Ln.cache=function(hn){return hn!=null?(In=hn,Ln):In},Ln.gamma=function(hn){return hn!=null?(Be=hn,Ln):Be},Ln.nodata=function(hn){return hn!=null?(Wt=ve(hn),Ln):Wt},Ln},ve.scales==null&&(ve.scales={}),ve.scales.cool=function(){return ve.scale([ve.hsl(180,1,.9),ve.hsl(250,.7,.4)])},ve.scales.hot=function(){return ve.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},ve.analyze=function(Z,re,ce){var de,xe,Ie,Ae,Be,tt,ut;if(Be={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0},ce==null&&(ce=function(){return!0}),de=function(Tt){Tt!=null&&!isNaN(Tt)&&(Be.values.push(Tt),Be.sum+=Tt,Tt<Be.min&&(Be.min=Tt),Tt>Be.max&&(Be.max=Tt),Be.count+=1)},ut=function(Tt,Wt){if(ce(Tt,Wt))return re!=null&&bi(re)==="function"?de(re(Tt)):re!=null&&bi(re)==="string"||bi(re)==="number"?de(Tt[re]):de(Tt)},bi(Z)==="array")for(Ae=0,Ie=Z.length;Ae<Ie;Ae++)tt=Z[Ae],ut(tt);else for(xe in Z)tt=Z[xe],ut(tt,xe);return Be.domain=[Be.min,Be.max],Be.limits=function(Tt,Wt){return ve.limits(Be,Tt,Wt)},Be},ve.limits=function(Z,re,ce){var de,xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn,Tn,In,Ln,dr,Zn,Zr,ri,nr,hn,Kn,br,oi,Ir,Kr,qr,ci,Zi,Xn,Gr,xa,lo,uo,wo,yr,wi,fe,Oe,We,dt,nn,Zt,fn,Cn,Gn,Cr,Ur,Ri,So,To,wr,Ba,Pr,Ho;if(re==null&&(re="equal"),ce==null&&(ce=7),bi(Z)==="array"&&(Z=ve.analyze(Z)),Ir=Z.min,Qn=Z.max,Z.sum,Pr=Z.values.sort(function(Yn,Wo){return Yn-Wo}),ce===1)return[Ir,Qn];if(br=[],re.substr(0,1)==="c"&&(br.push(Ir),br.push(Qn)),re.substr(0,1)==="e"){for(br.push(Ir),nr=Gr=1,wo=ce-1;1<=wo?Gr<=wo:Gr>=wo;nr=1<=wo?++Gr:--Gr)br.push(Ir+nr/ce*(Qn-Ir));br.push(Qn)}else if(re.substr(0,1)==="l"){if(Ir<=0)throw"Logarithmic scales are only possible for values > 0";for(Kr=Math.LOG10E*Dr(Ir),oi=Math.LOG10E*Dr(Qn),br.push(Ir),nr=Ho=1,yr=ce-1;1<=yr?Ho<=yr:Ho>=yr;nr=1<=yr?++Ho:--Ho)br.push(ii(10,Kr+nr/ce*(oi-Kr)));br.push(Qn)}else if(re.substr(0,1)==="q"){for(br.push(Ir),nr=de=1,nn=ce-1;1<=nn?de<=nn:de>=nn;nr=1<=nn?++de:--de)xa=(Pr.length-1)*nr/ce,lo=Nt(xa),lo===xa?br.push(Pr[lo]):(uo=xa-lo,br.push(Pr[lo]*(1-uo)+Pr[lo+1]*uo));br.push(Qn)}else if(re.substr(0,1)==="k"){for(ci=Pr.length,In=new Array(ci),Zr=new Array(ce),So=!0,Zi=0,dr=null,dr=[],dr.push(Ir),nr=xe=1,Zt=ce-1;1<=Zt?xe<=Zt:xe>=Zt;nr=1<=Zt?++xe:--xe)dr.push(Ir+nr/ce*(Qn-Ir));for(dr.push(Qn);So;){for(hn=Ie=0,fn=ce-1;0<=fn?Ie<=fn:Ie>=fn;hn=0<=fn?++Ie:--Ie)Zr[hn]=0;for(nr=Ae=0,Cn=ci-1;0<=Cn?Ae<=Cn:Ae>=Cn;nr=0<=Cn?++Ae:--Ae){for(Ba=Pr[nr],qr=Number.MAX_VALUE,hn=Be=0,Gn=ce-1;0<=Gn?Be<=Gn:Be>=Gn;hn=0<=Gn?++Be:--Be)ri=le(dr[hn]-Ba),ri<qr&&(qr=ri,Ln=hn);Zr[Ln]++,In[nr]=Ln}for(Xn=new Array(ce),hn=tt=0,Cr=ce-1;0<=Cr?tt<=Cr:tt>=Cr;hn=0<=Cr?++tt:--tt)Xn[hn]=null;for(nr=ut=0,Ur=ci-1;0<=Ur?ut<=Ur:ut>=Ur;nr=0<=Ur?++ut:--ut)Zn=In[nr],Xn[Zn]===null?Xn[Zn]=Pr[nr]:Xn[Zn]+=Pr[nr];for(hn=Tt=0,Ri=ce-1;0<=Ri?Tt<=Ri:Tt>=Ri;hn=0<=Ri?++Tt:--Tt)Xn[hn]*=1/Zr[hn];for(So=!1,hn=Wt=0,wi=ce-1;0<=wi?Wt<=wi:Wt>=wi;hn=0<=wi?++Wt:--Wt)if(Xn[hn]!==dr[nr]){So=!0;break}dr=Xn,Zi++,Zi>200&&(So=!1)}for(Kn={},hn=Vt=0,fe=ce-1;0<=fe?Vt<=fe:Vt>=fe;hn=0<=fe?++Vt:--Vt)Kn[hn]=[];for(nr=Gt=0,Oe=ci-1;0<=Oe?Gt<=Oe:Gt>=Oe;nr=0<=Oe?++Gt:--Gt)Zn=In[nr],Kn[Zn].push(Pr[nr]);for(To=[],hn=gn=0,We=ce-1;0<=We?gn<=We:gn>=We;hn=0<=We?++gn:--gn)To.push(Kn[hn][0]),To.push(Kn[hn][Kn[hn].length-1]);for(To=To.sort(function(Yn,Wo){return Yn-Wo}),br.push(To[0]),nr=Tn=1,dt=To.length-1;Tn<=dt;nr=Tn+=2)wr=To[nr],!isNaN(wr)&&br.indexOf(wr)===-1&&br.push(wr)}return br},Kt=function(Z,re,ce){var de,xe,Ie,Ae;return de=Mi(arguments),Z=de[0],re=de[1],ce=de[2],isNaN(Z)&&(Z=0),Z/=360,Z<1/3?(xe=(1-re)/3,Ae=(1+re*lt(I*Z)/lt(S-I*Z))/3,Ie=1-(xe+Ae)):Z<2/3?(Z-=1/3,Ae=(1-re)/3,Ie=(1+re*lt(I*Z)/lt(S-I*Z))/3,xe=1-(Ae+Ie)):(Z-=2/3,Ie=(1-re)/3,xe=(1+re*lt(I*Z)/lt(S-I*Z))/3,Ae=1-(Ie+xe)),Ae=Sn(ce*Ae*3),Ie=Sn(ce*Ie*3),xe=Sn(ce*xe*3),[Ae*255,Ie*255,xe*255,de.length>3?de[3]:1]},ea=function(){var Z,re,ce,de,xe,Ie,Ae,Be;return Ae=Mi(arguments),Ie=Ae[0],re=Ae[1],Z=Ae[2],I=Math.PI*2,Ie/=255,re/=255,Z/=255,xe=Math.min(Ie,re,Z),de=(Ie+re+Z)/3,Be=1-xe/de,Be===0?ce=0:(ce=(Ie-re+(Ie-Z))/2,ce/=Math.sqrt((Ie-re)*(Ie-re)+(Ie-Z)*(re-Z)),ce=Math.acos(ce),Z>re&&(ce=I-ce),ce/=I),[ce*360,Be,de]},ve.hsi=function(){return function(Z,re,ce){ce.prototype=Z.prototype;var de=new ce,xe=Z.apply(de,re);return Object(xe)===xe?xe:de}(i,Se.call(arguments).concat(["hsi"]),function(){})},K.hsi=Kt,i.prototype.hsi=function(){return ea(this._rgb)},mt=function(Z,re,ce,de){var xe,Ie,Ae,Be,tt,ut,Tt,Wt,Vt,Gt,gn,Tn;return de==="hsl"?(gn=Z.hsl(),Tn=re.hsl()):de==="hsv"?(gn=Z.hsv(),Tn=re.hsv()):de==="hcg"?(gn=Z.hcg(),Tn=re.hcg()):de==="hsi"?(gn=Z.hsi(),Tn=re.hsi()):(de==="lch"||de==="hcl")&&(de="hcl",gn=Z.hcl(),Tn=re.hcl()),de.substr(0,1)==="h"&&(Ae=gn[0],Vt=gn[1],ut=gn[2],Be=Tn[0],Gt=Tn[1],Tt=Tn[2]),!isNaN(Ae)&&!isNaN(Be)?(Be>Ae&&Be-Ae>180?xe=Be-(Ae+360):Be<Ae&&Ae-Be>180?xe=Be+360-Ae:xe=Be-Ae,Ie=Ae+ce*xe):isNaN(Ae)?isNaN(Be)?Ie=Number.NaN:(Ie=Be,(ut===1||ut===0)&&de!=="hsv"&&(Wt=Gt)):(Ie=Ae,(Tt===1||Tt===0)&&de!=="hsv"&&(Wt=Vt)),Wt==null&&(Wt=Vt+ce*(Gt-Vt)),tt=ut+ce*(Tt-ut),ve[de](Ie,Wt,tt)},te=te.concat(function(){var Z,re,ce,de;for(ce=["hsv","hsl","hsi","hcl","lch","hcg"],de=[],re=0,Z=ce.length;re<Z;re++)Mr=ce[re],de.push([Mr,mt]);return de}()),Un=function(Z,re,ce,de){var xe,Ie;return xe=Z.num(),Ie=re.num(),ve.num(xe+(Ie-xe)*ce,"num")},te.push(["num",Un]),zt=function(Z,re,ce,de){var xe,Ie;return xe=Z.lab(),Ie=re.lab(),new i(xe[0]+ce*(Ie[0]-xe[0]),xe[1]+ce*(Ie[1]-xe[1]),xe[2]+ce*(Ie[2]-xe[2]),de)},te.push(["lab",zt])}).call(Mle)}(U_,U_.exports)),U_.exports}var fE,C4;function Ng(){if(C4)return fE;C4=1;var e=Wy(),t=Lg();function i(a){return e(function(h,v){var S=-1,o=v.length,I=o>1?v[o-1]:void 0,B=o>2?v[2]:void 0;for(I=a.length>3&&typeof I=="function"?(o--,I):void 0,B&&t(v[0],v[1],B)&&(I=o<3?void 0:I,o=1),h=Object(h);++S<o;){var $=v[S];$&&a(h,$,S,I)}return h})}return fE=i,fE}var dE,O4;function Cle(){if(O4)return dE;O4=1;var e=l1(),t=hf(),i=Ng(),a=Kd(),h=kx(),v=oc(),S=Object.prototype,o=S.hasOwnProperty,I=i(function(B,$){if(h($)||a($)){t($,v($),B);return}for(var U in $)o.call($,U)&&e(B,U,$[U])});return dE=I,dE}var pE,k4;function _U(){if(k4)return pE;k4=1;var e=hf(),t=Ng(),i=ku(),a=t(function(h,v){e(v,i(v),h)});return pE=a,pE}var mE,R4;function yU(){if(R4)return mE;R4=1;var e=hf(),t=Ng(),i=ku(),a=t(function(h,v,S,o){e(v,i(v),h,o)});return mE=a,mE}var gE,L4;function Ole(){if(L4)return gE;L4=1;var e=hf(),t=Ng(),i=oc(),a=t(function(h,v,S,o){e(v,i(v),h,o)});return gE=a,gE}var _E,D4;function kle(){if(D4)return _E;D4=1;var e=wx();function t(i,a){for(var h=-1,v=a.length,S=Array(v),o=i==null;++h<v;)S[h]=o?void 0:e(i,a[h]);return S}return _E=t,_E}var yE,z4;function Rle(){if(z4)return yE;z4=1;var e=kle(),t=AI(),i=t(e);return yE=i,yE}var vE,F4;function Lle(){if(F4)return vE;F4=1;var e=lU(),t=EI();function i(a,h){var v=t(a);return h==null?v:e(v,h)}return vE=i,vE}var xE,B4;function Dle(){if(B4)return xE;B4=1;var e=Wy(),t=Og(),i=Lg(),a=ku(),h=Object.prototype,v=h.hasOwnProperty,S=e(function(o,I){o=Object(o);var B=-1,$=I.length,U=$>2?I[2]:void 0;for(U&&i(I[0],I[1],U)&&($=1);++B<$;)for(var K=I[B],te=a(K),le=-1,se=te.length;++le<se;){var ue=te[le],be=o[ue];(be===void 0||t(be,h[ue])&&!v.call(o,ue))&&(o[ue]=K[ue])}return o});return xE=S,xE}var bE,N4;function vU(){if(N4)return bE;N4=1;var e=Jy(),t=Og();function i(a,h,v){(v!==void 0&&!t(a[h],v)||v===void 0&&!(h in a))&&e(a,h,v)}return bE=i,bE}var wE,j4;function zle(){if(j4)return wE;j4=1;var e=Kd(),t=Yc();function i(a){return t(a)&&e(a)}return wE=i,wE}var SE,$4;function xU(){if($4)return SE;$4=1;function e(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}return SE=e,SE}var TE,U4;function Fle(){if(U4)return TE;U4=1;var e=hf(),t=ku();function i(a){return e(a,t(a))}return TE=i,TE}var EE,V4;function Ble(){if(V4)return EE;V4=1;var e=vU(),t=uU(),i=fU(),a=cU(),h=dU(),v=Mx(),S=vl(),o=zle(),I=Gy(),B=tm(),$=jl(),U=vI(),K=Ox(),te=xU(),le=Fle();function se(ue,be,Ce,Re,De,ve,Le){var Fe=te(ue,Ce),lt=te(be,Ce),xt=Le.get(lt);if(xt){e(ue,Ce,xt);return}var gt=ve?ve(Fe,lt,Ce+"",ue,be,Le):void 0,Je=gt===void 0;if(Je){var St=S(lt),Nt=!St&&I(lt),Ht=!St&&!Nt&&K(lt);gt=lt,St||Nt||Ht?S(Fe)?gt=Fe:o(Fe)?gt=a(Fe):Nt?(Je=!1,gt=t(lt,!0)):Ht?(Je=!1,gt=i(lt,!0)):gt=[]:U(lt)||v(lt)?(gt=Fe,v(Fe)?gt=le(Fe):(!$(Fe)||B(Fe))&&(gt=h(lt))):Je=!1}Je&&(Le.set(lt,gt),De(gt,lt,Re,ve,Le),Le.delete(lt)),e(ue,Ce,gt)}return EE=se,EE}var AE,q4;function PI(){if(q4)return AE;q4=1;var e=Px(),t=vU(),i=jM(),a=Ble(),h=jl(),v=ku(),S=xU();function o(I,B,$,U,K){I!==B&&i(B,function(te,le){if(K||(K=new e),h(te))a(I,B,le,$,o,U,K);else{var se=U?U(S(I,le),te,le+"",I,B,K):void 0;se===void 0&&(se=te),t(I,le,se)}},v)}return AE=o,AE}var PE,G4;function Nle(){if(G4)return PE;G4=1;var e=PI(),t=jl();function i(a,h,v,S,o,I){return t(a)&&t(h)&&(I.set(h,a),e(a,h,void 0,i,I),I.delete(h)),a}return PE=i,PE}var ME,H4;function bU(){if(H4)return ME;H4=1;var e=PI(),t=Ng(),i=t(function(a,h,v,S){e(a,h,v,S)});return ME=i,ME}var IE,W4;function jle(){if(W4)return IE;W4=1;var e=UM(),t=Wy(),i=Nle(),a=bU(),h=t(function(v){return v.push(void 0,i),e(a,void 0,v)});return IE=h,IE}var CE,Z4;function $le(){if(Z4)return CE;Z4=1;var e=rm();function t(i,a){return e(a,function(h){return[h,i[h]]})}return CE=t,CE}var OE,X4;function Ule(){if(X4)return OE;X4=1;function e(t){var i=-1,a=Array(t.size);return t.forEach(function(h){a[++i]=[h,h]}),a}return OE=e,OE}var kE,K4;function wU(){if(K4)return kE;K4=1;var e=$le(),t=Hy(),i=pj(),a=Ule(),h="[object Map]",v="[object Set]";function S(o){return function(I){var B=t(I);return B==h?i(I):B==v?a(I):e(I,o(I))}}return kE=S,kE}var RE,Y4;function SU(){if(Y4)return RE;Y4=1;var e=wU(),t=oc(),i=e(t);return RE=i,RE}var LE,J4;function Vle(){return J4||(J4=1,LE=SU()),LE}var DE,Q4;function TU(){if(Q4)return DE;Q4=1;var e=wU(),t=ku(),i=e(t);return DE=i,DE}var zE,e5;function qle(){return e5||(e5=1,zE=TU()),zE}var FE,t5;function Gle(){return t5||(t5=1,FE=_U()),FE}var BE,n5;function Hle(){return n5||(n5=1,BE=yU()),BE}var NE,r5;function EU(){if(r5)return NE;r5=1;function e(t,i,a){var h;return a(t,function(v,S,o){if(i(v,S,o))return h=S,!1}),h}return NE=e,NE}var jE,i5;function Wle(){if(i5)return jE;i5=1;var e=EU(),t=im(),i=xl();function a(h,v){return e(h,i(v,3),t)}return jE=a,jE}var $E,o5;function AU(){if(o5)return $E;o5=1;var e=Ij(),t=e(!0);return $E=t,$E}var UE,a5;function PU(){if(a5)return UE;a5=1;var e=AU(),t=oc();function i(a,h){return a&&e(a,h,t)}return UE=i,UE}var VE,s5;function Zle(){if(s5)return VE;s5=1;var e=EU(),t=PU(),i=xl();function a(h,v){return e(h,i(v,3),t)}return VE=a,VE}var qE,l5;function jg(){if(l5)return qE;l5=1;var e=Yd();function t(i){return typeof i=="function"?i:e}return qE=t,qE}var GE,u5;function Xle(){if(u5)return GE;u5=1;var e=jM(),t=jg(),i=ku();function a(h,v){return h==null?h:e(h,t(v),i)}return GE=a,GE}var HE,c5;function Kle(){if(c5)return HE;c5=1;var e=AU(),t=jg(),i=ku();function a(h,v){return h==null?h:e(h,t(v),i)}return HE=a,HE}var WE,h5;function Yle(){if(h5)return WE;h5=1;var e=im(),t=jg();function i(a,h){return a&&e(a,t(h))}return WE=i,WE}var ZE,f5;function Jle(){if(f5)return ZE;f5=1;var e=PU(),t=jg();function i(a,h){return a&&e(a,t(h))}return ZE=i,ZE}var XE,d5;function MU(){if(d5)return XE;d5=1;var e=gj(),t=tm();function i(a,h){return e(h,function(v){return t(a[v])})}return XE=i,XE}var KE,p5;function Qle(){if(p5)return KE;p5=1;var e=MU(),t=oc();function i(a){return a==null?[]:e(a,t(a))}return KE=i,KE}var YE,m5;function eue(){if(m5)return YE;m5=1;var e=MU(),t=ku();function i(a){return a==null?[]:e(a,t(a))}return YE=i,YE}var JE,g5;function tue(){if(g5)return JE;g5=1;var e=Object.prototype,t=e.hasOwnProperty;function i(a,h){return a!=null&&t.call(a,h)}return JE=i,JE}var QE,_5;function nue(){if(_5)return QE;_5=1;var e=tue(),t=Tj();function i(a,h){return a!=null&&t(a,h,e)}return QE=i,QE}var eA,y5;function rue(){if(y5)return eA;y5=1;var e=im();function t(i,a,h,v){return e(i,function(S,o,I){a(v,h(S),o,I)}),v}return eA=t,eA}var tA,v5;function IU(){if(v5)return tA;v5=1;var e=rue();function t(i,a){return function(h,v){return e(h,i,a(v),{})}}return tA=t,tA}var nA,x5;function iue(){if(x5)return nA;x5=1;var e=kj(),t=IU(),i=Yd(),a=Object.prototype,h=a.toString,v=t(function(S,o,I){o!=null&&typeof o.toString!="function"&&(o=h.call(o)),S[o]=I},e(i));return nA=v,nA}var rA,b5;function oue(){if(b5)return rA;b5=1;var e=xl(),t=IU(),i=Object.prototype,a=i.hasOwnProperty,h=i.toString,v=t(function(S,o,I){o!=null&&typeof o.toString!="function"&&(o=h.call(o)),a.call(S,o)?S[o].push(I):S[o]=[I]},e);return rA=v,rA}var iA,w5;function aue(){if(w5)return iA;w5=1;var e=UM(),t=Zd(),i=gI(),a=pU(),h=Xd();function v(S,o,I){o=t(o,S),S=a(S,o);var B=S==null?S:S[h(i(o))];return B==null?void 0:e(B,S,I)}return iA=v,iA}var oA,S5;function sue(){if(S5)return oA;S5=1;var e=aue(),t=Wy(),i=t(e);return oA=i,oA}var aA,T5;function lue(){if(T5)return aA;T5=1;var e=Jy(),t=im(),i=xl();function a(h,v){var S={};return v=i(v,3),t(h,function(o,I,B){e(S,v(o,I,B),o)}),S}return aA=a,aA}var sA,E5;function uue(){if(E5)return sA;E5=1;var e=PI(),t=Ng(),i=t(function(a,h,v){e(a,h,v)});return sA=i,sA}var lA,A5;function cue(){if(A5)return lA;A5=1;var e="Expected a function";function t(i){if(typeof i!="function")throw new TypeError(e);return function(){var a=arguments;switch(a.length){case 0:return!i.call(this);case 1:return!i.call(this,a[0]);case 2:return!i.call(this,a[0],a[1]);case 3:return!i.call(this,a[0],a[1],a[2])}return!i.apply(this,a)}}return lA=t,lA}var uA,P5;function c1(){if(P5)return uA;P5=1;var e=l1(),t=Zd(),i=Ix(),a=jl(),h=Xd();function v(S,o,I,B){if(!a(S))return S;o=t(o,S);for(var $=-1,U=o.length,K=U-1,te=S;te!=null&&++$<U;){var le=h(o[$]),se=I;if(le==="__proto__"||le==="constructor"||le==="prototype")return S;if($!=K){var ue=te[le];se=B?B(ue,le,te):void 0,se===void 0&&(se=a(ue)?ue:i(o[$+1])?[]:{})}e(te,le,se),te=te[le]}return S}return uA=v,uA}var cA,M5;function CU(){if(M5)return cA;M5=1;var e=kg(),t=c1(),i=Zd();function a(h,v,S){for(var o=-1,I=v.length,B={};++o<I;){var $=v[o],U=e(h,$);S(U,$)&&t(B,i($,h),U)}return B}return cA=a,cA}var hA,I5;function OU(){if(I5)return hA;I5=1;var e=rm(),t=xl(),i=CU(),a=SI();function h(v,S){if(v==null)return{};var o=e(a(v),function(I){return[I]});return S=t(S),i(v,o,function(I,B){return S(I,B[0])})}return hA=h,hA}var fA,C5;function hue(){if(C5)return fA;C5=1;var e=xl(),t=cue(),i=OU();function a(h,v){return i(h,t(e(v)))}return fA=a,fA}var dA,O5;function fue(){if(O5)return dA;O5=1;var e=CU(),t=BM();function i(a,h){return e(a,h,function(v,S){return t(a,S)})}return dA=i,dA}var pA,k5;function due(){if(k5)return pA;k5=1;var e=fue(),t=AI(),i=t(function(a,h){return a==null?{}:e(a,h)});return pA=i,pA}var mA,R5;function pue(){if(R5)return mA;R5=1;var e=Zd(),t=tm(),i=Xd();function a(h,v,S){v=e(v,h);var o=-1,I=v.length;for(I||(I=1,h=void 0);++o<I;){var B=h==null?void 0:h[i(v[o])];B===void 0&&(o=I,B=S),h=t(B)?B.call(h):B}return h}return mA=a,mA}var gA,L5;function mue(){if(L5)return gA;L5=1;var e=c1();function t(i,a,h){return i==null?i:e(i,a,h)}return gA=t,gA}var _A,D5;function gue(){if(D5)return _A;D5=1;var e=c1();function t(i,a,h,v){return v=typeof v=="function"?v:void 0,i==null?i:e(i,a,h,v)}return _A=t,_A}var yA,z5;function _ue(){if(z5)return yA;z5=1;var e=sU(),t=EI(),i=im(),a=xl(),h=Jx(),v=vl(),S=Gy(),o=tm(),I=jl(),B=Ox();function $(U,K,te){var le=v(U),se=le||S(U)||B(U);if(K=a(K,4),te==null){var ue=U&&U.constructor;se?te=le?new ue:[]:I(U)?te=o(ue)?t(h(U)):{}:te={}}return(se?e:i)(U,function(be,Ce,Re){return K(te,be,Ce,Re)}),te}return yA=$,yA}var vA,F5;function yue(){if(F5)return vA;F5=1;var e=mU();function t(i,a){return i==null?!0:e(i,a)}return vA=t,vA}var xA,B5;function kU(){if(B5)return xA;B5=1;var e=kg(),t=c1();function i(a,h,v,S){return t(a,h,v(e(a,h)),S)}return xA=i,xA}var bA,N5;function vue(){if(N5)return bA;N5=1;var e=kU(),t=jg();function i(a,h,v){return a==null?a:e(a,h,t(v))}return bA=i,bA}var wA,j5;function xue(){if(j5)return wA;j5=1;var e=kU(),t=jg();function i(a,h,v,S){return S=typeof S=="function"?S:void 0,a==null?a:e(a,h,t(v),S)}return wA=i,wA}var SA,$5;function RU(){if($5)return SA;$5=1;var e=rm();function t(i,a){return e(a,function(h){return i[h]})}return SA=t,SA}var TA,U5;function bue(){if(U5)return TA;U5=1;var e=RU(),t=oc();function i(a){return a==null?[]:e(a,t(a))}return TA=i,TA}var EA,V5;function wue(){if(V5)return EA;V5=1;var e=RU(),t=ku();function i(a){return a==null?[]:e(a,t(a))}return EA=i,EA}var AA,q5;function Sue(){return q5||(q5=1,AA={assign:Cle(),assignIn:_U(),assignInWith:yU(),assignWith:Ole(),at:Rle(),create:Lle(),defaults:Dle(),defaultsDeep:jle(),entries:Vle(),entriesIn:qle(),extend:Gle(),extendWith:Hle(),findKey:Wle(),findLastKey:Zle(),forIn:Xle(),forInRight:Kle(),forOwn:Yle(),forOwnRight:Jle(),functions:Qle(),functionsIn:eue(),get:wx(),has:nue(),hasIn:BM(),invert:iue(),invertBy:oue(),invoke:sue(),keys:oc(),keysIn:ku(),mapKeys:lue(),mapValues:b$(),merge:uue(),mergeWith:bU(),omit:xle(),omitBy:hue(),pick:due(),pickBy:OU(),result:pue(),set:mue(),setWith:gue(),toPairs:SU(),toPairsIn:TU(),transform:_ue(),unset:yue(),update:vue(),updateWith:xue(),values:bue(),valuesIn:wue()}),AA}var G5;function Tue(){if(G5)return hE.exports;G5=1;var e=Y5(),t=Ile(),i=Sue();return e.choropleth=hE.exports=function(a,h){h=h||{},i.defaults(h,{valueProperty:"value",scale:["white","red"],steps:5,mode:"q"});var v=h.style,S=a.features.map(typeof h.valueProperty=="function"?h.valueProperty:function(B){return B.properties[h.valueProperty]}),o=t.limits(S,h.mode,h.steps-1),I=h.colors&&h.colors.length===o.length?h.colors:t.scale(h.scale).colors(o.length);return e.geoJson(a,i.extend(h,{limits:o,colors:I,style:function(B){var $={},U;if(typeof h.valueProperty=="function"?U=h.valueProperty(B):U=B.properties[h.valueProperty],!isNaN(U)){for(var K=0;K<o.length;K++)if(U<=o[K]){$.fillColor=I[K];break}}switch(typeof v){case"function":return i.defaults($,v(B));case"object":return i.defaults($,v);default:return $}}}))},hE.exports}Tue();const H5=()=>Dt.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",children:Dt.jsx("path",{fill:"#FF0000",d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),gl={epicentre:{lieu:"71,8 km au sud-ouest de Marrakech",coordonnees:{latitude:31.11,longitude:-8.44}},infos:{nom:"Séisme d'Al Haouz 2023",date:"2023-09-08",heure:"22:11 UTC",magnitude:7,profondeur:18,intensite:"VIII (Destructrice)",mecanisme:"Chevauchement oblique"},bilan:{morts:2960,blesses:6125,batimentsDetruits:5e4,batimentsEndommages:15e4},regionsAffectees:[{name:"Al Haouz",morts:1684},{name:"Taroudant",morts:980},{name:"Chichaoua",morts:202},{name:"Ouarzazate",morts:38},{name:"Marrakech",morts:18}],impact:{batiments:{detruits:5e4,endommages:15e4},victimes:{morts:2960,blesses:6125}},regionsAffectees:[{name:"Al Haouz",morts:1684},{name:"Taroudant",morts:980},{name:"Chichaoua",morts:202},{name:"Ouarzazate",morts:38},{name:"Marrakech",morts:18}]};function Eue(){const[e,t]=rt.useState("batiments"),i=rt.useRef(null),a=rt.useRef(null),h=rt.useRef(null),v=rt.useRef(null),S=rt.useRef({}),[o,I]=rt.useState(!1),[B,$]=rt.useState(!1),U=()=>{switch(e){case"batiments":return[{name:"État des bâtiments",detruits:gl.impact.batiments.detruits,endommages:gl.impact.batiments.endommages}];case"victimes":return[{name:"Bilan humain",morts:gl.impact.victimes.morts,blesses:gl.impact.victimes.blesses}];case"regions":return gl.regionsAffectees;default:return[]}},K=()=>{const le=U();switch(e){case"batiments":return Dt.jsxs(c0,{data:le,margin:{top:20,right:30,left:20,bottom:5},children:[Dt.jsx(Gp,{dataKey:"name"}),Dt.jsx(Hp,{}),Dt.jsx(Cu,{formatter:se=>se.toLocaleString()}),Dt.jsx(Wc,{}),Dt.jsx(qc,{dataKey:"detruits",fill:"#FF5252",name:"Bâtiments détruits"}),Dt.jsx(qc,{dataKey:"endommages",fill:"#FFA726",name:"Bâtiments endommagés"})]});case"victimes":return Dt.jsxs(c0,{data:le,margin:{top:20,right:30,left:20,bottom:5},children:[Dt.jsx(Gp,{dataKey:"name"}),Dt.jsx(Hp,{}),Dt.jsx(Cu,{formatter:se=>se.toLocaleString()}),Dt.jsx(Wc,{}),Dt.jsx(qc,{dataKey:"morts",fill:"#FF5252",name:"Décès"}),Dt.jsx(qc,{dataKey:"blesses",fill:"#2196F3",name:"Blessés"})]});case"regions":return Dt.jsxs(c0,{data:le,margin:{top:20,right:30,left:20,bottom:5},children:[Dt.jsx(Gp,{dataKey:"name"}),Dt.jsx(Hp,{}),Dt.jsx(Cu,{formatter:se=>se.toLocaleString()}),Dt.jsx(Wc,{}),Dt.jsx(qc,{dataKey:"morts",fill:"#FF5252",name:"Nombre de décès"})]});default:return null}};rt.useEffect(()=>{if(i.current&&!a.current){a.current=Dl.map(i.current).setView([gl.epicentre.coordonnees.latitude,gl.epicentre.coordonnees.longitude],7),Dl.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(a.current);const le=Dl.divIcon({html:Ok.renderToString(Dt.jsx(H5,{})),className:"custom-div-icon",iconSize:[24,24],iconAnchor:[12,12]});Dl.marker([gl.epicentre.coordonnees.latitude,gl.epicentre.coordonnees.longitude],{icon:le}).addTo(a.current).bindPopup(`<strong>Épicentre du séisme</strong><br>${gl.epicentre.lieu}`);const se=Dl.control({position:"bottomleft"});se.onAdd=function(){const De=Dl.DomUtil.create("div","legend");return Ok.renderToString(Dt.jsx(H5,{})),De.innerHTML=`
          <div>
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="#FF0000" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            <span>Épicentre</span>
          </div>
        `,De},se.addTo(a.current),fetch("./public/mi.geojson").then(De=>De.json()).then(De=>{const ve=Dl.choropleth(De,{valueProperty:"PARAMVALUE",scale:["#f2f0f7","#54278f"],steps:5,mode:"q",style:{color:"#fff",weight:1,fillOpacity:.8},onEachFeature:(Le,Fe)=>{Fe.bindPopup(`<strong>MI:</strong> ${Le.properties.PARAMVALUE}<br>`)}});h.current=ve}),fetch("./public/pga.geojson").then(De=>De.json()).then(De=>{const ve=Dl.choropleth(De,{valueProperty:"PARAMVALUE",scale:["#ffffcc","#800026"],steps:5,mode:"q",style:{color:"#fff",weight:1,fillOpacity:.8},onEachFeature:(Le,Fe)=>{Fe.bindPopup(`<strong>PGA:</strong> ${Le.properties.PARAMVALUE} g`)}});v.current=ve});const ue=Dl.control({position:"topright"}),be=Dl.control({position:"bottomright"}),Ce=Dl.control({position:"topright"}),Re=Dl.control({position:"bottomright"});ue.onAdd=function(){const De=Dl.DomUtil.create("div","info");return De.innerHTML=`
            <h4>Modified Intensity (MI)</h4>
            <p>Le MI mesure l'intensité sismique basée sur les données instrumentales.</p>
            <p>Pour le séisme d'Al Haouz:</p>
            <p>- Valeurs maximales observées dans l'épicentre</p>
            <p>- Décroissance rapide avec la distance</p>
          `,De},be.onAdd=function(){const De=Dl.DomUtil.create("div","legend");return De.innerHTML=`
            <h4>Échelle MI</h4>
            <div><i style="background:#54278f"></i> 7.5 - 8.0</div>
            <div><i style="background:#756bb1"></i> 7.0 - 7.5</div>
            <div><i style="background:#9e9ac8"></i> 6.5 - 7.0</div>
            <div><i style="background:#cbc9e2"></i> 6.0 - 6.5</div>
            <div><i style="background:#f2f0f7"></i> < 6.0</div>
          `,De},Ce.onAdd=function(){const De=Dl.DomUtil.create("div","info");return De.innerHTML=`
            <h4>Peak Ground Acceleration (PGA)</h4>
            <p>L'accélération maximale du sol en g (9.81 m/s²)</p>

            <p>- Décroissance avec la distance</p>
          `,De},Re.onAdd=function(){const De=Dl.DomUtil.create("div","legend");return De.innerHTML=`
            <h4>Échelle PGA (g)</h4>
            <div><i style="background:#800026"></i> > 0.34</div>
            <div><i style="background:#bd0026"></i> 0.25 - 0.34</div>
            <div><i style="background:#e31a1c"></i> 0.15 - 0.25</div>
            <div><i style="background:#fc4e2a"></i> 0.10 - 0.15</div>
            <div><i style="background:#ffffcc"></i> < 0.10</div>
          `,De},S.current={info:ue,miLegend:be,pgaInfo:Ce,pgaLegend:Re}}return()=>{a.current&&(a.current.remove(),a.current=null)}},[]),rt.useEffect(()=>{a.current&&h.current&&(o?(h.current.addTo(a.current),S.current.info.addTo(a.current),S.current.miLegend.addTo(a.current)):(h.current.remove(),S.current.info.remove(),S.current.miLegend.remove()))},[o]),rt.useEffect(()=>{a.current&&v.current&&(B?(v.current.addTo(a.current),S.current.pgaInfo.addTo(a.current),S.current.pgaLegend.addTo(a.current)):(v.current.remove(),S.current.pgaInfo.remove(),S.current.pgaLegend.remove()))},[B]);const te=()=>{switch(e){case"batiments":return"Impact sur les bâtiments";case"victimes":return"Bilan humain";case"regions":return"Décès par région";default:return"Impact du Séisme"}};return Dt.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[Dt.jsxs(Gf,{className:"col-span-2 h-[500px] bg-white",children:[Dt.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[Dt.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Carte de l'épicentre"}),Dt.jsxs("div",{className:"flex items-center space-x-4",children:[Dt.jsxs("div",{className:"flex items-center space-x-2",children:[Dt.jsx(Um,{id:"mi-layer",checked:o,onCheckedChange:I}),Dt.jsx(Vm,{htmlFor:"mi-layer",children:" MI"})]}),Dt.jsxs("div",{className:"flex items-center space-x-2",children:[Dt.jsx(Um,{id:"pga-layer",checked:B,onCheckedChange:$}),Dt.jsx(Vm,{htmlFor:"pga-layer",children:" PGA"})]})]})]}),Dt.jsx("div",{ref:i,className:"h-[calc(100%-60px)]"})]}),Dt.jsxs(Gf,{className:"bg-white",children:[Dt.jsx("div",{className:"p-4 border-b",children:Dt.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:gl.infos.nom})}),Dt.jsx("div",{className:"p-6",children:Dt.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[Dt.jsxs("div",{className:"space-y-4",children:[Dt.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Date et Heure"}),Dt.jsx("div",{className:"text-xl font-bold text-gray-900",children:gl.infos.date}),Dt.jsx("div",{className:"text-sm text-gray-600",children:gl.infos.heure})]}),Dt.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Magnitude"}),Dt.jsx("div",{className:"text-2xl font-bold text-gray-900",children:gl.infos.magnitude})]})]}),Dt.jsxs("div",{className:"space-y-4",children:[Dt.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Profondeur"}),Dt.jsxs("div",{className:"text-xl font-bold text-gray-900",children:[gl.infos.profondeur," km"]})]}),Dt.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Intensité"}),Dt.jsx("div",{className:"text-xl font-bold text-gray-900",children:gl.infos.intensite})]})]}),Dt.jsxs("div",{className:"col-span-2 bg-purple-50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Mécanisme"}),Dt.jsx("div",{className:"text-xl font-bold text-gray-900",children:gl.infos.mecanisme})]})]})})]}),Dt.jsxs(Gf,{className:"bg-white h-[500px]",children:[Dt.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[Dt.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:te()}),Dt.jsxs($c,{as:"div",className:"relative inline-block text-left z-10",children:[Dt.jsxs($c.Button,{className:"inline-flex justify-center gap-x-1.5 rounded-md bg-blue-600 px-4 py-2 text-white text-sm font-semibold hover:bg-blue-700",children:[te(),Dt.jsx(jA,{className:"w-5 h-5"})]}),Dt.jsx($c.Items,{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg ring-1 ring-black/5",children:Dt.jsx("div",{className:"py-1",children:[{id:"batiments",label:"Impact sur les bâtiments"},{id:"victimes",label:"Bilan humain"},{id:"regions",label:"Décès par région"}].map(le=>Dt.jsx($c.Item,{children:({active:se})=>Dt.jsx("button",{className:`block w-full text-left px-4 py-2 text-sm ${se?"bg-gray-100 text-gray-900":"text-gray-700"}`,onClick:()=>t(le.id),children:le.label})},le.id))})})]})]}),Dt.jsx("div",{className:"p-4 h-[calc(100%-80px)]",children:Dt.jsx(oP,{width:"100%",height:"100%",children:K()})})]})]})}const PA={Adebdi:{center:[-8.4642,30.7765],buildingsPath:"./src/assets/data/dega/Adebdi_avec_degats.geojson",boundaryPath:"./src/assets/data/dega/zonne/Adebdi.geojson"},Chichaoua:{center:[-8.779,31.5277],buildingsPath:"./src/assets/data/dega/chichaoua_avec_degats.geojson",boundaryPath:"./src/assets/data/dega/zonne/chichoua.geojson"},"Lalla Aziza":{center:[-8.6106,31.0873],buildingsPath:"./src/assets/data/dega/lallaAziza_avec_degats.geojson",boundaryPath:"./src/assets/data/dega/zonne/lallaAziza.geojson"},Marrakech:{center:[-8.0089,31.6295],buildingsPath:"./src/assets/data/dega/marrakech_avec_degats.geojson",boundaryPath:"./src/assets/data/dega/zonne/marrakech.geojson"},Taroudant:{center:[-8.8767,30.4709],buildingsPath:"./src/assets/data/dega/Taroudant_avec_degats.geojson",boundaryPath:"./src/assets/data/dega/zonne/Taroudant.geojson"}},a0={Damage:"#FF4444","Possible damage":"#FFEB3B","pas touché":"#4CAF50"};function Aue(){const e=rt.useRef(null),t=rt.useRef(null),[i,a]=rt.useState(null),h=async()=>{try{for(const[S,o]of Object.entries(PA)){const B=await(await fetch(o.boundaryPath)).json();t.current.addSource(`zone-${S}`,{type:"geojson",data:B}),t.current.addLayer({id:`zone-boundary-${S}`,type:"fill",source:`zone-${S}`,paint:{"fill-color":"#ffffff","fill-opacity":.5,"fill-outline-color":"#000000"}})}}catch(S){console.error("Error loading zones:",S)}};rt.useEffect(()=>(!t.current&&e.current&&(Dp.accessToken="pk.eyJ1IjoibW9oc3NpbmVib3VoZGEiLCJhIjoiY20zdm13bGpzMHpxYzJsc2ZtZDNwMGVveSJ9.2otT87Si6Z7EB8P2t_rOIg",t.current=new Dp.Map({container:e.current,style:"mapbox://styles/mapbox/satellite-v9",center:[-8.1938,30.99],zoom:6,pitch:45}),t.current.addControl(new Dp.NavigationControl),t.current.on("load",()=>{h()})),()=>{t.current&&(t.current.remove(),t.current=null)}),[]);const v=async S=>{try{const o=PA[S];t.current.getLayer("buildings-damage")&&t.current.removeLayer("buildings-damage"),t.current.getSource("buildings")&&t.current.removeSource("buildings");const I=await fetch(o.buildingsPath);if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const B=await I.json();t.current.addSource("buildings",{type:"geojson",data:B}),t.current.addLayer({id:"buildings-damage",type:"fill-extrusion",source:"buildings",paint:{"fill-extrusion-color":["match",["get","degat"],"Damage",a0.Damage,"Possible damage",a0["Possible damage"],"pas touché",a0["pas touché"],"#000000"],"fill-extrusion-height":3,"fill-extrusion-opacity":.8}}),t.current.flyTo({center:o.center,zoom:13,duration:2e3})}catch(o){console.error("Error loading buildings:",o),alert(`Erreur lors du chargement des bâtiments pour ${S}`)}};return Dt.jsx("div",{className:"grid grid-cols-1 gap-6",children:Dt.jsxs(Gf,{className:"h-[calc(100vh-8rem)] bg-white relative",children:[Dt.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[Dt.jsx("h2",{className:"text-lg font-semibold",children:"Analyse Des Dégâts"}),Dt.jsx("div",{className:"flex gap-2",children:Object.keys(PA).map(S=>Dt.jsx("button",{onClick:()=>{a(S),v(S)},className:`px-4 py-2 rounded-md transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm
                  ${i===S?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,children:S},S))})]}),Dt.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:Dt.jsxs(Gf,{className:"bg-white/90 backdrop-blur p-4",children:[Dt.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Légende"}),Dt.jsx("div",{className:"space-y-2",children:Object.entries(a0).map(([S,o])=>Dt.jsxs("div",{className:"flex items-center gap-2",children:[Dt.jsx("div",{className:"w-4 h-4 rounded shadow-sm",style:{backgroundColor:o}}),Dt.jsx("span",{className:"text-sm text-gray-600",children:S})]},S))})]})}),Dt.jsx("div",{ref:e,className:"h-[calc(100%-60px)]"})]})})}const W5={Abadou:[-7.308,31.588],"Ait Ourir":[-7.672,31.561],"Ait Sidi Daoud":[-7.67,31.618],Amghras:[-8.177,31.217],Amizmiz:[-8.248,31.219],Anougal:[-8.276,31.108],Asni:[-7.92,31.175],Azgour:[-8.359,31.13],"Dar Jamaa":[-8.386,31.252],Ghmate:[-7.79,31.419],Ighil:[-8.359,30.999],Iguerferouane:[-7.677,31.399],Ijoukak:[-8.058,30.994],Imgdal:[-8.13,31.103],"Lalla Takarkoust":[-8.131,31.326],"Moulay Brahim":[-8.015,31.319],Oukaimden:[-7.831,31.219],"Oulad Mtaa":[-8.266,31.326],Ouazguita:[-8.089,31.259],Ourika:[-7.806,31.343],Ouirgane:[-8.03,31.16],"Sidi Abdallah Ghiat":[-7.851,31.522],"Sidi Badhaj":[-8.204,31.331],"Sti Fadma":[-7.709,31.242],Tahannaout:[-7.946,31.359],"Talat N Yaaqoub":[-8.26,30.955],Tamaguert:[-7.546,31.547],Tamazouzte:[-7.786,31.489],Tameslohte:[-8.066,31.46],Tazart:[-7.394,31.575],"Tidili Mesfioua":[-7.619,31.477],Tighedouine:[-7.533,31.355],Tizguine:[-8.318,31.26],Touama:[-7.483,31.56],Zerkten:[-7.352,31.401]},Z5=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#ffc658"];function Pue(){var Ct,Kt;rt.useState("overview"),rt.useState(null);const[e,t]=rt.useState(null),[i,a]=rt.useState("Taux de pauvreté"),[h,v]=rt.useState([]),[S,o]=rt.useState([]),[I,B]=rt.useState("alhaouz"),[$,U]=rt.useState({communes:!0,buildings:!1}),[K,te]=rt.useState(null),[le,se]=rt.useState({stats:!1,charts:!1}),ue=rt.useRef(null),be=rt.useRef(null),[Ce,Re]=rt.useState("alhaouz"),De=Lt=>{Lt==="satellite-compare"?(Re(I),window.open("https://oudaddayassine31.github.io/SatelliteCompare/","_blank")):B(Lt)},ve={area:[{max:50,color:"#FFEB3B",label:"Très petit"},{max:100,color:"#FFA726",label:"Petit"},{max:200,color:"#EF5350",label:"Moyen"},{max:1/0,color:"#212121",label:"Grand"}]},Le=[{name:"Ait Hkim-Ait Yzid",poverty:20},{name:"Alt Faska",poverty:15.8},{name:"Setti Fadma",poverty:13},{name:"Tidili Mesfioua",poverty:11.6},{name:"Iguerferouane",poverty:11},{name:"Ourika",poverty:10.7},{name:"Sidi Badhaj",poverty:10.1},{name:"Tidili",poverty:9.8},{name:"Tazart",poverty:9.3},{name:"Ighil",poverty:8.4},{name:"Lalla Takerkoust",poverty:7.7},{name:"Touama",poverty:7.3},{name:"Tamaguert",poverty:6.5},{name:"Asni",poverty:6.3},{name:"Amghras",poverty:5.7},{name:"Ghmate",poverty:4.7},{name:"Sidi Abdallah Ghiat",poverty:4.1},{name:"Ouirgane",poverty:3.7},{name:"Tazarine",poverty:3.1},{name:"Ait Aadel",poverty:2.8},{name:"Ait Sidi Daoud",poverty:2.7},{name:"Sidi Rahhal",poverty:2.5},{name:"Tamazouzte",property:2.1},{name:"Talat N'Yaaqoub",poverty:1.9},{name:"Ijoukak",poverty:1.3},{name:"Ait Ourir",poverty:1.1},{name:"Amizmiz",poverty:.9},{name:"Tahanaout",poverty:.5},{name:"Amezmiz",poverty:.4}];rt.useEffect(()=>(!be.current&&ue.current&&(Dp.accessToken="pk.eyJ1IjoibW9oc3NpbmVib3VoZGEiLCJhIjoiY20zdm13bGpzMHpxYzJsc2ZtZDNwMGVveSJ9.2otT87Si6Z7EB8P2t_rOIg",be.current=new Dp.Map({container:ue.current,style:"mapbox://styles/mapbox/satellite-v9",center:[-8.1938,30.99],zoom:7,pitch:45}),be.current.addControl(new Dp.NavigationControl),be.current.on("load",()=>{Fe()})),()=>{be.current&&(be.current.remove(),be.current=null)}),[I]);const Fe=async()=>{try{const et=await(await fetch("./src/assets/data/decoupage_administrative/commune_alhouz.geojson")).json();t(et.features.reduce((vt,Ot)=>({communes:vt.communes+1,population:vt.population+Ot.properties.Population,menages:vt.menages+Ot.properties.Nb_Menages}),{communes:0,population:0,menages:0})),be.current.getSource("communes")||(be.current.addSource("communes",{type:"geojson",data:et}),be.current.addLayer({id:"communes-fill",type:"fill",source:"communes",paint:{"fill-color":["interpolate",["linear"],["get","Population"],0,"#f1eef6",5e3,"#bdc9e1",1e4,"#74a9cf",2e4,"#0570b0"],"fill-opacity":.6}}),be.current.addLayer({id:"communes-line",type:"line",source:"communes",paint:{"line-color":"#000","line-width":1}}),be.current.on("click","communes-fill",vt=>{if(!vt.features.length)return;const Ot=vt.features[0];new Dp.Popup().setLngLat(vt.lngLat).setHTML(`
              <div class="p-2">
                <h3 class="font-bold">${Ot.properties.Nom_Commun}</h3>
                <p>Population: ${Ot.properties.Population.toLocaleString()}</p>
                <p>Ménages: ${Ot.properties.Nb_Menages.toLocaleString()}</p>
              </div>
            `).addTo(be.current)}))}catch(Lt){console.error("Error loading communes:",Lt)}},lt={Abadou:"Abadou.geojson","Ait Ourir":"Ait Ourir.geojson","Ait Sidi Daoud":"Ait Sidi Daoud.geojson",Amghras:"Amghras.geojson",Amizmiz:"Amizmiz.geojson",Anougal:"Anougal.geojson",Asni:"Asni.geojson",Azgour:"Azgour.geojson","Dar Jamaa":"Dar Jamaa.geojson",Ghmate:"Ghmate.geojson",Ighil:"Ighil.geojson",Iguerferouane:"Iguerferouane.geojson",Ijoukak:"Ijoukak.geojson",Imgdal:"Imgdal.geojson","Lalla Takarkoust":"Lalla Takarkoust.geojson","Moulay Brahim":"Moulay Brahim.geojson",Oukaimden:"Oukaimden.geojson","Oulad Mtaa":"Oulad Mtaa.geojson",Ouazguita:"Ouazguita.geojson",Ourika:"Ourika.geojson",Ouirgane:"Ouirgane.geojson","Sidi Abdallah Ghiat":"Sidi Abdallah Ghiat.geojson","Sidi Badhaj":"Sidi Badhaj.geojson","Sti Fadma":"Sti Fadma.geojson",Tahannaout:"Tahannaout.geojson","Talat N Yaaqoub":"Talat N Yaaqoub.geojson",Tamaguert:"Tamaguert.geojson",Tamazouzte:"Tamazouzte.geojson",Tameslohte:"Tameslohte.geojson",Tazart:"Tazart.geojson","Tidili Mesfioua":"Tidili Mesfioua.geojson",Tighedouine:"Tighedouine.geojson",Tizguine:"Tizguine.geojson",Touama:"Touama.geojson",Zerkten:"Zerkten.geojson"},xt=async Lt=>{try{if(!Lt){alert("Veuillez sélectionner une commune d'abord");return}const et=lt[Lt];if(!et){console.error(`Aucun fichier de données de bâtiments trouvé pour la commune : ${Lt}`);return}const vt=await fetch(`./src/assets/data/buildings/before/${et}`);if(!vt.ok){console.error(`Erreur de chargement des bâtiments pour ${Lt} : ${vt.status} - ${vt.statusText}`);return}const Ot=await vt.json();be.current.getLayer("buildings-3d")&&be.current.removeLayer("buildings-3d"),be.current.getSource("buildings")&&be.current.removeSource("buildings"),be.current.addSource("buildings",{type:"geojson",data:Ot}),be.current.addLayer({id:"buildings-3d",type:"fill-extrusion",source:"buildings",paint:{"fill-extrusion-color":["step",["get","area_in_meters"],ve.area[0].color,50,ve.area[1].color,100,ve.area[2].color,200,ve.area[3].color],"fill-extrusion-height":3,"fill-extrusion-opacity":.8},layout:{visibility:"visible"}}),U(zt=>({...zt,buildings:!0}));const mt=W5[Lt];mt&&be.current.flyTo({center:mt,zoom:15,duration:2e3})}catch(et){console.error("Error loading buildings:",et)}},gt=Lt=>{if(Lt==="buildings"){if(!K){alert("Veuillez sélectionner une commune d'abord");return}U(et=>{const vt={...et,buildings:!et.buildings};return be.current&&(vt.buildings?xt(K):(St(),te(null)),be.current.getLayer("buildings-3d")&&be.current.setLayoutProperty("buildings-3d","visibility",vt.buildings?"visible":"none")),vt})}else U(et=>{const vt={...et,[Lt]:!et[Lt]};return be.current&&(["communes-fill","communes-line"].forEach(Ot=>{be.current.getLayer(Ot)&&be.current.setLayoutProperty(Ot,"visibility",vt[Lt]?"visible":"none")}),vt.communes||te(null)),vt})},Je=Lt=>{se(et=>({stats:Lt==="stats"?!et.stats:!1,charts:Lt==="charts"?!et.charts:!1}))},St=()=>{be.current.flyTo({center:[-8.1938,30.99],zoom:9,pitch:45,duration:2e3})},Nt=Lt=>{switch(Lt){case"Taux de pauvreté":return Le.sort((et,vt)=>vt.poverty-et.poverty);case"Matériaux de mur":return Object.entries({"Béton armé/Briques":36.6,"Pierres scellées mortier":4.6,"Planches bois":.5,"Pierres scellées terre":16.6,"Pisé/Briques terre":41.5,"Bois récupéré":.2}).map(([et,vt])=>({name:et,value:vt}));case"Matériaux de toit":return Object.entries({Dalle:36.5,"Planches bois/tuiles":4.2,"Tôle/ciment/étain":.3,"Bois récupéré":58.7,"Étain/plastique":.2}).map(([et,vt])=>({name:et,value:vt}));case"Ménages par type":return Object.entries({Villa:.9,Appartement:.5,"Maison marocaine":38.8,"Habitat sommaire":.4,"Logement rural":58.9,Autre:.5}).map(([et,vt])=>({name:et,value:vt}));default:return[]}};rt.useEffect(()=>{v(Nt(i))},[i,S]);const Ht=()=>["Taux de pauvreté"].includes(i)?Dt.jsx(oP,{width:"100%",height:500,children:Dt.jsxs(c0,{data:h,margin:{top:20,right:120,left:50,bottom:100},children:[Dt.jsx(Gp,{dataKey:"name",angle:-45,textAnchor:"end",interval:0,height:100,tick:{fontSize:11}}),Dt.jsx(Hp,{label:{value:"Taux de pauvreté (%)",angle:-90,position:"insideLeft",offset:-10,style:{fontSize:"14px",textAnchor:"middle"}},tick:{fontSize:12}}),Dt.jsx(Cu,{}),Dt.jsx(Wc,{verticalAlign:"bottom",height:36}),Dt.jsx(qc,{dataKey:"poverty",fill:"#8884d8",name:"Taux de pauvreté par commune"}),Dt.jsx(Qm,{y:5.5,stroke:"#2196F3",strokeDasharray:"3 3",label:{value:"Al Haouz (5.5%)",position:"right",fill:"#2196F3",fontSize:12},name:"Province Al Haouz"}),Dt.jsx(Qm,{y:8,stroke:"#FF5252",strokeDasharray:"3 3",label:{value:"Zone sinistrée (8%)",position:"right",fill:"#FF5252",fontSize:12}}),Dt.jsx(Qm,{y:4.8,stroke:"#4CAF50",strokeDasharray:"3 3",label:{value:"Maroc (4.8%)",position:"right",fill:"#4CAF50",fontSize:12}}),Dt.jsx(Wc,{payload:[{value:"Taux de pauvreté par commune",type:"rect",color:"#8884d8"},{value:"Province Al Haouz",type:"line",color:"#2196F3",strokeDasharray:"3 3"},{value:"Zone sinistrée",type:"line",color:"#FF5252",strokeDasharray:"3 3"},{value:"Moyenne nationale",type:"line",color:"#4CAF50",strokeDasharray:"3 3"}]})]})}):Dt.jsx(oP,{width:"100%",height:400,children:Dt.jsxs(nle,{children:[Dt.jsx(od,{data:h,cx:"50%",cy:"50%",labelLine:!0,label:({name:Lt,value:et})=>`${Lt} (${et}%)`,outerRadius:150,fill:"#8884d8",dataKey:"value",children:h.map((Lt,et)=>Dt.jsx(Lx,{fill:Z5[et%Z5.length]},`cell-${et}`))}),Dt.jsx(Cu,{}),Dt.jsx(Wc,{})]})});return Dt.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[Dt.jsx("header",{className:"bg-white border-b",children:Dt.jsx("div",{className:"max-w-7xl mx-auto px-4",children:Dt.jsxs("div",{className:"h-20 flex items-center justify-between",children:[Dt.jsxs("div",{className:"flex items-center",children:[Dt.jsx("div",{className:"bg-blue-600 p-2 rounded-lg",children:Dt.jsx("img",{src:"./src/morocco.svg",alt:"Logo",className:"h-8 w-8"})}),Dt.jsxs("div",{className:"ml-3",children:[Dt.jsx("h1",{className:"text-2xl font-bold text-blue-600",children:"Observatoire sismique Al Haouz"}),Dt.jsx("p",{className:"text-sm text-gray-500",children:"Plateforme de surveillance du séisme du 8 septembre 2023 dans la province d'Al Haouz, Maroc"})]})]}),Dt.jsxs("nav",{className:"flex items-center space-x-6",children:[Dt.jsx("a",{href:"https://github.com/oudaddayassine31/al_haouz_project",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-blue-600 transition-colors font-medium",children:"Code source"}),Dt.jsx("a",{href:"https://www.linkedin.com/in/yassine-oudadda-4995581b8/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-blue-600 transition-colors font-medium",children:"Contact"})]})]})})}),Dt.jsxs("div",{className:"flex",children:[Dt.jsxs("aside",{className:"w-72 bg-white border-r shadow-sm h-[calc(100vh-5rem)] flex flex-col",children:[Dt.jsxs("div",{className:"p-6 flex-1",children:[Dt.jsx("h2",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-4",children:"Navigation"}),Dt.jsx("nav",{className:"space-y-2",children:[{id:"alhaouz",label:"Al Haouz",icon:Ale},{id:"seisme",label:"Séisme",icon:Tle},{id:"satellite",label:"Analyse Des Dégâts",icon:Ele},{id:"satellite-compare",label:"Comparaison Satellite",icon:Ple}].map(Lt=>Dt.jsxs("button",{onClick:()=>De(Lt.id),className:`
                    w-full flex items-center px-4 py-3 rounded-lg transition-all duration-200
                    ${I===Lt.id?"bg-blue-50 text-blue-700 font-medium shadow-sm":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                  `,children:[Dt.jsx(Lt.icon,{className:`h-5 w-5 mr-3 ${I===Lt.id?"text-blue-600":"text-gray-400"}`}),Dt.jsx("span",{children:Lt.label})]},Lt.id))})]}),Dt.jsxs("div",{className:"p-6 border-t",children:[Dt.jsx("h2",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-4",children:"Notre Équipe"}),Dt.jsx("div",{className:"space-y-4",children:[{name:"OUDADDA Yassine",placeholder:"public/WhatsApp Image 2024-12-03 at 7.17.28 PM.jpeg"},{name:"BOUHDA Mohssine",placeholder:"/api/placeholder/60/60"},{name:"SALAH Aissam",placeholder:"/api/placeholder/60/60"}].map(Lt=>Dt.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-50 hover:bg-blue-50 transition-colors",children:[Dt.jsx("div",{className:"flex-shrink-0",children:Dt.jsx("img",{src:Lt.placeholder,alt:Lt.name,className:"w-10 h-10 rounded-full bg-gray-200"})}),Dt.jsxs("div",{className:"flex-1 min-w-0",children:[Dt.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:Lt.name}),Dt.jsx("p",{className:"text-xs text-gray-500 truncate",children:Lt.role})]})]},Lt.name))})]})]}),Dt.jsx("main",{className:"flex-1 p-6",children:I==="seisme"?Dt.jsx(Eue,{}):I==="satellite"?Dt.jsx(Aue,{}):I==="satellite-compare"?Dt.jsx(SatelliteCompare,{}):Dt.jsx("div",{children:Dt.jsx("div",{className:"grid grid-cols-1 gap-6",children:Dt.jsxs(Gf,{className:"h-[calc(100vh-8rem)] bg-white relative",children:[Dt.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[Dt.jsx("h2",{className:"text-lg font-semibold",children:"Carte Interactive"}),Dt.jsx("button",{onClick:St,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-md shadow-sm transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 font-medium text-sm",children:"Réinitialiser le zoom"})]}),Dt.jsx("div",{className:"absolute top-4 right-4 z-10",children:Dt.jsxs(Gf,{className:"w-64 p-4 space-y-4",children:[Dt.jsxs("div",{className:"space-y-3",children:[Dt.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Couches"}),Dt.jsxs("div",{className:"flex items-center justify-between",children:[Dt.jsx(Vm,{htmlFor:"communes-toggle",children:"Communes"}),Dt.jsx(Um,{id:"communes-toggle",checked:$.communes,onCheckedChange:Lt=>gt("communes")})]})]}),Dt.jsxs("div",{className:"space-y-2",children:[Dt.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Sélectionnez une commune "}),Dt.jsxs($c,{as:"div",className:"relative",children:[Dt.jsxs($c.Button,{className:"w-full inline-flex justify-between items-center px-3 py-2 text-sm bg-gray-50 rounded-md border border-gray-200 hover:bg-gray-100 transition-colors",children:[Dt.jsx("span",{className:"truncate",children:K||"Choisir une commune"}),Dt.jsx(jA,{className:"h-5 w-5 text-gray-400"})]}),Dt.jsx($c.Items,{className:"absolute right-0 mt-1 w-full bg-white rounded-md shadow-lg max-h-60 overflow-y-auto border border-gray-200",children:Object.keys(W5).map(Lt=>Dt.jsx($c.Item,{children:({active:et})=>Dt.jsx("button",{className:`
                                      w-full px-4 py-2 text-sm text-left
                                      ${et?"bg-blue-50 text-blue-700":"text-gray-700"}
                                      hover:bg-blue-50 hover:text-blue-700 transition-colors
                                    `,onClick:()=>{te(Lt),xt(Lt)},children:Lt})},Lt))})]})]}),K&&Dt.jsx("div",{className:"space-y-3",children:Dt.jsxs("div",{className:"flex items-center justify-between",children:[Dt.jsx(Vm,{htmlFor:"buildings-toggle",children:"Bâtiments"}),Dt.jsx(Um,{id:"buildings-toggle",checked:$.buildings,onCheckedChange:Lt=>gt("buildings")})]})}),$.buildings&&K&&Dt.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[Dt.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Classification par surface"}),Dt.jsx("div",{className:"grid grid-cols-1 gap-2",children:ve.area.map((Lt,et)=>Dt.jsxs("div",{className:"flex items-center gap-2",children:[Dt.jsx("div",{className:"w-4 h-4 rounded shadow-sm",style:{backgroundColor:Lt.color}}),Dt.jsx("span",{className:"text-sm text-gray-600",children:et===ve.area.length-1?`${Lt.label} (>${ve.area[et-1].max}m²)`:`${Lt.label} (${et===0?"0":ve.area[et-1].max}-${Lt.max}m²)`})]},et))})]}),Dt.jsxs("div",{className:"space-y-3 pt-2 border-t",children:[Dt.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Affichage"}),Dt.jsxs("div",{className:"flex items-center justify-between",children:[Dt.jsx(Vm,{htmlFor:"stats-toggle",children:"Statistiques"}),Dt.jsx(Um,{id:"stats-toggle",checked:le.stats,onCheckedChange:()=>Je("stats")})]}),Dt.jsxs("div",{className:"flex items-center justify-between",children:[Dt.jsx(Vm,{htmlFor:"charts-toggle",children:"Graphiques"}),Dt.jsx(Um,{id:"charts-toggle",checked:le.charts,onCheckedChange:()=>Je("charts")})]})]})]})}),le.stats&&Dt.jsx("div",{className:"absolute bottom-4 left-4 z-10 w-96",children:Dt.jsx(Gf,{className:"bg-white/90 backdrop-blur",children:Dt.jsx("div",{className:"p-4",children:Dt.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Dt.jsxs("div",{className:"bg-blue-50/50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-gray-500",children:"Population"}),Dt.jsx("div",{className:"text-2xl font-bold",children:(Ct=e==null?void 0:e.population)==null?void 0:Ct.toLocaleString()})]}),Dt.jsxs("div",{className:"bg-green-50/50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-gray-500",children:"Communes"}),Dt.jsx("div",{className:"text-2xl font-bold",children:e==null?void 0:e.communes})]}),Dt.jsxs("div",{className:"bg-orange-50/50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-gray-500",children:"Ménages"}),Dt.jsx("div",{className:"text-2xl font-bold",children:(Kt=e==null?void 0:e.menages)==null?void 0:Kt.toLocaleString()})]}),Dt.jsxs("div",{className:"bg-red-50/50 p-4 rounded-lg",children:[Dt.jsx("div",{className:"text-sm text-gray-500",children:"Superficie"}),Dt.jsx("div",{className:"text-2xl font-bold",children:"6 612 km²"})]})]})})})}),le.charts&&Dt.jsx("div",{className:"absolute left-4 top-16 z-10 w-[600px]",children:Dt.jsxs(Gf,{className:"bg-white/90 backdrop-blur",children:[Dt.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[Dt.jsx("h2",{className:"text-lg font-semibold",children:"DataViz"}),Dt.jsxs($c,{as:"div",className:"relative inline-block text-left",children:[Dt.jsxs($c.Button,{className:"inline-flex justify-center gap-x-1.5 rounded-md bg-blue-600 px-4 py-2 text-white text-sm font-semibold hover:bg-blue-700",children:[i,Dt.jsx(jA,{className:"w-5 h-5"})]}),Dt.jsx($c.Items,{className:"absolute right-0 mt-2 w-56 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5 focus:outline-none",children:Dt.jsx("div",{className:"py-1",children:["Taux de pauvreté","Matériaux de mur","Matériaux de toit","Ménages par type"].map(Lt=>Dt.jsx($c.Item,{children:({active:et})=>Dt.jsx("button",{className:`block w-full text-left px-4 py-2 text-sm ${et?"bg-gray-100 text-gray-900":"text-gray-700"}`,onClick:()=>a(Lt),children:Lt})},Lt))})})]})]}),Dt.jsx("div",{className:"p-4",children:Ht()})]})}),Dt.jsx("div",{ref:ue,className:"h-[calc(100%-60px)]"})]})})},"alhaouz")})]})]})}XV.createRoot(document.getElementById("root")).render(Dt.jsx(rt.StrictMode,{children:Dt.jsx(Pue,{})}));
